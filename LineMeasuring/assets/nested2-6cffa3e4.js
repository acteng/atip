import{S as U,i as H,s as W,M as Jn,b as R,c as G,e as P,d as L,g as _,ax as Qn,h as j,j as $,k as D,m as b,w as Ut,l as q,t as h,n as g,p as m,q as w,aJ as cn,aK as pn,aL as $n,aM as mn,u as y,f as lr,x as Y,an as eo,N as X,C as ee,ap as hn,T as dt,r as Ot,F as dn,a as Tt,v as gr,I as Ce,a2 as _t,y as oe,o as se,a5 as ar,az as Ne,aA as Ct,B as _r,aQ as x,ao as je,aR as fe,Q as Ke,G as ue,Y as ge,aS as qe,aT as ie,P as fr,R as gn,aU as ur,aV as to,_ as _n,Z as gt,E as bn,aW as br,D as ro,aX as wr,L as no,z as oo,aG as so}from"./index-2b62213b.js";import{e as xt,C as Se,b as Dt,d as te,a as io,S as lo,L as ao,M as fo}from"./StreetViewController-79c95362.js";import{L as uo,d as vr,c as wn,C as _e,B as co,Z as po,I as $o}from"./schemas-3b2f0d60.js";import{P as mo}from"./Pin-67ab9e56.js";import{I as Q}from"./InteractiveLayer-7d28a164.js";import{F as ho}from"./FileInput-461cc3a9.js";const go="/atip/LineMeasuring/assets/help-d011708a.svg";function _o(t){let e,r;const n=t[1].default,o=cn(n,t,t[4],null);return{c(){e=P("div"),o&&o.c(),j(e,"class","govuk-prose")},m(s,l){$(s,e,l),o&&o.m(e,null),r=!0},p(s,l){o&&o.p&&(!r||l&16)&&pn(o,n,s,s[4],r?mn(n,s[4],l,null):$n(s[4]),null)},i(s){r||(h(o,s),r=!0)},o(s){g(o,s),r=!1},d(s){s&&m(e),o&&o.d(s)}}}function bo(t){let e,r,n,o,s,l,f,i,a;function u(p){t[3](p)}let c={title:"Help",$$slots:{default:[_o]},$$scope:{ctx:t}};return t[0]!==void 0&&(c.open=t[0]),s=new Jn({props:c}),R.push(()=>G(s,"open",u)),{c(){e=P("button"),r=P("img"),o=L(),_(s.$$.fragment),Qn(r.src,n=go)||j(r,"src",n),j(r,"title","Help"),j(r,"alt","Help"),j(e,"class","svelte-7d9d1l")},m(p,d){$(p,e,d),D(e,r),$(p,o,d),b(s,p,d),f=!0,i||(a=Ut(e,"click",t[2]),i=!0)},p(p,[d]){const k={};d&16&&(k.$$scope={dirty:d,ctx:p}),!l&&d&1&&(l=!0,k.open=p[0],q(()=>l=!1)),s.$set(k)},i(p){f||(h(s.$$.fragment,p),f=!0)},o(p){g(s.$$.fragment,p),f=!1},d(p){p&&(m(e),m(o)),w(s,p),i=!1,a()}}}function wo(t,e,r){let{$$slots:n={},$$scope:o}=e,s=!1;const l=()=>r(0,s=!0);function f(i){s=i,r(0,s)}return t.$$set=i=>{"$$scope"in i&&r(4,o=i.$$scope)},[s,n,l,f,o]}class re extends U{constructor(e){super(),H(this,e,wo,bo,W,{})}}function vo(t){let e;return{c(){e=P("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function yo(t){let e,r,n,o,s=t[0]=="Private (development)"&&vo();return{c(){s&&s.c(),e=L(),r=P("p"),r.textContent="Note the ATF scheme data has not been validated.",n=L(),o=P("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,f){s&&s.m(l,f),$(l,e,f),$(l,r,f),$(l,n,f),$(l,o,f)},p:Y,d(l){l&&(m(e),m(r),m(n),m(o)),s&&s.d(l)}}}function ko(t){let e,r,n,o,s,l;return s=new re({props:{$$slots:{default:[yo]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("App version: "),n=y(t[0]),o=L(),_(s.$$.fragment)},m(f,i){$(f,e,i),D(e,r),D(e,n),D(e,o),b(s,e,null),l=!0},p(f,[i]){const a={};i&2&&(a.$$scope={dirty:i,ctx:f}),s.$set(a)},i(f){l||(h(s.$$.fragment,f),l=!0)},o(f){g(s.$$.fragment,f),l=!1},d(f){f&&m(e),w(s)}}}function So(t){return[lr()]}class To extends U{constructor(e){super(),H(this,e,So,ko,W,{})}}const Co={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var me=Uint8Array,ot=Uint16Array,vn=Uint32Array,yn=new me([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kn=new me([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Lo=new me([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Sn=function(t,e){for(var r=new ot(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new vn(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},Tn=Sn(yn,2),Cn=Tn[0],Ao=Tn[1];Cn[28]=258,Ao[258]=28;var Oo=Sn(kn,0),Do=Oo[0],Jt=new ot(32768);for(var J=0;J<32768;++J){var He=(J&43690)>>>1|(J&21845)<<1;He=(He&52428)>>>2|(He&13107)<<2,He=(He&61680)>>>4|(He&3855)<<4,Jt[J]=((He&65280)>>>8|(He&255)<<8)>>>1}var kt=function(t,e,r){for(var n=t.length,o=0,s=new ot(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new ot(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new ot(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[Jt[c]>>>i]=a}else for(f=new ot(n),o=0;o<n;++o)t[o]&&(f[o]=Jt[l[t[o]-1]++]>>>15-t[o]);return f},Et=new me(288);for(var J=0;J<144;++J)Et[J]=8;for(var J=144;J<256;++J)Et[J]=9;for(var J=256;J<280;++J)Et[J]=7;for(var J=280;J<288;++J)Et[J]=8;var Ln=new me(32);for(var J=0;J<32;++J)Ln[J]=5;var Eo=kt(Et,9,1),Po=kt(Ln,5,1),Wt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},we=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},zt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Mo=function(t){return(t+7)/8|0},cr=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?ot:t.BYTES_PER_ELEMENT==4?vn:me)(r-e);return n.set(t.subarray(e,r)),n},No=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ke=function(t,e,r){var n=new Error(e||No[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ke),!r)throw n;return n},Io=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new me(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new me(n*3));var l=function(ut){var ct=e.length;if(ut>ct){var wt=new me(Math.max(ct*2,ut));wt.set(e),e=wt}},f=r.f||0,i=r.p||0,a=r.b||0,u=r.l,c=r.d,p=r.m,d=r.n,k=n*8;do{if(!u){f=we(t,i,1);var S=we(t,i+1,3);if(i+=3,S)if(S==1)u=Eo,c=Po,p=9,d=5;else if(S==2){var I=we(t,i,31)+257,E=we(t,i+10,15)+4,N=I+we(t,i+5,31)+1;i+=14;for(var F=new me(N),O=new me(19),A=0;A<E;++A)O[Lo[A]]=we(t,i+A*3,7);i+=E*3;for(var M=Wt(O),B=(1<<M)-1,Z=kt(O,M,1),A=0;A<N;){var ne=Z[we(t,i,B)];i+=ne&15;var T=ne>>>4;if(T<16)F[A++]=T;else{var z=0,Le=0;for(T==16?(Le=3+we(t,i,3),i+=2,z=F[A-1]):T==17?(Le=3+we(t,i,7),i+=3):T==18&&(Le=11+we(t,i,127),i+=7);Le--;)F[A++]=z}}var Fe=F.subarray(0,I),ce=F.subarray(I);p=Wt(Fe),d=Wt(ce),u=kt(Fe,p,1),c=kt(ce,d,1)}else ke(1);else{var T=Mo(i)+4,v=t[T-4]|t[T-3]<<8,C=T+v;if(C>n){s&&ke(0);break}o&&l(a+v),e.set(t.subarray(T,C),a),r.b=a+=v,r.p=i=C*8,r.f=f;continue}if(i>k){s&&ke(0);break}}o&&l(a+131072);for(var Nt=(1<<p)-1,pe=(1<<d)-1,bt=i;;bt=i){var z=u[zt(t,i)&Nt],Ue=z>>>4;if(i+=z&15,i>k){s&&ke(0);break}if(z||ke(2),Ue<256)e[a++]=Ue;else if(Ue==256){bt=i,u=null;break}else{var lt=Ue-254;if(Ue>264){var A=Ue-257,be=yn[A];lt=we(t,i,(1<<be)-1)+Cn[A],i+=be}var at=c[zt(t,i)&pe],Be=at>>>4;at||ke(3),i+=at&15;var ce=Do[Be];if(Be>3){var be=kn[Be];ce+=zt(t,i)&(1<<be)-1,i+=be}if(i>k){s&&ke(0);break}o&&l(a+131072);for(var ft=a+lt;a<ft;a+=4)e[a]=e[a-ce],e[a+1]=e[a+1-ce],e[a+2]=e[a+2-ce],e[a+3]=e[a+3-ce];a=ft}}r.l=u,r.p=bt,r.b=a,r.f=f,u&&(f=1,r.m=p,r.d=c,r.n=d)}while(!f);return a==e.length?e:cr(e,0,a)},Fo=new me(0),Me=function(t,e){return t[e]|t[e+1]<<8},Te=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Vt=function(t,e){return Te(t,e)+Te(t,e+4)*4294967296};function Bo(t,e){return Io(t,e)}var Qt=typeof TextDecoder<"u"&&new TextDecoder,xo=0;try{Qt.decode(Fo,{stream:!0}),xo=1}catch{}var jo=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,cr(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function An(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Qt)return Qt.decode(t);var o=jo(t),s=o[0],l=o[1];return l.length&&ke(8),s}}var Ro=function(t,e){return e+30+Me(t,e+26)+Me(t,e+28)},Uo=function(t,e,r){var n=Me(t,e+28),o=An(t.subarray(e+46,e+46+n),!(Me(t,e+8)&2048)),s=e+46+n,l=Te(t,e+20),f=r&&l==4294967295?Ho(t,s):[l,Te(t,e+24),Te(t,e+42)],i=f[0],a=f[1],u=f[2];return[Me(t,e+10),i,a,o,s+Me(t,e+30)+Me(t,e+32),u]},Ho=function(t,e){for(;Me(t,e)!=1;e+=4+Me(t,e+2));return[Vt(t,e+12),Vt(t,e+4),Vt(t,e+20)]};function Wo(t,e){for(var r={},n=t.length-22;Te(t,n)!=101010256;--n)(!n||t.length-n>65558)&&ke(13);var o=Me(t,n+8);if(!o)return{};var s=Te(t,n+16),l=s==4294967295||o==65535;if(l){var f=Te(t,n-12);l=Te(t,f)==101075792,l&&(o=Te(t,f+32),s=Te(t,f+48))}for(var i=e&&e.filter,a=0;a<o;++a){var u=Uo(t,s,l),c=u[0],p=u[1],d=u[2],k=u[3],S=u[4],T=u[5],v=Ro(t,T);s=S,(!i||i({name:k,size:p,originalSize:d,compression:c}))&&(c?c==8?r[k]=Bo(t.subarray(v,v+p),new me(d)):ke(14,"unknown compression type "+c):r[k]=cr(t,v,v+p))}return r}function zo(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Gt):Gt(t)}function Gt(t){var e=new Uint8Array(t),r=Wo(e);return Promise.resolve(Vo(r))}function Vo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=An(t[o])}return e}function Ie(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&it(n)===e)return n;r++}}function Pt(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&it(o)===e&&r.push(o),n++}return r}function jt(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&it(o)===e&&r(o,n):r(o,n),n++}}function Go(t,e,r){var n=[];return jt(t,e,function(o,s){n.push(r(o,s))}),n}var qo=/.+\:/;function it(t){return t.tagName.replace(qo,"")}function On(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+it(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=On(t.childNodes[n]),n++;return e+="</"+it(t)+">",e}function Ko(t){var e=t.documentElement,r=Ie(e,"sheetData"),n=[];return jt(r,"row",function(o){jt(o,"c",function(s){n.push(s)})}),n}function Zo(t,e){return Ie(e,"v")}function Xo(t,e){if(e.firstChild&&it(e.firstChild)==="is"&&e.firstChild.firstChild&&it(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function Yo(t){var e=t.documentElement,r=Ie(e,"dimension");if(r)return r.getAttribute("ref")}function Jo(t){var e=t.documentElement,r=Ie(e,"cellStyleXfs");return r?Pt(r,"xf"):[]}function Qo(t){var e=t.documentElement,r=Ie(e,"cellXfs");return r?Pt(r,"xf"):[]}function es(t){var e=t.documentElement,r=Ie(e,"numFmts");return r?Pt(r,"numFmt"):[]}function ts(t){var e=t.documentElement;return Go(e,"si",function(r){var n=Ie(r,"t");if(n)return n.textContent;var o="";return jt(r,"r",function(s){o+=Ie(s,"t").textContent}),o})}function rs(t){var e=t.documentElement;return Ie(e,"workbookPr")}function ns(t){var e=t.documentElement;return Pt(e,"Relationship")}function os(t){var e=t.documentElement,r=Ie(e,"sheets");return Pt(r,"sheet")}function ss(t,e){var r=e.createDocument(t),n={},o=rs(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(f){f.getAttribute("name")&&n.sheets.push({id:f.getAttribute("sheetId"),name:f.getAttribute("name"),relationId:f.getAttribute("r:id")})};return os(r).forEach(s),n}function is(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var f=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=qt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=qt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=qt(f);break}};return ns(r).forEach(o),n}function qt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function yr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yr(Object(r),!0).forEach(function(n){ls(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ls(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function as(t,e){if(!t)return{};var r=e.createDocument(t),n=Jo(r).map(Kt),o=es(r).map(fs).reduce(function(l,f){return l[f.id]=f,l},[]),s=function(f){return f.hasAttribute("xfId")?kr(kr({},n[f.xfId]),Kt(f,o)):Kt(f,o)};return Qo(r).map(s)}function fs(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function Kt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function us(t,e){return t?ts(e.createDocument(t)):[]}function Dn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function cs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ps(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ps(t,e){if(t){if(typeof t=="string")return Sr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sr(t,e)}}function Sr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $s(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(ms.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&gs(o.numberFormat.template))return!0}}var ms=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],hs=/^\[\$-414\]/,ds=/;@$/;function gs(t){t=t.toLowerCase(),t=t.replace(hs,""),t=t.replace(ds,"");for(var e=t.split(/\W+/),r=cs(e),n;!(n=r()).done;){var o=n.value;if(_s.indexOf(o)<0)return!1}return!0}var _s=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function bs(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,f=r.values,i=r.properties,a=r.options;switch(e||(e="n"),e){case"str":t=Zt(t,a);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Zt(t,a);break;case"s":var u=Number(t);if(isNaN(u))throw new Error('Invalid "shared" string index: '.concat(t));if(u>=f.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=f[u],t=Zt(t,a);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=ws(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,$s(t,s(),l,a)&&(t=Dn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function ws(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Zt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var vs=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function ys(t){var e=function(a,u){return a-u},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],f=n[n.length-1];return[{row:o,column:l},{row:s,column:f}]}function ks(t){for(var e=0,r=0;r<t.length;)e*=26,e+=vs.indexOf(t[r]),r++;return e}function En(t){return t=t.split(/(\d+)/),[parseInt(t[1]),ks(t[0].trim())]}function Ss(t,e,r,n,o,s,l){var f=En(t.getAttribute("r")),i=Zo(e,t),a=i&&i.textContent,u;return t.hasAttribute("t")&&(u=t.getAttribute("t")),{row:f[0],column:f[1],value:bs(a,u,{getInlineStringValue:function(){return Xo(e,t)},getInlineStringXml:function(){return On(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function Ts(t,e,r,n,o,s){var l=Ko(t);return l.length===0?[]:l.map(function(f){return Ss(f,t,e,r,n,o,s)})}function Cs(t,e){return Ds(t)||Os(t,e)||As(t,e)||Ls()}function Ls(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function As(t,e){if(t){if(typeof t=="string")return Tr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tr(t,e)}}function Tr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Os(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function Ds(t){if(Array.isArray(t))return t}function Es(t){var e=Yo(t);if(e)return e=e.split(":").map(En).map(function(r){var n=Cs(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function Ps(t,e,r,n,o,s){var l=e.createDocument(t),f=Ts(l,e,r,n,o,s),i=Es(l)||ys(f);return{cells:f,dimensions:i}}function Ms(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ns(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ns(t,e){if(t){if(typeof t=="string")return Cr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(t,e)}}function Cr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Is(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var f=!0,i=Ms(t[l]),a;!(a=i()).done;){var u=a.value;if(o(u)!==null){f=!1;break}}if(f)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function Fs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Bs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bs(t,e){if(t){if(typeof t=="string")return Lr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lr(t,e)}}function Lr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,f=Fs(t),i;!(i=f()).done;){var a=i.value;if(n(a[s])!==null){l=!1;break}}if(l)for(var u=0;u<t.length;)t[u].splice(s,1),u++;else if(o)break;s--}return t}function js(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Pn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rs(t,e){return Ws(t)||Hs(t,e)||Pn(t,e)||Us()}function Us(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pn(t,e){if(t){if(typeof t=="string")return Ar(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ar(t,e)}}function Ar(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Hs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function Ws(t){if(Array.isArray(t))return t}function zs(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Rs(r,2);o[0];for(var s=o[1],l=s.column,f=s.row,i=new Array(f),a=0;a<f;){i[a]=new Array(l);for(var u=0;u<l;)i[a][u]=null,u++;a++}for(var c=js(n),p;!(p=c()).done;){var d=p.value,k=d.row-1,S=d.column-1;S<l&&k<f&&(i[k][S]=d.value)}var T=e.rowMap;if(T)for(var v=0;v<i.length;)T[v]=v,v++;return i=Is(xs(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:T}),e.transformData&&(i=e.transformData(i)),i}function Vs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Gs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gs(t,e){if(t){if(typeof t=="string")return Or(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Or(t,e)}}function Or(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Dr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function qs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dr(Object(r),!0).forEach(function(n){Ks(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ks(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=qs({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=is(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?us(n(o.sharedStrings),e):[],l=o.styles?as(n(o.styles),e):{},f=ss(n("xl/workbook.xml"),e);if(r.getSheets)return f.sheets.map(function(c){var p=c.name;return{name:p}});var i=Xs(r.sheet,f.sheets);if(!i||!o.sheets[i])throw Ys(r.sheet,f.sheets);var a=Ps(n(o.sheets[i]),e,s,l,f,r),u=zs(a,r);return r.properties?{data:u,properties:f}:u}function Xs(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Vs(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function Ys(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function er(t){"@babel/helpers - typeof";return er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(t)}function Er(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Js(t,e,r){return e&&Er(t.prototype,e),r&&Er(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ei(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}function ti(t){var e=Mn();return function(){var n=At(t),o;if(e){var s=At(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return ri(this,o)}}function ri(t,e){if(e&&(er(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ni(t)}function ni(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tr(t){var e=typeof Map=="function"?new Map:void 0;return tr=function(n){if(n===null||!oi(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Ft(n,arguments,At(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Lt(o,n)},tr(t)}function Ft(t,e,r){return Mn()?Ft=Reflect.construct:Ft=function(o,s,l){var f=[null];f.push.apply(f,s);var i=Function.bind.apply(o,f),a=new i;return l&&Lt(a,l.prototype),a},Ft.apply(null,arguments)}function Mn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oi(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function Lt(t,e){return Lt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Lt(t,e)}function At(t){return At=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},At(t)}var he=function(t){ei(r,t);var e=ti(r);function r(n){var o;return Qs(this,r),o=e.call(this,"invalid"),o.reason=n,o}return Js(r)}(tr(Error));function si(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new he("not_a_number")}if(typeof t!="number")throw new he("not_a_number");if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return t}function ii(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return String(t)}throw new he("not_a_string")}function li(t){if(typeof t=="boolean")return t;throw new he("not_a_boolean")}function ai(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new he("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");var n=Dn(t,r);if(isNaN(n.valueOf()))throw new he("out_of_bounds");return n}throw new he("not_a_date")}function fi(t,e){return pi(t)||ci(t,e)||Nn(t,e)||ui()}function ui(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ci(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function pi(t){if(Array.isArray(t))return t}function rr(t){"@babel/helpers - typeof";return rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(t)}function $i(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Nn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nn(t,e){if(t){if(typeof t=="string")return Pr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pr(t,e)}}function Pr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Nr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mr(Object(r),!0).forEach(function(n){mi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ir={isColumnOriented:!1};function hi(t,e,r){r?r=Nr(Nr({},Ir),r):r=Ir;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;bi(e),o&&(t=_i(t));for(var f=t[0],i=[],a=[],u=1;u<t.length;u++){var c=In(e,t[u],u,f,a,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=$i(a),d;!(d=p()).done;){var k=d.value;k.row=s[k.row-1]+1}return{rows:i,errors:a}}function In(t,e,r,n,o,s){for(var l={},f=!0,i=function(){var p=u[a],d=t[p],k=rr(d.type)==="object"&&!Array.isArray(d.type),S=e[n.indexOf(p)];S===void 0&&(S=null);var T=void 0,v=void 0,C=void 0;if(k)T=In(d.type,e,r,n,o,s);else if(S===null)T=null;else if(Array.isArray(d.type)){var I=!1,E=gi(S).map(function(F){var O=Fr(F,d,s);return O.error&&(T=F,v=O.error,C=O.reason),O.value!==null&&(I=!0),O.value});v||(T=I?E:null)}else{var N=Fr(S,d,s);v=N.error,C=N.reason,T=v?S:N.value}!v&&T===null&&d.required&&(v="required"),v?(v={error:v,row:r+1,column:p,value:T},C&&(v.reason=C),d.type&&(v.type=d.type),o.push(v)):(f&&T!==null&&(f=!1),(T!==null||s.includeNullValues)&&(l[d.prop]=T))},a=0,u=Object.keys(t);a<u.length;a++)i();return f?null:l}function Fr(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=$t(t,e.parse):e.type?n=di(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function $t(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function di(t,e,r){switch(e){case String:return $t(t,ii);case Number:return $t(t,si);case Date:return $t(t,function(n){return ai(n,{properties:r.properties})});case Boolean:return $t(t,li);default:if(typeof e=="function")return $t(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Fn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=Fn(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function gi(t){for(var e=[],r=0;r<t.length;){var n=Fn(t,",",r),o=fi(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var _i=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function bi(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function nr(t){"@babel/helpers - typeof";return nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(t)}function Bn(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;nr(s)==="object"&&(s=Object.keys(t[o])[0],l=Bn(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var wi=["schema","map"];function Br(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function It(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Br(Object(r),!0).forEach(function(n){vi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Br(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yi(t,e){if(t==null)return{};var r=ki(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ki(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Si(t,e,r){var n=r.schema,o=r.map,s=yi(r,wi);!n&&o&&(n=Bn(o));var l=Zs(t,e,It(It({},s),{},{properties:n||s.properties}));return n?hi(l.data,n,It(It({},s),{},{properties:l.properties})):l}function Ti(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return zo(t).then(function(r){return Si(r,Co,e)})}function Ci(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function Li(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await Ti(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=eo(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const V={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Ht=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function Ai(t){let e,r,n,o,s;function l(i){t[3](i)}let f={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(f.value=t[0]),e=new xt({props:f}),R.push(()=>G(e,"value",l)),e.$on("change",t[2]),o=new uo({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};!r&&a&1&&(r=!0,u.value=i[0],q(()=>r=!1)),e.$set(u);const c={};a&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}function Oi(t,e,r){let n;X(t,ee,i=>r(4,n=i));let o="interventionType",s=vr("v1");function l(){let i;o=="interventionType"?(i=wn("v1"),r(1,s=vr("v1"))):(i=hn(["get","funding_programme"],{ATF2:V.atf2,ATF3:V.atf3,ATF4:V.atf4},"grey"),r(1,s=[["ATF2",V.atf2],["ATF3",V.atf3],["ATF4",V.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function f(i){o=i,r(0,o)}return[o,s,l,f]}class Di extends U{constructor(e){super(),H(this,e,Oi,Ai,W,{})}}function Ei(t){let e;return{c(){e=y("Clear")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Pi(t){let e,r,n,o,s,l;return n=new Tt({props:{$$slots:{default:[Ei]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=P("input"),r=L(),_(n.$$.fragment),j(e,"type","text"),j(e,"class","govuk-input govuk-input--width-10"),j(e,"id","filterText")},m(f,i){$(f,e,i),gr(e,t[0]),$(f,r,i),b(n,f,i),o=!0,s||(l=Ut(e,"input",t[12]),s=!0)},p(f,i){i&1&&e.value!==f[0]&&gr(e,f[0]);const a={};i&131072&&(a.$$scope={dirty:i,ctx:f}),n.$set(a)},i(f){o||(h(n.$$.fragment,f),o=!0)},o(f){g(n.$$.fragment,f),o=!1},d(f){f&&(m(e),m(r)),w(n,f),s=!1,l()}}}function Mi(t){let e,r,n,o,s,l,f,i,a,u;function c(S){t[10](S)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new xt({props:p}),R.push(()=>G(e,"value",c));function d(S){t[11](S)}let k={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(k.value=t[3]),o=new xt({props:k}),R.push(()=>G(o,"value",d)),f=new dn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[Pi]},$$scope:{ctx:t}}}),a=new Di({}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment)},m(S,T){b(e,S,T),$(S,n,T),b(o,S,T),$(S,l,T),b(f,S,T),$(S,i,T),b(a,S,T),u=!0},p(S,T){const v={};T&32&&(v.choices=S[5]),!r&&T&4&&(r=!0,v.value=S[2],q(()=>r=!1)),e.$set(v);const C={};T&64&&(C.choices=S[6]),!s&&T&8&&(s=!0,C.value=S[3],q(()=>s=!1)),o.$set(C);const I={};T&131073&&(I.$$scope={dirty:T,ctx:S}),f.$set(I)},i(S){u||(h(e.$$.fragment,S),h(o.$$.fragment,S),h(f.$$.fragment,S),h(a.$$.fragment,S),u=!0)},o(S){g(e.$$.fragment,S),g(o.$$.fragment,S),g(f.$$.fragment,S),g(a.$$.fragment,S),u=!1},d(S){S&&(m(n),m(l),m(i)),w(e,S),w(o,S),w(f,S),w(a,S)}}}function Ni(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,f,i=t[7].area.toLocaleString()+"",a,u,c=t[7].crossing.toLocaleString()+"",p,d,k=t[7].other.toLocaleString()+"",S,T;return{c(){e=y("Showing "),n=y(r),o=y(" schemes ("),l=y(s),f=y(`
    routes, `),a=y(i),u=y(` areas,
    `),p=y(c),d=y(" crossings, "),S=y(k),T=y(`
    other)`)},m(v,C){$(v,e,C),$(v,n,C),$(v,o,C),$(v,l,C),$(v,f,C),$(v,a,C),$(v,u,C),$(v,p,C),$(v,d,C),$(v,S,C),$(v,T,C)},p(v,C){C&2&&r!==(r=v[1].size.toLocaleString()+"")&&Ce(n,r),C&128&&s!==(s=v[7].route.toLocaleString()+"")&&Ce(l,s),C&128&&i!==(i=v[7].area.toLocaleString()+"")&&Ce(a,i),C&128&&c!==(c=v[7].crossing.toLocaleString()+"")&&Ce(p,c),C&128&&k!==(k=v[7].other.toLocaleString()+"")&&Ce(S,k)},d(v){v&&(m(e),m(n),m(o),m(l),m(f),m(a),m(u),m(p),m(d),m(S),m(T))}}}function Ii(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[Ni]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),R.push(()=>G(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){b(e,l,f),n=!0},p(l,f){const i={};f&131202&&(i.$$scope={dirty:f,ctx:l}),!r&&f&16&&(r=!0,i.checked=l[4],q(()=>r=!1)),e.$set(i)},i(l){n||(h(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){w(e,l)}}}function Fi(t){let e,r,n,o;return e=new Se({props:{label:"Filters",$$slots:{default:[Mi]},$$scope:{ctx:t}}}),n=new Dt({props:{small:!0,$$slots:{default:[Ii]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(s,l){b(e,s,l),$(s,r,l),b(n,s,l),o=!0},p(s,[l]){const f={};l&131181&&(f.$$scope={dirty:l,ctx:s}),e.$set(f);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(h(e.$$.fragment,s),h(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&m(r),w(e,s),w(n,s)}}}function Bi(t,e,r){let n,o;X(t,dt,E=>r(15,n=E)),X(t,ee,E=>r(9,o=E));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:f=""}=e,i=[],a="",u=[],c="",p={area:0,route:0,crossing:0,other:0},d=!0;Ot(()=>{let E=new Set,N=new Set;for(let F of s.values())F.authority_or_region&&E.add(F.authority_or_region),F.funding_programme&&N.add(F.funding_programme);r(5,i=Array.from(E.entries())),i.sort(),r(6,u=Array.from(N.entries())),u.sort()});function k(E,N,F){let O=E.toLowerCase(),A=B=>{var Z,ne;if(O&&!((Z=B.properties.name)!=null&&Z.toLowerCase().includes(O))&&!((ne=B.properties.description)!=null&&ne.toLowerCase().includes(O)))return!1;if(N||F){let z=s.get(B.properties.scheme_reference);if(N&&z.authority_or_region!=N||F&&z.funding_programme!=F)return!1}return!0};r(1,l=new Set(n.features.filter(A).map(B=>B.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let M=B=>{var Z,ne;return!(!l.has(B.properties.scheme_reference)||O&&!((Z=B.properties.name)!=null&&Z.toLowerCase().includes(O))&&!((ne=B.properties.description)!=null&&ne.toLowerCase().includes(O)))};dt.update(B=>{for(let Z of B.features)M(Z)?(delete Z.properties.hide_while_editing,r(7,p[Z.properties.intervention_type]++,p)):Z.properties.hide_while_editing=!0;return B}),r(7,p)}function S(E){a=E,r(2,a)}function T(E){c=E,r(3,c)}function v(){f=this.value,r(0,f)}const C=()=>r(0,f="");function I(E){d=E,r(4,d)}return t.$$set=E=>{"schemes"in E&&r(8,s=E.schemes),"schemesToBeShown"in E&&r(1,l=E.schemesToBeShown),"filterText"in E&&r(0,f=E.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let E of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(E)&&o.setLayoutProperty(E,"visibility",d?"visible":"none");t.$$.dirty&13&&k(f,a,c)},[f,l,a,c,d,i,u,p,s,o,S,T,v,C,I]}class xi extends U{constructor(e){super(),H(this,e,Bi,Fi,W,{schemes:8,schemesToBeShown:1,filterText:0})}}function xr(t,e,r){const n=t.slice();return n[11]=e[r],n[12]=e,n[13]=r,n}function ji(t){let e,r;return e=new Tt({props:{$$slots:{default:[Ui]},$$scope:{ctx:t}}}),e.$on("click",t[3]),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&16384&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Ri(t){let e,r;return e=new Tt({props:{$$slots:{default:[Hi]},$$scope:{ctx:t}}}),e.$on("click",t[2]),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&16384&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Ui(t){let e;return{c(){e=y("Disable Line Measurement Tool")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Hi(t){let e;return{c(){e=y("Enable Line Measurement Tool")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function jr(t){let e,r,n,o;e=new Se({props:{label:"Help",$$slots:{default:[Wi]},$$scope:{ctx:t}}});let s=Ne(t[1]),l=[];for(let i=0;i<s.length;i+=1)l[i]=Rr(xr(t,s,i));const f=i=>g(l[i],1,1,()=>{l[i]=null});return{c(){_(e.$$.fragment),r=L();for(let i=0;i<l.length;i+=1)l[i].c();n=_t()},m(i,a){b(e,i,a),$(i,r,a);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(i,a);$(i,n,a),o=!0},p(i,a){const u={};if(a&16384&&(u.$$scope={dirty:a,ctx:i}),e.$set(u),a&2){s=Ne(i[1]);let c;for(c=0;c<s.length;c+=1){const p=xr(i,s,c);l[c]?(l[c].p(p,a),h(l[c],1)):(l[c]=Rr(p),l[c].c(),h(l[c],1),l[c].m(n.parentNode,n))}for(oe(),c=s.length;c<l.length;c+=1)f(c);se()}},i(i){if(!o){h(e.$$.fragment,i);for(let a=0;a<s.length;a+=1)h(l[a]);o=!0}},o(i){g(e.$$.fragment,i),l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)g(l[a]);o=!1},d(i){i&&(m(r),m(n)),w(e,i),Ct(l,i)}}}function Wi(t){let e;return{c(){e=P("ul"),e.innerHTML=`<li><b>Click</b>
        on the map to place a new waypoint</li> <li><b>Click &amp; Drag</b>
        an existing waypoint to move it</li> <li><b>Double click</b>
        an existing waypoint to delete it</li> <li>Press <b>Escape</b>
        to exit this mode</li>`},m(r,n){$(r,e,n)},p:Y,d(r){r&&m(e)}}}function Rr(t){let e,r,n;function o(l){t[4](l,t[11],t[12],t[13])}let s={};return t[11]!==void 0&&(s.markerPosition=t[11]),e=new mo({props:s}),R.push(()=>G(e,"markerPosition",o)),{c(){_(e.$$.fragment)},m(l,f){b(e,l,f),n=!0},p(l,f){t=l;const i={};!r&&f&2&&(r=!0,i.markerPosition=t[11],q(()=>r=!1)),e.$set(i)},i(l){n||(h(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){w(e,l)}}}function zi(t){let e,r,n,o,s;const l=[Ri,ji],f=[];function i(u,c){return u[0]?0:1}e=i(t),r=f[e]=l[e](t);let a=!t[0]&&jr(t);return{c(){r.c(),n=L(),a&&a.c(),o=_t()},m(u,c){f[e].m(u,c),$(u,n,c),a&&a.m(u,c),$(u,o,c),s=!0},p(u,[c]){let p=e;e=i(u),e===p?f[e].p(u,c):(oe(),g(f[p],1,1,()=>{f[p]=null}),se(),r=f[e],r?r.p(u,c):(r=f[e]=l[e](u),r.c()),h(r,1),r.m(n.parentNode,n)),u[0]?a&&(oe(),g(a,1,1,()=>{a=null}),se()):a?(a.p(u,c),c&1&&h(a,1)):(a=jr(u),a.c(),h(a,1),a.m(o.parentNode,o))},i(u){s||(h(r),h(a),s=!0)},o(u){g(r),g(a),s=!1},d(u){u&&(m(n),m(o)),f[e].d(u),a&&a.d(u)}}}function Vi(t,e,r){let n;X(t,ee,k=>r(6,n=k));let o=!0,s=[],l=!1;function f(k){o||(l||(s.push(k.lngLat),r(1,s)),l&&s.length>0&&(console.log("removing?"),i(k.lngLat)))}function i(k){let T=new _r.LngLat(0,-90).distanceTo(new _r.LngLat(0,90)),v;console.log(`clickLocation ${k.lat}, ${k.lng}`),console.log(s),s.forEach(C=>{T>=k.distanceTo(C)&&(v=C,T=k.distanceTo(C),console.log(`waypoint ${C}, ${k.distanceTo(C)}, prev shorted ${T}`))}),console.log(v),v&&r(1,s=s.filter(C=>C.lng!=(v==null?void 0:v.lng)||C.lat!=(v==null?void 0:v.lat))),console.log(s),r(1,s)}function a(){r(0,o=!1),n.on("click",f)}function u(){r(0,o=!0),n.off("click",f)}function c(k){k.key==="Shift"&&(l=!0)}function p(k){k.key==="Shift"&&(l=!1)}Ot(()=>{document.addEventListener("keydown",c),document.addEventListener("keyup",p)}),ar(()=>{document.removeEventListener("keydown",c),document.removeEventListener("keyup",p)});function d(k,S,T,v){T[v]=k,r(1,s)}return[o,s,a,u,d]}class Gi extends U{constructor(e){super(),H(this,e,Vi,zi,W,{})}}function qi(t){let e;return{c(){e=y(`Open Government License
  `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Ki(t){let e,r,n,o,s;return n=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[qi]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("License: "),_(n.$$.fragment),o=y(`. Contains OS data © Crown copyright and database right
  2023.`)},m(l,f){$(l,e,f),D(e,r),b(n,e,null),D(e,o),s=!0},p(l,[f]){const i={};f&1&&(i.$$scope={dirty:f,ctx:l}),n.$set(i)},i(l){s||(h(n.$$.fragment,l),s=!0)},o(l){g(n.$$.fragment,l),s=!1},d(l){l&&m(e),w(n)}}}class Re extends U{constructor(e){super(),H(this,e,null,Ki,W,{})}}function Ur(t,e,r){const n=t.slice();return n[2]=e[r],n}function Hr(t,e,r){const n=t.slice();return n[5]=e[r],n}function Wr(t){let e,r;return{c(){e=P("span"),r=y(` 
    `),je(e,"background",t[5]),je(e,"width","100%"),je(e,"border","1px solid black")},m(n,o){$(n,e,o),D(e,r)},p(n,o){o&1&&je(e,"background",n[5])},d(n){n&&m(e)}}}function zr(t){let e,r=t[2]+"",n;return{c(){e=P("span"),n=y(r)},m(o,s){$(o,e,s),D(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&Ce(n,r)},d(o){o&&m(e)}}}function Zi(t){let e,r,n,o=Ne(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Wr(Hr(t,o,i));let l=Ne(t[1]),f=[];for(let i=0;i<l.length;i+=1)f[i]=zr(Ur(t,l,i));return{c(){e=P("div");for(let i=0;i<s.length;i+=1)s[i].c();r=L(),n=P("div");for(let i=0;i<f.length;i+=1)f[i].c();je(e,"display","flex"),je(n,"display","flex"),je(n,"justify-content","space-between")},m(i,a){$(i,e,a);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);$(i,r,a),$(i,n,a);for(let u=0;u<f.length;u+=1)f[u]&&f[u].m(n,null)},p(i,[a]){if(a&1){o=Ne(i[0]);let u;for(u=0;u<o.length;u+=1){const c=Hr(i,o,u);s[u]?s[u].p(c,a):(s[u]=Wr(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length}if(a&2){l=Ne(i[1]);let u;for(u=0;u<l.length;u+=1){const c=Ur(i,l,u);f[u]?f[u].p(c,a):(f[u]=zr(c),f[u].c(),f[u].m(n,null))}for(;u<f.length;u+=1)f[u].d(1);f.length=l.length}},i:Y,o:Y,d(i){i&&(m(e),m(r),m(n)),Ct(s,i),Ct(f,i)}}}function Xi(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class Ze extends U{constructor(e){super(),H(this,e,Xi,Zi,W,{colorScale:0,limits:1})}}function Yi(t){let e;return{c(){e=y("Percent of households with a car")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Ji(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Qi(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function el(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function tl(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ji]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Qi]},$$scope:{ctx:t}}}),u=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[el]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),f=L(),i=P("p"),a=y("License: "),_(u.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(d,k){$(d,e,k),D(e,r),b(n,e,null),D(e,o),b(s,e,null),D(e,l),$(d,f,k),$(d,i,k),D(i,a),b(u,i,null),D(i,c),p=!0},p(d,k){const S={};k&65536&&(S.$$scope={dirty:k,ctx:d}),n.$set(S);const T={};k&65536&&(T.$$scope={dirty:k,ctx:d}),s.$set(T);const v={};k&65536&&(v.$$scope={dirty:k,ctx:d}),u.$set(v)},i(d){p||(h(n.$$.fragment,d),h(s.$$.fragment,d),h(u.$$.fragment,d),p=!0)},o(d){g(n.$$.fragment,d),g(s.$$.fragment,d),g(u.$$.fragment,d),p=!1},d(d){d&&(m(e),m(f),m(i)),w(n),w(s),w(u)}}}function rl(t){let e,r,n;return r=new re({props:{$$slots:{default:[tl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Vr(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:Y,i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function nl(t){let e;return{c(){e=y("Average cars per household")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function ol(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function sl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function il(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function ll(t){let e,r,n,o,s,l,f,i,a,u,c,p,d,k;return s=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[ol]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[sl]},$$scope:{ctx:t}}}),p=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[il]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=L(),n=P("p"),o=y("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),l=y(". Output area boundaries from "),_(f.$$.fragment),i=y("."),a=L(),u=P("p"),c=y("License: "),_(p.$$.fragment),d=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(S,T){$(S,e,T),$(S,r,T),$(S,n,T),D(n,o),b(s,n,null),D(n,l),b(f,n,null),D(n,i),$(S,a,T),$(S,u,T),D(u,c),b(p,u,null),D(u,d),k=!0},p(S,T){const v={};T&65536&&(v.$$scope={dirty:T,ctx:S}),s.$set(v);const C={};T&65536&&(C.$$scope={dirty:T,ctx:S}),f.$set(C);const I={};T&65536&&(I.$$scope={dirty:T,ctx:S}),p.$set(I)},i(S){k||(h(s.$$.fragment,S),h(f.$$.fragment,S),h(p.$$.fragment,S),k=!0)},o(S){g(s.$$.fragment,S),g(f.$$.fragment,S),g(p.$$.fragment,S),k=!1},d(S){S&&(m(e),m(r),m(n),m(a),m(u)),w(s),w(f),w(p)}}}function al(t){let e,r,n;return r=new re({props:{$$slots:{default:[ll]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Gr(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:Y,i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function fl(t){let e;return{c(){e=y("Population density")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function ul(t){let e;return{c(){e=y(`NOMIS TS006
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function cl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function pl(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[ul]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[cl]},$$scope:{ctx:t}}}),i=new Re({}),{c(){e=P("p"),r=y("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),f=L(),_(i.$$.fragment)},m(u,c){$(u,e,c),D(e,r),b(n,e,null),D(e,o),b(s,e,null),D(e,l),$(u,f,c),b(i,u,c),a=!0},p(u,c){const p={};c&65536&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const d={};c&65536&&(d.$$scope={dirty:c,ctx:u}),s.$set(d)},i(u){a||(h(n.$$.fragment,u),h(s.$$.fragment,u),h(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(m(e),m(f)),w(n),w(s),w(i,u)}}}function $l(t){let e,r,n;return r=new re({props:{$$slots:{default:[pl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function qr(t){let e,r,n,o;return n=new Ze({props:{colorScale:t[4],limits:t[7]().map(hl)}}),{c(){e=P("p"),e.textContent="(people per square kilometres)",r=L(),_(n.$$.fragment)},m(s,l){$(s,e,l),$(s,r,l),b(n,s,l),o=!0},p:Y,i(s){o||(h(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(m(e),m(r)),w(n,s)}}}function ml(t){let e,r,n,o,s,l,f,i,a,u,c,p,d,k;function S(A){t[9](A)}let T={id:"percent_households_with_car",$$slots:{right:[rl],default:[Yi]},$$scope:{ctx:t}};t[0]!==void 0&&(T.checked=t[0]),e=new te({props:T}),R.push(()=>G(e,"checked",S)),e.$on("change",t[10]);let v=t[3]=="percent_households_with_car"&&Vr(t);function C(A){t[11](A)}let I={id:"average_cars_per_household",$$slots:{right:[al],default:[nl]},$$scope:{ctx:t}};t[1]!==void 0&&(I.checked=t[1]),s=new te({props:I}),R.push(()=>G(s,"checked",C)),s.$on("change",t[12]);let E=t[3]=="average_cars_per_household"&&Gr(t);function N(A){t[13](A)}let F={id:"population_density",$$slots:{right:[$l],default:[fl]},$$scope:{ctx:t}};t[2]!==void 0&&(F.checked=t[2]),a=new te({props:F}),R.push(()=>G(a,"checked",N)),a.$on("change",t[14]);let O=t[3]=="population_density"&&qr(t);return d=new Q({props:{layer:Ae,tooltip:t[5],show:t[3]!="",clickable:!0}}),d.$on("click",t[6]),{c(){_(e.$$.fragment),n=L(),v&&v.c(),o=L(),_(s.$$.fragment),f=L(),E&&E.c(),i=L(),_(a.$$.fragment),c=L(),O&&O.c(),p=L(),_(d.$$.fragment)},m(A,M){b(e,A,M),$(A,n,M),v&&v.m(A,M),$(A,o,M),b(s,A,M),$(A,f,M),E&&E.m(A,M),$(A,i,M),b(a,A,M),$(A,c,M),O&&O.m(A,M),$(A,p,M),b(d,A,M),k=!0},p(A,[M]){const B={};M&65536&&(B.$$scope={dirty:M,ctx:A}),!r&&M&1&&(r=!0,B.checked=A[0],q(()=>r=!1)),e.$set(B),A[3]=="percent_households_with_car"?v?(v.p(A,M),M&8&&h(v,1)):(v=Vr(A),v.c(),h(v,1),v.m(o.parentNode,o)):v&&(oe(),g(v,1,1,()=>{v=null}),se());const Z={};M&65536&&(Z.$$scope={dirty:M,ctx:A}),!l&&M&2&&(l=!0,Z.checked=A[1],q(()=>l=!1)),s.$set(Z),A[3]=="average_cars_per_household"?E?(E.p(A,M),M&8&&h(E,1)):(E=Gr(A),E.c(),h(E,1),E.m(i.parentNode,i)):E&&(oe(),g(E,1,1,()=>{E=null}),se());const ne={};M&65536&&(ne.$$scope={dirty:M,ctx:A}),!u&&M&4&&(u=!0,ne.checked=A[2],q(()=>u=!1)),a.$set(ne),A[3]=="population_density"?O?(O.p(A,M),M&8&&h(O,1)):(O=qr(A),O.c(),h(O,1),O.m(p.parentNode,p)):O&&(oe(),g(O,1,1,()=>{O=null}),se());const z={};M&8&&(z.show=A[3]!=""),d.$set(z)},i(A){k||(h(e.$$.fragment,A),h(v),h(s.$$.fragment,A),h(E),h(a.$$.fragment,A),h(O),h(d.$$.fragment,A),k=!0)},o(A){g(e.$$.fragment,A),g(v),g(s.$$.fragment,A),g(E),g(a.$$.fragment,A),g(O),g(d.$$.fragment,A),k=!1},d(A){A&&(m(n),m(o),m(f),m(i),m(c),m(p)),w(e,A),v&&v.d(A),w(s,A),E&&E.d(A),w(a,A),O&&O.d(A),w(d,A)}}}let Ae="census_output_areas";const hl=t=>t.toLocaleString();function dl(t,e,r){let n;X(t,ee,I=>r(8,n=I));let o=`${Ae}-outline`,s=V.sequential_low_to_high,l=!1,f=!1,i=!1,a="";fe(n,Ae,`${ie()}/v1/${Ae}.pmtiles`),Ke(n,{id:Ae,source:Ae,sourceLayer:Ae,color:"black",opacity:ue(.5,.7)}),ge(n,{id:o,source:Ae,sourceLayer:Ae,color:"black",width:.5});function u(I){let E=I.properties.OA21CD,N=I.properties[a];return a=="percent_households_with_car"?`<p>${N}% of households in ${E} have 1 or more cars</p>`:a=="average_cars_per_household"?`<p>Households in ${E} have an average of ${N} cars</p>`:`<p>There are ${N.toLocaleString()} people per square kilometre in ${E}</p>`}function c(I){let E=I.detail.properties.OA21CD;a=="percent_households_with_car"||a=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${E}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${E}`,"_blank")}function p(){return a=="percent_households_with_car"?[0,20,40,60,80,100]:a=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function d(I){l=I,r(0,l)}const k=()=>{r(1,f=!1),r(2,i=!1)};function S(I){f=I,r(1,f)}const T=()=>{r(0,l=!1),r(2,i=!1)};function v(I){i=I,r(2,i)}const C=()=>{r(0,l=!1),r(1,f=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,a="percent_households_with_car"):f?r(3,a="average_cars_per_household"):i?r(3,a="population_density"):r(3,a=""),a?(n.setPaintProperty(Ae,"fill-color",qe(["get",a],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,f,i,a,s,u,c,p,n,d,k,S,T,v,C]}class gl extends U{constructor(e){super(),H(this,e,dl,ml,W,{})}}function _l(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Combined authorities`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function bl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function wl(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[bl]},$$scope:{ctx:t}}}),l=new Re({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of December 2022."),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function vl(t){let e,r,n;return r=new re({props:{$$slots:{default:[wl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function yl(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:We,$$slots:{right:[vl],default:[_l]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:We,tooltip:kl,show:t[0],clickable:!0}}),o.$on("click",Sl),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let We="combined_authorities";function kl(t){return`<p>${t.properties.name}</p>`}function Sl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function Tl(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.combined_authorities,s=`${We}-outline`;fr(n,We,`${ie()}/v1/${We}.geojson`),Ke(n,{id:We,source:We,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:We,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Cl extends U{constructor(e){super(),H(this,e,Tl,yl,W,{})}}function Ll(t){let e;return{c(){e=y("Indices of Multiple Deprivation")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Al(t){let e;return{c(){e=y(`DLUCH GIS
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Ol(t){let e;return{c(){e=y(`here
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Dl(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Al]},$$scope:{ctx:t}}}),s=new x({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Ol]},$$scope:{ctx:t}}}),i=new Re({}),{c(){e=P("p"),r=y("The 2019 English IMD scores come from "),_(n.$$.fragment),o=y(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),l=y("."),f=L(),_(i.$$.fragment)},m(u,c){$(u,e,c),D(e,r),b(n,e,null),D(e,o),b(s,e,null),D(e,l),$(u,f,c),b(i,u,c),a=!0},p(u,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const d={};c&64&&(d.$$scope={dirty:c,ctx:u}),s.$set(d)},i(u){a||(h(n.$$.fragment,u),h(s.$$.fragment,u),h(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(m(e),m(f)),w(n),w(s),w(i,u)}}}function El(t){let e,r,n;return r=new re({props:{$$slots:{default:[Dl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Kr(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:Y,i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Pl(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:Oe,$$slots:{right:[El],default:[Ll]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>G(e,"checked",f));let a=t[0]&&Kr(t);return s=new Q({props:{layer:Oe,tooltip:Ml,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){b(e,u,c),$(u,n,c),a&&a.m(u,c),$(u,o,c),b(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&h(a,1)):(a=Kr(u),a.c(),h(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const d={};c&1&&(d.show=u[0]),s.$set(d)},i(u){l||(h(e.$$.fragment,u),h(a),h(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(m(n),m(o)),w(e,u),a&&a.d(u),w(s,u)}}}let Oe="imd";function Ml(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function Nl(t,e,r){let n;X(t,ee,a=>r(2,n=a));let o=`${Oe}-outline`,s=V.sequential_low_to_high,l=[0,2,4,6,8,10];fe(n,Oe,`${ie()}/v1/${Oe}.pmtiles`),Ke(n,{id:Oe,source:Oe,sourceLayer:Oe,color:qe(["-",10,["get","decile"]],l,s),opacity:ue(.5,.7)}),ge(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});let f=!1;function i(a){f=a,r(0,f)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",f?"visible":"none")},[f,s,n,i]}class Il extends U{constructor(e){super(),H(this,e,Nl,Pl,W,{})}}function Fl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Authority Districts`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function Bl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function xl(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Bl]},$$scope:{ctx:t}}}),l=new Re({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function jl(t){let e,r,n;return r=new re({props:{$$slots:{default:[xl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Rl(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:ze,$$slots:{right:[jl],default:[Fl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:ze,tooltip:Ul,show:t[0],clickable:!0}}),o.$on("click",Hl),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let ze="local_authority_districts";function Ul(t){return`<p>${t.properties.name}</p>`}function Hl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function Wl(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.local_authority_districts,s=`${ze}-outline`;fr(n,ze,`${ie()}/v1/${ze}.geojson`),Ke(n,{id:ze,source:ze,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:ze,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class zl extends U{constructor(e){super(),H(this,e,Wl,Rl,W,{})}}function Vl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Planning Authorities`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function Gl(t){let e;return{c(){e=y(`local authority
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function ql(t){let e;return{c(){e=y(`national park authorit
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Kl(t){let e;return{c(){e=y(`development corporation
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Zl(t){let e;return{c(){e=y("this map")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Xl(t){let e;return{c(){e=y(`planning.data.gov.uk
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Yl(t){let e,r,n,o,s,l,f,i,a,u,c,p,d,k,S,T,v,C,I,E,N,F;return n=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Gl]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[ql]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Kl]},$$scope:{ctx:t}}}),d=new x({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Zl]},$$scope:{ctx:t}}}),C=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Xl]},$$scope:{ctx:t}}}),N=new Re({}),{c(){e=P("p"),r=y("LPAs may be a "),_(n.$$.fragment),o=y(", "),_(s.$$.fragment),l=y("y, or "),_(f.$$.fragment),i=y("."),a=L(),u=P("p"),c=P("strong"),p=y(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_(d.$$.fragment),k=y(" to get more details."),S=L(),T=P("p"),v=y("Data from ONS Geography via "),_(C.$$.fragment),I=y(", as of November 2022."),E=L(),_(N.$$.fragment)},m(O,A){$(O,e,A),D(e,r),b(n,e,null),D(e,o),b(s,e,null),D(e,l),b(f,e,null),D(e,i),$(O,a,A),$(O,u,A),D(u,c),D(c,p),b(d,c,null),D(c,k),$(O,S,A),$(O,T,A),D(T,v),b(C,T,null),D(T,I),$(O,E,A),b(N,O,A),F=!0},p(O,A){const M={};A&32&&(M.$$scope={dirty:A,ctx:O}),n.$set(M);const B={};A&32&&(B.$$scope={dirty:A,ctx:O}),s.$set(B);const Z={};A&32&&(Z.$$scope={dirty:A,ctx:O}),f.$set(Z);const ne={};A&32&&(ne.$$scope={dirty:A,ctx:O}),d.$set(ne);const z={};A&32&&(z.$$scope={dirty:A,ctx:O}),C.$set(z)},i(O){F||(h(n.$$.fragment,O),h(s.$$.fragment,O),h(f.$$.fragment,O),h(d.$$.fragment,O),h(C.$$.fragment,O),h(N.$$.fragment,O),F=!0)},o(O){g(n.$$.fragment,O),g(s.$$.fragment,O),g(f.$$.fragment,O),g(d.$$.fragment,O),g(C.$$.fragment,O),g(N.$$.fragment,O),F=!1},d(O){O&&(m(e),m(a),m(u),m(S),m(T),m(E)),w(n),w(s),w(f),w(d),w(C),w(N,O)}}}function Jl(t){let e,r,n;return r=new re({props:{$$slots:{default:[Yl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Ql(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:De,$$slots:{right:[Jl],default:[Vl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:De,tooltip:ea,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let De="local_planning_authorities";function ea(t){return`<p>${t.properties.name}</p>`}function ta(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.local_planning_authorities,s=`${De}-outline`;fe(n,De,`${ie()}/v1/${De}.pmtiles`),Ke(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:De,sourceLayer:De,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class ra extends U{constructor(e){super(),H(this,e,ta,Ql,W,{})}}function na(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Parliamentary constituencies`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function oa(t){let e;return{c(){e=y(`Ordnance Survey Boundary-Line
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function sa(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[oa]},$$scope:{ctx:t}}}),l=new Re({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function ia(t){let e,r,n;return r=new re({props:{$$slots:{default:[sa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function la(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ee,$$slots:{right:[ia],default:[na]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ee,tooltip:aa,show:t[0],clickable:!0}}),o.$on("click",fa),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let Ee="parliamentary_constituencies";function aa(t){return`<p>${t.properties.Name}</p>`}function fa(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function ua(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.parliamentary_constituencies,s=`${Ee}-outline`;fe(n,Ee,`${ie()}/v1/${Ee}.pmtiles`),Ke(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class ca extends U{constructor(e){super(),H(this,e,ua,la,W,{})}}function pa(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Wards`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function $a(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function ma(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[$a]},$$scope:{ctx:t}}}),l=new Re({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function ha(t){let e,r,n;return r=new re({props:{$$slots:{default:[ma]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function da(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Pe,$$slots:{right:[ha],default:[pa]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Pe,tooltip:ga,show:t[0],clickable:!0}}),o.$on("click",_a),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let Pe="wards";function ga(t){return`<p>${t.properties.name}</p>`}function _a(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function ba(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.wards,s=`${Pe}-outline`;fe(n,Pe,`${ie()}/v1/${Pe}.pmtiles`),Ke(n,{id:Pe,source:Pe,sourceLayer:Pe,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Pe,sourceLayer:Pe,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class wa extends U{constructor(e){super(),H(this,e,ba,da,W,{})}}function va(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function ya(t){let e,r,n,o;return n=new x({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[va]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("License: "),_(n.$$.fragment)},m(s,l){$(s,e,l),D(e,r),b(n,e,null),o=!0},p(s,[l]){const f={};l&1&&(f.$$scope={dirty:l,ctx:s}),n.$set(f)},i(s){o||(h(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&m(e),w(n)}}}class Xe extends U{constructor(e){super(),H(this,e,null,ya,W,{})}}function ka(t){let e,r,n;return e=new _e({props:{color:V.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=y(`
  Bus routes`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function Sa(t){let e;return{c(){e=y(`GTFS
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Ta(t){let e,r,n,o,s,l,f,i,a;return s=new x({props:{href:"https://gtfs.org",$$slots:{default:[Sa]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=P("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=L(),n=P("p"),o=y("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),l=y(`, and doesn't include which routes are run or the
        frequency of service.`),f=L(),_(i.$$.fragment)},m(u,c){$(u,e,c),$(u,r,c),$(u,n,c),D(n,o),b(s,n,null),D(n,l),$(u,f,c),b(i,u,c),a=!0},p(u,c){const p={};c&8&&(p.$$scope={dirty:c,ctx:u}),s.$set(p)},i(u){a||(h(s.$$.fragment,u),h(i.$$.fragment,u),a=!0)},o(u){g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(m(e),m(r),m(n),m(f)),w(s),w(i,u)}}}function Ca(t){let e,r,n;return r=new re({props:{$$slots:{default:[Ta]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function La(t){let e,r,n,o,s;function l(i){t[1](i)}let f={id:Ye,$$slots:{right:[Ca],default:[ka]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ye,tooltip:Aa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&8&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let Ye="bus_routes";function Aa(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Oa(t,e,r){let n;X(t,ee,l=>r(2,n=l)),fe(n,Ye,`${ie()}/v1/${Ye}.pmtiles`),ge(n,{id:Ye,source:Ye,sourceLayer:Ye,color:["case",["boolean",["get","has_bus_lane"],!1],V.bus_route_with_lane,V.bus_route_without_lane],width:5,opacity:ue(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class Da extends U{constructor(e){super(),H(this,e,Oa,La,W,{})}}function Zr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function Ea(t){let e;return{c(){e=y("Cycle paths")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Pa(t){let e,r,n,o,s,l,f,i;return f=new Xe({}),{c(){e=P("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=L(),n=P("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=L(),s=P("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=L(),_(f.$$.fragment)},m(a,u){$(a,e,u),$(a,r,u),$(a,n,u),$(a,o,u),$(a,s,u),$(a,l,u),b(f,a,u),i=!0},p:Y,i(a){i||(h(f.$$.fragment,a),i=!0)},o(a){g(f.$$.fragment,a),i=!1},d(a){a&&(m(e),m(r),m(n),m(o),m(s),m(l)),w(f,a)}}}function Ma(t){let e,r,n;return r=new re({props:{$$slots:{default:[Pa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Xr(t){let e,r,n=Ne(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=Yr(Zr(t,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=_t()},m(l,f){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,f);$(l,e,f),r=!0},p(l,f){if(f&2){n=Ne(l[1]);let i;for(i=0;i<n.length;i+=1){const a=Zr(l,n,i);o[i]?(o[i].p(a,f),h(o[i],1)):(o[i]=Yr(a),o[i].c(),h(o[i],1),o[i].m(e.parentNode,e))}for(oe(),i=n.length;i<o.length;i+=1)s(i);se()}},i(l){if(!r){for(let f=0;f<n.length;f+=1)h(o[f]);r=!0}},o(l){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)g(o[f]);r=!1},d(l){l&&m(e),Ct(o,l)}}}function Yr(t){let e,r,n,o=t[4]+"",s,l,f;return r=new _e({props:{color:t[5]}}),{c(){e=P("div"),_(r.$$.fragment),n=L(),s=y(o),l=L()},m(i,a){$(i,e,a),b(r,e,null),D(e,n),D(e,s),D(e,l),f=!0},p:Y,i(i){f||(h(r.$$.fragment,i),f=!0)},o(i){g(r.$$.fragment,i),f=!1},d(i){i&&m(e),w(r)}}}function Na(t){let e,r,n,o,s,l;function f(u){t[2](u)}let i={id:Je,$$slots:{right:[Ma],default:[Ea]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>G(e,"checked",f));let a=t[0]&&Xr(t);return s=new Q({props:{layer:Je,tooltip:Ia,show:t[0],clickable:!0}}),s.$on("click",Fa),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){b(e,u,c),$(u,n,c),a&&a.m(u,c),$(u,o,c),b(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&h(a,1)):(a=Xr(u),a.c(),h(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const d={};c&1&&(d.show=u[0]),s.$set(d)},i(u){l||(h(e.$$.fragment,u),h(a),h(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(m(n),m(o)),w(e,u),a&&a.d(u),w(s,u)}}}let Je="cycle_paths";function Ia(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Fa(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Ba(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=[["Separated tracks",V.cycle_paths.track],["Unprotected lanes",V.cycle_paths.lane],["Shared-use (segregated)",V.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",V.cycle_paths.shared_use_unsegregated]];fe(n,Je,`${ie()}/v1/${Je}.pmtiles`),ge(n,{id:Je,source:Je,sourceLayer:Je,color:hn(["get","kind"],{track:V.cycle_paths.track,lane:V.cycle_paths.lane,shared_use_segregated:V.cycle_paths.shared_use_segregated,shared_use_unsegregated:V.cycle_paths.shared_use_unsegregated},"red"),width:Ht,opacity:ue(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class xa extends U{constructor(e){super(),H(this,e,Ba,Na,W,{})}}function ja(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Major Road Network`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function Ra(t){let e;return{c(){e=y(`Major Road Network
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Ua(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Ra]},$$scope:{ctx:t}}}),l=new Re({}),{c(){e=P("p"),r=y("Data from the "),_(n.$$.fragment),o=y(", as of September 2021."),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function Ha(t){let e,r,n;return r=new re({props:{$$slots:{default:[Ua]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Wa(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:Qe,$$slots:{right:[Ha],default:[ja]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Qe,tooltip:za,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let Qe="mrn";function za(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Va(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=V.mrn;fe(n,Qe,`${ie()}/v1/${Qe}.pmtiles`),ge(n,{id:Qe,source:Qe,sourceLayer:Qe,color:o,width:7,opacity:ue(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Ga extends U{constructor(e){super(),H(this,e,Va,Wa,W,{})}}function qa(t){let e;return{c(){e=y("Propensity to Cycle Tool")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Ka(t){let e;return{c(){e=y("the PCT website")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Za(t){let e;return{c(){e=y("2017 journal article")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Xa(t){let e,r,n,o,s,l,f,i,a,u,c;return f=new x({props:{href:"https://www.pct.bike",$$slots:{default:[Ka]},$$scope:{ctx:t}}}),a=new x({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[Za]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=L(),n=P("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=L(),s=P("p"),l=y("See "),_(f.$$.fragment),i=y(" and "),_(a.$$.fragment),u=y(" for details on methodology and data sources.")},m(p,d){$(p,e,d),$(p,r,d),$(p,n,d),$(p,o,d),$(p,s,d),D(s,l),b(f,s,null),D(s,i),b(a,s,null),D(s,u),c=!0},p(p,d){const k={};d&2048&&(k.$$scope={dirty:d,ctx:p}),f.$set(k);const S={};d&2048&&(S.$$scope={dirty:d,ctx:p}),a.$set(S)},i(p){c||(h(f.$$.fragment,p),h(a.$$.fragment,p),c=!0)},o(p){g(f.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(m(e),m(r),m(n),m(o),m(s)),w(f),w(a)}}}function Ya(t){let e,r,n;return r=new re({props:{$$slots:{default:[Xa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Jr(t){let e,r,n,o,s,l,f,i;e=new Ze({props:{colorScale:t[3],limits:t[4]}});function a(d){t[8](d)}let u={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(u.value=t[0]),n=new gn({props:u}),R.push(()=>G(n,"value",a)),n.$on("change",t[6]);function c(d){t[9](d)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new xt({props:p}),R.push(()=>G(l,"value",c)),l.$on("change",t[6]),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),s=L(),_(l.$$.fragment)},m(d,k){b(e,d,k),$(d,r,k),b(n,d,k),$(d,s,k),b(l,d,k),i=!0},p(d,k){const S={};!o&&k&1&&(o=!0,S.value=d[0],q(()=>o=!1)),n.$set(S);const T={};!f&&k&2&&(f=!0,T.value=d[1],q(()=>f=!1)),l.$set(T)},i(d){i||(h(e.$$.fragment,d),h(n.$$.fragment,d),h(l.$$.fragment,d),i=!0)},o(d){g(e.$$.fragment,d),g(n.$$.fragment,d),g(l.$$.fragment,d),i=!1},d(d){d&&(m(r),m(s)),w(e,d),w(n,d),w(l,d)}}}function Ja(t){let e,r,n,o,s,l,f,i;function a(p){t[7](p)}let u={id:st,$$slots:{right:[Ya],default:[qa]},$$scope:{ctx:t}};t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),R.push(()=>G(e,"checked",a));let c=t[2]&&Jr(t);return s=new Q({props:{layer:st,tooltip:t[5],show:t[2]&&t[0]==st,clickable:!1}}),f=new Q({props:{layer:Bt,tooltip:t[5],show:t[2]&&t[0]==Bt,clickable:!1}}),{c(){_(e.$$.fragment),n=L(),c&&c.c(),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment)},m(p,d){b(e,p,d),$(p,n,d),c&&c.m(p,d),$(p,o,d),b(s,p,d),$(p,l,d),b(f,p,d),i=!0},p(p,[d]){const k={};d&2048&&(k.$$scope={dirty:d,ctx:p}),!r&&d&4&&(r=!0,k.checked=p[2],q(()=>r=!1)),e.$set(k),p[2]?c?(c.p(p,d),d&4&&h(c,1)):(c=Jr(p),c.c(),h(c,1),c.m(o.parentNode,o)):c&&(oe(),g(c,1,1,()=>{c=null}),se());const S={};d&5&&(S.show=p[2]&&p[0]==st),s.$set(S);const T={};d&5&&(T.show=p[2]&&p[0]==Bt),f.$set(T)},i(p){i||(h(e.$$.fragment,p),h(c),h(s.$$.fragment,p),h(f.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(f.$$.fragment,p),i=!1},d(p){p&&(m(n),m(o),m(l)),w(e,p),c&&c.d(p),w(s,p),w(f,p)}}}let st="pct_commute",Bt="pct_school";function Qa(t,e,r){let n;X(t,ee,k=>r(10,n=k));let o=V.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=st,f="baseline";for(let k of[st,Bt])fe(n,k,`${ie()}/v1/${k}.pmtiles`),ge(n,{id:k,source:k,sourceLayer:k,color:qe(["get",f],s,o),width:Ht,opacity:ue(.5,1)});let i=!1;function a(k){let S=k.properties.baseline,T=k.properties.gov_target,v=k.properties.go_dutch,C=`<h2>Trip purpose: ${l==st?"commuting":"school"}</h2>`;if(C+=`<p>Baseline (2011): <b>${S.toLocaleString()}</b></p>`,S==0)C+=`<p>Government target (2025): <b>${T.toLocaleString()}</b></p>`,C+=`<p>Go Dutch: <b>${v.toLocaleString()}</b></p>`;else{let I=(T/S).toFixed(1),E=(v/S).toFixed(1);C+=`<p>Government target (2025): ${T.toLocaleString()} (<b>${I}x</b> of baseline)</p>`,C+=`<p>Go Dutch: ${v.toLocaleString()} (<b>${E}x</b> of baseline)</p>`}return C}function u(){n.setPaintProperty(l,"line-color",qe(["get",f],s,o))}function c(k){i=k,r(2,i)}function p(k){l=k,r(0,l)}function d(k){f=k,r(1,f)}return[l,f,i,o,s,a,u,c,p,d]}class ef extends U{constructor(e){super(),H(this,e,Qa,Ja,W,{})}}function tf(t){let e;return{c(){e=y("OS Speeds")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function rf(t){let e;return{c(){e=y("Basemap")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function nf(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function of(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[rf]},$$scope:{ctx:t}}}),u=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[nf]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=y(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=L(),l=P("p"),l.textContent="Data valid as of 1 September, 2023",f=L(),i=P("p"),a=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),c=y(".")},m(d,k){$(d,e,k),D(e,r),b(n,e,null),D(e,o),$(d,s,k),$(d,l,k),$(d,f,k),$(d,i,k),D(i,a),b(u,i,null),D(i,c),p=!0},p(d,k){const S={};k&256&&(S.$$scope={dirty:k,ctx:d}),n.$set(S);const T={};k&256&&(T.$$scope={dirty:k,ctx:d}),u.$set(T)},i(d){p||(h(n.$$.fragment,d),h(u.$$.fragment,d),p=!0)},o(d){g(n.$$.fragment,d),g(u.$$.fragment,d),p=!1},d(d){d&&(m(e),m(s),m(l),m(f),m(i)),w(n),w(u)}}}function sf(t){let e,r,n;return r=new re({props:{$$slots:{default:[of]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Qr(t){let e,r,n,o,s;e=new Ze({props:{colorScale:t[2],limits:t[3]}});function l(i){t[6](i)}let f={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(f.value=t[0]),n=new gn({props:f}),R.push(()=>G(n,"value",l)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(i,a){b(e,i,a),$(i,r,a),b(n,i,a),s=!0},p(i,a){const u={};!o&&a&1&&(o=!0,u.value=i[0],q(()=>o=!1)),n.$set(u)},i(i){s||(h(e.$$.fragment,i),h(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&m(r),w(e,i),w(n,i)}}}function lf(t){let e,r,n,o,s,l;function f(u){t[5](u)}let i={id:Ve,$$slots:{right:[sf],default:[tf]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),R.push(()=>G(e,"checked",f));let a=t[1]&&Qr(t);return s=new Q({props:{layer:Ve,tooltip:af,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){b(e,u,c),$(u,n,c),a&&a.m(u,c),$(u,o,c),b(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&2&&(r=!0,p.checked=u[1],q(()=>r=!1)),e.$set(p),u[1]?a?(a.p(u,c),c&2&&h(a,1)):(a=Qr(u),a.c(),h(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const d={};c&2&&(d.show=u[1]),s.$set(d)},i(u){l||(h(e.$$.fragment,u),h(a),h(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(m(n),m(o)),w(e,u),a&&a.d(u),w(s,u)}}}let Ve="road_speeds";function af(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function ff(t,e,r){let n;X(t,ee,c=>r(7,n=c));let o=V.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";fe(n,Ve,`${ur()}/v1/${Ve}.pmtiles`),ge(n,{id:Ve,source:Ve,sourceLayer:Ve,color:qe(["get",l],s,o),width:Ht,opacity:ue(.5,1)});let f=!1;function i(){n.setPaintProperty(Ve,"line-color",qe(["get",l],s,o))}function a(c){f=c,r(1,f)}function u(c){l=c,r(0,l)}return[l,f,o,s,i,a,u]}class uf extends U{constructor(e){super(),H(this,e,ff,lf,W,{})}}function cf(t){let e;return{c(){e=y("OS Road widths")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function pf(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function $f(t){let e,r,n,o,s,l,f,i,a;return f=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[pf]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=L(),n=P("p"),n.textContent="Data valid as of 1 September, 2023",o=L(),s=P("p"),l=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(f.$$.fragment),i=y(".")},m(u,c){$(u,e,c),$(u,r,c),$(u,n,c),$(u,o,c),$(u,s,c),D(s,l),b(f,s,null),D(s,i),a=!0},p(u,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),f.$set(p)},i(u){a||(h(f.$$.fragment,u),a=!0)},o(u){g(f.$$.fragment,u),a=!1},d(u){u&&(m(e),m(r),m(n),m(o),m(s)),w(f)}}}function mf(t){let e,r,n;return r=new re({props:{$$slots:{default:[$f]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function en(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:Y,i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function hf(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:et,$$slots:{right:[mf],default:[cf]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>G(e,"checked",f));let a=t[0]&&en(t);return s=new Q({props:{layer:et,tooltip:df,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){b(e,u,c),$(u,n,c),a&&a.m(u,c),$(u,o,c),b(s,u,c),l=!0},p(u,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&h(a,1)):(a=en(u),a.c(),h(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const d={};c&1&&(d.show=u[0]),s.$set(d)},i(u){l||(h(e.$$.fragment,u),h(a),h(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(m(n),m(o)),w(e,u),a&&a.d(u),w(s,u)}}}let et="road_widths";function df(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function gf(t,e,r){let n;X(t,ee,i=>r(4,n=i));let o=V.sequential_low_to_high,s=[0,5,10,15,20,100];fe(n,et,`${ur()}/v1/${et}.pmtiles`),ge(n,{id:et,source:et,sourceLayer:et,color:qe(["get","average"],s,o),width:Ht,opacity:ue(.5,1)});let l=!1;function f(i){l=i,r(0,l)}return[l,o,s,f]}class _f extends U{constructor(e){super(),H(this,e,gf,hf,W,{})}}function bf(t){let e,r,n;return{c(){e=P("input"),j(e,"class","govuk-file-upload"),j(e,"id","load-criticals"),j(e,"type","file")},m(o,s){$(o,e,s),t[7](e),r||(n=Ut(e,"change",t[4]),r=!0)},p:Y,d(o){o&&m(e),t[7](null),r=!1,n()}}}function tn(t){let e,r;return e=new Dt({props:{small:!0,$$slots:{default:[vf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function wf(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new _e({props:{color:or}}),{c(){_(e.$$.fragment),r=y(`
        Show `),o=y(n),s=y(" issues")},m(f,i){b(e,f,i),$(f,r,i),$(f,o,i),$(f,s,i),l=!0},p(f,i){(!l||i&4)&&n!==(n=f[2].toLocaleString()+"")&&Ce(o,n)},i(f){l||(h(e.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),l=!1},d(f){f&&(m(r),m(o),m(s)),w(e,f)}}}function vf(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[wf]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),R.push(()=>G(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){b(e,l,f),n=!0},p(l,f){const i={};f&516&&(i.$$scope={dirty:f,ctx:l}),!r&&f&1&&(r=!0,i.checked=l[0],q(()=>r=!1)),e.$set(i)},i(l){n||(h(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){w(e,l)}}}function yf(t){let e,r,n,o,s,l;e=new dn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[bf]},$$scope:{ctx:t}}}),n=new bn({props:{errorMessage:t[3]}});let f=t[2]>0&&tn(t);return{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),f&&f.c(),s=_t()},m(i,a){b(e,i,a),$(i,r,a),b(n,i,a),$(i,o,a),f&&f.m(i,a),$(i,s,a),l=!0},p(i,a){const u={};a&514&&(u.$$scope={dirty:a,ctx:i}),e.$set(u);const c={};a&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?f?(f.p(i,a),a&4&&h(f,1)):(f=tn(i),f.c(),h(f,1),f.m(s.parentNode,s)):f&&(oe(),g(f,1,1,()=>{f=null}),se())},i(i){l||(h(e.$$.fragment,i),h(n.$$.fragment,i),h(f),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(f),l=!1},d(i){i&&(m(r),m(o),m(s)),w(e,i),w(n,i),f&&f.d(i)}}}function kf(t){let e,r,n,o,s,l;return e=new Se({props:{label:"Critical Issues",$$slots:{default:[yf]},$$scope:{ctx:t}}}),n=new Q({props:{layer:le+"-points",tooltip:Sf,show:t[0],clickable:!1}}),s=new Q({props:{layer:le+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[le+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment)},m(f,i){b(e,f,i),$(f,r,i),b(n,f,i),$(f,o,i),b(s,f,i),l=!0},p(f,[i]){const a={};i&527&&(a.$$scope={dirty:i,ctx:f}),e.$set(a);const u={};i&1&&(u.show=f[0]),n.$set(u);const c={};i&1&&(c.show=f[0]),s.$set(c)},i(f){l||(h(e.$$.fragment,f),h(n.$$.fragment,f),h(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),l=!1},d(f){f&&(m(r),m(o)),w(e,f),w(n,f),w(s,f)}}}let le="criticals",or="red";function Sf(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function Tf(t,e,r){let n;X(t,ee,p=>r(6,n=p));let o,s=!0,l=0,f="";to(n,le),n.addSource(le,{type:"geojson",data:_n(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),gt(n,{id:`${le}-clusters`,source:le,filter:["has","point_count"],color:or,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${le}-counts`,source:le,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),gt(n,{id:`${le}-points`,source:le,filter:["!",["has","point_count"]],color:or,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let d=await Li(o.files[0]);n.getSource(le).setData(d),r(2,l=d.features.length),r(3,f="")}catch(d){r(3,f=`The file you loaded is broken: ${d}`)}}function a(p){n.getSource(le).getClusterExpansionZoom(p.detail.properties.cluster_id,(d,k)=>{d||n.easeTo({center:p.detail.geometry.coordinates,zoom:k})})}function u(p){R[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${le}-counts`)&&n.setLayoutProperty(`${le}-counts`,"visibility",s?"visible":"none")},[s,o,l,f,i,a,n,u,c]}class Cf extends U{constructor(e){super(),H(this,e,Tf,kf,W,{})}}function Lf(t){let e,r,n;return e=new _e({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=y(`
  Crossings`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function Af(t){let e;return{c(){e=y("crossing")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Of(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[Af]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function Df(t){let e,r,n;return r=new re({props:{$$slots:{default:[Of]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Ef(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ge,$$slots:{right:[Df],default:[Lf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ge,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",Pf),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}const Ge="crossings";function Pf(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function Mf(t,e,r){let n;X(t,ee,a=>r(4,n=a));let o=!1;function s(a){const u=a.properties.crossing;return`<p>${l.get(u)??`Crossing with unknown type (${u})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);fe(n,Ge,`${ie()}/v1/${Ge}.pmtiles`);let f=V[Ge];gt(n,{id:Ge,source:Ge,sourceLayer:Ge,color:f,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(a){o=a,r(0,o)}return[o,s,f,i]}class Nf extends U{constructor(e){super(),H(this,e,Mf,Ef,W,{})}}function If(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Cycle parking`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function Ff(t){let e;return{c(){e=y("OpenStreetMap")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Bf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Ff]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("Cycle parking, according to "),_(n.$$.fragment),o=y(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function xf(t){let e,r,n;return r=new re({props:{$$slots:{default:[Bf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function jf(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:tt,$$slots:{right:[xf],default:[If]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:tt,tooltip:Rf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}let tt="cycle_parking";function Rf(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function Uf(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=V.cycle_parking;fe(n,tt,`${ie()}/v1/${tt}.pmtiles`),gt(n,{id:tt,source:tt,sourceLayer:tt,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Hf extends U{constructor(e){super(),H(this,e,Uf,jf,W,{})}}function Wf(t){let e,r,n,o;return e=new _e({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=L(),n=y(t[1])},m(s,l){b(e,s,l),$(s,r,l),$(s,n,l),o=!0},p(s,l){(!o||l&2)&&Ce(n,s[1])},i(s){o||(h(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(m(r),m(n)),w(e,s)}}}function zf(t){let e;const r=t[6].default,n=cn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&pn(n,r,o,o[8],e?mn(r,o[8],s,null):$n(o[8]),null)},i(o){e||(h(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Vf(t){let e,r,n;return r=new re({props:{$$slots:{default:[zf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function Gf(t){let e,r,n,o,s;function l(i){t[7](i)}let f={id:t[0],$$slots:{right:[Vf],default:[Wf]},$$scope:{ctx:t}};return t[2]!==void 0&&(f.checked=t[2]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&1&&(u.id=i[0]),a&258&&(u.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,u.checked=i[2],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.layer=i[0]),a&4&&(c.show=i[2]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}function qf(t,e,r){let n;X(t,ee,d=>r(9,n=d));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:f}=e,{pluralNoun:i}=e,a=V[l];fe(n,l,`${ie()}/v1/${l}.pmtiles`),Ke(n,{id:l,source:l,sourceLayer:l,color:a,opacity:ue(1,.7)});let u=!1;function c(d){return`<p>${d.properties.name??`Unnamed ${f}`}</p>`}function p(d){u=d,r(2,u)}return t.$$set=d=>{"name"in d&&r(0,l=d.name),"singularNoun"in d&&r(5,f=d.singularNoun),"pluralNoun"in d&&r(1,i=d.pluralNoun),"$$scope"in d&&r(8,s=d.$$scope)},[l,i,u,a,c,f,o,p,s]}class pr extends U{constructor(e){super(),H(this,e,qf,Gf,W,{name:0,singularNoun:5,pluralNoun:1})}}function Kf(t){let e;return{c(){e=y("hospital")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Zf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[Kf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function Xf(t){let e,r;return e=new pr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Zf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}class Yf extends U{constructor(e){super(),H(this,e,null,Xf,W,{})}}function Jf(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Railway Stations`)},m(o,s){b(e,o,s),$(o,r,s),n=!0},p:Y,i(o){n||(h(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&m(r),w(e,o)}}}function Qf(t){let e;return{c(){e=y("railway station")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function eu(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[Qf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function tu(t){let e,r,n;return r=new re({props:{$$slots:{default:[eu]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function ru(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:rt,$$slots:{right:[tu],default:[Jf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>G(e,"checked",l)),o=new Q({props:{layer:rt,tooltip:nu,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),w(e,i),w(o,i)}}}const rt="railway_stations";function nu(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function ou(t,e,r){let n;X(t,ee,i=>r(3,n=i));const o=`${ie()}/v1/${rt}.geojson`;let s=!1;fr(n,rt,o);let l=V[rt];gt(n,{id:rt,source:rt,color:l,radius:io/2});function f(i){s=i,r(0,s)}return[s,l,f]}class su extends U{constructor(e){super(),H(this,e,ou,ru,W,{})}}function iu(t){let e;return{c(){e=y("primary and secondary schools")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function lu(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[iu]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=L(),_(l.$$.fragment)},m(i,a){$(i,e,a),D(e,r),b(n,e,null),D(e,o),$(i,s,a),b(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(h(n.$$.fragment,i),h(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(m(e),m(s)),w(n),w(l,i)}}}function au(t){let e,r;return e=new pr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[lu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}class fu extends U{constructor(e){super(),H(this,e,null,au,W,{})}}function uu(t){let e;return{c(){e=y("sports pitches")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function cu(t){let e;return{c(){e=y("sports centres")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function pu(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[uu]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[cu]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(" and "),_(s.$$.fragment),l=y(" data from OpenStreetMap (as of 9 August 2023)."),f=L(),_(i.$$.fragment)},m(u,c){$(u,e,c),D(e,r),b(n,e,null),D(e,o),b(s,e,null),D(e,l),$(u,f,c),b(i,u,c),a=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const d={};c&1&&(d.$$scope={dirty:c,ctx:u}),s.$set(d)},i(u){a||(h(n.$$.fragment,u),h(s.$$.fragment,u),h(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(m(e),m(f)),w(n),w(s),w(i,u)}}}function $u(t){let e,r;return e=new pr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[pu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}class mu extends U{constructor(e){super(),H(this,e,null,$u,W,{})}}function hu(t){let e;return{c(){e=y("Vehicle counts")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function du(t){let e;return{c(){e=y(`DfT road statistics
        `)},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function gu(t){let e;return{c(){e=y("methodology")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function _u(t){let e,r,n,o,s,l,f,i,a,u,c;return n=new x({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[du]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[gu]},$$scope:{ctx:t}}}),u=new Re({}),{c(){e=P("p"),r=y("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=y(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),l=y(" for details and caveats about the measurements."),f=L(),i=P("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,a=L(),_(u.$$.fragment)},m(p,d){$(p,e,d),D(e,r),b(n,e,null),D(e,o),b(s,e,null),D(e,l),$(p,f,d),$(p,i,d),$(p,a,d),b(u,p,d),c=!0},p(p,d){const k={};d&64&&(k.$$scope={dirty:d,ctx:p}),n.$set(k);const S={};d&64&&(S.$$scope={dirty:d,ctx:p}),s.$set(S)},i(p){c||(h(n.$$.fragment,p),h(s.$$.fragment,p),h(u.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(m(e),m(f),m(i),m(a)),w(n),w(s),w(u,p)}}}function bu(t){let e,r,n;return r=new re({props:{$$slots:{default:[_u]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){$(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(h(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&m(e),w(r)}}}function rn(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:Y,i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function wu(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:nt,$$slots:{right:[bu],default:[hu]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>G(e,"checked",f));let a=t[0]&&rn(t);return s=new Q({props:{layer:nt,tooltip:vu,show:t[0],clickable:!0}}),s.$on("click",yu),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){b(e,u,c),$(u,n,c),a&&a.m(u,c),$(u,o,c),b(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&h(a,1)):(a=rn(u),a.c(),h(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const d={};c&1&&(d.show=u[0]),s.$set(d)},i(u){l||(h(e.$$.fragment,u),h(a),h(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(m(n),m(o)),w(e,u),a&&a.d(u),w(s,u)}}}let nt="vehicle_counts";function vu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function yu(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function ku(t,e,r){let n;X(t,ee,a=>r(4,n=a));let o=V.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];fe(n,nt,`${ie()}/v1/${nt}.pmtiles`),gt(n,{id:nt,source:nt,sourceLayer:nt,color:qe(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let f=!1;function i(a){f=a,r(0,f)}return[f,o,l,i]}class Su extends U{constructor(e){super(),H(this,e,ku,wu,W,{})}}function Tu(t){let e,r,n,o,s,l,f,i;return e=new fu({}),n=new Yf({}),s=new mu({}),f=new su({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment)},m(a,u){b(e,a,u),$(a,r,u),b(n,a,u),$(a,o,u),b(s,a,u),$(a,l,u),b(f,a,u),i=!0},i(a){i||(h(e.$$.fragment,a),h(n.$$.fragment,a),h(s.$$.fragment,a),h(f.$$.fragment,a),i=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(s.$$.fragment,a),g(f.$$.fragment,a),i=!1},d(a){a&&(m(r),m(o),m(l)),w(e,a),w(n,a),w(s,a),w(f,a)}}}function Cu(t){let e,r;return e=new Dt({props:{small:!0,$$slots:{default:[Tu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Lu(t){let e,r,n,o,s,l,f,i,a,u;return e=new xa({}),n=new Ga({}),s=new Da({}),f=new Hf({}),a=new Nf({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment)},m(c,p){b(e,c,p),$(c,r,p),b(n,c,p),$(c,o,p),b(s,c,p),$(c,l,p),b(f,c,p),$(c,i,p),b(a,c,p),u=!0},i(c){u||(h(e.$$.fragment,c),h(n.$$.fragment,c),h(s.$$.fragment,c),h(f.$$.fragment,c),h(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(m(r),m(o),m(l),m(i)),w(e,c),w(n,c),w(s,c),w(f,c),w(a,c)}}}function Au(t){let e,r;return e=new Dt({props:{small:!0,$$slots:{default:[Lu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Ou(t){let e,r,n,o,s,l,f,i,a,u;return e=new ca({}),n=new wa({}),s=new Cl({}),f=new zl({}),a=new ra({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment)},m(c,p){b(e,c,p),$(c,r,p),b(n,c,p),$(c,o,p),b(s,c,p),$(c,l,p),b(f,c,p),$(c,i,p),b(a,c,p),u=!0},i(c){u||(h(e.$$.fragment,c),h(n.$$.fragment,c),h(s.$$.fragment,c),h(f.$$.fragment,c),h(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(m(r),m(o),m(l),m(i)),w(e,c),w(n,c),w(s,c),w(f,c),w(a,c)}}}function Du(t){let e,r;return e=new Dt({props:{small:!0,$$slots:{default:[Ou]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Eu(t){let e,r,n,o;return e=new gl({}),n=new Il({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(s,l){b(e,s,l),$(s,r,l),b(n,s,l),o=!0},i(s){o||(h(e.$$.fragment,s),h(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&m(r),w(e,s),w(n,s)}}}function Pu(t){let e,r,n,o;return e=new _f({}),n=new uf({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(s,l){b(e,s,l),$(s,r,l),b(n,s,l),o=!0},i(s){o||(h(e.$$.fragment,s),h(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&m(r),w(e,s),w(n,s)}}}function Mu(t){let e,r,n,o,s=lr()=="Private (development)",l,f;e=new Su({}),n=new ef({});let i=s&&Pu();return{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),i&&i.c(),l=_t()},m(a,u){b(e,a,u),$(a,r,u),b(n,a,u),$(a,o,u),i&&i.m(a,u),$(a,l,u),f=!0},p:Y,i(a){f||(h(e.$$.fragment,a),h(n.$$.fragment,a),h(i),f=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(i),f=!1},d(a){a&&(m(r),m(o),m(l)),w(e,a),w(n,a),i&&i.d(a)}}}function Nu(t){let e,r,n,o,s;function l(i){t[5](i)}let f={displayEnableButton:!0};return t[2]!==void 0&&(f.isInactive=t[2]),e=new lo({props:f}),t[4](e),R.push(()=>G(e,"isInactive",l)),o=new Gi({}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){b(e,i,a),$(i,n,a),b(o,i,a),s=!0},p(i,a){const u={};!r&&a&4&&(r=!0,u.isInactive=i[2],q(()=>r=!1)),e.$set(u)},i(i){s||(h(e.$$.fragment,i),h(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&m(n),t[4](null),w(e,i),w(o,i)}}}function Iu(t){let e,r,n,o,s,l,f,i,a,u,c,p,d,k,S,T;return e=new Cf({}),n=new Se({props:{label:"Trip generators",$$slots:{default:[Cu]},$$scope:{ctx:t}}}),s=new Se({props:{label:"Existing infrastructure",$$slots:{default:[Au]},$$scope:{ctx:t}}}),f=new Se({props:{label:"Boundaries",$$slots:{default:[Du]},$$scope:{ctx:t}}}),a=new Se({props:{label:"Census",$$slots:{default:[Eu]},$$scope:{ctx:t}}}),c=new Se({props:{label:"Other",$$slots:{default:[Mu]},$$scope:{ctx:t}}}),d=new Se({props:{label:"Tools",$$slots:{default:[Nu]},$$scope:{ctx:t}}}),S=new co({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment),u=L(),_(c.$$.fragment),p=L(),_(d.$$.fragment),k=L(),_(S.$$.fragment)},m(v,C){b(e,v,C),$(v,r,C),b(n,v,C),$(v,o,C),b(s,v,C),$(v,l,C),b(f,v,C),$(v,i,C),b(a,v,C),$(v,u,C),b(c,v,C),$(v,p,C),b(d,v,C),$(v,k,C),b(S,v,C),T=!0},p(v,C){const I={};C&64&&(I.$$scope={dirty:C,ctx:v}),n.$set(I);const E={};C&64&&(E.$$scope={dirty:C,ctx:v}),s.$set(E);const N={};C&64&&(N.$$scope={dirty:C,ctx:v}),f.$set(N);const F={};C&64&&(F.$$scope={dirty:C,ctx:v}),a.$set(F);const O={};C&64&&(O.$$scope={dirty:C,ctx:v}),c.$set(O);const A={};C&70&&(A.$$scope={dirty:C,ctx:v}),d.$set(A);const M={};C&1&&(M.style=v[0]),S.$set(M)},i(v){T||(h(e.$$.fragment,v),h(n.$$.fragment,v),h(s.$$.fragment,v),h(f.$$.fragment,v),h(a.$$.fragment,v),h(c.$$.fragment,v),h(d.$$.fragment,v),h(S.$$.fragment,v),T=!0)},o(v){g(e.$$.fragment,v),g(n.$$.fragment,v),g(s.$$.fragment,v),g(f.$$.fragment,v),g(a.$$.fragment,v),g(c.$$.fragment,v),g(d.$$.fragment,v),g(S.$$.fragment,v),T=!1},d(v){v&&(m(r),m(o),m(l),m(i),m(u),m(p),m(k)),w(e,v),w(n,v),w(s,v),w(f,v),w(a,v),w(c,v),w(d,v),w(S,v)}}}function Fu(t){let e,r,n,o;return e=new Se({props:{label:"Layers",open:!0,$$slots:{default:[Iu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,l){b(e,s,l),r=!0,n||(o=Ut(window,"keydown",t[3]),n=!0)},p(s,[l]){const f={};l&71&&(f.$$scope={dirty:l,ctx:s}),e.$set(f)},i(s){r||(h(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){w(e,s),n=!1,o()}}}function Bu(t,e,r){let n;X(t,br,a=>r(2,n=a));let{style:o}=e,s;function l(a){!n&&a.key=="Escape"&&(s.disableStreetView(),a.preventDefault())}function f(a){R[a?"unshift":"push"](()=>{s=a,r(1,s)})}function i(a){n=a,br.set(n)}return t.$$set=a=>{"style"in a&&r(0,o=a.style)},[o,s,n,l,f,i]}class xu extends U{constructor(e){super(),H(this,e,Bu,Fu,W,{style:0})}}function ju(t,e,r){let{loadFile:n}=e;return Ot(async()=>{let s=await(await fetch(`${ur()}/v1/random_schemes.geojson`)).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class Ru extends U{constructor(e){super(),H(this,e,ju,null,W,{loadFile:0})}}function Uu(t){let e;return{c(){e=y("Show on map")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Hu(t){let e;return{c(){e=y("Edit scheme locally")},m(r,n){$(r,e,n)},d(r){r&&m(e)}}}function Wu(t){let e,r,n=t[0].authority_or_region+"",o,s,l,f,i=t[0].capital_scheme_id+"",a,u,c,p,d=t[0].funding_programme+"",k,S,T,v,C,I,E;return v=new Tt({props:{$$slots:{default:[Uu]},$$scope:{ctx:t}}}),v.$on("click",t[3]),I=new Tt({props:{disabled:t[1],title:t[2],$$slots:{default:[Hu]},$$scope:{ctx:t}}}),I.$on("click",t[4]),{c(){e=P("p"),r=y("Authority or region: "),o=y(n),s=L(),l=P("p"),f=y("Capital scheme ID: "),a=y(i),u=L(),c=P("p"),p=y("Funding programme: "),k=y(d),S=L(),T=P("div"),_(v.$$.fragment),C=L(),_(I.$$.fragment),j(T,"class","govuk-button-group")},m(N,F){$(N,e,F),D(e,r),D(e,o),$(N,s,F),$(N,l,F),D(l,f),D(l,a),$(N,u,F),$(N,c,F),D(c,p),D(c,k),$(N,S,F),$(N,T,F),b(v,T,null),D(T,C),b(I,T,null),E=!0},p(N,F){(!E||F&1)&&n!==(n=N[0].authority_or_region+"")&&Ce(o,n),(!E||F&1)&&i!==(i=N[0].capital_scheme_id+"")&&Ce(a,i),(!E||F&1)&&d!==(d=N[0].funding_programme+"")&&Ce(k,d);const O={};F&256&&(O.$$scope={dirty:F,ctx:N}),v.$set(O);const A={};F&256&&(A.$$scope={dirty:F,ctx:N}),I.$set(A)},i(N){E||(h(v.$$.fragment,N),h(I.$$.fragment,N),E=!0)},o(N){g(v.$$.fragment,N),g(I.$$.fragment,N),E=!1},d(N){N&&(m(e),m(s),m(l),m(u),m(c),m(S),m(T)),w(v),w(I)}}}function zu(t){let e,r;return e=new Se({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Wu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Vu(t,e,r){let n,o;X(t,dt,c=>r(6,n=c)),X(t,ee,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,f=!l.has(s.authority_or_region),i=f?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function a(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(ro(c),{padding:20,animate:!1})}function u(){let c={type:"FeatureCollection",features:n.features.filter(d=>d.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,f,i,a,u,l]}class Gu extends U{constructor(e){super(),H(this,e,Vu,zu,W,{scheme:0,authorityNames:5})}}const qu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ae=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{f(r.next(i))}catch(a){o(a)}},l=i=>{try{f(r.throw(i))}catch(a){o(a)}},f=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);f((r=r.apply(t,e)).next())}),de=Uint8Array,mt=Uint16Array,Ku=Int32Array,xn=new de([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),jn=new de([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Zu=new de([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Rn=function(t,e){for(var r=new mt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new Ku(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},Un=Rn(xn,2),Hn=Un.b,Xu=Un.r;Hn[28]=258,Xu[258]=28;var Yu=Rn(jn,0),Ju=Yu.b,sr=new mt(32768);for(K=0;K<32768;++K)xe=(K&43690)>>1|(K&21845)<<1,xe=(xe&52428)>>2|(xe&13107)<<2,xe=(xe&61680)>>4|(xe&3855)<<4,sr[K]=((xe&65280)>>8|(xe&255)<<8)>>1;var xe,K,St=function(t,e,r){for(var n=t.length,o=0,s=new mt(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new mt(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new mt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[sr[c]>>i]=a}else for(f=new mt(n),o=0;o<n;++o)t[o]&&(f[o]=sr[l[t[o]-1]++]>>15-t[o]);return f},Mt=new de(288);for(K=0;K<144;++K)Mt[K]=8;var K;for(K=144;K<256;++K)Mt[K]=9;var K;for(K=256;K<280;++K)Mt[K]=7;var K;for(K=280;K<288;++K)Mt[K]=8;var K,Wn=new de(32);for(K=0;K<32;++K)Wn[K]=5;var K,Qu=St(Mt,9,1),ec=St(Wn,5,1),Xt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Yt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},tc=function(t){return(t+7)/8|0},rc=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new de(r-e);return n.set(t.subarray(e,r)),n},nc=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$e=function(t,e,r){var n=new Error(e||nc[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,$e),!r)throw n;return n},$r=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new de(0);var l=!r||e.i!=2,f=e.i;r||(r=new de(o*3));var i=function(mr){var hr=r.length;if(mr>hr){var dr=new de(Math.max(hr*2,mr));dr.set(r),r=dr}},a=e.f||0,u=e.p||0,c=e.b||0,p=e.l,d=e.d,k=e.m,S=e.n,T=o*8;do{if(!p){a=ve(t,u,1);var v=ve(t,u+1,3);if(u+=3,v)if(v==1)p=Qu,d=ec,k=9,S=5;else if(v==2){var N=ve(t,u,31)+257,F=ve(t,u+10,15)+4,O=N+ve(t,u+5,31)+1;u+=14;for(var A=new de(O),M=new de(19),B=0;B<F;++B)M[Zu[B]]=ve(t,u+B*3,7);u+=F*3;for(var Z=Xt(M),ne=(1<<Z)-1,z=St(M,Z,1),B=0;B<O;){var Le=z[ve(t,u,ne)];u+=Le&15;var C=Le>>4;if(C<16)A[B++]=C;else{var Fe=0,ce=0;for(C==16?(ce=3+ve(t,u,3),u+=2,Fe=A[B-1]):C==17?(ce=3+ve(t,u,7),u+=3):C==18&&(ce=11+ve(t,u,127),u+=7);ce--;)A[B++]=Fe}}var Nt=A.subarray(0,N),pe=A.subarray(N);k=Xt(Nt),S=Xt(pe),p=St(Nt,k,1),d=St(pe,S,1)}else $e(1);else{var C=tc(u)+4,I=t[C-4]|t[C-3]<<8,E=C+I;if(E>o){f&&$e(0);break}l&&i(c+I),r.set(t.subarray(C,E),c),e.b=c+=I,e.p=u=E*8,e.f=a;continue}if(u>T){f&&$e(0);break}}l&&i(c+131072);for(var bt=(1<<k)-1,Ue=(1<<S)-1,lt=u;;lt=u){var Fe=p[Yt(t,u)&bt],be=Fe>>4;if(u+=Fe&15,u>T){f&&$e(0);break}if(Fe||$e(2),be<256)r[c++]=be;else if(be==256){lt=u,p=null;break}else{var at=be-254;if(be>264){var B=be-257,Be=xn[B];at=ve(t,u,(1<<Be)-1)+Hn[B],u+=Be}var ft=d[Yt(t,u)&Ue],ut=ft>>4;ft||$e(3),u+=ft&15;var pe=Ju[ut];if(ut>3){var Be=jn[ut];pe+=Yt(t,u)&(1<<Be)-1,u+=Be}if(u>T){f&&$e(0);break}l&&i(c+131072);var ct=c+at;if(c<pe){var wt=s-pe,Yn=Math.min(pe,ct);for(wt+c<0&&$e(3);c<Yn;++c)r[c]=n[wt+c]}for(;c<ct;c+=4)r[c]=r[c-pe],r[c+1]=r[c+1-pe],r[c+2]=r[c+2-pe],r[c+3]=r[c+3-pe];c=ct}}e.l=p,e.p=lt,e.b=c,e.f=a,p&&(a=1,e.m=k,e.d=d,e.n=S)}while(!a);return c==r.length?r:rc(r,0,c)},oc=new de(0),sc=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&$e(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},ic=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},lc=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&$e(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&$e(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function ac(t,e){return $r(t,{i:2},e&&e.out,e&&e.dictionary)}function fc(t,e){var r=sc(t);return r+8>t.length&&$e(6,"invalid gzip data"),$r(t.subarray(r,-8),{i:2},e&&e.out||new de(ic(t)),e&&e.dictionary)}function uc(t,e){return $r(t.subarray(lc(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function ir(t,e){return t[0]==31&&t[1]==139&&t[2]==8?fc(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?ac(t,e):uc(t,e)}var cc=typeof TextDecoder<"u"&&new TextDecoder,pc=0;try{cc.decode(oc,{stream:!0}),pc=1}catch{}var zn=(t,e)=>t*Math.pow(2,e),vt=(t,e)=>Math.floor(t/Math.pow(2,e)),Rt=(t,e)=>zn(t.getUint16(e+1,!0),8)+t.getUint8(e),Vn=(t,e)=>zn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),$c=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Rt(n,o+1);if(e!=s)return e-s;const l=Rt(n,o+4);return r!=l?r-l:0},mc=(t,e,r,n)=>{const o=Gn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},nn=(t,e,r,n)=>{const o=Gn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},Gn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,f=$c(e,r,n,t,l*17);if(f>0)o=l+1;else if(f<0)s=l-1;else return[Vn(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},hc=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,qn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Rt(t,e*17+1),y:Rt(t,e*17+4),offset:Vn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},on=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(qn(r,n));return dc(e)},dc=t=>{t.sort(hc);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=vt(o.offset,8)&255,r[n*17+9]=vt(o.offset,16)&255,r[n*17+10]=vt(o.offset,24)&255,r[n*17+11]=vt(o.offset,32)&255,r[n*17+12]=vt(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},gc=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=qn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),f=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:f}}return null};function _c(t){return ae(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let f=0;l.compression==="gzip"&&(f=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let a=0;"maxzoom"in l&&(a=+l.maxzoom);let u=0,c=0,p=0,d=-180,k=-85,S=180,T=85;if(l.bounds){const C=l.bounds.split(",");d=+C[0],k=+C[1],S=+C[2],T=+C[3]}if(l.center){const C=l.center.split(",");u=+C[0],c=+C[1],p=+C[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:f,tileType:1,minZoom:i,maxZoom:a,minLon:d,minLat:k,maxLon:S,maxLat:T,centerZoom:p,centerLon:u,centerLat:c,etag:e.etag}})}function bc(t,e,r,n,o,s,l){return ae(this,null,function*(){let f=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(f=on(f));const i=nn(new DataView(f),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=ir(new Uint8Array(c))),{data:c}}const a=gc(new DataView(f),{z:n,x:o,y:s});if(a){const u=mc(new DataView(f),a.z,a.x,a.y);if(u){let c=yield r.getArrayBuffer(e,u.offset,u.length,t);t.specVersion===1&&(c=on(c));const p=nn(new DataView(c),n,o,s);if(p){let k=(yield e.getBytes(p.offset,p.length,l)).data;const S=new DataView(k);return S.getUint8(0)==31&&S.getUint8(1)==139&&(k=ir(new Uint8Array(k))),{data:k}}}}})}var Kn={getHeader:_c,getZxy:bc},wc=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new sn(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new sn(o),this.tiles.set(o,s));const l=n[2],f=n[3],i=n[4],a=new AbortController,u=a.signal;let c=()=>{a.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+f,+i,u).then(d=>{d?e(null,new Uint8Array(d.data),d.cacheControl,d.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(d=>{d.name!=="AbortError"&&e(d,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function pt(t,e){return(e>>>0)*4294967296+(t>>>0)}function vc(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return pt(t,n);throw new Error("Expected varint not more than 10 bytes")}function yt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,vc(r,t))}function yc(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var kc=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Sc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=kc[t],o=Math.pow(2,t);let s=0,l=0,f=0;const i=[e,r];let a=o/2;for(;a>0;)s=(i[0]&a)>0?1:0,l=(i[1]&a)>0?1:0,f+=a*a*(3*s^l),yc(a,i,s,l),a=a/2;return n+f}function Zn(t,e){return ae(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return ir(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Tc=127;function Cc(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Lc=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ae(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const f=o.headers.get("Content-Range");if(!f||!f.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+f.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ye(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Ac(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ye(r,8),rootDirectoryLength:ye(r,16),jsonMetadataOffset:ye(r,24),jsonMetadataLength:ye(r,32),leafDirectoryOffset:ye(r,40),leafDirectoryLength:ye(r,48),tileDataOffset:ye(r,56),tileDataLength:ye(r,64),numAddressedTiles:ye(r,72),numTileEntries:ye(r,80),numTileContents:ye(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function Xn(t){const e={buf:new Uint8Array(t),pos:0},r=yt(e),n=[];let o=0;for(let s=0;s<r;s++){const l=yt(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=yt(e);for(let s=0;s<r;s++)n[s].length=yt(e);for(let s=0;s<r;s++){const l=yt(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function Oc(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ht=class extends Error{};function Dc(t,e,r,n){return ae(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Oc(o.data)<3)return[yield Kn.getHeader(t)];const l=o.data.slice(0,Tc);let f=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),f=void 0);const i=Ac(l,f);if(r){const a=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),u=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=Xn(yield e(a,i.internalCompression));return[i,[u,c.length,c]]}return[i,void 0]})}function Ec(t,e,r,n,o){return ae(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new ht(s.etag);const l=yield e(s.data,o.internalCompression),f=Xn(l);if(f.length===0)throw new Error("Empty directory is invalid");return f})}var Pc=class{constructor(t=100,e=!0,r=Zn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ae(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{Dc(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ae(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{Ec(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ae(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new ht(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ae(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},sn=class{constructor(t,e,r){typeof t=="string"?this.source=new Lc(t):this.source=t,r?this.decompress=r:this.decompress=Zn,e?this.cache=e:this.cache=new Pc}getHeader(){return ae(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ae(this,null,function*(){const o=Sc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Kn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,f=s.rootDirectoryLength;for(let i=0;i<=3;i++){const a=yield this.cache.getDirectory(this.source,l,f,s),u=Cc(a,o);if(u)if(u.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+u.offset,u.length,n);if(s.etag&&s.etag!==c.etag)throw new ht(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+u.offset,f=u.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ae(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof ht)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ae(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new ht(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ae(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof ht)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Mc(t){return Ot(()=>{let e=new wc;wr.addProtocol("pmtiles",e.tile)}),ar(()=>{wr.removeProtocol("pmtiles")}),[]}class Nc extends U{constructor(e){super(),H(this,e,Mc,null,W,{})}}function ln(t,e,r){const n=t.slice();return n[13]=e[r],n}function Ic(t){let e,r;return e=new Ru({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:Y,i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function an(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let f={schemes:t[1]};return t[2]!==void 0&&(f.schemesToBeShown=t[2]),t[3]!==void 0&&(f.filterText=t[3]),e=new xi({props:f}),R.push(()=>G(e,"schemesToBeShown",s)),R.push(()=>G(e,"filterText",l)),{c(){_(e.$$.fragment)},m(i,a){b(e,i,a),o=!0},p(i,a){const u={};a&2&&(u.schemes=i[1]),!r&&a&4&&(r=!0,u.schemesToBeShown=i[2],q(()=>r=!1)),!n&&a&8&&(n=!0,u.filterText=i[3],q(()=>n=!1)),e.$set(u)},i(i){o||(h(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){w(e,i)}}}function fn(t){let e,r;return e=new Gu({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function un(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&fn(t);return{c(){o&&o.c(),r=_t()},m(s,l){o&&o.m(s,l),$(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&h(o,1)):(o=fn(s),o.c(),h(o,1),o.m(r.parentNode,r)):o&&(oe(),g(o,1,1,()=>{o=null}),se())},i(s){n||(h(o),n=!0)},o(s){g(o),n=!1},d(s){s&&m(r),o&&o.d(s)}}}function Fc(t){let e,r,n,o,s,l,f,i,a,u,c=lr()=="Private (development)",p,d,k,S,T,v,C,I;s=new po({props:{boundaryGeojson:t[4]}}),f=new To({}),a=new no({});let E=c&&Ic(t);d=new ho({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),S=new bn({props:{errorMessage:t[0]}});let N=t[1].size>0&&an(t),F=Ne(t[1].values()),O=[];for(let M=0;M<F.length;M+=1)O[M]=un(ln(t,F,M));const A=M=>g(O[M],1,1,()=>{O[M]=null});return{c(){e=P("div"),r=P("div"),n=P("h1"),n.textContent="Browse schemes",o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment),u=L(),E&&E.c(),p=L(),_(d.$$.fragment),k=L(),_(S.$$.fragment),T=L(),N&&N.c(),v=L(),C=P("ul");for(let M=0;M<O.length;M+=1)O[M].c();je(r,"display","flex"),je(r,"justify-content","space-between"),j(e,"slot","sidebar"),j(e,"class","govuk-prose")},m(M,B){$(M,e,B),D(e,r),D(r,n),D(r,o),b(s,r,null),D(e,l),b(f,e,null),D(e,i),b(a,e,null),D(e,u),E&&E.m(e,null),D(e,p),b(d,e,null),D(e,k),b(S,e,null),D(e,T),N&&N.m(e,null),D(e,v),D(e,C);for(let Z=0;Z<O.length;Z+=1)O[Z]&&O[Z].m(C,null);I=!0},p(M,B){const Z={};B&16&&(Z.boundaryGeojson=M[4]),s.$set(Z),c&&E.p(M,B);const ne={};if(B&1&&(ne.errorMessage=M[0]),S.$set(ne),M[1].size>0?N?(N.p(M,B),B&2&&h(N,1)):(N=an(M),N.c(),h(N,1),N.m(e,v)):N&&(oe(),g(N,1,1,()=>{N=null}),se()),B&38){F=Ne(M[1].values());let z;for(z=0;z<F.length;z+=1){const Le=ln(M,F,z);O[z]?(O[z].p(Le,B),h(O[z],1)):(O[z]=un(Le),O[z].c(),h(O[z],1),O[z].m(C,null))}for(oe(),z=F.length;z<O.length;z+=1)A(z);se()}},i(M){if(!I){h(s.$$.fragment,M),h(f.$$.fragment,M),h(a.$$.fragment,M),h(E),h(d.$$.fragment,M),h(S.$$.fragment,M),h(N);for(let B=0;B<F.length;B+=1)h(O[B]);I=!0}},o(M){g(s.$$.fragment,M),g(f.$$.fragment,M),g(a.$$.fragment,M),g(E),g(d.$$.fragment,M),g(S.$$.fragment,M),g(N),O=O.filter(Boolean);for(let B=0;B<O.length;B+=1)g(O[B]);I=!1},d(M){M&&m(e),w(s),w(f),w(a),E&&E.d(),w(d),w(S),N&&N.d(),Ct(O,M)}}}function Bc(t){let e,r,n,o,s,l,f,i,a,u,c;return e=new $o({props:{colorInterventions:wn("v1")}}),n=new Q({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new Q({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),f=new Q({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),u=new xu({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),a=P("div"),_(u.$$.fragment),j(a,"class","top-right svelte-u44ed2")},m(p,d){b(e,p,d),$(p,r,d),b(n,p,d),$(p,o,d),b(s,p,d),$(p,l,d),b(f,p,d),$(p,i,d),$(p,a,d),b(u,a,null),c=!0},p:Y,i(p){c||(h(e.$$.fragment,p),h(n.$$.fragment,p),h(s.$$.fragment,p),h(f.$$.fragment,p),h(u.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(f.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(m(r),m(o),m(l),m(i),m(a)),w(e,p),w(n,p),w(s,p),w(f,p),w(u)}}}function xc(t){let e,r,n,o,s;return r=new Nc({}),o=new fo({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Bc]},$$scope:{ctx:t}}}),{c(){e=P("div"),_(r.$$.fragment),n=L(),_(o.$$.fragment),j(e,"slot","main")},m(l,f){$(l,e,f),b(r,e,null),D(e,n),b(o,e,null),s=!0},p(l,f){const i={};f&65536&&(i.$$scope={dirty:f,ctx:l}),o.$set(i)},i(l){s||(h(r.$$.fragment,l),h(o.$$.fragment,l),s=!0)},o(l){g(r.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&m(e),w(r),w(o)}}}function jc(t){let e,r;return e=new ao({props:{$$slots:{main:[xc],sidebar:[Fc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(h(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){w(e,n)}}}function Rc(t,e,r){let n;X(t,dt,T=>r(4,n=T));let o=new Set(qu);Ot(()=>{oo()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",f="",i=new Map,a=new Set,u="";ar(()=>{dt.set(_n())});function c(T){try{let v=JSON.parse(T);r(1,i=Ci(v)),dt.set(v),r(0,f="")}catch(v){r(0,f=`The file you loaded is broken: ${v}`)}}function p(T){let v=T.properties;var C='<div style="max-width: 30vw;">';return C+=`<h2>${d(v.name)} (${v.intervention_type})</h2>`,C+=`<p>Scheme reference: ${v.scheme_reference}</p>`,v.length_meters&&(C+=`<p>Length: ${so(v.length_meters)}</p>`),v.description&&(C+=`<p>${d(v.description)}</p>`),C+="</div>",C}function d(T){return u?T.replace(new RegExp(u,"gi"),v=>`<mark>${v}</mark>`):T}function k(T){a=T,r(2,a)}function S(T){u=T,r(3,u)}return[f,i,a,u,n,o,l,c,p,k,S]}class Uc extends U{constructor(e){super(),H(this,e,Rc,jc,W,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Uc({target:document.getElementById("app")});
