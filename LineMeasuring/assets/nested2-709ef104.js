import{S as R,i as H,s as W,M as Qn,b as U,c as G,e as P,d as L,g as _,av as eo,h as j,j as m,k as D,m as w,w as _t,l as q,t as d,n as g,p as h,q as b,aH as cn,aI as pn,aJ as $n,aK as mn,u as S,f as lr,x as Y,am as to,N as X,C as ee,ao as hn,T as gt,r as Rt,F as dn,a as Ct,v as dr,I as be,a2 as lt,y as oe,o as se,aA as ro,ax as Ne,aL as no,aM as oo,ad as so,B as gr,aO as x,an as je,ay as Bt,aP as fe,Q as Ke,G as ue,Y as ge,aQ as qe,aR as ie,P as ar,R as gn,aS as fr,aT as io,_ as _n,Z as wt,E as wn,aU as _r,D as lo,aV as wr,a5 as bn,L as ao,z as fo,aE as uo}from"./index-8ed7da87.js";import{e as xt,C as Te,b as Ot,d as te,a as co,S as po,L as $o,M as mo}from"./StreetViewController-2603847c.js";import{L as ho,h as br,f as vn,l as go,C as _e,B as _o,Z as wo,I as bo}from"./index-793ce943.js";import{P as vo}from"./Pin-ea7bdf64.js";import{I as Q}from"./InteractiveLayer-051e5e8b.js";import{F as yo}from"./FileInput-2397db78.js";const ko="/atip/LineMeasuring/assets/help-d011708a.svg";function So(t){let e,r;const n=t[1].default,o=cn(n,t,t[4],null);return{c(){e=P("div"),o&&o.c(),j(e,"class","govuk-prose")},m(s,l){m(s,e,l),o&&o.m(e,null),r=!0},p(s,l){o&&o.p&&(!r||l&16)&&pn(o,n,s,s[4],r?mn(n,s[4],l,null):$n(s[4]),null)},i(s){r||(d(o,s),r=!0)},o(s){g(o,s),r=!1},d(s){s&&h(e),o&&o.d(s)}}}function To(t){let e,r,n,o,s,l,f,i,a;function u(p){t[3](p)}let c={title:"Help",$$slots:{default:[So]},$$scope:{ctx:t}};return t[0]!==void 0&&(c.open=t[0]),s=new Qn({props:c}),U.push(()=>G(s,"open",u)),{c(){e=P("button"),r=P("img"),o=L(),_(s.$$.fragment),eo(r.src,n=ko)||j(r,"src",n),j(r,"title","Help"),j(r,"alt","Help"),j(e,"class","svelte-7d9d1l")},m(p,$){m(p,e,$),D(e,r),m(p,o,$),w(s,p,$),f=!0,i||(a=_t(e,"click",t[2]),i=!0)},p(p,[$]){const y={};$&16&&(y.$$scope={dirty:$,ctx:p}),!l&&$&1&&(l=!0,y.open=p[0],q(()=>l=!1)),s.$set(y)},i(p){f||(d(s.$$.fragment,p),f=!0)},o(p){g(s.$$.fragment,p),f=!1},d(p){p&&(h(e),h(o)),b(s,p),i=!1,a()}}}function Co(t,e,r){let{$$slots:n={},$$scope:o}=e,s=!1;const l=()=>r(0,s=!0);function f(i){s=i,r(0,s)}return t.$$set=i=>{"$$scope"in i&&r(4,o=i.$$scope)},[s,n,l,f,o]}class re extends R{constructor(e){super(),H(this,e,Co,To,W,{})}}function Lo(t){let e;return{c(){e=P("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ao(t){let e,r,n,o,s=t[0]=="Private (development)"&&Lo();return{c(){s&&s.c(),e=L(),r=P("p"),r.textContent="Note the ATF scheme data has not been validated.",n=L(),o=P("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,f){s&&s.m(l,f),m(l,e,f),m(l,r,f),m(l,n,f),m(l,o,f)},p:Y,d(l){l&&(h(e),h(r),h(n),h(o)),s&&s.d(l)}}}function Oo(t){let e,r,n,o,s,l;return s=new re({props:{$$slots:{default:[Ao]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=S("App version: "),n=S(t[0]),o=L(),_(s.$$.fragment)},m(f,i){m(f,e,i),D(e,r),D(e,n),D(e,o),w(s,e,null),l=!0},p(f,[i]){const a={};i&2&&(a.$$scope={dirty:i,ctx:f}),s.$set(a)},i(f){l||(d(s.$$.fragment,f),l=!0)},o(f){g(s.$$.fragment,f),l=!1},d(f){f&&h(e),b(s)}}}function Do(t){return[lr()]}class Eo extends R{constructor(e){super(),H(this,e,Do,Oo,W,{})}}const Po={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var me=Uint8Array,ot=Uint16Array,yn=Uint32Array,kn=new me([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Sn=new me([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Mo=new me([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tn=function(t,e){for(var r=new ot(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new yn(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},Cn=Tn(kn,2),Ln=Cn[0],No=Cn[1];Ln[28]=258,No[258]=28;var Io=Tn(Sn,0),Fo=Io[0],Jt=new ot(32768);for(var J=0;J<32768;++J){var He=(J&43690)>>>1|(J&21845)<<1;He=(He&52428)>>>2|(He&13107)<<2,He=(He&61680)>>>4|(He&3855)<<4,Jt[J]=((He&65280)>>>8|(He&255)<<8)>>>1}var St=function(t,e,r){for(var n=t.length,o=0,s=new ot(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new ot(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new ot(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[Jt[c]>>>i]=a}else for(f=new ot(n),o=0;o<n;++o)t[o]&&(f[o]=Jt[l[t[o]-1]++]>>>15-t[o]);return f},Dt=new me(288);for(var J=0;J<144;++J)Dt[J]=8;for(var J=144;J<256;++J)Dt[J]=9;for(var J=256;J<280;++J)Dt[J]=7;for(var J=280;J<288;++J)Dt[J]=8;var An=new me(32);for(var J=0;J<32;++J)An[J]=5;var Bo=St(Dt,9,1),xo=St(An,5,1),Wt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},zt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},jo=function(t){return(t+7)/8|0},ur=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?ot:t.BYTES_PER_ELEMENT==4?yn:me)(r-e);return n.set(t.subarray(e,r)),n},Uo=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Se=function(t,e,r){var n=new Error(e||Uo[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Se),!r)throw n;return n},Ro=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new me(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new me(n*3));var l=function(ct){var pt=e.length;if(ct>pt){var vt=new me(Math.max(pt*2,ct));vt.set(e),e=vt}},f=r.f||0,i=r.p||0,a=r.b||0,u=r.l,c=r.d,p=r.m,$=r.n,y=n*8;do{if(!u){f=ve(t,i,1);var k=ve(t,i+1,3);if(i+=3,k)if(k==1)u=Bo,c=xo,p=9,$=5;else if(k==2){var I=ve(t,i,31)+257,E=ve(t,i+10,15)+4,M=I+ve(t,i+5,31)+1;i+=14;for(var F=new me(M),A=new me(19),O=0;O<E;++O)A[Mo[O]]=ve(t,i+O*3,7);i+=E*3;for(var N=Wt(A),B=(1<<N)-1,Z=St(A,N,1),O=0;O<M;){var ne=Z[ve(t,i,B)];i+=ne&15;var C=ne>>>4;if(C<16)F[O++]=C;else{var z=0,Le=0;for(C==16?(Le=3+ve(t,i,3),i+=2,z=F[O-1]):C==17?(Le=3+ve(t,i,7),i+=3):C==18&&(Le=11+ve(t,i,127),i+=7);Le--;)F[O++]=z}}var Fe=F.subarray(0,I),ce=F.subarray(I);p=Wt(Fe),$=Wt(ce),u=St(Fe,p,1),c=St(ce,$,1)}else Se(1);else{var C=jo(i)+4,v=t[C-4]|t[C-3]<<8,T=C+v;if(T>n){s&&Se(0);break}o&&l(a+v),e.set(t.subarray(C,T),a),r.b=a+=v,r.p=i=T*8,r.f=f;continue}if(i>y){s&&Se(0);break}}o&&l(a+131072);for(var Mt=(1<<p)-1,pe=(1<<$)-1,bt=i;;bt=i){var z=u[zt(t,i)&Mt],Re=z>>>4;if(i+=z&15,i>y){s&&Se(0);break}if(z||Se(2),Re<256)e[a++]=Re;else if(Re==256){bt=i,u=null;break}else{var at=Re-254;if(Re>264){var O=Re-257,we=kn[O];at=ve(t,i,(1<<we)-1)+Ln[O],i+=we}var ft=c[zt(t,i)&pe],Be=ft>>>4;ft||Se(3),i+=ft&15;var ce=Fo[Be];if(Be>3){var we=Sn[Be];ce+=zt(t,i)&(1<<we)-1,i+=we}if(i>y){s&&Se(0);break}o&&l(a+131072);for(var ut=a+at;a<ut;a+=4)e[a]=e[a-ce],e[a+1]=e[a+1-ce],e[a+2]=e[a+2-ce],e[a+3]=e[a+3-ce];a=ut}}r.l=u,r.p=bt,r.b=a,r.f=f,u&&(f=1,r.m=p,r.d=c,r.n=$)}while(!f);return a==e.length?e:ur(e,0,a)},Ho=new me(0),Me=function(t,e){return t[e]|t[e+1]<<8},Ce=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Vt=function(t,e){return Ce(t,e)+Ce(t,e+4)*4294967296};function Wo(t,e){return Ro(t,e)}var Qt=typeof TextDecoder<"u"&&new TextDecoder,zo=0;try{Qt.decode(Ho,{stream:!0}),zo=1}catch{}var Vo=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,ur(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function On(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Qt)return Qt.decode(t);var o=Vo(t),s=o[0],l=o[1];return l.length&&Se(8),s}}var Go=function(t,e){return e+30+Me(t,e+26)+Me(t,e+28)},qo=function(t,e,r){var n=Me(t,e+28),o=On(t.subarray(e+46,e+46+n),!(Me(t,e+8)&2048)),s=e+46+n,l=Ce(t,e+20),f=r&&l==4294967295?Ko(t,s):[l,Ce(t,e+24),Ce(t,e+42)],i=f[0],a=f[1],u=f[2];return[Me(t,e+10),i,a,o,s+Me(t,e+30)+Me(t,e+32),u]},Ko=function(t,e){for(;Me(t,e)!=1;e+=4+Me(t,e+2));return[Vt(t,e+12),Vt(t,e+4),Vt(t,e+20)]};function Zo(t,e){for(var r={},n=t.length-22;Ce(t,n)!=101010256;--n)(!n||t.length-n>65558)&&Se(13);var o=Me(t,n+8);if(!o)return{};var s=Ce(t,n+16),l=s==4294967295||o==65535;if(l){var f=Ce(t,n-12);l=Ce(t,f)==101075792,l&&(o=Ce(t,f+32),s=Ce(t,f+48))}for(var i=e&&e.filter,a=0;a<o;++a){var u=qo(t,s,l),c=u[0],p=u[1],$=u[2],y=u[3],k=u[4],C=u[5],v=Go(t,C);s=k,(!i||i({name:y,size:p,originalSize:$,compression:c}))&&(c?c==8?r[y]=Wo(t.subarray(v,v+p),new me($)):Se(14,"unknown compression type "+c):r[y]=ur(t,v,v+p))}return r}function Xo(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Gt):Gt(t)}function Gt(t){var e=new Uint8Array(t),r=Zo(e);return Promise.resolve(Yo(r))}function Yo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=On(t[o])}return e}function Ie(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&it(n)===e)return n;r++}}function Et(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&it(o)===e&&r.push(o),n++}return r}function jt(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&it(o)===e&&r(o,n):r(o,n),n++}}function Jo(t,e,r){var n=[];return jt(t,e,function(o,s){n.push(r(o,s))}),n}var Qo=/.+\:/;function it(t){return t.tagName.replace(Qo,"")}function Dn(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+it(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=Dn(t.childNodes[n]),n++;return e+="</"+it(t)+">",e}function es(t){var e=t.documentElement,r=Ie(e,"sheetData"),n=[];return jt(r,"row",function(o){jt(o,"c",function(s){n.push(s)})}),n}function ts(t,e){return Ie(e,"v")}function rs(t,e){if(e.firstChild&&it(e.firstChild)==="is"&&e.firstChild.firstChild&&it(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function ns(t){var e=t.documentElement,r=Ie(e,"dimension");if(r)return r.getAttribute("ref")}function os(t){var e=t.documentElement,r=Ie(e,"cellStyleXfs");return r?Et(r,"xf"):[]}function ss(t){var e=t.documentElement,r=Ie(e,"cellXfs");return r?Et(r,"xf"):[]}function is(t){var e=t.documentElement,r=Ie(e,"numFmts");return r?Et(r,"numFmt"):[]}function ls(t){var e=t.documentElement;return Jo(e,"si",function(r){var n=Ie(r,"t");if(n)return n.textContent;var o="";return jt(r,"r",function(s){o+=Ie(s,"t").textContent}),o})}function as(t){var e=t.documentElement;return Ie(e,"workbookPr")}function fs(t){var e=t.documentElement;return Et(e,"Relationship")}function us(t){var e=t.documentElement,r=Ie(e,"sheets");return Et(r,"sheet")}function cs(t,e){var r=e.createDocument(t),n={},o=as(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(f){f.getAttribute("name")&&n.sheets.push({id:f.getAttribute("sheetId"),name:f.getAttribute("name"),relationId:f.getAttribute("r:id")})};return us(r).forEach(s),n}function ps(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var f=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=qt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=qt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=qt(f);break}};return fs(r).forEach(o),n}function qt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function vr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function yr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vr(Object(r),!0).forEach(function(n){$s(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ms(t,e){if(!t)return{};var r=e.createDocument(t),n=os(r).map(Kt),o=is(r).map(hs).reduce(function(l,f){return l[f.id]=f,l},[]),s=function(f){return f.hasAttribute("xfId")?yr(yr({},n[f.xfId]),Kt(f,o)):Kt(f,o)};return ss(r).map(s)}function hs(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function Kt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function ds(t,e){return t?ls(e.createDocument(t)):[]}function En(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function gs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=_s(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _s(t,e){if(t){if(typeof t=="string")return kr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kr(t,e)}}function kr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ws(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(bs.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&ks(o.numberFormat.template))return!0}}var bs=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],vs=/^\[\$-414\]/,ys=/;@$/;function ks(t){t=t.toLowerCase(),t=t.replace(vs,""),t=t.replace(ys,"");for(var e=t.split(/\W+/),r=gs(e),n;!(n=r()).done;){var o=n.value;if(Ss.indexOf(o)<0)return!1}return!0}var Ss=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function Ts(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,f=r.values,i=r.properties,a=r.options;switch(e||(e="n"),e){case"str":t=Zt(t,a);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Zt(t,a);break;case"s":var u=Number(t);if(isNaN(u))throw new Error('Invalid "shared" string index: '.concat(t));if(u>=f.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=f[u],t=Zt(t,a);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=Cs(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,ws(t,s(),l,a)&&(t=En(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function Cs(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Zt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var Ls=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function As(t){var e=function(a,u){return a-u},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],f=n[n.length-1];return[{row:o,column:l},{row:s,column:f}]}function Os(t){for(var e=0,r=0;r<t.length;)e*=26,e+=Ls.indexOf(t[r]),r++;return e}function Pn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),Os(t[0].trim())]}function Ds(t,e,r,n,o,s,l){var f=Pn(t.getAttribute("r")),i=ts(e,t),a=i&&i.textContent,u;return t.hasAttribute("t")&&(u=t.getAttribute("t")),{row:f[0],column:f[1],value:Ts(a,u,{getInlineStringValue:function(){return rs(e,t)},getInlineStringXml:function(){return Dn(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function Es(t,e,r,n,o,s){var l=es(t);return l.length===0?[]:l.map(function(f){return Ds(f,t,e,r,n,o,s)})}function Ps(t,e){return Fs(t)||Is(t,e)||Ns(t,e)||Ms()}function Ms(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ns(t,e){if(t){if(typeof t=="string")return Sr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sr(t,e)}}function Sr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Is(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function Fs(t){if(Array.isArray(t))return t}function Bs(t){var e=ns(t);if(e)return e=e.split(":").map(Pn).map(function(r){var n=Ps(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function xs(t,e,r,n,o,s){var l=e.createDocument(t),f=Es(l,e,r,n,o,s),i=Bs(l)||As(f);return{cells:f,dimensions:i}}function js(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Us(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Us(t,e){if(t){if(typeof t=="string")return Tr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tr(t,e)}}function Tr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Rs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var f=!0,i=js(t[l]),a;!(a=i()).done;){var u=a.value;if(o(u)!==null){f=!1;break}}if(f)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function Hs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ws(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ws(t,e){if(t){if(typeof t=="string")return Cr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(t,e)}}function Cr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,f=Hs(t),i;!(i=f()).done;){var a=i.value;if(n(a[s])!==null){l=!1;break}}if(l)for(var u=0;u<t.length;)t[u].splice(s,1),u++;else if(o)break;s--}return t}function Vs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Mn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gs(t,e){return Zs(t)||Ks(t,e)||Mn(t,e)||qs()}function qs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mn(t,e){if(t){if(typeof t=="string")return Lr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lr(t,e)}}function Lr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ks(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function Zs(t){if(Array.isArray(t))return t}function Xs(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Gs(r,2);o[0];for(var s=o[1],l=s.column,f=s.row,i=new Array(f),a=0;a<f;){i[a]=new Array(l);for(var u=0;u<l;)i[a][u]=null,u++;a++}for(var c=Vs(n),p;!(p=c()).done;){var $=p.value,y=$.row-1,k=$.column-1;k<l&&y<f&&(i[y][k]=$.value)}var C=e.rowMap;if(C)for(var v=0;v<i.length;)C[v]=v,v++;return i=Rs(zs(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:C}),e.transformData&&(i=e.transformData(i)),i}function Ys(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Js(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Js(t,e){if(t){if(typeof t=="string")return Ar(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ar(t,e)}}function Ar(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Or(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Qs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Or(Object(r),!0).forEach(function(n){ei(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Or(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ei(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ti(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=Qs({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=ps(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?ds(n(o.sharedStrings),e):[],l=o.styles?ms(n(o.styles),e):{},f=cs(n("xl/workbook.xml"),e);if(r.getSheets)return f.sheets.map(function(c){var p=c.name;return{name:p}});var i=ri(r.sheet,f.sheets);if(!i||!o.sheets[i])throw ni(r.sheet,f.sheets);var a=xs(n(o.sheets[i]),e,s,l,f,r),u=Xs(a,r);return r.properties?{data:u,properties:f}:u}function ri(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Ys(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function ni(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function er(t){"@babel/helpers - typeof";return er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(t)}function Dr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function oi(t,e,r){return e&&Dr(t.prototype,e),r&&Dr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function si(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ii(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}function li(t){var e=Nn();return function(){var n=At(t),o;if(e){var s=At(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return ai(this,o)}}function ai(t,e){if(e&&(er(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fi(t)}function fi(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tr(t){var e=typeof Map=="function"?new Map:void 0;return tr=function(n){if(n===null||!ui(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return It(n,arguments,At(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Lt(o,n)},tr(t)}function It(t,e,r){return Nn()?It=Reflect.construct:It=function(o,s,l){var f=[null];f.push.apply(f,s);var i=Function.bind.apply(o,f),a=new i;return l&&Lt(a,l.prototype),a},It.apply(null,arguments)}function Nn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ui(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function Lt(t,e){return Lt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Lt(t,e)}function At(t){return At=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},At(t)}var he=function(t){ii(r,t);var e=li(r);function r(n){var o;return si(this,r),o=e.call(this,"invalid"),o.reason=n,o}return oi(r)}(tr(Error));function ci(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new he("not_a_number")}if(typeof t!="number")throw new he("not_a_number");if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return t}function pi(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return String(t)}throw new he("not_a_string")}function $i(t){if(typeof t=="boolean")return t;throw new he("not_a_boolean")}function mi(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new he("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");var n=En(t,r);if(isNaN(n.valueOf()))throw new he("out_of_bounds");return n}throw new he("not_a_date")}function hi(t,e){return _i(t)||gi(t,e)||In(t,e)||di()}function di(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gi(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function _i(t){if(Array.isArray(t))return t}function rr(t){"@babel/helpers - typeof";return rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(t)}function wi(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=In(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function In(t,e){if(t){if(typeof t=="string")return Er(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Er(t,e)}}function Er(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Pr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pr(Object(r),!0).forEach(function(n){bi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Nr={isColumnOriented:!1};function vi(t,e,r){r?r=Mr(Mr({},Nr),r):r=Nr;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;Ti(e),o&&(t=Si(t));for(var f=t[0],i=[],a=[],u=1;u<t.length;u++){var c=Fn(e,t[u],u,f,a,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=wi(a),$;!($=p()).done;){var y=$.value;y.row=s[y.row-1]+1}return{rows:i,errors:a}}function Fn(t,e,r,n,o,s){for(var l={},f=!0,i=function(){var p=u[a],$=t[p],y=rr($.type)==="object"&&!Array.isArray($.type),k=e[n.indexOf(p)];k===void 0&&(k=null);var C=void 0,v=void 0,T=void 0;if(y)C=Fn($.type,e,r,n,o,s);else if(k===null)C=null;else if(Array.isArray($.type)){var I=!1,E=ki(k).map(function(F){var A=Ir(F,$,s);return A.error&&(C=F,v=A.error,T=A.reason),A.value!==null&&(I=!0),A.value});v||(C=I?E:null)}else{var M=Ir(k,$,s);v=M.error,T=M.reason,C=v?k:M.value}!v&&C===null&&$.required&&(v="required"),v?(v={error:v,row:r+1,column:p,value:C},T&&(v.reason=T),$.type&&(v.type=$.type),o.push(v)):(f&&C!==null&&(f=!1),(C!==null||s.includeNullValues)&&(l[$.prop]=C))},a=0,u=Object.keys(t);a<u.length;a++)i();return f?null:l}function Ir(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=mt(t,e.parse):e.type?n=yi(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function mt(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function yi(t,e,r){switch(e){case String:return mt(t,pi);case Number:return mt(t,ci);case Date:return mt(t,function(n){return mi(n,{properties:r.properties})});case Boolean:return mt(t,$i);default:if(typeof e=="function")return mt(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Bn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=Bn(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function ki(t){for(var e=[],r=0;r<t.length;){var n=Bn(t,",",r),o=hi(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var Si=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function Ti(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function nr(t){"@babel/helpers - typeof";return nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(t)}function xn(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;nr(s)==="object"&&(s=Object.keys(t[o])[0],l=xn(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var Ci=["schema","map"];function Fr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Nt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fr(Object(r),!0).forEach(function(n){Li(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Li(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ai(t,e){if(t==null)return{};var r=Oi(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Oi(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Di(t,e,r){var n=r.schema,o=r.map,s=Ai(r,Ci);!n&&o&&(n=xn(o));var l=ti(t,e,Nt(Nt({},s),{},{properties:n||s.properties}));return n?vi(l.data,n,Nt(Nt({},s),{},{properties:l.properties})):l}function Ei(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Xo(t).then(function(r){return Di(r,Po,e)})}function Pi(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function Mi(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await Ei(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=to(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const V={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Ht=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function Ni(t){let e,r,n,o,s;function l(i){t[3](i)}let f={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(f.value=t[0]),e=new xt({props:f}),U.push(()=>G(e,"value",l)),e.$on("change",t[2]),o=new ho({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};!r&&a&1&&(r=!0,u.value=i[0],q(()=>r=!1)),e.$set(u);const c={};a&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function Ii(t,e,r){let n;X(t,ee,i=>r(4,n=i));let o="interventionType",s=br("v1");function l(){let i;o=="interventionType"?(i=vn("v1"),r(1,s=br("v1"))):(i=hn(["get","funding_programme"],{ATF2:V.atf2,ATF3:V.atf3,ATF4:V.atf4},"grey"),r(1,s=[["ATF2",V.atf2],["ATF3",V.atf3],["ATF4",V.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function f(i){o=i,r(0,o)}return[o,s,l,f]}class Fi extends R{constructor(e){super(),H(this,e,Ii,Ni,W,{})}}function Bi(t){let e;return{c(){e=S("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xi(t){let e,r,n,o,s,l;return n=new Ct({props:{$$slots:{default:[Bi]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=P("input"),r=L(),_(n.$$.fragment),j(e,"type","text"),j(e,"class","govuk-input govuk-input--width-10"),j(e,"id","filterText")},m(f,i){m(f,e,i),dr(e,t[0]),m(f,r,i),w(n,f,i),o=!0,s||(l=_t(e,"input",t[12]),s=!0)},p(f,i){i&1&&e.value!==f[0]&&dr(e,f[0]);const a={};i&131072&&(a.$$scope={dirty:i,ctx:f}),n.$set(a)},i(f){o||(d(n.$$.fragment,f),o=!0)},o(f){g(n.$$.fragment,f),o=!1},d(f){f&&(h(e),h(r)),b(n,f),s=!1,l()}}}function ji(t){let e,r,n,o,s,l,f,i,a,u;function c(k){t[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new xt({props:p}),U.push(()=>G(e,"value",c));function $(k){t[11](k)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(y.value=t[3]),o=new xt({props:y}),U.push(()=>G(o,"value",$)),f=new dn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[xi]},$$scope:{ctx:t}}}),a=new Fi({}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment)},m(k,C){w(e,k,C),m(k,n,C),w(o,k,C),m(k,l,C),w(f,k,C),m(k,i,C),w(a,k,C),u=!0},p(k,C){const v={};C&32&&(v.choices=k[5]),!r&&C&4&&(r=!0,v.value=k[2],q(()=>r=!1)),e.$set(v);const T={};C&64&&(T.choices=k[6]),!s&&C&8&&(s=!0,T.value=k[3],q(()=>s=!1)),o.$set(T);const I={};C&131073&&(I.$$scope={dirty:C,ctx:k}),f.$set(I)},i(k){u||(d(e.$$.fragment,k),d(o.$$.fragment,k),d(f.$$.fragment,k),d(a.$$.fragment,k),u=!0)},o(k){g(e.$$.fragment,k),g(o.$$.fragment,k),g(f.$$.fragment,k),g(a.$$.fragment,k),u=!1},d(k){k&&(h(n),h(l),h(i)),b(e,k),b(o,k),b(f,k),b(a,k)}}}function Ui(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,f,i=t[7].area.toLocaleString()+"",a,u,c=t[7].crossing.toLocaleString()+"",p,$,y=t[7].other.toLocaleString()+"",k,C;return{c(){e=S("Showing "),n=S(r),o=S(" schemes ("),l=S(s),f=S(`
    routes, `),a=S(i),u=S(` areas,
    `),p=S(c),$=S(" crossings, "),k=S(y),C=S(`
    other)`)},m(v,T){m(v,e,T),m(v,n,T),m(v,o,T),m(v,l,T),m(v,f,T),m(v,a,T),m(v,u,T),m(v,p,T),m(v,$,T),m(v,k,T),m(v,C,T)},p(v,T){T&2&&r!==(r=v[1].size.toLocaleString()+"")&&be(n,r),T&128&&s!==(s=v[7].route.toLocaleString()+"")&&be(l,s),T&128&&i!==(i=v[7].area.toLocaleString()+"")&&be(a,i),T&128&&c!==(c=v[7].crossing.toLocaleString()+"")&&be(p,c),T&128&&y!==(y=v[7].other.toLocaleString()+"")&&be(k,y)},d(v){v&&(h(e),h(n),h(o),h(l),h(f),h(a),h(u),h(p),h($),h(k),h(C))}}}function Ri(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[Ui]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),U.push(()=>G(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){w(e,l,f),n=!0},p(l,f){const i={};f&131202&&(i.$$scope={dirty:f,ctx:l}),!r&&f&16&&(r=!0,i.checked=l[4],q(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function Hi(t){let e,r,n,o;return e=new Te({props:{label:"Filters",$$slots:{default:[ji]},$$scope:{ctx:t}}}),n=new Ot({props:{small:!0,$$slots:{default:[Ri]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},p(s,[l]){const f={};l&131181&&(f.$$scope={dirty:l,ctx:s}),e.$set(f);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Wi(t,e,r){let n,o;X(t,gt,E=>r(15,n=E)),X(t,ee,E=>r(9,o=E));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:f=""}=e,i=[],a="",u=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;Rt(()=>{let E=new Set,M=new Set;for(let F of s.values())F.authority_or_region&&E.add(F.authority_or_region),F.funding_programme&&M.add(F.funding_programme);r(5,i=Array.from(E.entries())),i.sort(),r(6,u=Array.from(M.entries())),u.sort()});function y(E,M,F){let A=E.toLowerCase(),O=B=>{var Z,ne;if(A&&!((Z=B.properties.name)!=null&&Z.toLowerCase().includes(A))&&!((ne=B.properties.description)!=null&&ne.toLowerCase().includes(A)))return!1;if(M||F){let z=s.get(B.properties.scheme_reference);if(M&&z.authority_or_region!=M||F&&z.funding_programme!=F)return!1}return!0};r(1,l=new Set(n.features.filter(O).map(B=>B.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let N=B=>{var Z,ne;return!(!l.has(B.properties.scheme_reference)||A&&!((Z=B.properties.name)!=null&&Z.toLowerCase().includes(A))&&!((ne=B.properties.description)!=null&&ne.toLowerCase().includes(A)))};gt.update(B=>{for(let Z of B.features)N(Z)?(delete Z.properties.hide_while_editing,r(7,p[Z.properties.intervention_type]++,p)):Z.properties.hide_while_editing=!0;return B}),r(7,p)}function k(E){a=E,r(2,a)}function C(E){c=E,r(3,c)}function v(){f=this.value,r(0,f)}const T=()=>r(0,f="");function I(E){$=E,r(4,$)}return t.$$set=E=>{"schemes"in E&&r(8,s=E.schemes),"schemesToBeShown"in E&&r(1,l=E.schemesToBeShown),"filterText"in E&&r(0,f=E.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let E of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(E)&&o.setLayoutProperty(E,"visibility",$?"visible":"none");t.$$.dirty&13&&y(f,a,c)},[f,l,a,c,$,i,u,p,s,o,k,C,v,T,I]}class zi extends R{constructor(e){super(),H(this,e,Wi,Hi,W,{schemes:8,schemesToBeShown:1,filterText:0})}}function Br(t,e,r){const n=t.slice();return n[15]=e[r],n[16]=e,n[17]=r,n}function Vi(t){let e,r;return e=new Ct({props:{$$slots:{default:[qi]},$$scope:{ctx:t}}}),e.$on("click",t[4]),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&262144&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Gi(t){let e,r;return e=new Ct({props:{$$slots:{default:[Ki]},$$scope:{ctx:t}}}),e.$on("click",t[3]),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&262144&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function qi(t){let e;return{c(){e=S("Disable Line Measurement Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ki(t){let e;return{c(){e=S("Enable Line Measurement Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xr(t){var l;let e,r,n=((l=t[2].properties)==null?void 0:l.length)+"",o,s;return{c(){e=P("p"),r=S("Length: "),o=S(n),s=S("m")},m(f,i){m(f,e,i),D(e,r),D(e,o),D(e,s)},p(f,i){var a;i&4&&n!==(n=((a=f[2].properties)==null?void 0:a.length)+"")&&be(o,n)},d(f){f&&h(e)}}}function jr(t){let e,r,n=[],o=new Map,s,l;e=new Te({props:{label:"Help",$$slots:{default:[Zi]},$$scope:{ctx:t}}});let f=Ne(t[1]);const i=a=>a[15].id;for(let a=0;a<f.length;a+=1){let u=Br(t,f,a),c=i(u);o.set(c,n[a]=Ur(c,u))}return{c(){_(e.$$.fragment),r=L();for(let a=0;a<n.length;a+=1)n[a].c();s=lt()},m(a,u){w(e,a,u),m(a,r,u);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(a,u);m(a,s,u),l=!0},p(a,u){const c={};u&262144&&(c.$$scope={dirty:u,ctx:a}),e.$set(c),u&130&&(f=Ne(a[1]),oe(),n=no(n,u,i,1,a,f,o,s.parentNode,oo,Ur,s,Br),se())},i(a){if(!l){d(e.$$.fragment,a);for(let u=0;u<f.length;u+=1)d(n[u]);l=!0}},o(a){g(e.$$.fragment,a);for(let u=0;u<n.length;u+=1)g(n[u]);l=!1},d(a){a&&(h(r),h(s)),b(e,a);for(let u=0;u<n.length;u+=1)n[u].d(a)}}}function Zi(t){let e;return{c(){e=P("ul"),e.innerHTML=`<li><b>Click</b>
        on the map to place a new waypoint</li> <li><b>Click &amp; Drag</b>
        an existing waypoint to move it</li> <li><b>Hold shift and click on</b>
        an existing waypoint to delete it</li> <li>Press <b>Escape</b>
        to exit this mode</li>`},m(r,n){m(r,e,n)},p:Y,d(r){r&&h(e)}}}function Ur(t,e){let r,n,o,s;function l(i){e[8](i,e[15])}let f={markerPositionUpdated:e[7]};return e[15].lngLat!==void 0&&(f.markerPosition=e[15].lngLat),n=new vo({props:f}),U.push(()=>G(n,"markerPosition",l)),{key:t,first:null,c(){r=lt(),_(n.$$.fragment),this.first=r},m(i,a){m(i,r,a),w(n,i,a),s=!0},p(i,a){e=i;const u={};!o&&a&2&&(o=!0,u.markerPosition=e[15].lngLat,q(()=>o=!1)),n.$set(u)},i(i){s||(d(n.$$.fragment,i),s=!0)},o(i){g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(n,i)}}}function Xi(t){let e,r,n,o,s,l,f,i;const a=[Gi,Vi],u=[];function c(y,k){return y[0]?0:1}e=c(t),r=u[e]=a[e](t);let p=t[2]&&xr(t),$=!t[0]&&jr(t);return{c(){r.c(),n=L(),p&&p.c(),o=L(),$&&$.c(),s=lt()},m(y,k){u[e].m(y,k),m(y,n,k),p&&p.m(y,k),m(y,o,k),$&&$.m(y,k),m(y,s,k),l=!0,f||(i=[_t(window,"keydown",t[5]),_t(window,"keyup",t[6])],f=!0)},p(y,[k]){let C=e;e=c(y),e===C?u[e].p(y,k):(oe(),g(u[C],1,1,()=>{u[C]=null}),se(),r=u[e],r?r.p(y,k):(r=u[e]=a[e](y),r.c()),d(r,1),r.m(n.parentNode,n)),y[2]?p?p.p(y,k):(p=xr(y),p.c(),p.m(o.parentNode,o)):p&&(p.d(1),p=null),y[0]?$&&(oe(),g($,1,1,()=>{$=null}),se()):$?($.p(y,k),k&1&&d($,1)):($=jr(y),$.c(),d($,1),$.m(s.parentNode,s))},i(y){l||(d(r),d($),l=!0)},o(y){g(r),g($),l=!1},d(y){y&&(h(n),h(o),h(s)),u[e].d(y),p&&p.d(y),$&&$.d(y),f=!1,ro(i)}}}function Yi(t,e,r){let n;X(t,ee,T=>r(11,n=T));let o=!0,s=[],l,f=!1,i=0;function a(T){o||(f||(s.push({id:i++,lngLat:T.lngLat}),r(1,s),k()),f&&s.length>0&&(u(T.lngLat),k()))}function u(T){let E=new gr.LngLat(0,-90).distanceTo(new gr.LngLat(0,90)),M;s.forEach(F=>{const A=F.lngLat;E>=T.distanceTo(A)&&(M=A,E=T.distanceTo(A))}),M&&r(1,s=s.filter(F=>{const A=F.lngLat;return A.lng!=(M==null?void 0:M.lng)||A.lat!=(M==null?void 0:M.lat)}))}function c(){r(0,o=!1),n.on("click",a)}function p(){r(0,o=!0),n.off("click",a),r(1,s=[]),n.getSource("route")&&(n.removeLayer("route"),n.removeSource("route"))}function $(T){T.key==="Shift"&&(f=!0)}function y(T){T.key==="Shift"&&(f=!1)}function k(){if(s.length<2)return;const T=s.map(I=>[I.lngLat.lng,I.lngLat.lat]);r(2,l=so(T,{})),l.properties&&r(2,l.properties.length=go(l)*1e3,l),C()}function C(){var T;n.getSource("route")?(T=n.getSource("route"))==null||T.setData(l):(n.addSource("route",{type:"geojson",data:l}),n.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":8}}))}function v(T,I){t.$$.not_equal(I.lngLat,T)&&(I.lngLat=T,r(1,s))}return[o,s,l,c,p,$,y,k,v]}class Ji extends R{constructor(e){super(),H(this,e,Yi,Xi,W,{})}}function Qi(t){let e;return{c(){e=S(`Open Government License
  `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function el(t){let e,r,n,o,s;return n=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Qi]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=S("License: "),_(n.$$.fragment),o=S(`. Contains OS data © Crown copyright and database right
  2023.`)},m(l,f){m(l,e,f),D(e,r),w(n,e,null),D(e,o),s=!0},p(l,[f]){const i={};f&1&&(i.$$scope={dirty:f,ctx:l}),n.$set(i)},i(l){s||(d(n.$$.fragment,l),s=!0)},o(l){g(n.$$.fragment,l),s=!1},d(l){l&&h(e),b(n)}}}class Ue extends R{constructor(e){super(),H(this,e,null,el,W,{})}}function Rr(t,e,r){const n=t.slice();return n[2]=e[r],n}function Hr(t,e,r){const n=t.slice();return n[5]=e[r],n}function Wr(t){let e,r;return{c(){e=P("span"),r=S(` 
    `),je(e,"background",t[5]),je(e,"width","100%"),je(e,"border","1px solid black")},m(n,o){m(n,e,o),D(e,r)},p(n,o){o&1&&je(e,"background",n[5])},d(n){n&&h(e)}}}function zr(t){let e,r=t[2]+"",n;return{c(){e=P("span"),n=S(r)},m(o,s){m(o,e,s),D(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&be(n,r)},d(o){o&&h(e)}}}function tl(t){let e,r,n,o=Ne(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Wr(Hr(t,o,i));let l=Ne(t[1]),f=[];for(let i=0;i<l.length;i+=1)f[i]=zr(Rr(t,l,i));return{c(){e=P("div");for(let i=0;i<s.length;i+=1)s[i].c();r=L(),n=P("div");for(let i=0;i<f.length;i+=1)f[i].c();je(e,"display","flex"),je(n,"display","flex"),je(n,"justify-content","space-between")},m(i,a){m(i,e,a);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);m(i,r,a),m(i,n,a);for(let u=0;u<f.length;u+=1)f[u]&&f[u].m(n,null)},p(i,[a]){if(a&1){o=Ne(i[0]);let u;for(u=0;u<o.length;u+=1){const c=Hr(i,o,u);s[u]?s[u].p(c,a):(s[u]=Wr(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length}if(a&2){l=Ne(i[1]);let u;for(u=0;u<l.length;u+=1){const c=Rr(i,l,u);f[u]?f[u].p(c,a):(f[u]=zr(c),f[u].c(),f[u].m(n,null))}for(;u<f.length;u+=1)f[u].d(1);f.length=l.length}},i:Y,o:Y,d(i){i&&(h(e),h(r),h(n)),Bt(s,i),Bt(f,i)}}}function rl(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class Ze extends R{constructor(e){super(),H(this,e,rl,tl,W,{colorScale:0,limits:1})}}function nl(t){let e;return{c(){e=S("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ol(t){let e;return{c(){e=S(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function sl(t){let e;return{c(){e=S(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function il(t){let e;return{c(){e=S(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ll(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[ol]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[sl]},$$scope:{ctx:t}}}),u=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[il]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=S("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=S(". Output area boundaries from "),_(s.$$.fragment),l=S("."),f=L(),i=P("p"),a=S("License: "),_(u.$$.fragment),c=S(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m($,f,y),m($,i,y),D(i,a),w(u,i,null),D(i,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const C={};y&65536&&(C.$$scope={dirty:y,ctx:$}),s.$set(C);const v={};y&65536&&(v.$$scope={dirty:y,ctx:$}),u.$set(v)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(u.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(f),h(i)),b(n),b(s),b(u)}}}function al(t){let e,r,n;return r=new re({props:{$$slots:{default:[ll]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Vr(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function fl(t){let e;return{c(){e=S("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ul(t){let e;return{c(){e=S(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function cl(t){let e;return{c(){e=S(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pl(t){let e;return{c(){e=S(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $l(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,y;return s=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[ul]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[cl]},$$scope:{ctx:t}}}),p=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[pl]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=L(),n=P("p"),o=S("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),l=S(". Output area boundaries from "),_(f.$$.fragment),i=S("."),a=L(),u=P("p"),c=S("License: "),_(p.$$.fragment),$=S(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(k,C){m(k,e,C),m(k,r,C),m(k,n,C),D(n,o),w(s,n,null),D(n,l),w(f,n,null),D(n,i),m(k,a,C),m(k,u,C),D(u,c),w(p,u,null),D(u,$),y=!0},p(k,C){const v={};C&65536&&(v.$$scope={dirty:C,ctx:k}),s.$set(v);const T={};C&65536&&(T.$$scope={dirty:C,ctx:k}),f.$set(T);const I={};C&65536&&(I.$$scope={dirty:C,ctx:k}),p.$set(I)},i(k){y||(d(s.$$.fragment,k),d(f.$$.fragment,k),d(p.$$.fragment,k),y=!0)},o(k){g(s.$$.fragment,k),g(f.$$.fragment,k),g(p.$$.fragment,k),y=!1},d(k){k&&(h(e),h(r),h(n),h(a),h(u)),b(s),b(f),b(p)}}}function ml(t){let e,r,n;return r=new re({props:{$$slots:{default:[$l]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Gr(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function hl(t){let e;return{c(){e=S("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function dl(t){let e;return{c(){e=S(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function gl(t){let e;return{c(){e=S(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _l(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[dl]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[gl]},$$scope:{ctx:t}}}),i=new Ue({}),{c(){e=P("p"),r=S("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=S(". Output area boundaries from "),_(s.$$.fragment),l=S("."),f=L(),_(i.$$.fragment)},m(u,c){m(u,e,c),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&65536&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&65536&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function wl(t){let e,r,n;return r=new re({props:{$$slots:{default:[_l]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function qr(t){let e,r,n,o;return n=new Ze({props:{colorScale:t[4],limits:t[7]().map(vl)}}),{c(){e=P("p"),e.textContent="(people per square kilometres)",r=L(),_(n.$$.fragment)},m(s,l){m(s,e,l),m(s,r,l),w(n,s,l),o=!0},p:Y,i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function bl(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,y;function k(O){t[9](O)}let C={id:"percent_households_with_car",$$slots:{right:[al],default:[nl]},$$scope:{ctx:t}};t[0]!==void 0&&(C.checked=t[0]),e=new te({props:C}),U.push(()=>G(e,"checked",k)),e.$on("change",t[10]);let v=t[3]=="percent_households_with_car"&&Vr(t);function T(O){t[11](O)}let I={id:"average_cars_per_household",$$slots:{right:[ml],default:[fl]},$$scope:{ctx:t}};t[1]!==void 0&&(I.checked=t[1]),s=new te({props:I}),U.push(()=>G(s,"checked",T)),s.$on("change",t[12]);let E=t[3]=="average_cars_per_household"&&Gr(t);function M(O){t[13](O)}let F={id:"population_density",$$slots:{right:[wl],default:[hl]},$$scope:{ctx:t}};t[2]!==void 0&&(F.checked=t[2]),a=new te({props:F}),U.push(()=>G(a,"checked",M)),a.$on("change",t[14]);let A=t[3]=="population_density"&&qr(t);return $=new Q({props:{layer:Ae,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=L(),v&&v.c(),o=L(),_(s.$$.fragment),f=L(),E&&E.c(),i=L(),_(a.$$.fragment),c=L(),A&&A.c(),p=L(),_($.$$.fragment)},m(O,N){w(e,O,N),m(O,n,N),v&&v.m(O,N),m(O,o,N),w(s,O,N),m(O,f,N),E&&E.m(O,N),m(O,i,N),w(a,O,N),m(O,c,N),A&&A.m(O,N),m(O,p,N),w($,O,N),y=!0},p(O,[N]){const B={};N&65536&&(B.$$scope={dirty:N,ctx:O}),!r&&N&1&&(r=!0,B.checked=O[0],q(()=>r=!1)),e.$set(B),O[3]=="percent_households_with_car"?v?(v.p(O,N),N&8&&d(v,1)):(v=Vr(O),v.c(),d(v,1),v.m(o.parentNode,o)):v&&(oe(),g(v,1,1,()=>{v=null}),se());const Z={};N&65536&&(Z.$$scope={dirty:N,ctx:O}),!l&&N&2&&(l=!0,Z.checked=O[1],q(()=>l=!1)),s.$set(Z),O[3]=="average_cars_per_household"?E?(E.p(O,N),N&8&&d(E,1)):(E=Gr(O),E.c(),d(E,1),E.m(i.parentNode,i)):E&&(oe(),g(E,1,1,()=>{E=null}),se());const ne={};N&65536&&(ne.$$scope={dirty:N,ctx:O}),!u&&N&4&&(u=!0,ne.checked=O[2],q(()=>u=!1)),a.$set(ne),O[3]=="population_density"?A?(A.p(O,N),N&8&&d(A,1)):(A=qr(O),A.c(),d(A,1),A.m(p.parentNode,p)):A&&(oe(),g(A,1,1,()=>{A=null}),se());const z={};N&8&&(z.show=O[3]!=""),$.$set(z)},i(O){y||(d(e.$$.fragment,O),d(v),d(s.$$.fragment,O),d(E),d(a.$$.fragment,O),d(A),d($.$$.fragment,O),y=!0)},o(O){g(e.$$.fragment,O),g(v),g(s.$$.fragment,O),g(E),g(a.$$.fragment,O),g(A),g($.$$.fragment,O),y=!1},d(O){O&&(h(n),h(o),h(f),h(i),h(c),h(p)),b(e,O),v&&v.d(O),b(s,O),E&&E.d(O),b(a,O),A&&A.d(O),b($,O)}}}let Ae="census_output_areas";const vl=t=>t.toLocaleString();function yl(t,e,r){let n;X(t,ee,I=>r(8,n=I));let o=`${Ae}-outline`,s=V.sequential_low_to_high,l=!1,f=!1,i=!1,a="";fe(n,Ae,`${ie()}/v1/${Ae}.pmtiles`),Ke(n,{id:Ae,source:Ae,sourceLayer:Ae,color:"black",opacity:ue(.5,.7)}),ge(n,{id:o,source:Ae,sourceLayer:Ae,color:"black",width:.5});function u(I){let E=I.properties.OA21CD,M=I.properties[a];return a=="percent_households_with_car"?`<p>${M}% of households in ${E} have 1 or more cars</p>`:a=="average_cars_per_household"?`<p>Households in ${E} have an average of ${M} cars</p>`:`<p>There are ${M.toLocaleString()} people per square kilometre in ${E}</p>`}function c(I){let E=I.detail.properties.OA21CD;a=="percent_households_with_car"||a=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${E}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${E}`,"_blank")}function p(){return a=="percent_households_with_car"?[0,20,40,60,80,100]:a=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(I){l=I,r(0,l)}const y=()=>{r(1,f=!1),r(2,i=!1)};function k(I){f=I,r(1,f)}const C=()=>{r(0,l=!1),r(2,i=!1)};function v(I){i=I,r(2,i)}const T=()=>{r(0,l=!1),r(1,f=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,a="percent_households_with_car"):f?r(3,a="average_cars_per_household"):i?r(3,a="population_density"):r(3,a=""),a?(n.setPaintProperty(Ae,"fill-color",qe(["get",a],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,f,i,a,s,u,c,p,n,$,y,k,C,v,T]}class kl extends R{constructor(e){super(),H(this,e,yl,bl,W,{})}}function Sl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Tl(t){let e;return{c(){e=S(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cl(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Tl]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=S("Data from "),_(n.$$.fragment),o=S(", as of December 2022."),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Ll(t){let e,r,n;return r=new re({props:{$$slots:{default:[Cl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Al(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:We,$$slots:{right:[Ll],default:[Sl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:We,tooltip:Ol,show:t[0],clickable:!0}}),o.$on("click",Dl),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let We="combined_authorities";function Ol(t){return`<p>${t.properties.name}</p>`}function Dl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function El(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.combined_authorities,s=`${We}-outline`;ar(n,We,`${ie()}/v1/${We}.geojson`),Ke(n,{id:We,source:We,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:We,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Pl extends R{constructor(e){super(),H(this,e,El,Al,W,{})}}function Ml(t){let e;return{c(){e=S("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Nl(t){let e;return{c(){e=S(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Il(t){let e;return{c(){e=S(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fl(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Nl]},$$scope:{ctx:t}}}),s=new x({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Il]},$$scope:{ctx:t}}}),i=new Ue({}),{c(){e=P("p"),r=S("The 2019 English IMD scores come from "),_(n.$$.fragment),o=S(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),l=S("."),f=L(),_(i.$$.fragment)},m(u,c){m(u,e,c),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function Bl(t){let e,r,n;return r=new re({props:{$$slots:{default:[Fl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kr(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function xl(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:Oe,$$slots:{right:[Bl],default:[Ml]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&Kr(t);return s=new Q({props:{layer:Oe,tooltip:jl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=Kr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Oe="imd";function jl(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function Ul(t,e,r){let n;X(t,ee,a=>r(2,n=a));let o=`${Oe}-outline`,s=V.sequential_low_to_high,l=[0,2,4,6,8,10];fe(n,Oe,`${ie()}/v1/${Oe}.pmtiles`),Ke(n,{id:Oe,source:Oe,sourceLayer:Oe,color:qe(["-",10,["get","decile"]],l,s),opacity:ue(.5,.7)}),ge(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});let f=!1;function i(a){f=a,r(0,f)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",f?"visible":"none")},[f,s,n,i]}class Rl extends R{constructor(e){super(),H(this,e,Ul,xl,W,{})}}function Hl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Wl(t){let e;return{c(){e=S(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zl(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Wl]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=S("Data from "),_(n.$$.fragment),o=S(", as of May 2023."),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Vl(t){let e,r,n;return r=new re({props:{$$slots:{default:[zl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Gl(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:ze,$$slots:{right:[Vl],default:[Hl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:ze,tooltip:ql,show:t[0],clickable:!0}}),o.$on("click",Kl),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let ze="local_authority_districts";function ql(t){return`<p>${t.properties.name}</p>`}function Kl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function Zl(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.local_authority_districts,s=`${ze}-outline`;ar(n,ze,`${ie()}/v1/${ze}.geojson`),Ke(n,{id:ze,source:ze,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:ze,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Xl extends R{constructor(e){super(),H(this,e,Zl,Gl,W,{})}}function Yl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Jl(t){let e;return{c(){e=S(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ql(t){let e;return{c(){e=S(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ea(t){let e;return{c(){e=S(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ta(t){let e;return{c(){e=S("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ra(t){let e;return{c(){e=S(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function na(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,y,k,C,v,T,I,E,M,F;return n=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Jl]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Ql]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[ea]},$$scope:{ctx:t}}}),$=new x({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[ta]},$$scope:{ctx:t}}}),T=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[ra]},$$scope:{ctx:t}}}),M=new Ue({}),{c(){e=P("p"),r=S("LPAs may be a "),_(n.$$.fragment),o=S(", "),_(s.$$.fragment),l=S("y, or "),_(f.$$.fragment),i=S("."),a=L(),u=P("p"),c=P("strong"),p=S(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),y=S(" to get more details."),k=L(),C=P("p"),v=S("Data from ONS Geography via "),_(T.$$.fragment),I=S(", as of November 2022."),E=L(),_(M.$$.fragment)},m(A,O){m(A,e,O),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),w(f,e,null),D(e,i),m(A,a,O),m(A,u,O),D(u,c),D(c,p),w($,c,null),D(c,y),m(A,k,O),m(A,C,O),D(C,v),w(T,C,null),D(C,I),m(A,E,O),w(M,A,O),F=!0},p(A,O){const N={};O&32&&(N.$$scope={dirty:O,ctx:A}),n.$set(N);const B={};O&32&&(B.$$scope={dirty:O,ctx:A}),s.$set(B);const Z={};O&32&&(Z.$$scope={dirty:O,ctx:A}),f.$set(Z);const ne={};O&32&&(ne.$$scope={dirty:O,ctx:A}),$.$set(ne);const z={};O&32&&(z.$$scope={dirty:O,ctx:A}),T.$set(z)},i(A){F||(d(n.$$.fragment,A),d(s.$$.fragment,A),d(f.$$.fragment,A),d($.$$.fragment,A),d(T.$$.fragment,A),d(M.$$.fragment,A),F=!0)},o(A){g(n.$$.fragment,A),g(s.$$.fragment,A),g(f.$$.fragment,A),g($.$$.fragment,A),g(T.$$.fragment,A),g(M.$$.fragment,A),F=!1},d(A){A&&(h(e),h(a),h(u),h(k),h(C),h(E)),b(n),b(s),b(f),b($),b(T),b(M,A)}}}function oa(t){let e,r,n;return r=new re({props:{$$slots:{default:[na]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function sa(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:De,$$slots:{right:[oa],default:[Yl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:De,tooltip:ia,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="local_planning_authorities";function ia(t){return`<p>${t.properties.name}</p>`}function la(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.local_planning_authorities,s=`${De}-outline`;fe(n,De,`${ie()}/v1/${De}.pmtiles`),Ke(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:De,sourceLayer:De,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class aa extends R{constructor(e){super(),H(this,e,la,sa,W,{})}}function fa(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ua(t){let e;return{c(){e=S(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ca(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[ua]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=S("Data from "),_(n.$$.fragment),o=S(", as of May 2023."),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function pa(t){let e,r,n;return r=new re({props:{$$slots:{default:[ca]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function $a(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ee,$$slots:{right:[pa],default:[fa]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ee,tooltip:ma,show:t[0],clickable:!0}}),o.$on("click",ha),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="parliamentary_constituencies";function ma(t){return`<p>${t.properties.Name}</p>`}function ha(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function da(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.parliamentary_constituencies,s=`${Ee}-outline`;fe(n,Ee,`${ie()}/v1/${Ee}.pmtiles`),Ke(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class ga extends R{constructor(e){super(),H(this,e,da,$a,W,{})}}function _a(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function wa(t){let e;return{c(){e=S(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ba(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[wa]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=S("Data from "),_(n.$$.fragment),o=S(", as of May 2023."),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function va(t){let e,r,n;return r=new re({props:{$$slots:{default:[ba]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ya(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Pe,$$slots:{right:[va],default:[_a]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Pe,tooltip:ka,show:t[0],clickable:!0}}),o.$on("click",Sa),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Pe="wards";function ka(t){return`<p>${t.properties.name}</p>`}function Sa(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Ta(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.wards,s=`${Pe}-outline`;fe(n,Pe,`${ie()}/v1/${Pe}.pmtiles`),Ke(n,{id:Pe,source:Pe,sourceLayer:Pe,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Pe,sourceLayer:Pe,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Ca extends R{constructor(e){super(),H(this,e,Ta,ya,W,{})}}function La(t){let e;return{c(){e=S("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Aa(t){let e,r,n,o;return n=new x({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[La]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=S("License: "),_(n.$$.fragment)},m(s,l){m(s,e,l),D(e,r),w(n,e,null),o=!0},p(s,[l]){const f={};l&1&&(f.$$scope={dirty:l,ctx:s}),n.$set(f)},i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&h(e),b(n)}}}class Xe extends R{constructor(e){super(),H(this,e,null,Aa,W,{})}}function Oa(t){let e,r,n;return e=new _e({props:{color:V.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=S(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Da(t){let e;return{c(){e=S(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ea(t){let e,r,n,o,s,l,f,i,a;return s=new x({props:{href:"https://gtfs.org",$$slots:{default:[Da]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=P("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=L(),n=P("p"),o=S("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),l=S(`, and doesn't include which routes are run or the
        frequency of service.`),f=L(),_(i.$$.fragment)},m(u,c){m(u,e,c),m(u,r,c),m(u,n,c),D(n,o),w(s,n,null),D(n,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&8&&(p.$$scope={dirty:c,ctx:u}),s.$set(p)},i(u){a||(d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(r),h(n),h(f)),b(s),b(i,u)}}}function Pa(t){let e,r,n;return r=new re({props:{$$slots:{default:[Ea]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ma(t){let e,r,n,o,s;function l(i){t[1](i)}let f={id:Ye,$$slots:{right:[Pa],default:[Oa]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ye,tooltip:Na,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&8&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ye="bus_routes";function Na(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Ia(t,e,r){let n;X(t,ee,l=>r(2,n=l)),fe(n,Ye,`${ie()}/v1/${Ye}.pmtiles`),ge(n,{id:Ye,source:Ye,sourceLayer:Ye,color:["case",["boolean",["get","has_bus_lane"],!1],V.bus_route_with_lane,V.bus_route_without_lane],width:5,opacity:ue(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class Fa extends R{constructor(e){super(),H(this,e,Ia,Ma,W,{})}}function Zr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function Ba(t){let e;return{c(){e=S("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xa(t){let e,r,n,o,s,l,f,i;return f=new Xe({}),{c(){e=P("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=L(),n=P("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=L(),s=P("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=L(),_(f.$$.fragment)},m(a,u){m(a,e,u),m(a,r,u),m(a,n,u),m(a,o,u),m(a,s,u),m(a,l,u),w(f,a,u),i=!0},p:Y,i(a){i||(d(f.$$.fragment,a),i=!0)},o(a){g(f.$$.fragment,a),i=!1},d(a){a&&(h(e),h(r),h(n),h(o),h(s),h(l)),b(f,a)}}}function ja(t){let e,r,n;return r=new re({props:{$$slots:{default:[xa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Xr(t){let e,r,n=Ne(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=Yr(Zr(t,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=lt()},m(l,f){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,f);m(l,e,f),r=!0},p(l,f){if(f&2){n=Ne(l[1]);let i;for(i=0;i<n.length;i+=1){const a=Zr(l,n,i);o[i]?(o[i].p(a,f),d(o[i],1)):(o[i]=Yr(a),o[i].c(),d(o[i],1),o[i].m(e.parentNode,e))}for(oe(),i=n.length;i<o.length;i+=1)s(i);se()}},i(l){if(!r){for(let f=0;f<n.length;f+=1)d(o[f]);r=!0}},o(l){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)g(o[f]);r=!1},d(l){l&&h(e),Bt(o,l)}}}function Yr(t){let e,r,n,o=t[4]+"",s,l,f;return r=new _e({props:{color:t[5]}}),{c(){e=P("div"),_(r.$$.fragment),n=L(),s=S(o),l=L()},m(i,a){m(i,e,a),w(r,e,null),D(e,n),D(e,s),D(e,l),f=!0},p:Y,i(i){f||(d(r.$$.fragment,i),f=!0)},o(i){g(r.$$.fragment,i),f=!1},d(i){i&&h(e),b(r)}}}function Ua(t){let e,r,n,o,s,l;function f(u){t[2](u)}let i={id:Je,$$slots:{right:[ja],default:[Ba]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&Xr(t);return s=new Q({props:{layer:Je,tooltip:Ra,show:t[0],clickable:!0}}),s.$on("click",Ha),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=Xr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Je="cycle_paths";function Ra(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Ha(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Wa(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=[["Separated tracks",V.cycle_paths.track],["Unprotected lanes",V.cycle_paths.lane],["Shared-use (segregated)",V.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",V.cycle_paths.shared_use_unsegregated]];fe(n,Je,`${ie()}/v1/${Je}.pmtiles`),ge(n,{id:Je,source:Je,sourceLayer:Je,color:hn(["get","kind"],{track:V.cycle_paths.track,lane:V.cycle_paths.lane,shared_use_segregated:V.cycle_paths.shared_use_segregated,shared_use_unsegregated:V.cycle_paths.shared_use_unsegregated},"red"),width:Ht,opacity:ue(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class za extends R{constructor(e){super(),H(this,e,Wa,Ua,W,{})}}function Va(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ga(t){let e;return{c(){e=S(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function qa(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Ga]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=S("Data from the "),_(n.$$.fragment),o=S(", as of September 2021."),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Ka(t){let e,r,n;return r=new re({props:{$$slots:{default:[qa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Za(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:Qe,$$slots:{right:[Ka],default:[Va]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Qe,tooltip:Xa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Qe="mrn";function Xa(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Ya(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=V.mrn;fe(n,Qe,`${ie()}/v1/${Qe}.pmtiles`),ge(n,{id:Qe,source:Qe,sourceLayer:Qe,color:o,width:7,opacity:ue(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Ja extends R{constructor(e){super(),H(this,e,Ya,Za,W,{})}}function Qa(t){let e;return{c(){e=S("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ef(t){let e;return{c(){e=S("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tf(t){let e;return{c(){e=S("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rf(t){let e,r,n,o,s,l,f,i,a,u,c;return f=new x({props:{href:"https://www.pct.bike",$$slots:{default:[ef]},$$scope:{ctx:t}}}),a=new x({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[tf]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=L(),n=P("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=L(),s=P("p"),l=S("See "),_(f.$$.fragment),i=S(" and "),_(a.$$.fragment),u=S(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),D(s,l),w(f,s,null),D(s,i),w(a,s,null),D(s,u),c=!0},p(p,$){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),f.$set(y);const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),a.$set(k)},i(p){c||(d(f.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(f.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(f),b(a)}}}function nf(t){let e,r,n;return r=new re({props:{$$slots:{default:[rf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Jr(t){let e,r,n,o,s,l,f,i;e=new Ze({props:{colorScale:t[3],limits:t[4]}});function a($){t[8]($)}let u={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(u.value=t[0]),n=new gn({props:u}),U.push(()=>G(n,"value",a)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new xt({props:p}),U.push(()=>G(l,"value",c)),l.$on("change",t[6]),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),s=L(),_(l.$$.fragment)},m($,y){w(e,$,y),m($,r,y),w(n,$,y),m($,s,y),w(l,$,y),i=!0},p($,y){const k={};!o&&y&1&&(o=!0,k.value=$[0],q(()=>o=!1)),n.$set(k);const C={};!f&&y&2&&(f=!0,C.value=$[1],q(()=>f=!1)),l.$set(C)},i($){i||(d(e.$$.fragment,$),d(n.$$.fragment,$),d(l.$$.fragment,$),i=!0)},o($){g(e.$$.fragment,$),g(n.$$.fragment,$),g(l.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(l,$)}}}function of(t){let e,r,n,o,s,l,f,i;function a(p){t[7](p)}let u={id:st,$$slots:{right:[nf],default:[Qa]},$$scope:{ctx:t}};t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),U.push(()=>G(e,"checked",a));let c=t[2]&&Jr(t);return s=new Q({props:{layer:st,tooltip:t[5],show:t[2]&&t[0]==st,clickable:!1}}),f=new Q({props:{layer:Ft,tooltip:t[5],show:t[2]&&t[0]==Ft,clickable:!1}}),{c(){_(e.$$.fragment),n=L(),c&&c.c(),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(f,p,$),i=!0},p(p,[$]){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,y.checked=p[2],q(()=>r=!1)),e.$set(y),p[2]?c?(c.p(p,$),$&4&&d(c,1)):(c=Jr(p),c.c(),d(c,1),c.m(o.parentNode,o)):c&&(oe(),g(c,1,1,()=>{c=null}),se());const k={};$&5&&(k.show=p[2]&&p[0]==st),s.$set(k);const C={};$&5&&(C.show=p[2]&&p[0]==Ft),f.$set(C)},i(p){i||(d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(f.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(f.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(l)),b(e,p),c&&c.d(p),b(s,p),b(f,p)}}}let st="pct_commute",Ft="pct_school";function sf(t,e,r){let n;X(t,ee,y=>r(10,n=y));let o=V.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=st,f="baseline";for(let y of[st,Ft])fe(n,y,`${ie()}/v1/${y}.pmtiles`),ge(n,{id:y,source:y,sourceLayer:y,color:qe(["get",f],s,o),width:Ht,opacity:ue(.5,1)});let i=!1;function a(y){let k=y.properties.baseline,C=y.properties.gov_target,v=y.properties.go_dutch,T=`<h2>Trip purpose: ${l==st?"commuting":"school"}</h2>`;if(T+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)T+=`<p>Government target (2025): <b>${C.toLocaleString()}</b></p>`,T+=`<p>Go Dutch: <b>${v.toLocaleString()}</b></p>`;else{let I=(C/k).toFixed(1),E=(v/k).toFixed(1);T+=`<p>Government target (2025): ${C.toLocaleString()} (<b>${I}x</b> of baseline)</p>`,T+=`<p>Go Dutch: ${v.toLocaleString()} (<b>${E}x</b> of baseline)</p>`}return T}function u(){n.setPaintProperty(l,"line-color",qe(["get",f],s,o))}function c(y){i=y,r(2,i)}function p(y){l=y,r(0,l)}function $(y){f=y,r(1,f)}return[l,f,i,o,s,a,u,c,p,$]}class lf extends R{constructor(e){super(),H(this,e,sf,of,W,{})}}function af(t){let e;return{c(){e=S("OS Speeds")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ff(t){let e;return{c(){e=S("Basemap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function uf(t){let e;return{c(){e=S(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function cf(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[ff]},$$scope:{ctx:t}}}),u=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[uf]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=S("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=S(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=L(),l=P("p"),l.textContent="Data valid as of 1 September, 2023",f=L(),i=P("p"),a=S(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),c=S(".")},m($,y){m($,e,y),D(e,r),w(n,e,null),D(e,o),m($,s,y),m($,l,y),m($,f,y),m($,i,y),D(i,a),w(u,i,null),D(i,c),p=!0},p($,y){const k={};y&256&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const C={};y&256&&(C.$$scope={dirty:y,ctx:$}),u.$set(C)},i($){p||(d(n.$$.fragment,$),d(u.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(s),h(l),h(f),h(i)),b(n),b(u)}}}function pf(t){let e,r,n;return r=new re({props:{$$slots:{default:[cf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Qr(t){let e,r,n,o,s;e=new Ze({props:{colorScale:t[2],limits:t[3]}});function l(i){t[6](i)}let f={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(f.value=t[0]),n=new gn({props:f}),U.push(()=>G(n,"value",l)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(i,a){w(e,i,a),m(i,r,a),w(n,i,a),s=!0},p(i,a){const u={};!o&&a&1&&(o=!0,u.value=i[0],q(()=>o=!1)),n.$set(u)},i(i){s||(d(e.$$.fragment,i),d(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(e,i),b(n,i)}}}function $f(t){let e,r,n,o,s,l;function f(u){t[5](u)}let i={id:Ve,$$slots:{right:[pf],default:[af]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[1]&&Qr(t);return s=new Q({props:{layer:Ve,tooltip:mf,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&2&&(r=!0,p.checked=u[1],q(()=>r=!1)),e.$set(p),u[1]?a?(a.p(u,c),c&2&&d(a,1)):(a=Qr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&2&&($.show=u[1]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Ve="road_speeds";function mf(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function hf(t,e,r){let n;X(t,ee,c=>r(7,n=c));let o=V.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";fe(n,Ve,`${fr()}/v1/${Ve}.pmtiles`),ge(n,{id:Ve,source:Ve,sourceLayer:Ve,color:qe(["get",l],s,o),width:Ht,opacity:ue(.5,1)});let f=!1;function i(){n.setPaintProperty(Ve,"line-color",qe(["get",l],s,o))}function a(c){f=c,r(1,f)}function u(c){l=c,r(0,l)}return[l,f,o,s,i,a,u]}class df extends R{constructor(e){super(),H(this,e,hf,$f,W,{})}}function gf(t){let e;return{c(){e=S("OS Road widths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _f(t){let e;return{c(){e=S(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wf(t){let e,r,n,o,s,l,f,i,a;return f=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[_f]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=L(),n=P("p"),n.textContent="Data valid as of 1 September, 2023",o=L(),s=P("p"),l=S(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(f.$$.fragment),i=S(".")},m(u,c){m(u,e,c),m(u,r,c),m(u,n,c),m(u,o,c),m(u,s,c),D(s,l),w(f,s,null),D(s,i),a=!0},p(u,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),f.$set(p)},i(u){a||(d(f.$$.fragment,u),a=!0)},o(u){g(f.$$.fragment,u),a=!1},d(u){u&&(h(e),h(r),h(n),h(o),h(s)),b(f)}}}function bf(t){let e,r,n;return r=new re({props:{$$slots:{default:[wf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function en(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function vf(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:et,$$slots:{right:[bf],default:[gf]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&en(t);return s=new Q({props:{layer:et,tooltip:yf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=en(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let et="road_widths";function yf(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function kf(t,e,r){let n;X(t,ee,i=>r(4,n=i));let o=V.sequential_low_to_high,s=[0,5,10,15,20,100];fe(n,et,`${fr()}/v1/${et}.pmtiles`),ge(n,{id:et,source:et,sourceLayer:et,color:qe(["get","average"],s,o),width:Ht,opacity:ue(.5,1)});let l=!1;function f(i){l=i,r(0,l)}return[l,o,s,f]}class Sf extends R{constructor(e){super(),H(this,e,kf,vf,W,{})}}function Tf(t){let e,r,n;return{c(){e=P("input"),j(e,"class","govuk-file-upload"),j(e,"id","load-criticals"),j(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=_t(e,"change",t[4]),r=!0)},p:Y,d(o){o&&h(e),t[7](null),r=!1,n()}}}function tn(t){let e,r;return e=new Ot({props:{small:!0,$$slots:{default:[Lf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Cf(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new _e({props:{color:or}}),{c(){_(e.$$.fragment),r=S(`
        Show `),o=S(n),s=S(" issues")},m(f,i){w(e,f,i),m(f,r,i),m(f,o,i),m(f,s,i),l=!0},p(f,i){(!l||i&4)&&n!==(n=f[2].toLocaleString()+"")&&be(o,n)},i(f){l||(d(e.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o),h(s)),b(e,f)}}}function Lf(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[Cf]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),U.push(()=>G(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){w(e,l,f),n=!0},p(l,f){const i={};f&516&&(i.$$scope={dirty:f,ctx:l}),!r&&f&1&&(r=!0,i.checked=l[0],q(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function Af(t){let e,r,n,o,s,l;e=new dn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[Tf]},$$scope:{ctx:t}}}),n=new wn({props:{errorMessage:t[3]}});let f=t[2]>0&&tn(t);return{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),f&&f.c(),s=lt()},m(i,a){w(e,i,a),m(i,r,a),w(n,i,a),m(i,o,a),f&&f.m(i,a),m(i,s,a),l=!0},p(i,a){const u={};a&514&&(u.$$scope={dirty:a,ctx:i}),e.$set(u);const c={};a&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?f?(f.p(i,a),a&4&&d(f,1)):(f=tn(i),f.c(),d(f,1),f.m(s.parentNode,s)):f&&(oe(),g(f,1,1,()=>{f=null}),se())},i(i){l||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(f),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(f),l=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),f&&f.d(i)}}}function Of(t){let e,r,n,o,s,l;return e=new Te({props:{label:"Critical Issues",$$slots:{default:[Af]},$$scope:{ctx:t}}}),n=new Q({props:{layer:le+"-points",tooltip:Df,show:t[0],clickable:!1}}),s=new Q({props:{layer:le+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[le+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment)},m(f,i){w(e,f,i),m(f,r,i),w(n,f,i),m(f,o,i),w(s,f,i),l=!0},p(f,[i]){const a={};i&527&&(a.$$scope={dirty:i,ctx:f}),e.$set(a);const u={};i&1&&(u.show=f[0]),n.$set(u);const c={};i&1&&(c.show=f[0]),s.$set(c)},i(f){l||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o)),b(e,f),b(n,f),b(s,f)}}}let le="criticals",or="red";function Df(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function Ef(t,e,r){let n;X(t,ee,p=>r(6,n=p));let o,s=!0,l=0,f="";io(n,le),n.addSource(le,{type:"geojson",data:_n(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),wt(n,{id:`${le}-clusters`,source:le,filter:["has","point_count"],color:or,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${le}-counts`,source:le,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),wt(n,{id:`${le}-points`,source:le,filter:["!",["has","point_count"]],color:or,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await Mi(o.files[0]);n.getSource(le).setData($),r(2,l=$.features.length),r(3,f="")}catch($){r(3,f=`The file you loaded is broken: ${$}`)}}function a(p){n.getSource(le).getClusterExpansionZoom(p.detail.properties.cluster_id,($,y)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:y})})}function u(p){U[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${le}-counts`)&&n.setLayoutProperty(`${le}-counts`,"visibility",s?"visible":"none")},[s,o,l,f,i,a,n,u,c]}class Pf extends R{constructor(e){super(),H(this,e,Ef,Of,W,{})}}function Mf(t){let e,r,n;return e=new _e({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=S(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Nf(t){let e;return{c(){e=S("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function If(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[Nf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=S("This shows "),_(n.$$.fragment),o=S(" data from OpenStreetMap (as of 9 August 2023)."),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Ff(t){let e,r,n;return r=new re({props:{$$slots:{default:[If]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Bf(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ge,$$slots:{right:[Ff],default:[Mf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ge,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",xf),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Ge="crossings";function xf(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function jf(t,e,r){let n;X(t,ee,a=>r(4,n=a));let o=!1;function s(a){const u=a.properties.crossing;return`<p>${l.get(u)??`Crossing with unknown type (${u})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);fe(n,Ge,`${ie()}/v1/${Ge}.pmtiles`);let f=V[Ge];wt(n,{id:Ge,source:Ge,sourceLayer:Ge,color:f,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(a){o=a,r(0,o)}return[o,s,f,i]}class Uf extends R{constructor(e){super(),H(this,e,jf,Bf,W,{})}}function Rf(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Hf(t){let e;return{c(){e=S("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Wf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Hf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=S("Cycle parking, according to "),_(n.$$.fragment),o=S(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function zf(t){let e,r,n;return r=new re({props:{$$slots:{default:[Wf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Vf(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:tt,$$slots:{right:[zf],default:[Rf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:tt,tooltip:Gf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let tt="cycle_parking";function Gf(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function qf(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=V.cycle_parking;fe(n,tt,`${ie()}/v1/${tt}.pmtiles`),wt(n,{id:tt,source:tt,sourceLayer:tt,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Kf extends R{constructor(e){super(),H(this,e,qf,Vf,W,{})}}function Zf(t){let e,r,n,o;return e=new _e({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=L(),n=S(t[1])},m(s,l){w(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&be(n,s[1])},i(s){o||(d(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function Xf(t){let e;const r=t[6].default,n=cn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&pn(n,r,o,o[8],e?mn(r,o[8],s,null):$n(o[8]),null)},i(o){e||(d(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Yf(t){let e,r,n;return r=new re({props:{$$slots:{default:[Xf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Jf(t){let e,r,n,o,s;function l(i){t[7](i)}let f={id:t[0],$$slots:{right:[Yf],default:[Zf]},$$scope:{ctx:t}};return t[2]!==void 0&&(f.checked=t[2]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&1&&(u.id=i[0]),a&258&&(u.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,u.checked=i[2],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.layer=i[0]),a&4&&(c.show=i[2]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function Qf(t,e,r){let n;X(t,ee,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:f}=e,{pluralNoun:i}=e,a=V[l];fe(n,l,`${ie()}/v1/${l}.pmtiles`),Ke(n,{id:l,source:l,sourceLayer:l,color:a,opacity:ue(1,.7)});let u=!1;function c($){return`<p>${$.properties.name??`Unnamed ${f}`}</p>`}function p($){u=$,r(2,u)}return t.$$set=$=>{"name"in $&&r(0,l=$.name),"singularNoun"in $&&r(5,f=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[l,i,u,a,c,f,o,p,s]}class cr extends R{constructor(e){super(),H(this,e,Qf,Jf,W,{name:0,singularNoun:5,pluralNoun:1})}}function eu(t){let e;return{c(){e=S("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tu(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[eu]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=S("This shows "),_(n.$$.fragment),o=S(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function ru(t){let e,r;return e=new cr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[tu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class nu extends R{constructor(e){super(),H(this,e,null,ru,W,{})}}function ou(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=S(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function su(t){let e;return{c(){e=S("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function iu(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[su]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=S("This shows "),_(n.$$.fragment),o=S(" data from OpenStreetMap (as of 9 August 2023)."),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function lu(t){let e,r,n;return r=new re({props:{$$slots:{default:[iu]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function au(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:rt,$$slots:{right:[lu],default:[ou]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:rt,tooltip:fu,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const rt="railway_stations";function fu(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function uu(t,e,r){let n;X(t,ee,i=>r(3,n=i));const o=`${ie()}/v1/${rt}.geojson`;let s=!1;ar(n,rt,o);let l=V[rt];wt(n,{id:rt,source:rt,color:l,radius:co/2});function f(i){s=i,r(0,s)}return[s,l,f]}class cu extends R{constructor(e){super(),H(this,e,uu,au,W,{})}}function pu(t){let e;return{c(){e=S("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $u(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[pu]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=S("This shows "),_(n.$$.fragment),o=S(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=L(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function mu(t){let e,r;return e=new cr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[$u]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class hu extends R{constructor(e){super(),H(this,e,null,mu,W,{})}}function du(t){let e;return{c(){e=S("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function gu(t){let e;return{c(){e=S("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _u(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[du]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[gu]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=P("p"),r=S("This shows "),_(n.$$.fragment),o=S(" and "),_(s.$$.fragment),l=S(" data from OpenStreetMap (as of 9 August 2023)."),f=L(),_(i.$$.fragment)},m(u,c){m(u,e,c),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function wu(t){let e,r;return e=new cr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[_u]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class bu extends R{constructor(e){super(),H(this,e,null,wu,W,{})}}function vu(t){let e;return{c(){e=S("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yu(t){let e;return{c(){e=S(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ku(t){let e;return{c(){e=S("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Su(t){let e,r,n,o,s,l,f,i,a,u,c;return n=new x({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[yu]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[ku]},$$scope:{ctx:t}}}),u=new Ue({}),{c(){e=P("p"),r=S("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=S(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),l=S(" for details and caveats about the measurements."),f=L(),i=P("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,a=L(),_(u.$$.fragment)},m(p,$){m(p,e,$),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(p,f,$),m(p,i,$),m(p,a,$),w(u,p,$),c=!0},p(p,$){const y={};$&64&&(y.$$scope={dirty:$,ctx:p}),n.$set(y);const k={};$&64&&(k.$$scope={dirty:$,ctx:p}),s.$set(k)},i(p){c||(d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(h(e),h(f),h(i),h(a)),b(n),b(s),b(u,p)}}}function Tu(t){let e,r,n;return r=new re({props:{$$slots:{default:[Su]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function rn(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Cu(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:nt,$$slots:{right:[Tu],default:[vu]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&rn(t);return s=new Q({props:{layer:nt,tooltip:Lu,show:t[0],clickable:!0}}),s.$on("click",Au),{c(){_(e.$$.fragment),n=L(),a&&a.c(),o=L(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=rn(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let nt="vehicle_counts";function Lu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function Au(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function Ou(t,e,r){let n;X(t,ee,a=>r(4,n=a));let o=V.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];fe(n,nt,`${ie()}/v1/${nt}.pmtiles`),wt(n,{id:nt,source:nt,sourceLayer:nt,color:qe(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let f=!1;function i(a){f=a,r(0,f)}return[f,o,l,i]}class Du extends R{constructor(e){super(),H(this,e,Ou,Cu,W,{})}}function Eu(t){let e,r,n,o,s,l,f,i;return e=new hu({}),n=new nu({}),s=new bu({}),f=new cu({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment)},m(a,u){w(e,a,u),m(a,r,u),w(n,a,u),m(a,o,u),w(s,a,u),m(a,l,u),w(f,a,u),i=!0},i(a){i||(d(e.$$.fragment,a),d(n.$$.fragment,a),d(s.$$.fragment,a),d(f.$$.fragment,a),i=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(s.$$.fragment,a),g(f.$$.fragment,a),i=!1},d(a){a&&(h(r),h(o),h(l)),b(e,a),b(n,a),b(s,a),b(f,a)}}}function Pu(t){let e,r;return e=new Ot({props:{small:!0,$$slots:{default:[Eu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Mu(t){let e,r,n,o,s,l,f,i,a,u;return e=new za({}),n=new Ja({}),s=new Fa({}),f=new Kf({}),a=new Uf({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(f,c,p),m(c,i,p),w(a,c,p),u=!0},i(c){u||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),d(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(f,c),b(a,c)}}}function Nu(t){let e,r;return e=new Ot({props:{small:!0,$$slots:{default:[Mu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Iu(t){let e,r,n,o,s,l,f,i,a,u;return e=new ga({}),n=new Ca({}),s=new Pl({}),f=new Xl({}),a=new aa({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(f,c,p),m(c,i,p),w(a,c,p),u=!0},i(c){u||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),d(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(f,c),b(a,c)}}}function Fu(t){let e,r;return e=new Ot({props:{small:!0,$$slots:{default:[Iu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Bu(t){let e,r,n,o;return e=new kl({}),n=new Rl({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function xu(t){let e,r,n,o;return e=new Sf({}),n=new df({}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function ju(t){let e,r,n,o,s=lr()=="Private (development)",l,f;e=new Du({}),n=new lf({});let i=s&&xu();return{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),i&&i.c(),l=lt()},m(a,u){w(e,a,u),m(a,r,u),w(n,a,u),m(a,o,u),i&&i.m(a,u),m(a,l,u),f=!0},p:Y,i(a){f||(d(e.$$.fragment,a),d(n.$$.fragment,a),d(i),f=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(i),f=!1},d(a){a&&(h(r),h(o),h(l)),b(e,a),b(n,a),i&&i.d(a)}}}function Uu(t){let e,r,n,o,s;function l(i){t[5](i)}let f={displayEnableButton:!0};return t[2]!==void 0&&(f.isInactive=t[2]),e=new po({props:f}),t[4](e),U.push(()=>G(e,"isInactive",l)),o=new Ji({}),{c(){_(e.$$.fragment),n=L(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,a){const u={};!r&&a&4&&(r=!0,u.isInactive=i[2],q(()=>r=!1)),e.$set(u)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),t[4](null),b(e,i),b(o,i)}}}function Ru(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,y,k,C;return e=new Pf({}),n=new Te({props:{label:"Trip generators",$$slots:{default:[Pu]},$$scope:{ctx:t}}}),s=new Te({props:{label:"Existing infrastructure",$$slots:{default:[Nu]},$$scope:{ctx:t}}}),f=new Te({props:{label:"Boundaries",$$slots:{default:[Fu]},$$scope:{ctx:t}}}),a=new Te({props:{label:"Census",$$slots:{default:[Bu]},$$scope:{ctx:t}}}),c=new Te({props:{label:"Other",$$slots:{default:[ju]},$$scope:{ctx:t}}}),$=new Te({props:{label:"Tools",$$slots:{default:[Uu]},$$scope:{ctx:t}}}),k=new _o({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment),u=L(),_(c.$$.fragment),p=L(),_($.$$.fragment),y=L(),_(k.$$.fragment)},m(v,T){w(e,v,T),m(v,r,T),w(n,v,T),m(v,o,T),w(s,v,T),m(v,l,T),w(f,v,T),m(v,i,T),w(a,v,T),m(v,u,T),w(c,v,T),m(v,p,T),w($,v,T),m(v,y,T),w(k,v,T),C=!0},p(v,T){const I={};T&64&&(I.$$scope={dirty:T,ctx:v}),n.$set(I);const E={};T&64&&(E.$$scope={dirty:T,ctx:v}),s.$set(E);const M={};T&64&&(M.$$scope={dirty:T,ctx:v}),f.$set(M);const F={};T&64&&(F.$$scope={dirty:T,ctx:v}),a.$set(F);const A={};T&64&&(A.$$scope={dirty:T,ctx:v}),c.$set(A);const O={};T&70&&(O.$$scope={dirty:T,ctx:v}),$.$set(O);const N={};T&1&&(N.style=v[0]),k.$set(N)},i(v){C||(d(e.$$.fragment,v),d(n.$$.fragment,v),d(s.$$.fragment,v),d(f.$$.fragment,v),d(a.$$.fragment,v),d(c.$$.fragment,v),d($.$$.fragment,v),d(k.$$.fragment,v),C=!0)},o(v){g(e.$$.fragment,v),g(n.$$.fragment,v),g(s.$$.fragment,v),g(f.$$.fragment,v),g(a.$$.fragment,v),g(c.$$.fragment,v),g($.$$.fragment,v),g(k.$$.fragment,v),C=!1},d(v){v&&(h(r),h(o),h(l),h(i),h(u),h(p),h(y)),b(e,v),b(n,v),b(s,v),b(f,v),b(a,v),b(c,v),b($,v),b(k,v)}}}function Hu(t){let e,r,n,o;return e=new Te({props:{label:"Layers",open:!0,$$slots:{default:[Ru]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,l){w(e,s,l),r=!0,n||(o=_t(window,"keydown",t[3]),n=!0)},p(s,[l]){const f={};l&71&&(f.$$scope={dirty:l,ctx:s}),e.$set(f)},i(s){r||(d(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function Wu(t,e,r){let n;X(t,_r,a=>r(2,n=a));let{style:o}=e,s;function l(a){!n&&a.key=="Escape"&&(s.disableStreetView(),a.preventDefault())}function f(a){U[a?"unshift":"push"](()=>{s=a,r(1,s)})}function i(a){n=a,_r.set(n)}return t.$$set=a=>{"style"in a&&r(0,o=a.style)},[o,s,n,l,f,i]}class zu extends R{constructor(e){super(),H(this,e,Wu,Hu,W,{style:0})}}function Vu(t,e,r){let{loadFile:n}=e;return Rt(async()=>{let s=await(await fetch(`${fr()}/v1/random_schemes.geojson`)).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class Gu extends R{constructor(e){super(),H(this,e,Vu,null,W,{loadFile:0})}}function qu(t){let e;return{c(){e=S("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ku(t){let e;return{c(){e=S("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zu(t){let e,r,n=t[0].authority_or_region+"",o,s,l,f,i=t[0].capital_scheme_id+"",a,u,c,p,$=t[0].funding_programme+"",y,k,C,v,T,I,E;return v=new Ct({props:{$$slots:{default:[qu]},$$scope:{ctx:t}}}),v.$on("click",t[3]),I=new Ct({props:{disabled:t[1],title:t[2],$$slots:{default:[Ku]},$$scope:{ctx:t}}}),I.$on("click",t[4]),{c(){e=P("p"),r=S("Authority or region: "),o=S(n),s=L(),l=P("p"),f=S("Capital scheme ID: "),a=S(i),u=L(),c=P("p"),p=S("Funding programme: "),y=S($),k=L(),C=P("div"),_(v.$$.fragment),T=L(),_(I.$$.fragment),j(C,"class","govuk-button-group")},m(M,F){m(M,e,F),D(e,r),D(e,o),m(M,s,F),m(M,l,F),D(l,f),D(l,a),m(M,u,F),m(M,c,F),D(c,p),D(c,y),m(M,k,F),m(M,C,F),w(v,C,null),D(C,T),w(I,C,null),E=!0},p(M,F){(!E||F&1)&&n!==(n=M[0].authority_or_region+"")&&be(o,n),(!E||F&1)&&i!==(i=M[0].capital_scheme_id+"")&&be(a,i),(!E||F&1)&&$!==($=M[0].funding_programme+"")&&be(y,$);const A={};F&256&&(A.$$scope={dirty:F,ctx:M}),v.$set(A);const O={};F&256&&(O.$$scope={dirty:F,ctx:M}),I.$set(O)},i(M){E||(d(v.$$.fragment,M),d(I.$$.fragment,M),E=!0)},o(M){g(v.$$.fragment,M),g(I.$$.fragment,M),E=!1},d(M){M&&(h(e),h(s),h(l),h(u),h(c),h(k),h(C)),b(v),b(I)}}}function Xu(t){let e,r;return e=new Te({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Zu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Yu(t,e,r){let n,o;X(t,gt,c=>r(6,n=c)),X(t,ee,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,f=!l.has(s.authority_or_region),i=f?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function a(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(lo(c),{padding:20,animate:!1})}function u(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,f,i,a,u,l]}class Ju extends R{constructor(e){super(),H(this,e,Yu,Xu,W,{scheme:0,authorityNames:5})}}const Qu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ae=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{f(r.next(i))}catch(a){o(a)}},l=i=>{try{f(r.throw(i))}catch(a){o(a)}},f=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);f((r=r.apply(t,e)).next())}),de=Uint8Array,ht=Uint16Array,ec=Int32Array,jn=new de([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Un=new de([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tc=new de([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Rn=function(t,e){for(var r=new ht(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new ec(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},Hn=Rn(jn,2),Wn=Hn.b,rc=Hn.r;Wn[28]=258,rc[258]=28;var nc=Rn(Un,0),oc=nc.b,sr=new ht(32768);for(K=0;K<32768;++K)xe=(K&43690)>>1|(K&21845)<<1,xe=(xe&52428)>>2|(xe&13107)<<2,xe=(xe&61680)>>4|(xe&3855)<<4,sr[K]=((xe&65280)>>8|(xe&255)<<8)>>1;var xe,K,Tt=function(t,e,r){for(var n=t.length,o=0,s=new ht(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new ht(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new ht(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[sr[c]>>i]=a}else for(f=new ht(n),o=0;o<n;++o)t[o]&&(f[o]=sr[l[t[o]-1]++]>>15-t[o]);return f},Pt=new de(288);for(K=0;K<144;++K)Pt[K]=8;var K;for(K=144;K<256;++K)Pt[K]=9;var K;for(K=256;K<280;++K)Pt[K]=7;var K;for(K=280;K<288;++K)Pt[K]=8;var K,zn=new de(32);for(K=0;K<32;++K)zn[K]=5;var K,sc=Tt(Pt,9,1),ic=Tt(zn,5,1),Xt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ye=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Yt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},lc=function(t){return(t+7)/8|0},ac=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new de(r-e);return n.set(t.subarray(e,r)),n},fc=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$e=function(t,e,r){var n=new Error(e||fc[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,$e),!r)throw n;return n},pr=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new de(0);var l=!r||e.i!=2,f=e.i;r||(r=new de(o*3));var i=function($r){var mr=r.length;if($r>mr){var hr=new de(Math.max(mr*2,$r));hr.set(r),r=hr}},a=e.f||0,u=e.p||0,c=e.b||0,p=e.l,$=e.d,y=e.m,k=e.n,C=o*8;do{if(!p){a=ye(t,u,1);var v=ye(t,u+1,3);if(u+=3,v)if(v==1)p=sc,$=ic,y=9,k=5;else if(v==2){var M=ye(t,u,31)+257,F=ye(t,u+10,15)+4,A=M+ye(t,u+5,31)+1;u+=14;for(var O=new de(A),N=new de(19),B=0;B<F;++B)N[tc[B]]=ye(t,u+B*3,7);u+=F*3;for(var Z=Xt(N),ne=(1<<Z)-1,z=Tt(N,Z,1),B=0;B<A;){var Le=z[ye(t,u,ne)];u+=Le&15;var T=Le>>4;if(T<16)O[B++]=T;else{var Fe=0,ce=0;for(T==16?(ce=3+ye(t,u,3),u+=2,Fe=O[B-1]):T==17?(ce=3+ye(t,u,7),u+=3):T==18&&(ce=11+ye(t,u,127),u+=7);ce--;)O[B++]=Fe}}var Mt=O.subarray(0,M),pe=O.subarray(M);y=Xt(Mt),k=Xt(pe),p=Tt(Mt,y,1),$=Tt(pe,k,1)}else $e(1);else{var T=lc(u)+4,I=t[T-4]|t[T-3]<<8,E=T+I;if(E>o){f&&$e(0);break}l&&i(c+I),r.set(t.subarray(T,E),c),e.b=c+=I,e.p=u=E*8,e.f=a;continue}if(u>C){f&&$e(0);break}}l&&i(c+131072);for(var bt=(1<<y)-1,Re=(1<<k)-1,at=u;;at=u){var Fe=p[Yt(t,u)&bt],we=Fe>>4;if(u+=Fe&15,u>C){f&&$e(0);break}if(Fe||$e(2),we<256)r[c++]=we;else if(we==256){at=u,p=null;break}else{var ft=we-254;if(we>264){var B=we-257,Be=jn[B];ft=ye(t,u,(1<<Be)-1)+Wn[B],u+=Be}var ut=$[Yt(t,u)&Re],ct=ut>>4;ut||$e(3),u+=ut&15;var pe=oc[ct];if(ct>3){var Be=Un[ct];pe+=Yt(t,u)&(1<<Be)-1,u+=Be}if(u>C){f&&$e(0);break}l&&i(c+131072);var pt=c+ft;if(c<pe){var vt=s-pe,Jn=Math.min(pe,pt);for(vt+c<0&&$e(3);c<Jn;++c)r[c]=n[vt+c]}for(;c<pt;c+=4)r[c]=r[c-pe],r[c+1]=r[c+1-pe],r[c+2]=r[c+2-pe],r[c+3]=r[c+3-pe];c=pt}}e.l=p,e.p=at,e.b=c,e.f=a,p&&(a=1,e.m=y,e.d=$,e.n=k)}while(!a);return c==r.length?r:ac(r,0,c)},uc=new de(0),cc=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&$e(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},pc=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},$c=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&$e(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&$e(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function mc(t,e){return pr(t,{i:2},e&&e.out,e&&e.dictionary)}function hc(t,e){var r=cc(t);return r+8>t.length&&$e(6,"invalid gzip data"),pr(t.subarray(r,-8),{i:2},e&&e.out||new de(pc(t)),e&&e.dictionary)}function dc(t,e){return pr(t.subarray($c(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function ir(t,e){return t[0]==31&&t[1]==139&&t[2]==8?hc(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?mc(t,e):dc(t,e)}var gc=typeof TextDecoder<"u"&&new TextDecoder,_c=0;try{gc.decode(uc,{stream:!0}),_c=1}catch{}var Vn=(t,e)=>t*Math.pow(2,e),yt=(t,e)=>Math.floor(t/Math.pow(2,e)),Ut=(t,e)=>Vn(t.getUint16(e+1,!0),8)+t.getUint8(e),Gn=(t,e)=>Vn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),wc=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Ut(n,o+1);if(e!=s)return e-s;const l=Ut(n,o+4);return r!=l?r-l:0},bc=(t,e,r,n)=>{const o=qn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},nn=(t,e,r,n)=>{const o=qn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},qn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,f=wc(e,r,n,t,l*17);if(f>0)o=l+1;else if(f<0)s=l-1;else return[Gn(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},vc=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,Kn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Ut(t,e*17+1),y:Ut(t,e*17+4),offset:Gn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},on=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(Kn(r,n));return yc(e)},yc=t=>{t.sort(vc);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=yt(o.offset,8)&255,r[n*17+9]=yt(o.offset,16)&255,r[n*17+10]=yt(o.offset,24)&255,r[n*17+11]=yt(o.offset,32)&255,r[n*17+12]=yt(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},kc=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=Kn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),f=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:f}}return null};function Sc(t){return ae(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let f=0;l.compression==="gzip"&&(f=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let a=0;"maxzoom"in l&&(a=+l.maxzoom);let u=0,c=0,p=0,$=-180,y=-85,k=180,C=85;if(l.bounds){const T=l.bounds.split(",");$=+T[0],y=+T[1],k=+T[2],C=+T[3]}if(l.center){const T=l.center.split(",");u=+T[0],c=+T[1],p=+T[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:f,tileType:1,minZoom:i,maxZoom:a,minLon:$,minLat:y,maxLon:k,maxLat:C,centerZoom:p,centerLon:u,centerLat:c,etag:e.etag}})}function Tc(t,e,r,n,o,s,l){return ae(this,null,function*(){let f=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(f=on(f));const i=nn(new DataView(f),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=ir(new Uint8Array(c))),{data:c}}const a=kc(new DataView(f),{z:n,x:o,y:s});if(a){const u=bc(new DataView(f),a.z,a.x,a.y);if(u){let c=yield r.getArrayBuffer(e,u.offset,u.length,t);t.specVersion===1&&(c=on(c));const p=nn(new DataView(c),n,o,s);if(p){let y=(yield e.getBytes(p.offset,p.length,l)).data;const k=new DataView(y);return k.getUint8(0)==31&&k.getUint8(1)==139&&(y=ir(new Uint8Array(y))),{data:y}}}}})}var Zn={getHeader:Sc,getZxy:Tc},Cc=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new sn(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new sn(o),this.tiles.set(o,s));const l=n[2],f=n[3],i=n[4],a=new AbortController,u=a.signal;let c=()=>{a.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+f,+i,u).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function $t(t,e){return(e>>>0)*4294967296+(t>>>0)}function Lc(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return $t(t,n);throw new Error("Expected varint not more than 10 bytes")}function kt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,Lc(r,t))}function Ac(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var Oc=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Dc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=Oc[t],o=Math.pow(2,t);let s=0,l=0,f=0;const i=[e,r];let a=o/2;for(;a>0;)s=(i[0]&a)>0?1:0,l=(i[1]&a)>0?1:0,f+=a*a*(3*s^l),Ac(a,i,s,l),a=a/2;return n+f}function Xn(t,e){return ae(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return ir(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Ec=127;function Pc(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Mc=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ae(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const f=o.headers.get("Content-Range");if(!f||!f.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+f.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ke(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Nc(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ke(r,8),rootDirectoryLength:ke(r,16),jsonMetadataOffset:ke(r,24),jsonMetadataLength:ke(r,32),leafDirectoryOffset:ke(r,40),leafDirectoryLength:ke(r,48),tileDataOffset:ke(r,56),tileDataLength:ke(r,64),numAddressedTiles:ke(r,72),numTileEntries:ke(r,80),numTileContents:ke(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function Yn(t){const e={buf:new Uint8Array(t),pos:0},r=kt(e),n=[];let o=0;for(let s=0;s<r;s++){const l=kt(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=kt(e);for(let s=0;s<r;s++)n[s].length=kt(e);for(let s=0;s<r;s++){const l=kt(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function Ic(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var dt=class extends Error{};function Fc(t,e,r,n){return ae(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Ic(o.data)<3)return[yield Zn.getHeader(t)];const l=o.data.slice(0,Ec);let f=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),f=void 0);const i=Nc(l,f);if(r){const a=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),u=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=Yn(yield e(a,i.internalCompression));return[i,[u,c.length,c]]}return[i,void 0]})}function Bc(t,e,r,n,o){return ae(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new dt(s.etag);const l=yield e(s.data,o.internalCompression),f=Yn(l);if(f.length===0)throw new Error("Empty directory is invalid");return f})}var xc=class{constructor(t=100,e=!0,r=Xn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ae(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{Fc(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ae(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{Bc(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ae(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new dt(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ae(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},sn=class{constructor(t,e,r){typeof t=="string"?this.source=new Mc(t):this.source=t,r?this.decompress=r:this.decompress=Xn,e?this.cache=e:this.cache=new xc}getHeader(){return ae(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ae(this,null,function*(){const o=Dc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Zn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,f=s.rootDirectoryLength;for(let i=0;i<=3;i++){const a=yield this.cache.getDirectory(this.source,l,f,s),u=Pc(a,o);if(u)if(u.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+u.offset,u.length,n);if(s.etag&&s.etag!==c.etag)throw new dt(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+u.offset,f=u.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ae(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof dt)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ae(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new dt(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ae(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof dt)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function jc(t){return Rt(()=>{let e=new Cc;wr.addProtocol("pmtiles",e.tile)}),bn(()=>{wr.removeProtocol("pmtiles")}),[]}class Uc extends R{constructor(e){super(),H(this,e,jc,null,W,{})}}function ln(t,e,r){const n=t.slice();return n[13]=e[r],n}function Rc(t){let e,r;return e=new Gu({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function an(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let f={schemes:t[1]};return t[2]!==void 0&&(f.schemesToBeShown=t[2]),t[3]!==void 0&&(f.filterText=t[3]),e=new zi({props:f}),U.push(()=>G(e,"schemesToBeShown",s)),U.push(()=>G(e,"filterText",l)),{c(){_(e.$$.fragment)},m(i,a){w(e,i,a),o=!0},p(i,a){const u={};a&2&&(u.schemes=i[1]),!r&&a&4&&(r=!0,u.schemesToBeShown=i[2],q(()=>r=!1)),!n&&a&8&&(n=!0,u.filterText=i[3],q(()=>n=!1)),e.$set(u)},i(i){o||(d(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function fn(t){let e,r;return e=new Ju({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function un(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&fn(t);return{c(){o&&o.c(),r=lt()},m(s,l){o&&o.m(s,l),m(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&d(o,1)):(o=fn(s),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(oe(),g(o,1,1,()=>{o=null}),se())},i(s){n||(d(o),n=!0)},o(s){g(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function Hc(t){let e,r,n,o,s,l,f,i,a,u,c=lr()=="Private (development)",p,$,y,k,C,v,T,I;s=new wo({props:{boundaryGeojson:t[4]}}),f=new Eo({}),a=new ao({});let E=c&&Rc(t);$=new yo({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),k=new wn({props:{errorMessage:t[0]}});let M=t[1].size>0&&an(t),F=Ne(t[1].values()),A=[];for(let N=0;N<F.length;N+=1)A[N]=un(ln(t,F,N));const O=N=>g(A[N],1,1,()=>{A[N]=null});return{c(){e=P("div"),r=P("div"),n=P("h1"),n.textContent="Browse schemes",o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),_(a.$$.fragment),u=L(),E&&E.c(),p=L(),_($.$$.fragment),y=L(),_(k.$$.fragment),C=L(),M&&M.c(),v=L(),T=P("ul");for(let N=0;N<A.length;N+=1)A[N].c();je(r,"display","flex"),je(r,"justify-content","space-between"),j(e,"slot","sidebar"),j(e,"class","govuk-prose")},m(N,B){m(N,e,B),D(e,r),D(r,n),D(r,o),w(s,r,null),D(e,l),w(f,e,null),D(e,i),w(a,e,null),D(e,u),E&&E.m(e,null),D(e,p),w($,e,null),D(e,y),w(k,e,null),D(e,C),M&&M.m(e,null),D(e,v),D(e,T);for(let Z=0;Z<A.length;Z+=1)A[Z]&&A[Z].m(T,null);I=!0},p(N,B){const Z={};B&16&&(Z.boundaryGeojson=N[4]),s.$set(Z),c&&E.p(N,B);const ne={};if(B&1&&(ne.errorMessage=N[0]),k.$set(ne),N[1].size>0?M?(M.p(N,B),B&2&&d(M,1)):(M=an(N),M.c(),d(M,1),M.m(e,v)):M&&(oe(),g(M,1,1,()=>{M=null}),se()),B&38){F=Ne(N[1].values());let z;for(z=0;z<F.length;z+=1){const Le=ln(N,F,z);A[z]?(A[z].p(Le,B),d(A[z],1)):(A[z]=un(Le),A[z].c(),d(A[z],1),A[z].m(T,null))}for(oe(),z=F.length;z<A.length;z+=1)O(z);se()}},i(N){if(!I){d(s.$$.fragment,N),d(f.$$.fragment,N),d(a.$$.fragment,N),d(E),d($.$$.fragment,N),d(k.$$.fragment,N),d(M);for(let B=0;B<F.length;B+=1)d(A[B]);I=!0}},o(N){g(s.$$.fragment,N),g(f.$$.fragment,N),g(a.$$.fragment,N),g(E),g($.$$.fragment,N),g(k.$$.fragment,N),g(M),A=A.filter(Boolean);for(let B=0;B<A.length;B+=1)g(A[B]);I=!1},d(N){N&&h(e),b(s),b(f),b(a),E&&E.d(),b($),b(k),M&&M.d(),Bt(A,N)}}}function Wc(t){let e,r,n,o,s,l,f,i,a,u,c;return e=new bo({props:{colorInterventions:vn("v1")}}),n=new Q({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new Q({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),f=new Q({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),u=new zu({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=L(),_(n.$$.fragment),o=L(),_(s.$$.fragment),l=L(),_(f.$$.fragment),i=L(),a=P("div"),_(u.$$.fragment),j(a,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(f,p,$),m(p,i,$),m(p,a,$),w(u,a,null),c=!0},p:Y,i(p){c||(d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(f.$$.fragment,p),d(u.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(f.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(l),h(i),h(a)),b(e,p),b(n,p),b(s,p),b(f,p),b(u)}}}function zc(t){let e,r,n,o,s;return r=new Uc({}),o=new mo({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Wc]},$$scope:{ctx:t}}}),{c(){e=P("div"),_(r.$$.fragment),n=L(),_(o.$$.fragment),j(e,"slot","main")},m(l,f){m(l,e,f),w(r,e,null),D(e,n),w(o,e,null),s=!0},p(l,f){const i={};f&65536&&(i.$$scope={dirty:f,ctx:l}),o.$set(i)},i(l){s||(d(r.$$.fragment,l),d(o.$$.fragment,l),s=!0)},o(l){g(r.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&h(e),b(r),b(o)}}}function Vc(t){let e,r;return e=new $o({props:{$$slots:{main:[zc],sidebar:[Hc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Gc(t,e,r){let n;X(t,gt,C=>r(4,n=C));let o=new Set(Qu);Rt(()=>{fo()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",f="",i=new Map,a=new Set,u="";bn(()=>{gt.set(_n())});function c(C){try{let v=JSON.parse(C);r(1,i=Pi(v)),gt.set(v),r(0,f="")}catch(v){r(0,f=`The file you loaded is broken: ${v}`)}}function p(C){let v=C.properties;var T='<div style="max-width: 30vw;">';return T+=`<h2>${$(v.name)} (${v.intervention_type})</h2>`,T+=`<p>Scheme reference: ${v.scheme_reference}</p>`,v.length_meters&&(T+=`<p>Length: ${uo(v.length_meters)}</p>`),v.description&&(T+=`<p>${$(v.description)}</p>`),T+="</div>",T}function $(C){return u?C.replace(new RegExp(u,"gi"),v=>`<mark>${v}</mark>`):C}function y(C){a=C,r(2,a)}function k(C){u=C,r(3,u)}return[f,i,a,u,n,o,l,c,p,y,k]}class qc extends R{constructor(e){super(),H(this,e,Gc,Vc,W,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new qc({target:document.getElementById("app")});
