import{S as R,i as H,s as W,M as eo,b as U,c as G,e as P,d as C,g as _,av as to,h as j,j as m,k as D,m as w,w as wt,l as q,t as d,n as g,p as h,q as b,aH as mn,aI as hn,aJ as dn,aK as gn,u as y,f as fr,x as Y,am as ro,N as X,C as ee,ao as _n,T as _t,r as Dt,F as wn,a as Lt,v as wr,I as be,a2 as at,y as oe,o as se,aA as no,a5 as ur,ax as Ne,aL as oo,aM as so,ad as io,_ as cr,P as Wt,Y as ue,B as br,aO as x,an as je,ay as jt,aP as fe,Q as Ke,G as ce,aQ as qe,aR as ie,R as bn,aS as pr,aT as lo,Z as bt,E as vn,aU as vr,D as ao,aV as yr,L as fo,z as uo,aE as co}from"./index-a52a4cd6.js";import{e as Ut,C as Te,b as Et,d as te,c as po,a as $o,S as mo,L as ho,M as go}from"./StreetViewController-f139370a.js";import{L as _o,h as kr,f as yn,l as wo,C as _e,B as bo,Z as vo,I as yo}from"./index-18e88e00.js";import{P as ko}from"./Pin-cfa68946.js";import{I as Q}from"./InteractiveLayer-49e7e353.js";import{F as So}from"./FileInput-f1810b9c.js";const To="/atip/LineMeasuring/assets/help-d011708a.svg";function Co(t){let e,r;const n=t[1].default,o=mn(n,t,t[4],null);return{c(){e=P("div"),o&&o.c(),j(e,"class","govuk-prose")},m(s,l){m(s,e,l),o&&o.m(e,null),r=!0},p(s,l){o&&o.p&&(!r||l&16)&&hn(o,n,s,s[4],r?gn(n,s[4],l,null):dn(s[4]),null)},i(s){r||(d(o,s),r=!0)},o(s){g(o,s),r=!1},d(s){s&&h(e),o&&o.d(s)}}}function Lo(t){let e,r,n,o,s,l,f,i,a;function u(p){t[3](p)}let c={title:"Help",$$slots:{default:[Co]},$$scope:{ctx:t}};return t[0]!==void 0&&(c.open=t[0]),s=new eo({props:c}),U.push(()=>G(s,"open",u)),{c(){e=P("button"),r=P("img"),o=C(),_(s.$$.fragment),to(r.src,n=To)||j(r,"src",n),j(r,"title","Help"),j(r,"alt","Help"),j(e,"class","svelte-7d9d1l")},m(p,$){m(p,e,$),D(e,r),m(p,o,$),w(s,p,$),f=!0,i||(a=wt(e,"click",t[2]),i=!0)},p(p,[$]){const k={};$&16&&(k.$$scope={dirty:$,ctx:p}),!l&&$&1&&(l=!0,k.open=p[0],q(()=>l=!1)),s.$set(k)},i(p){f||(d(s.$$.fragment,p),f=!0)},o(p){g(s.$$.fragment,p),f=!1},d(p){p&&(h(e),h(o)),b(s,p),i=!1,a()}}}function Ao(t,e,r){let{$$slots:n={},$$scope:o}=e,s=!1;const l=()=>r(0,s=!0);function f(i){s=i,r(0,s)}return t.$$set=i=>{"$$scope"in i&&r(4,o=i.$$scope)},[s,n,l,f,o]}class re extends R{constructor(e){super(),H(this,e,Ao,Lo,W,{})}}function Oo(t){let e;return{c(){e=P("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Do(t){let e,r,n,o,s=t[0]=="Private (development)"&&Oo();return{c(){s&&s.c(),e=C(),r=P("p"),r.textContent="Note the ATF scheme data has not been validated.",n=C(),o=P("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,f){s&&s.m(l,f),m(l,e,f),m(l,r,f),m(l,n,f),m(l,o,f)},p:Y,d(l){l&&(h(e),h(r),h(n),h(o)),s&&s.d(l)}}}function Eo(t){let e,r,n,o,s,l;return s=new re({props:{$$slots:{default:[Do]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("App version: "),n=y(t[0]),o=C(),_(s.$$.fragment)},m(f,i){m(f,e,i),D(e,r),D(e,n),D(e,o),w(s,e,null),l=!0},p(f,[i]){const a={};i&2&&(a.$$scope={dirty:i,ctx:f}),s.$set(a)},i(f){l||(d(s.$$.fragment,f),l=!0)},o(f){g(s.$$.fragment,f),l=!1},d(f){f&&h(e),b(s)}}}function Po(t){return[fr()]}class Mo extends R{constructor(e){super(),H(this,e,Po,Eo,W,{})}}const No={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var he=Uint8Array,st=Uint16Array,kn=Uint32Array,Sn=new he([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tn=new he([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Io=new he([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Cn=function(t,e){for(var r=new st(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new kn(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},Ln=Cn(Sn,2),An=Ln[0],Fo=Ln[1];An[28]=258,Fo[258]=28;var Bo=Cn(Tn,0),xo=Bo[0],er=new st(32768);for(var J=0;J<32768;++J){var He=(J&43690)>>>1|(J&21845)<<1;He=(He&52428)>>>2|(He&13107)<<2,He=(He&61680)>>>4|(He&3855)<<4,er[J]=((He&65280)>>>8|(He&255)<<8)>>>1}var Tt=function(t,e,r){for(var n=t.length,o=0,s=new st(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new st(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new st(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[er[c]>>>i]=a}else for(f=new st(n),o=0;o<n;++o)t[o]&&(f[o]=er[l[t[o]-1]++]>>>15-t[o]);return f},Pt=new he(288);for(var J=0;J<144;++J)Pt[J]=8;for(var J=144;J<256;++J)Pt[J]=9;for(var J=256;J<280;++J)Pt[J]=7;for(var J=280;J<288;++J)Pt[J]=8;var On=new he(32);for(var J=0;J<32;++J)On[J]=5;var jo=Tt(Pt,9,1),Uo=Tt(On,5,1),Vt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Gt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Ro=function(t){return(t+7)/8|0},$r=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?st:t.BYTES_PER_ELEMENT==4?kn:he)(r-e);return n.set(t.subarray(e,r)),n},Ho=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Se=function(t,e,r){var n=new Error(e||Ho[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Se),!r)throw n;return n},Wo=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new he(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new he(n*3));var l=function(pt){var $t=e.length;if(pt>$t){var yt=new he(Math.max($t*2,pt));yt.set(e),e=yt}},f=r.f||0,i=r.p||0,a=r.b||0,u=r.l,c=r.d,p=r.m,$=r.n,k=n*8;do{if(!u){f=ve(t,i,1);var S=ve(t,i+1,3);if(i+=3,S)if(S==1)u=jo,c=Uo,p=9,$=5;else if(S==2){var I=ve(t,i,31)+257,E=ve(t,i+10,15)+4,N=I+ve(t,i+5,31)+1;i+=14;for(var F=new he(N),O=new he(19),A=0;A<E;++A)O[Io[A]]=ve(t,i+A*3,7);i+=E*3;for(var M=Vt(O),B=(1<<M)-1,Z=Tt(O,M,1),A=0;A<N;){var ne=Z[ve(t,i,B)];i+=ne&15;var T=ne>>>4;if(T<16)F[A++]=T;else{var z=0,Le=0;for(T==16?(Le=3+ve(t,i,3),i+=2,z=F[A-1]):T==17?(Le=3+ve(t,i,7),i+=3):T==18&&(Le=11+ve(t,i,127),i+=7);Le--;)F[A++]=z}}var Fe=F.subarray(0,I),pe=F.subarray(I);p=Vt(Fe),$=Vt(pe),u=Tt(Fe,p,1),c=Tt(pe,$,1)}else Se(1);else{var T=Ro(i)+4,v=t[T-4]|t[T-3]<<8,L=T+v;if(L>n){s&&Se(0);break}o&&l(a+v),e.set(t.subarray(T,L),a),r.b=a+=v,r.p=i=L*8,r.f=f;continue}if(i>k){s&&Se(0);break}}o&&l(a+131072);for(var It=(1<<p)-1,$e=(1<<$)-1,vt=i;;vt=i){var z=u[Gt(t,i)&It],Re=z>>>4;if(i+=z&15,i>k){s&&Se(0);break}if(z||Se(2),Re<256)e[a++]=Re;else if(Re==256){vt=i,u=null;break}else{var ft=Re-254;if(Re>264){var A=Re-257,we=Sn[A];ft=ve(t,i,(1<<we)-1)+An[A],i+=we}var ut=c[Gt(t,i)&$e],Be=ut>>>4;ut||Se(3),i+=ut&15;var pe=xo[Be];if(Be>3){var we=Tn[Be];pe+=Gt(t,i)&(1<<we)-1,i+=we}if(i>k){s&&Se(0);break}o&&l(a+131072);for(var ct=a+ft;a<ct;a+=4)e[a]=e[a-pe],e[a+1]=e[a+1-pe],e[a+2]=e[a+2-pe],e[a+3]=e[a+3-pe];a=ct}}r.l=u,r.p=vt,r.b=a,r.f=f,u&&(f=1,r.m=p,r.d=c,r.n=$)}while(!f);return a==e.length?e:$r(e,0,a)},zo=new he(0),Me=function(t,e){return t[e]|t[e+1]<<8},Ce=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},qt=function(t,e){return Ce(t,e)+Ce(t,e+4)*4294967296};function Vo(t,e){return Wo(t,e)}var tr=typeof TextDecoder<"u"&&new TextDecoder,Go=0;try{tr.decode(zo,{stream:!0}),Go=1}catch{}var qo=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,$r(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function Dn(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(tr)return tr.decode(t);var o=qo(t),s=o[0],l=o[1];return l.length&&Se(8),s}}var Ko=function(t,e){return e+30+Me(t,e+26)+Me(t,e+28)},Zo=function(t,e,r){var n=Me(t,e+28),o=Dn(t.subarray(e+46,e+46+n),!(Me(t,e+8)&2048)),s=e+46+n,l=Ce(t,e+20),f=r&&l==4294967295?Xo(t,s):[l,Ce(t,e+24),Ce(t,e+42)],i=f[0],a=f[1],u=f[2];return[Me(t,e+10),i,a,o,s+Me(t,e+30)+Me(t,e+32),u]},Xo=function(t,e){for(;Me(t,e)!=1;e+=4+Me(t,e+2));return[qt(t,e+12),qt(t,e+4),qt(t,e+20)]};function Yo(t,e){for(var r={},n=t.length-22;Ce(t,n)!=101010256;--n)(!n||t.length-n>65558)&&Se(13);var o=Me(t,n+8);if(!o)return{};var s=Ce(t,n+16),l=s==4294967295||o==65535;if(l){var f=Ce(t,n-12);l=Ce(t,f)==101075792,l&&(o=Ce(t,f+32),s=Ce(t,f+48))}for(var i=e&&e.filter,a=0;a<o;++a){var u=Zo(t,s,l),c=u[0],p=u[1],$=u[2],k=u[3],S=u[4],T=u[5],v=Ko(t,T);s=S,(!i||i({name:k,size:p,originalSize:$,compression:c}))&&(c?c==8?r[k]=Vo(t.subarray(v,v+p),new he($)):Se(14,"unknown compression type "+c):r[k]=$r(t,v,v+p))}return r}function Jo(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Kt):Kt(t)}function Kt(t){var e=new Uint8Array(t),r=Yo(e);return Promise.resolve(Qo(r))}function Qo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=Dn(t[o])}return e}function Ie(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&lt(n)===e)return n;r++}}function Mt(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&lt(o)===e&&r.push(o),n++}return r}function Rt(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&lt(o)===e&&r(o,n):r(o,n),n++}}function es(t,e,r){var n=[];return Rt(t,e,function(o,s){n.push(r(o,s))}),n}var ts=/.+\:/;function lt(t){return t.tagName.replace(ts,"")}function En(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+lt(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=En(t.childNodes[n]),n++;return e+="</"+lt(t)+">",e}function rs(t){var e=t.documentElement,r=Ie(e,"sheetData"),n=[];return Rt(r,"row",function(o){Rt(o,"c",function(s){n.push(s)})}),n}function ns(t,e){return Ie(e,"v")}function os(t,e){if(e.firstChild&&lt(e.firstChild)==="is"&&e.firstChild.firstChild&&lt(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function ss(t){var e=t.documentElement,r=Ie(e,"dimension");if(r)return r.getAttribute("ref")}function is(t){var e=t.documentElement,r=Ie(e,"cellStyleXfs");return r?Mt(r,"xf"):[]}function ls(t){var e=t.documentElement,r=Ie(e,"cellXfs");return r?Mt(r,"xf"):[]}function as(t){var e=t.documentElement,r=Ie(e,"numFmts");return r?Mt(r,"numFmt"):[]}function fs(t){var e=t.documentElement;return es(e,"si",function(r){var n=Ie(r,"t");if(n)return n.textContent;var o="";return Rt(r,"r",function(s){o+=Ie(s,"t").textContent}),o})}function us(t){var e=t.documentElement;return Ie(e,"workbookPr")}function cs(t){var e=t.documentElement;return Mt(e,"Relationship")}function ps(t){var e=t.documentElement,r=Ie(e,"sheets");return Mt(r,"sheet")}function $s(t,e){var r=e.createDocument(t),n={},o=us(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(f){f.getAttribute("name")&&n.sheets.push({id:f.getAttribute("sheetId"),name:f.getAttribute("name"),relationId:f.getAttribute("r:id")})};return ps(r).forEach(s),n}function ms(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var f=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=Zt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=Zt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=Zt(f);break}};return cs(r).forEach(o),n}function Zt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function Sr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Tr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sr(Object(r),!0).forEach(function(n){hs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ds(t,e){if(!t)return{};var r=e.createDocument(t),n=is(r).map(Xt),o=as(r).map(gs).reduce(function(l,f){return l[f.id]=f,l},[]),s=function(f){return f.hasAttribute("xfId")?Tr(Tr({},n[f.xfId]),Xt(f,o)):Xt(f,o)};return ls(r).map(s)}function gs(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function Xt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function _s(t,e){return t?fs(e.createDocument(t)):[]}function Pn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function ws(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=bs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bs(t,e){if(t){if(typeof t=="string")return Cr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(t,e)}}function Cr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vs(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(ys.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&Ts(o.numberFormat.template))return!0}}var ys=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],ks=/^\[\$-414\]/,Ss=/;@$/;function Ts(t){t=t.toLowerCase(),t=t.replace(ks,""),t=t.replace(Ss,"");for(var e=t.split(/\W+/),r=ws(e),n;!(n=r()).done;){var o=n.value;if(Cs.indexOf(o)<0)return!1}return!0}var Cs=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function Ls(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,f=r.values,i=r.properties,a=r.options;switch(e||(e="n"),e){case"str":t=Yt(t,a);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Yt(t,a);break;case"s":var u=Number(t);if(isNaN(u))throw new Error('Invalid "shared" string index: '.concat(t));if(u>=f.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=f[u],t=Yt(t,a);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=As(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,vs(t,s(),l,a)&&(t=Pn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function As(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Yt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var Os=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Ds(t){var e=function(a,u){return a-u},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],f=n[n.length-1];return[{row:o,column:l},{row:s,column:f}]}function Es(t){for(var e=0,r=0;r<t.length;)e*=26,e+=Os.indexOf(t[r]),r++;return e}function Mn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),Es(t[0].trim())]}function Ps(t,e,r,n,o,s,l){var f=Mn(t.getAttribute("r")),i=ns(e,t),a=i&&i.textContent,u;return t.hasAttribute("t")&&(u=t.getAttribute("t")),{row:f[0],column:f[1],value:Ls(a,u,{getInlineStringValue:function(){return os(e,t)},getInlineStringXml:function(){return En(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function Ms(t,e,r,n,o,s){var l=rs(t);return l.length===0?[]:l.map(function(f){return Ps(f,t,e,r,n,o,s)})}function Ns(t,e){return xs(t)||Bs(t,e)||Fs(t,e)||Is()}function Is(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fs(t,e){if(t){if(typeof t=="string")return Lr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lr(t,e)}}function Lr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function xs(t){if(Array.isArray(t))return t}function js(t){var e=ss(t);if(e)return e=e.split(":").map(Mn).map(function(r){var n=Ns(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function Us(t,e,r,n,o,s){var l=e.createDocument(t),f=Ms(l,e,r,n,o,s),i=js(l)||Ds(f);return{cells:f,dimensions:i}}function Rs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Hs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hs(t,e){if(t){if(typeof t=="string")return Ar(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ar(t,e)}}function Ar(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ws(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var f=!0,i=Rs(t[l]),a;!(a=i()).done;){var u=a.value;if(o(u)!==null){f=!1;break}}if(f)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function zs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Vs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vs(t,e){if(t){if(typeof t=="string")return Or(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Or(t,e)}}function Or(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Gs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,f=zs(t),i;!(i=f()).done;){var a=i.value;if(n(a[s])!==null){l=!1;break}}if(l)for(var u=0;u<t.length;)t[u].splice(s,1),u++;else if(o)break;s--}return t}function qs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Nn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ks(t,e){return Ys(t)||Xs(t,e)||Nn(t,e)||Zs()}function Zs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nn(t,e){if(t){if(typeof t=="string")return Dr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dr(t,e)}}function Dr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Xs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function Ys(t){if(Array.isArray(t))return t}function Js(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Ks(r,2);o[0];for(var s=o[1],l=s.column,f=s.row,i=new Array(f),a=0;a<f;){i[a]=new Array(l);for(var u=0;u<l;)i[a][u]=null,u++;a++}for(var c=qs(n),p;!(p=c()).done;){var $=p.value,k=$.row-1,S=$.column-1;S<l&&k<f&&(i[k][S]=$.value)}var T=e.rowMap;if(T)for(var v=0;v<i.length;)T[v]=v,v++;return i=Ws(Gs(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:T}),e.transformData&&(i=e.transformData(i)),i}function Qs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ei(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ei(t,e){if(t){if(typeof t=="string")return Er(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Er(t,e)}}function Er(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Pr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ti(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pr(Object(r),!0).forEach(function(n){ri(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ri(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ni(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=ti({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=ms(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?_s(n(o.sharedStrings),e):[],l=o.styles?ds(n(o.styles),e):{},f=$s(n("xl/workbook.xml"),e);if(r.getSheets)return f.sheets.map(function(c){var p=c.name;return{name:p}});var i=oi(r.sheet,f.sheets);if(!i||!o.sheets[i])throw si(r.sheet,f.sheets);var a=Us(n(o.sheets[i]),e,s,l,f,r),u=Js(a,r);return r.properties?{data:u,properties:f}:u}function oi(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Qs(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function si(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function rr(t){"@babel/helpers - typeof";return rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(t)}function Mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ii(t,e,r){return e&&Mr(t.prototype,e),r&&Mr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function li(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ai(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&At(t,e)}function fi(t){var e=In();return function(){var n=Ot(t),o;if(e){var s=Ot(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return ui(this,o)}}function ui(t,e){if(e&&(rr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ci(t)}function ci(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nr(t){var e=typeof Map=="function"?new Map:void 0;return nr=function(n){if(n===null||!pi(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Bt(n,arguments,Ot(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),At(o,n)},nr(t)}function Bt(t,e,r){return In()?Bt=Reflect.construct:Bt=function(o,s,l){var f=[null];f.push.apply(f,s);var i=Function.bind.apply(o,f),a=new i;return l&&At(a,l.prototype),a},Bt.apply(null,arguments)}function In(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function At(t,e){return At=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},At(t,e)}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Ot(t)}var de=function(t){ai(r,t);var e=fi(r);function r(n){var o;return li(this,r),o=e.call(this,"invalid"),o.reason=n,o}return ii(r)}(nr(Error));function $i(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new de("not_a_number")}if(typeof t!="number")throw new de("not_a_number");if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");return t}function mi(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");return String(t)}throw new de("not_a_string")}function hi(t){if(typeof t=="boolean")return t;throw new de("not_a_boolean")}function di(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new de("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");var n=Pn(t,r);if(isNaN(n.valueOf()))throw new de("out_of_bounds");return n}throw new de("not_a_date")}function gi(t,e){return bi(t)||wi(t,e)||Fn(t,e)||_i()}function _i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wi(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function bi(t){if(Array.isArray(t))return t}function or(t){"@babel/helpers - typeof";return or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},or(t)}function vi(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Fn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fn(t,e){if(t){if(typeof t=="string")return Nr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nr(t,e)}}function Nr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ir(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Fr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ir(Object(r),!0).forEach(function(n){yi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ir(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Br={isColumnOriented:!1};function ki(t,e,r){r?r=Fr(Fr({},Br),r):r=Br;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;Li(e),o&&(t=Ci(t));for(var f=t[0],i=[],a=[],u=1;u<t.length;u++){var c=Bn(e,t[u],u,f,a,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=vi(a),$;!($=p()).done;){var k=$.value;k.row=s[k.row-1]+1}return{rows:i,errors:a}}function Bn(t,e,r,n,o,s){for(var l={},f=!0,i=function(){var p=u[a],$=t[p],k=or($.type)==="object"&&!Array.isArray($.type),S=e[n.indexOf(p)];S===void 0&&(S=null);var T=void 0,v=void 0,L=void 0;if(k)T=Bn($.type,e,r,n,o,s);else if(S===null)T=null;else if(Array.isArray($.type)){var I=!1,E=Ti(S).map(function(F){var O=xr(F,$,s);return O.error&&(T=F,v=O.error,L=O.reason),O.value!==null&&(I=!0),O.value});v||(T=I?E:null)}else{var N=xr(S,$,s);v=N.error,L=N.reason,T=v?S:N.value}!v&&T===null&&$.required&&(v="required"),v?(v={error:v,row:r+1,column:p,value:T},L&&(v.reason=L),$.type&&(v.type=$.type),o.push(v)):(f&&T!==null&&(f=!1),(T!==null||s.includeNullValues)&&(l[$.prop]=T))},a=0,u=Object.keys(t);a<u.length;a++)i();return f?null:l}function xr(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=ht(t,e.parse):e.type?n=Si(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function ht(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function Si(t,e,r){switch(e){case String:return ht(t,mi);case Number:return ht(t,$i);case Date:return ht(t,function(n){return di(n,{properties:r.properties})});case Boolean:return ht(t,hi);default:if(typeof e=="function")return ht(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function xn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=xn(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function Ti(t){for(var e=[],r=0;r<t.length;){var n=xn(t,",",r),o=gi(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var Ci=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function Li(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function sr(t){"@babel/helpers - typeof";return sr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sr(t)}function jn(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;sr(s)==="object"&&(s=Object.keys(t[o])[0],l=jn(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var Ai=["schema","map"];function jr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Ft(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jr(Object(r),!0).forEach(function(n){Oi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Oi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Di(t,e){if(t==null)return{};var r=Ei(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ei(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Pi(t,e,r){var n=r.schema,o=r.map,s=Di(r,Ai);!n&&o&&(n=jn(o));var l=ni(t,e,Ft(Ft({},s),{},{properties:n||s.properties}));return n?ki(l.data,n,Ft(Ft({},s),{},{properties:l.properties})):l}function Mi(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Jo(t).then(function(r){return Pi(r,No,e)})}function Ni(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function Ii(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await Mi(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=ro(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const V={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},zt=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function Fi(t){let e,r,n,o,s;function l(i){t[3](i)}let f={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(f.value=t[0]),e=new Ut({props:f}),U.push(()=>G(e,"value",l)),e.$on("change",t[2]),o=new _o({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};!r&&a&1&&(r=!0,u.value=i[0],q(()=>r=!1)),e.$set(u);const c={};a&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function Bi(t,e,r){let n;X(t,ee,i=>r(4,n=i));let o="interventionType",s=kr("v1");function l(){let i;o=="interventionType"?(i=yn("v1"),r(1,s=kr("v1"))):(i=_n(["get","funding_programme"],{ATF2:V.atf2,ATF3:V.atf3,ATF4:V.atf4},"grey"),r(1,s=[["ATF2",V.atf2],["ATF3",V.atf3],["ATF4",V.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function f(i){o=i,r(0,o)}return[o,s,l,f]}class xi extends R{constructor(e){super(),H(this,e,Bi,Fi,W,{})}}function ji(t){let e;return{c(){e=y("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ui(t){let e,r,n,o,s,l;return n=new Lt({props:{$$slots:{default:[ji]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=P("input"),r=C(),_(n.$$.fragment),j(e,"type","text"),j(e,"class","govuk-input govuk-input--width-10"),j(e,"id","filterText")},m(f,i){m(f,e,i),wr(e,t[0]),m(f,r,i),w(n,f,i),o=!0,s||(l=wt(e,"input",t[12]),s=!0)},p(f,i){i&1&&e.value!==f[0]&&wr(e,f[0]);const a={};i&131072&&(a.$$scope={dirty:i,ctx:f}),n.$set(a)},i(f){o||(d(n.$$.fragment,f),o=!0)},o(f){g(n.$$.fragment,f),o=!1},d(f){f&&(h(e),h(r)),b(n,f),s=!1,l()}}}function Ri(t){let e,r,n,o,s,l,f,i,a,u;function c(S){t[10](S)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Ut({props:p}),U.push(()=>G(e,"value",c));function $(S){t[11](S)}let k={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(k.value=t[3]),o=new Ut({props:k}),U.push(()=>G(o,"value",$)),f=new wn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[Ui]},$$scope:{ctx:t}}}),a=new xi({}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment),l=C(),_(f.$$.fragment),i=C(),_(a.$$.fragment)},m(S,T){w(e,S,T),m(S,n,T),w(o,S,T),m(S,l,T),w(f,S,T),m(S,i,T),w(a,S,T),u=!0},p(S,T){const v={};T&32&&(v.choices=S[5]),!r&&T&4&&(r=!0,v.value=S[2],q(()=>r=!1)),e.$set(v);const L={};T&64&&(L.choices=S[6]),!s&&T&8&&(s=!0,L.value=S[3],q(()=>s=!1)),o.$set(L);const I={};T&131073&&(I.$$scope={dirty:T,ctx:S}),f.$set(I)},i(S){u||(d(e.$$.fragment,S),d(o.$$.fragment,S),d(f.$$.fragment,S),d(a.$$.fragment,S),u=!0)},o(S){g(e.$$.fragment,S),g(o.$$.fragment,S),g(f.$$.fragment,S),g(a.$$.fragment,S),u=!1},d(S){S&&(h(n),h(l),h(i)),b(e,S),b(o,S),b(f,S),b(a,S)}}}function Hi(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,f,i=t[7].area.toLocaleString()+"",a,u,c=t[7].crossing.toLocaleString()+"",p,$,k=t[7].other.toLocaleString()+"",S,T;return{c(){e=y("Showing "),n=y(r),o=y(" schemes ("),l=y(s),f=y(`
    routes, `),a=y(i),u=y(` areas,
    `),p=y(c),$=y(" crossings, "),S=y(k),T=y(`
    other)`)},m(v,L){m(v,e,L),m(v,n,L),m(v,o,L),m(v,l,L),m(v,f,L),m(v,a,L),m(v,u,L),m(v,p,L),m(v,$,L),m(v,S,L),m(v,T,L)},p(v,L){L&2&&r!==(r=v[1].size.toLocaleString()+"")&&be(n,r),L&128&&s!==(s=v[7].route.toLocaleString()+"")&&be(l,s),L&128&&i!==(i=v[7].area.toLocaleString()+"")&&be(a,i),L&128&&c!==(c=v[7].crossing.toLocaleString()+"")&&be(p,c),L&128&&k!==(k=v[7].other.toLocaleString()+"")&&be(S,k)},d(v){v&&(h(e),h(n),h(o),h(l),h(f),h(a),h(u),h(p),h($),h(S),h(T))}}}function Wi(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[Hi]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),U.push(()=>G(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){w(e,l,f),n=!0},p(l,f){const i={};f&131202&&(i.$$scope={dirty:f,ctx:l}),!r&&f&16&&(r=!0,i.checked=l[4],q(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function zi(t){let e,r,n,o;return e=new Te({props:{label:"Filters",$$slots:{default:[Ri]},$$scope:{ctx:t}}}),n=new Et({props:{small:!0,$$slots:{default:[Wi]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},p(s,[l]){const f={};l&131181&&(f.$$scope={dirty:l,ctx:s}),e.$set(f);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Vi(t,e,r){let n,o;X(t,_t,E=>r(15,n=E)),X(t,ee,E=>r(9,o=E));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:f=""}=e,i=[],a="",u=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;Dt(()=>{let E=new Set,N=new Set;for(let F of s.values())F.authority_or_region&&E.add(F.authority_or_region),F.funding_programme&&N.add(F.funding_programme);r(5,i=Array.from(E.entries())),i.sort(),r(6,u=Array.from(N.entries())),u.sort()});function k(E,N,F){let O=E.toLowerCase(),A=B=>{var Z,ne;if(O&&!((Z=B.properties.name)!=null&&Z.toLowerCase().includes(O))&&!((ne=B.properties.description)!=null&&ne.toLowerCase().includes(O)))return!1;if(N||F){let z=s.get(B.properties.scheme_reference);if(N&&z.authority_or_region!=N||F&&z.funding_programme!=F)return!1}return!0};r(1,l=new Set(n.features.filter(A).map(B=>B.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let M=B=>{var Z,ne;return!(!l.has(B.properties.scheme_reference)||O&&!((Z=B.properties.name)!=null&&Z.toLowerCase().includes(O))&&!((ne=B.properties.description)!=null&&ne.toLowerCase().includes(O)))};_t.update(B=>{for(let Z of B.features)M(Z)?(delete Z.properties.hide_while_editing,r(7,p[Z.properties.intervention_type]++,p)):Z.properties.hide_while_editing=!0;return B}),r(7,p)}function S(E){a=E,r(2,a)}function T(E){c=E,r(3,c)}function v(){f=this.value,r(0,f)}const L=()=>r(0,f="");function I(E){$=E,r(4,$)}return t.$$set=E=>{"schemes"in E&&r(8,s=E.schemes),"schemesToBeShown"in E&&r(1,l=E.schemesToBeShown),"filterText"in E&&r(0,f=E.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let E of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(E)&&o.setLayoutProperty(E,"visibility",$?"visible":"none");t.$$.dirty&13&&k(f,a,c)},[f,l,a,c,$,i,u,p,s,o,S,T,v,L,I]}class Gi extends R{constructor(e){super(),H(this,e,Vi,zi,W,{schemes:8,schemesToBeShown:1,filterText:0})}}function Ur(t,e,r){const n=t.slice();return n[16]=e[r],n[17]=e,n[18]=r,n}function qi(t){let e,r;return e=new Lt({props:{$$slots:{default:[Zi]},$$scope:{ctx:t}}}),e.$on("click",t[4]),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&524288&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ki(t){let e,r;return e=new Lt({props:{$$slots:{default:[Xi]},$$scope:{ctx:t}}}),e.$on("click",t[3]),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&524288&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Zi(t){let e;return{c(){e=y("Disable Line Measurement Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xi(t){let e;return{c(){e=y("Enable Line Measurement Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Rr(t){var c;let e,r,n,o=[],s=new Map,l,f,i=t[2]&&((c=t[2].properties)==null?void 0:c.length)&&Hr(t);r=new Te({props:{label:"Help",$$slots:{default:[Yi]},$$scope:{ctx:t}}});let a=Ne(t[1]);const u=p=>p[16].id;for(let p=0;p<a.length;p+=1){let $=Ur(t,a,p),k=u($);s.set(k,o[p]=Wr(k,$))}return{c(){i&&i.c(),e=C(),_(r.$$.fragment),n=C();for(let p=0;p<o.length;p+=1)o[p].c();l=at()},m(p,$){i&&i.m(p,$),m(p,e,$),w(r,p,$),m(p,n,$);for(let k=0;k<o.length;k+=1)o[k]&&o[k].m(p,$);m(p,l,$),f=!0},p(p,$){var S;p[2]&&((S=p[2].properties)!=null&&S.length)?i?i.p(p,$):(i=Hr(p),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null);const k={};$&524288&&(k.$$scope={dirty:$,ctx:p}),r.$set(k),$&130&&(a=Ne(p[1]),oe(),o=oo(o,$,u,1,p,a,s,l.parentNode,so,Wr,l,Ur),se())},i(p){if(!f){d(r.$$.fragment,p);for(let $=0;$<a.length;$+=1)d(o[$]);f=!0}},o(p){g(r.$$.fragment,p);for(let $=0;$<o.length;$+=1)g(o[$]);f=!1},d(p){p&&(h(e),h(n),h(l)),i&&i.d(p),b(r,p);for(let $=0;$<o.length;$+=1)o[$].d(p)}}}function Hr(t){var l;let e,r,n=((l=t[2].properties)==null?void 0:l.length)+"",o,s;return{c(){e=P("p"),r=y("Length: "),o=y(n),s=y("m")},m(f,i){m(f,e,i),D(e,r),D(e,o),D(e,s)},p(f,i){var a;i&4&&n!==(n=((a=f[2].properties)==null?void 0:a.length)+"")&&be(o,n)},d(f){f&&h(e)}}}function Yi(t){let e;return{c(){e=P("ul"),e.innerHTML=`<li><b>Click</b>
        on the map to place a new waypoint</li> <li><b>Click and Drag</b>
        an existing waypoint to move it</li> <li><b>Hold shift and click on</b>
        an existing waypoint to delete it</li> <li>Press <b>Escape</b>
        to exit this mode</li>`},m(r,n){m(r,e,n)},p:Y,d(r){r&&h(e)}}}function Wr(t,e){let r,n,o,s;function l(i){e[8](i,e[16])}let f={markerPositionUpdated:e[7]};return e[16].lngLat!==void 0&&(f.markerPosition=e[16].lngLat),n=new ko({props:f}),U.push(()=>G(n,"markerPosition",l)),{key:t,first:null,c(){r=at(),_(n.$$.fragment),this.first=r},m(i,a){m(i,r,a),w(n,i,a),s=!0},p(i,a){e=i;const u={};!o&&a&2&&(o=!0,u.markerPosition=e[16].lngLat,q(()=>o=!1)),n.$set(u)},i(i){s||(d(n.$$.fragment,i),s=!0)},o(i){g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(n,i)}}}function Ji(t){let e,r,n,o,s,l,f;const i=[Ki,qi],a=[];function u(p,$){return p[0]?0:1}e=u(t),r=a[e]=i[e](t);let c=!t[0]&&Rr(t);return{c(){r.c(),n=C(),c&&c.c(),o=at()},m(p,$){a[e].m(p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),s=!0,l||(f=[wt(window,"keydown",t[5]),wt(window,"keyup",t[6])],l=!0)},p(p,[$]){let k=e;e=u(p),e===k?a[e].p(p,$):(oe(),g(a[k],1,1,()=>{a[k]=null}),se(),r=a[e],r?r.p(p,$):(r=a[e]=i[e](p),r.c()),d(r,1),r.m(n.parentNode,n)),p[0]?c&&(oe(),g(c,1,1,()=>{c=null}),se()):c?(c.p(p,$),$&1&&d(c,1)):(c=Rr(p),c.c(),d(c,1),c.m(o.parentNode,o))},i(p){s||(d(r),d(c),s=!0)},o(p){g(r),g(c),s=!1},d(p){p&&(h(n),h(o)),a[e].d(p),c&&c.d(p),l=!1,no(f)}}}const Ye="measurement-line";function Qi(t,e,r){let n;X(t,ee,I=>r(11,n=I));let o=!0,s=[],l,f=!1,i=0;function a(I){o||(f||(s.push({id:i++,lngLat:I.lngLat}),r(1,s),S()),f&&s.length>0&&(u(I.lngLat),S()))}function u(I){let N=new br.LngLat(0,-90).distanceTo(new br.LngLat(0,90)),F;s.forEach(O=>{const A=O.lngLat;N>=I.distanceTo(A)&&(F=A,N=I.distanceTo(A))}),F&&r(1,s=s.filter(O=>{const A=O.lngLat;return A.lng!=(F==null?void 0:F.lng)||A.lat!=(F==null?void 0:F.lat)}))}function c(){r(0,o=!1)}function p(){r(0,o=!0),r(1,s=[]),T()}function $(I){I.key==="Shift"&&(f=!0),I.key==="Escape"&&p()}function k(I){I.key==="Shift"&&(f=!1)}function S(){if(s.length<2){T();return}const I=s.map(E=>[E.lngLat.lng,E.lngLat.lat]);r(2,l=io(I,{})),l.properties&&r(2,l.properties.length=(wo(l)*1e3).toFixed(2),l),v()}function T(){n.getSource(Ye)&&(n.getSource(Ye).setData(cr()),r(2,l=void 0))}function v(){n.getSource(Ye)?n.getSource(Ye).setData(l):(Wt(n,Ye,l),ue(n,{id:Ye,source:Ye,color:po.measuringLine,width:5}))}Dt(()=>{n.on("click",a)}),ur(()=>{n.off("click",a)});function L(I,E){t.$$.not_equal(E.lngLat,I)&&(E.lngLat=I,r(1,s))}return[o,s,l,c,p,$,k,S,L]}class el extends R{constructor(e){super(),H(this,e,Qi,Ji,W,{})}}function tl(t){let e;return{c(){e=y(`Open Government License
  `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rl(t){let e,r,n,o,s;return n=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[tl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("License: "),_(n.$$.fragment),o=y(`. Contains OS data © Crown copyright and database right
  2023.`)},m(l,f){m(l,e,f),D(e,r),w(n,e,null),D(e,o),s=!0},p(l,[f]){const i={};f&1&&(i.$$scope={dirty:f,ctx:l}),n.$set(i)},i(l){s||(d(n.$$.fragment,l),s=!0)},o(l){g(n.$$.fragment,l),s=!1},d(l){l&&h(e),b(n)}}}class Ue extends R{constructor(e){super(),H(this,e,null,rl,W,{})}}function zr(t,e,r){const n=t.slice();return n[2]=e[r],n}function Vr(t,e,r){const n=t.slice();return n[5]=e[r],n}function Gr(t){let e,r;return{c(){e=P("span"),r=y(` 
    `),je(e,"background",t[5]),je(e,"width","100%"),je(e,"border","1px solid black")},m(n,o){m(n,e,o),D(e,r)},p(n,o){o&1&&je(e,"background",n[5])},d(n){n&&h(e)}}}function qr(t){let e,r=t[2]+"",n;return{c(){e=P("span"),n=y(r)},m(o,s){m(o,e,s),D(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&be(n,r)},d(o){o&&h(e)}}}function nl(t){let e,r,n,o=Ne(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Gr(Vr(t,o,i));let l=Ne(t[1]),f=[];for(let i=0;i<l.length;i+=1)f[i]=qr(zr(t,l,i));return{c(){e=P("div");for(let i=0;i<s.length;i+=1)s[i].c();r=C(),n=P("div");for(let i=0;i<f.length;i+=1)f[i].c();je(e,"display","flex"),je(n,"display","flex"),je(n,"justify-content","space-between")},m(i,a){m(i,e,a);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);m(i,r,a),m(i,n,a);for(let u=0;u<f.length;u+=1)f[u]&&f[u].m(n,null)},p(i,[a]){if(a&1){o=Ne(i[0]);let u;for(u=0;u<o.length;u+=1){const c=Vr(i,o,u);s[u]?s[u].p(c,a):(s[u]=Gr(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length}if(a&2){l=Ne(i[1]);let u;for(u=0;u<l.length;u+=1){const c=zr(i,l,u);f[u]?f[u].p(c,a):(f[u]=qr(c),f[u].c(),f[u].m(n,null))}for(;u<f.length;u+=1)f[u].d(1);f.length=l.length}},i:Y,o:Y,d(i){i&&(h(e),h(r),h(n)),jt(s,i),jt(f,i)}}}function ol(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class Ze extends R{constructor(e){super(),H(this,e,ol,nl,W,{colorScale:0,limits:1})}}function sl(t){let e;return{c(){e=y("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function il(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ll(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function al(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fl(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[il]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[ll]},$$scope:{ctx:t}}}),u=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[al]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),f=C(),i=P("p"),a=y("License: "),_(u.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,k){m($,e,k),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m($,f,k),m($,i,k),D(i,a),w(u,i,null),D(i,c),p=!0},p($,k){const S={};k&65536&&(S.$$scope={dirty:k,ctx:$}),n.$set(S);const T={};k&65536&&(T.$$scope={dirty:k,ctx:$}),s.$set(T);const v={};k&65536&&(v.$$scope={dirty:k,ctx:$}),u.$set(v)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(u.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(f),h(i)),b(n),b(s),b(u)}}}function ul(t){let e,r,n;return r=new re({props:{$$slots:{default:[fl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kr(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function cl(t){let e;return{c(){e=y("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pl(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $l(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ml(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function hl(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,k;return s=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[pl]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[$l]},$$scope:{ctx:t}}}),p=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ml]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=C(),n=P("p"),o=y("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),l=y(". Output area boundaries from "),_(f.$$.fragment),i=y("."),a=C(),u=P("p"),c=y("License: "),_(p.$$.fragment),$=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(S,T){m(S,e,T),m(S,r,T),m(S,n,T),D(n,o),w(s,n,null),D(n,l),w(f,n,null),D(n,i),m(S,a,T),m(S,u,T),D(u,c),w(p,u,null),D(u,$),k=!0},p(S,T){const v={};T&65536&&(v.$$scope={dirty:T,ctx:S}),s.$set(v);const L={};T&65536&&(L.$$scope={dirty:T,ctx:S}),f.$set(L);const I={};T&65536&&(I.$$scope={dirty:T,ctx:S}),p.$set(I)},i(S){k||(d(s.$$.fragment,S),d(f.$$.fragment,S),d(p.$$.fragment,S),k=!0)},o(S){g(s.$$.fragment,S),g(f.$$.fragment,S),g(p.$$.fragment,S),k=!1},d(S){S&&(h(e),h(r),h(n),h(a),h(u)),b(s),b(f),b(p)}}}function dl(t){let e,r,n;return r=new re({props:{$$slots:{default:[hl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Zr(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function gl(t){let e;return{c(){e=y("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _l(t){let e;return{c(){e=y(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function bl(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[_l]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[wl]},$$scope:{ctx:t}}}),i=new Ue({}),{c(){e=P("p"),r=y("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),f=C(),_(i.$$.fragment)},m(u,c){m(u,e,c),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&65536&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&65536&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function vl(t){let e,r,n;return r=new re({props:{$$slots:{default:[bl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Xr(t){let e,r,n,o;return n=new Ze({props:{colorScale:t[4],limits:t[7]().map(kl)}}),{c(){e=P("p"),e.textContent="(people per square kilometres)",r=C(),_(n.$$.fragment)},m(s,l){m(s,e,l),m(s,r,l),w(n,s,l),o=!0},p:Y,i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function yl(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,k;function S(A){t[9](A)}let T={id:"percent_households_with_car",$$slots:{right:[ul],default:[sl]},$$scope:{ctx:t}};t[0]!==void 0&&(T.checked=t[0]),e=new te({props:T}),U.push(()=>G(e,"checked",S)),e.$on("change",t[10]);let v=t[3]=="percent_households_with_car"&&Kr(t);function L(A){t[11](A)}let I={id:"average_cars_per_household",$$slots:{right:[dl],default:[cl]},$$scope:{ctx:t}};t[1]!==void 0&&(I.checked=t[1]),s=new te({props:I}),U.push(()=>G(s,"checked",L)),s.$on("change",t[12]);let E=t[3]=="average_cars_per_household"&&Zr(t);function N(A){t[13](A)}let F={id:"population_density",$$slots:{right:[vl],default:[gl]},$$scope:{ctx:t}};t[2]!==void 0&&(F.checked=t[2]),a=new te({props:F}),U.push(()=>G(a,"checked",N)),a.$on("change",t[14]);let O=t[3]=="population_density"&&Xr(t);return $=new Q({props:{layer:Ae,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=C(),v&&v.c(),o=C(),_(s.$$.fragment),f=C(),E&&E.c(),i=C(),_(a.$$.fragment),c=C(),O&&O.c(),p=C(),_($.$$.fragment)},m(A,M){w(e,A,M),m(A,n,M),v&&v.m(A,M),m(A,o,M),w(s,A,M),m(A,f,M),E&&E.m(A,M),m(A,i,M),w(a,A,M),m(A,c,M),O&&O.m(A,M),m(A,p,M),w($,A,M),k=!0},p(A,[M]){const B={};M&65536&&(B.$$scope={dirty:M,ctx:A}),!r&&M&1&&(r=!0,B.checked=A[0],q(()=>r=!1)),e.$set(B),A[3]=="percent_households_with_car"?v?(v.p(A,M),M&8&&d(v,1)):(v=Kr(A),v.c(),d(v,1),v.m(o.parentNode,o)):v&&(oe(),g(v,1,1,()=>{v=null}),se());const Z={};M&65536&&(Z.$$scope={dirty:M,ctx:A}),!l&&M&2&&(l=!0,Z.checked=A[1],q(()=>l=!1)),s.$set(Z),A[3]=="average_cars_per_household"?E?(E.p(A,M),M&8&&d(E,1)):(E=Zr(A),E.c(),d(E,1),E.m(i.parentNode,i)):E&&(oe(),g(E,1,1,()=>{E=null}),se());const ne={};M&65536&&(ne.$$scope={dirty:M,ctx:A}),!u&&M&4&&(u=!0,ne.checked=A[2],q(()=>u=!1)),a.$set(ne),A[3]=="population_density"?O?(O.p(A,M),M&8&&d(O,1)):(O=Xr(A),O.c(),d(O,1),O.m(p.parentNode,p)):O&&(oe(),g(O,1,1,()=>{O=null}),se());const z={};M&8&&(z.show=A[3]!=""),$.$set(z)},i(A){k||(d(e.$$.fragment,A),d(v),d(s.$$.fragment,A),d(E),d(a.$$.fragment,A),d(O),d($.$$.fragment,A),k=!0)},o(A){g(e.$$.fragment,A),g(v),g(s.$$.fragment,A),g(E),g(a.$$.fragment,A),g(O),g($.$$.fragment,A),k=!1},d(A){A&&(h(n),h(o),h(f),h(i),h(c),h(p)),b(e,A),v&&v.d(A),b(s,A),E&&E.d(A),b(a,A),O&&O.d(A),b($,A)}}}let Ae="census_output_areas";const kl=t=>t.toLocaleString();function Sl(t,e,r){let n;X(t,ee,I=>r(8,n=I));let o=`${Ae}-outline`,s=V.sequential_low_to_high,l=!1,f=!1,i=!1,a="";fe(n,Ae,`${ie()}/v1/${Ae}.pmtiles`),Ke(n,{id:Ae,source:Ae,sourceLayer:Ae,color:"black",opacity:ce(.5,.7)}),ue(n,{id:o,source:Ae,sourceLayer:Ae,color:"black",width:.5});function u(I){let E=I.properties.OA21CD,N=I.properties[a];return a=="percent_households_with_car"?`<p>${N}% of households in ${E} have 1 or more cars</p>`:a=="average_cars_per_household"?`<p>Households in ${E} have an average of ${N} cars</p>`:`<p>There are ${N.toLocaleString()} people per square kilometre in ${E}</p>`}function c(I){let E=I.detail.properties.OA21CD;a=="percent_households_with_car"||a=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${E}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${E}`,"_blank")}function p(){return a=="percent_households_with_car"?[0,20,40,60,80,100]:a=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(I){l=I,r(0,l)}const k=()=>{r(1,f=!1),r(2,i=!1)};function S(I){f=I,r(1,f)}const T=()=>{r(0,l=!1),r(2,i=!1)};function v(I){i=I,r(2,i)}const L=()=>{r(0,l=!1),r(1,f=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,a="percent_households_with_car"):f?r(3,a="average_cars_per_household"):i?r(3,a="population_density"):r(3,a=""),a?(n.setPaintProperty(Ae,"fill-color",qe(["get",a],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,f,i,a,s,u,c,p,n,$,k,S,T,v,L]}class Tl extends R{constructor(e){super(),H(this,e,Sl,yl,W,{})}}function Cl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ll(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Al(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Ll]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of December 2022."),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Ol(t){let e,r,n;return r=new re({props:{$$slots:{default:[Al]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Dl(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:We,$$slots:{right:[Ol],default:[Cl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:We,tooltip:El,show:t[0],clickable:!0}}),o.$on("click",Pl),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let We="combined_authorities";function El(t){return`<p>${t.properties.name}</p>`}function Pl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function Ml(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.combined_authorities,s=`${We}-outline`;Wt(n,We,`${ie()}/v1/${We}.geojson`),Ke(n,{id:We,source:We,color:o,opacity:ce(.5,0)}),ue(n,{id:s,source:We,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Nl extends R{constructor(e){super(),H(this,e,Ml,Dl,W,{})}}function Il(t){let e;return{c(){e=y("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fl(t){let e;return{c(){e=y(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bl(t){let e;return{c(){e=y(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xl(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Fl]},$$scope:{ctx:t}}}),s=new x({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Bl]},$$scope:{ctx:t}}}),i=new Ue({}),{c(){e=P("p"),r=y("The 2019 English IMD scores come from "),_(n.$$.fragment),o=y(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),l=y("."),f=C(),_(i.$$.fragment)},m(u,c){m(u,e,c),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function jl(t){let e,r,n;return r=new re({props:{$$slots:{default:[xl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Yr(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ul(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:Oe,$$slots:{right:[jl],default:[Il]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&Yr(t);return s=new Q({props:{layer:Oe,tooltip:Rl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),a&&a.c(),o=C(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=Yr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Oe="imd";function Rl(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function Hl(t,e,r){let n;X(t,ee,a=>r(2,n=a));let o=`${Oe}-outline`,s=V.sequential_low_to_high,l=[0,2,4,6,8,10];fe(n,Oe,`${ie()}/v1/${Oe}.pmtiles`),Ke(n,{id:Oe,source:Oe,sourceLayer:Oe,color:qe(["-",10,["get","decile"]],l,s),opacity:ce(.5,.7)}),ue(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});let f=!1;function i(a){f=a,r(0,f)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",f?"visible":"none")},[f,s,n,i]}class Wl extends R{constructor(e){super(),H(this,e,Hl,Ul,W,{})}}function zl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Vl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gl(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Vl]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function ql(t){let e,r,n;return r=new re({props:{$$slots:{default:[Gl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kl(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:ze,$$slots:{right:[ql],default:[zl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:ze,tooltip:Zl,show:t[0],clickable:!0}}),o.$on("click",Xl),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let ze="local_authority_districts";function Zl(t){return`<p>${t.properties.name}</p>`}function Xl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function Yl(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.local_authority_districts,s=`${ze}-outline`;Wt(n,ze,`${ie()}/v1/${ze}.geojson`),Ke(n,{id:ze,source:ze,color:o,opacity:ce(.5,0)}),ue(n,{id:s,source:ze,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Jl extends R{constructor(e){super(),H(this,e,Yl,Kl,W,{})}}function Ql(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ea(t){let e;return{c(){e=y(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ta(t){let e;return{c(){e=y(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ra(t){let e;return{c(){e=y(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function na(t){let e;return{c(){e=y("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function oa(t){let e;return{c(){e=y(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function sa(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,k,S,T,v,L,I,E,N,F;return n=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[ea]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[ta]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[ra]},$$scope:{ctx:t}}}),$=new x({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[na]},$$scope:{ctx:t}}}),L=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[oa]},$$scope:{ctx:t}}}),N=new Ue({}),{c(){e=P("p"),r=y("LPAs may be a "),_(n.$$.fragment),o=y(", "),_(s.$$.fragment),l=y("y, or "),_(f.$$.fragment),i=y("."),a=C(),u=P("p"),c=P("strong"),p=y(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),k=y(" to get more details."),S=C(),T=P("p"),v=y("Data from ONS Geography via "),_(L.$$.fragment),I=y(", as of November 2022."),E=C(),_(N.$$.fragment)},m(O,A){m(O,e,A),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),w(f,e,null),D(e,i),m(O,a,A),m(O,u,A),D(u,c),D(c,p),w($,c,null),D(c,k),m(O,S,A),m(O,T,A),D(T,v),w(L,T,null),D(T,I),m(O,E,A),w(N,O,A),F=!0},p(O,A){const M={};A&32&&(M.$$scope={dirty:A,ctx:O}),n.$set(M);const B={};A&32&&(B.$$scope={dirty:A,ctx:O}),s.$set(B);const Z={};A&32&&(Z.$$scope={dirty:A,ctx:O}),f.$set(Z);const ne={};A&32&&(ne.$$scope={dirty:A,ctx:O}),$.$set(ne);const z={};A&32&&(z.$$scope={dirty:A,ctx:O}),L.$set(z)},i(O){F||(d(n.$$.fragment,O),d(s.$$.fragment,O),d(f.$$.fragment,O),d($.$$.fragment,O),d(L.$$.fragment,O),d(N.$$.fragment,O),F=!0)},o(O){g(n.$$.fragment,O),g(s.$$.fragment,O),g(f.$$.fragment,O),g($.$$.fragment,O),g(L.$$.fragment,O),g(N.$$.fragment,O),F=!1},d(O){O&&(h(e),h(a),h(u),h(S),h(T),h(E)),b(n),b(s),b(f),b($),b(L),b(N,O)}}}function ia(t){let e,r,n;return r=new re({props:{$$slots:{default:[sa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function la(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:De,$$slots:{right:[ia],default:[Ql]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:De,tooltip:aa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="local_planning_authorities";function aa(t){return`<p>${t.properties.name}</p>`}function fa(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.local_planning_authorities,s=`${De}-outline`;fe(n,De,`${ie()}/v1/${De}.pmtiles`),Ke(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ce(.5,0)}),ue(n,{id:s,source:De,sourceLayer:De,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class ua extends R{constructor(e){super(),H(this,e,fa,la,W,{})}}function ca(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function pa(t){let e;return{c(){e=y(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $a(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[pa]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function ma(t){let e,r,n;return r=new re({props:{$$slots:{default:[$a]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ha(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ee,$$slots:{right:[ma],default:[ca]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ee,tooltip:da,show:t[0],clickable:!0}}),o.$on("click",ga),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="parliamentary_constituencies";function da(t){return`<p>${t.properties.Name}</p>`}function ga(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function _a(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.parliamentary_constituencies,s=`${Ee}-outline`;fe(n,Ee,`${ie()}/v1/${Ee}.pmtiles`),Ke(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ce(.5,0)}),ue(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class wa extends R{constructor(e){super(),H(this,e,_a,ha,W,{})}}function ba(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function va(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ya(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[va]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function ka(t){let e,r,n;return r=new re({props:{$$slots:{default:[ya]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Sa(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Pe,$$slots:{right:[ka],default:[ba]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Pe,tooltip:Ta,show:t[0],clickable:!0}}),o.$on("click",Ca),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Pe="wards";function Ta(t){return`<p>${t.properties.name}</p>`}function Ca(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function La(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=V.wards,s=`${Pe}-outline`;fe(n,Pe,`${ie()}/v1/${Pe}.pmtiles`),Ke(n,{id:Pe,source:Pe,sourceLayer:Pe,color:o,opacity:ce(.5,0)}),ue(n,{id:s,source:Pe,sourceLayer:Pe,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Aa extends R{constructor(e){super(),H(this,e,La,Sa,W,{})}}function Oa(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Da(t){let e,r,n,o;return n=new x({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Oa]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("License: "),_(n.$$.fragment)},m(s,l){m(s,e,l),D(e,r),w(n,e,null),o=!0},p(s,[l]){const f={};l&1&&(f.$$scope={dirty:l,ctx:s}),n.$set(f)},i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&h(e),b(n)}}}class Xe extends R{constructor(e){super(),H(this,e,null,Da,W,{})}}function Ea(t){let e,r,n;return e=new _e({props:{color:V.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=y(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Pa(t){let e;return{c(){e=y(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ma(t){let e,r,n,o,s,l,f,i,a;return s=new x({props:{href:"https://gtfs.org",$$slots:{default:[Pa]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=P("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=C(),n=P("p"),o=y("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),l=y(`, and doesn't include which routes are run or the
        frequency of service.`),f=C(),_(i.$$.fragment)},m(u,c){m(u,e,c),m(u,r,c),m(u,n,c),D(n,o),w(s,n,null),D(n,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&8&&(p.$$scope={dirty:c,ctx:u}),s.$set(p)},i(u){a||(d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(r),h(n),h(f)),b(s),b(i,u)}}}function Na(t){let e,r,n;return r=new re({props:{$$slots:{default:[Ma]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ia(t){let e,r,n,o,s;function l(i){t[1](i)}let f={id:Je,$$slots:{right:[Na],default:[Ea]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Je,tooltip:Fa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&8&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Je="bus_routes";function Fa(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Ba(t,e,r){let n;X(t,ee,l=>r(2,n=l)),fe(n,Je,`${ie()}/v1/${Je}.pmtiles`),ue(n,{id:Je,source:Je,sourceLayer:Je,color:["case",["boolean",["get","has_bus_lane"],!1],V.bus_route_with_lane,V.bus_route_without_lane],width:5,opacity:ce(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class xa extends R{constructor(e){super(),H(this,e,Ba,Ia,W,{})}}function Jr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function ja(t){let e;return{c(){e=y("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ua(t){let e,r,n,o,s,l,f,i;return f=new Xe({}),{c(){e=P("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=C(),n=P("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=C(),s=P("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=C(),_(f.$$.fragment)},m(a,u){m(a,e,u),m(a,r,u),m(a,n,u),m(a,o,u),m(a,s,u),m(a,l,u),w(f,a,u),i=!0},p:Y,i(a){i||(d(f.$$.fragment,a),i=!0)},o(a){g(f.$$.fragment,a),i=!1},d(a){a&&(h(e),h(r),h(n),h(o),h(s),h(l)),b(f,a)}}}function Ra(t){let e,r,n;return r=new re({props:{$$slots:{default:[Ua]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Qr(t){let e,r,n=Ne(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=en(Jr(t,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=at()},m(l,f){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,f);m(l,e,f),r=!0},p(l,f){if(f&2){n=Ne(l[1]);let i;for(i=0;i<n.length;i+=1){const a=Jr(l,n,i);o[i]?(o[i].p(a,f),d(o[i],1)):(o[i]=en(a),o[i].c(),d(o[i],1),o[i].m(e.parentNode,e))}for(oe(),i=n.length;i<o.length;i+=1)s(i);se()}},i(l){if(!r){for(let f=0;f<n.length;f+=1)d(o[f]);r=!0}},o(l){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)g(o[f]);r=!1},d(l){l&&h(e),jt(o,l)}}}function en(t){let e,r,n,o=t[4]+"",s,l,f;return r=new _e({props:{color:t[5]}}),{c(){e=P("div"),_(r.$$.fragment),n=C(),s=y(o),l=C()},m(i,a){m(i,e,a),w(r,e,null),D(e,n),D(e,s),D(e,l),f=!0},p:Y,i(i){f||(d(r.$$.fragment,i),f=!0)},o(i){g(r.$$.fragment,i),f=!1},d(i){i&&h(e),b(r)}}}function Ha(t){let e,r,n,o,s,l;function f(u){t[2](u)}let i={id:Qe,$$slots:{right:[Ra],default:[ja]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&Qr(t);return s=new Q({props:{layer:Qe,tooltip:Wa,show:t[0],clickable:!0}}),s.$on("click",za),{c(){_(e.$$.fragment),n=C(),a&&a.c(),o=C(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=Qr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Qe="cycle_paths";function Wa(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function za(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Va(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=[["Separated tracks",V.cycle_paths.track],["Unprotected lanes",V.cycle_paths.lane],["Shared-use (segregated)",V.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",V.cycle_paths.shared_use_unsegregated]];fe(n,Qe,`${ie()}/v1/${Qe}.pmtiles`),ue(n,{id:Qe,source:Qe,sourceLayer:Qe,color:_n(["get","kind"],{track:V.cycle_paths.track,lane:V.cycle_paths.lane,shared_use_segregated:V.cycle_paths.shared_use_segregated,shared_use_unsegregated:V.cycle_paths.shared_use_unsegregated},"red"),width:zt,opacity:ce(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Ga extends R{constructor(e){super(),H(this,e,Va,Ha,W,{})}}function qa(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ka(t){let e;return{c(){e=y(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Za(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Ka]},$$scope:{ctx:t}}}),l=new Ue({}),{c(){e=P("p"),r=y("Data from the "),_(n.$$.fragment),o=y(", as of September 2021."),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Xa(t){let e,r,n;return r=new re({props:{$$slots:{default:[Za]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ya(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:et,$$slots:{right:[Xa],default:[qa]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:et,tooltip:Ja,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let et="mrn";function Ja(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Qa(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=V.mrn;fe(n,et,`${ie()}/v1/${et}.pmtiles`),ue(n,{id:et,source:et,sourceLayer:et,color:o,width:7,opacity:ce(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class ef extends R{constructor(e){super(),H(this,e,Qa,Ya,W,{})}}function tf(t){let e;return{c(){e=y("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rf(t){let e;return{c(){e=y("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nf(t){let e;return{c(){e=y("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function of(t){let e,r,n,o,s,l,f,i,a,u,c;return f=new x({props:{href:"https://www.pct.bike",$$slots:{default:[rf]},$$scope:{ctx:t}}}),a=new x({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[nf]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=C(),n=P("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=C(),s=P("p"),l=y("See "),_(f.$$.fragment),i=y(" and "),_(a.$$.fragment),u=y(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),D(s,l),w(f,s,null),D(s,i),w(a,s,null),D(s,u),c=!0},p(p,$){const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),f.$set(k);const S={};$&2048&&(S.$$scope={dirty:$,ctx:p}),a.$set(S)},i(p){c||(d(f.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(f.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(f),b(a)}}}function sf(t){let e,r,n;return r=new re({props:{$$slots:{default:[of]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function tn(t){let e,r,n,o,s,l,f,i;e=new Ze({props:{colorScale:t[3],limits:t[4]}});function a($){t[8]($)}let u={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(u.value=t[0]),n=new bn({props:u}),U.push(()=>G(n,"value",a)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new Ut({props:p}),U.push(()=>G(l,"value",c)),l.$on("change",t[6]),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),s=C(),_(l.$$.fragment)},m($,k){w(e,$,k),m($,r,k),w(n,$,k),m($,s,k),w(l,$,k),i=!0},p($,k){const S={};!o&&k&1&&(o=!0,S.value=$[0],q(()=>o=!1)),n.$set(S);const T={};!f&&k&2&&(f=!0,T.value=$[1],q(()=>f=!1)),l.$set(T)},i($){i||(d(e.$$.fragment,$),d(n.$$.fragment,$),d(l.$$.fragment,$),i=!0)},o($){g(e.$$.fragment,$),g(n.$$.fragment,$),g(l.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(l,$)}}}function lf(t){let e,r,n,o,s,l,f,i;function a(p){t[7](p)}let u={id:it,$$slots:{right:[sf],default:[tf]},$$scope:{ctx:t}};t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),U.push(()=>G(e,"checked",a));let c=t[2]&&tn(t);return s=new Q({props:{layer:it,tooltip:t[5],show:t[2]&&t[0]==it,clickable:!1}}),f=new Q({props:{layer:xt,tooltip:t[5],show:t[2]&&t[0]==xt,clickable:!1}}),{c(){_(e.$$.fragment),n=C(),c&&c.c(),o=C(),_(s.$$.fragment),l=C(),_(f.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(f,p,$),i=!0},p(p,[$]){const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,k.checked=p[2],q(()=>r=!1)),e.$set(k),p[2]?c?(c.p(p,$),$&4&&d(c,1)):(c=tn(p),c.c(),d(c,1),c.m(o.parentNode,o)):c&&(oe(),g(c,1,1,()=>{c=null}),se());const S={};$&5&&(S.show=p[2]&&p[0]==it),s.$set(S);const T={};$&5&&(T.show=p[2]&&p[0]==xt),f.$set(T)},i(p){i||(d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(f.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(f.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(l)),b(e,p),c&&c.d(p),b(s,p),b(f,p)}}}let it="pct_commute",xt="pct_school";function af(t,e,r){let n;X(t,ee,k=>r(10,n=k));let o=V.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=it,f="baseline";for(let k of[it,xt])fe(n,k,`${ie()}/v1/${k}.pmtiles`),ue(n,{id:k,source:k,sourceLayer:k,color:qe(["get",f],s,o),width:zt,opacity:ce(.5,1)});let i=!1;function a(k){let S=k.properties.baseline,T=k.properties.gov_target,v=k.properties.go_dutch,L=`<h2>Trip purpose: ${l==it?"commuting":"school"}</h2>`;if(L+=`<p>Baseline (2011): <b>${S.toLocaleString()}</b></p>`,S==0)L+=`<p>Government target (2025): <b>${T.toLocaleString()}</b></p>`,L+=`<p>Go Dutch: <b>${v.toLocaleString()}</b></p>`;else{let I=(T/S).toFixed(1),E=(v/S).toFixed(1);L+=`<p>Government target (2025): ${T.toLocaleString()} (<b>${I}x</b> of baseline)</p>`,L+=`<p>Go Dutch: ${v.toLocaleString()} (<b>${E}x</b> of baseline)</p>`}return L}function u(){n.setPaintProperty(l,"line-color",qe(["get",f],s,o))}function c(k){i=k,r(2,i)}function p(k){l=k,r(0,l)}function $(k){f=k,r(1,f)}return[l,f,i,o,s,a,u,c,p,$]}class ff extends R{constructor(e){super(),H(this,e,af,lf,W,{})}}function uf(t){let e;return{c(){e=y("OS Speeds")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function cf(t){let e;return{c(){e=y("Basemap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pf(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $f(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[cf]},$$scope:{ctx:t}}}),u=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[pf]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=y(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=C(),l=P("p"),l.textContent="Data valid as of 1 September, 2023",f=C(),i=P("p"),a=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),c=y(".")},m($,k){m($,e,k),D(e,r),w(n,e,null),D(e,o),m($,s,k),m($,l,k),m($,f,k),m($,i,k),D(i,a),w(u,i,null),D(i,c),p=!0},p($,k){const S={};k&256&&(S.$$scope={dirty:k,ctx:$}),n.$set(S);const T={};k&256&&(T.$$scope={dirty:k,ctx:$}),u.$set(T)},i($){p||(d(n.$$.fragment,$),d(u.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(s),h(l),h(f),h(i)),b(n),b(u)}}}function mf(t){let e,r,n;return r=new re({props:{$$slots:{default:[$f]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function rn(t){let e,r,n,o,s;e=new Ze({props:{colorScale:t[2],limits:t[3]}});function l(i){t[6](i)}let f={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(f.value=t[0]),n=new bn({props:f}),U.push(()=>G(n,"value",l)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment)},m(i,a){w(e,i,a),m(i,r,a),w(n,i,a),s=!0},p(i,a){const u={};!o&&a&1&&(o=!0,u.value=i[0],q(()=>o=!1)),n.$set(u)},i(i){s||(d(e.$$.fragment,i),d(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(e,i),b(n,i)}}}function hf(t){let e,r,n,o,s,l;function f(u){t[5](u)}let i={id:Ve,$$slots:{right:[mf],default:[uf]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[1]&&rn(t);return s=new Q({props:{layer:Ve,tooltip:df,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),a&&a.c(),o=C(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&2&&(r=!0,p.checked=u[1],q(()=>r=!1)),e.$set(p),u[1]?a?(a.p(u,c),c&2&&d(a,1)):(a=rn(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&2&&($.show=u[1]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Ve="road_speeds";function df(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function gf(t,e,r){let n;X(t,ee,c=>r(7,n=c));let o=V.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";fe(n,Ve,`${pr()}/v1/${Ve}.pmtiles`),ue(n,{id:Ve,source:Ve,sourceLayer:Ve,color:qe(["get",l],s,o),width:zt,opacity:ce(.5,1)});let f=!1;function i(){n.setPaintProperty(Ve,"line-color",qe(["get",l],s,o))}function a(c){f=c,r(1,f)}function u(c){l=c,r(0,l)}return[l,f,o,s,i,a,u]}class _f extends R{constructor(e){super(),H(this,e,gf,hf,W,{})}}function wf(t){let e;return{c(){e=y("OS Road widths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function bf(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function vf(t){let e,r,n,o,s,l,f,i,a;return f=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[bf]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=C(),n=P("p"),n.textContent="Data valid as of 1 September, 2023",o=C(),s=P("p"),l=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(f.$$.fragment),i=y(".")},m(u,c){m(u,e,c),m(u,r,c),m(u,n,c),m(u,o,c),m(u,s,c),D(s,l),w(f,s,null),D(s,i),a=!0},p(u,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),f.$set(p)},i(u){a||(d(f.$$.fragment,u),a=!0)},o(u){g(f.$$.fragment,u),a=!1},d(u){u&&(h(e),h(r),h(n),h(o),h(s)),b(f)}}}function yf(t){let e,r,n;return r=new re({props:{$$slots:{default:[vf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function nn(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function kf(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:tt,$$slots:{right:[yf],default:[wf]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&nn(t);return s=new Q({props:{layer:tt,tooltip:Sf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),a&&a.c(),o=C(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=nn(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let tt="road_widths";function Sf(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function Tf(t,e,r){let n;X(t,ee,i=>r(4,n=i));let o=V.sequential_low_to_high,s=[0,5,10,15,20,100];fe(n,tt,`${pr()}/v1/${tt}.pmtiles`),ue(n,{id:tt,source:tt,sourceLayer:tt,color:qe(["get","average"],s,o),width:zt,opacity:ce(.5,1)});let l=!1;function f(i){l=i,r(0,l)}return[l,o,s,f]}class Cf extends R{constructor(e){super(),H(this,e,Tf,kf,W,{})}}function Lf(t){let e,r,n;return{c(){e=P("input"),j(e,"class","govuk-file-upload"),j(e,"id","load-criticals"),j(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=wt(e,"change",t[4]),r=!0)},p:Y,d(o){o&&h(e),t[7](null),r=!1,n()}}}function on(t){let e,r;return e=new Et({props:{small:!0,$$slots:{default:[Of]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Af(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new _e({props:{color:ir}}),{c(){_(e.$$.fragment),r=y(`
        Show `),o=y(n),s=y(" issues")},m(f,i){w(e,f,i),m(f,r,i),m(f,o,i),m(f,s,i),l=!0},p(f,i){(!l||i&4)&&n!==(n=f[2].toLocaleString()+"")&&be(o,n)},i(f){l||(d(e.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o),h(s)),b(e,f)}}}function Of(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[Af]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),U.push(()=>G(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){w(e,l,f),n=!0},p(l,f){const i={};f&516&&(i.$$scope={dirty:f,ctx:l}),!r&&f&1&&(r=!0,i.checked=l[0],q(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function Df(t){let e,r,n,o,s,l;e=new wn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[Lf]},$$scope:{ctx:t}}}),n=new vn({props:{errorMessage:t[3]}});let f=t[2]>0&&on(t);return{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),f&&f.c(),s=at()},m(i,a){w(e,i,a),m(i,r,a),w(n,i,a),m(i,o,a),f&&f.m(i,a),m(i,s,a),l=!0},p(i,a){const u={};a&514&&(u.$$scope={dirty:a,ctx:i}),e.$set(u);const c={};a&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?f?(f.p(i,a),a&4&&d(f,1)):(f=on(i),f.c(),d(f,1),f.m(s.parentNode,s)):f&&(oe(),g(f,1,1,()=>{f=null}),se())},i(i){l||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(f),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(f),l=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),f&&f.d(i)}}}function Ef(t){let e,r,n,o,s,l;return e=new Te({props:{label:"Critical Issues",$$slots:{default:[Df]},$$scope:{ctx:t}}}),n=new Q({props:{layer:le+"-points",tooltip:Pf,show:t[0],clickable:!1}}),s=new Q({props:{layer:le+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[le+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),_(s.$$.fragment)},m(f,i){w(e,f,i),m(f,r,i),w(n,f,i),m(f,o,i),w(s,f,i),l=!0},p(f,[i]){const a={};i&527&&(a.$$scope={dirty:i,ctx:f}),e.$set(a);const u={};i&1&&(u.show=f[0]),n.$set(u);const c={};i&1&&(c.show=f[0]),s.$set(c)},i(f){l||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o)),b(e,f),b(n,f),b(s,f)}}}let le="criticals",ir="red";function Pf(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function Mf(t,e,r){let n;X(t,ee,p=>r(6,n=p));let o,s=!0,l=0,f="";lo(n,le),n.addSource(le,{type:"geojson",data:cr(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),bt(n,{id:`${le}-clusters`,source:le,filter:["has","point_count"],color:ir,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${le}-counts`,source:le,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),bt(n,{id:`${le}-points`,source:le,filter:["!",["has","point_count"]],color:ir,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await Ii(o.files[0]);n.getSource(le).setData($),r(2,l=$.features.length),r(3,f="")}catch($){r(3,f=`The file you loaded is broken: ${$}`)}}function a(p){n.getSource(le).getClusterExpansionZoom(p.detail.properties.cluster_id,($,k)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:k})})}function u(p){U[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${le}-counts`)&&n.setLayoutProperty(`${le}-counts`,"visibility",s?"visible":"none")},[s,o,l,f,i,a,n,u,c]}class Nf extends R{constructor(e){super(),H(this,e,Mf,Ef,W,{})}}function If(t){let e,r,n;return e=new _e({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=y(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ff(t){let e;return{c(){e=y("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[Ff]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function xf(t){let e,r,n;return r=new re({props:{$$slots:{default:[Bf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function jf(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ge,$$slots:{right:[xf],default:[If]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:Ge,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",Uf),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Ge="crossings";function Uf(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function Rf(t,e,r){let n;X(t,ee,a=>r(4,n=a));let o=!1;function s(a){const u=a.properties.crossing;return`<p>${l.get(u)??`Crossing with unknown type (${u})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);fe(n,Ge,`${ie()}/v1/${Ge}.pmtiles`);let f=V[Ge];bt(n,{id:Ge,source:Ge,sourceLayer:Ge,color:f,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(a){o=a,r(0,o)}return[o,s,f,i]}class Hf extends R{constructor(e){super(),H(this,e,Rf,jf,W,{})}}function Wf(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function zf(t){let e;return{c(){e=y("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[zf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("Cycle parking, according to "),_(n.$$.fragment),o=y(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Gf(t){let e,r,n;return r=new re({props:{$$slots:{default:[Vf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function qf(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:rt,$$slots:{right:[Gf],default:[Wf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:rt,tooltip:Kf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let rt="cycle_parking";function Kf(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function Zf(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=V.cycle_parking;fe(n,rt,`${ie()}/v1/${rt}.pmtiles`),bt(n,{id:rt,source:rt,sourceLayer:rt,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Xf extends R{constructor(e){super(),H(this,e,Zf,qf,W,{})}}function Yf(t){let e,r,n,o;return e=new _e({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=C(),n=y(t[1])},m(s,l){w(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&be(n,s[1])},i(s){o||(d(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function Jf(t){let e;const r=t[6].default,n=mn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&hn(n,r,o,o[8],e?gn(r,o[8],s,null):dn(o[8]),null)},i(o){e||(d(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Qf(t){let e,r,n;return r=new re({props:{$$slots:{default:[Jf]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function eu(t){let e,r,n,o,s;function l(i){t[7](i)}let f={id:t[0],$$slots:{right:[Qf],default:[Yf]},$$scope:{ctx:t}};return t[2]!==void 0&&(f.checked=t[2]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&1&&(u.id=i[0]),a&258&&(u.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,u.checked=i[2],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.layer=i[0]),a&4&&(c.show=i[2]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function tu(t,e,r){let n;X(t,ee,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:f}=e,{pluralNoun:i}=e,a=V[l];fe(n,l,`${ie()}/v1/${l}.pmtiles`),Ke(n,{id:l,source:l,sourceLayer:l,color:a,opacity:ce(1,.7)});let u=!1;function c($){return`<p>${$.properties.name??`Unnamed ${f}`}</p>`}function p($){u=$,r(2,u)}return t.$$set=$=>{"name"in $&&r(0,l=$.name),"singularNoun"in $&&r(5,f=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[l,i,u,a,c,f,o,p,s]}class mr extends R{constructor(e){super(),H(this,e,tu,eu,W,{name:0,singularNoun:5,pluralNoun:1})}}function ru(t){let e;return{c(){e=y("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nu(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[ru]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function ou(t){let e,r;return e=new mr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[nu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class su extends R{constructor(e){super(),H(this,e,null,ou,W,{})}}function iu(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Y,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function lu(t){let e;return{c(){e=y("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function au(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[lu]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function fu(t){let e,r,n;return r=new re({props:{$$slots:{default:[au]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function uu(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:nt,$$slots:{right:[fu],default:[iu]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),U.push(()=>G(e,"checked",l)),o=new Q({props:{layer:nt,tooltip:cu,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],q(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const nt="railway_stations";function cu(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function pu(t,e,r){let n;X(t,ee,i=>r(3,n=i));const o=`${ie()}/v1/${nt}.geojson`;let s=!1;Wt(n,nt,o);let l=V[nt];bt(n,{id:nt,source:nt,color:l,radius:$o/2});function f(i){s=i,r(0,s)}return[s,l,f]}class $u extends R{constructor(e){super(),H(this,e,pu,uu,W,{})}}function mu(t){let e;return{c(){e=y("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function hu(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[mu]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=C(),_(l.$$.fragment)},m(i,a){m(i,e,a),D(e,r),w(n,e,null),D(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function du(t){let e,r;return e=new mr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[hu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class gu extends R{constructor(e){super(),H(this,e,null,du,W,{})}}function _u(t){let e;return{c(){e=y("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wu(t){let e;return{c(){e=y("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function bu(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[_u]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[wu]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=P("p"),r=y("This shows "),_(n.$$.fragment),o=y(" and "),_(s.$$.fragment),l=y(" data from OpenStreetMap (as of 9 August 2023)."),f=C(),_(i.$$.fragment)},m(u,c){m(u,e,c),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function vu(t){let e,r;return e=new mr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[bu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class yu extends R{constructor(e){super(),H(this,e,null,vu,W,{})}}function ku(t){let e;return{c(){e=y("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Su(t){let e;return{c(){e=y(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Tu(t){let e;return{c(){e=y("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cu(t){let e,r,n,o,s,l,f,i,a,u,c;return n=new x({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[Su]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[Tu]},$$scope:{ctx:t}}}),u=new Ue({}),{c(){e=P("p"),r=y("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=y(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),l=y(" for details and caveats about the measurements."),f=C(),i=P("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,a=C(),_(u.$$.fragment)},m(p,$){m(p,e,$),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,l),m(p,f,$),m(p,i,$),m(p,a,$),w(u,p,$),c=!0},p(p,$){const k={};$&64&&(k.$$scope={dirty:$,ctx:p}),n.$set(k);const S={};$&64&&(S.$$scope={dirty:$,ctx:p}),s.$set(S)},i(p){c||(d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(h(e),h(f),h(i),h(a)),b(n),b(s),b(u,p)}}}function Lu(t){let e,r,n;return r=new re({props:{$$slots:{default:[Cu]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function sn(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Au(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:ot,$$slots:{right:[Lu],default:[ku]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>G(e,"checked",f));let a=t[0]&&sn(t);return s=new Q({props:{layer:ot,tooltip:Ou,show:t[0],clickable:!0}}),s.$on("click",Du),{c(){_(e.$$.fragment),n=C(),a&&a.c(),o=C(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],q(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=sn(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(oe(),g(a,1,1,()=>{a=null}),se());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let ot="vehicle_counts";function Ou(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function Du(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function Eu(t,e,r){let n;X(t,ee,a=>r(4,n=a));let o=V.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];fe(n,ot,`${ie()}/v1/${ot}.pmtiles`),bt(n,{id:ot,source:ot,sourceLayer:ot,color:qe(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let f=!1;function i(a){f=a,r(0,f)}return[f,o,l,i]}class Pu extends R{constructor(e){super(),H(this,e,Eu,Au,W,{})}}function Mu(t){let e,r,n,o,s,l,f,i;return e=new gu({}),n=new su({}),s=new yu({}),f=new $u({}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),_(s.$$.fragment),l=C(),_(f.$$.fragment)},m(a,u){w(e,a,u),m(a,r,u),w(n,a,u),m(a,o,u),w(s,a,u),m(a,l,u),w(f,a,u),i=!0},i(a){i||(d(e.$$.fragment,a),d(n.$$.fragment,a),d(s.$$.fragment,a),d(f.$$.fragment,a),i=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(s.$$.fragment,a),g(f.$$.fragment,a),i=!1},d(a){a&&(h(r),h(o),h(l)),b(e,a),b(n,a),b(s,a),b(f,a)}}}function Nu(t){let e,r;return e=new Et({props:{small:!0,$$slots:{default:[Mu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Iu(t){let e,r,n,o,s,l,f,i,a,u;return e=new Ga({}),n=new ef({}),s=new xa({}),f=new Xf({}),a=new Hf({}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),_(s.$$.fragment),l=C(),_(f.$$.fragment),i=C(),_(a.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(f,c,p),m(c,i,p),w(a,c,p),u=!0},i(c){u||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),d(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(f,c),b(a,c)}}}function Fu(t){let e,r;return e=new Et({props:{small:!0,$$slots:{default:[Iu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Bu(t){let e,r,n,o,s,l,f,i,a,u;return e=new wa({}),n=new Aa({}),s=new Nl({}),f=new Jl({}),a=new ua({}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),_(s.$$.fragment),l=C(),_(f.$$.fragment),i=C(),_(a.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(f,c,p),m(c,i,p),w(a,c,p),u=!0},i(c){u||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),d(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(f,c),b(a,c)}}}function xu(t){let e,r;return e=new Et({props:{small:!0,$$slots:{default:[Bu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function ju(t){let e,r,n,o;return e=new Tl({}),n=new Wl({}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Uu(t){let e,r,n,o;return e=new Cf({}),n=new _f({}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Ru(t){let e,r,n,o,s=fr()=="Private (development)",l,f;e=new Pu({}),n=new ff({});let i=s&&Uu();return{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),i&&i.c(),l=at()},m(a,u){w(e,a,u),m(a,r,u),w(n,a,u),m(a,o,u),i&&i.m(a,u),m(a,l,u),f=!0},p:Y,i(a){f||(d(e.$$.fragment,a),d(n.$$.fragment,a),d(i),f=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(i),f=!1},d(a){a&&(h(r),h(o),h(l)),b(e,a),b(n,a),i&&i.d(a)}}}function Hu(t){let e,r,n,o,s;function l(i){t[5](i)}let f={displayEnableButton:!0};return t[2]!==void 0&&(f.isInactive=t[2]),e=new mo({props:f}),t[4](e),U.push(()=>G(e,"isInactive",l)),o=new el({}),{c(){_(e.$$.fragment),n=C(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,a){const u={};!r&&a&4&&(r=!0,u.isInactive=i[2],q(()=>r=!1)),e.$set(u)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),t[4](null),b(e,i),b(o,i)}}}function Wu(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,k,S,T;return e=new Nf({}),n=new Te({props:{label:"Trip generators",$$slots:{default:[Nu]},$$scope:{ctx:t}}}),s=new Te({props:{label:"Existing infrastructure",$$slots:{default:[Fu]},$$scope:{ctx:t}}}),f=new Te({props:{label:"Boundaries",$$slots:{default:[xu]},$$scope:{ctx:t}}}),a=new Te({props:{label:"Census",$$slots:{default:[ju]},$$scope:{ctx:t}}}),c=new Te({props:{label:"Other",$$slots:{default:[Ru]},$$scope:{ctx:t}}}),$=new Te({props:{label:"Tools",$$slots:{default:[Hu]},$$scope:{ctx:t}}}),S=new bo({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),_(s.$$.fragment),l=C(),_(f.$$.fragment),i=C(),_(a.$$.fragment),u=C(),_(c.$$.fragment),p=C(),_($.$$.fragment),k=C(),_(S.$$.fragment)},m(v,L){w(e,v,L),m(v,r,L),w(n,v,L),m(v,o,L),w(s,v,L),m(v,l,L),w(f,v,L),m(v,i,L),w(a,v,L),m(v,u,L),w(c,v,L),m(v,p,L),w($,v,L),m(v,k,L),w(S,v,L),T=!0},p(v,L){const I={};L&64&&(I.$$scope={dirty:L,ctx:v}),n.$set(I);const E={};L&64&&(E.$$scope={dirty:L,ctx:v}),s.$set(E);const N={};L&64&&(N.$$scope={dirty:L,ctx:v}),f.$set(N);const F={};L&64&&(F.$$scope={dirty:L,ctx:v}),a.$set(F);const O={};L&64&&(O.$$scope={dirty:L,ctx:v}),c.$set(O);const A={};L&70&&(A.$$scope={dirty:L,ctx:v}),$.$set(A);const M={};L&1&&(M.style=v[0]),S.$set(M)},i(v){T||(d(e.$$.fragment,v),d(n.$$.fragment,v),d(s.$$.fragment,v),d(f.$$.fragment,v),d(a.$$.fragment,v),d(c.$$.fragment,v),d($.$$.fragment,v),d(S.$$.fragment,v),T=!0)},o(v){g(e.$$.fragment,v),g(n.$$.fragment,v),g(s.$$.fragment,v),g(f.$$.fragment,v),g(a.$$.fragment,v),g(c.$$.fragment,v),g($.$$.fragment,v),g(S.$$.fragment,v),T=!1},d(v){v&&(h(r),h(o),h(l),h(i),h(u),h(p),h(k)),b(e,v),b(n,v),b(s,v),b(f,v),b(a,v),b(c,v),b($,v),b(S,v)}}}function zu(t){let e,r,n,o;return e=new Te({props:{label:"Layers",open:!0,$$slots:{default:[Wu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,l){w(e,s,l),r=!0,n||(o=wt(window,"keydown",t[3]),n=!0)},p(s,[l]){const f={};l&71&&(f.$$scope={dirty:l,ctx:s}),e.$set(f)},i(s){r||(d(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function Vu(t,e,r){let n;X(t,vr,a=>r(2,n=a));let{style:o}=e,s;function l(a){!n&&a.key=="Escape"&&(s.disableStreetView(),a.preventDefault())}function f(a){U[a?"unshift":"push"](()=>{s=a,r(1,s)})}function i(a){n=a,vr.set(n)}return t.$$set=a=>{"style"in a&&r(0,o=a.style)},[o,s,n,l,f,i]}class Gu extends R{constructor(e){super(),H(this,e,Vu,zu,W,{style:0})}}function qu(t,e,r){let{loadFile:n}=e;return Dt(async()=>{let s=await(await fetch(`${pr()}/v1/random_schemes.geojson`)).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class Ku extends R{constructor(e){super(),H(this,e,qu,null,W,{loadFile:0})}}function Zu(t){let e;return{c(){e=y("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xu(t){let e;return{c(){e=y("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yu(t){let e,r,n=t[0].authority_or_region+"",o,s,l,f,i=t[0].capital_scheme_id+"",a,u,c,p,$=t[0].funding_programme+"",k,S,T,v,L,I,E;return v=new Lt({props:{$$slots:{default:[Zu]},$$scope:{ctx:t}}}),v.$on("click",t[3]),I=new Lt({props:{disabled:t[1],title:t[2],$$slots:{default:[Xu]},$$scope:{ctx:t}}}),I.$on("click",t[4]),{c(){e=P("p"),r=y("Authority or region: "),o=y(n),s=C(),l=P("p"),f=y("Capital scheme ID: "),a=y(i),u=C(),c=P("p"),p=y("Funding programme: "),k=y($),S=C(),T=P("div"),_(v.$$.fragment),L=C(),_(I.$$.fragment),j(T,"class","govuk-button-group")},m(N,F){m(N,e,F),D(e,r),D(e,o),m(N,s,F),m(N,l,F),D(l,f),D(l,a),m(N,u,F),m(N,c,F),D(c,p),D(c,k),m(N,S,F),m(N,T,F),w(v,T,null),D(T,L),w(I,T,null),E=!0},p(N,F){(!E||F&1)&&n!==(n=N[0].authority_or_region+"")&&be(o,n),(!E||F&1)&&i!==(i=N[0].capital_scheme_id+"")&&be(a,i),(!E||F&1)&&$!==($=N[0].funding_programme+"")&&be(k,$);const O={};F&256&&(O.$$scope={dirty:F,ctx:N}),v.$set(O);const A={};F&256&&(A.$$scope={dirty:F,ctx:N}),I.$set(A)},i(N){E||(d(v.$$.fragment,N),d(I.$$.fragment,N),E=!0)},o(N){g(v.$$.fragment,N),g(I.$$.fragment,N),E=!1},d(N){N&&(h(e),h(s),h(l),h(u),h(c),h(S),h(T)),b(v),b(I)}}}function Ju(t){let e,r;return e=new Te({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Yu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Qu(t,e,r){let n,o;X(t,_t,c=>r(6,n=c)),X(t,ee,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,f=!l.has(s.authority_or_region),i=f?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function a(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(ao(c),{padding:20,animate:!1})}function u(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,f,i,a,u,l]}class ec extends R{constructor(e){super(),H(this,e,Qu,Ju,W,{scheme:0,authorityNames:5})}}const tc=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ae=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{f(r.next(i))}catch(a){o(a)}},l=i=>{try{f(r.throw(i))}catch(a){o(a)}},f=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);f((r=r.apply(t,e)).next())}),ge=Uint8Array,dt=Uint16Array,rc=Int32Array,Un=new ge([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Rn=new ge([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nc=new ge([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Hn=function(t,e){for(var r=new dt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new rc(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},Wn=Hn(Un,2),zn=Wn.b,oc=Wn.r;zn[28]=258,oc[258]=28;var sc=Hn(Rn,0),ic=sc.b,lr=new dt(32768);for(K=0;K<32768;++K)xe=(K&43690)>>1|(K&21845)<<1,xe=(xe&52428)>>2|(xe&13107)<<2,xe=(xe&61680)>>4|(xe&3855)<<4,lr[K]=((xe&65280)>>8|(xe&255)<<8)>>1;var xe,K,Ct=function(t,e,r){for(var n=t.length,o=0,s=new dt(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new dt(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new dt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[lr[c]>>i]=a}else for(f=new dt(n),o=0;o<n;++o)t[o]&&(f[o]=lr[l[t[o]-1]++]>>15-t[o]);return f},Nt=new ge(288);for(K=0;K<144;++K)Nt[K]=8;var K;for(K=144;K<256;++K)Nt[K]=9;var K;for(K=256;K<280;++K)Nt[K]=7;var K;for(K=280;K<288;++K)Nt[K]=8;var K,Vn=new ge(32);for(K=0;K<32;++K)Vn[K]=5;var K,lc=Ct(Nt,9,1),ac=Ct(Vn,5,1),Jt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ye=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Qt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},fc=function(t){return(t+7)/8|0},uc=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new ge(r-e);return n.set(t.subarray(e,r)),n},cc=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],me=function(t,e,r){var n=new Error(e||cc[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,me),!r)throw n;return n},hr=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new ge(0);var l=!r||e.i!=2,f=e.i;r||(r=new ge(o*3));var i=function(dr){var gr=r.length;if(dr>gr){var _r=new ge(Math.max(gr*2,dr));_r.set(r),r=_r}},a=e.f||0,u=e.p||0,c=e.b||0,p=e.l,$=e.d,k=e.m,S=e.n,T=o*8;do{if(!p){a=ye(t,u,1);var v=ye(t,u+1,3);if(u+=3,v)if(v==1)p=lc,$=ac,k=9,S=5;else if(v==2){var N=ye(t,u,31)+257,F=ye(t,u+10,15)+4,O=N+ye(t,u+5,31)+1;u+=14;for(var A=new ge(O),M=new ge(19),B=0;B<F;++B)M[nc[B]]=ye(t,u+B*3,7);u+=F*3;for(var Z=Jt(M),ne=(1<<Z)-1,z=Ct(M,Z,1),B=0;B<O;){var Le=z[ye(t,u,ne)];u+=Le&15;var L=Le>>4;if(L<16)A[B++]=L;else{var Fe=0,pe=0;for(L==16?(pe=3+ye(t,u,3),u+=2,Fe=A[B-1]):L==17?(pe=3+ye(t,u,7),u+=3):L==18&&(pe=11+ye(t,u,127),u+=7);pe--;)A[B++]=Fe}}var It=A.subarray(0,N),$e=A.subarray(N);k=Jt(It),S=Jt($e),p=Ct(It,k,1),$=Ct($e,S,1)}else me(1);else{var L=fc(u)+4,I=t[L-4]|t[L-3]<<8,E=L+I;if(E>o){f&&me(0);break}l&&i(c+I),r.set(t.subarray(L,E),c),e.b=c+=I,e.p=u=E*8,e.f=a;continue}if(u>T){f&&me(0);break}}l&&i(c+131072);for(var vt=(1<<k)-1,Re=(1<<S)-1,ft=u;;ft=u){var Fe=p[Qt(t,u)&vt],we=Fe>>4;if(u+=Fe&15,u>T){f&&me(0);break}if(Fe||me(2),we<256)r[c++]=we;else if(we==256){ft=u,p=null;break}else{var ut=we-254;if(we>264){var B=we-257,Be=Un[B];ut=ye(t,u,(1<<Be)-1)+zn[B],u+=Be}var ct=$[Qt(t,u)&Re],pt=ct>>4;ct||me(3),u+=ct&15;var $e=ic[pt];if(pt>3){var Be=Rn[pt];$e+=Qt(t,u)&(1<<Be)-1,u+=Be}if(u>T){f&&me(0);break}l&&i(c+131072);var $t=c+ut;if(c<$e){var yt=s-$e,Qn=Math.min($e,$t);for(yt+c<0&&me(3);c<Qn;++c)r[c]=n[yt+c]}for(;c<$t;c+=4)r[c]=r[c-$e],r[c+1]=r[c+1-$e],r[c+2]=r[c+2-$e],r[c+3]=r[c+3-$e];c=$t}}e.l=p,e.p=ft,e.b=c,e.f=a,p&&(a=1,e.m=k,e.d=$,e.n=S)}while(!a);return c==r.length?r:uc(r,0,c)},pc=new ge(0),$c=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&me(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},mc=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},hc=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&me(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&me(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function dc(t,e){return hr(t,{i:2},e&&e.out,e&&e.dictionary)}function gc(t,e){var r=$c(t);return r+8>t.length&&me(6,"invalid gzip data"),hr(t.subarray(r,-8),{i:2},e&&e.out||new ge(mc(t)),e&&e.dictionary)}function _c(t,e){return hr(t.subarray(hc(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function ar(t,e){return t[0]==31&&t[1]==139&&t[2]==8?gc(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?dc(t,e):_c(t,e)}var wc=typeof TextDecoder<"u"&&new TextDecoder,bc=0;try{wc.decode(pc,{stream:!0}),bc=1}catch{}var Gn=(t,e)=>t*Math.pow(2,e),kt=(t,e)=>Math.floor(t/Math.pow(2,e)),Ht=(t,e)=>Gn(t.getUint16(e+1,!0),8)+t.getUint8(e),qn=(t,e)=>Gn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),vc=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Ht(n,o+1);if(e!=s)return e-s;const l=Ht(n,o+4);return r!=l?r-l:0},yc=(t,e,r,n)=>{const o=Kn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},ln=(t,e,r,n)=>{const o=Kn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},Kn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,f=vc(e,r,n,t,l*17);if(f>0)o=l+1;else if(f<0)s=l-1;else return[qn(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},kc=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,Zn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Ht(t,e*17+1),y:Ht(t,e*17+4),offset:qn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},an=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(Zn(r,n));return Sc(e)},Sc=t=>{t.sort(kc);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=kt(o.offset,8)&255,r[n*17+9]=kt(o.offset,16)&255,r[n*17+10]=kt(o.offset,24)&255,r[n*17+11]=kt(o.offset,32)&255,r[n*17+12]=kt(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},Tc=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=Zn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),f=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:f}}return null};function Cc(t){return ae(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let f=0;l.compression==="gzip"&&(f=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let a=0;"maxzoom"in l&&(a=+l.maxzoom);let u=0,c=0,p=0,$=-180,k=-85,S=180,T=85;if(l.bounds){const L=l.bounds.split(",");$=+L[0],k=+L[1],S=+L[2],T=+L[3]}if(l.center){const L=l.center.split(",");u=+L[0],c=+L[1],p=+L[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:f,tileType:1,minZoom:i,maxZoom:a,minLon:$,minLat:k,maxLon:S,maxLat:T,centerZoom:p,centerLon:u,centerLat:c,etag:e.etag}})}function Lc(t,e,r,n,o,s,l){return ae(this,null,function*(){let f=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(f=an(f));const i=ln(new DataView(f),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=ar(new Uint8Array(c))),{data:c}}const a=Tc(new DataView(f),{z:n,x:o,y:s});if(a){const u=yc(new DataView(f),a.z,a.x,a.y);if(u){let c=yield r.getArrayBuffer(e,u.offset,u.length,t);t.specVersion===1&&(c=an(c));const p=ln(new DataView(c),n,o,s);if(p){let k=(yield e.getBytes(p.offset,p.length,l)).data;const S=new DataView(k);return S.getUint8(0)==31&&S.getUint8(1)==139&&(k=ar(new Uint8Array(k))),{data:k}}}}})}var Xn={getHeader:Cc,getZxy:Lc},Ac=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new fn(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new fn(o),this.tiles.set(o,s));const l=n[2],f=n[3],i=n[4],a=new AbortController,u=a.signal;let c=()=>{a.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+f,+i,u).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function mt(t,e){return(e>>>0)*4294967296+(t>>>0)}function Oc(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return mt(t,n);throw new Error("Expected varint not more than 10 bytes")}function St(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,Oc(r,t))}function Dc(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var Ec=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Pc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=Ec[t],o=Math.pow(2,t);let s=0,l=0,f=0;const i=[e,r];let a=o/2;for(;a>0;)s=(i[0]&a)>0?1:0,l=(i[1]&a)>0?1:0,f+=a*a*(3*s^l),Dc(a,i,s,l),a=a/2;return n+f}function Yn(t,e){return ae(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return ar(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Mc=127;function Nc(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Ic=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ae(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const f=o.headers.get("Content-Range");if(!f||!f.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+f.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ke(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Fc(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ke(r,8),rootDirectoryLength:ke(r,16),jsonMetadataOffset:ke(r,24),jsonMetadataLength:ke(r,32),leafDirectoryOffset:ke(r,40),leafDirectoryLength:ke(r,48),tileDataOffset:ke(r,56),tileDataLength:ke(r,64),numAddressedTiles:ke(r,72),numTileEntries:ke(r,80),numTileContents:ke(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function Jn(t){const e={buf:new Uint8Array(t),pos:0},r=St(e),n=[];let o=0;for(let s=0;s<r;s++){const l=St(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=St(e);for(let s=0;s<r;s++)n[s].length=St(e);for(let s=0;s<r;s++){const l=St(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function Bc(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var gt=class extends Error{};function xc(t,e,r,n){return ae(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Bc(o.data)<3)return[yield Xn.getHeader(t)];const l=o.data.slice(0,Mc);let f=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),f=void 0);const i=Fc(l,f);if(r){const a=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),u=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=Jn(yield e(a,i.internalCompression));return[i,[u,c.length,c]]}return[i,void 0]})}function jc(t,e,r,n,o){return ae(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new gt(s.etag);const l=yield e(s.data,o.internalCompression),f=Jn(l);if(f.length===0)throw new Error("Empty directory is invalid");return f})}var Uc=class{constructor(t=100,e=!0,r=Yn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ae(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{xc(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ae(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{jc(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ae(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new gt(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ae(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},fn=class{constructor(t,e,r){typeof t=="string"?this.source=new Ic(t):this.source=t,r?this.decompress=r:this.decompress=Yn,e?this.cache=e:this.cache=new Uc}getHeader(){return ae(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ae(this,null,function*(){const o=Pc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Xn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,f=s.rootDirectoryLength;for(let i=0;i<=3;i++){const a=yield this.cache.getDirectory(this.source,l,f,s),u=Nc(a,o);if(u)if(u.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+u.offset,u.length,n);if(s.etag&&s.etag!==c.etag)throw new gt(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+u.offset,f=u.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ae(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof gt)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ae(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new gt(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ae(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof gt)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Rc(t){return Dt(()=>{let e=new Ac;yr.addProtocol("pmtiles",e.tile)}),ur(()=>{yr.removeProtocol("pmtiles")}),[]}class Hc extends R{constructor(e){super(),H(this,e,Rc,null,W,{})}}function un(t,e,r){const n=t.slice();return n[13]=e[r],n}function Wc(t){let e,r;return e=new Ku({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Y,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function cn(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let f={schemes:t[1]};return t[2]!==void 0&&(f.schemesToBeShown=t[2]),t[3]!==void 0&&(f.filterText=t[3]),e=new Gi({props:f}),U.push(()=>G(e,"schemesToBeShown",s)),U.push(()=>G(e,"filterText",l)),{c(){_(e.$$.fragment)},m(i,a){w(e,i,a),o=!0},p(i,a){const u={};a&2&&(u.schemes=i[1]),!r&&a&4&&(r=!0,u.schemesToBeShown=i[2],q(()=>r=!1)),!n&&a&8&&(n=!0,u.filterText=i[3],q(()=>n=!1)),e.$set(u)},i(i){o||(d(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function pn(t){let e,r;return e=new ec({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function $n(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&pn(t);return{c(){o&&o.c(),r=at()},m(s,l){o&&o.m(s,l),m(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&d(o,1)):(o=pn(s),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(oe(),g(o,1,1,()=>{o=null}),se())},i(s){n||(d(o),n=!0)},o(s){g(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function zc(t){let e,r,n,o,s,l,f,i,a,u,c=fr()=="Private (development)",p,$,k,S,T,v,L,I;s=new vo({props:{boundaryGeojson:t[4]}}),f=new Mo({}),a=new fo({});let E=c&&Wc(t);$=new So({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),S=new vn({props:{errorMessage:t[0]}});let N=t[1].size>0&&cn(t),F=Ne(t[1].values()),O=[];for(let M=0;M<F.length;M+=1)O[M]=$n(un(t,F,M));const A=M=>g(O[M],1,1,()=>{O[M]=null});return{c(){e=P("div"),r=P("div"),n=P("h1"),n.textContent="Browse schemes",o=C(),_(s.$$.fragment),l=C(),_(f.$$.fragment),i=C(),_(a.$$.fragment),u=C(),E&&E.c(),p=C(),_($.$$.fragment),k=C(),_(S.$$.fragment),T=C(),N&&N.c(),v=C(),L=P("ul");for(let M=0;M<O.length;M+=1)O[M].c();je(r,"display","flex"),je(r,"justify-content","space-between"),j(e,"slot","sidebar"),j(e,"class","govuk-prose")},m(M,B){m(M,e,B),D(e,r),D(r,n),D(r,o),w(s,r,null),D(e,l),w(f,e,null),D(e,i),w(a,e,null),D(e,u),E&&E.m(e,null),D(e,p),w($,e,null),D(e,k),w(S,e,null),D(e,T),N&&N.m(e,null),D(e,v),D(e,L);for(let Z=0;Z<O.length;Z+=1)O[Z]&&O[Z].m(L,null);I=!0},p(M,B){const Z={};B&16&&(Z.boundaryGeojson=M[4]),s.$set(Z),c&&E.p(M,B);const ne={};if(B&1&&(ne.errorMessage=M[0]),S.$set(ne),M[1].size>0?N?(N.p(M,B),B&2&&d(N,1)):(N=cn(M),N.c(),d(N,1),N.m(e,v)):N&&(oe(),g(N,1,1,()=>{N=null}),se()),B&38){F=Ne(M[1].values());let z;for(z=0;z<F.length;z+=1){const Le=un(M,F,z);O[z]?(O[z].p(Le,B),d(O[z],1)):(O[z]=$n(Le),O[z].c(),d(O[z],1),O[z].m(L,null))}for(oe(),z=F.length;z<O.length;z+=1)A(z);se()}},i(M){if(!I){d(s.$$.fragment,M),d(f.$$.fragment,M),d(a.$$.fragment,M),d(E),d($.$$.fragment,M),d(S.$$.fragment,M),d(N);for(let B=0;B<F.length;B+=1)d(O[B]);I=!0}},o(M){g(s.$$.fragment,M),g(f.$$.fragment,M),g(a.$$.fragment,M),g(E),g($.$$.fragment,M),g(S.$$.fragment,M),g(N),O=O.filter(Boolean);for(let B=0;B<O.length;B+=1)g(O[B]);I=!1},d(M){M&&h(e),b(s),b(f),b(a),E&&E.d(),b($),b(S),N&&N.d(),jt(O,M)}}}function Vc(t){let e,r,n,o,s,l,f,i,a,u,c;return e=new yo({props:{colorInterventions:yn("v1")}}),n=new Q({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new Q({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),f=new Q({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),u=new Gu({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=C(),_(n.$$.fragment),o=C(),_(s.$$.fragment),l=C(),_(f.$$.fragment),i=C(),a=P("div"),_(u.$$.fragment),j(a,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(f,p,$),m(p,i,$),m(p,a,$),w(u,a,null),c=!0},p:Y,i(p){c||(d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(f.$$.fragment,p),d(u.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(f.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(l),h(i),h(a)),b(e,p),b(n,p),b(s,p),b(f,p),b(u)}}}function Gc(t){let e,r,n,o,s;return r=new Hc({}),o=new go({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Vc]},$$scope:{ctx:t}}}),{c(){e=P("div"),_(r.$$.fragment),n=C(),_(o.$$.fragment),j(e,"slot","main")},m(l,f){m(l,e,f),w(r,e,null),D(e,n),w(o,e,null),s=!0},p(l,f){const i={};f&65536&&(i.$$scope={dirty:f,ctx:l}),o.$set(i)},i(l){s||(d(r.$$.fragment,l),d(o.$$.fragment,l),s=!0)},o(l){g(r.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&h(e),b(r),b(o)}}}function qc(t){let e,r;return e=new ho({props:{$$slots:{main:[Gc],sidebar:[zc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Kc(t,e,r){let n;X(t,_t,T=>r(4,n=T));let o=new Set(tc);Dt(()=>{uo()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",f="",i=new Map,a=new Set,u="";ur(()=>{_t.set(cr())});function c(T){try{let v=JSON.parse(T);r(1,i=Ni(v)),_t.set(v),r(0,f="")}catch(v){r(0,f=`The file you loaded is broken: ${v}`)}}function p(T){let v=T.properties;var L='<div style="max-width: 30vw;">';return L+=`<h2>${$(v.name)} (${v.intervention_type})</h2>`,L+=`<p>Scheme reference: ${v.scheme_reference}</p>`,v.length_meters&&(L+=`<p>Length: ${co(v.length_meters)}</p>`),v.description&&(L+=`<p>${$(v.description)}</p>`),L+="</div>",L}function $(T){return u?T.replace(new RegExp(u,"gi"),v=>`<mark>${v}</mark>`):T}function k(T){a=T,r(2,a)}function S(T){u=T,r(3,u)}return[f,i,a,u,n,o,l,c,p,k,S]}class Zc extends R{constructor(e){super(),H(this,e,Kc,qc,W,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Zc({target:document.getElementById("app")});
