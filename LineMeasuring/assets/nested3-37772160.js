import{S as J,i as U,s as Q,aW as ge,b as A,c as L,g as k,m as D,l as P,t as $,n as _,q as y,N as $e,C as _e,aZ as be,F as ie,d as C,j as b,p as w,E as le,e as R,h as M,v as q,w as W,aA as we,u as Y,M as he,a as ve,k as T,am as ke,r as De,f as me,L as ye,y as Ce,o as Se,z as Ie,x as re}from"./index-8ed7da87.js";import{e as ae,b as Ee,d as Me,L as Re,M as Te,S as Be}from"./StreetViewController-d9ea354e.js";import{D as Ae}from"./DefaultButton-65043d9a.js";import{T as de,W as Le}from"./WarningButton-66cec84e.js";import{P as Pe}from"./Pin-ea7bdf64.js";function je(s){let e,t,n;function a(r){s[3](r)}let o={label:"Basemap",id:"basemap",choices:ge(),disabled:s[1]};return s[0]!==void 0&&(o.value=s[0]),e=new ae({props:o}),A.push(()=>L(e,"value",a)),e.$on("change",s[2]),{c(){k(e.$$.fragment)},m(r,i){D(e,r,i),n=!0},p(r,[i]){const l={};i&2&&(l.disabled=r[1]),!t&&i&1&&(t=!0,l.value=r[0],P(()=>t=!1)),e.$set(l)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){y(e,r)}}}function Fe(s,e,t){let n;$e(s,_e,l=>t(4,n=l));let{style:a}=e,{disabled:o}=e;async function r(){n.setStyle(await be(a))}function i(l){a=l,t(0,a)}return s.$$set=l=>{"style"in l&&t(0,a=l.style),"disabled"in l&&t(1,o=l.disabled)},[a,o,r,i]}class qe extends J{constructor(e){super(),U(this,e,Fe,je,Q,{style:0,disabled:1})}}function Ve(s){let e,t,n,a,o,r;return e=new le({props:{errorMessage:s[1]}}),{c(){k(e.$$.fragment),t=C(),n=R("input"),M(n,"type","text"),M(n,"class","govuk-input"),M(n,"id","locationDescription")},m(i,l){D(e,i,l),b(i,t,l),b(i,n,l),q(n,s[0]),a=!0,o||(r=[W(n,"input",s[5]),W(n,"change",s[3])],o=!0)},p(i,l){const f={};l&2&&(f.errorMessage=i[1]),e.$set(f),l&1&&n.value!==i[0]&&q(n,i[0])},i(i){a||($(e.$$.fragment,i),a=!0)},o(i){_(e.$$.fragment,i),a=!1},d(i){i&&(w(t),w(n)),y(e,i),o=!1,we(r)}}}function We(s){let e;return{c(){e=Y("Lookup location description automatically")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function Oe(s){let e,t,n;function a(r){s[6](r)}let o={id:"lookupLocation",$$slots:{default:[We]},$$scope:{ctx:s}};return s[2]!==void 0&&(o.checked=s[2]),e=new Me({props:o}),A.push(()=>L(e,"checked",a)),{c(){k(e.$$.fragment)},m(r,i){D(e,r,i),n=!0},p(r,i){const l={};i&256&&(l.$$scope={dirty:i,ctx:r}),!t&&i&4&&(t=!0,l.checked=r[2],P(()=>t=!1)),e.$set(l)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){y(e,r)}}}function He(s){let e,t,n,a;return e=new ie({props:{label:"Describe this location",id:"locationDescription",$$slots:{default:[Ve]},$$scope:{ctx:s}}}),n=new Ee({props:{small:!0,$$slots:{default:[Oe]},$$scope:{ctx:s}}}),{c(){k(e.$$.fragment),t=C(),k(n.$$.fragment)},m(o,r){D(e,o,r),b(o,t,r),D(n,o,r),a=!0},p(o,[r]){const i={};r&259&&(i.$$scope={dirty:r,ctx:o}),e.$set(i);const l={};r&260&&(l.$$scope={dirty:r,ctx:o}),n.$set(l)},i(o){a||($(e.$$.fragment,o),$(n.$$.fragment,o),a=!0)},o(o){_(e.$$.fragment,o),_(n.$$.fragment,o),a=!1},d(o){o&&w(t),y(e,o),y(n,o)}}}function Ne(s,e,t){let{locationDescription:n}=e,{locationDescriptionError:a}=e,{pt:o}=e,r=!0;async function i(p){if(!r)return;let h=`https://nominatim.openstreetmap.org/reverse?lat=${p.lat}&lon=${p.lng}&format=json`;try{t(0,n="Loading...");let c=await(await fetch(h)).json();t(0,n=c.address.road??c.display_name)}catch(d){console.log(`Location lookup failed: ${d}`)}}function l(){t(2,r=!1)}function f(){n=this.value,t(0,n)}function g(p){r=p,t(2,r)}return s.$$set=p=>{"locationDescription"in p&&t(0,n=p.locationDescription),"locationDescriptionError"in p&&t(1,a=p.locationDescriptionError),"pt"in p&&t(4,o=p.pt)},s.$$.update=()=>{s.$$.dirty&16&&i(o)},[n,a,r,l,o,f,g]}class ze extends J{constructor(e){super(),U(this,e,Ne,He,Q,{locationDescription:0,locationDescriptionError:1,pt:4})}}function Ke(s){let e,t,n,a,o,r;return e=new le({props:{errorMessage:s[7]}}),{c(){k(e.$$.fragment),t=C(),n=R("input"),M(n,"type","text"),M(n,"class","govuk-input"),M(n,"id","inspector")},m(i,l){D(e,i,l),b(i,t,l),b(i,n,l),q(n,s[1]),a=!0,o||(r=W(n,"input",s[18]),o=!0)},p(i,l){const f={};l&128&&(f.errorMessage=i[7]),e.$set(f),l&2&&n.value!==i[1]&&q(n,i[1])},i(i){a||($(e.$$.fragment,i),a=!0)},o(i){_(e.$$.fragment,i),a=!1},d(i){i&&(w(t),w(n)),y(e,i),o=!1,r()}}}function Ge(s){let e,t,n,a,o,r,i,l;return n=new le({props:{errorMessage:s[8]}}),{c(){e=R("div"),e.textContent="Example: ATF2_WLT_01",t=C(),k(n.$$.fragment),a=C(),o=R("input"),M(e,"class","govuk-hint"),M(o,"type","text"),M(o,"class","govuk-input"),M(o,"id","schemeReference")},m(f,g){b(f,e,g),b(f,t,g),D(n,f,g),b(f,a,g),b(f,o,g),q(o,s[2]),r=!0,i||(l=W(o,"input",s[19]),i=!0)},p(f,g){const p={};g&256&&(p.errorMessage=f[8]),n.$set(p),g&4&&o.value!==f[2]&&q(o,f[2])},i(f){r||($(n.$$.fragment,f),r=!0)},o(f){_(n.$$.fragment,f),r=!1},d(f){f&&(w(e),w(t),w(a),w(o)),y(n,f),i=!1,l()}}}function Je(s){let e;return{c(){e=Y("Export")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function Ue(s){let e;return{c(){e=Y("Keep editing this issue")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function Qe(s){let e;return{c(){e=Y("Done! Enter a new critical")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function Ye(s){let e,t,n,a,o,r,i,l,f,g,p,h;return r=new de({props:{label:"The new row has already been copied to your clipboard. If it didn't work, copy from below",value:s[14]}}),f=new ve({props:{$$slots:{default:[Ue]},$$scope:{ctx:s}}}),f.$on("click",s[24]),p=new Le({props:{$$slots:{default:[Qe]},$$scope:{ctx:s}}}),p.$on("click",xe),{c(){e=R("div"),t=R("p"),t.innerHTML=`Edit <i>Inspectors Log.xlsx</i>
      , add a new row at the bottom of
      <i>Form Input</i>
      , and press
      <i>Control+V</i>
      to paste.`,n=C(),a=R("p"),a.innerHTML="<b>You have to manually fill out the first ID column!</b>",o=C(),k(r.$$.fragment),i=C(),l=R("div"),k(f.$$.fragment),g=C(),k(p.$$.fragment),M(l,"class","govuk-button-group"),M(e,"class","govuk-prose")},m(d,c){b(d,e,c),T(e,t),T(e,n),T(e,a),T(e,o),D(r,e,null),T(e,i),T(e,l),D(f,l,null),T(l,g),D(p,l,null),h=!0},p(d,c){const v={};c&16384&&(v.value=d[14]),r.$set(v);const S={};c&134217728&&(S.$$scope={dirty:c,ctx:d}),f.$set(S);const I={};c&134217728&&(I.$$scope={dirty:c,ctx:d}),p.$set(I)},i(d){h||($(r.$$.fragment,d),$(f.$$.fragment,d),$(p.$$.fragment,d),h=!0)},o(d){_(r.$$.fragment,d),_(f.$$.fragment,d),_(p.$$.fragment,d),h=!1},d(d){d&&w(e),y(r),y(f),y(p)}}}function Ze(s){let e,t,n,a,o,r,i,l,f,g,p,h,d,c,v,S,I,j,B,V,F;e=new ie({props:{label:"Inspector name",id:"inspector",$$slots:{default:[Ke]},$$scope:{ctx:s}}}),n=new ie({props:{label:"Scheme reference",id:"schemeReference",$$slots:{default:[Ge]},$$scope:{ctx:s}}});function Z(u){s[20](u)}let O={label:"Current design stage",id:"currentDesignStage",choices:s[15],emptyOption:!0,errorMessage:s[9]};s[3]!==void 0&&(O.value=s[3]),o=new ae({props:O}),A.push(()=>L(o,"value",Z));function X(u){s[21](u)}let H={pt:s[0],locationDescriptionError:s[11]};s[5]!==void 0&&(H.locationDescription=s[5]),l=new ze({props:H}),A.push(()=>L(l,"locationDescription",X));function x(u){s[22](u)}let N={label:"Critical issue type",id:"criticalIssueType",choices:s[16],emptyOption:!0,errorMessage:s[10]};s[4]!==void 0&&(N.value=s[4]),p=new ae({props:N}),A.push(()=>L(p,"value",x));function ee(u){s[23](u)}let z={label:"Comments or notes",errorMessage:s[12]};s[6]!==void 0&&(z.value=s[6]),c=new de({props:z}),A.push(()=>L(c,"value",ee)),I=new Ae({props:{$$slots:{default:[Je]},$$scope:{ctx:s}}}),I.$on("click",s[17]);function E(u){s[25](u)}let K={title:"Almost done!",displayEscapeButton:!1,canCloseByClickingBackground:!1,$$slots:{default:[Ye]},$$scope:{ctx:s}};return s[13]!==void 0&&(K.open=s[13]),B=new he({props:K}),A.push(()=>L(B,"open",E)),{c(){k(e.$$.fragment),t=C(),k(n.$$.fragment),a=C(),k(o.$$.fragment),i=C(),k(l.$$.fragment),g=C(),k(p.$$.fragment),d=C(),k(c.$$.fragment),S=C(),k(I.$$.fragment),j=C(),k(B.$$.fragment)},m(u,m){D(e,u,m),b(u,t,m),D(n,u,m),b(u,a,m),D(o,u,m),b(u,i,m),D(l,u,m),b(u,g,m),D(p,u,m),b(u,d,m),D(c,u,m),b(u,S,m),D(I,u,m),b(u,j,m),D(B,u,m),F=!0},p(u,[m]){const ue={};m&134217858&&(ue.$$scope={dirty:m,ctx:u}),e.$set(ue);const fe={};m&134217988&&(fe.$$scope={dirty:m,ctx:u}),n.$set(fe);const te={};m&512&&(te.errorMessage=u[9]),!r&&m&8&&(r=!0,te.value=u[3],P(()=>r=!1)),o.$set(te);const G={};m&1&&(G.pt=u[0]),m&2048&&(G.locationDescriptionError=u[11]),!f&&m&32&&(f=!0,G.locationDescription=u[5],P(()=>f=!1)),l.$set(G);const ne={};m&1024&&(ne.errorMessage=u[10]),!h&&m&16&&(h=!0,ne.value=u[4],P(()=>h=!1)),p.$set(ne);const se={};m&4096&&(se.errorMessage=u[12]),!v&&m&64&&(v=!0,se.value=u[6],P(()=>v=!1)),c.$set(se);const ce={};m&134217728&&(ce.$$scope={dirty:m,ctx:u}),I.$set(ce);const oe={};m&134242304&&(oe.$$scope={dirty:m,ctx:u}),!V&&m&8192&&(V=!0,oe.open=u[13],P(()=>V=!1)),B.$set(oe)},i(u){F||($(e.$$.fragment,u),$(n.$$.fragment,u),$(o.$$.fragment,u),$(l.$$.fragment,u),$(p.$$.fragment,u),$(c.$$.fragment,u),$(I.$$.fragment,u),$(B.$$.fragment,u),F=!0)},o(u){_(e.$$.fragment,u),_(n.$$.fragment,u),_(o.$$.fragment,u),_(l.$$.fragment,u),_(p.$$.fragment,u),_(c.$$.fragment,u),_(I.$$.fragment,u),_(B.$$.fragment,u),F=!1},d(u){u&&(w(t),w(a),w(i),w(g),w(d),w(S),w(j)),y(e,u),y(n,u),y(o,u),y(l,u),y(p,u),y(c,u),y(I,u),y(B,u)}}}function pe(s){return s.map(e=>[e,e])}function Xe(s){let e=25569,n=24*(60*60*1e3);return s.getTime()/n+e}function xe(){location.reload()}function et(s,e,t){let{pt:n}=e,a=window.localStorage.getItem("inspector")??"",o=window.localStorage.getItem("schemeReference")??"",r=window.localStorage.getItem("currentDesignStage")??"",i="",l="",f="",g="",p="",h="",d="",c="",v="",S=!1,I="",j=pe(["Baseline","Feasibility Design","Preliminary Design","Outline Design","Detailed Design","Inspection"]),B=pe(["1 - Conflict at Side Roads","2 - Conflict at Major Junctions / Roundabouts","3 - Collision Alongside or from Behind","4 - Trip Hazard","5 - Kerbside Activity","6A - Risk of Crossing Conflict (Busy Roads)","6B - Risk of Crossing Conflict (Quieter Roads)","7A - Standard of Crossing Facility (Busy Roads)","7B - Standard of Crossing Facility (Junction)","8 - Traffic Speed (>37mph)","9A - Traffic Volume (>10,000vpd)","9B - Traffic Volume (>5% HGVs)","10 - Crossing Speed","11A - Footway Width (Absolute Minimum <1m)","11B - Footway Width (at Pinchpoints)","11C - Footway Width - Poor Pedestrian Comfort","12 - Tram - Insufficient width next to Tram Track","13 - Tram/Rail - Poor Crossing Angle","14 - Major Cycle Surface Defect","15 - Major Pedestrian Surface Defect","16 - Inappropriate Shared Use","17 - Barriers, Steps and/or Dismount signs","18 - Route isn't direct, logical or intuitive to all users","19 - Inappropriate Surface Materials","20 - Inappropriate Lighting","21 - Routes must join other facilities as a network"]);function V(){let E=0,K=Xe(new Date);return[E,a,K,o,r,i,ke(n.toArray().reverse()).join(", "),l,f].join("	")}function F(){t(7,g=a?"":"Required"),t(8,p=o?"":"Required"),t(9,h=r?"":"Required"),t(10,d=i?"":"Required"),t(11,c=l?"":"Required"),t(12,v=f?"":"Required"),!(g||p||h||d||c||v)&&(t(14,I=V()),navigator.clipboard.writeText(I),t(13,S=!0))}function Z(){a=this.value,t(1,a)}function O(){o=this.value,t(2,o)}function X(E){r=E,t(3,r)}function H(E){l=E,t(5,l)}function x(E){i=E,t(4,i)}function N(E){f=E,t(6,f)}const ee=()=>t(13,S=!1);function z(E){S=E,t(13,S)}return s.$$set=E=>{"pt"in E&&t(0,n=E.pt)},s.$$.update=()=>{s.$$.dirty&2&&window.localStorage.setItem("inspector",a),s.$$.dirty&4&&window.localStorage.setItem("schemeReference",o),s.$$.dirty&8&&window.localStorage.setItem("currentDesignStage",r)},[n,a,o,r,i,l,f,g,p,h,d,c,v,S,I,j,B,F,Z,O,X,H,x,N,ee,z]}class tt extends J{constructor(e){super(),U(this,e,et,Ze,Q,{pt:0})}}function nt(s){let e;return{c(){e=R("p"),e.textContent="Click the map to add a critical"},m(t,n){b(t,e,n)},p:re,i:re,o:re,d(t){t&&w(e)}}}function st(s){let e,t;return e=new tt({props:{pt:s[0]}}),{c(){k(e.$$.fragment)},m(n,a){D(e,n,a),t=!0},p(n,a){const o={};a&1&&(o.pt=n[0]),e.$set(o)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function ot(s){let e,t,n,a,o,r,i,l,f,g;r=new ye({});const p=[st,nt],h=[];function d(c,v){return c[0]?0:1}return l=d(s),f=h[l]=p[l](s),{c(){e=R("div"),t=R("h1"),t.textContent="Critical issue entry",n=C(),a=R("p"),a.textContent=`App version: ${me()}`,o=C(),k(r.$$.fragment),i=C(),f.c(),M(e,"slot","sidebar"),M(e,"class","govuk-prose")},m(c,v){b(c,e,v),T(e,t),T(e,n),T(e,a),T(e,o),D(r,e,null),T(e,i),h[l].m(e,null),g=!0},p(c,v){let S=l;l=d(c),l===S?h[l].p(c,v):(Ce(),_(h[S],1,1,()=>{h[S]=null}),Se(),f=h[l],f?f.p(c,v):(f=h[l]=p[l](c),f.c()),$(f,1),f.m(e,null))},i(c){g||($(r.$$.fragment,c),$(f),g=!0)},o(c){_(r.$$.fragment,c),_(f),g=!1},d(c){c&&w(e),y(r),h[l].d()}}}function rt(s){let e,t,n,a,o,r,i,l,f;function g(c){s[5](c)}let p={enableAdding:s[1]};s[0]!==void 0&&(p.markerPosition=s[0]),e=new Pe({props:p}),A.push(()=>L(e,"markerPosition",g)),o=new qe({props:{style:s[3],disabled:!s[1]}});function h(c){s[7](c)}let d={displayEnableButton:!0};return s[1]!==void 0&&(d.isInactive=s[1]),i=new Be({props:d}),s[6](i),A.push(()=>L(i,"isInactive",h)),{c(){k(e.$$.fragment),n=C(),a=R("div"),k(o.$$.fragment),r=C(),k(i.$$.fragment),M(a,"class","top-right svelte-nlvvhu")},m(c,v){D(e,c,v),b(c,n,v),b(c,a,v),D(o,a,null),T(a,r),D(i,a,null),f=!0},p(c,v){const S={};v&2&&(S.enableAdding=c[1]),!t&&v&1&&(t=!0,S.markerPosition=c[0],P(()=>t=!1)),e.$set(S);const I={};v&2&&(I.disabled=!c[1]),o.$set(I);const j={};!l&&v&2&&(l=!0,j.isInactive=c[1],P(()=>l=!1)),i.$set(j)},i(c){f||($(e.$$.fragment,c),$(o.$$.fragment,c),$(i.$$.fragment,c),f=!0)},o(c){_(e.$$.fragment,c),_(o.$$.fragment,c),_(i.$$.fragment,c),f=!1},d(c){c&&(w(n),w(a)),y(e,c),y(o),s[6](null),y(i)}}}function it(s){let e,t,n;return t=new Te({props:{style:s[3],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[rt]},$$scope:{ctx:s}}}),{c(){e=R("div"),k(t.$$.fragment),M(e,"slot","main")},m(a,o){b(a,e,o),D(t,e,null),n=!0},p(a,o){const r={};o&263&&(r.$$scope={dirty:o,ctx:a}),t.$set(r)},i(a){n||($(t.$$.fragment,a),n=!0)},o(a){_(t.$$.fragment,a),n=!1},d(a){a&&w(e),y(t)}}}function at(s){let e,t,n,a;return e=new Re({props:{sidebarWidth:"35rem",$$slots:{main:[it],sidebar:[ot]},$$scope:{ctx:s}}}),{c(){k(e.$$.fragment)},m(o,r){D(e,o,r),t=!0,n||(a=W(window,"keydown",s[4]),n=!0)},p(o,[r]){const i={};r&263&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){t||($(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){y(e,o),n=!1,a()}}}function lt(s,e,t){De(()=>{Ie()});let n=me()=="Private (development)"?"Road":"dataviz",a=null,o=!0,r;function i(p){!o&&p.key=="Escape"&&(r.disableStreetView(),p.preventDefault())}function l(p){a=p,t(0,a)}function f(p){A[p?"unshift":"push"](()=>{r=p,t(2,r)})}function g(p){o=p,t(1,o)}return[a,o,r,n,i,l,f,g]}class ut extends J{constructor(e){super(),U(this,e,lt,at,Q,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new ut({target:document.getElementById("app")});
