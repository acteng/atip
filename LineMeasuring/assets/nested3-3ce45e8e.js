import{S as N,i as O,s as H,aW as ke,b as B,c as P,g as k,m as v,l as A,t as $,n as b,q as y,N as le,C as ue,aZ as ve,F as ie,d as D,j as w,p as h,E as ce,e as L,h as E,v as F,w as W,aA as ye,u as Y,M as De,a as Ce,k as R,am as Se,r as _e,a5 as Ie,B as Ee,f as $e,L as Me,y as be,o as we,z as Le,x as oe}from"./index-a52a4cd6.js";import{e as ae,b as Re,d as Te,L as Be,M as Pe,S as Ae}from"./StreetViewController-f139370a.js";import{D as je}from"./DefaultButton-2ce4b728.js";import{T as he,W as Fe}from"./WarningButton-ac0fc211.js";function qe(r){let e,n,t;function l(o){r[3](o)}let s={label:"Basemap",id:"basemap",choices:ke(),disabled:r[1]};return r[0]!==void 0&&(s.value=r[0]),e=new ae({props:s}),B.push(()=>P(e,"value",l)),e.$on("change",r[2]),{c(){k(e.$$.fragment)},m(o,a){v(e,o,a),t=!0},p(o,[a]){const i={};a&2&&(i.disabled=o[1]),!n&&a&1&&(n=!0,i.value=o[0],A(()=>n=!1)),e.$set(i)},i(o){t||($(e.$$.fragment,o),t=!0)},o(o){b(e.$$.fragment,o),t=!1},d(o){y(e,o)}}}function Ve(r,e,n){let t;le(r,ue,i=>n(4,t=i));let{style:l}=e,{disabled:s}=e;async function o(){t.setStyle(await ve(l))}function a(i){l=i,n(0,l)}return r.$$set=i=>{"style"in i&&n(0,l=i.style),"disabled"in i&&n(1,s=i.disabled)},[l,s,o,a]}class We extends N{constructor(e){super(),O(this,e,Ve,qe,H,{style:0,disabled:1})}}function Ne(r){let e,n,t,l,s,o;return e=new ce({props:{errorMessage:r[1]}}),{c(){k(e.$$.fragment),n=D(),t=L("input"),E(t,"type","text"),E(t,"class","govuk-input"),E(t,"id","locationDescription")},m(a,i){v(e,a,i),w(a,n,i),w(a,t,i),F(t,r[0]),l=!0,s||(o=[W(t,"input",r[5]),W(t,"change",r[3])],s=!0)},p(a,i){const f={};i&2&&(f.errorMessage=a[1]),e.$set(f),i&1&&t.value!==a[0]&&F(t,a[0])},i(a){l||($(e.$$.fragment,a),l=!0)},o(a){b(e.$$.fragment,a),l=!1},d(a){a&&(h(n),h(t)),y(e,a),s=!1,ye(o)}}}function Oe(r){let e;return{c(){e=Y("Lookup location description automatically")},m(n,t){w(n,e,t)},d(n){n&&h(e)}}}function He(r){let e,n,t;function l(o){r[6](o)}let s={id:"lookupLocation",$$slots:{default:[Oe]},$$scope:{ctx:r}};return r[2]!==void 0&&(s.checked=r[2]),e=new Te({props:s}),B.push(()=>P(e,"checked",l)),{c(){k(e.$$.fragment)},m(o,a){v(e,o,a),t=!0},p(o,a){const i={};a&256&&(i.$$scope={dirty:a,ctx:o}),!n&&a&4&&(n=!0,i.checked=o[2],A(()=>n=!1)),e.$set(i)},i(o){t||($(e.$$.fragment,o),t=!0)},o(o){b(e.$$.fragment,o),t=!1},d(o){y(e,o)}}}function ze(r){let e,n,t,l;return e=new ie({props:{label:"Describe this location",id:"locationDescription",$$slots:{default:[Ne]},$$scope:{ctx:r}}}),t=new Re({props:{small:!0,$$slots:{default:[He]},$$scope:{ctx:r}}}),{c(){k(e.$$.fragment),n=D(),k(t.$$.fragment)},m(s,o){v(e,s,o),w(s,n,o),v(t,s,o),l=!0},p(s,[o]){const a={};o&259&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const i={};o&260&&(i.$$scope={dirty:o,ctx:s}),t.$set(i)},i(s){l||($(e.$$.fragment,s),$(t.$$.fragment,s),l=!0)},o(s){b(e.$$.fragment,s),b(t.$$.fragment,s),l=!1},d(s){s&&h(n),y(e,s),y(t,s)}}}function Ge(r,e,n){let{locationDescription:t}=e,{locationDescriptionError:l}=e,{pt:s}=e,o=!0;async function a(c){if(!o)return;let p=`https://nominatim.openstreetmap.org/reverse?lat=${c.lat}&lon=${c.lng}&format=json`;try{n(0,t="Loading...");let m=await(await fetch(p)).json();n(0,t=m.address.road??m.display_name)}catch(d){console.log(`Location lookup failed: ${d}`)}}function i(){n(2,o=!1)}function f(){t=this.value,n(0,t)}function _(c){o=c,n(2,o)}return r.$$set=c=>{"locationDescription"in c&&n(0,t=c.locationDescription),"locationDescriptionError"in c&&n(1,l=c.locationDescriptionError),"pt"in c&&n(4,s=c.pt)},r.$$.update=()=>{r.$$.dirty&16&&a(s)},[t,l,o,i,s,f,_]}class Ke extends N{constructor(e){super(),O(this,e,Ge,ze,H,{locationDescription:0,locationDescriptionError:1,pt:4})}}function Ue(r){let e,n,t,l,s,o;return e=new ce({props:{errorMessage:r[7]}}),{c(){k(e.$$.fragment),n=D(),t=L("input"),E(t,"type","text"),E(t,"class","govuk-input"),E(t,"id","inspector")},m(a,i){v(e,a,i),w(a,n,i),w(a,t,i),F(t,r[1]),l=!0,s||(o=W(t,"input",r[18]),s=!0)},p(a,i){const f={};i&128&&(f.errorMessage=a[7]),e.$set(f),i&2&&t.value!==a[1]&&F(t,a[1])},i(a){l||($(e.$$.fragment,a),l=!0)},o(a){b(e.$$.fragment,a),l=!1},d(a){a&&(h(n),h(t)),y(e,a),s=!1,o()}}}function Je(r){let e,n,t,l,s,o,a,i;return t=new ce({props:{errorMessage:r[8]}}),{c(){e=L("div"),e.textContent="Example: ATF2_WLT_01",n=D(),k(t.$$.fragment),l=D(),s=L("input"),E(e,"class","govuk-hint"),E(s,"type","text"),E(s,"class","govuk-input"),E(s,"id","schemeReference")},m(f,_){w(f,e,_),w(f,n,_),v(t,f,_),w(f,l,_),w(f,s,_),F(s,r[2]),o=!0,a||(i=W(s,"input",r[19]),a=!0)},p(f,_){const c={};_&256&&(c.errorMessage=f[8]),t.$set(c),_&4&&s.value!==f[2]&&F(s,f[2])},i(f){o||($(t.$$.fragment,f),o=!0)},o(f){b(t.$$.fragment,f),o=!1},d(f){f&&(h(e),h(n),h(l),h(s)),y(t,f),a=!1,i()}}}function Qe(r){let e;return{c(){e=Y("Export")},m(n,t){w(n,e,t)},d(n){n&&h(e)}}}function Ye(r){let e;return{c(){e=Y("Keep editing this issue")},m(n,t){w(n,e,t)},d(n){n&&h(e)}}}function Ze(r){let e;return{c(){e=Y("Done! Enter a new critical")},m(n,t){w(n,e,t)},d(n){n&&h(e)}}}function Xe(r){let e,n,t,l,s,o,a,i,f,_,c,p;return o=new he({props:{label:"The new row has already been copied to your clipboard. If it didn't work, copy from below",value:r[14]}}),f=new Ce({props:{$$slots:{default:[Ye]},$$scope:{ctx:r}}}),f.$on("click",r[24]),c=new Fe({props:{$$slots:{default:[Ze]},$$scope:{ctx:r}}}),c.$on("click",tt),{c(){e=L("div"),n=L("p"),n.innerHTML=`Edit <i>Inspectors Log.xlsx</i>
      , add a new row at the bottom of
      <i>Form Input</i>
      , and press
      <i>Control+V</i>
      to paste.`,t=D(),l=L("p"),l.innerHTML="<b>You have to manually fill out the first ID column!</b>",s=D(),k(o.$$.fragment),a=D(),i=L("div"),k(f.$$.fragment),_=D(),k(c.$$.fragment),E(i,"class","govuk-button-group"),E(e,"class","govuk-prose")},m(d,m){w(d,e,m),R(e,n),R(e,t),R(e,l),R(e,s),v(o,e,null),R(e,a),R(e,i),v(f,i,null),R(i,_),v(c,i,null),p=!0},p(d,m){const C={};m&16384&&(C.value=d[14]),o.$set(C);const S={};m&134217728&&(S.$$scope={dirty:m,ctx:d}),f.$set(S);const M={};m&134217728&&(M.$$scope={dirty:m,ctx:d}),c.$set(M)},i(d){p||($(o.$$.fragment,d),$(f.$$.fragment,d),$(c.$$.fragment,d),p=!0)},o(d){b(o.$$.fragment,d),b(f.$$.fragment,d),b(c.$$.fragment,d),p=!1},d(d){d&&h(e),y(o),y(f),y(c)}}}function xe(r){let e,n,t,l,s,o,a,i,f,_,c,p,d,m,C,S,M,q,T,V,j;e=new ie({props:{label:"Inspector name",id:"inspector",$$slots:{default:[Ue]},$$scope:{ctx:r}}}),t=new ie({props:{label:"Scheme reference",id:"schemeReference",$$slots:{default:[Je]},$$scope:{ctx:r}}});function Z(u){r[20](u)}let z={label:"Current design stage",id:"currentDesignStage",choices:r[15],emptyOption:!0,errorMessage:r[9]};r[3]!==void 0&&(z.value=r[3]),s=new ae({props:z}),B.push(()=>P(s,"value",Z));function X(u){r[21](u)}let G={pt:r[0],locationDescriptionError:r[11]};r[5]!==void 0&&(G.locationDescription=r[5]),i=new Ke({props:G}),B.push(()=>P(i,"locationDescription",X));function x(u){r[22](u)}let K={label:"Critical issue type",id:"criticalIssueType",choices:r[16],emptyOption:!0,errorMessage:r[10]};r[4]!==void 0&&(K.value=r[4]),c=new ae({props:K}),B.push(()=>P(c,"value",x));function ee(u){r[23](u)}let U={label:"Comments or notes",errorMessage:r[12]};r[6]!==void 0&&(U.value=r[6]),m=new he({props:U}),B.push(()=>P(m,"value",ee)),M=new je({props:{$$slots:{default:[Qe]},$$scope:{ctx:r}}}),M.$on("click",r[17]);function I(u){r[25](u)}let J={title:"Almost done!",displayEscapeButton:!1,canCloseByClickingBackground:!1,$$slots:{default:[Xe]},$$scope:{ctx:r}};return r[13]!==void 0&&(J.open=r[13]),T=new De({props:J}),B.push(()=>P(T,"open",I)),{c(){k(e.$$.fragment),n=D(),k(t.$$.fragment),l=D(),k(s.$$.fragment),a=D(),k(i.$$.fragment),_=D(),k(c.$$.fragment),d=D(),k(m.$$.fragment),S=D(),k(M.$$.fragment),q=D(),k(T.$$.fragment)},m(u,g){v(e,u,g),w(u,n,g),v(t,u,g),w(u,l,g),v(s,u,g),w(u,a,g),v(i,u,g),w(u,_,g),v(c,u,g),w(u,d,g),v(m,u,g),w(u,S,g),v(M,u,g),w(u,q,g),v(T,u,g),j=!0},p(u,[g]){const fe={};g&134217858&&(fe.$$scope={dirty:g,ctx:u}),e.$set(fe);const pe={};g&134217988&&(pe.$$scope={dirty:g,ctx:u}),t.$set(pe);const te={};g&512&&(te.errorMessage=u[9]),!o&&g&8&&(o=!0,te.value=u[3],A(()=>o=!1)),s.$set(te);const Q={};g&1&&(Q.pt=u[0]),g&2048&&(Q.locationDescriptionError=u[11]),!f&&g&32&&(f=!0,Q.locationDescription=u[5],A(()=>f=!1)),i.$set(Q);const ne={};g&1024&&(ne.errorMessage=u[10]),!p&&g&16&&(p=!0,ne.value=u[4],A(()=>p=!1)),c.$set(ne);const re={};g&4096&&(re.errorMessage=u[12]),!C&&g&64&&(C=!0,re.value=u[6],A(()=>C=!1)),m.$set(re);const me={};g&134217728&&(me.$$scope={dirty:g,ctx:u}),M.$set(me);const se={};g&134242304&&(se.$$scope={dirty:g,ctx:u}),!V&&g&8192&&(V=!0,se.open=u[13],A(()=>V=!1)),T.$set(se)},i(u){j||($(e.$$.fragment,u),$(t.$$.fragment,u),$(s.$$.fragment,u),$(i.$$.fragment,u),$(c.$$.fragment,u),$(m.$$.fragment,u),$(M.$$.fragment,u),$(T.$$.fragment,u),j=!0)},o(u){b(e.$$.fragment,u),b(t.$$.fragment,u),b(s.$$.fragment,u),b(i.$$.fragment,u),b(c.$$.fragment,u),b(m.$$.fragment,u),b(M.$$.fragment,u),b(T.$$.fragment,u),j=!1},d(u){u&&(h(n),h(l),h(a),h(_),h(d),h(S),h(q)),y(e,u),y(t,u),y(s,u),y(i,u),y(c,u),y(m,u),y(M,u),y(T,u)}}}function ge(r){return r.map(e=>[e,e])}function et(r){let e=25569,t=24*(60*60*1e3);return r.getTime()/t+e}function tt(){location.reload()}function nt(r,e,n){let{pt:t}=e,l=window.localStorage.getItem("inspector")??"",s=window.localStorage.getItem("schemeReference")??"",o=window.localStorage.getItem("currentDesignStage")??"",a="",i="",f="",_="",c="",p="",d="",m="",C="",S=!1,M="",q=ge(["Baseline","Feasibility Design","Preliminary Design","Outline Design","Detailed Design","Inspection"]),T=ge(["1 - Conflict at Side Roads","2 - Conflict at Major Junctions / Roundabouts","3 - Collision Alongside or from Behind","4 - Trip Hazard","5 - Kerbside Activity","6A - Risk of Crossing Conflict (Busy Roads)","6B - Risk of Crossing Conflict (Quieter Roads)","7A - Standard of Crossing Facility (Busy Roads)","7B - Standard of Crossing Facility (Junction)","8 - Traffic Speed (>37mph)","9A - Traffic Volume (>10,000vpd)","9B - Traffic Volume (>5% HGVs)","10 - Crossing Speed","11A - Footway Width (Absolute Minimum <1m)","11B - Footway Width (at Pinchpoints)","11C - Footway Width - Poor Pedestrian Comfort","12 - Tram - Insufficient width next to Tram Track","13 - Tram/Rail - Poor Crossing Angle","14 - Major Cycle Surface Defect","15 - Major Pedestrian Surface Defect","16 - Inappropriate Shared Use","17 - Barriers, Steps and/or Dismount signs","18 - Route isn't direct, logical or intuitive to all users","19 - Inappropriate Surface Materials","20 - Inappropriate Lighting","21 - Routes must join other facilities as a network"]);function V(){let I=0,J=et(new Date);return[I,l,J,s,o,a,Se(t.toArray().reverse()).join(", "),i,f].join("	")}function j(){n(7,_=l?"":"Required"),n(8,c=s?"":"Required"),n(9,p=o?"":"Required"),n(10,d=a?"":"Required"),n(11,m=i?"":"Required"),n(12,C=f?"":"Required"),!(_||c||p||d||m||C)&&(n(14,M=V()),navigator.clipboard.writeText(M),n(13,S=!0))}function Z(){l=this.value,n(1,l)}function z(){s=this.value,n(2,s)}function X(I){o=I,n(3,o)}function G(I){i=I,n(5,i)}function x(I){a=I,n(4,a)}function K(I){f=I,n(6,f)}const ee=()=>n(13,S=!1);function U(I){S=I,n(13,S)}return r.$$set=I=>{"pt"in I&&n(0,t=I.pt)},r.$$.update=()=>{r.$$.dirty&2&&window.localStorage.setItem("inspector",l),r.$$.dirty&4&&window.localStorage.setItem("schemeReference",s),r.$$.dirty&8&&window.localStorage.setItem("currentDesignStage",o)},[t,l,s,o,a,i,f,_,c,p,d,m,C,S,M,q,T,j,Z,z,X,G,x,K,ee,U]}class rt extends N{constructor(e){super(),O(this,e,nt,xe,H,{pt:0})}}function st(r,e,n){let t;le(r,ue,i=>n(3,t=i));let{enableAdding:l}=e,s=null,{markerPosition:o=null}=e;_e(()=>{t.on("click",a),t.getCanvas().style.cursor="crosshair"}),Ie(()=>{s&&s.remove(),t.off("click",a)});function a(i){s||!l||(t.getCanvas().style.cursor="inherit",s=new Ee.Marker({draggable:!0}).setLngLat(i.lngLat).addTo(t),n(0,o=s.getLngLat()),s.on("dragstart",()=>{t.getCanvas().style.cursor="grabbing"}),s.on("dragend",()=>{t.getCanvas().style.cursor="inherit",n(0,o=s.getLngLat())}))}return r.$$set=i=>{"enableAdding"in i&&n(1,l=i.enableAdding),"markerPosition"in i&&n(0,o=i.markerPosition)},[o,l]}class ot extends N{constructor(e){super(),O(this,e,st,null,H,{enableAdding:1,markerPosition:0})}}function it(r){let e;return{c(){e=L("p"),e.textContent="Click the map to add a critical"},m(n,t){w(n,e,t)},p:oe,i:oe,o:oe,d(n){n&&h(e)}}}function at(r){let e,n;return e=new rt({props:{pt:r[0]}}),{c(){k(e.$$.fragment)},m(t,l){v(e,t,l),n=!0},p(t,l){const s={};l&1&&(s.pt=t[0]),e.$set(s)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){y(e,t)}}}function lt(r){let e,n,t,l,s,o,a,i,f,_;o=new Me({});const c=[at,it],p=[];function d(m,C){return m[0]?0:1}return i=d(r),f=p[i]=c[i](r),{c(){e=L("div"),n=L("h1"),n.textContent="Critical issue entry",t=D(),l=L("p"),l.textContent=`App version: ${$e()}`,s=D(),k(o.$$.fragment),a=D(),f.c(),E(e,"slot","sidebar"),E(e,"class","govuk-prose")},m(m,C){w(m,e,C),R(e,n),R(e,t),R(e,l),R(e,s),v(o,e,null),R(e,a),p[i].m(e,null),_=!0},p(m,C){let S=i;i=d(m),i===S?p[i].p(m,C):(be(),b(p[S],1,1,()=>{p[S]=null}),we(),f=p[i],f?f.p(m,C):(f=p[i]=c[i](m),f.c()),$(f,1),f.m(e,null))},i(m){_||($(o.$$.fragment,m),$(f),_=!0)},o(m){b(o.$$.fragment,m),b(f),_=!1},d(m){m&&h(e),y(o),p[i].d()}}}function de(r){let e,n,t;function l(o){r[5](o)}let s={markerPositionUpdated:pt};return r[0]!==void 0&&(s.markerPosition=r[0]),e=new ot({props:s}),B.push(()=>P(e,"markerPosition",l)),{c(){k(e.$$.fragment)},m(o,a){v(e,o,a),t=!0},p(o,a){const i={};!n&&a&1&&(n=!0,i.markerPosition=o[0],A(()=>n=!1)),e.$set(i)},i(o){t||($(e.$$.fragment,o),t=!0)},o(o){b(e.$$.fragment,o),t=!1},d(o){y(e,o)}}}function ut(r){let e,n,t,l,s,o,a,i=r[0]&&de(r);t=new We({props:{style:r[3],disabled:!r[1]}});function f(c){r[7](c)}let _={displayEnableButton:!0};return r[1]!==void 0&&(_.isInactive=r[1]),s=new Ae({props:_}),r[6](s),B.push(()=>P(s,"isInactive",f)),{c(){i&&i.c(),e=D(),n=L("div"),k(t.$$.fragment),l=D(),k(s.$$.fragment),E(n,"class","top-right svelte-nlvvhu")},m(c,p){i&&i.m(c,p),w(c,e,p),w(c,n,p),v(t,n,null),R(n,l),v(s,n,null),a=!0},p(c,p){c[0]?i?(i.p(c,p),p&1&&$(i,1)):(i=de(c),i.c(),$(i,1),i.m(e.parentNode,e)):i&&(be(),b(i,1,1,()=>{i=null}),we());const d={};p&2&&(d.disabled=!c[1]),t.$set(d);const m={};!o&&p&2&&(o=!0,m.isInactive=c[1],A(()=>o=!1)),s.$set(m)},i(c){a||($(i),$(t.$$.fragment,c),$(s.$$.fragment,c),a=!0)},o(c){b(i),b(t.$$.fragment,c),b(s.$$.fragment,c),a=!1},d(c){c&&(h(e),h(n)),i&&i.d(c),y(t),r[6](null),y(s)}}}function ct(r){let e,n,t;return n=new Pe({props:{style:r[3],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[ut]},$$scope:{ctx:r}}}),{c(){e=L("div"),k(n.$$.fragment),E(e,"slot","main")},m(l,s){w(l,e,s),v(n,e,null),t=!0},p(l,s){const o={};s&519&&(o.$$scope={dirty:s,ctx:l}),n.$set(o)},i(l){t||($(n.$$.fragment,l),t=!0)},o(l){b(n.$$.fragment,l),t=!1},d(l){l&&h(e),y(n)}}}function ft(r){let e,n,t,l;return e=new Be({props:{sidebarWidth:"35rem",$$slots:{main:[ct],sidebar:[lt]},$$scope:{ctx:r}}}),{c(){k(e.$$.fragment)},m(s,o){v(e,s,o),n=!0,t||(l=W(window,"keydown",r[4]),t=!0)},p(s,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:s}),e.$set(a)},i(s){n||($(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){y(e,s),t=!1,l()}}}const pt=()=>{};function mt(r,e,n){let t;le(r,ue,p=>n(8,t=p)),_e(()=>{Le(),t.on("click",p=>{n(0,s=p.lngLat)})});let l=$e()=="Private (development)"?"Road":"dataviz",s,o=!0,a;function i(p){!o&&p.key=="Escape"&&(a.disableStreetView(),p.preventDefault())}function f(p){s=p,n(0,s)}function _(p){B[p?"unshift":"push"](()=>{a=p,n(2,a)})}function c(p){o=p,n(1,o)}return[s,o,a,l,i,f,_,c]}class gt extends N{constructor(e){super(),O(this,e,mt,ft,H,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new gt({target:document.getElementById("app")});
