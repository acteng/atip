var Ll=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Xr=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var Lt=(n,e,t)=>(Ll(n,e,"access private method"),t);import{S as Le,i as xe,s as Pe,x as De,y as lt,f as U,z as wn,g as L,h as k,B as $t,C as Ie,p as x,D as et,E as Tt,t as ge,F as Ve,e as R,c as J,G as A,H as At,l as le,n as V,I as rt,o as X,J as it,r as Ct,K as Pr,L as gi,M as fn,N as Ye,O as ct,P as dt,Q as ht,R as pt,T as Se,b as Be,U as ms,V as bs,W as Jn,X as uo,Y as xl,j as Sn,d as be,m as ve,q as _e,Z as Pl,a as wt,k as St,_ as yr,$ as Al,a0 as Kr,a1 as mi,a2 as fo,w as bi,a3 as Un,a4 as cn,a5 as vs,a6 as co,a7 as Nl,a8 as Rl,a9 as Fl,aa as ho,ab as Dl,ac as Rn,ad as Ul,A as jl,u as Bl}from"./authorities-fe9f9155.js";function po(n){let e,t;return{c(){e=lt("title"),t=ge(n[1])},m(r,o){L(r,e,o),k(e,t)},p(r,o){o&2&&Ve(t,r[1])},d(r){r&&x(e)}}}function Gl(n){let e,t,r,o=n[1]&&po(n),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],a={};for(let u=0;u<s.length;u+=1)a=De(a,s[u]);return{c(){e=lt("svg"),o&&o.c(),t=lt("path"),r=lt("path"),U(t,"d","M16,2C8.3,2,2,8.3,2,16s6.3,14,14,14s14-6.3,14-14C30,8.3,23.7,2,16,2z M14.9,8h2.2v11h-2.2V8z M16,25	c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22c0.8,0,1.5,0.7,1.5,1.5S16.8,25,16,25z"),U(r,"fill","none"),U(r,"d","M17.5,23.5c0,0.8-0.7,1.5-1.5,1.5c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22	C16.8,22,17.5,22.7,17.5,23.5z M17.1,8h-2.2v11h2.2V8z"),U(r,"data-icon-path","inner-path"),U(r,"opacity","0"),wn(e,a)},m(u,d){L(u,e,d),o&&o.m(e,null),k(e,t),k(e,r)},p(u,[d]){u[1]?o?o.p(u,d):(o=po(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null),wn(e,a=$t(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},d&1&&{width:u[0]},d&1&&{height:u[0]},d&4&&u[2],d&8&&u[3]]))},i:Ie,o:Ie,d(u){u&&x(e),o&&o.d()}}}function Vl(n,e,t){let r,o;const s=["size","title"];let a=et(e,s),{size:u=16}=e,{title:d=void 0}=e;return n.$$set=f=>{t(5,e=De(De({},e),Tt(f))),t(3,a=et(e,s)),"size"in f&&t(0,u=f.size),"title"in f&&t(1,d=f.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||d),t(2,o={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Tt(e),[u,d,o,a,r]}class zl extends Le{constructor(e){super(),xe(this,e,Vl,Gl,Pe,{size:0,title:1})}}const _s=zl;function go(n){let e,t;return{c(){e=lt("title"),t=ge(n[1])},m(r,o){L(r,e,o),k(e,t)},p(r,o){o&2&&Ve(t,r[1])},d(r){r&&x(e)}}}function ql(n){let e,t,r,o,s=n[1]&&go(n),a=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],u={};for(let d=0;d<a.length;d+=1)u=De(u,a[d]);return{c(){e=lt("svg"),s&&s.c(),t=lt("path"),r=lt("path"),o=lt("path"),U(t,"fill","none"),U(t,"d","M16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Zm-1.125-5h2.25V12h-2.25Z"),U(t,"data-icon-path","inner-path"),U(r,"d","M16.002,6.1714h-.004L4.6487,27.9966,4.6506,28H27.3494l.0019-.0034ZM14.875,12h2.25v9h-2.25ZM16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Z"),U(o,"d","M29,30H3a1,1,0,0,1-.8872-1.4614l13-25a1,1,0,0,1,1.7744,0l13,25A1,1,0,0,1,29,30ZM4.6507,28H27.3493l.002-.0033L16.002,6.1714h-.004L4.6487,27.9967Z"),wn(e,u)},m(d,f){L(d,e,f),s&&s.m(e,null),k(e,t),k(e,r),k(e,o)},p(d,[f]){d[1]?s?s.p(d,f):(s=go(d),s.c(),s.m(e,t)):s&&(s.d(1),s=null),wn(e,u=$t(a,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},f&1&&{width:d[0]},f&1&&{height:d[0]},f&4&&d[2],f&8&&d[3]]))},i:Ie,o:Ie,d(d){d&&x(e),s&&s.d()}}}function Jl(n,e,t){let r,o;const s=["size","title"];let a=et(e,s),{size:u=16}=e,{title:d=void 0}=e;return n.$$set=f=>{t(5,e=De(De({},e),Tt(f))),t(3,a=et(e,s)),"size"in f&&t(0,u=f.size),"title"in f&&t(1,d=f.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||d),t(2,o={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Tt(e),[u,d,o,a,r]}class Yl extends Le{constructor(e){super(),xe(this,e,Jl,ql,Pe,{size:0,title:1})}}const Wl=Yl,Hl=n=>({}),mo=n=>({});function bo(n){let e,t;const r=n[16].labelText,o=ct(r,n,n[15],mo),s=o||Zl(n);return{c(){e=R("span"),s&&s.c(),A(e,"bx--visually-hidden",n[7])},m(a,u){L(a,e,u),s&&s.m(e,null),t=!0},p(a,u){o?o.p&&(!t||u&32768)&&dt(o,r,a,a[15],t?pt(r,a[15],u,Hl):ht(a[15]),mo):s&&s.p&&(!t||u&64)&&s.p(a,t?u:-1),(!t||u&128)&&A(e,"bx--visually-hidden",a[7])},i(a){t||(V(s,a),t=!0)},o(a){X(s,a),t=!1},d(a){a&&x(e),s&&s.d(a)}}}function Zl(n){let e;return{c(){e=ge(n[6])},m(t,r){L(t,e,r)},p(t,r){r&64&&Ve(e,t[6])},d(t){t&&x(e)}}}function Xl(n){let e,t,r,o,s,a,u,d,f,g=(n[6]||n[13].labelText)&&bo(n),b=[n[12]],p={};for(let h=0;h<b.length;h+=1)p=De(p,b[h]);return{c(){e=R("div"),t=R("input"),r=J(),o=R("label"),s=R("span"),a=J(),g&&g.c(),U(t,"type","radio"),U(t,"id",n[8]),U(t,"name",n[9]),t.checked=n[0],t.disabled=n[3],t.required=n[4],t.value=n[2],A(t,"bx--radio-button",!0),A(s,"bx--radio-button__appearance",!0),U(o,"for",n[8]),A(o,"bx--radio-button__label",!0),At(e,p),A(e,"bx--radio-button-wrapper",!0),A(e,"bx--radio-button-wrapper--label-left",n[5]==="left")},m(h,m){L(h,e,m),k(e,t),n[18](t),k(e,r),k(e,o),k(o,s),k(o,a),g&&g.m(o,null),u=!0,d||(f=[le(t,"change",n[17]),le(t,"change",n[19])],d=!0)},p(h,[m]){(!u||m&256)&&U(t,"id",h[8]),(!u||m&512)&&U(t,"name",h[9]),(!u||m&1)&&(t.checked=h[0]),(!u||m&8)&&(t.disabled=h[3]),(!u||m&16)&&(t.required=h[4]),(!u||m&4)&&(t.value=h[2]),h[6]||h[13].labelText?g?(g.p(h,m),m&8256&&V(g,1)):(g=bo(h),g.c(),V(g,1),g.m(o,null)):g&&(rt(),X(g,1,1,()=>{g=null}),it()),(!u||m&256)&&U(o,"for",h[8]),At(e,p=$t(b,[m&4096&&h[12]])),A(e,"bx--radio-button-wrapper",!0),A(e,"bx--radio-button-wrapper--label-left",h[5]==="left")},i(h){u||(V(g),u=!0)},o(h){X(g),u=!1},d(h){h&&x(e),n[18](null),g&&g.d(),d=!1,Ct(f)}}}function Kl(n,e,t){const r=["value","checked","disabled","required","labelPosition","labelText","hideLabel","id","name","ref"];let o=et(e,r),s,{$$slots:a={},$$scope:u}=e;const d=Pr(a);let{value:f=""}=e,{checked:g=!1}=e,{disabled:b=!1}=e,{required:p=!1}=e,{labelPosition:h="right"}=e,{labelText:m=""}=e,{hideLabel:E=!1}=e,{id:M="ccs-"+Math.random().toString(36)}=e,{name:z=""}=e,{ref:D=null}=e;const O=gi("RadioButtonGroup"),j=O?O.selectedValue:fn(g?f:void 0);Ye(n,j,ee=>t(14,s=ee)),O&&O.add({id:M,checked:g,disabled:b,value:f});function B(ee){Se.call(this,n,ee)}function N(ee){Be[ee?"unshift":"push"](()=>{D=ee,t(1,D)})}const he=()=>{O&&O.update(f)};return n.$$set=ee=>{e=De(De({},e),Tt(ee)),t(12,o=et(e,r)),"value"in ee&&t(2,f=ee.value),"checked"in ee&&t(0,g=ee.checked),"disabled"in ee&&t(3,b=ee.disabled),"required"in ee&&t(4,p=ee.required),"labelPosition"in ee&&t(5,h=ee.labelPosition),"labelText"in ee&&t(6,m=ee.labelText),"hideLabel"in ee&&t(7,E=ee.hideLabel),"id"in ee&&t(8,M=ee.id),"name"in ee&&t(9,z=ee.name),"ref"in ee&&t(1,D=ee.ref),"$$scope"in ee&&t(15,u=ee.$$scope)},n.$$.update=()=>{n.$$.dirty&16388&&t(0,g=s===f)},[g,D,f,b,p,h,m,E,M,z,O,j,o,d,s,u,a,B,N,he]}class Ql extends Le{constructor(e){super(),xe(this,e,Kl,Xl,Pe,{value:2,checked:0,disabled:3,required:4,labelPosition:5,labelText:6,hideLabel:7,id:8,name:9,ref:1})}}const Er=Ql;function $l(n){const e=n-1;return e*e*e+1}function vo(n,{delay:e=0,duration:t=400,easing:r=$l}={}){const o=getComputedStyle(n),s=+o.opacity,a=parseFloat(o.height),u=parseFloat(o.paddingTop),d=parseFloat(o.paddingBottom),f=parseFloat(o.marginTop),g=parseFloat(o.marginBottom),b=parseFloat(o.borderTopWidth),p=parseFloat(o.borderBottomWidth);return{delay:e,duration:t,easing:r,css:h=>`overflow: hidden;opacity: ${Math.min(h*20,1)*s};height: ${h*a}px;padding-top: ${h*u}px;padding-bottom: ${h*d}px;margin-top: ${h*f}px;margin-bottom: ${h*g}px;border-top-width: ${h*b}px;border-bottom-width: ${h*p}px;`}}function _o(n){let e,t;return{c(){e=lt("title"),t=ge(n[1])},m(r,o){L(r,e,o),k(e,t)},p(r,o){o&2&&Ve(t,r[1])},d(r){r&&x(e)}}}function ea(n){let e,t,r=n[1]&&_o(n),o=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],s={};for(let a=0;a<o.length;a+=1)s=De(s,o[a]);return{c(){e=lt("svg"),r&&r.c(),t=lt("path"),U(t,"d","M30 28.6L3.4 2 2 3.4l10.1 10.1L4 21.6V28h6.4l8.1-8.1L28.6 30 30 28.6zM9.6 26H6v-3.6l7.5-7.5 3.6 3.6L9.6 26zM29.4 6.2L29.4 6.2l-3.6-3.6c-.8-.8-2-.8-2.8 0l0 0 0 0-8 8 1.4 1.4L20 8.4l3.6 3.6L20 15.6l1.4 1.4 8-8C30.2 8.2 30.2 7 29.4 6.2L29.4 6.2zM25 10.6L21.4 7l3-3L28 7.6 25 10.6z"),wn(e,s)},m(a,u){L(a,e,u),r&&r.m(e,null),k(e,t)},p(a,[u]){a[1]?r?r.p(a,u):(r=_o(a),r.c(),r.m(e,t)):r&&(r.d(1),r=null),wn(e,s=$t(o,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},u&1&&{width:a[0]},u&1&&{height:a[0]},u&4&&a[2],u&8&&a[3]]))},i:Ie,o:Ie,d(a){a&&x(e),r&&r.d()}}}function ta(n,e,t){let r,o;const s=["size","title"];let a=et(e,s),{size:u=16}=e,{title:d=void 0}=e;return n.$$set=f=>{t(5,e=De(De({},e),Tt(f))),t(3,a=et(e,s)),"size"in f&&t(0,u=f.size),"title"in f&&t(1,d=f.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||d),t(2,o={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Tt(e),[u,d,o,a,r]}class na extends Le{constructor(e){super(),xe(this,e,ta,ea,Pe,{size:0,title:1})}}const ra=na;function ia(n){let e,t,r,o;const s=n[5].default,a=ct(s,n,n[4],null);let u=[n[3]],d={};for(let f=0;f<u.length;f+=1)d=De(d,u[f]);return{c(){e=R("ol"),a&&a.c(),At(e,d),A(e,"bx--list--ordered",!n[1]),A(e,"bx--list--ordered--native",n[1]),A(e,"bx--list--nested",n[0]),A(e,"bx--list--expressive",n[2])},m(f,g){L(f,e,g),a&&a.m(e,null),t=!0,r||(o=[le(e,"click",n[6]),le(e,"mouseover",n[7]),le(e,"mouseenter",n[8]),le(e,"mouseleave",n[9])],r=!0)},p(f,[g]){a&&a.p&&(!t||g&16)&&dt(a,s,f,f[4],t?pt(s,f[4],g,null):ht(f[4]),null),At(e,d=$t(u,[g&8&&f[3]])),A(e,"bx--list--ordered",!f[1]),A(e,"bx--list--ordered--native",f[1]),A(e,"bx--list--nested",f[0]),A(e,"bx--list--expressive",f[2])},i(f){t||(V(a,f),t=!0)},o(f){X(a,f),t=!1},d(f){f&&x(e),a&&a.d(f),r=!1,Ct(o)}}}function oa(n,e,t){const r=["nested","native","expressive"];let o=et(e,r),{$$slots:s={},$$scope:a}=e,{nested:u=!1}=e,{native:d=!1}=e,{expressive:f=!1}=e;function g(m){Se.call(this,n,m)}function b(m){Se.call(this,n,m)}function p(m){Se.call(this,n,m)}function h(m){Se.call(this,n,m)}return n.$$set=m=>{e=De(De({},e),Tt(m)),t(3,o=et(e,r)),"nested"in m&&t(0,u=m.nested),"native"in m&&t(1,d=m.native),"expressive"in m&&t(2,f=m.expressive),"$$scope"in m&&t(4,a=m.$$scope)},[u,d,f,o,a,s,g,b,p,h]}class sa extends Le{constructor(e){super(),xe(this,e,oa,ia,Pe,{nested:0,native:1,expressive:2})}}const la=sa,aa=n=>({}),yo=n=>({});function Eo(n){let e,t;const r=n[11].legendText,o=ct(r,n,n[10],yo),s=o||ua(n);return{c(){e=R("legend"),s&&s.c(),A(e,"bx--label",!0),A(e,"bx--visually-hidden",n[2])},m(a,u){L(a,e,u),s&&s.m(e,null),t=!0},p(a,u){o?o.p&&(!t||u&1024)&&dt(o,r,a,a[10],t?pt(r,a[10],u,aa):ht(a[10]),yo):s&&s.p&&(!t||u&2)&&s.p(a,t?u:-1),(!t||u&4)&&A(e,"bx--visually-hidden",a[2])},i(a){t||(V(s,a),t=!0)},o(a){X(s,a),t=!1},d(a){a&&x(e),s&&s.d(a)}}}function ua(n){let e;return{c(){e=ge(n[1])},m(t,r){L(t,e,r)},p(t,r){r&2&&Ve(e,t[1])},d(t){t&&x(e)}}}function fa(n){let e,t,r,o,s,a,u=(n[1]||n[8].legendText)&&Eo(n);const d=n[11].default,f=ct(d,n,n[10],null);let g=[{id:n[5]},n[7]],b={};for(let p=0;p<g.length;p+=1)b=De(b,g[p]);return{c(){e=R("div"),t=R("fieldset"),u&&u.c(),r=J(),f&&f.c(),t.disabled=n[0],A(t,"bx--radio-button-group",!0),A(t,"bx--radio-button-group--vertical",n[4]==="vertical"),A(t,"bx--radio-button-group--label-left",n[3]==="left"),A(t,"bx--radio-button-group--label-right",n[3]==="right"),At(e,b),A(e,"bx--form-item",!0)},m(p,h){L(p,e,h),k(e,t),u&&u.m(t,null),k(t,r),f&&f.m(t,null),o=!0,s||(a=[le(e,"click",n[12]),le(e,"mouseover",n[13]),le(e,"mouseenter",n[14]),le(e,"mouseleave",n[15])],s=!0)},p(p,[h]){p[1]||p[8].legendText?u?(u.p(p,h),h&258&&V(u,1)):(u=Eo(p),u.c(),V(u,1),u.m(t,r)):u&&(rt(),X(u,1,1,()=>{u=null}),it()),f&&f.p&&(!o||h&1024)&&dt(f,d,p,p[10],o?pt(d,p[10],h,null):ht(p[10]),null),(!o||h&1)&&(t.disabled=p[0]),(!o||h&16)&&A(t,"bx--radio-button-group--vertical",p[4]==="vertical"),(!o||h&8)&&A(t,"bx--radio-button-group--label-left",p[3]==="left"),(!o||h&8)&&A(t,"bx--radio-button-group--label-right",p[3]==="right"),At(e,b=$t(g,[(!o||h&32)&&{id:p[5]},h&128&&p[7]])),A(e,"bx--form-item",!0)},i(p){o||(V(u),V(f,p),o=!0)},o(p){X(u),X(f,p),o=!1},d(p){p&&x(e),u&&u.d(),f&&f.d(p),s=!1,Ct(a)}}}function ca(n,e,t){const r=["selected","disabled","legendText","hideLegend","labelPosition","orientation","id"];let o=et(e,r),s,{$$slots:a={},$$scope:u}=e;const d=Pr(a);let{selected:f=void 0}=e,{disabled:g=!1}=e,{legendText:b=""}=e,{hideLegend:p=!1}=e,{labelPosition:h="right"}=e,{orientation:m="horizontal"}=e,{id:E=void 0}=e;const M=ms(),z=fn(f);Ye(n,z,N=>t(16,s=N)),bs("RadioButtonGroup",{selectedValue:z,add:({checked:N,value:he})=>{N&&z.set(he)},update:N=>{t(9,f=N)}}),Jn(()=>{uo(z,s=f,s)}),xl(()=>{uo(z,s=f,s)}),z.subscribe(N=>{t(9,f=N),M("change",N)});function D(N){Se.call(this,n,N)}function O(N){Se.call(this,n,N)}function j(N){Se.call(this,n,N)}function B(N){Se.call(this,n,N)}return n.$$set=N=>{e=De(De({},e),Tt(N)),t(7,o=et(e,r)),"selected"in N&&t(9,f=N.selected),"disabled"in N&&t(0,g=N.disabled),"legendText"in N&&t(1,b=N.legendText),"hideLegend"in N&&t(2,p=N.hideLegend),"labelPosition"in N&&t(3,h=N.labelPosition),"orientation"in N&&t(4,m=N.orientation),"id"in N&&t(5,E=N.id),"$$scope"in N&&t(10,u=N.$$scope)},[g,b,p,h,m,E,z,o,d,f,u,a,D,O,j,B]}class da extends Le{constructor(e){super(),xe(this,e,ca,fa,Pe,{selected:9,disabled:0,legendText:1,hideLegend:2,labelPosition:3,orientation:4,id:5})}}const ha=da,pa=n=>({}),wo=n=>({});function So(n){let e,t,r,o;const s=n[20].labelText,a=ct(s,n,n[19],wo),u=a||ga(n);let d=n[5]&&To(n);return{c(){e=R("div"),t=R("label"),u&&u.c(),r=J(),d&&d.c(),U(t,"for",n[14]),A(t,"bx--label",!0),A(t,"bx--visually-hidden",n[11]),A(t,"bx--label--disabled",n[7]),A(e,"bx--text-area__label-wrapper",!0)},m(f,g){L(f,e,g),k(e,t),u&&u.m(t,null),k(e,r),d&&d.m(e,null),o=!0},p(f,g){a?a.p&&(!o||g[0]&524288)&&dt(a,s,f,f[19],o?pt(s,f[19],g,pa):ht(f[19]),wo):u&&u.p&&(!o||g[0]&1024)&&u.p(f,o?g:[-1,-1]),(!o||g[0]&16384)&&U(t,"for",f[14]),(!o||g[0]&2048)&&A(t,"bx--visually-hidden",f[11]),(!o||g[0]&128)&&A(t,"bx--label--disabled",f[7]),f[5]?d?d.p(f,g):(d=To(f),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i(f){o||(V(u,f),o=!0)},o(f){X(u,f),o=!1},d(f){f&&x(e),u&&u.d(f),d&&d.d()}}}function ga(n){let e;return{c(){e=ge(n[10])},m(t,r){L(t,e,r)},p(t,r){r[0]&1024&&Ve(e,t[10])},d(t){t&&x(e)}}}function To(n){let e,t=n[0].length+"",r,o,s;return{c(){e=R("div"),r=ge(t),o=ge("/"),s=ge(n[5]),A(e,"bx--label",!0),A(e,"bx--label--disabled",n[7])},m(a,u){L(a,e,u),k(e,r),k(e,o),k(e,s)},p(a,u){u[0]&1&&t!==(t=a[0].length+"")&&Ve(r,t),u[0]&32&&Ve(s,a[5]),u[0]&128&&A(e,"bx--label--disabled",a[7])},d(a){a&&x(e)}}}function Co(n){let e,t;return e=new _s({props:{class:"bx--text-area__invalid-icon"}}),{c(){be(e.$$.fragment)},m(r,o){ve(e,r,o),t=!0},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){X(e.$$.fragment,r),t=!1},d(r){_e(e,r)}}}function ko(n){let e,t;return{c(){e=R("div"),t=ge(n[9]),A(e,"bx--form__helper-text",!0),A(e,"bx--form__helper-text--disabled",n[7])},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&512&&Ve(t,r[9]),o[0]&128&&A(e,"bx--form__helper-text--disabled",r[7])},d(r){r&&x(e)}}}function Mo(n){let e,t;return{c(){e=R("div"),t=ge(n[13]),U(e,"id",n[16]),A(e,"bx--form-requirement",!0)},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&8192&&Ve(t,r[13]),o[0]&65536&&U(e,"id",r[16])},d(r){r&&x(e)}}}function ma(n){let e,t,r,o,s,a,u,d,f,g,b,p,h,m,E=(n[10]||n[17].labelText)&&!n[11]&&So(n),M=n[12]&&Co(),z=[{"aria-invalid":a=n[12]||void 0},{"aria-describedby":u=n[12]?n[16]:void 0},{disabled:n[7]},{id:n[14]},{name:n[15]},{cols:n[3]},{rows:n[4]},{placeholder:n[2]},{readOnly:n[8]},{maxlength:d=n[5]??void 0},n[18]],D={};for(let B=0;B<z.length;B+=1)D=De(D,z[B]);let O=!n[12]&&n[9]&&ko(n),j=n[12]&&Mo(n);return{c(){e=R("div"),E&&E.c(),t=J(),r=R("div"),M&&M.c(),o=J(),s=R("textarea"),g=J(),O&&O.c(),b=J(),j&&j.c(),At(s,D),A(s,"bx--text-area",!0),A(s,"bx--text-area--light",n[6]),A(s,"bx--text-area--invalid",n[12]),U(r,"data-invalid",f=n[12]||void 0),A(r,"bx--text-area__wrapper",!0),A(e,"bx--form-item",!0)},m(B,N){L(B,e,N),E&&E.m(e,null),k(e,t),k(e,r),M&&M.m(r,null),k(r,o),k(r,s),s.autofocus&&s.focus(),n[32](s),Sn(s,n[0]),k(e,g),O&&O.m(e,null),k(e,b),j&&j.m(e,null),p=!0,h||(m=[le(s,"input",n[33]),le(s,"change",n[25]),le(s,"input",n[26]),le(s,"keydown",n[27]),le(s,"keyup",n[28]),le(s,"focus",n[29]),le(s,"blur",n[30]),le(s,"paste",n[31]),le(e,"click",n[21]),le(e,"mouseover",n[22]),le(e,"mouseenter",n[23]),le(e,"mouseleave",n[24])],h=!0)},p(B,N){(B[10]||B[17].labelText)&&!B[11]?E?(E.p(B,N),N[0]&134144&&V(E,1)):(E=So(B),E.c(),V(E,1),E.m(e,t)):E&&(rt(),X(E,1,1,()=>{E=null}),it()),B[12]?M?N[0]&4096&&V(M,1):(M=Co(),M.c(),V(M,1),M.m(r,o)):M&&(rt(),X(M,1,1,()=>{M=null}),it()),At(s,D=$t(z,[(!p||N[0]&4096&&a!==(a=B[12]||void 0))&&{"aria-invalid":a},(!p||N[0]&69632&&u!==(u=B[12]?B[16]:void 0))&&{"aria-describedby":u},(!p||N[0]&128)&&{disabled:B[7]},(!p||N[0]&16384)&&{id:B[14]},(!p||N[0]&32768)&&{name:B[15]},(!p||N[0]&8)&&{cols:B[3]},(!p||N[0]&16)&&{rows:B[4]},(!p||N[0]&4)&&{placeholder:B[2]},(!p||N[0]&256)&&{readOnly:B[8]},(!p||N[0]&32&&d!==(d=B[5]??void 0))&&{maxlength:d},N[0]&262144&&B[18]])),N[0]&1&&Sn(s,B[0]),A(s,"bx--text-area",!0),A(s,"bx--text-area--light",B[6]),A(s,"bx--text-area--invalid",B[12]),(!p||N[0]&4096&&f!==(f=B[12]||void 0))&&U(r,"data-invalid",f),!B[12]&&B[9]?O?O.p(B,N):(O=ko(B),O.c(),O.m(e,b)):O&&(O.d(1),O=null),B[12]?j?j.p(B,N):(j=Mo(B),j.c(),j.m(e,null)):j&&(j.d(1),j=null)},i(B){p||(V(E),V(M),p=!0)},o(B){X(E),X(M),p=!1},d(B){B&&x(e),E&&E.d(),M&&M.d(),n[32](null),O&&O.d(),j&&j.d(),h=!1,Ct(m)}}}function ba(n,e,t){let r;const o=["value","placeholder","cols","rows","maxCount","light","disabled","readonly","helperText","labelText","hideLabel","invalid","invalidText","id","name","ref"];let s=et(e,o),{$$slots:a={},$$scope:u}=e;const d=Pr(a);let{value:f=""}=e,{placeholder:g=""}=e,{cols:b=50}=e,{rows:p=4}=e,{maxCount:h=void 0}=e,{light:m=!1}=e,{disabled:E=!1}=e,{readonly:M=!1}=e,{helperText:z=""}=e,{labelText:D=""}=e,{hideLabel:O=!1}=e,{invalid:j=!1}=e,{invalidText:B=""}=e,{id:N="ccs-"+Math.random().toString(36)}=e,{name:he=void 0}=e,{ref:ee=null}=e;function oe(T){Se.call(this,n,T)}function H(T){Se.call(this,n,T)}function I(T){Se.call(this,n,T)}function te(T){Se.call(this,n,T)}function $(T){Se.call(this,n,T)}function re(T){Se.call(this,n,T)}function K(T){Se.call(this,n,T)}function fe(T){Se.call(this,n,T)}function we(T){Se.call(this,n,T)}function Te(T){Se.call(this,n,T)}function Ce(T){Se.call(this,n,T)}function Fe(T){Be[T?"unshift":"push"](()=>{ee=T,t(1,ee)})}function ae(){f=this.value,t(0,f)}return n.$$set=T=>{e=De(De({},e),Tt(T)),t(18,s=et(e,o)),"value"in T&&t(0,f=T.value),"placeholder"in T&&t(2,g=T.placeholder),"cols"in T&&t(3,b=T.cols),"rows"in T&&t(4,p=T.rows),"maxCount"in T&&t(5,h=T.maxCount),"light"in T&&t(6,m=T.light),"disabled"in T&&t(7,E=T.disabled),"readonly"in T&&t(8,M=T.readonly),"helperText"in T&&t(9,z=T.helperText),"labelText"in T&&t(10,D=T.labelText),"hideLabel"in T&&t(11,O=T.hideLabel),"invalid"in T&&t(12,j=T.invalid),"invalidText"in T&&t(13,B=T.invalidText),"id"in T&&t(14,N=T.id),"name"in T&&t(15,he=T.name),"ref"in T&&t(1,ee=T.ref),"$$scope"in T&&t(19,u=T.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&t(16,r=`error-${N}`)},[f,ee,g,b,p,h,m,E,M,z,D,O,j,B,N,he,r,d,s,u,a,oe,H,I,te,$,re,K,fe,we,Te,Ce,Fe,ae]}class va extends Le{constructor(e){super(),xe(this,e,ba,ma,Pe,{value:0,placeholder:2,cols:3,rows:4,maxCount:5,light:6,disabled:7,readonly:8,helperText:9,labelText:10,hideLabel:11,invalid:12,invalidText:13,id:14,name:15,ref:1},null,[-1,-1])}}const _a=va,ya=n=>({}),Oo=n=>({}),Ea=n=>({}),Io=n=>({});function Lo(n){let e,t,r,o=n[9]&&xo(n),s=!n[20]&&n[6]&&Po(n);return{c(){e=R("div"),o&&o.c(),t=J(),s&&s.c(),A(e,"bx--text-input__label-helper-wrapper",!0)},m(a,u){L(a,e,u),o&&o.m(e,null),k(e,t),s&&s.m(e,null),r=!0},p(a,u){a[9]?o?(o.p(a,u),u[0]&512&&V(o,1)):(o=xo(a),o.c(),V(o,1),o.m(e,t)):o&&(rt(),X(o,1,1,()=>{o=null}),it()),!a[20]&&a[6]?s?s.p(a,u):(s=Po(a),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i(a){r||(V(o),r=!0)},o(a){X(o),r=!1},d(a){a&&x(e),o&&o.d(),s&&s.d()}}}function xo(n){let e,t;const r=n[26].labelText,o=ct(r,n,n[25],Io),s=o||wa(n);return{c(){e=R("label"),s&&s.c(),U(e,"for",n[7]),A(e,"bx--label",!0),A(e,"bx--visually-hidden",n[10]),A(e,"bx--label--disabled",n[5]),A(e,"bx--label--inline",n[16]),A(e,"bx--label--inline--sm",n[2]==="sm"),A(e,"bx--label--inline--xl",n[2]==="xl")},m(a,u){L(a,e,u),s&&s.m(e,null),t=!0},p(a,u){o?o.p&&(!t||u[0]&33554432)&&dt(o,r,a,a[25],t?pt(r,a[25],u,Ea):ht(a[25]),Io):s&&s.p&&(!t||u[0]&512)&&s.p(a,t?u:[-1,-1]),(!t||u[0]&128)&&U(e,"for",a[7]),(!t||u[0]&1024)&&A(e,"bx--visually-hidden",a[10]),(!t||u[0]&32)&&A(e,"bx--label--disabled",a[5]),(!t||u[0]&65536)&&A(e,"bx--label--inline",a[16]),(!t||u[0]&4)&&A(e,"bx--label--inline--sm",a[2]==="sm"),(!t||u[0]&4)&&A(e,"bx--label--inline--xl",a[2]==="xl")},i(a){t||(V(s,a),t=!0)},o(a){X(s,a),t=!1},d(a){a&&x(e),s&&s.d(a)}}}function wa(n){let e;return{c(){e=ge(n[9])},m(t,r){L(t,e,r)},p(t,r){r[0]&512&&Ve(e,t[9])},d(t){t&&x(e)}}}function Po(n){let e,t;return{c(){e=R("div"),t=ge(n[6]),A(e,"bx--form__helper-text",!0),A(e,"bx--form__helper-text--disabled",n[5]),A(e,"bx--form__helper-text--inline",n[16])},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&64&&Ve(t,r[6]),o[0]&32&&A(e,"bx--form__helper-text--disabled",r[5]),o[0]&65536&&A(e,"bx--form__helper-text--inline",r[16])},d(r){r&&x(e)}}}function Ao(n){let e,t;const r=n[26].labelText,o=ct(r,n,n[25],Oo),s=o||Sa(n);return{c(){e=R("label"),s&&s.c(),U(e,"for",n[7]),A(e,"bx--label",!0),A(e,"bx--visually-hidden",n[10]),A(e,"bx--label--disabled",n[5]),A(e,"bx--label--inline",n[16]),A(e,"bx--label--inline-sm",n[16]&&n[2]==="sm"),A(e,"bx--label--inline-xl",n[16]&&n[2]==="xl")},m(a,u){L(a,e,u),s&&s.m(e,null),t=!0},p(a,u){o?o.p&&(!t||u[0]&33554432)&&dt(o,r,a,a[25],t?pt(r,a[25],u,ya):ht(a[25]),Oo):s&&s.p&&(!t||u[0]&512)&&s.p(a,t?u:[-1,-1]),(!t||u[0]&128)&&U(e,"for",a[7]),(!t||u[0]&1024)&&A(e,"bx--visually-hidden",a[10]),(!t||u[0]&32)&&A(e,"bx--label--disabled",a[5]),(!t||u[0]&65536)&&A(e,"bx--label--inline",a[16]),(!t||u[0]&65540)&&A(e,"bx--label--inline-sm",a[16]&&a[2]==="sm"),(!t||u[0]&65540)&&A(e,"bx--label--inline-xl",a[16]&&a[2]==="xl")},i(a){t||(V(s,a),t=!0)},o(a){X(s,a),t=!1},d(a){a&&x(e),s&&s.d(a)}}}function Sa(n){let e;return{c(){e=ge(n[9])},m(t,r){L(t,e,r)},p(t,r){r[0]&512&&Ve(e,t[9])},d(t){t&&x(e)}}}function No(n){let e,t;return e=new _s({props:{class:"bx--text-input__invalid-icon"}}),{c(){be(e.$$.fragment)},m(r,o){ve(e,r,o),t=!0},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){X(e.$$.fragment,r),t=!1},d(r){_e(e,r)}}}function Ro(n){let e,t;return e=new Wl({props:{class:`bx--text-input__invalid-icon
            bx--text-input__invalid-icon--warning`}}),{c(){be(e.$$.fragment)},m(r,o){ve(e,r,o),t=!0},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){X(e.$$.fragment,r),t=!1},d(r){_e(e,r)}}}function Fo(n){let e,t;return e=new ra({props:{class:"bx--text-input__readonly-icon"}}),{c(){be(e.$$.fragment)},m(r,o){ve(e,r,o),t=!0},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){X(e.$$.fragment,r),t=!1},d(r){_e(e,r)}}}function Do(n){let e;return{c(){e=R("hr"),A(e,"bx--text-input__divider",!0)},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function Uo(n){let e,t;return{c(){e=R("div"),t=ge(n[12]),U(e,"id",n[19]),A(e,"bx--form-requirement",!0)},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&4096&&Ve(t,r[12]),o[0]&524288&&U(e,"id",r[19])},d(r){r&&x(e)}}}function jo(n){let e,t;return{c(){e=R("div"),t=ge(n[14]),U(e,"id",n[18]),A(e,"bx--form-requirement",!0)},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&16384&&Ve(t,r[14]),o[0]&262144&&U(e,"id",r[18])},d(r){r&&x(e)}}}function Bo(n){let e,t;return{c(){e=R("div"),t=ge(n[6]),A(e,"bx--form__helper-text",!0),A(e,"bx--form__helper-text--disabled",n[5]),A(e,"bx--form__helper-text--inline",n[16])},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&64&&Ve(t,r[6]),o[0]&32&&A(e,"bx--form__helper-text--disabled",r[5]),o[0]&65536&&A(e,"bx--form__helper-text--inline",r[16])},d(r){r&&x(e)}}}function Go(n){let e,t;return{c(){e=R("div"),t=ge(n[12]),U(e,"id",n[19]),A(e,"bx--form-requirement",!0)},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&4096&&Ve(t,r[12]),o[0]&524288&&U(e,"id",r[19])},d(r){r&&x(e)}}}function Vo(n){let e,t;return{c(){e=R("div"),t=ge(n[14]),U(e,"id",n[18]),A(e,"bx--form-requirement",!0)},m(r,o){L(r,e,o),k(e,t)},p(r,o){o[0]&16384&&Ve(t,r[14]),o[0]&262144&&U(e,"id",r[18])},d(r){r&&x(e)}}}function Ta(n){let e,t,r,o,s,a,u,d,f,g,b,p,h,m,E,M,z,D,O,j,B,N,he,ee,oe=n[16]&&Lo(n),H=!n[16]&&(n[9]||n[24].labelText)&&Ao(n),I=n[11]&&No(),te=!n[11]&&n[13]&&Ro(),$=n[17]&&Fo(),re=[{"data-invalid":g=n[11]||void 0},{"aria-invalid":b=n[11]||void 0},{"data-warn":p=n[13]||void 0},{"aria-describedby":h=n[11]?n[19]:n[13]?n[18]:void 0},{disabled:n[5]},{id:n[7]},{name:n[8]},{placeholder:n[3]},{required:n[15]},{readOnly:n[17]},n[23]],K={};for(let T=0;T<re.length;T+=1)K=De(K,re[T]);let fe=n[20]&&Do(),we=n[20]&&!n[16]&&n[11]&&Uo(n),Te=n[20]&&!n[16]&&n[13]&&jo(n),Ce=!n[11]&&!n[13]&&!n[20]&&!n[16]&&n[6]&&Bo(n),Fe=!n[20]&&n[11]&&Go(n),ae=!n[20]&&!n[11]&&n[13]&&Vo(n);return{c(){e=R("div"),oe&&oe.c(),t=J(),H&&H.c(),r=J(),o=R("div"),s=R("div"),I&&I.c(),a=J(),te&&te.c(),u=J(),$&&$.c(),d=J(),f=R("input"),m=J(),fe&&fe.c(),E=J(),we&&we.c(),M=J(),Te&&Te.c(),O=J(),Ce&&Ce.c(),j=J(),Fe&&Fe.c(),B=J(),ae&&ae.c(),At(f,K),A(f,"bx--text-input",!0),A(f,"bx--text-input--light",n[4]),A(f,"bx--text-input--invalid",n[11]),A(f,"bx--text-input--warn",n[13]),A(f,"bx--text-input--sm",n[2]==="sm"),A(f,"bx--text-input--xl",n[2]==="xl"),U(s,"data-invalid",z=n[11]||void 0),U(s,"data-warn",D=n[13]||void 0),A(s,"bx--text-input__field-wrapper",!0),A(s,"bx--text-input__field-wrapper--warning",!n[11]&&n[13]),A(o,"bx--text-input__field-outer-wrapper",!0),A(o,"bx--text-input__field-outer-wrapper--inline",n[16]),A(e,"bx--form-item",!0),A(e,"bx--text-input-wrapper",!0),A(e,"bx--text-input-wrapper--inline",n[16]),A(e,"bx--text-input-wrapper--light",n[4]),A(e,"bx--text-input-wrapper--readonly",n[17])},m(T,de){L(T,e,de),oe&&oe.m(e,null),k(e,t),H&&H.m(e,null),k(e,r),k(e,o),k(o,s),I&&I.m(s,null),k(s,a),te&&te.m(s,null),k(s,u),$&&$.m(s,null),k(s,d),k(s,f),f.autofocus&&f.focus(),n[36](f),Sn(f,n[0]),k(s,m),fe&&fe.m(s,null),k(s,E),we&&we.m(s,null),k(s,M),Te&&Te.m(s,null),k(o,O),Ce&&Ce.m(o,null),k(o,j),Fe&&Fe.m(o,null),k(o,B),ae&&ae.m(o,null),N=!0,he||(ee=[le(f,"input",n[37]),le(f,"change",n[22]),le(f,"input",n[21]),le(f,"keydown",n[31]),le(f,"keyup",n[32]),le(f,"focus",n[33]),le(f,"blur",n[34]),le(f,"paste",n[35]),le(e,"click",n[27]),le(e,"mouseover",n[28]),le(e,"mouseenter",n[29]),le(e,"mouseleave",n[30])],he=!0)},p(T,de){T[16]?oe?(oe.p(T,de),de[0]&65536&&V(oe,1)):(oe=Lo(T),oe.c(),V(oe,1),oe.m(e,t)):oe&&(rt(),X(oe,1,1,()=>{oe=null}),it()),!T[16]&&(T[9]||T[24].labelText)?H?(H.p(T,de),de[0]&16843264&&V(H,1)):(H=Ao(T),H.c(),V(H,1),H.m(e,r)):H&&(rt(),X(H,1,1,()=>{H=null}),it()),T[11]?I?de[0]&2048&&V(I,1):(I=No(),I.c(),V(I,1),I.m(s,a)):I&&(rt(),X(I,1,1,()=>{I=null}),it()),!T[11]&&T[13]?te?de[0]&10240&&V(te,1):(te=Ro(),te.c(),V(te,1),te.m(s,u)):te&&(rt(),X(te,1,1,()=>{te=null}),it()),T[17]?$?de[0]&131072&&V($,1):($=Fo(),$.c(),V($,1),$.m(s,d)):$&&(rt(),X($,1,1,()=>{$=null}),it()),At(f,K=$t(re,[(!N||de[0]&2048&&g!==(g=T[11]||void 0))&&{"data-invalid":g},(!N||de[0]&2048&&b!==(b=T[11]||void 0))&&{"aria-invalid":b},(!N||de[0]&8192&&p!==(p=T[13]||void 0))&&{"data-warn":p},(!N||de[0]&796672&&h!==(h=T[11]?T[19]:T[13]?T[18]:void 0))&&{"aria-describedby":h},(!N||de[0]&32)&&{disabled:T[5]},(!N||de[0]&128)&&{id:T[7]},(!N||de[0]&256)&&{name:T[8]},(!N||de[0]&8)&&{placeholder:T[3]},(!N||de[0]&32768)&&{required:T[15]},(!N||de[0]&131072)&&{readOnly:T[17]},de[0]&8388608&&T[23]])),de[0]&1&&f.value!==T[0]&&Sn(f,T[0]),A(f,"bx--text-input",!0),A(f,"bx--text-input--light",T[4]),A(f,"bx--text-input--invalid",T[11]),A(f,"bx--text-input--warn",T[13]),A(f,"bx--text-input--sm",T[2]==="sm"),A(f,"bx--text-input--xl",T[2]==="xl"),T[20]?fe||(fe=Do(),fe.c(),fe.m(s,E)):fe&&(fe.d(1),fe=null),T[20]&&!T[16]&&T[11]?we?we.p(T,de):(we=Uo(T),we.c(),we.m(s,M)):we&&(we.d(1),we=null),T[20]&&!T[16]&&T[13]?Te?Te.p(T,de):(Te=jo(T),Te.c(),Te.m(s,null)):Te&&(Te.d(1),Te=null),(!N||de[0]&2048&&z!==(z=T[11]||void 0))&&U(s,"data-invalid",z),(!N||de[0]&8192&&D!==(D=T[13]||void 0))&&U(s,"data-warn",D),(!N||de[0]&10240)&&A(s,"bx--text-input__field-wrapper--warning",!T[11]&&T[13]),!T[11]&&!T[13]&&!T[20]&&!T[16]&&T[6]?Ce?Ce.p(T,de):(Ce=Bo(T),Ce.c(),Ce.m(o,j)):Ce&&(Ce.d(1),Ce=null),!T[20]&&T[11]?Fe?Fe.p(T,de):(Fe=Go(T),Fe.c(),Fe.m(o,B)):Fe&&(Fe.d(1),Fe=null),!T[20]&&!T[11]&&T[13]?ae?ae.p(T,de):(ae=Vo(T),ae.c(),ae.m(o,null)):ae&&(ae.d(1),ae=null),(!N||de[0]&65536)&&A(o,"bx--text-input__field-outer-wrapper--inline",T[16]),(!N||de[0]&65536)&&A(e,"bx--text-input-wrapper--inline",T[16]),(!N||de[0]&16)&&A(e,"bx--text-input-wrapper--light",T[4]),(!N||de[0]&131072)&&A(e,"bx--text-input-wrapper--readonly",T[17])},i(T){N||(V(oe),V(H),V(I),V(te),V($),N=!0)},o(T){X(oe),X(H),X(I),X(te),X($),N=!1},d(T){T&&x(e),oe&&oe.d(),H&&H.d(),I&&I.d(),te&&te.d(),$&&$.d(),n[36](null),fe&&fe.d(),we&&we.d(),Te&&Te.d(),Ce&&Ce.d(),Fe&&Fe.d(),ae&&ae.d(),he=!1,Ct(ee)}}}function Ca(n,e,t){let r,o,s;const a=["size","value","placeholder","light","disabled","helperText","id","name","labelText","hideLabel","invalid","invalidText","warn","warnText","ref","required","inline","readonly"];let u=et(e,a),{$$slots:d={},$$scope:f}=e;const g=Pr(d);let{size:b=void 0}=e,{value:p=""}=e,{placeholder:h=""}=e,{light:m=!1}=e,{disabled:E=!1}=e,{helperText:M=""}=e,{id:z="ccs-"+Math.random().toString(36)}=e,{name:D=void 0}=e,{labelText:O=""}=e,{hideLabel:j=!1}=e,{invalid:B=!1}=e,{invalidText:N=""}=e,{warn:he=!1}=e,{warnText:ee=""}=e,{ref:oe=null}=e,{required:H=!1}=e,{inline:I=!1}=e,{readonly:te=!1}=e;const $=gi("Form"),re=ms();function K(Q){return u.type!=="number"?Q:Q!=""?Number(Q):null}const fe=Q=>{t(0,p=K(Q.target.value)),re("input",p)},we=Q=>{re("change",K(Q.target.value))};function Te(Q){Se.call(this,n,Q)}function Ce(Q){Se.call(this,n,Q)}function Fe(Q){Se.call(this,n,Q)}function ae(Q){Se.call(this,n,Q)}function T(Q){Se.call(this,n,Q)}function de(Q){Se.call(this,n,Q)}function $e(Q){Se.call(this,n,Q)}function Tn(Q){Se.call(this,n,Q)}function kt(Q){Se.call(this,n,Q)}function ue(Q){Be[Q?"unshift":"push"](()=>{oe=Q,t(1,oe)})}function ie(){p=this.value,t(0,p)}return n.$$set=Q=>{e=De(De({},e),Tt(Q)),t(23,u=et(e,a)),"size"in Q&&t(2,b=Q.size),"value"in Q&&t(0,p=Q.value),"placeholder"in Q&&t(3,h=Q.placeholder),"light"in Q&&t(4,m=Q.light),"disabled"in Q&&t(5,E=Q.disabled),"helperText"in Q&&t(6,M=Q.helperText),"id"in Q&&t(7,z=Q.id),"name"in Q&&t(8,D=Q.name),"labelText"in Q&&t(9,O=Q.labelText),"hideLabel"in Q&&t(10,j=Q.hideLabel),"invalid"in Q&&t(11,B=Q.invalid),"invalidText"in Q&&t(12,N=Q.invalidText),"warn"in Q&&t(13,he=Q.warn),"warnText"in Q&&t(14,ee=Q.warnText),"ref"in Q&&t(1,oe=Q.ref),"required"in Q&&t(15,H=Q.required),"inline"in Q&&t(16,I=Q.inline),"readonly"in Q&&t(17,te=Q.readonly),"$$scope"in Q&&t(25,f=Q.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&128&&t(19,o=`error-${z}`),n.$$.dirty[0]&128&&t(18,s=`warn-${z}`)},t(20,r=!!$&&$.isFluid),[p,oe,b,h,m,E,M,z,D,O,j,B,N,he,ee,H,I,te,s,o,r,fe,we,u,g,f,d,Te,Ce,Fe,ae,T,de,$e,Tn,kt,ue,ie]}class ka extends Le{constructor(e){super(),xe(this,e,Ca,Ta,Pe,{size:2,value:0,placeholder:3,light:4,disabled:5,helperText:6,id:7,name:8,labelText:9,hideLabel:10,invalid:11,invalidText:12,warn:13,warnText:14,ref:1,required:15,inline:16,readonly:17},null,[-1,-1])}}const Ma=ka;function Oa(n){let e;return{c(){e=ge(`Click one of the draw icons to the top right of the map (the icons allow
      you to draw points, lines, polygons or routes)`)},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function Ia(n){let e;return{c(){e=ge(`Draw the intervention on the map, clicking the original point or 'Finish
      snapping' for the Polygon and Route tools respectively`)},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function La(n){let e;return{c(){e=ge("Fill in the details that appear (Intervention type, name, description)")},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function xa(n){let e;return{c(){e=ge(`Click the "Save" button or "Delete" button to save or remove the
      intervention`)},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function Pa(n){let e,t,r,o,s,a,u,d;return e=new yr({props:{$$slots:{default:[Oa]},$$scope:{ctx:n}}}),r=new yr({props:{$$slots:{default:[Ia]},$$scope:{ctx:n}}}),s=new yr({props:{$$slots:{default:[La]},$$scope:{ctx:n}}}),u=new yr({props:{$$slots:{default:[xa]},$$scope:{ctx:n}}}),{c(){be(e.$$.fragment),t=J(),be(r.$$.fragment),o=J(),be(s.$$.fragment),a=J(),be(u.$$.fragment)},m(f,g){ve(e,f,g),L(f,t,g),ve(r,f,g),L(f,o,g),ve(s,f,g),L(f,a,g),ve(u,f,g),d=!0},p(f,g){const b={};g&4&&(b.$$scope={dirty:g,ctx:f}),e.$set(b);const p={};g&4&&(p.$$scope={dirty:g,ctx:f}),r.$set(p);const h={};g&4&&(h.$$scope={dirty:g,ctx:f}),s.$set(h);const m={};g&4&&(m.$$scope={dirty:g,ctx:f}),u.$set(m)},i(f){d||(V(e.$$.fragment,f),V(r.$$.fragment,f),V(s.$$.fragment,f),V(u.$$.fragment,f),d=!0)},o(f){X(e.$$.fragment,f),X(r.$$.fragment,f),X(s.$$.fragment,f),X(u.$$.fragment,f),d=!1},d(f){_e(e,f),f&&x(t),_e(r,f),f&&x(o),_e(s,f),f&&x(a),_e(u,f)}}}function Aa(n){let e,t,r,o,s,a,u,d,f,g,b,p,h,m,E,M,z,D,O,j,B,N,he,ee,oe,H;return s=new la({props:{$$slots:{default:[Pa]},$$scope:{ctx:n}}}),{c(){e=R("p"),e.textContent="For each intervention:",t=J(),r=R("br"),o=J(),be(s.$$.fragment),a=J(),u=R("br"),d=J(),f=R("p"),f.textContent=`Repeat the steps above for each substantial infrastructure intervention in
    the scheme.`,g=J(),b=R("br"),p=J(),h=R("p"),h.textContent=`To make further edits to attribute data, or to delete an intervention, click
    on its name in the left hand panel or its geometry in the map.`,m=J(),E=R("br"),M=J(),z=R("p"),z.textContent=`Click the "Export to GeoJSON" button to download the dataset representing
    the scheme, which can be made up of one or more intervention, as a GeoJSON
    file. After saving the file, you can delete the interventions, change the
    scheme name, and start a new set of interventions representing a new scheme.`,D=J(),O=R("br"),j=J(),B=R("p"),B.textContent=`To load a GeoJSON file that you have already saved from the tool, click the
    "Load from GeoJSON" button and select the file.`,N=J(),he=R("br"),ee=J(),oe=R("p"),oe.innerHTML=`Note: the <strong>Route tool</strong> works by calculating routes between
    start and end points using the existing transport network according to
    OpenStreetMap. Use it by clicking on the location where you would like the
    route to start and then clicking on the location where you would like the
    route to end on the map. The route will be calculated and drawn on the map.
    After you click &quot;Finish snapping&quot; you can edit the route by dragging
    individual points. This can be useful for representing links that are not
    part of the existing transport network, such as a new bridge or path.
    However,
    <strong>you cannot add or remove points</strong> with the Route tool. If the
    planned route intervention you would like to sketch as part of a scheme contains
    one or more new links (for example containing new bridges or paths between cul-de-sacs),
    you may want to use the Line tool instead.`},m(I,te){L(I,e,te),L(I,t,te),L(I,r,te),L(I,o,te),ve(s,I,te),L(I,a,te),L(I,u,te),L(I,d,te),L(I,f,te),L(I,g,te),L(I,b,te),L(I,p,te),L(I,h,te),L(I,m,te),L(I,E,te),L(I,M,te),L(I,z,te),L(I,D,te),L(I,O,te),L(I,j,te),L(I,B,te),L(I,N,te),L(I,he,te),L(I,ee,te),L(I,oe,te),H=!0},p(I,te){const $={};te&4&&($.$$scope={dirty:te,ctx:I}),s.$set($)},i(I){H||(V(s.$$.fragment,I),H=!0)},o(I){X(s.$$.fragment,I),H=!1},d(I){I&&x(e),I&&x(t),I&&x(r),I&&x(o),_e(s,I),I&&x(a),I&&x(u),I&&x(d),I&&x(f),I&&x(g),I&&x(b),I&&x(p),I&&x(h),I&&x(m),I&&x(E),I&&x(M),I&&x(z),I&&x(D),I&&x(O),I&&x(j),I&&x(B),I&&x(N),I&&x(he),I&&x(ee),I&&x(oe)}}}function Na(n){let e,t,r;function o(a){n[1](a)}let s={passiveModal:!0,modalHeading:"Instructions",$$slots:{default:[Aa]},$$scope:{ctx:n}};return n[0]!==void 0&&(s.open=n[0]),e=new Pl({props:s}),Be.push(()=>wt(e,"open",o,n[0])),{c(){be(e.$$.fragment)},m(a,u){ve(e,a,u),r=!0},p(a,[u]){const d={};u&4&&(d.$$scope={dirty:u,ctx:a}),!t&&u&1&&(t=!0,d.open=a[0],St(()=>t=!1)),e.$set(d)},i(a){r||(V(e.$$.fragment,a),r=!0)},o(a){X(e.$$.fragment,a),r=!1},d(a){_e(e,a)}}}function Ra(n,e,t){let{open:r}=e;function o(s){r=s,t(0,r)}return n.$$set=s=>{"open"in s&&t(0,r=s.open)},[r,o]}class Fa extends Le{constructor(e){super(),xe(this,e,Ra,Na,Pe,{open:0})}}const Nt=fn(null),je=fn(ni()),ft=fn(null),_t=fn(null),Da=fn(null);function ni(){return{type:"FeatureCollection",features:[]}}const Ua=Al(je,n=>{let e=n.features.find(t=>t.properties.editing);return e?e.id:null});function ys(n){let e=new Set;for(let r of n.features)e.add(r.id);let t=e.size+1;for(;e.has(t);)t++;return t}function zo(n){let e;const t=n[4].default,r=ct(t,n,n[3],null);return{c(){r&&r.c()},m(o,s){r&&r.m(o,s),e=!0},p(o,s){r&&r.p&&(!e||s&8)&&dt(r,t,o,o[3],e?pt(t,o[3],s,null):ht(o[3]),null)},i(o){e||(V(r,o),e=!0)},o(o){X(r,o),e=!1},d(o){r&&r.d(o)}}}function ja(n){let e,t,r=n[1]&&zo(n);return{c(){e=R("div"),r&&r.c(),U(e,"class","map svelte-12dpf1u")},m(o,s){L(o,e,s),r&&r.m(e,null),n[5](e),t=!0},p(o,[s]){o[1]?r?(r.p(o,s),s&2&&V(r,1)):(r=zo(o),r.c(),V(r,1),r.m(e,null)):r&&(rt(),X(r,1,1,()=>{r=null}),it())},i(o){t||(V(r),t=!0)},o(o){X(r),t=!1},d(o){o&&x(e),r&&r.d(),n[5](null)}}}function Ba(n,e,t){let{$$slots:r={},$$scope:o}=e,{style:s}=e,a,u,d=!1;bs("setCamera",!window.location.hash),Jn(()=>{a=new Kr.Map({container:u,style:`https://api.maptiler.com/maps/${s}/style.json?key=MZEJTanw3WpxRvt7qDfo`,hash:!0}),a.addControl(new Kr.ScaleControl),a.addControl(new Kr.NavigationControl({visualizePitch:!0}),"bottom-right"),a.on("load",()=>{t(1,d=!0),Nt.set(a)}),new ResizeObserver(()=>{a.resize()}).observe(u)}),mi(()=>{a.remove()});function f(g){Be[g?"unshift":"push"](()=>{u=g,t(0,u)})}return n.$$set=g=>{"style"in g&&t(2,s=g.style),"$$scope"in g&&t(3,o=g.$$scope)},[u,d,s,o,r,f]}class Ga extends Le{constructor(e){super(),xe(this,e,Ba,ja,Pe,{style:2})}}const Va=n=>({}),qo=n=>({}),za=n=>({}),Jo=n=>({}),qa=n=>({}),Yo=n=>({});function Ja(n){let e,t,r,o,s,a,u,d,f,g,b,p;const h=n[3].nav,m=ct(h,n,n[2],Yo),E=n[3].sidebar,M=ct(E,n,n[2],Jo),z=n[3].main,D=ct(z,n,n[2],qo);return{c(){e=R("aside"),t=R("div"),r=R("nav"),m&&m.c(),o=J(),M&&M.c(),s=J(),a=R("div"),a.textContent="→",d=J(),f=R("main"),D&&D.c(),U(r,"class","svelte-19nerxn"),U(t,"class","sidebar-content content-container svelte-19nerxn"),U(a,"class","sidebar-toggle rounded-rect svelte-19nerxn"),U(e,"class",u=fo(n[0]?"":"collapsed")+" svelte-19nerxn"),U(f,"class","svelte-19nerxn")},m(O,j){L(O,e,j),k(e,t),k(t,r),m&&m.m(r,null),k(t,o),M&&M.m(t,null),k(e,s),k(e,a),L(O,d,j),L(O,f,j),D&&D.m(f,null),g=!0,b||(p=le(a,"click",n[1]),b=!0)},p(O,[j]){m&&m.p&&(!g||j&4)&&dt(m,h,O,O[2],g?pt(h,O[2],j,qa):ht(O[2]),Yo),M&&M.p&&(!g||j&4)&&dt(M,E,O,O[2],g?pt(E,O[2],j,za):ht(O[2]),Jo),(!g||j&1&&u!==(u=fo(O[0]?"":"collapsed")+" svelte-19nerxn"))&&U(e,"class",u),D&&D.p&&(!g||j&4)&&dt(D,z,O,O[2],g?pt(z,O[2],j,Va):ht(O[2]),qo)},i(O){g||(V(m,O),V(M,O),V(D,O),g=!0)},o(O){X(m,O),X(M,O),X(D,O),g=!1},d(O){O&&x(e),m&&m.d(O),M&&M.d(O),O&&x(d),O&&x(f),D&&D.d(O),b=!1,p()}}}function Ya(n,e,t){let{$$slots:r={},$$scope:o}=e,s=!0;function a(){t(0,s=!s)}return n.$$set=u=>{"$$scope"in u&&t(2,o=u.$$scope)},[s,a,o,r]}class Wa extends Le{constructor(e){super(),xe(this,e,Ya,Ja,Pe,{})}}var st=63710088e-1,Ha={centimeters:st*100,centimetres:st*100,degrees:st/111325,feet:st*3.28084,inches:st*39.37,kilometers:st/1e3,kilometres:st/1e3,meters:st,metres:st,miles:st/1609.344,millimeters:st*1e3,millimetres:st*1e3,nauticalmiles:st/1852,radians:1,yards:st*1.0936};function Vn(n,e,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=n,r}function Za(n,e,t){t===void 0&&(t={});for(var r=0,o=n;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:n};return Vn(u,e,t)}function Xa(n,e,t){if(t===void 0&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:n};return Vn(r,e,t)}function Ka(n,e,t){t===void 0&&(t={});var r={type:"MultiPolygon",coordinates:n};return Vn(r,e,t)}function Qa(n,e){e===void 0&&(e="kilometers");var t=Ha[e];if(!t)throw new Error(e+" units is invalid");return n*t}function wr(n){var e=n%360;return e*Math.PI/180}/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function $a(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(f){return function(g){return d([f,g])}}function d(f){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=f[0]&2?o.return:f[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,f[1])).done)return s;switch(o=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,o=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){t.label=f[1];break}if(f[0]===6&&t.label<s[1]){t.label=s[1],s=f;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(f);break}s[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(n,t)}catch(g){f=[6,g],o=0}finally{r=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Qt=function(){function n(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return n}();function eu(n,e){return n>e?1:n<e?-1:0}function Zt(n,e,t){for(var r=new Qt(null,null),o=r,s=r;;){var a=t(n,e.key);if(a<0){if(e.left===null)break;if(t(n,e.left.key)<0){var u=e.left;if(e.left=u.right,u.right=e,e=u,e.left===null)break}s.left=e,s=e,e=e.left}else if(a>0){if(e.right===null)break;if(t(n,e.right.key)>0){var u=e.right;if(e.right=u.left,u.left=e,e=u,e.right===null)break}o.right=e,o=e,e=e.right}else break}return o.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function Qr(n,e,t,r){var o=new Qt(n,e);if(t===null)return o.left=o.right=null,o;t=Zt(n,t,r);var s=r(n,t.key);return s<0?(o.left=t.left,o.right=t,t.left=null):s>=0&&(o.right=t.right,o.left=t,t.right=null),o}function Wo(n,e,t){var r=null,o=null;if(e){e=Zt(n,e,t);var s=t(e.key,n);s===0?(r=e.left,o=e.right):s<0?(o=e.right,e.right=null,r=e):(r=e.left,e.left=null,o=e)}return{left:r,right:o}}function tu(n,e,t){return e===null?n:(n===null||(e=Zt(n.key,e,t),e.left=n),e)}function ri(n,e,t,r,o){if(n){r(""+e+(t?"└── ":"├── ")+o(n)+`
`);var s=e+(t?"    ":"│   ");n.left&&ri(n.left,s,!1,r,o),n.right&&ri(n.right,s,!0,r,o)}}var vi=function(){function n(e){e===void 0&&(e=eu),this._root=null,this._size=0,this._comparator=e}return n.prototype.insert=function(e,t){return this._size++,this._root=Qr(e,t,this._root,this._comparator)},n.prototype.add=function(e,t){var r=new Qt(e,t);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var o=this._comparator,s=Zt(e,this._root,o),a=o(e,s.key);return a===0?this._root=s:(a<0?(r.left=s.left,r.right=s,s.left=null):a>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},n.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},n.prototype._remove=function(e,t,r){var o;if(t===null)return null;t=Zt(e,t,r);var s=r(e,t.key);return s===0?(t.left===null?o=t.right:(o=Zt(e,t.left,r),o.right=t.right),this._size--,o):t},n.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Zt(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},n.prototype.findStatic=function(e){for(var t=this._root,r=this._comparator;t;){var o=r(e,t.key);if(o===0)return t;o<0?t=t.left:t=t.right}return null},n.prototype.find=function(e){return this._root&&(this._root=Zt(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},n.prototype.contains=function(e){for(var t=this._root,r=this._comparator;t;){var o=r(e,t.key);if(o===0)return!0;o<0?t=t.left:t=t.right}return!1},n.prototype.forEach=function(e,t){for(var r=this._root,o=[],s=!1;!s;)r!==null?(o.push(r),r=r.left):o.length!==0?(r=o.pop(),e.call(t,r),r=r.right):s=!0;return this},n.prototype.range=function(e,t,r,o){for(var s=[],a=this._comparator,u=this._root,d;s.length!==0||u;)if(u)s.push(u),u=u.left;else{if(u=s.pop(),d=a(u.key,t),d>0)break;if(a(u.key,e)>=0&&r.call(o,u))return this;u=u.right}return this},n.prototype.keys=function(){var e=[];return this.forEach(function(t){var r=t.key;return e.push(r)}),e},n.prototype.values=function(){var e=[];return this.forEach(function(t){var r=t.data;return e.push(r)}),e},n.prototype.min=function(){return this._root?this.minNode(this._root).key:null},n.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},n.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},n.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},n.prototype.at=function(e){for(var t=this._root,r=!1,o=0,s=[];!r;)if(t)s.push(t),t=t.left;else if(s.length>0){if(t=s.pop(),o===e)return t;o++,t=t.right}else r=!0;return null},n.prototype.next=function(e){var t=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var o=this._comparator;t;){var s=o(e.key,t.key);if(s===0)break;s<0?(r=t,t=t.left):t=t.right}return r},n.prototype.prev=function(e){var t=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var o=this._comparator;t;){var s=o(e.key,t.key);if(s===0)break;s<0?t=t.left:(r=t,t=t.right)}return r},n.prototype.clear=function(){return this._root=null,this._size=0,this},n.prototype.toList=function(){return ru(this._root)},n.prototype.load=function(e,t,r){t===void 0&&(t=[]),r===void 0&&(r=!1);var o=e.length,s=this._comparator;if(r&&si(e,t,0,o-1,s),this._root===null)this._root=ii(e,t,0,o),this._size=o;else{var a=iu(this.toList(),nu(e,t),s);o=this._size+o,this._root=oi({head:a},0,o)}return this},n.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var t=[];return ri(this._root,"",!0,function(r){return t.push(r)},e),t.join("")},n.prototype.update=function(e,t,r){var o=this._comparator,s=Wo(e,this._root,o),a=s.left,u=s.right;o(e,t)<0?u=Qr(t,r,u,o):a=Qr(t,r,a,o),this._root=tu(a,u,o)},n.prototype.split=function(e){return Wo(e,this._root,this._comparator)},n.prototype[Symbol.iterator]=function(){var e;return $a(this,function(t){switch(t.label){case 0:e=this.minNode(),t.label=1;case 1:return e?[4,e]:[3,3];case 2:return t.sent(),e=this.next(e),[3,1];case 3:return[2]}})},n}();function ii(n,e,t,r){var o=r-t;if(o>0){var s=t+Math.floor(o/2),a=n[s],u=e[s],d=new Qt(a,u);return d.left=ii(n,e,t,s),d.right=ii(n,e,s+1,r),d}return null}function nu(n,e){for(var t=new Qt(null,null),r=t,o=0;o<n.length;o++)r=r.next=new Qt(n[o],e[o]);return r.next=null,t.next}function ru(n){for(var e=n,t=[],r=!1,o=new Qt(null,null),s=o;!r;)e?(t.push(e),e=e.left):t.length>0?(e=s=s.next=t.pop(),e=e.right):r=!0;return s.next=null,o.next}function oi(n,e,t){var r=t-e;if(r>0){var o=e+Math.floor(r/2),s=oi(n,e,o),a=n.head;return a.left=s,n.head=n.head.next,a.right=oi(n,o+1,t),a}return null}function iu(n,e,t){for(var r=new Qt(null,null),o=r,s=n,a=e;s!==null&&a!==null;)t(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return s!==null?o.next=s:a!==null&&(o.next=a),r.next}function si(n,e,t,r,o){if(!(t>=r)){for(var s=n[t+r>>1],a=t-1,u=r+1;;){do a++;while(o(n[a],s)<0);do u--;while(o(n[u],s)>0);if(a>=u)break;var d=n[a];n[a]=n[u],n[u]=d,d=e[a],e[a]=e[u],e[u]=d}si(n,e,t,u,o),si(n,e,u+1,r,o)}}function gt(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Ho(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function ot(n,e,t){return e&&Ho(n.prototype,e),t&&Ho(n,t),n}var Fn=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},li=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,o=e.ur.x<t.ur.x?e.ur.x:t.ur.x,s=e.ll.y<t.ll.y?t.ll.y:e.ll.y,a=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:r,y:s},ur:{x:o,y:a}}},Xt=Number.EPSILON;Xt===void 0&&(Xt=Math.pow(2,-52));var ou=Xt*Xt,ai=function(e,t){if(-Xt<e&&e<Xt&&-Xt<t&&t<Xt)return 0;var r=e-t;return r*r<ou*e*t?0:e<t?-1:1},su=function(){function n(){gt(this,n),this.reset()}return ot(n,[{key:"reset",value:function(){this.xRounder=new Zo,this.yRounder=new Zo}},{key:"round",value:function(t,r){return{x:this.xRounder.round(t),y:this.yRounder.round(r)}}}]),n}(),Zo=function(){function n(){gt(this,n),this.tree=new vi,this.round(0)}return ot(n,[{key:"round",value:function(t){var r=this.tree.add(t),o=this.tree.prev(r);if(o!==null&&ai(r.key,o.key)===0)return this.tree.remove(t),o.key;var s=this.tree.next(r);return s!==null&&ai(r.key,s.key)===0?(this.tree.remove(t),s.key):t}}]),n}(),zn=new su,jn=function(e,t){return e.x*t.y-e.y*t.x},Es=function(e,t){return e.x*t.x+e.y*t.y},Xo=function(e,t,r){var o={x:t.x-e.x,y:t.y-e.y},s={x:r.x-e.x,y:r.y-e.y},a=jn(o,s);return ai(a,0)},Ir=function(e){return Math.sqrt(Es(e,e))},lu=function(e,t,r){var o={x:t.x-e.x,y:t.y-e.y},s={x:r.x-e.x,y:r.y-e.y};return jn(s,o)/Ir(s)/Ir(o)},au=function(e,t,r){var o={x:t.x-e.x,y:t.y-e.y},s={x:r.x-e.x,y:r.y-e.y};return Es(s,o)/Ir(s)/Ir(o)},Ko=function(e,t,r){return t.y===0?null:{x:e.x+t.x/t.y*(r-e.y),y:r}},Qo=function(e,t,r){return t.x===0?null:{x:r,y:e.y+t.y/t.x*(r-e.x)}},uu=function(e,t,r,o){if(t.x===0)return Qo(r,o,e.x);if(o.x===0)return Qo(e,t,r.x);if(t.y===0)return Ko(r,o,e.y);if(o.y===0)return Ko(e,t,r.y);var s=jn(t,o);if(s==0)return null;var a={x:r.x-e.x,y:r.y-e.y},u=jn(a,t)/s,d=jn(a,o)/s,f=e.x+d*t.x,g=r.x+u*o.x,b=e.y+d*t.y,p=r.y+u*o.y,h=(f+g)/2,m=(b+p)/2;return{x:h,y:m}},xt=function(){ot(n,null,[{key:"compare",value:function(t,r){var o=n.comparePoints(t.point,r.point);return o!==0?o:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:Lr.compare(t.segment,r.segment))}},{key:"comparePoints",value:function(t,r){return t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0}}]);function n(e,t){gt(this,n),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}return ot(n,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var r=t.point.events,o=0,s=r.length;o<s;o++){var a=r[o];this.point.events.push(a),a.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,r=0;r<t;r++){var o=this.point.events[r];if(o.segment.consumedBy===void 0)for(var s=r+1;s<t;s++){var a=this.point.events[s];a.consumedBy===void 0&&o.otherSE.point.events===a.otherSE.point.events&&o.segment.consume(a.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],r=0,o=this.point.events.length;r<o;r++){var s=this.point.events[r];s!==this&&!s.segment.ringOut&&s.segment.isInResult()&&t.push(s)}return t}},{key:"getLeftmostComparator",value:function(t){var r=this,o=new Map,s=function(u){var d=u.otherSE;o.set(u,{sine:lu(r.point,t.point,d.point),cosine:au(r.point,t.point,d.point)})};return function(a,u){o.has(a)||s(a),o.has(u)||s(u);var d=o.get(a),f=d.sine,g=d.cosine,b=o.get(u),p=b.sine,h=b.cosine;return f>=0&&p>=0?g<h?1:g>h?-1:0:f<0&&p<0?g<h?-1:g>h?1:0:p<f?-1:p>f?1:0}}}]),n}(),fu=0,Lr=function(){ot(n,null,[{key:"compare",value:function(t,r){var o=t.leftSE.point.x,s=r.leftSE.point.x,a=t.rightSE.point.x,u=r.rightSE.point.x;if(u<o)return 1;if(a<s)return-1;var d=t.leftSE.point.y,f=r.leftSE.point.y,g=t.rightSE.point.y,b=r.rightSE.point.y;if(o<s){if(f<d&&f<g)return 1;if(f>d&&f>g)return-1;var p=t.comparePoint(r.leftSE.point);if(p<0)return 1;if(p>0)return-1;var h=r.comparePoint(t.rightSE.point);return h!==0?h:-1}if(o>s){if(d<f&&d<b)return-1;if(d>f&&d>b)return 1;var m=r.comparePoint(t.leftSE.point);if(m!==0)return m;var E=t.comparePoint(r.rightSE.point);return E<0?1:E>0?-1:1}if(d<f)return-1;if(d>f)return 1;if(a<u){var M=r.comparePoint(t.rightSE.point);if(M!==0)return M}if(a>u){var z=t.comparePoint(r.rightSE.point);if(z<0)return 1;if(z>0)return-1}if(a!==u){var D=g-d,O=a-o,j=b-f,B=u-s;if(D>O&&j<B)return 1;if(D<O&&j>B)return-1}return a>u?1:a<u||g<b?-1:g>b?1:t.id<r.id?-1:t.id>r.id?1:0}}]);function n(e,t,r,o){gt(this,n),this.id=++fu,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=r,this.windings=o}return ot(n,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<r?t:r},ur:{x:this.rightSE.point.x,y:t>r?t:r}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var r=this.leftSE.point,o=this.rightSE.point,s=this.vector();if(r.x===o.x)return t.x===r.x?0:t.x<r.x?1:-1;var a=(t.y-r.y)/s.y,u=r.x+a*s.x;if(t.x===u)return 0;var d=(t.x-r.x)/s.x,f=r.y+d*s.y;return t.y===f?0:t.y<f?-1:1}},{key:"getIntersection",value:function(t){var r=this.bbox(),o=t.bbox(),s=li(r,o);if(s===null)return null;var a=this.leftSE.point,u=this.rightSE.point,d=t.leftSE.point,f=t.rightSE.point,g=Fn(r,d)&&this.comparePoint(d)===0,b=Fn(o,a)&&t.comparePoint(a)===0,p=Fn(r,f)&&this.comparePoint(f)===0,h=Fn(o,u)&&t.comparePoint(u)===0;if(b&&g)return h&&!p?u:!h&&p?f:null;if(b)return p&&a.x===f.x&&a.y===f.y?null:a;if(g)return h&&u.x===d.x&&u.y===d.y?null:d;if(h&&p)return null;if(h)return u;if(p)return f;var m=uu(a,this.vector(),d,t.vector());return m===null||!Fn(s,m)?null:zn.round(m.x,m.y)}},{key:"split",value:function(t){var r=[],o=t.events!==void 0,s=new xt(t,!0),a=new xt(t,!1),u=this.rightSE;this.replaceRightSE(a),r.push(a),r.push(s);var d=new n(s,u,this.rings.slice(),this.windings.slice());return xt.comparePoints(d.leftSE.point,d.rightSE.point)>0&&d.swapEvents(),xt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(s.checkForConsuming(),a.checkForConsuming()),r}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var r=0,o=this.windings.length;r<o;r++)this.windings[r]*=-1}},{key:"consume",value:function(t){for(var r=this,o=t;r.consumedBy;)r=r.consumedBy;for(;o.consumedBy;)o=o.consumedBy;var s=n.compare(r,o);if(s!==0){if(s>0){var a=r;r=o,o=a}if(r.prev===o){var u=r;r=o,o=u}for(var d=0,f=o.rings.length;d<f;d++){var g=o.rings[d],b=o.windings[d],p=r.rings.indexOf(g);p===-1?(r.rings.push(g),r.windings.push(b)):r.windings[p]+=b}o.rings=null,o.windings=null,o.consumedBy=r,o.leftSE.consumedBy=r.leftSE,o.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var r=this._afterState.rings,o=this._afterState.windings,s=this._afterState.multiPolys,a=0,u=this.rings.length;a<u;a++){var d=this.rings[a],f=this.windings[a],g=r.indexOf(d);g===-1?(r.push(d),o.push(f)):o[g]+=f}for(var b=[],p=[],h=0,m=r.length;h<m;h++)if(o[h]!==0){var E=r[h],M=E.poly;if(p.indexOf(M)===-1)if(E.isExterior)b.push(M);else{p.indexOf(M)===-1&&p.push(M);var z=b.indexOf(E.poly);z!==-1&&b.splice(z,1)}}for(var D=0,O=b.length;D<O;D++){var j=b[D].multiPoly;s.indexOf(j)===-1&&s.push(j)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var t=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(yt.type){case"union":{var o=t.length===0,s=r.length===0;this._isInResult=o!==s;break}case"intersection":{var a,u;t.length<r.length?(a=t.length,u=r.length):(a=r.length,u=t.length),this._isInResult=u===yt.numMultiPolys&&a<u;break}case"xor":{var d=Math.abs(t.length-r.length);this._isInResult=d%2===1;break}case"difference":{var f=function(b){return b.length===1&&b[0].isSubject};this._isInResult=f(t)!==f(r);break}default:throw new Error("Unrecognized operation type found ".concat(yt.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,r,o){var s,a,u,d=xt.comparePoints(t,r);if(d<0)s=t,a=r,u=1;else if(d>0)s=r,a=t,u=-1;else throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));var f=new xt(s,!0),g=new xt(a,!1);return new n(f,g,[o],[u])}}]),n}(),$o=function(){function n(e,t,r){if(gt(this,n),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=zn.round(e[0][0],e[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,u=e.length;a<u;a++){if(typeof e[a][0]!="number"||typeof e[a][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var d=zn.round(e[a][0],e[a][1]);d.x===s.x&&d.y===s.y||(this.segments.push(Lr.fromRing(s,d,this)),d.x<this.bbox.ll.x&&(this.bbox.ll.x=d.x),d.y<this.bbox.ll.y&&(this.bbox.ll.y=d.y),d.x>this.bbox.ur.x&&(this.bbox.ur.x=d.x),d.y>this.bbox.ur.y&&(this.bbox.ur.y=d.y),s=d)}(o.x!==s.x||o.y!==s.y)&&this.segments.push(Lr.fromRing(s,o,this))}return ot(n,[{key:"getSweepEvents",value:function(){for(var t=[],r=0,o=this.segments.length;r<o;r++){var s=this.segments[r];t.push(s.leftSE),t.push(s.rightSE)}return t}}]),n}(),cu=function(){function n(e,t){if(gt(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new $o(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,o=e.length;r<o;r++){var s=new $o(e[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=t}return ot(n,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),r=0,o=this.interiorRings.length;r<o;r++)for(var s=this.interiorRings[r].getSweepEvents(),a=0,u=s.length;a<u;a++)t.push(s[a]);return t}}]),n}(),es=function(){function n(e,t){if(gt(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,o=e.length;r<o;r++){var s=new cu(e[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=t}return ot(n,[{key:"getSweepEvents",value:function(){for(var t=[],r=0,o=this.polys.length;r<o;r++)for(var s=this.polys[r].getSweepEvents(),a=0,u=s.length;a<u;a++)t.push(s[a]);return t}}]),n}(),du=function(){ot(n,null,[{key:"factory",value:function(t){for(var r=[],o=0,s=t.length;o<s;o++){var a=t[o];if(!(!a.isInResult()||a.ringOut)){for(var u=null,d=a.leftSE,f=a.rightSE,g=[d],b=d.point,p=[];u=d,d=f,g.push(d),d.point!==b;)for(;;){var h=d.getAvailableLinkedEvents();if(h.length===0){var m=g[0].point,E=g[g.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(m.x,",")+" ".concat(m.y,"]. Last matching segment found ends at")+" [".concat(E.x,", ").concat(E.y,"]."))}if(h.length===1){f=h[0].otherSE;break}for(var M=null,z=0,D=p.length;z<D;z++)if(p[z].point===d.point){M=z;break}if(M!==null){var O=p.splice(M)[0],j=g.splice(O.index);j.unshift(j[0].otherSE),r.push(new n(j.reverse()));continue}p.push({index:g.length,point:d.point});var B=d.getLeftmostComparator(u);f=h.sort(B)[0].otherSE;break}r.push(new n(g))}}return r}}]);function n(e){gt(this,n),this.events=e;for(var t=0,r=e.length;t<r;t++)e[t].segment.ringOut=this;this.poly=null}return ot(n,[{key:"getGeom",value:function(){for(var t=this.events[0].point,r=[t],o=1,s=this.events.length-1;o<s;o++){var a=this.events[o].point,u=this.events[o+1].point;Xo(a,t,u)!==0&&(r.push(a),t=a)}if(r.length===1)return null;var d=r[0],f=r[1];Xo(d,t,f)===0&&r.shift(),r.push(r[0]);for(var g=this.isExteriorRing()?1:-1,b=this.isExteriorRing()?0:r.length-1,p=this.isExteriorRing()?r.length:-1,h=[],m=b;m!=p;m+=g)h.push([r[m].x,r[m].y]);return h}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],r=1,o=this.events.length;r<o;r++){var s=this.events[r];xt.compare(t,s)>0&&(t=s)}for(var a=t.segment.prevInResult(),u=a?a.prevInResult():null;;){if(!a)return null;if(!u)return a.ringOut;if(u.ringOut!==a.ringOut)return u.ringOut.enclosingRing()!==a.ringOut?a.ringOut:a.ringOut.enclosingRing();a=u.prevInResult(),u=a?a.prevInResult():null}}}]),n}(),ts=function(){function n(e){gt(this,n),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return ot(n,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(var r=0,o=this.interiorRings.length;r<o;r++){var s=this.interiorRings[r].getGeom();s!==null&&t.push(s)}return t}}]),n}(),hu=function(){function n(e){gt(this,n),this.rings=e,this.polys=this._composePolys(e)}return ot(n,[{key:"getGeom",value:function(){for(var t=[],r=0,o=this.polys.length;r<o;r++){var s=this.polys[r].getGeom();s!==null&&t.push(s)}return t}},{key:"_composePolys",value:function(t){for(var r=[],o=0,s=t.length;o<s;o++){var a=t[o];if(!a.poly)if(a.isExteriorRing())r.push(new ts(a));else{var u=a.enclosingRing();u.poly||r.push(new ts(u)),u.poly.addInterior(a)}}return r}}]),n}(),pu=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lr.compare;gt(this,n),this.queue=e,this.tree=new vi(t),this.segments=[]}return ot(n,[{key:"process",value:function(t){var r=t.segment,o=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(r),o;var s=t.isLeft?this.tree.insert(r):this.tree.find(r);if(!s)throw new Error("Unable to find segment #".concat(r.id," ")+"[".concat(r.leftSE.point.x,", ").concat(r.leftSE.point.y,"] -> ")+"[".concat(r.rightSE.point.x,", ").concat(r.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var a=s,u=s,d=void 0,f=void 0;d===void 0;)a=this.tree.prev(a),a===null?d=null:a.key.consumedBy===void 0&&(d=a.key);for(;f===void 0;)u=this.tree.next(u),u===null?f=null:u.key.consumedBy===void 0&&(f=u.key);if(t.isLeft){var g=null;if(d){var b=d.getIntersection(r);if(b!==null&&(r.isAnEndpoint(b)||(g=b),!d.isAnEndpoint(b)))for(var p=this._splitSafely(d,b),h=0,m=p.length;h<m;h++)o.push(p[h])}var E=null;if(f){var M=f.getIntersection(r);if(M!==null&&(r.isAnEndpoint(M)||(E=M),!f.isAnEndpoint(M)))for(var z=this._splitSafely(f,M),D=0,O=z.length;D<O;D++)o.push(z[D])}if(g!==null||E!==null){var j=null;if(g===null)j=E;else if(E===null)j=g;else{var B=xt.comparePoints(g,E);j=B<=0?g:E}this.queue.remove(r.rightSE),o.push(r.rightSE);for(var N=r.split(j),he=0,ee=N.length;he<ee;he++)o.push(N[he])}o.length>0?(this.tree.remove(r),o.push(t)):(this.segments.push(r),r.prev=d)}else{if(d&&f){var oe=d.getIntersection(f);if(oe!==null){if(!d.isAnEndpoint(oe))for(var H=this._splitSafely(d,oe),I=0,te=H.length;I<te;I++)o.push(H[I]);if(!f.isAnEndpoint(oe))for(var $=this._splitSafely(f,oe),re=0,K=$.length;re<K;re++)o.push($[re])}}this.tree.remove(r)}return o}},{key:"_splitSafely",value:function(t,r){this.tree.remove(t);var o=t.rightSE;this.queue.remove(o);var s=t.split(r);return s.push(o),t.consumedBy===void 0&&this.tree.insert(t),s}}]),n}(),ns=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,gu=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,mu=function(){function n(){gt(this,n)}return ot(n,[{key:"run",value:function(t,r,o){yt.type=t,zn.reset();for(var s=[new es(r,!0)],a=0,u=o.length;a<u;a++)s.push(new es(o[a],!1));if(yt.numMultiPolys=s.length,yt.type==="difference")for(var d=s[0],f=1;f<s.length;)li(s[f].bbox,d.bbox)!==null?f++:s.splice(f,1);if(yt.type==="intersection"){for(var g=0,b=s.length;g<b;g++)for(var p=s[g],h=g+1,m=s.length;h<m;h++)if(li(p.bbox,s[h].bbox)===null)return[]}for(var E=new vi(xt.compare),M=0,z=s.length;M<z;M++)for(var D=s[M].getSweepEvents(),O=0,j=D.length;O<j;O++)if(E.insert(D[O]),E.size>ns)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var B=new pu(E),N=E.size,he=E.pop();he;){var ee=he.key;if(E.size===N){var oe=ee.segment;throw new Error("Unable to pop() ".concat(ee.isLeft?"left":"right"," SweepEvent ")+"[".concat(ee.point.x,", ").concat(ee.point.y,"] from segment #").concat(oe.id," ")+"[".concat(oe.leftSE.point.x,", ").concat(oe.leftSE.point.y,"] -> ")+"[".concat(oe.rightSE.point.x,", ").concat(oe.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(E.size>ns)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(B.segments.length>gu)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var H=B.process(ee),I=0,te=H.length;I<te;I++){var $=H[I];$.consumedBy===void 0&&E.insert($)}N=E.size,he=E.pop()}zn.reset();var re=du.factory(B.segments),K=new hu(re);return K.getGeom()}}]),n}(),yt=new mu,bu=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return yt.run("union",e,r)},vu=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return yt.run("intersection",e,r)},_u=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return yt.run("xor",e,r)},yu=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return yt.run("difference",e,r)},Tr={union:bu,intersection:vu,xor:_u,difference:yu};function Eu(n,e){var t=Su(e),r=null;return n.type==="FeatureCollection"?r=wu(n):r=ws(Tr.union(n.geometry.coordinates)),r.geometry.coordinates.forEach(function(o){t.geometry.coordinates.push(o[0])}),t}function wu(n){var e=n.features.length===2?Tr.union(n.features[0].geometry.coordinates,n.features[1].geometry.coordinates):Tr.union.apply(Tr,n.features.map(function(t){return t.geometry.coordinates}));return ws(e)}function ws(n){return Ka(n)}function Su(n){var e=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],t=n&&n.geometry.coordinates||e;return Za(t)}const Tu={"line-cap":"round","line-join":"round"},Ss=["==","$type","Polygon"],Ts=["==","$type","LineString"],Cs=["==","$type","Point"];function ui(n,e,t=1){return{type:"line",layout:Tu,paint:{"line-color":n,"line-width":e,"line-opacity":t}}}function ks(n,e){return{type:"fill",paint:{"fill-color":n,"fill-opacity":e}}}function Ms(n,e,t=1){return{type:"circle",paint:{"circle-radius":e,"circle-color":n,"circle-opacity":t}}}function _i(n,e,t){if(n.getSource(e)){let r=[];for(let o of n.getStyle().layers)o.source==e&&r.push(o.id);for(let o of r)n.removeLayer(o);n.removeSource(e)}n.addSource(e,t)}function un(n,e,t=null){n.getLayer(e.id)&&n.removeLayer(e.id),t&&!n.getLayer(t)&&(t=null),n.addLayer(e,t)}function Cu(n,e,t){let r;Ye(n,Nt,a=>t(1,r=a));let{boundaryGeojson:o}=e;return gi("setCamera")&&r.fitBounds(bi(o),{padding:20,animate:!1}),_i(r,"boundary",{type:"geojson",data:Eu(o)}),un(r,{id:"boundary",source:"boundary",...ks("black",.5)}),n.$$set=a=>{"boundaryGeojson"in a&&t(0,o=a.boundaryGeojson)},[o]}class ku extends Le{constructor(e){super(),xe(this,e,Cu,null,Pe,{boundaryGeojson:0})}}function Mu(n){let e,t,r,o,s,a,u,d;return e=new Er({props:{labelText:"Area",value:"area"}}),r=new Er({props:{labelText:"Route",value:"route"}}),s=new Er({props:{labelText:"Crossing",value:"crossing"}}),u=new Er({props:{labelText:"Other",value:"other"}}),{c(){be(e.$$.fragment),t=J(),be(r.$$.fragment),o=J(),be(s.$$.fragment),a=J(),be(u.$$.fragment)},m(f,g){ve(e,f,g),L(f,t,g),ve(r,f,g),L(f,o,g),ve(s,f,g),L(f,a,g),ve(u,f,g),d=!0},p:Ie,i(f){d||(V(e.$$.fragment,f),V(r.$$.fragment,f),V(s.$$.fragment,f),V(u.$$.fragment,f),d=!0)},o(f){X(e.$$.fragment,f),X(r.$$.fragment,f),X(s.$$.fragment,f),X(u.$$.fragment,f),d=!1},d(f){_e(e,f),f&&x(t),_e(r,f),f&&x(o),_e(s,f),f&&x(a),_e(u,f)}}}function rs(n){let e,t,r=is(n[3])+"",o,s,a;return{c(){e=R("p"),t=ge("Length: "),o=ge(r),s=J(),a=R("br")},m(u,d){L(u,e,d),k(e,t),k(e,o),L(u,s,d),L(u,a,d)},p(u,d){d&8&&r!==(r=is(u[3])+"")&&Ve(o,r)},d(u){u&&x(e),u&&x(s),u&&x(a)}}}function Ou(n){let e,t,r,o,s,a,u,d,f,g,b,p,h,m,E,M,z,D,O,j,B,N,he;function ee(K){n[7](K)}let oe={labelText:"Name"};n[0]!==void 0&&(oe.value=n[0]),e=new Ma({props:oe}),Be.push(()=>wt(e,"value",ee,n[0]));function H(K){n[8](K)}let I={$$slots:{default:[Mu]},$$scope:{ctx:n}};n[1]!==void 0&&(I.selected=n[1]),a=new ha({props:I}),Be.push(()=>wt(a,"selected",H,n[1]));function te(K){n[9](K)}let $={labelText:"Description"};n[2]!==void 0&&($.value=n[2]),b=new _a({props:$}),Be.push(()=>wt(b,"value",te,n[2]));let re=n[3]&&rs(n);return{c(){be(e.$$.fragment),r=J(),o=R("br"),s=J(),be(a.$$.fragment),d=J(),f=R("br"),g=J(),be(b.$$.fragment),h=J(),m=R("br"),E=J(),re&&re.c(),M=J(),z=R("div"),D=R("button"),D.textContent="Delete",O=J(),j=R("button"),j.textContent="Save",U(D,"type","button"),U(j,"type","button"),Un(j,"float","right")},m(K,fe){ve(e,K,fe),L(K,r,fe),L(K,o,fe),L(K,s,fe),ve(a,K,fe),L(K,d,fe),L(K,f,fe),L(K,g,fe),ve(b,K,fe),L(K,h,fe),L(K,m,fe),L(K,E,fe),re&&re.m(K,fe),L(K,M,fe),L(K,z,fe),k(z,D),k(z,O),k(z,j),n[11](z),B=!0,N||(he=[le(D,"click",n[5]),le(j,"click",n[10])],N=!0)},p(K,[fe]){const we={};!t&&fe&1&&(t=!0,we.value=K[0],St(()=>t=!1)),e.$set(we);const Te={};fe&4096&&(Te.$$scope={dirty:fe,ctx:K}),!u&&fe&2&&(u=!0,Te.selected=K[1],St(()=>u=!1)),a.$set(Te);const Ce={};!p&&fe&4&&(p=!0,Ce.value=K[2],St(()=>p=!1)),b.$set(Ce),K[3]?re?re.p(K,fe):(re=rs(K),re.c(),re.m(M.parentNode,M)):re&&(re.d(1),re=null)},i(K){B||(V(e.$$.fragment,K),V(a.$$.fragment,K),V(b.$$.fragment,K),B=!0)},o(K){X(e.$$.fragment,K),X(a.$$.fragment,K),X(b.$$.fragment,K),B=!1},d(K){_e(e,K),K&&x(r),K&&x(o),K&&x(s),_e(a,K),K&&x(d),K&&x(f),K&&x(g),_e(b,K),K&&x(h),K&&x(m),K&&x(E),re&&re.d(K),K&&x(M),K&&x(z),n[11](null),N=!1,Ct(he)}}}function is(n){return n<1e3?Math.round(n)+" m":(n/1e3).toFixed(1)+"km"}function Iu(n,e,t){let{id:r}=e,{name:o}=e,{intervention_type:s}=e,{description:a}=e,{length_meters:u}=e,d;Ua.subscribe(E=>{r==E&&setTimeout(()=>d==null?void 0:d.scrollIntoView({behavior:"smooth"}),1)});function f(){je.update(E=>(E.features=E.features.filter(M=>M.id!=r),E)),ft.set(null),_t.set(null)}function g(E){o=E,t(0,o)}function b(E){s=E,t(1,s)}function p(E){a=E,t(2,a)}const h=()=>ft.set(null);function m(E){Be[E?"unshift":"push"](()=>{d=E,t(4,d)})}return n.$$set=E=>{"id"in E&&t(6,r=E.id),"name"in E&&t(0,o=E.name),"intervention_type"in E&&t(1,s=E.intervention_type),"description"in E&&t(2,a=E.description),"length_meters"in E&&t(3,u=E.length_meters)},[o,s,a,u,d,f,r,g,b,p,h,m]}class Lu extends Le{constructor(e){super(),xe(this,e,Iu,Ou,Pe,{id:6,name:0,intervention_type:1,description:2,length_meters:3})}}function os(n){let e,t,r;const o=n[8].default,s=ct(o,n,n[7],null);return{c(){e=R("div"),s&&s.c()},m(a,u){L(a,e,u),s&&s.m(e,null),r=!0},p(a,u){s&&s.p&&(!r||u&128)&&dt(s,o,a,a[7],r?pt(o,a[7],u,null):ht(a[7]),null)},i(a){r||(V(s,a),vs(()=>{t||(t=co(e,vo,{duration:300},!0)),t.run(1)}),r=!0)},o(a){X(s,a),t||(t=co(e,vo,{duration:300},!1)),t.run(0),r=!1},d(a){a&&x(e),s&&s.d(a),a&&t&&t.end()}}}function xu(n){let e,t,r,o,s,a,u,d,f,g,b=n[2]&&os(n);return{c(){e=R("button"),t=lt("svg"),r=lt("path"),o=J(),s=ge(n[0]),a=J(),b&&b.c(),u=cn(),U(r,"d","M9 5l7 7-7 7"),U(t,"style","tran"),U(t,"width","20"),U(t,"height","20"),U(t,"fill","none"),U(t,"stroke-linecap","round"),U(t,"stroke-linejoin","round"),U(t,"stroke-width","2"),U(t,"viewBox","0 0 24 24"),U(t,"stroke","currentColor"),U(t,"class","svelte-75u8ea"),U(e,"aria-expanded",n[2]),U(e,"class","svelte-75u8ea"),A(e,"underlined",n[1])},m(p,h){L(p,e,h),k(e,t),k(t,r),k(e,o),k(e,s),L(p,a,h),b&&b.m(p,h),L(p,u,h),d=!0,f||(g=[le(e,"click",n[3]),le(e,"mouseenter",n[9]),le(e,"mouseleave",n[10])],f=!0)},p(p,[h]){(!d||h&1)&&Ve(s,p[0]),(!d||h&4)&&U(e,"aria-expanded",p[2]),(!d||h&2)&&A(e,"underlined",p[1]),p[2]?b?(b.p(p,h),h&4&&V(b,1)):(b=os(p),b.c(),V(b,1),b.m(u.parentNode,u)):b&&(rt(),X(b,1,1,()=>{b=null}),it())},i(p){d||(V(b),d=!0)},o(p){X(b),d=!1},d(p){p&&x(e),p&&x(a),b&&b.d(p),p&&x(u),f=!1,Ct(g)}}}function Pu(n,e,t){let r,o,s,a;Ye(n,_t,m=>t(5,s=m)),Ye(n,ft,m=>t(6,a=m));let{$$slots:u={},$$scope:d}=e,{id:f}=e,{label:g}=e;const b=()=>{ft.update(m=>m==f?null:f)};function p(m){Se.call(this,n,m)}function h(m){Se.call(this,n,m)}return n.$$set=m=>{"id"in m&&t(4,f=m.id),"label"in m&&t(0,g=m.label),"$$scope"in m&&t(7,d=m.$$scope)},n.$$.update=()=>{n.$$.dirty&80&&t(2,r=a==f),n.$$.dirty&48&&t(1,o=s==f)},[g,o,r,b,f,s,a,d,u,p,h]}class Au extends Le{constructor(e){super(),xe(this,e,Pu,xu,Pe,{id:4,label:0})}}function ss(n,e,t){const r=n.slice();return r[10]=e[t],r[11]=e,r[12]=t,r}function Nu(n){let e,t,r,o,s,a;function u(b){n[3](b,n[10])}function d(b){n[4](b,n[10])}function f(b){n[5](b,n[10])}let g={id:n[10].id,length_meters:n[10].properties.length_meters};return n[10].properties.name!==void 0&&(g.name=n[10].properties.name),n[10].properties.intervention_type!==void 0&&(g.intervention_type=n[10].properties.intervention_type),n[10].properties.description!==void 0&&(g.description=n[10].properties.description),e=new Lu({props:g}),Be.push(()=>wt(e,"name",u,n[10].properties.name)),Be.push(()=>wt(e,"intervention_type",d,n[10].properties.intervention_type)),Be.push(()=>wt(e,"description",f,n[10].properties.description)),{c(){be(e.$$.fragment),s=J()},m(b,p){ve(e,b,p),L(b,s,p),a=!0},p(b,p){n=b;const h={};p&1&&(h.id=n[10].id),p&1&&(h.length_meters=n[10].properties.length_meters),!t&&p&1&&(t=!0,h.name=n[10].properties.name,St(()=>t=!1)),!r&&p&1&&(r=!0,h.intervention_type=n[10].properties.intervention_type,St(()=>r=!1)),!o&&p&1&&(o=!0,h.description=n[10].properties.description,St(()=>o=!1)),e.$set(h)},i(b){a||(V(e.$$.fragment,b),a=!0)},o(b){X(e.$$.fragment,b),a=!1},d(b){_e(e,b),b&&x(s)}}}function ls(n,e){let t,r,o;function s(){return e[6](e[10])}return r=new Au({props:{id:e[10].id,label:as(e[10]),$$slots:{default:[Nu]},$$scope:{ctx:e}}}),r.$on("mouseenter",s),r.$on("mouseleave",e[7]),{key:n,first:null,c(){t=cn(),be(r.$$.fragment),this.first=t},m(a,u){L(a,t,u),ve(r,a,u),o=!0},p(a,u){e=a;const d={};u&1&&(d.id=e[10].id),u&1&&(d.label=as(e[10])),u&8193&&(d.$$scope={dirty:u,ctx:e}),r.$set(d)},i(a){o||(V(r.$$.fragment,a),o=!0)},o(a){X(r.$$.fragment,a),o=!1},d(a){a&&x(t),_e(r,a)}}}function Ru(n){let e=[],t=new Map,r,o,s,a,u=n[0].features;const d=f=>f[10].id;for(let f=0;f<u.length;f+=1){let g=ss(n,u,f),b=d(g);t.set(b,e[f]=ls(b,g))}return{c(){for(let f=0;f<e.length;f+=1)e[f].c();r=cn()},m(f,g){for(let b=0;b<e.length;b+=1)e[b].m(f,g);L(f,r,g),o=!0,s||(a=le(window,"keydown",n[2]),s=!0)},p(f,[g]){g&3&&(u=f[0].features,rt(),e=Nl(e,g,d,1,f,u,t,r.parentNode,Rl,ls,r,ss),it())},i(f){if(!o){for(let g=0;g<u.length;g+=1)V(e[g]);o=!0}},o(f){for(let g=0;g<e.length;g+=1)X(e[g]);o=!1},d(f){for(let g=0;g<e.length;g+=1)e[g].d(f);f&&x(r),s=!1,a()}}}function as(n){if(n.properties.name)return n.properties.name;var e=n.properties.intervention_type;return e=="other"&&(n.geometry.type=="Point"?e="point":n.geometry.type=="LineString"?e="line":e="polygon"),`Untitled ${e}`}function Fu(n,e,t){let r,o;Ye(n,ft,p=>t(8,r=p)),Ye(n,je,p=>t(0,o=p));function s(p){r==null&&_t.set(p)}function a(p){if(p.key=="Delete"){const h=p.originalTarget.tagName;if(h=="INPUT"||h=="TEXTAREA")return;p.preventDefault();const m=r;m&&(je.update(E=>(E.features=E.features.filter(M=>M.id!=m),E)),ft.set(null))}}function u(p,h){n.$$.not_equal(h.properties.name,p)&&(h.properties.name=p,je.set(o))}function d(p,h){n.$$.not_equal(h.properties.intervention_type,p)&&(h.properties.intervention_type=p,je.set(o))}function f(p,h){n.$$.not_equal(h.properties.description,p)&&(h.properties.description=p,je.set(o))}return[o,s,a,u,d,f,p=>s(p.id),()=>s(null)]}class Du extends Le{constructor(e){super(),xe(this,e,Fu,Ru,Pe,{})}}function us(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Uu(n,e,t){t===void 0&&(t={});var r=us(n),o=us(e),s=wr(o[1]-r[1]),a=wr(o[0]-r[0]),u=wr(r[1]),d=wr(o[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(u)*Math.cos(d);return Qa(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),t.units)}function Os(n,e,t){if(n!==null)for(var r,o,s,a,u,d,f,g=0,b=0,p,h=n.type,m=h==="FeatureCollection",E=h==="Feature",M=m?n.features.length:1,z=0;z<M;z++){f=m?n.features[z].geometry:E?n.geometry:n,p=f?f.type==="GeometryCollection":!1,u=p?f.geometries.length:1;for(var D=0;D<u;D++){var O=0,j=0;if(a=p?f.geometries[D]:f,a!==null){d=a.coordinates;var B=a.type;switch(g=t&&(B==="Polygon"||B==="MultiPolygon")?1:0,B){case null:break;case"Point":if(e(d,b,z,O,j)===!1)return!1;b++,O++;break;case"LineString":case"MultiPoint":for(r=0;r<d.length;r++){if(e(d[r],b,z,O,j)===!1)return!1;b++,B==="MultiPoint"&&O++}B==="LineString"&&O++;break;case"Polygon":case"MultiLineString":for(r=0;r<d.length;r++){for(o=0;o<d[r].length-g;o++){if(e(d[r][o],b,z,O,j)===!1)return!1;b++}B==="MultiLineString"&&O++,B==="Polygon"&&j++}B==="Polygon"&&O++;break;case"MultiPolygon":for(r=0;r<d.length;r++){for(j=0,o=0;o<d[r].length;o++){for(s=0;s<d[r][o].length-g;s++){if(e(d[r][o][s],b,z,O,j)===!1)return!1;b++}j++}O++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(Os(a.geometries[r],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ju(n,e){var t,r,o,s,a,u,d,f,g,b,p=0,h=n.type==="FeatureCollection",m=n.type==="Feature",E=h?n.features.length:1;for(t=0;t<E;t++){for(u=h?n.features[t].geometry:m?n.geometry:n,f=h?n.features[t].properties:m?n.properties:{},g=h?n.features[t].bbox:m?n.bbox:void 0,b=h?n.features[t].id:m?n.id:void 0,d=u?u.type==="GeometryCollection":!1,a=d?u.geometries.length:1,o=0;o<a;o++){if(s=d?u.geometries[o]:u,s===null){if(e(null,p,f,g,b)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,p,f,g,b)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(e(s.geometries[r],p,f,g,b)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}p++}}function Bu(n,e){ju(n,function(t,r,o,s,a){var u=t===null?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return e(Vn(t,o,{bbox:s,id:a}),r,0)===!1?!1:void 0}var d;switch(u){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon";break}for(var f=0;f<t.coordinates.length;f++){var g=t.coordinates[f],b={type:d,coordinates:g};if(e(Vn(b,o),r,f)===!1)return!1}})}function Gu(n,e){Bu(n,function(t,r,o){var s=0;if(t.geometry){var a=t.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var u,d=0,f=0,g=0;if(Os(t,function(b,p,h,m,E){if(u===void 0||r>d||m>f||E>g){u=b,d=r,f=m,g=E,s=0;return}var M=Xa([u,b],t.properties);if(e(M,r,o,E,s)===!1)return!1;s++,u=b})===!1)return!1}}})}function Vu(n,e,t){var r=t,o=!1;return Gu(n,function(s,a,u,d,f){o===!1&&t===void 0?r=s:r=e(r,s,a,u,d,f),o=!0}),r}function zu(n,e){return e===void 0&&(e={}),Vu(n,function(t,r){var o=r.geometry.coordinates;return t+Uu(o[0],o[1],e)},0)}function qu(n){let e,t,r,o,s,a,u,d,f,g,b,p,h,m,E,M,z,D,O,j=n[0].features.length+"",B,N,he,ee,oe,H,I,te;return{c(){e=R("div"),t=R("label"),r=ge(`Scheme name:
    `),o=R("input"),s=J(),a=R("br"),u=J(),d=R("div"),f=R("label"),g=R("input"),b=J(),p=R("button"),p.textContent="Load from GeoJSON",h=J(),m=R("button"),m.textContent="Export to GeoJSON",E=J(),M=R("br"),z=J(),D=R("div"),O=R("span"),B=ge(j),N=ge(" interventions"),he=J(),ee=R("button"),oe=ge("Clear all"),U(o,"type","text"),U(g,"type","file"),U(g,"id","load_geojson"),U(g,"class","svelte-lhyd1e"),U(p,"type","button"),U(p,"onclick","document.getElementById('load_geojson').click();"),U(m,"type","button"),U(m,"class","align-right svelte-lhyd1e"),U(ee,"type","button"),U(ee,"class","align-right svelte-lhyd1e"),ee.disabled=H=n[0].features.length==0},m($,re){L($,e,re),k(e,t),k(t,r),k(t,o),Sn(o,n[0].scheme_name),L($,s,re),L($,a,re),L($,u,re),L($,d,re),k(d,f),k(f,g),k(f,b),k(f,p),k(d,h),k(d,m),L($,E,re),L($,M,re),L($,z,re),L($,D,re),k(D,O),k(O,B),k(O,N),k(D,he),k(D,ee),k(ee,oe),I||(te=[le(o,"input",n[5]),le(g,"change",n[3]),le(m,"click",n[2]),le(ee,"click",n[1])],I=!0)},p($,[re]){re&1&&o.value!==$[0].scheme_name&&Sn(o,$[0].scheme_name),re&1&&j!==(j=$[0].features.length+"")&&Ve(B,j),re&1&&H!==(H=$[0].features.length==0)&&(ee.disabled=H)},i:Ie,o:Ie,d($){$&&x(e),$&&x(s),$&&x(a),$&&x(u),$&&x(d),$&&x(E),$&&x(M),$&&x(z),$&&x(D),I=!1,Ct(te)}}}function Ju(n,e){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(e)),t.setAttribute("download",n),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Yu(n,e,t){let r;Ye(n,je,p=>t(0,r=p));let{authorityName:o}=e,s=window.localStorage.getItem(o);if(s)try{je.set(g(JSON.parse(s)))}catch(p){console.log(`Failed to load from local storage: ${p}`)}function a(){confirm("Do you want to clear the current scheme? (You should save it first!)")&&je.update(p=>(delete p.scheme_name,p.features=[],p))}function u(){const p=JSON.parse(JSON.stringify(r));for(let h of p.features)delete h.properties.editing,delete h.properties.hide_while_editing;return p}function d(){let p=u();var h=o;p.authority=o,p.origin="atip-v1",p.scheme_name&&(h+="_"+p.scheme_name),h+=".txt",Ju(h,JSON.stringify(p,null,"  "))}function f(p){const h=new FileReader;h.onload=m=>{try{je.set(g(JSON.parse(m.target.result)))}catch(E){window.alert(`Couldn't load scheme from a file: ${E}`)}},h.readAsText(p.target.files[0])}function g(p){let h=1;for(let m of p.features)m.geometry.type=="LineString"&&!m.properties.length_meters&&(m.properties.length_meters=zu(m.geometry,{units:"kilometers"})*1e3),m.id=h++;return p}function b(){r.scheme_name=this.value,je.set(r)}return n.$$set=p=>{"authorityName"in p&&t(4,o=p.authorityName)},n.$$.update=()=>{n.$$.dirty&17&&r&&(console.log("GJ changed, saving to local storage"),window.localStorage.setItem(o,JSON.stringify(u())))},[r,a,d,f,o,b]}class Wu extends Le{constructor(e){super(),xe(this,e,Yu,qu,Pe,{authorityName:4})}}const Hu="/atip/accordion/assets/zoom_out_map-b2e1091a.svg";function Zu(n){let e,t,r,o,s;return{c(){e=R("button"),t=R("img"),Fl(t.src,r=Hu)||U(t,"src",r),U(t,"alt","Zoom to show entire boundary"),U(e,"type","button"),U(e,"title","Zoom to show entire boundary"),U(e,"class","svelte-qzjsqo")},m(a,u){L(a,e,u),k(e,t),o||(s=le(e,"click",n[0]),o=!0)},p:Ie,i:Ie,o:Ie,d(a){a&&x(e),o=!1,s()}}}function Xu(n,e,t){let r;Ye(n,Nt,a=>t(2,r=a));let{boundaryGeojson:o}=e;function s(){r.fitBounds(bi(o),{padding:20,animate:!0,duration:500})}return n.$$set=a=>{"boundaryGeojson"in a&&t(1,o=a.boundaryGeojson)},[s,o]}class Ku extends Le{constructor(e){super(),xe(this,e,Xu,Zu,Pe,{boundaryGeojson:1})}}function Qu(n){let e,t,r,o,s,a,u;return{c(){e=R("div"),t=ge(`Basemap:
  `),r=R("select"),o=R("option"),o.textContent="Streets",s=R("option"),s.textContent="Satellite",o.__value="streets",o.value=o.__value,s.__value="hybrid",s.value=s.__value,n[0]===void 0&&vs(()=>n[2].call(r)),U(e,"class","svelte-1tbnm6i")},m(d,f){L(d,e,f),k(e,t),k(e,r),k(r,o),k(r,s),ho(r,n[0]),a||(u=[le(r,"change",n[2]),le(r,"change",n[1])],a=!0)},p(d,[f]){f&1&&ho(r,d[0])},i:Ie,o:Ie,d(d){d&&x(e),a=!1,Ct(u)}}}function $u(n,e,t){let{style:r}=e;function o(){let a=new URLSearchParams(window.location.search);a.set("style",r);let u=`${window.location.pathname}?${a.toString()}${window.location.hash}`;window.location.href=u}function s(){r=Dl(this),t(0,r)}return n.$$set=a=>{"style"in a&&t(0,r=a.style)},[r,o,s]}class ef extends Le{constructor(e){super(),xe(this,e,$u,Qu,Pe,{style:0})}}const Et={area:"#e41a1c",route:"#377eb8",crossing:"#4daf4a",other:"#984ea3",hovering:"black"},Is=10,fi=10;function tf(n){let e,t,r,o,s,a,u,d,f,g,b,p,h,m,E,M,z,D,O;return{c(){e=R("div"),t=R("h1"),t.textContent="Interventions",r=J(),o=R("ul"),s=R("li"),a=R("span"),u=ge("Areas"),d=J(),f=R("li"),g=R("span"),b=ge("Routes"),p=J(),h=R("li"),m=R("span"),E=ge("Crossings"),M=J(),z=R("li"),D=R("span"),O=ge("Other"),U(t,"class","svelte-p551i1"),U(a,"class","svelte-p551i1"),Un(a,"background",Et.area),U(g,"class","svelte-p551i1"),Un(g,"background",Et.route),U(m,"class","svelte-p551i1"),Un(m,"background",Et.crossing),U(D,"class","svelte-p551i1"),Un(D,"background",Et.other),U(e,"class","svelte-p551i1")},m(j,B){L(j,e,B),k(e,t),k(e,r),k(e,o),k(o,s),k(s,a),k(s,u),k(o,d),k(o,f),k(f,g),k(f,b),k(o,p),k(o,h),k(h,m),k(h,E),k(o,M),k(o,z),k(z,D),k(z,O)},p:Ie,i:Ie,o:Ie,d(j){j&&x(e)}}}class nf extends Le{constructor(e){super(),xe(this,e,null,tf,Pe,{})}}let Dn="interventions";function rf(n,e,t){let r,o;Ye(n,Nt,u=>t(0,r=u)),Ye(n,je,u=>t(1,o=u)),_i(r,Dn,{type:"geojson",data:o});const s=["match",["get","intervention_type"],"area",Et.area,"route",Et.route,"crossing",Et.crossing,"other",Et.other,"white"],a=["!=","hide_while_editing",!0];return un(r,{id:"interventions-points",source:Dn,filter:["all",Cs,a],...Ms(s,Is)}),un(r,{id:"interventions-lines",source:Dn,filter:["all",Ts,a],...ui(s,fi)}),un(r,{id:"interventions-polygons",source:Dn,filter:["all",Ss,a],...ks(s,.5)},"hover-polygons"),n.$$.update=()=>{n.$$.dirty&3&&r.getSource(Dn).setData(o)},[r,o]}class of extends Le{constructor(e){super(),xe(this,e,rf,null,Pe,{})}}let _n="hover";function sf(n,e,t){let r,o;return Ye(n,Nt,s=>t(0,r=s)),Ye(n,je,s=>t(1,o=s)),_i(r,_n,{type:"geojson",data:ni()}),un(r,{id:"hover-polygons",source:_n,filter:Ss,...ui(Et.hovering,.5*fi,1)}),un(r,{id:"hover-lines",source:_n,filter:Ts,...ui(Et.hovering,1.5*fi,1)},"interventions-lines"),un(r,{id:"hover-points",source:_n,filter:Cs,...Ms(Et.hovering,1.5*Is,1)},"interventions-points"),_t.subscribe(s=>{s!=null?r.getSource(_n).setData(o.features.find(a=>a.id==s)):r.getSource(_n).setData(ni())}),[]}class lf extends Le{constructor(e){super(),xe(this,e,sf,null,Pe,{})}}var ci={},af={get exports(){return ci},set exports(n){ci=n}};(function(n,e){(function(t,r){n.exports=r()})(Rn,function(){var t=function(i,l){var c={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},v={on:function(y,w,F){if(c[y]===void 0)throw new Error("Invalid event type: "+y);c[y].push({selector:w,fn:F})},render:function(y){l.store.featureChanged(y)}},_=function(y,w){for(var F=c[y],G=F.length;G--;){var Z=F[G];if(Z.selector(w)){Z.fn.call(v,w)||l.store.render(),l.ui.updateMapClasses();break}}};return i.start.call(v),{render:i.render,stop:function(){i.stop&&i.stop()},trash:function(){i.trash&&(i.trash(),l.store.render())},combineFeatures:function(){i.combineFeatures&&i.combineFeatures()},uncombineFeatures:function(){i.uncombineFeatures&&i.uncombineFeatures()},drag:function(y){_("drag",y)},click:function(y){_("click",y)},mousemove:function(y){_("mousemove",y)},mousedown:function(y){_("mousedown",y)},mouseup:function(y){_("mouseup",y)},mouseout:function(y){_("mouseout",y)},keydown:function(y){_("keydown",y)},keyup:function(y){_("keyup",y)},touchstart:function(y){_("touchstart",y)},touchmove:function(y){_("touchmove",y)},touchend:function(y){_("touchend",y)},tap:function(y){_("tap",y)}}};function r(i){if(i.__esModule)return i;var l=i.default;if(typeof l=="function"){var c=function v(){if(this instanceof v){var _=[null];_.push.apply(_,arguments);var y=Function.bind.apply(l,_);return new y}return l.apply(this,arguments)};c.prototype=l.prototype}else c={};return Object.defineProperty(c,"__esModule",{value:!0}),Object.keys(i).forEach(function(v){var _=Object.getOwnPropertyDescriptor(i,v);Object.defineProperty(c,v,_.get?_:{enumerable:!0,get:function(){return i[v]}})}),c}var o={},s={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},a=s;function u(i){var l=0;if(i&&i.length>0){l+=Math.abs(d(i[0]));for(var c=1;c<i.length;c++)l-=Math.abs(d(i[c]))}return l}function d(i){var l,c,v,_,y,w,F=0,G=i.length;if(G>2){for(w=0;w<G;w++)w===G-2?(v=G-2,_=G-1,y=0):w===G-1?(v=G-1,_=0,y=1):(v=w,_=w+1,y=w+2),l=i[v],c=i[_],F+=(f(i[y][0])-f(l[0]))*Math.sin(f(c[1]));F=F*a.RADIUS*a.RADIUS/2}return F}function f(i){return i*Math.PI/180}o.geometry=function i(l){var c,v=0;switch(l.type){case"Polygon":return u(l.coordinates);case"MultiPolygon":for(c=0;c<l.coordinates.length;c++)v+=u(l.coordinates[c]);return v;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(c=0;c<l.geometries.length;c++)v+=i(l.geometries[c]);return v}},o.ring=d;var g={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},b={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},p={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},h={POLYGON:"polygon",LINE:"line_string",POINT:"point"},m={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},E={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},M={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},z={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},D={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},O={ACTIVE:"true",INACTIVE:"false"},j=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],B=-85,N=Object.freeze({__proto__:null,classes:g,sources:b,cursors:p,types:h,geojsonTypes:m,modes:E,events:M,updateActions:z,meta:D,activeStates:O,interactions:j,LAT_MIN:-90,LAT_RENDERED_MIN:B,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),he={Point:0,LineString:1,MultiLineString:1,Polygon:2};function ee(i,l){var c=he[i.geometry.type]-he[l.geometry.type];return c===0&&i.geometry.type===m.POLYGON?i.area-l.area:c}function oe(i){return i.map(function(l){return l.geometry.type===m.POLYGON&&(l.area=o.geometry({type:m.FEATURE,property:{},geometry:l.geometry})),l}).sort(ee).map(function(l){return delete l.area,l})}function H(i,l){return l===void 0&&(l=0),[[i.point.x-l,i.point.y-l],[i.point.x+l,i.point.y+l]]}function I(i){if(this._items={},this._nums={},this._length=i?i.length:0,i)for(var l=0,c=i.length;l<c;l++)this.add(i[l]),i[l]!==void 0&&(typeof i[l]=="string"?this._items[i[l]]=l:this._nums[i[l]]=l)}I.prototype.add=function(i){return this.has(i)||(this._length++,typeof i=="string"?this._items[i]=this._length:this._nums[i]=this._length),this},I.prototype.delete=function(i){return this.has(i)===!1||(this._length--,delete this._items[i],delete this._nums[i]),this},I.prototype.has=function(i){return(typeof i=="string"||typeof i=="number")&&(this._items[i]!==void 0||this._nums[i]!==void 0)},I.prototype.values=function(){var i=this,l=[];return Object.keys(this._items).forEach(function(c){l.push({k:c,v:i._items[c]})}),Object.keys(this._nums).forEach(function(c){l.push({k:JSON.parse(c),v:i._nums[c]})}),l.sort(function(c,v){return c.v-v.v}).map(function(c){return c.k})},I.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var te=[D.FEATURE,D.MIDPOINT,D.VERTEX],$={click:function(i,l,c){return re(i,l,c,c.options.clickBuffer)},touch:function(i,l,c){return re(i,l,c,c.options.touchBuffer)}};function re(i,l,c,v){if(c.map===null)return[];var _=i?H(i,v):l,y={};c.options.styles&&(y.layers=c.options.styles.map(function(Z){return Z.id}));var w=c.map.queryRenderedFeatures(_,y).filter(function(Z){return te.indexOf(Z.properties.meta)!==-1}),F=new I,G=[];return w.forEach(function(Z){var W=Z.properties.id;F.has(W)||(F.add(W),G.push(Z))}),oe(G)}function K(i,l){var c=$.click(i,null,l),v={mouse:p.NONE};return c[0]&&(v.mouse=c[0].properties.active===O.ACTIVE?p.MOVE:p.POINTER,v.feature=c[0].properties.meta),l.events.currentModeName().indexOf("draw")!==-1&&(v.mouse=p.ADD),l.ui.queueMapClasses(v),l.ui.updateMapClasses(),c[0]}function fe(i,l){var c=i.x-l.x,v=i.y-l.y;return Math.sqrt(c*c+v*v)}function we(i,l,c){c===void 0&&(c={});var v=c.fineTolerance!=null?c.fineTolerance:4,_=c.grossTolerance!=null?c.grossTolerance:12,y=c.interval!=null?c.interval:500;i.point=i.point||l.point,i.time=i.time||l.time;var w=fe(i.point,l.point);return w<v||w<_&&l.time-i.time<y}function Te(i,l,c){c===void 0&&(c={});var v=c.tolerance!=null?c.tolerance:25,_=c.interval!=null?c.interval:250;return i.point=i.point||l.point,i.time=i.time||l.time,fe(i.point,l.point)<v&&l.time-i.time<_}var Ce={},Fe={get exports(){return Ce},set exports(i){Ce=i}}.exports=function(i,l){if(l||(l=16),i===void 0&&(i=128),i<=0)return"0";for(var c=Math.log(Math.pow(2,i))/Math.log(l),v=2;c===1/0;v*=2)c=Math.log(Math.pow(2,i/v))/Math.log(l)*v;var _=c-Math.floor(c),y="";for(v=0;v<Math.floor(c);v++)y=Math.floor(Math.random()*l).toString(l)+y;if(_){var w=Math.pow(l,_);y=Math.floor(Math.random()*w).toString(l)+y}var F=parseInt(y,l);return F!==1/0&&F>=Math.pow(2,i)?Fe(i,l):y};Fe.rack=function(i,l,c){var v=function(y){var w=0;do{if(w++>10){if(!c)throw new Error("too many ID collisions, use more bits");i+=c}var F=Fe(i,l)}while(Object.hasOwnProperty.call(_,F));return _[F]=y,F},_=v.hats={};return v.get=function(y){return v.hats[y]},v.set=function(y,w){return v.hats[y]=w,v},v.bits=i||128,v.base=l||16,v};var ae=function(i,l){this.ctx=i,this.properties=l.properties||{},this.coordinates=l.geometry.coordinates,this.id=l.id||Ce(),this.type=l.geometry.type};ae.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},ae.prototype.incomingCoords=function(i){this.setCoordinates(i)},ae.prototype.setCoordinates=function(i){this.coordinates=i,this.changed()},ae.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},ae.prototype.setProperty=function(i,l){this.properties[i]=l},ae.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:m.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},ae.prototype.internal=function(i){var l={id:this.id,meta:D.FEATURE,"meta:type":this.type,active:O.INACTIVE,mode:i};if(this.ctx.options.userProperties)for(var c in this.properties)l["user_"+c]=this.properties[c];return{type:m.FEATURE,properties:l,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var T=function(i,l){ae.call(this,i,l)};(T.prototype=Object.create(ae.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},T.prototype.updateCoordinate=function(i,l,c){this.coordinates=arguments.length===3?[l,c]:[i,l],this.changed()},T.prototype.getCoordinate=function(){return this.getCoordinates()};var de=function(i,l){ae.call(this,i,l)};(de.prototype=Object.create(ae.prototype)).isValid=function(){return this.coordinates.length>1},de.prototype.addCoordinate=function(i,l,c){this.changed();var v=parseInt(i,10);this.coordinates.splice(v,0,[l,c])},de.prototype.getCoordinate=function(i){var l=parseInt(i,10);return JSON.parse(JSON.stringify(this.coordinates[l]))},de.prototype.removeCoordinate=function(i){this.changed(),this.coordinates.splice(parseInt(i,10),1)},de.prototype.updateCoordinate=function(i,l,c){var v=parseInt(i,10);this.coordinates[v]=[l,c],this.changed()};var $e=function(i,l){ae.call(this,i,l),this.coordinates=this.coordinates.map(function(c){return c.slice(0,-1)})};($e.prototype=Object.create(ae.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(i){return i.length>2})},$e.prototype.incomingCoords=function(i){this.coordinates=i.map(function(l){return l.slice(0,-1)}),this.changed()},$e.prototype.setCoordinates=function(i){this.coordinates=i,this.changed()},$e.prototype.addCoordinate=function(i,l,c){this.changed();var v=i.split(".").map(function(_){return parseInt(_,10)});this.coordinates[v[0]].splice(v[1],0,[l,c])},$e.prototype.removeCoordinate=function(i){this.changed();var l=i.split(".").map(function(v){return parseInt(v,10)}),c=this.coordinates[l[0]];c&&(c.splice(l[1],1),c.length<3&&this.coordinates.splice(l[0],1))},$e.prototype.getCoordinate=function(i){var l=i.split(".").map(function(v){return parseInt(v,10)}),c=this.coordinates[l[0]];return JSON.parse(JSON.stringify(c[l[1]]))},$e.prototype.getCoordinates=function(){return this.coordinates.map(function(i){return i.concat([i[0]])})},$e.prototype.updateCoordinate=function(i,l,c){this.changed();var v=i.split("."),_=parseInt(v[0],10),y=parseInt(v[1],10);this.coordinates[_]===void 0&&(this.coordinates[_]=[]),this.coordinates[_][y]=[l,c]};var Tn={MultiPoint:T,MultiLineString:de,MultiPolygon:$e},kt=function(i,l,c,v,_){var y=c.split("."),w=parseInt(y[0],10),F=y[1]?y.slice(1).join("."):null;return i[w][l](F,v,_)},ue=function(i,l){if(ae.call(this,i,l),delete this.coordinates,this.model=Tn[l.geometry.type],this.model===void 0)throw new TypeError(l.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(l.geometry.coordinates)};function ie(i){this.map=i.map,this.drawConfig=JSON.parse(JSON.stringify(i.options||{})),this._ctx=i}(ue.prototype=Object.create(ae.prototype))._coordinatesToFeatures=function(i){var l=this,c=this.model.bind(this);return i.map(function(v){return new c(l.ctx,{id:Ce(),type:m.FEATURE,properties:{},geometry:{coordinates:v,type:l.type.replace("Multi","")}})})},ue.prototype.isValid=function(){return this.features.every(function(i){return i.isValid()})},ue.prototype.setCoordinates=function(i){this.features=this._coordinatesToFeatures(i),this.changed()},ue.prototype.getCoordinate=function(i){return kt(this.features,"getCoordinate",i)},ue.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(i){return i.type===m.POLYGON?i.getCoordinates():i.coordinates})))},ue.prototype.updateCoordinate=function(i,l,c){kt(this.features,"updateCoordinate",i,l,c),this.changed()},ue.prototype.addCoordinate=function(i,l,c){kt(this.features,"addCoordinate",i,l,c),this.changed()},ue.prototype.removeCoordinate=function(i){kt(this.features,"removeCoordinate",i),this.changed()},ue.prototype.getFeatures=function(){return this.features},ie.prototype.setSelected=function(i){return this._ctx.store.setSelected(i)},ie.prototype.setSelectedCoordinates=function(i){var l=this;this._ctx.store.setSelectedCoordinates(i),i.reduce(function(c,v){return c[v.feature_id]===void 0&&(c[v.feature_id]=!0,l._ctx.store.get(v.feature_id).changed()),c},{})},ie.prototype.getSelected=function(){return this._ctx.store.getSelected()},ie.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},ie.prototype.isSelected=function(i){return this._ctx.store.isSelected(i)},ie.prototype.getFeature=function(i){return this._ctx.store.get(i)},ie.prototype.select=function(i){return this._ctx.store.select(i)},ie.prototype.deselect=function(i){return this._ctx.store.deselect(i)},ie.prototype.deleteFeature=function(i,l){return l===void 0&&(l={}),this._ctx.store.delete(i,l)},ie.prototype.addFeature=function(i){return this._ctx.store.add(i)},ie.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},ie.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},ie.prototype.setActionableState=function(i){i===void 0&&(i={});var l={trash:i.trash||!1,combineFeatures:i.combineFeatures||!1,uncombineFeatures:i.uncombineFeatures||!1};return this._ctx.events.actionable(l)},ie.prototype.changeMode=function(i,l,c){return l===void 0&&(l={}),c===void 0&&(c={}),this._ctx.events.changeMode(i,l,c)},ie.prototype.updateUIClasses=function(i){return this._ctx.ui.queueMapClasses(i)},ie.prototype.activateUIButton=function(i){return this._ctx.ui.setActiveButton(i)},ie.prototype.featuresAt=function(i,l,c){if(c===void 0&&(c="click"),c!=="click"&&c!=="touch")throw new Error("invalid buffer type");return $[c](i,l,this._ctx)},ie.prototype.newFeature=function(i){var l=i.geometry.type;return l===m.POINT?new T(this._ctx,i):l===m.LINE_STRING?new de(this._ctx,i):l===m.POLYGON?new $e(this._ctx,i):new ue(this._ctx,i)},ie.prototype.isInstanceOf=function(i,l){if(i===m.POINT)return l instanceof T;if(i===m.LINE_STRING)return l instanceof de;if(i===m.POLYGON)return l instanceof $e;if(i==="MultiFeature")return l instanceof ue;throw new Error("Unknown feature class: "+i)},ie.prototype.doRender=function(i){return this._ctx.store.featureChanged(i)},ie.prototype.onSetup=function(){},ie.prototype.onDrag=function(){},ie.prototype.onClick=function(){},ie.prototype.onMouseMove=function(){},ie.prototype.onMouseDown=function(){},ie.prototype.onMouseUp=function(){},ie.prototype.onMouseOut=function(){},ie.prototype.onKeyUp=function(){},ie.prototype.onKeyDown=function(){},ie.prototype.onTouchStart=function(){},ie.prototype.onTouchMove=function(){},ie.prototype.onTouchEnd=function(){},ie.prototype.onTap=function(){},ie.prototype.onStop=function(){},ie.prototype.onTrash=function(){},ie.prototype.onCombineFeature=function(){},ie.prototype.onUncombineFeature=function(){},ie.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Q={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Cn=Object.keys(Q);function kn(i){var l=Object.keys(i);return function(c,v){v===void 0&&(v={});var _={},y=l.reduce(function(w,F){return w[F]=i[F],w},new ie(c));return{start:function(){var w=this;_=y.onSetup(v),Cn.forEach(function(F){var G,Z=Q[F],W=function(){return!1};i[Z]&&(W=function(){return!0}),w.on(F,W,(G=Z,function(q){return y[G](_,q)}))})},stop:function(){y.onStop(_)},trash:function(){y.onTrash(_)},combineFeatures:function(){y.onCombineFeatures(_)},uncombineFeatures:function(){y.onUncombineFeatures(_)},render:function(w,F){y.toDisplayFeatures(_,w,F)}}}}function mt(i){return[].concat(i).filter(function(l){return l!==void 0})}function Ns(){var i=this;if(!(i.ctx.map&&i.ctx.map.getSource(b.HOT)!==void 0))return G();var l=i.ctx.events.currentModeName();i.ctx.ui.queueMapClasses({mode:l});var c=[],v=[];i.isDirty?v=i.getAllIds():(c=i.getChangedIds().filter(function(Z){return i.get(Z)!==void 0}),v=i.sources.hot.filter(function(Z){return Z.properties.id&&c.indexOf(Z.properties.id)===-1&&i.get(Z.properties.id)!==void 0}).map(function(Z){return Z.properties.id})),i.sources.hot=[];var _=i.sources.cold.length;i.sources.cold=i.isDirty?[]:i.sources.cold.filter(function(Z){var W=Z.properties.id||Z.properties.parent;return c.indexOf(W)===-1});var y=_!==i.sources.cold.length||v.length>0;function w(Z,W){var q=i.get(Z).internal(l);i.ctx.events.currentModeRender(q,function(ce){i.sources[W].push(ce)})}if(c.forEach(function(Z){return w(Z,"hot")}),v.forEach(function(Z){return w(Z,"cold")}),y&&i.ctx.map.getSource(b.COLD).setData({type:m.FEATURE_COLLECTION,features:i.sources.cold}),i.ctx.map.getSource(b.HOT).setData({type:m.FEATURE_COLLECTION,features:i.sources.hot}),i._emitSelectionChange&&(i.ctx.map.fire(M.SELECTION_CHANGE,{features:i.getSelected().map(function(Z){return Z.toGeoJSON()}),points:i.getSelectedCoordinates().map(function(Z){return{type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:Z.coordinates}}})}),i._emitSelectionChange=!1),i._deletedFeaturesToEmit.length){var F=i._deletedFeaturesToEmit.map(function(Z){return Z.toGeoJSON()});i._deletedFeaturesToEmit=[],i.ctx.map.fire(M.DELETE,{features:F})}function G(){i.isDirty=!1,i.clearChangedIds()}G(),i.ctx.map.fire(M.RENDER,{})}function Ae(i){var l,c=this;this._features={},this._featureIds=new I,this._selectedFeatureIds=new I,this._selectedCoordinates=[],this._changedFeatureIds=new I,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=i,this.sources={hot:[],cold:[]},this.render=function(){l||(l=requestAnimationFrame(function(){l=null,Ns.call(c)}))},this.isDirty=!1}function yi(i,l){var c=i._selectedCoordinates.filter(function(v){return i._selectedFeatureIds.has(v.feature_id)});i._selectedCoordinates.length===c.length||l.silent||(i._emitSelectionChange=!0),i._selectedCoordinates=c}Ae.prototype.createRenderBatch=function(){var i=this,l=this.render,c=0;return this.render=function(){c++},function(){i.render=l,c>0&&i.render()}},Ae.prototype.setDirty=function(){return this.isDirty=!0,this},Ae.prototype.featureChanged=function(i){return this._changedFeatureIds.add(i),this},Ae.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Ae.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Ae.prototype.getAllIds=function(){return this._featureIds.values()},Ae.prototype.add=function(i){return this.featureChanged(i.id),this._features[i.id]=i,this._featureIds.add(i.id),this},Ae.prototype.delete=function(i,l){var c=this;return l===void 0&&(l={}),mt(i).forEach(function(v){c._featureIds.has(v)&&(c._featureIds.delete(v),c._selectedFeatureIds.delete(v),l.silent||c._deletedFeaturesToEmit.indexOf(c._features[v])===-1&&c._deletedFeaturesToEmit.push(c._features[v]),delete c._features[v],c.isDirty=!0)}),yi(this,l),this},Ae.prototype.get=function(i){return this._features[i]},Ae.prototype.getAll=function(){var i=this;return Object.keys(this._features).map(function(l){return i._features[l]})},Ae.prototype.select=function(i,l){var c=this;return l===void 0&&(l={}),mt(i).forEach(function(v){c._selectedFeatureIds.has(v)||(c._selectedFeatureIds.add(v),c._changedFeatureIds.add(v),l.silent||(c._emitSelectionChange=!0))}),this},Ae.prototype.deselect=function(i,l){var c=this;return l===void 0&&(l={}),mt(i).forEach(function(v){c._selectedFeatureIds.has(v)&&(c._selectedFeatureIds.delete(v),c._changedFeatureIds.add(v),l.silent||(c._emitSelectionChange=!0))}),yi(this,l),this},Ae.prototype.clearSelected=function(i){return i===void 0&&(i={}),this.deselect(this._selectedFeatureIds.values(),{silent:i.silent}),this},Ae.prototype.setSelected=function(i,l){var c=this;return l===void 0&&(l={}),i=mt(i),this.deselect(this._selectedFeatureIds.values().filter(function(v){return i.indexOf(v)===-1}),{silent:l.silent}),this.select(i.filter(function(v){return!c._selectedFeatureIds.has(v)}),{silent:l.silent}),this},Ae.prototype.setSelectedCoordinates=function(i){return this._selectedCoordinates=i,this._emitSelectionChange=!0,this},Ae.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Ae.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Ae.prototype.getSelected=function(){var i=this;return this._selectedFeatureIds.values().map(function(l){return i.get(l)})},Ae.prototype.getSelectedCoordinates=function(){var i=this;return this._selectedCoordinates.map(function(l){return{coordinates:i.get(l.feature_id).getCoordinate(l.coord_path)}})},Ae.prototype.isSelected=function(i){return this._selectedFeatureIds.has(i)},Ae.prototype.setFeatureProperty=function(i,l,c){this.get(i).setProperty(l,c),this.featureChanged(i)},Ae.prototype.storeMapConfig=function(){var i=this;j.forEach(function(l){i.ctx.map[l]&&(i._mapInitialConfig[l]=i.ctx.map[l].isEnabled())})},Ae.prototype.restoreMapConfig=function(){var i=this;Object.keys(this._mapInitialConfig).forEach(function(l){i._mapInitialConfig[l]?i.ctx.map[l].enable():i.ctx.map[l].disable()})},Ae.prototype.getInitialConfigValue=function(i){return this._mapInitialConfig[i]===void 0||this._mapInitialConfig[i]};var Vt=function(){for(var i=arguments,l={},c=0;c<arguments.length;c++){var v=i[c];for(var _ in v)Rs.call(v,_)&&(l[_]=v[_])}return l},Rs=Object.prototype.hasOwnProperty,Fs=["mode","feature","mouse"];function Ds(i){var l=null,c=null,v={onRemove:function(){return i.map.off("load",v.connect),clearInterval(c),v.removeLayers(),i.store.restoreMapConfig(),i.ui.removeButtons(),i.events.removeEventListeners(),i.ui.clearMapClasses(),i.map=null,i.container=null,i.store=null,l&&l.parentNode&&l.parentNode.removeChild(l),l=null,this},connect:function(){i.map.off("load",v.connect),clearInterval(c),v.addLayers(),i.store.storeMapConfig(),i.events.addEventListeners()},onAdd:function(_){var y=_.fire;return _.fire=function(w,F){var G=arguments;return y.length===1&&arguments.length!==1&&(G=[Vt({},{type:w},F)]),y.apply(_,G)},i.map=_,i.events=function(w){var F=Object.keys(w.options.modes).reduce(function(P,ne){return P[ne]=kn(w.options.modes[ne]),P},{}),G={},Z={},W={},q=null,ce=null;W.drag=function(P,ne){ne({point:P.point,time:new Date().getTime()})?(w.ui.queueMapClasses({mouse:p.DRAG}),ce.drag(P)):P.originalEvent.stopPropagation()},W.mousedrag=function(P){W.drag(P,function(ne){return!we(G,ne)})},W.touchdrag=function(P){W.drag(P,function(ne){return!Te(Z,ne)})},W.mousemove=function(P){if((P.originalEvent.buttons!==void 0?P.originalEvent.buttons:P.originalEvent.which)===1)return W.mousedrag(P);var ne=K(P,w);P.featureTarget=ne,ce.mousemove(P)},W.mousedown=function(P){G={time:new Date().getTime(),point:P.point};var ne=K(P,w);P.featureTarget=ne,ce.mousedown(P)},W.mouseup=function(P){var ne=K(P,w);P.featureTarget=ne,we(G,{point:P.point,time:new Date().getTime()})?ce.click(P):ce.mouseup(P)},W.mouseout=function(P){ce.mouseout(P)},W.touchstart=function(P){if(P.originalEvent.preventDefault(),w.options.touchEnabled){Z={time:new Date().getTime(),point:P.point};var ne=$.touch(P,null,w)[0];P.featureTarget=ne,ce.touchstart(P)}},W.touchmove=function(P){if(P.originalEvent.preventDefault(),w.options.touchEnabled)return ce.touchmove(P),W.touchdrag(P)},W.touchend=function(P){if(P.originalEvent.preventDefault(),w.options.touchEnabled){var ne=$.touch(P,null,w)[0];P.featureTarget=ne,Te(Z,{time:new Date().getTime(),point:P.point})?ce.tap(P):ce.touchend(P)}};var Ue=function(P){return!(P===8||P===46||P>=48&&P<=57)};function pe(P,ne,ke){ke===void 0&&(ke={}),ce.stop();var Xe=F[P];if(Xe===void 0)throw new Error(P+" is not valid");q=P;var qe=Xe(w,ne);ce=t(qe,w),ke.silent||w.map.fire(M.MODE_CHANGE,{mode:P}),w.store.setDirty(),w.store.render()}W.keydown=function(P){(P.srcElement||P.target).classList[0]==="mapboxgl-canvas"&&(P.keyCode!==8&&P.keyCode!==46||!w.options.controls.trash?Ue(P.keyCode)?ce.keydown(P):P.keyCode===49&&w.options.controls.point?pe(E.DRAW_POINT):P.keyCode===50&&w.options.controls.line_string?pe(E.DRAW_LINE_STRING):P.keyCode===51&&w.options.controls.polygon&&pe(E.DRAW_POLYGON):(P.preventDefault(),ce.trash()))},W.keyup=function(P){Ue(P.keyCode)&&ce.keyup(P)},W.zoomend=function(){w.store.changeZoom()},W.data=function(P){if(P.dataType==="style"){var ne=w.setup,ke=w.map,Xe=w.options,qe=w.store;Xe.styles.some(function(jr){return ke.getLayer(jr.id)})||(ne.addLayers(),qe.setDirty(),qe.render())}};var ze={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){q=w.options.defaultMode,ce=t(F[q](w),w)},changeMode:pe,actionable:function(P){var ne=!1;Object.keys(P).forEach(function(ke){if(ze[ke]===void 0)throw new Error("Invalid action type");ze[ke]!==P[ke]&&(ne=!0),ze[ke]=P[ke]}),ne&&w.map.fire(M.ACTIONABLE,{actions:ze})},currentModeName:function(){return q},currentModeRender:function(P,ne){return ce.render(P,ne)},fire:function(P,ne){W[P]&&W[P](ne)},addEventListeners:function(){w.map.on("mousemove",W.mousemove),w.map.on("mousedown",W.mousedown),w.map.on("mouseup",W.mouseup),w.map.on("data",W.data),w.map.on("touchmove",W.touchmove),w.map.on("touchstart",W.touchstart),w.map.on("touchend",W.touchend),w.container.addEventListener("mouseout",W.mouseout),w.options.keybindings&&(w.container.addEventListener("keydown",W.keydown),w.container.addEventListener("keyup",W.keyup))},removeEventListeners:function(){w.map.off("mousemove",W.mousemove),w.map.off("mousedown",W.mousedown),w.map.off("mouseup",W.mouseup),w.map.off("data",W.data),w.map.off("touchmove",W.touchmove),w.map.off("touchstart",W.touchstart),w.map.off("touchend",W.touchend),w.container.removeEventListener("mouseout",W.mouseout),w.options.keybindings&&(w.container.removeEventListener("keydown",W.keydown),w.container.removeEventListener("keyup",W.keyup))},trash:function(P){ce.trash(P)},combineFeatures:function(){ce.combineFeatures()},uncombineFeatures:function(){ce.uncombineFeatures()},getMode:function(){return q}}}(i),i.ui=function(w){var F={},G=null,Z={mode:null,feature:null,mouse:null},W={mode:null,feature:null,mouse:null};function q(P){W=Vt(W,P)}function ce(){var P,ne;if(w.container){var ke=[],Xe=[];Fs.forEach(function(qe){W[qe]!==Z[qe]&&(ke.push(qe+"-"+Z[qe]),W[qe]!==null&&Xe.push(qe+"-"+W[qe]))}),ke.length>0&&(P=w.container.classList).remove.apply(P,ke),Xe.length>0&&(ne=w.container.classList).add.apply(ne,Xe),Z=Vt(Z,W)}}function Ue(P,ne){ne===void 0&&(ne={});var ke=document.createElement("button");return ke.className=g.CONTROL_BUTTON+" "+ne.className,ke.setAttribute("title",ne.title),ne.container.appendChild(ke),ke.addEventListener("click",function(Xe){if(Xe.preventDefault(),Xe.stopPropagation(),Xe.target===G)return pe(),void ne.onDeactivate();ze(P),ne.onActivate()},!0),ke}function pe(){G&&(G.classList.remove(g.ACTIVE_BUTTON),G=null)}function ze(P){pe();var ne=F[P];ne&&ne&&P!=="trash"&&(ne.classList.add(g.ACTIVE_BUTTON),G=ne)}return{setActiveButton:ze,queueMapClasses:q,updateMapClasses:ce,clearMapClasses:function(){q({mode:null,feature:null,mouse:null}),ce()},addButtons:function(){var P=w.options.controls,ne=document.createElement("div");return ne.className=g.CONTROL_GROUP+" "+g.CONTROL_BASE,P&&(P[h.LINE]&&(F[h.LINE]=Ue(h.LINE,{container:ne,className:g.CONTROL_BUTTON_LINE,title:"LineString tool "+(w.options.keybindings?"(l)":""),onActivate:function(){return w.events.changeMode(E.DRAW_LINE_STRING)},onDeactivate:function(){return w.events.trash()}})),P[h.POLYGON]&&(F[h.POLYGON]=Ue(h.POLYGON,{container:ne,className:g.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(w.options.keybindings?"(p)":""),onActivate:function(){return w.events.changeMode(E.DRAW_POLYGON)},onDeactivate:function(){return w.events.trash()}})),P[h.POINT]&&(F[h.POINT]=Ue(h.POINT,{container:ne,className:g.CONTROL_BUTTON_POINT,title:"Marker tool "+(w.options.keybindings?"(m)":""),onActivate:function(){return w.events.changeMode(E.DRAW_POINT)},onDeactivate:function(){return w.events.trash()}})),P.trash&&(F.trash=Ue("trash",{container:ne,className:g.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){w.events.trash()}})),P.combine_features&&(F.combine_features=Ue("combineFeatures",{container:ne,className:g.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){w.events.combineFeatures()}})),P.uncombine_features&&(F.uncombine_features=Ue("uncombineFeatures",{container:ne,className:g.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){w.events.uncombineFeatures()}}))),ne},removeButtons:function(){Object.keys(F).forEach(function(P){var ne=F[P];ne.parentNode&&ne.parentNode.removeChild(ne),delete F[P]})}}}(i),i.container=_.getContainer(),i.store=new Ae(i),l=i.ui.addButtons(),i.options.boxSelect&&(_.boxZoom.disable(),_.dragPan.disable(),_.dragPan.enable()),_.loaded()?v.connect():(_.on("load",v.connect),c=setInterval(function(){_.loaded()&&v.connect()},16)),i.events.start(),l},addLayers:function(){i.map.addSource(b.COLD,{data:{type:m.FEATURE_COLLECTION,features:[]},type:"geojson"}),i.map.addSource(b.HOT,{data:{type:m.FEATURE_COLLECTION,features:[]},type:"geojson"}),i.options.styles.forEach(function(_){i.map.addLayer(_)}),i.store.setDirty(!0),i.store.render()},removeLayers:function(){i.options.styles.forEach(function(_){i.map.getLayer(_.id)&&i.map.removeLayer(_.id)}),i.map.getSource(b.COLD)&&i.map.removeSource(b.COLD),i.map.getSource(b.HOT)&&i.map.removeSource(b.HOT)}};return i.setup=v,v}var Ei=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Yn(i){return function(l){var c=l.featureTarget;return!!c&&!!c.properties&&c.properties.meta===i}}function wi(i){return!!i.originalEvent&&!!i.originalEvent.shiftKey&&i.originalEvent.button===0}function en(i){return!!i.featureTarget&&!!i.featureTarget.properties&&i.featureTarget.properties.active===O.ACTIVE&&i.featureTarget.properties.meta===D.FEATURE}function Ar(i){return!!i.featureTarget&&!!i.featureTarget.properties&&i.featureTarget.properties.active===O.INACTIVE&&i.featureTarget.properties.meta===D.FEATURE}function Wn(i){return i.featureTarget===void 0}function Si(i){return!!i.featureTarget&&!!i.featureTarget.properties&&i.featureTarget.properties.meta===D.FEATURE}function Mn(i){var l=i.featureTarget;return!!l&&!!l.properties&&l.properties.meta===D.VERTEX}function Hn(i){return!!i.originalEvent&&i.originalEvent.shiftKey===!0}function Zn(i){return i.keyCode===27}function Xn(i){return i.keyCode===13}var Us=Object.freeze({__proto__:null,isOfMetaType:Yn,isShiftMousedown:wi,isActiveFeature:en,isInactiveFeature:Ar,noTarget:Wn,isFeature:Si,isVertex:Mn,isShiftDown:Hn,isEscapeKey:Zn,isEnterKey:Xn,isTrue:function(){return!0}}),js=dn;function dn(i,l){this.x=i,this.y=l}function Nr(i,l){var c=l.getBoundingClientRect();return new js(i.clientX-c.left-(l.clientLeft||0),i.clientY-c.top-(l.clientTop||0))}function hn(i,l,c,v){return{type:m.FEATURE,properties:{meta:D.VERTEX,parent:i,coord_path:c,active:v?O.ACTIVE:O.INACTIVE},geometry:{type:m.POINT,coordinates:l}}}function Ti(i,l,c){var v=l.geometry.coordinates,_=c.geometry.coordinates;if(v[1]>85||v[1]<B||_[1]>85||_[1]<B)return null;var y={lng:(v[0]+_[0])/2,lat:(v[1]+_[1])/2};return{type:m.FEATURE,properties:{meta:D.MIDPOINT,parent:i,lng:y.lng,lat:y.lat,coord_path:c.properties.coord_path},geometry:{type:m.POINT,coordinates:[y.lng,y.lat]}}}function Kn(i,l,c){l===void 0&&(l={}),c===void 0&&(c=null);var v,_=i.geometry,y=_.type,w=_.coordinates,F=i.properties&&i.properties.id,G=[];function Z(q,ce){var Ue="",pe=null;q.forEach(function(ze,P){var ne=ce!=null?ce+"."+P:String(P),ke=hn(F,ze,ne,W(ne));if(l.midpoints&&pe){var Xe=Ti(F,pe,ke);Xe&&G.push(Xe)}pe=ke;var qe=JSON.stringify(ze);Ue!==qe&&G.push(ke),P===0&&(Ue=qe)})}function W(q){return!!l.selectedPaths&&l.selectedPaths.indexOf(q)!==-1}return y===m.POINT?G.push(hn(F,w,c,W(c))):y===m.POLYGON?w.forEach(function(q,ce){Z(q,c!==null?c+"."+ce:String(ce))}):y===m.LINE_STRING?Z(w,c):y.indexOf(m.MULTI_PREFIX)===0&&(v=y.replace(m.MULTI_PREFIX,""),w.forEach(function(q,ce){var Ue={type:m.FEATURE,properties:i.properties,geometry:{type:v,coordinates:q}};G=G.concat(Kn(Ue,l,ce))})),G}dn.prototype={clone:function(){return new dn(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,l){return this.clone()._rotateAround(i,l)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var l=i.x-this.x,c=i.y-this.y;return l*l+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,l){return Math.atan2(this.x*l-this.y*i,this.x*i+this.y*l)},_matMult:function(i){var l=i[0]*this.x+i[1]*this.y,c=i[2]*this.x+i[3]*this.y;return this.x=l,this.y=c,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var l=Math.cos(i),c=Math.sin(i),v=l*this.x-c*this.y,_=c*this.x+l*this.y;return this.x=v,this.y=_,this},_rotateAround:function(i,l){var c=Math.cos(i),v=Math.sin(i),_=l.x+c*(this.x-l.x)-v*(this.y-l.y),y=l.y+v*(this.x-l.x)+c*(this.y-l.y);return this.x=_,this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},dn.convert=function(i){return i instanceof dn?i:Array.isArray(i)?new dn(i[0],i[1]):i};var bt={enable:function(i){setTimeout(function(){i.map&&i.map.doubleClickZoom&&i._ctx&&i._ctx.store&&i._ctx.store.getInitialConfigValue&&i._ctx.store.getInitialConfigValue("doubleClickZoom")&&i.map.doubleClickZoom.enable()},0)},disable:function(i){setTimeout(function(){i.map&&i.map.doubleClickZoom&&i.map.doubleClickZoom.disable()},0)}},On={},Bs={get exports(){return On},set exports(i){On=i}},Ci=function(i){if(!i||!i.type)return null;var l=Gs[i.type];if(!l)return null;if(l==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:i}]};if(l==="feature")return{type:"FeatureCollection",features:[i]};if(l==="featurecollection")return i},Gs={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Vs=Object.freeze({__proto__:null,default:function i(l){switch(l&&l.type||null){case"FeatureCollection":return l.features=l.features.reduce(function(c,v){return c.concat(i(v))},[]),l;case"Feature":return l.geometry?i(l.geometry).map(function(c){var v={type:"Feature",properties:JSON.parse(JSON.stringify(l.properties)),geometry:c};return l.id!==void 0&&(v.id=l.id),v}):[l];case"MultiPoint":return l.coordinates.map(function(c){return{type:"Point",coordinates:c}});case"MultiPolygon":return l.coordinates.map(function(c){return{type:"Polygon",coordinates:c}});case"MultiLineString":return l.coordinates.map(function(c){return{type:"LineString",coordinates:c}});case"GeometryCollection":return l.geometries.map(i).reduce(function(c,v){return c.concat(v)},[]);case"Point":case"Polygon":case"LineString":return[l]}}}),zs=Ci,Qn=r(Vs),qs=function(i){return function l(c){return Array.isArray(c)&&c.length&&typeof c[0]=="number"?[c]:c.reduce(function(v,_){return Array.isArray(_)&&Array.isArray(_[0])?v.concat(l(_)):(v.push(_),v)},[])}(i)};Qn instanceof Function||(Qn=Qn.default);var Rr={},Js={get exports(){return Rr},set exports(i){Rr=i}}.exports=function(i){return new at(i)};function at(i){this.value=i}function ki(i,l,c){var v=[],_=[],y=!0;return function w(F){var G=c?Mi(F):F,Z={},W=!0,q={node:G,node_:F,path:[].concat(v),parent:_[_.length-1],parents:_,key:v.slice(-1)[0],isRoot:v.length===0,level:v.length,circular:null,update:function(pe,ze){q.isRoot||(q.parent.node[q.key]=pe),q.node=pe,ze&&(W=!1)},delete:function(pe){delete q.parent.node[q.key],pe&&(W=!1)},remove:function(pe){Oi(q.parent.node)?q.parent.node.splice(q.key,1):delete q.parent.node[q.key],pe&&(W=!1)},keys:null,before:function(pe){Z.before=pe},after:function(pe){Z.after=pe},pre:function(pe){Z.pre=pe},post:function(pe){Z.post=pe},stop:function(){y=!1},block:function(){W=!1}};if(!y)return q;function ce(){if(typeof q.node=="object"&&q.node!==null){q.keys&&q.node_===q.node||(q.keys=$n(q.node)),q.isLeaf=q.keys.length==0;for(var pe=0;pe<_.length;pe++)if(_[pe].node_===F){q.circular=_[pe];break}}else q.isLeaf=!0,q.keys=null;q.notLeaf=!q.isLeaf,q.notRoot=!q.isRoot}ce();var Ue=l.call(q,q.node);return Ue!==void 0&&q.update&&q.update(Ue),Z.before&&Z.before.call(q,q.node),W&&(typeof q.node!="object"||q.node===null||q.circular||(_.push(q),ce(),er(q.keys,function(pe,ze){v.push(pe),Z.pre&&Z.pre.call(q,q.node[pe],pe);var P=w(q.node[pe]);c&&tr.call(q.node,pe)&&(q.node[pe]=P.node),P.isLast=ze==q.keys.length-1,P.isFirst=ze==0,Z.post&&Z.post.call(q,P),v.pop()}),_.pop()),Z.after&&Z.after.call(q,q.node)),q}(i).node}function Mi(i){if(typeof i=="object"&&i!==null){var l;if(Oi(i))l=[];else if(pn(i)==="[object Date]")l=new Date(i.getTime?i.getTime():i);else if(function(_){return pn(_)==="[object RegExp]"}(i))l=new RegExp(i);else if(function(_){return pn(_)==="[object Error]"}(i))l={message:i.message};else if(function(_){return pn(_)==="[object Boolean]"}(i))l=new Boolean(i);else if(function(_){return pn(_)==="[object Number]"}(i))l=new Number(i);else if(function(_){return pn(_)==="[object String]"}(i))l=new String(i);else if(Object.create&&Object.getPrototypeOf)l=Object.create(Object.getPrototypeOf(i));else if(i.constructor===Object)l={};else{var c=i.constructor&&i.constructor.prototype||i.__proto__||{},v=function(){};v.prototype=c,l=new v}return er($n(i),function(_){l[_]=i[_]}),l}return i}at.prototype.get=function(i){for(var l=this.value,c=0;c<i.length;c++){var v=i[c];if(!l||!tr.call(l,v)){l=void 0;break}l=l[v]}return l},at.prototype.has=function(i){for(var l=this.value,c=0;c<i.length;c++){var v=i[c];if(!l||!tr.call(l,v))return!1;l=l[v]}return!0},at.prototype.set=function(i,l){for(var c=this.value,v=0;v<i.length-1;v++){var _=i[v];tr.call(c,_)||(c[_]={}),c=c[_]}return c[i[v]]=l,l},at.prototype.map=function(i){return ki(this.value,i,!0)},at.prototype.forEach=function(i){return this.value=ki(this.value,i,!1),this.value},at.prototype.reduce=function(i,l){var c=arguments.length===1,v=c?this.value:l;return this.forEach(function(_){this.isRoot&&c||(v=i.call(this,v,_))}),v},at.prototype.paths=function(){var i=[];return this.forEach(function(l){i.push(this.path)}),i},at.prototype.nodes=function(){var i=[];return this.forEach(function(l){i.push(this.node)}),i},at.prototype.clone=function(){var i=[],l=[];return function c(v){for(var _=0;_<i.length;_++)if(i[_]===v)return l[_];if(typeof v=="object"&&v!==null){var y=Mi(v);return i.push(v),l.push(y),er($n(v),function(w){y[w]=c(v[w])}),i.pop(),l.pop(),y}return v}(this.value)};var $n=Object.keys||function(i){var l=[];for(var c in i)l.push(c);return l};function pn(i){return Object.prototype.toString.call(i)}var Oi=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"},er=function(i,l){if(i.forEach)return i.forEach(l);for(var c=0;c<i.length;c++)l(i[c],c,i)};er($n(at.prototype),function(i){Js[i]=function(l){var c=[].slice.call(arguments,1),v=new at(l);return v[i].apply(v,c)}});var tr=Object.hasOwnProperty||function(i,l){return l in i},Ys=tt;function tt(i){if(!(this instanceof tt))return new tt(i);this._bbox=i||[1/0,1/0,-1/0,-1/0],this._valid=!!i}tt.prototype.include=function(i){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],i[0]),this._bbox[1]=Math.min(this._bbox[1],i[1]),this._bbox[2]=Math.max(this._bbox[2],i[0]),this._bbox[3]=Math.max(this._bbox[3],i[1]),this},tt.prototype.equals=function(i){var l;return l=i instanceof tt?i.bbox():i,this._bbox[0]==l[0]&&this._bbox[1]==l[1]&&this._bbox[2]==l[2]&&this._bbox[3]==l[3]},tt.prototype.center=function(i){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},tt.prototype.union=function(i){var l;return this._valid=!0,l=i instanceof tt?i.bbox():i,this._bbox[0]=Math.min(this._bbox[0],l[0]),this._bbox[1]=Math.min(this._bbox[1],l[1]),this._bbox[2]=Math.max(this._bbox[2],l[2]),this._bbox[3]=Math.max(this._bbox[3],l[3]),this},tt.prototype.bbox=function(){return this._valid?this._bbox:null},tt.prototype.contains=function(i){if(!i)return this._fastContains();if(!this._valid)return null;var l=i[0],c=i[1];return this._bbox[0]<=l&&this._bbox[1]<=c&&this._bbox[2]>=l&&this._bbox[3]>=c},tt.prototype.intersect=function(i){return this._valid?(l=i instanceof tt?i.bbox():i,!(this._bbox[0]>l[2]||this._bbox[2]<l[0]||this._bbox[3]<l[1]||this._bbox[1]>l[3])):null;var l},tt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var i="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",i)},tt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Ws=function(i){if(!i)return[];var l=Qn(zs(i)),c=[];return l.features.forEach(function(v){v.geometry&&(c=c.concat(qs(v.geometry.coordinates)))}),c},Hs=Rr,Zs=Ys,Ii={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Xs=Object.keys(Ii);function Fr(i){for(var l=Zs(),c=Ws(i),v=0;v<c.length;v++)l.include(c[v]);return l}Bs.exports=function(i){return Fr(i).bbox()},On.polygon=function(i){return Fr(i).polygon()},On.bboxify=function(i){return Hs(i).map(function(l){l&&Xs.some(function(c){return!!l[c]&&Ii[c].indexOf(l.type)!==-1})&&(l.bbox=Fr(l).bbox(),this.update(l))})};var nr=-90;function Dr(i,l){var c=nr,v=90,_=nr,y=90,w=270,F=-270;i.forEach(function(Z){var W=On(Z),q=W[1],ce=W[3],Ue=W[0],pe=W[2];q>c&&(c=q),ce<v&&(v=ce),ce>_&&(_=ce),q<y&&(y=q),Ue<w&&(w=Ue),pe>F&&(F=pe)});var G=l;return c+G.lat>85&&(G.lat=85-c),_+G.lat>90&&(G.lat=90-_),v+G.lat<-85&&(G.lat=-85-v),y+G.lat<nr&&(G.lat=nr-y),w+G.lng<=-270&&(G.lng+=360*Math.ceil(Math.abs(G.lng)/360)),F+G.lng>=270&&(G.lng-=360*Math.ceil(Math.abs(G.lng)/360)),G}function Ur(i,l){var c=Dr(i.map(function(v){return v.toGeoJSON()}),l);i.forEach(function(v){var _,y=v.getCoordinates(),w=function(G){var Z={lng:G[0]+c.lng,lat:G[1]+c.lat};return[Z.lng,Z.lat]},F=function(G){return G.map(function(Z){return w(Z)})};v.type===m.POINT?_=w(y):v.type===m.LINE_STRING||v.type===m.MULTI_POINT?_=y.map(w):v.type===m.POLYGON||v.type===m.MULTI_LINE_STRING?_=y.map(F):v.type===m.MULTI_POLYGON&&(_=y.map(function(G){return G.map(function(Z){return F(Z)})})),v.incomingCoords(_)})}var We={onSetup:function(i){var l=this,c={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:i.featureIds||[]};return this.setSelected(c.initiallySelectedFeatureIds.filter(function(v){return l.getFeature(v)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),c},fireUpdate:function(){this.map.fire(M.UPDATE,{action:z.MOVE,features:this.getSelected().map(function(i){return i.toGeoJSON()})})},fireActionable:function(){var i=this,l=this.getSelected(),c=l.filter(function(F){return i.isInstanceOf("MultiFeature",F)}),v=!1;if(l.length>1){v=!0;var _=l[0].type.replace("Multi","");l.forEach(function(F){F.type.replace("Multi","")!==_&&(v=!1)})}var y=c.length>0,w=l.length>0;this.setActionableState({combineFeatures:v,uncombineFeatures:y,trash:w})},getUniqueIds:function(i){return i.length?i.map(function(l){return l.properties.id}).filter(function(l){return l!==void 0}).reduce(function(l,c){return l.add(c),l},new I).values():[]},stopExtendedInteractions:function(i){i.boxSelectElement&&(i.boxSelectElement.parentNode&&i.boxSelectElement.parentNode.removeChild(i.boxSelectElement),i.boxSelectElement=null),this.map.dragPan.enable(),i.boxSelecting=!1,i.canBoxSelect=!1,i.dragMoving=!1,i.canDragMove=!1},onStop:function(){bt.enable(this)},onMouseMove:function(i){return this.stopExtendedInteractions(i),!0},onMouseOut:function(i){return!i.dragMoving||this.fireUpdate()}};We.onTap=We.onClick=function(i,l){return Wn(l)?this.clickAnywhere(i,l):Yn(D.VERTEX)(l)?this.clickOnVertex(i,l):Si(l)?this.clickOnFeature(i,l):void 0},We.clickAnywhere=function(i){var l=this,c=this.getSelectedIds();c.length&&(this.clearSelectedFeatures(),c.forEach(function(v){return l.doRender(v)})),bt.enable(this),this.stopExtendedInteractions(i)},We.clickOnVertex=function(i,l){this.changeMode(E.DIRECT_SELECT,{featureId:l.featureTarget.properties.parent,coordPath:l.featureTarget.properties.coord_path,startPos:l.lngLat}),this.updateUIClasses({mouse:p.MOVE})},We.startOnActiveFeature=function(i,l){this.stopExtendedInteractions(i),this.map.dragPan.disable(),this.doRender(l.featureTarget.properties.id),i.canDragMove=!0,i.dragMoveLocation=l.lngLat},We.clickOnFeature=function(i,l){var c=this;bt.disable(this),this.stopExtendedInteractions(i);var v=Hn(l),_=this.getSelectedIds(),y=l.featureTarget.properties.id,w=this.isSelected(y);if(!v&&w&&this.getFeature(y).type!==m.POINT)return this.changeMode(E.DIRECT_SELECT,{featureId:y});w&&v?(this.deselect(y),this.updateUIClasses({mouse:p.POINTER}),_.length===1&&bt.enable(this)):!w&&v?(this.select(y),this.updateUIClasses({mouse:p.MOVE})):w||v||(_.forEach(function(F){return c.doRender(F)}),this.setSelected(y),this.updateUIClasses({mouse:p.MOVE})),this.doRender(y)},We.onMouseDown=function(i,l){return en(l)?this.startOnActiveFeature(i,l):this.drawConfig.boxSelect&&wi(l)?this.startBoxSelect(i,l):void 0},We.startBoxSelect=function(i,l){this.stopExtendedInteractions(i),this.map.dragPan.disable(),i.boxSelectStartLocation=Nr(l.originalEvent,this.map.getContainer()),i.canBoxSelect=!0},We.onTouchStart=function(i,l){if(en(l))return this.startOnActiveFeature(i,l)},We.onDrag=function(i,l){return i.canDragMove?this.dragMove(i,l):this.drawConfig.boxSelect&&i.canBoxSelect?this.whileBoxSelect(i,l):void 0},We.whileBoxSelect=function(i,l){i.boxSelecting=!0,this.updateUIClasses({mouse:p.ADD}),i.boxSelectElement||(i.boxSelectElement=document.createElement("div"),i.boxSelectElement.classList.add(g.BOX_SELECT),this.map.getContainer().appendChild(i.boxSelectElement));var c=Nr(l.originalEvent,this.map.getContainer()),v=Math.min(i.boxSelectStartLocation.x,c.x),_=Math.max(i.boxSelectStartLocation.x,c.x),y=Math.min(i.boxSelectStartLocation.y,c.y),w=Math.max(i.boxSelectStartLocation.y,c.y),F="translate("+v+"px, "+y+"px)";i.boxSelectElement.style.transform=F,i.boxSelectElement.style.WebkitTransform=F,i.boxSelectElement.style.width=_-v+"px",i.boxSelectElement.style.height=w-y+"px"},We.dragMove=function(i,l){i.dragMoving=!0,l.originalEvent.stopPropagation();var c={lng:l.lngLat.lng-i.dragMoveLocation.lng,lat:l.lngLat.lat-i.dragMoveLocation.lat};Ur(this.getSelected(),c),i.dragMoveLocation=l.lngLat},We.onTouchEnd=We.onMouseUp=function(i,l){var c=this;if(i.dragMoving)this.fireUpdate();else if(i.boxSelecting){var v=[i.boxSelectStartLocation,Nr(l.originalEvent,this.map.getContainer())],_=this.featuresAt(null,v,"click"),y=this.getUniqueIds(_).filter(function(w){return!c.isSelected(w)});y.length&&(this.select(y),y.forEach(function(w){return c.doRender(w)}),this.updateUIClasses({mouse:p.MOVE}))}this.stopExtendedInteractions(i)},We.toDisplayFeatures=function(i,l,c){l.properties.active=this.isSelected(l.properties.id)?O.ACTIVE:O.INACTIVE,c(l),this.fireActionable(),l.properties.active===O.ACTIVE&&l.geometry.type!==m.POINT&&Kn(l).forEach(c)},We.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},We.onCombineFeatures=function(){var i=this.getSelected();if(!(i.length===0||i.length<2)){for(var l=[],c=[],v=i[0].type.replace("Multi",""),_=0;_<i.length;_++){var y=i[_];if(y.type.replace("Multi","")!==v)return;y.type.includes("Multi")?y.getCoordinates().forEach(function(F){l.push(F)}):l.push(y.getCoordinates()),c.push(y.toGeoJSON())}if(c.length>1){var w=this.newFeature({type:m.FEATURE,properties:c[0].properties,geometry:{type:"Multi"+v,coordinates:l}});this.addFeature(w),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([w.id]),this.map.fire(M.COMBINE_FEATURES,{createdFeatures:[w.toGeoJSON()],deletedFeatures:c})}this.fireActionable()}},We.onUncombineFeatures=function(){var i=this,l=this.getSelected();if(l.length!==0){for(var c=[],v=[],_=function(w){var F=l[w];i.isInstanceOf("MultiFeature",F)&&(F.getFeatures().forEach(function(G){i.addFeature(G),G.properties=F.properties,c.push(G.toGeoJSON()),i.select([G.id])}),i.deleteFeature(F.id,{silent:!0}),v.push(F.toGeoJSON()))},y=0;y<l.length;y++)_(y);c.length>1&&this.map.fire(M.UNCOMBINE_FEATURES,{createdFeatures:c,deletedFeatures:v}),this.fireActionable()}};var Li=Yn(D.VERTEX),Ks=Yn(D.MIDPOINT),zt={fireUpdate:function(){this.map.fire(M.UPDATE,{action:z.CHANGE_COORDINATES,features:this.getSelected().map(function(i){return i.toGeoJSON()})})},fireActionable:function(i){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:i.selectedCoordPaths.length>0})},startDragging:function(i,l){this.map.dragPan.disable(),i.canDragMove=!0,i.dragMoveLocation=l.lngLat},stopDragging:function(i){this.map.dragPan.enable(),i.dragMoving=!1,i.canDragMove=!1,i.dragMoveLocation=null},onVertex:function(i,l){this.startDragging(i,l);var c=l.featureTarget.properties,v=i.selectedCoordPaths.indexOf(c.coord_path);Hn(l)||v!==-1?Hn(l)&&v===-1&&i.selectedCoordPaths.push(c.coord_path):i.selectedCoordPaths=[c.coord_path];var _=this.pathsToCoordinates(i.featureId,i.selectedCoordPaths);this.setSelectedCoordinates(_)},onMidpoint:function(i,l){this.startDragging(i,l);var c=l.featureTarget.properties;i.feature.addCoordinate(c.coord_path,c.lng,c.lat),this.fireUpdate(),i.selectedCoordPaths=[c.coord_path]},pathsToCoordinates:function(i,l){return l.map(function(c){return{feature_id:i,coord_path:c}})},onFeature:function(i,l){i.selectedCoordPaths.length===0?this.startDragging(i,l):this.stopDragging(i)},dragFeature:function(i,l,c){Ur(this.getSelected(),c),i.dragMoveLocation=l.lngLat},dragVertex:function(i,l,c){for(var v=i.selectedCoordPaths.map(function(F){return i.feature.getCoordinate(F)}),_=Dr(v.map(function(F){return{type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:F}}}),c),y=0;y<v.length;y++){var w=v[y];i.feature.updateCoordinate(i.selectedCoordPaths[y],w[0]+_.lng,w[1]+_.lat)}},clickNoTarget:function(){this.changeMode(E.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(E.SIMPLE_SELECT)},clickActiveFeature:function(i){i.selectedCoordPaths=[],this.clearSelectedCoordinates(),i.feature.changed()},onSetup:function(i){var l=i.featureId,c=this.getFeature(l);if(!c)throw new Error("You must provide a featureId to enter direct_select mode");if(c.type===m.POINT)throw new TypeError("direct_select mode doesn't handle point features");var v={featureId:l,feature:c,dragMoveLocation:i.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:i.coordPath?[i.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(l,v.selectedCoordPaths)),this.setSelected(l),bt.disable(this),this.setActionableState({trash:!0}),v},onStop:function(){bt.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(i,l,c){i.featureId===l.properties.id?(l.properties.active=O.ACTIVE,c(l),Kn(l,{map:this.map,midpoints:!0,selectedPaths:i.selectedCoordPaths}).forEach(c)):(l.properties.active=O.INACTIVE,c(l)),this.fireActionable(i)},onTrash:function(i){i.selectedCoordPaths.sort(function(l,c){return c.localeCompare(l,"en",{numeric:!0})}).forEach(function(l){return i.feature.removeCoordinate(l)}),this.fireUpdate(),i.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(i),i.feature.isValid()===!1&&(this.deleteFeature([i.featureId]),this.changeMode(E.SIMPLE_SELECT,{}))},onMouseMove:function(i,l){var c=en(l),v=Li(l),_=i.selectedCoordPaths.length===0;return c&&_||v&&!_?this.updateUIClasses({mouse:p.MOVE}):this.updateUIClasses({mouse:p.NONE}),this.stopDragging(i),!0},onMouseOut:function(i){return i.dragMoving&&this.fireUpdate(),!0}};zt.onTouchStart=zt.onMouseDown=function(i,l){return Li(l)?this.onVertex(i,l):en(l)?this.onFeature(i,l):Ks(l)?this.onMidpoint(i,l):void 0},zt.onDrag=function(i,l){if(i.canDragMove===!0){i.dragMoving=!0,l.originalEvent.stopPropagation();var c={lng:l.lngLat.lng-i.dragMoveLocation.lng,lat:l.lngLat.lat-i.dragMoveLocation.lat};i.selectedCoordPaths.length>0?this.dragVertex(i,l,c):this.dragFeature(i,l,c),i.dragMoveLocation=l.lngLat}},zt.onClick=function(i,l){return Wn(l)?this.clickNoTarget(i,l):en(l)?this.clickActiveFeature(i,l):Ar(l)?this.clickInactive(i,l):void this.stopDragging(i)},zt.onTap=function(i,l){return Wn(l)?this.clickNoTarget(i,l):en(l)?this.clickActiveFeature(i,l):Ar(l)?this.clickInactive(i,l):void 0},zt.onTouchEnd=zt.onMouseUp=function(i){i.dragMoving&&this.fireUpdate(),this.stopDragging(i)};var Mt={};function rr(i,l){return!!i.lngLat&&i.lngLat.lng===l[0]&&i.lngLat.lat===l[1]}Mt.onSetup=function(){var i=this.newFeature({type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:[]}});return this.addFeature(i),this.clearSelectedFeatures(),this.updateUIClasses({mouse:p.ADD}),this.activateUIButton(h.POINT),this.setActionableState({trash:!0}),{point:i}},Mt.stopDrawingAndRemove=function(i){this.deleteFeature([i.point.id],{silent:!0}),this.changeMode(E.SIMPLE_SELECT)},Mt.onTap=Mt.onClick=function(i,l){this.updateUIClasses({mouse:p.MOVE}),i.point.updateCoordinate("",l.lngLat.lng,l.lngLat.lat),this.map.fire(M.CREATE,{features:[i.point.toGeoJSON()]}),this.changeMode(E.SIMPLE_SELECT,{featureIds:[i.point.id]})},Mt.onStop=function(i){this.activateUIButton(),i.point.getCoordinate().length||this.deleteFeature([i.point.id],{silent:!0})},Mt.toDisplayFeatures=function(i,l,c){var v=l.properties.id===i.point.id;if(l.properties.active=v?O.ACTIVE:O.INACTIVE,!v)return c(l)},Mt.onTrash=Mt.stopDrawingAndRemove,Mt.onKeyUp=function(i,l){if(Zn(l)||Xn(l))return this.stopDrawingAndRemove(i,l)};var tn={onSetup:function(){var i=this.newFeature({type:m.FEATURE,properties:{},geometry:{type:m.POLYGON,coordinates:[[]]}});return this.addFeature(i),this.clearSelectedFeatures(),bt.disable(this),this.updateUIClasses({mouse:p.ADD}),this.activateUIButton(h.POLYGON),this.setActionableState({trash:!0}),{polygon:i,currentVertexPosition:0}},clickAnywhere:function(i,l){if(i.currentVertexPosition>0&&rr(l,i.polygon.coordinates[0][i.currentVertexPosition-1]))return this.changeMode(E.SIMPLE_SELECT,{featureIds:[i.polygon.id]});this.updateUIClasses({mouse:p.ADD}),i.polygon.updateCoordinate("0."+i.currentVertexPosition,l.lngLat.lng,l.lngLat.lat),i.currentVertexPosition++,i.polygon.updateCoordinate("0."+i.currentVertexPosition,l.lngLat.lng,l.lngLat.lat)},clickOnVertex:function(i){return this.changeMode(E.SIMPLE_SELECT,{featureIds:[i.polygon.id]})},onMouseMove:function(i,l){i.polygon.updateCoordinate("0."+i.currentVertexPosition,l.lngLat.lng,l.lngLat.lat),Mn(l)&&this.updateUIClasses({mouse:p.POINTER})}};tn.onTap=tn.onClick=function(i,l){return Mn(l)?this.clickOnVertex(i,l):this.clickAnywhere(i,l)},tn.onKeyUp=function(i,l){Zn(l)?(this.deleteFeature([i.polygon.id],{silent:!0}),this.changeMode(E.SIMPLE_SELECT)):Xn(l)&&this.changeMode(E.SIMPLE_SELECT,{featureIds:[i.polygon.id]})},tn.onStop=function(i){this.updateUIClasses({mouse:p.NONE}),bt.enable(this),this.activateUIButton(),this.getFeature(i.polygon.id)!==void 0&&(i.polygon.removeCoordinate("0."+i.currentVertexPosition),i.polygon.isValid()?this.map.fire(M.CREATE,{features:[i.polygon.toGeoJSON()]}):(this.deleteFeature([i.polygon.id],{silent:!0}),this.changeMode(E.SIMPLE_SELECT,{},{silent:!0})))},tn.toDisplayFeatures=function(i,l,c){var v=l.properties.id===i.polygon.id;if(l.properties.active=v?O.ACTIVE:O.INACTIVE,!v)return c(l);if(l.geometry.coordinates.length!==0){var _=l.geometry.coordinates[0].length;if(!(_<3)){if(l.properties.meta=D.FEATURE,c(hn(i.polygon.id,l.geometry.coordinates[0][0],"0.0",!1)),_>3){var y=l.geometry.coordinates[0].length-3;c(hn(i.polygon.id,l.geometry.coordinates[0][y],"0."+y,!1))}if(_<=4){var w=[[l.geometry.coordinates[0][0][0],l.geometry.coordinates[0][0][1]],[l.geometry.coordinates[0][1][0],l.geometry.coordinates[0][1][1]]];if(c({type:m.FEATURE,properties:l.properties,geometry:{coordinates:w,type:m.LINE_STRING}}),_===3)return}return c(l)}}},tn.onTrash=function(i){this.deleteFeature([i.polygon.id],{silent:!0}),this.changeMode(E.SIMPLE_SELECT)};var nn={onSetup:function(i){var l,c,v=(i=i||{}).featureId,_="forward";if(v){if(!(l=this.getFeature(v)))throw new Error("Could not find a feature with the provided featureId");var y=i.from;if(y&&y.type==="Feature"&&y.geometry&&y.geometry.type==="Point"&&(y=y.geometry),y&&y.type==="Point"&&y.coordinates&&y.coordinates.length===2&&(y=y.coordinates),!y||!Array.isArray(y))throw new Error("Please use the `from` property to indicate which point to continue the line from");var w=l.coordinates.length-1;if(l.coordinates[w][0]===y[0]&&l.coordinates[w][1]===y[1])c=w+1,l.addCoordinate.apply(l,[c].concat(l.coordinates[w]));else{if(l.coordinates[0][0]!==y[0]||l.coordinates[0][1]!==y[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");_="backwards",c=0,l.addCoordinate.apply(l,[c].concat(l.coordinates[0]))}}else l=this.newFeature({type:m.FEATURE,properties:{},geometry:{type:m.LINE_STRING,coordinates:[]}}),c=0,this.addFeature(l);return this.clearSelectedFeatures(),bt.disable(this),this.updateUIClasses({mouse:p.ADD}),this.activateUIButton(h.LINE),this.setActionableState({trash:!0}),{line:l,currentVertexPosition:c,direction:_}},clickAnywhere:function(i,l){if(i.currentVertexPosition>0&&rr(l,i.line.coordinates[i.currentVertexPosition-1])||i.direction==="backwards"&&rr(l,i.line.coordinates[i.currentVertexPosition+1]))return this.changeMode(E.SIMPLE_SELECT,{featureIds:[i.line.id]});this.updateUIClasses({mouse:p.ADD}),i.line.updateCoordinate(i.currentVertexPosition,l.lngLat.lng,l.lngLat.lat),i.direction==="forward"?(i.currentVertexPosition++,i.line.updateCoordinate(i.currentVertexPosition,l.lngLat.lng,l.lngLat.lat)):i.line.addCoordinate(0,l.lngLat.lng,l.lngLat.lat)},clickOnVertex:function(i){return this.changeMode(E.SIMPLE_SELECT,{featureIds:[i.line.id]})},onMouseMove:function(i,l){i.line.updateCoordinate(i.currentVertexPosition,l.lngLat.lng,l.lngLat.lat),Mn(l)&&this.updateUIClasses({mouse:p.POINTER})}};nn.onTap=nn.onClick=function(i,l){if(Mn(l))return this.clickOnVertex(i,l);this.clickAnywhere(i,l)},nn.onKeyUp=function(i,l){Xn(l)?this.changeMode(E.SIMPLE_SELECT,{featureIds:[i.line.id]}):Zn(l)&&(this.deleteFeature([i.line.id],{silent:!0}),this.changeMode(E.SIMPLE_SELECT))},nn.onStop=function(i){bt.enable(this),this.activateUIButton(),this.getFeature(i.line.id)!==void 0&&(i.line.removeCoordinate(""+i.currentVertexPosition),i.line.isValid()?this.map.fire(M.CREATE,{features:[i.line.toGeoJSON()]}):(this.deleteFeature([i.line.id],{silent:!0}),this.changeMode(E.SIMPLE_SELECT,{},{silent:!0})))},nn.onTrash=function(i){this.deleteFeature([i.line.id],{silent:!0}),this.changeMode(E.SIMPLE_SELECT)},nn.toDisplayFeatures=function(i,l,c){var v=l.properties.id===i.line.id;if(l.properties.active=v?O.ACTIVE:O.INACTIVE,!v)return c(l);l.geometry.coordinates.length<2||(l.properties.meta=D.FEATURE,c(hn(i.line.id,l.geometry.coordinates[i.direction==="forward"?l.geometry.coordinates.length-2:1],""+(i.direction==="forward"?l.geometry.coordinates.length-2:1),!1)),c(l))};var xi={simple_select:We,direct_select:zt,draw_point:Mt,draw_polygon:tn,draw_line_string:nn},Qs={defaultMode:E.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Ei,modes:xi,controls:{},userProperties:!1},$s={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},el={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Pi(i,l){return i.map(function(c){return c.source?c:Vt(c,{id:c.id+"."+l,source:l==="hot"?b.HOT:b.COLD})})}var ir={};(function(i,l){var c="__lodash_hash_undefined__",v=9007199254740991,_="[object Arguments]",y="[object Array]",w="[object Boolean]",F="[object Date]",G="[object Error]",Z="[object Function]",W="[object Map]",q="[object Number]",ce="[object Object]",Ue="[object Promise]",pe="[object RegExp]",ze="[object Set]",P="[object String]",ne="[object Symbol]",ke="[object WeakMap]",Xe="[object ArrayBuffer]",qe="[object DataView]",jr=/^\[object .+?Constructor\]$/,ol=/^(?:0|[1-9]\d*)$/,Ne={};Ne["[object Float32Array]"]=Ne["[object Float64Array]"]=Ne["[object Int8Array]"]=Ne["[object Int16Array]"]=Ne["[object Int32Array]"]=Ne["[object Uint8Array]"]=Ne["[object Uint8ClampedArray]"]=Ne["[object Uint16Array]"]=Ne["[object Uint32Array]"]=!0,Ne[_]=Ne[y]=Ne[Xe]=Ne[w]=Ne[qe]=Ne[F]=Ne[G]=Ne[Z]=Ne[W]=Ne[q]=Ne[ce]=Ne[pe]=Ne[ze]=Ne[P]=Ne[ke]=!1;var Ni=typeof Rn=="object"&&Rn&&Rn.Object===Object&&Rn,sl=typeof self=="object"&&self&&self.Object===Object&&self,Rt=Ni||sl||Function("return this")(),Ri=l&&!l.nodeType&&l,Fi=Ri&&i&&!i.nodeType&&i,Di=Fi&&Fi.exports===Ri,Br=Di&&Ni.process,Ui=function(){try{return Br&&Br.binding&&Br.binding("util")}catch{}}(),ji=Ui&&Ui.isTypedArray;function ll(S,C){for(var Y=-1,se=S==null?0:S.length;++Y<se;)if(C(S[Y],Y,S))return!0;return!1}function al(S){var C=-1,Y=Array(S.size);return S.forEach(function(se,Re){Y[++C]=[Re,se]}),Y}function ul(S){var C=-1,Y=Array(S.size);return S.forEach(function(se){Y[++C]=se}),Y}var Bi,Gi,Vi,fl=Array.prototype,cl=Function.prototype,sr=Object.prototype,Gr=Rt["__core-js_shared__"],zi=cl.toString,Ot=sr.hasOwnProperty,qi=(Bi=/[^.]+$/.exec(Gr&&Gr.keys&&Gr.keys.IE_PROTO||""))?"Symbol(src)_1."+Bi:"",Ji=sr.toString,dl=RegExp("^"+zi.call(Ot).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yi=Di?Rt.Buffer:void 0,lr=Rt.Symbol,Wi=Rt.Uint8Array,Hi=sr.propertyIsEnumerable,hl=fl.splice,rn=lr?lr.toStringTag:void 0,Zi=Object.getOwnPropertySymbols,pl=Yi?Yi.isBuffer:void 0,gl=(Gi=Object.keys,Vi=Object,function(S){return Gi(Vi(S))}),Vr=gn(Rt,"DataView"),In=gn(Rt,"Map"),zr=gn(Rt,"Promise"),qr=gn(Rt,"Set"),Jr=gn(Rt,"WeakMap"),Ln=gn(Object,"create"),ml=ln(Vr),bl=ln(In),vl=ln(zr),_l=ln(qr),yl=ln(Jr),Xi=lr?lr.prototype:void 0,Yr=Xi?Xi.valueOf:void 0;function on(S){var C=-1,Y=S==null?0:S.length;for(this.clear();++C<Y;){var se=S[C];this.set(se[0],se[1])}}function Ft(S){var C=-1,Y=S==null?0:S.length;for(this.clear();++C<Y;){var se=S[C];this.set(se[0],se[1])}}function sn(S){var C=-1,Y=S==null?0:S.length;for(this.clear();++C<Y;){var se=S[C];this.set(se[0],se[1])}}function ar(S){var C=-1,Y=S==null?0:S.length;for(this.__data__=new sn;++C<Y;)this.add(S[C])}function qt(S){var C=this.__data__=new Ft(S);this.size=C.size}function El(S,C){var Y=cr(S),se=!Y&&kl(S),Re=!Y&&!se&&Wr(S),ye=!Y&&!se&&!Re&&oo(S),Ge=Y||se||Re||ye,Je=Ge?function(Ze,It){for(var Dt=-1,nt=Array(Ze);++Dt<Ze;)nt[Dt]=It(Dt);return nt}(S.length,String):[],vt=Je.length;for(var He in S)!C&&!Ot.call(S,He)||Ge&&(He=="length"||Re&&(He=="offset"||He=="parent")||ye&&(He=="buffer"||He=="byteLength"||He=="byteOffset")||Cl(He,vt))||Je.push(He);return Je}function ur(S,C){for(var Y=S.length;Y--;)if(to(S[Y][0],C))return Y;return-1}function xn(S){return S==null?S===void 0?"[object Undefined]":"[object Null]":rn&&rn in Object(S)?function(C){var Y=Ot.call(C,rn),se=C[rn];try{C[rn]=void 0;var Re=!0}catch{}var ye=Ji.call(C);return Re&&(Y?C[rn]=se:delete C[rn]),ye}(S):function(C){return Ji.call(C)}(S)}function Ki(S){return Pn(S)&&xn(S)==_}function Qi(S,C,Y,se,Re){return S===C||(S==null||C==null||!Pn(S)&&!Pn(C)?S!=S&&C!=C:function(ye,Ge,Je,vt,He,Ze){var It=cr(ye),Dt=cr(Ge),nt=It?y:Jt(ye),Ut=Dt?y:Jt(Ge),mn=(nt=nt==_?ce:nt)==ce,dr=(Ut=Ut==_?ce:Ut)==ce,bn=nt==Ut;if(bn&&Wr(ye)){if(!Wr(Ge))return!1;It=!0,mn=!1}if(bn&&!mn)return Ze||(Ze=new qt),It||oo(ye)?$i(ye,Ge,Je,vt,He,Ze):function(Oe,Me,hr,Yt,Hr,ut,jt){switch(hr){case qe:if(Oe.byteLength!=Me.byteLength||Oe.byteOffset!=Me.byteOffset)return!1;Oe=Oe.buffer,Me=Me.buffer;case Xe:return!(Oe.byteLength!=Me.byteLength||!ut(new Wi(Oe),new Wi(Me)));case w:case F:case q:return to(+Oe,+Me);case G:return Oe.name==Me.name&&Oe.message==Me.message;case pe:case P:return Oe==Me+"";case W:var Wt=al;case ze:var Nn=1&Yt;if(Wt||(Wt=ul),Oe.size!=Me.size&&!Nn)return!1;var pr=jt.get(Oe);if(pr)return pr==Me;Yt|=2,jt.set(Oe,Me);var vn=$i(Wt(Oe),Wt(Me),Yt,Hr,ut,jt);return jt.delete(Oe),vn;case ne:if(Yr)return Yr.call(Oe)==Yr.call(Me)}return!1}(ye,Ge,nt,Je,vt,He,Ze);if(!(1&Je)){var An=mn&&Ot.call(ye,"__wrapped__"),so=dr&&Ot.call(Ge,"__wrapped__");if(An||so){var Ol=An?ye.value():ye,Il=so?Ge.value():Ge;return Ze||(Ze=new qt),He(Ol,Il,Je,vt,Ze)}}return bn?(Ze||(Ze=new qt),function(Oe,Me,hr,Yt,Hr,ut){var jt=1&hr,Wt=eo(Oe),Nn=Wt.length,pr=eo(Me).length;if(Nn!=pr&&!jt)return!1;for(var vn=Nn;vn--;){var an=Wt[vn];if(!(jt?an in Me:Ot.call(Me,an)))return!1}var lo=ut.get(Oe);if(lo&&ut.get(Me))return lo==Me;var gr=!0;ut.set(Oe,Me),ut.set(Me,Oe);for(var Zr=jt;++vn<Nn;){var mr=Oe[an=Wt[vn]],br=Me[an];if(Yt)var ao=jt?Yt(br,mr,an,Me,Oe,ut):Yt(mr,br,an,Oe,Me,ut);if(!(ao===void 0?mr===br||Hr(mr,br,hr,Yt,ut):ao)){gr=!1;break}Zr||(Zr=an=="constructor")}if(gr&&!Zr){var vr=Oe.constructor,_r=Me.constructor;vr==_r||!("constructor"in Oe)||!("constructor"in Me)||typeof vr=="function"&&vr instanceof vr&&typeof _r=="function"&&_r instanceof _r||(gr=!1)}return ut.delete(Oe),ut.delete(Me),gr}(ye,Ge,Je,vt,He,Ze)):!1}(S,C,Y,se,Qi,Re))}function wl(S){return!(!io(S)||function(C){return!!qi&&qi in C}(S))&&(no(S)?dl:jr).test(ln(S))}function Sl(S){if(Y=(C=S)&&C.constructor,se=typeof Y=="function"&&Y.prototype||sr,C!==se)return gl(S);var C,Y,se,Re=[];for(var ye in Object(S))Ot.call(S,ye)&&ye!="constructor"&&Re.push(ye);return Re}function $i(S,C,Y,se,Re,ye){var Ge=1&Y,Je=S.length,vt=C.length;if(Je!=vt&&!(Ge&&vt>Je))return!1;var He=ye.get(S);if(He&&ye.get(C))return He==C;var Ze=-1,It=!0,Dt=2&Y?new ar:void 0;for(ye.set(S,C),ye.set(C,S);++Ze<Je;){var nt=S[Ze],Ut=C[Ze];if(se)var mn=Ge?se(Ut,nt,Ze,C,S,ye):se(nt,Ut,Ze,S,C,ye);if(mn!==void 0){if(mn)continue;It=!1;break}if(Dt){if(!ll(C,function(dr,bn){if(An=bn,!Dt.has(An)&&(nt===dr||Re(nt,dr,Y,se,ye)))return Dt.push(bn);var An})){It=!1;break}}else if(nt!==Ut&&!Re(nt,Ut,Y,se,ye)){It=!1;break}}return ye.delete(S),ye.delete(C),It}function eo(S){return function(C,Y,se){var Re=Y(C);return cr(C)?Re:function(ye,Ge){for(var Je=-1,vt=Ge.length,He=ye.length;++Je<vt;)ye[He+Je]=Ge[Je];return ye}(Re,se(C))}(S,Ml,Tl)}function fr(S,C){var Y,se,Re=S.__data__;return((se=typeof(Y=C))=="string"||se=="number"||se=="symbol"||se=="boolean"?Y!=="__proto__":Y===null)?Re[typeof C=="string"?"string":"hash"]:Re.map}function gn(S,C){var Y=function(se,Re){return se==null?void 0:se[Re]}(S,C);return wl(Y)?Y:void 0}on.prototype.clear=function(){this.__data__=Ln?Ln(null):{},this.size=0},on.prototype.delete=function(S){var C=this.has(S)&&delete this.__data__[S];return this.size-=C?1:0,C},on.prototype.get=function(S){var C=this.__data__;if(Ln){var Y=C[S];return Y===c?void 0:Y}return Ot.call(C,S)?C[S]:void 0},on.prototype.has=function(S){var C=this.__data__;return Ln?C[S]!==void 0:Ot.call(C,S)},on.prototype.set=function(S,C){var Y=this.__data__;return this.size+=this.has(S)?0:1,Y[S]=Ln&&C===void 0?c:C,this},Ft.prototype.clear=function(){this.__data__=[],this.size=0},Ft.prototype.delete=function(S){var C=this.__data__,Y=ur(C,S);return!(Y<0)&&(Y==C.length-1?C.pop():hl.call(C,Y,1),--this.size,!0)},Ft.prototype.get=function(S){var C=this.__data__,Y=ur(C,S);return Y<0?void 0:C[Y][1]},Ft.prototype.has=function(S){return ur(this.__data__,S)>-1},Ft.prototype.set=function(S,C){var Y=this.__data__,se=ur(Y,S);return se<0?(++this.size,Y.push([S,C])):Y[se][1]=C,this},sn.prototype.clear=function(){this.size=0,this.__data__={hash:new on,map:new(In||Ft),string:new on}},sn.prototype.delete=function(S){var C=fr(this,S).delete(S);return this.size-=C?1:0,C},sn.prototype.get=function(S){return fr(this,S).get(S)},sn.prototype.has=function(S){return fr(this,S).has(S)},sn.prototype.set=function(S,C){var Y=fr(this,S),se=Y.size;return Y.set(S,C),this.size+=Y.size==se?0:1,this},ar.prototype.add=ar.prototype.push=function(S){return this.__data__.set(S,c),this},ar.prototype.has=function(S){return this.__data__.has(S)},qt.prototype.clear=function(){this.__data__=new Ft,this.size=0},qt.prototype.delete=function(S){var C=this.__data__,Y=C.delete(S);return this.size=C.size,Y},qt.prototype.get=function(S){return this.__data__.get(S)},qt.prototype.has=function(S){return this.__data__.has(S)},qt.prototype.set=function(S,C){var Y=this.__data__;if(Y instanceof Ft){var se=Y.__data__;if(!In||se.length<199)return se.push([S,C]),this.size=++Y.size,this;Y=this.__data__=new sn(se)}return Y.set(S,C),this.size=Y.size,this};var Tl=Zi?function(S){return S==null?[]:(S=Object(S),function(C,Y){for(var se=-1,Re=C==null?0:C.length,ye=0,Ge=[];++se<Re;){var Je=C[se];Y(Je,se,C)&&(Ge[ye++]=Je)}return Ge}(Zi(S),function(C){return Hi.call(S,C)}))}:function(){return[]},Jt=xn;function Cl(S,C){return!!(C=C??v)&&(typeof S=="number"||ol.test(S))&&S>-1&&S%1==0&&S<C}function ln(S){if(S!=null){try{return zi.call(S)}catch{}try{return S+""}catch{}}return""}function to(S,C){return S===C||S!=S&&C!=C}(Vr&&Jt(new Vr(new ArrayBuffer(1)))!=qe||In&&Jt(new In)!=W||zr&&Jt(zr.resolve())!=Ue||qr&&Jt(new qr)!=ze||Jr&&Jt(new Jr)!=ke)&&(Jt=function(S){var C=xn(S),Y=C==ce?S.constructor:void 0,se=Y?ln(Y):"";if(se)switch(se){case ml:return qe;case bl:return W;case vl:return Ue;case _l:return ze;case yl:return ke}return C});var kl=Ki(function(){return arguments}())?Ki:function(S){return Pn(S)&&Ot.call(S,"callee")&&!Hi.call(S,"callee")},cr=Array.isArray,Wr=pl||function(){return!1};function no(S){if(!io(S))return!1;var C=xn(S);return C==Z||C=="[object GeneratorFunction]"||C=="[object AsyncFunction]"||C=="[object Proxy]"}function ro(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=v}function io(S){var C=typeof S;return S!=null&&(C=="object"||C=="function")}function Pn(S){return S!=null&&typeof S=="object"}var oo=ji?function(S){return function(C){return S(C)}}(ji):function(S){return Pn(S)&&ro(S.length)&&!!Ne[xn(S)]};function Ml(S){return(C=S)!=null&&ro(C.length)&&!no(C)?El(S):Sl(S);var C}i.exports=function(S,C){return Qi(S,C)}})({get exports(){return ir},set exports(i){ir=i}},ir);var tl=ir;function Ai(i,l){return i.length===l.length&&JSON.stringify(i.map(function(c){return c}).sort())===JSON.stringify(l.map(function(c){return c}).sort())}var nl={Polygon:$e,LineString:de,Point:T,MultiPolygon:ue,MultiLineString:ue,MultiPoint:ue},rl=Object.freeze({__proto__:null,CommonSelectors:Us,constrainFeatureMovement:Dr,createMidPoint:Ti,createSupplementaryPoints:Kn,createVertex:hn,doubleClickZoom:bt,euclideanDistance:fe,featuresAt:$,getFeatureAtAndSetCursors:K,isClick:we,isEventAtCoordinates:rr,isTap:Te,mapEventToBoundingBox:H,ModeHandler:t,moveFeatures:Ur,sortFeatures:oe,stringSetsAreEqual:Ai,StringSet:I,theme:Ei,toDenseArray:mt}),il=function(i,l){var c={options:i=function(_){_===void 0&&(_={});var y=Vt(_);return _.controls||(y.controls={}),_.displayControlsDefault===!1?y.controls=Vt(el,_.controls):y.controls=Vt($s,_.controls),(y=Vt(Qs,y)).styles=Pi(y.styles,"cold").concat(Pi(y.styles,"hot")),y}(i)};l=function(_,y){return y.modes=E,y.getFeatureIdsAt=function(w){return $.click({point:w},null,_).map(function(F){return F.properties.id})},y.getSelectedIds=function(){return _.store.getSelectedIds()},y.getSelected=function(){return{type:m.FEATURE_COLLECTION,features:_.store.getSelectedIds().map(function(w){return _.store.get(w)}).map(function(w){return w.toGeoJSON()})}},y.getSelectedPoints=function(){return{type:m.FEATURE_COLLECTION,features:_.store.getSelectedCoordinates().map(function(w){return{type:m.FEATURE,properties:{},geometry:{type:m.POINT,coordinates:w.coordinates}}})}},y.set=function(w){if(w.type===void 0||w.type!==m.FEATURE_COLLECTION||!Array.isArray(w.features))throw new Error("Invalid FeatureCollection");var F=_.store.createRenderBatch(),G=_.store.getAllIds().slice(),Z=y.add(w),W=new I(Z);return(G=G.filter(function(q){return!W.has(q)})).length&&y.delete(G),F(),Z},y.add=function(w){var F=JSON.parse(JSON.stringify(Ci(w))).features.map(function(G){if(G.id=G.id||Ce(),G.geometry===null)throw new Error("Invalid geometry: null");if(_.store.get(G.id)===void 0||_.store.get(G.id).type!==G.geometry.type){var Z=nl[G.geometry.type];if(Z===void 0)throw new Error("Invalid geometry type: "+G.geometry.type+".");var W=new Z(_,G);_.store.add(W)}else{var q=_.store.get(G.id);q.properties=G.properties,tl(q.getCoordinates(),G.geometry.coordinates)||q.incomingCoords(G.geometry.coordinates)}return G.id});return _.store.render(),F},y.get=function(w){var F=_.store.get(w);if(F)return F.toGeoJSON()},y.getAll=function(){return{type:m.FEATURE_COLLECTION,features:_.store.getAll().map(function(w){return w.toGeoJSON()})}},y.delete=function(w){return _.store.delete(w,{silent:!0}),y.getMode()!==E.DIRECT_SELECT||_.store.getSelectedIds().length?_.store.render():_.events.changeMode(E.SIMPLE_SELECT,void 0,{silent:!0}),y},y.deleteAll=function(){return _.store.delete(_.store.getAllIds(),{silent:!0}),y.getMode()===E.DIRECT_SELECT?_.events.changeMode(E.SIMPLE_SELECT,void 0,{silent:!0}):_.store.render(),y},y.changeMode=function(w,F){return F===void 0&&(F={}),w===E.SIMPLE_SELECT&&y.getMode()===E.SIMPLE_SELECT?(Ai(F.featureIds||[],_.store.getSelectedIds())||(_.store.setSelected(F.featureIds,{silent:!0}),_.store.render()),y):(w===E.DIRECT_SELECT&&y.getMode()===E.DIRECT_SELECT&&F.featureId===_.store.getSelectedIds()[0]||_.events.changeMode(w,F,{silent:!0}),y)},y.getMode=function(){return _.events.getMode()},y.trash=function(){return _.events.trash({silent:!0}),y},y.combineFeatures=function(){return _.events.combineFeatures({silent:!0}),y},y.uncombineFeatures=function(){return _.events.uncombineFeatures({silent:!0}),y},y.setFeatureProperty=function(w,F,G){return _.store.setFeatureProperty(w,F,G),y},y}(c,l),c.api=l;var v=Ds(c);return l.onAdd=v.onAdd,l.onRemove=v.onRemove,l.types=h,l.options=i,l};function or(i){il(i,this)}return or.modes=xi,or.constants=N,or.lib=rl,or})})(af);const fs=Ul(ci);function cs(n){let e;return{c(){e=R("p"),e.textContent="Click an intervention to fill out its attributes"},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function uf(n){let e,t=n[0]==yn&&cs();return{c(){t&&t.c(),e=cn()},m(r,o){t&&t.m(r,o),L(r,e,o)},p(r,[o]){r[0]==yn?t||(t=cs(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ie,o:Ie,d(r){t&&t.d(r),r&&x(e)}}}const yn="edit-attribute";function Ls(){}function ff(n,e,t){let r,o,s;Ye(n,Nt,f=>t(4,r=f)),Ye(n,je,f=>t(5,o=f)),Ye(n,ft,f=>t(6,s=f));let{mode:a}=e,{changeMode:u}=e;function d(){ft.set(null)}return r.on("mousemove",f=>{if(a==yn&&s==null){let b=r.queryRenderedFeatures(f.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var g=null;b.length>0&&(g=b[0].id),_t.set(g)}}),r.on("mouseout",()=>{a==yn&&s==null&&_t.set(null)}),r.on("click",f=>{if(a==yn){let g=r.queryRenderedFeatures(f.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});g.length>0?ft.set(g[0].id):(ft.set(null),_t.set(null))}}),Da.subscribe(f=>{if(f){let g=o.features.find(b=>b.id==f);g.geometry.type=="Point"?r.flyTo({center:g.geometry.coordinates}):r.fitBounds(bi(g),{padding:200,animate:!0,duration:500}),u(yn)}}),n.$$set=f=>{"mode"in f&&t(0,a=f.mode),"changeMode"in f&&t(1,u=f.changeMode)},[a,u,Ls,d]}class cf extends Le{constructor(e){super(),xe(this,e,ff,uf,Pe,{mode:0,changeMode:1,start:2,stop:3})}get start(){return Ls}get stop(){return this.$$.ctx[3]}}function ds(n){let e;return{c(){e=R("p"),e.textContent="Click an intervention to edit its geometry"},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function df(n){let e,t=n[0]==Bt&&ds();return{c(){t&&t.c(),e=cn()},m(r,o){t&&t.m(r,o),L(r,e,o)},p(r,[o]){r[0]==Bt?t||(t=ds(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Ie,o:Ie,d(r){t&&t.d(r),r&&x(e)}}}const Bt="edit-geometry";function xs(){}function hf(n,e,t){let r;Ye(n,Nt,b=>t(7,r=b));let{mode:o}=e,{routeSnapper:s}=e,{snapTool:a}=e,{drawControls:u}=e;function d(){f&&(u.changeMode("static"),u.deleteAll(),s.stop(),je.update(b=>{let p=b.features.find(h=>h.id==f);return delete p.properties.hide_while_editing,b})),f=null,_t.set(null)}let f=null;r.on("mousemove",b=>{if(o==Bt&&f==null){let h=r.queryRenderedFeatures(b.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var p=null;h.length>0&&(p=h[0].id),_t.set(p)}}),r.on("mouseout",()=>{o==Bt&&f==null&&_t.set(null)}),r.on("click",b=>{if(o==Bt&&f==null){let p=r.queryRenderedFeatures(b.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});p.length>0&&g(p[0].id)}}),a.addEventListener("new-route",b=>{if(o==Bt){const p=b.detail;je.update(h=>{let m=h.features.find(E=>E.id==f);return m.properties.length_meters=p.properties.length_meters,m.properties.waypoints=p.properties.waypoints,delete m.properties.hide_while_editing,m.geometry=p.geometry,h}),f=null}}),a.addEventListener("no-new-route",()=>{o==Bt&&(je.update(b=>{let p=b.features.find(h=>h.id==f);return delete p.properties.hide_while_editing,b}),f=null)}),r.on("draw.update",b=>{if(o==Bt){const p=b.features[0];je.update(h=>{let m=h.features.find(E=>E.id==f);return m.geometry=p.geometry,h})}}),r.on("draw.selectionchange",b=>{o==Bt&&b.features.length==0&&(u.changeMode("static"),u.deleteAll(),je.update(p=>{let h=p.features.find(m=>m.id==f);return delete h.properties.hide_while_editing,p}),f=null)});function g(b){_t.set(null);let p;je.update(h=>(p=h.features.find(m=>m.id==b),p.properties.hide_while_editing=!0,h)),f=b,p.geometry.type=="LineString"?s.editExisting(p):p.geometry.type=="Polygon"?(u.add(p),u.changeMode("direct_select",{featureId:f})):p.geometry.type=="Point"&&(u.add(p),u.changeMode("simple_select"))}return n.$$set=b=>{"mode"in b&&t(0,o=b.mode),"routeSnapper"in b&&t(1,s=b.routeSnapper),"snapTool"in b&&t(2,a=b.snapTool),"drawControls"in b&&t(3,u=b.drawControls)},[o,s,a,u,xs,d]}class pf extends Le{constructor(e){super(),xe(this,e,hf,df,Pe,{mode:0,routeSnapper:1,snapTool:2,drawControls:3,start:4,stop:5})}get start(){return xs}get stop(){return this.$$.ctx[5]}}let me;const Ps=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Ps.decode();let Cr=new Uint8Array;function Bn(){return Cr.byteLength===0&&(Cr=new Uint8Array(me.memory.buffer)),Cr}function En(n,e){return Ps.decode(Bn().subarray(n,n+e))}const Gt=new Array(32).fill(void 0);Gt.push(void 0,null,!0,!1);let Gn=Gt.length;function Ke(n){Gn===Gt.length&&Gt.push(Gt.length+1);const e=Gn;return Gn=Gt[e],Gt[e]=n,e}function Ee(n){return Gt[n]}function gf(n){n<36||(Gt[n]=Gn,Gn=n)}function di(n){const e=Ee(n);return gf(n),e}function $r(n){return n==null}let kr=new Float64Array;function mf(){return kr.byteLength===0&&(kr=new Float64Array(me.memory.buffer)),kr}let Mr=new Int32Array;function Qe(){return Mr.byteLength===0&&(Mr=new Int32Array(me.memory.buffer)),Mr}let Kt=0;const Or=new TextEncoder("utf-8"),bf=typeof Or.encodeInto=="function"?function(n,e){return Or.encodeInto(n,e)}:function(n,e){const t=Or.encode(n);return e.set(t),{read:n.length,written:t.length}};function Sr(n,e,t){if(t===void 0){const u=Or.encode(n),d=e(u.length);return Bn().subarray(d,d+u.length).set(u),Kt=u.length,d}let r=n.length,o=e(r);const s=Bn();let a=0;for(;a<r;a++){const u=n.charCodeAt(a);if(u>127)break;s[o+a]=u}if(a!==r){a!==0&&(n=n.slice(a)),o=t(o,r,r=a+n.length*3);const u=Bn().subarray(o+a,o+r),d=bf(n,u);a+=d.written}return Kt=a,o}function hi(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let s="[";o>0&&(s+=hi(n[0]));for(let a=1;a<o;a++)s+=", "+hi(n[a]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function vf(n,e){const t=e(n.length*1);return Bn().set(n,t/1),Kt=n.length,t}function ei(n,e){try{return n.apply(this,e)}catch(t){me.__wbindgen_exn_store(Ke(t))}}class xr{static __wrap(e){const t=Object.create(xr.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();me.__wbg_jsroutesnapper_free(e)}constructor(e){try{const s=me.__wbindgen_add_to_stack_pointer(-16),a=vf(e,me.__wbindgen_malloc),u=Kt;me.jsroutesnapper_new(s,a,u);var t=Qe()[s/4+0],r=Qe()[s/4+1],o=Qe()[s/4+2];if(o)throw di(r);return xr.__wrap(t)}finally{me.__wbindgen_add_to_stack_pointer(16)}}setConfig(e){me.jsroutesnapper_setConfig(this.ptr,Ke(e))}toFinalFeature(){try{const r=me.__wbindgen_add_to_stack_pointer(-16);me.jsroutesnapper_toFinalFeature(r,this.ptr);var e=Qe()[r/4+0],t=Qe()[r/4+1];let o;return e!==0&&(o=En(e,t).slice(),me.__wbindgen_free(e,t*1)),o}finally{me.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){try{const r=me.__wbindgen_add_to_stack_pointer(-16);me.jsroutesnapper_renderGeojson(r,this.ptr);var e=Qe()[r/4+0],t=Qe()[r/4+1];return En(e,t)}finally{me.__wbindgen_add_to_stack_pointer(16),me.__wbindgen_free(e,t)}}setSnapMode(e){me.jsroutesnapper_setSnapMode(this.ptr,e)}onMouseMove(e,t,r){return me.jsroutesnapper_onMouseMove(this.ptr,e,t,r)!==0}onClick(){me.jsroutesnapper_onClick(this.ptr)}onDragStart(){return me.jsroutesnapper_onDragStart(this.ptr)!==0}onMouseUp(){return me.jsroutesnapper_onMouseUp(this.ptr)!==0}clearState(){me.jsroutesnapper_clearState(this.ptr)}editExisting(e){try{const o=me.__wbindgen_add_to_stack_pointer(-16);me.jsroutesnapper_editExisting(o,this.ptr,Ke(e));var t=Qe()[o/4+0],r=Qe()[o/4+1];if(r)throw di(t)}finally{me.__wbindgen_add_to_stack_pointer(16)}}}async function _f(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function yf(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const r=En(e,t);return Ke(r)},n.wbg.__wbindgen_object_drop_ref=function(e){di(e)},n.wbg.__wbindgen_boolean_get=function(e){const t=Ee(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_error_new=function(e,t){const r=new Error(En(e,t));return Ke(r)},n.wbg.__wbindgen_is_object=function(e){const t=Ee(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return Ee(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return Ee(e)in Ee(t)},n.wbg.__wbindgen_number_get=function(e,t){const r=Ee(t),o=typeof r=="number"?r:void 0;mf()[e/8+1]=$r(o)?0:o,Qe()[e/4+0]=!$r(o)},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return Ee(e)==Ee(t)},n.wbg.__wbindgen_string_get=function(e,t){const r=Ee(t),o=typeof r=="string"?r:void 0;var s=$r(o)?0:Sr(o,me.__wbindgen_malloc,me.__wbindgen_realloc),a=Kt;Qe()[e/4+1]=a,Qe()[e/4+0]=s},n.wbg.__wbg_String_91fba7ded13ba54c=function(e,t){const r=String(Ee(t)),o=Sr(r,me.__wbindgen_malloc,me.__wbindgen_realloc),s=Kt;Qe()[e/4+1]=s,Qe()[e/4+0]=o},n.wbg.__wbindgen_object_clone_ref=function(e){const t=Ee(e);return Ke(t)},n.wbg.__wbg_getwithrefkey_15c62c2b8546208d=function(e,t){const r=Ee(e)[Ee(t)];return Ke(r)},n.wbg.__wbg_log_4b5638ad60bdc54a=function(e){console.log(Ee(e))},n.wbg.__wbg_get_57245cc7d7c7619d=function(e,t){const r=Ee(e)[t>>>0];return Ke(r)},n.wbg.__wbg_length_6e3bbe7c8bd4dbd8=function(e){return Ee(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof Ee(e)=="function"},n.wbg.__wbg_next_579e583d33566a86=function(e){const t=Ee(e).next;return Ke(t)},n.wbg.__wbg_next_aaef7c8aa5e212ac=function(){return ei(function(e){const t=Ee(e).next();return Ke(t)},arguments)},n.wbg.__wbg_done_1b73b0672e15f234=function(e){return Ee(e).done},n.wbg.__wbg_value_1ccc36bc03462d71=function(e){const t=Ee(e).value;return Ke(t)},n.wbg.__wbg_iterator_6f9d4f28845f426c=function(){return Ke(Symbol.iterator)},n.wbg.__wbg_get_765201544a2b6869=function(){return ei(function(e,t){const r=Reflect.get(Ee(e),Ee(t));return Ke(r)},arguments)},n.wbg.__wbg_call_97ae9d8645dc388b=function(){return ei(function(e,t){const r=Ee(e).call(Ee(t));return Ke(r)},arguments)},n.wbg.__wbg_isArray_27c46c67f498e15d=function(e){return Array.isArray(Ee(e))},n.wbg.__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b=function(e){let t;try{t=Ee(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_buffer_3f3d764d4747d564=function(e){const t=Ee(e).buffer;return Ke(t)},n.wbg.__wbg_new_8c3f0052272a457a=function(e){const t=new Uint8Array(Ee(e));return Ke(t)},n.wbg.__wbg_set_83db9690f9353e79=function(e,t,r){Ee(e).set(Ee(t),r>>>0)},n.wbg.__wbg_length_9e1ae1900cb0fbd5=function(e){return Ee(e).length},n.wbg.__wbg_instanceof_Uint8Array_971eeda69eb75003=function(e){let t;try{t=Ee(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return Ke(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const r=Ee(t).stack,o=Sr(r,me.__wbindgen_malloc,me.__wbindgen_realloc),s=Kt;Qe()[e/4+1]=s,Qe()[e/4+0]=o},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){try{console.error(En(e,t))}finally{me.__wbindgen_free(e,t)}},n.wbg.__wbindgen_debug_string=function(e,t){const r=hi(Ee(t)),o=Sr(r,me.__wbindgen_malloc,me.__wbindgen_realloc),s=Kt;Qe()[e/4+1]=s,Qe()[e/4+0]=o},n.wbg.__wbindgen_throw=function(e,t){throw new Error(En(e,t))},n.wbg.__wbindgen_memory=function(){const e=me.memory;return Ke(e)},n}function Ef(n,e){return me=n.exports,As.__wbindgen_wasm_module=e,kr=new Float64Array,Mr=new Int32Array,Cr=new Uint8Array,me}async function As(n){typeof n>"u"&&(n="/atip/accordion/assets/route_snapper_bg.wasm");const e=yf();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await _f(await n,e);return Ef(t,r)}var qn,pi,Pt,Ht;class wf{constructor(e,t,r){Xr(this,qn);Xr(this,Pt);this.controlDiv=r,this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new xr(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),console.log("JsRouteSnapper ready, waiting for idle event"),this.active=!1,this.loaded=!1,this.map.once("idle",()=>{console.log("JsRouteSnapper now usable"),this.map.addSource("route-snapper",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"route-points",type:"circle",source:"route-snapper",paint:{"circle-radius":["match",["get","type"],"unimportant",10/2,10],"circle-color":["match",["get","type"],"hovered","green","important","red","black"]},filter:["in","$type","Point"]}),this.map.addLayer({id:"route-lines",type:"line",source:"route-snapper",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"black","line-width":2.5},filter:["in","$type","LineString"]}),this.loaded=!0,this.map.on("mousemove",a=>{if(!this.active)return;const u={x:a.point.x-30,y:a.point.y},d=this.map.unproject(a.point).distanceTo(this.map.unproject(u));this.inner.onMouseMove(a.lngLat.lng,a.lngLat.lat,d)&&Lt(this,Pt,Ht).call(this)}),this.map.on("click",()=>{this.active&&(this.inner.onClick(),Lt(this,Pt,Ht).call(this))}),this.map.on("dragstart",a=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()}),this.map.on("mouseup",a=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()}),document.addEventListener("keypress",a=>{this.active&&a.key=="Enter"&&(a.preventDefault(),Lt(this,qn,pi).call(this))}),document.addEventListener("keydown",a=>{this.active&&a.key=="Shift"&&(a.preventDefault(),this.inner.setSnapMode(!1),Lt(this,Pt,Ht).call(this))}),document.addEventListener("keyup",a=>{this.active&&a.key=="Shift"&&(a.preventDefault(),this.inner.setSnapMode(!0),Lt(this,Pt,Ht).call(this))}),this.stop()})}isActive(){return this.active}tearDown(){this.loaded&&(this.map.removeLayer("route-points"),this.map.removeLayer("route-lines"),this.map.removeSource("route-snapper"))}editExisting(e){if(!this.loaded){console.error("editExisting called before the map idle event received. Not starting tool.");return}e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.start(),this.inner.editExisting(e.properties.waypoints),Lt(this,Pt,Ht).call(this)}stop(){if(!this.loaded)return;this.active=!1,this.inner.clearState(),Lt(this,Pt,Ht).call(this),this.controlDiv.innerHTML="";let e=document.createElement("button");e.innerText="Route tool",e.type="button",e.onclick=()=>{this.controlDiv.dispatchEvent(new CustomEvent("activate")),this.start()},this.controlDiv.appendChild(e)}start(){if(this.active)return;this.active=!0;let e=document.createElement("button");e.type="button",e.innerText="Finish route",e.onclick=()=>{Lt(this,qn,pi).call(this)};let t=document.createElement("button");t.type="button",t.innerText="Cancel",t.onclick=()=>{this.controlDiv.dispatchEvent(new CustomEvent("no-new-route")),this.stop()},this.controlDiv.innerHTML="";let r=document.createElement("div");r.style="display: flex; justify-content: space-evenly;",r.appendChild(e),r.appendChild(t),this.controlDiv.appendChild(r);let o=document.createElement("input");o.type="checkbox",o.id="avoidDoublingBack",o.onclick=()=>{this.inner.setConfig({avoid_doubling_back:o.checked}),Lt(this,Pt,Ht).call(this)};let s=document.createElement("label");s.innerText="Avoid doubling back",s.for=o.id;let a=document.createElement("div");a.appendChild(o),a.appendChild(s),this.controlDiv.append(a);const u=document.createElement("ul");u.innerHTML="<li><b>Click</b> green points on the transport network</br>to create snapped routes</li><li>Hold <b>Shift</b> to draw a point anywhere</li><li><b>Click and drag</b> any point to move it</li><li><b>Click</b> a red waypoint to delete it</li><li>Press <b>Enter</b> to finish route</li>",this.controlDiv.appendChild(u)}}qn=new WeakSet,pi=function(){const e=this.inner.toFinalFeature();e?this.controlDiv.dispatchEvent(new CustomEvent("new-route",{detail:JSON.parse(e)})):this.controlDiv.dispatchEvent(new CustomEvent("no-new-route")),this.stop()},Pt=new WeakSet,Ht=function(){this.loaded&&this.map.getSource("route-snapper").setData(JSON.parse(this.inner.renderGeojson()))};async function Sf(n,e){const t=await fetch(n),r=t.body.getReader(),o=t.headers.get("Content-Length");let s=0,a=[];for(;;){const{done:f,value:g}=await r.read();if(f)break;a.push(g),s+=g.length;const b=100*s/o;e.style=`background: linear-gradient(to right, red ${b}%, transparent 0);`}let u=new Uint8Array(s),d=0;for(let f of a)u.set(f,d),d+=f.length;return u}function Tf(n){let e,t;return{c(){e=R("div"),t=R("div"),t.textContent="Route tool loading..."},m(r,o){L(r,e,o),k(e,t),n[8](t),n[9](e)},p:Ie,i:Ie,o:Ie,d(r){r&&x(e),n[8](null),n[9](null)}}}const ti="route";function Cf(n,e,t){let r;Ye(n,Nt,m=>t(10,r=m));let{mode:o}=e,{changeMode:s}=e,{url:a}=e,{snapTool:u}=e,d,{routeSnapper:f}=e;function g(){f.isActive()||f.start()}function b(){f==null||f.stop()}Jn(async()=>{await As(),console.log(`Grabbing ${a}`);try{const m=await Sf(a,d);t(2,f=new wf(r,m,u))}catch(m){console.log(`Route tool broke: ${m}`),t(0,u.innerHTML="Failed to load",u)}u.addEventListener("activate",()=>{s(ti)}),u.addEventListener("no-new-route",()=>{o==ti&&s("edit-attribute")}),u.addEventListener("new-route",m=>{if(o==ti){const E=m.detail;je.update(M=>(E.id=ys(M),E.properties.intervention_type="route",M.features.push(E),M)),s("edit-attribute"),ft.set(E.id)}})}),mi(()=>{f==null||f.tearDown()});function p(m){Be[m?"unshift":"push"](()=>{d=m,t(1,d)})}function h(m){Be[m?"unshift":"push"](()=>{u=m,t(0,u)})}return n.$$set=m=>{"mode"in m&&t(3,o=m.mode),"changeMode"in m&&t(4,s=m.changeMode),"url"in m&&t(5,a=m.url),"snapTool"in m&&t(0,u=m.snapTool),"routeSnapper"in m&&t(2,f=m.routeSnapper)},[u,d,f,o,s,a,g,b,p,h]}class kf extends Le{constructor(e){super(),xe(this,e,Cf,Tf,Pe,{mode:3,changeMode:4,url:5,snapTool:0,routeSnapper:2,start:6,stop:7})}get start(){return this.$$.ctx[6]}get stop(){return this.$$.ctx[7]}}function Mf(n){let e;return{c(){e=R("p"),e.innerHTML="Click the map to add a vertex. Click the last vertex or press <strong>Enter</strong> to finish."},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function Of(n){let e;return{c(){e=R("p"),e.textContent="Click the map to draw a new point"},m(t,r){L(t,e,r)},d(t){t&&x(e)}}}function If(n){let e;function t(s,a){if(s[1]=="point"&&s[0]==s[1])return Of;if(s[1]=="polygon"&&s[0]==s[1])return Mf}let r=t(n),o=r&&r(n);return{c(){o&&o.c(),e=cn()},m(s,a){o&&o.m(s,a),L(s,e,a)},p(s,[a]){r!==(r=t(s))&&(o&&o.d(1),o=r&&r(s),o&&(o.c(),o.m(e.parentNode,e)))},i:Ie,o:Ie,d(s){o&&o.d(s),s&&x(e)}}}function Lf(n,e,t){let r;Ye(n,Nt,b=>t(7,r=b));let{thisMode:o}=e,{mode:s}=e,{changeMode:a}=e,{drawControls:u}=e,d;function f(){u.changeMode(`draw_${o}`)}function g(){d=null,u.changeMode("static"),u.deleteAll()}return r.on("draw.create",b=>{if(s==o){const p=b.features[0];je.update(h=>(p.properties.intervention_type=o=="point"?"other":"area",p.id=ys(h),h.features.push(p),d=p.id,h))}}),r.on("draw.modechange",b=>{if(s==o){let p=d;a("edit-attribute"),p?(ft.set(p),d=null):console.error(`After drawing a new ${o}, we lost the new feature ID`)}}),n.$$set=b=>{"thisMode"in b&&t(0,o=b.thisMode),"mode"in b&&t(1,s=b.mode),"changeMode"in b&&t(2,a=b.changeMode),"drawControls"in b&&t(3,u=b.drawControls)},[o,s,a,u,f,g]}class hs extends Le{constructor(e){super(),xe(this,e,Lf,If,Pe,{thisMode:0,mode:1,changeMode:2,drawControls:3,start:4,stop:5})}get start(){return this.$$.ctx[4]}get stop(){return this.$$.ctx[5]}}function ps(n){let e,t,r,o,s,a,u,d,f,g,b,p,h,m,E,M,z,D,O,j,B,N,he,ee,oe,H,I,te,$,re,K,fe,we,Te,Ce,Fe={mode:n[4],changeMode:n[10]};u=new cf({props:Fe}),n[12](u);let ae=n[1]&&n[2]&&gs(n),T={thisMode:"point",mode:n[4],changeMode:n[10],drawControls:n[3]};j=new hs({props:T}),n[16](j);let de={thisMode:"polygon",mode:n[4],changeMode:n[10],drawControls:n[3]};I=new hs({props:de}),n[18](I);function $e(ue){n[20](ue)}function Tn(ue){n[21](ue)}let kt={mode:n[4],changeMode:n[10],url:n[0]};return n[1]!==void 0&&(kt.routeSnapper=n[1]),n[2]!==void 0&&(kt.snapTool=n[2]),re=new kf({props:kt}),n[19](re),Be.push(()=>wt(re,"routeSnapper",$e,n[1])),Be.push(()=>wt(re,"snapTool",Tn,n[2])),{c(){e=R("div"),t=R("div"),r=R("button"),o=ge("Edit attributes"),a=J(),be(u.$$.fragment),d=J(),f=R("div"),g=R("button"),b=ge("Edit geometry"),h=J(),ae&&ae.c(),m=J(),E=R("div"),M=R("button"),z=ge("New point"),O=J(),be(j.$$.fragment),B=J(),N=R("div"),he=R("button"),ee=ge("New polygon"),H=J(),be(I.$$.fragment),te=J(),$=R("div"),be(re.$$.fragment),U(r,"type","button"),r.disabled=s=n[4]=="edit-attribute",U(r,"class","svelte-51rdg3"),U(g,"type","button"),g.disabled=p=n[4]=="edit-geometry",U(g,"class","svelte-51rdg3"),U(M,"type","button"),M.disabled=D=n[4]=="point",U(M,"class","svelte-51rdg3"),U(he,"type","button"),he.disabled=oe=n[4]=="polygon",U(he,"class","svelte-51rdg3"),U(e,"class","toolbox svelte-51rdg3")},m(ue,ie){L(ue,e,ie),k(e,t),k(t,r),k(r,o),k(t,a),ve(u,t,null),k(e,d),k(e,f),k(f,g),k(g,b),k(f,h),ae&&ae.m(f,null),k(e,m),k(e,E),k(E,M),k(M,z),k(E,O),ve(j,E,null),k(e,B),k(e,N),k(N,he),k(he,ee),k(N,H),ve(I,N,null),k(e,te),k(e,$),ve(re,$,null),we=!0,Te||(Ce=[le(r,"click",n[11]),le(g,"click",n[13]),le(M,"click",n[15]),le(he,"click",n[17])],Te=!0)},p(ue,ie){(!we||ie&16&&s!==(s=ue[4]=="edit-attribute"))&&(r.disabled=s);const Q={};ie&16&&(Q.mode=ue[4]),u.$set(Q),(!we||ie&16&&p!==(p=ue[4]=="edit-geometry"))&&(g.disabled=p),ue[1]&&ue[2]?ae?(ae.p(ue,ie),ie&6&&V(ae,1)):(ae=gs(ue),ae.c(),V(ae,1),ae.m(f,null)):ae&&(rt(),X(ae,1,1,()=>{ae=null}),it()),(!we||ie&16&&D!==(D=ue[4]=="point"))&&(M.disabled=D);const Cn={};ie&16&&(Cn.mode=ue[4]),ie&8&&(Cn.drawControls=ue[3]),j.$set(Cn),(!we||ie&16&&oe!==(oe=ue[4]=="polygon"))&&(he.disabled=oe);const kn={};ie&16&&(kn.mode=ue[4]),ie&8&&(kn.drawControls=ue[3]),I.$set(kn);const mt={};ie&16&&(mt.mode=ue[4]),ie&1&&(mt.url=ue[0]),!K&&ie&2&&(K=!0,mt.routeSnapper=ue[1],St(()=>K=!1)),!fe&&ie&4&&(fe=!0,mt.snapTool=ue[2],St(()=>fe=!1)),re.$set(mt)},i(ue){we||(V(u.$$.fragment,ue),V(ae),V(j.$$.fragment,ue),V(I.$$.fragment,ue),V(re.$$.fragment,ue),we=!0)},o(ue){X(u.$$.fragment,ue),X(ae),X(j.$$.fragment,ue),X(I.$$.fragment,ue),X(re.$$.fragment,ue),we=!1},d(ue){ue&&x(e),n[12](null),_e(u),ae&&ae.d(),n[16](null),_e(j),n[18](null),_e(I),n[19](null),_e(re),Te=!1,Ct(Ce)}}}function gs(n){let e,t,r={mode:n[4],routeSnapper:n[1],snapTool:n[2],drawControls:n[3]};return e=new pf({props:r}),n[14](e),{c(){be(e.$$.fragment)},m(o,s){ve(e,o,s),t=!0},p(o,s){const a={};s&16&&(a.mode=o[4]),s&2&&(a.routeSnapper=o[1]),s&4&&(a.snapTool=o[2]),s&8&&(a.drawControls=o[3]),e.$set(a)},i(o){t||(V(e.$$.fragment,o),t=!0)},o(o){X(e.$$.fragment,o),t=!1},d(o){n[14](null),_e(e,o)}}}function xf(n){let e,t,r=n[3]&&ps(n);return{c(){r&&r.c(),e=cn()},m(o,s){r&&r.m(o,s),L(o,e,s),t=!0},p(o,[s]){o[3]?r?(r.p(o,s),s&8&&V(r,1)):(r=ps(o),r.c(),V(r,1),r.m(e.parentNode,e)):r&&(rt(),X(r,1,1,()=>{r=null}),it())},i(o){t||(V(r),t=!0)},o(o){X(r),t=!1},d(o){r&&r.d(o),o&&x(e)}}}function Pf(n,e,t){let r;Ye(n,Nt,H=>t(22,r=H));let{routeUrl:o}=e,s,a,u,d="edit-attribute",f,g,b,p,h;function m(H){let I={"edit-attribute":f,"edit-geometry":g,route:b,point:p,polygon:h};if(d==H){console.log(`Mode is already ${d}, not changing`);return}console.log(`Stopping old mode ${d}`),I[d].stop(),t(4,d=H),console.log(`Starting new mode ${d}`),I[d].start()}Jn(()=>{let H={};H.onSetup=function(){return this.setActionableState(),{}},H.toDisplayFeatures=function(te,$,re){re($)},t(3,u=new fs({displayControlsDefault:!1,controls:{point:!0,polygon:!0},modes:Object.assign({static:H},fs.modes)})),r.addControl(u),u.changeMode("static");let I=document.getElementsByClassName("maplibregl-ctrl-top-right");for(;I.length>0;)I[0].remove()}),mi(()=>{u&&(r.removeControl(u),t(3,u=null))});const E=()=>m("edit-attribute");function M(H){Be[H?"unshift":"push"](()=>{f=H,t(5,f)})}const z=()=>m("edit-geometry");function D(H){Be[H?"unshift":"push"](()=>{g=H,t(6,g)})}const O=()=>m("point");function j(H){Be[H?"unshift":"push"](()=>{p=H,t(8,p)})}const B=()=>m("polygon");function N(H){Be[H?"unshift":"push"](()=>{h=H,t(9,h)})}function he(H){Be[H?"unshift":"push"](()=>{b=H,t(7,b)})}function ee(H){s=H,t(1,s)}function oe(H){a=H,t(2,a)}return n.$$set=H=>{"routeUrl"in H&&t(0,o=H.routeUrl)},[o,s,a,u,d,f,g,b,p,h,m,E,M,z,D,O,j,B,N,he,ee,oe]}class Af extends Le{constructor(e){super(),xe(this,e,Pf,xf,Pe,{routeUrl:0})}}function Nf(n){let e,t,r,o,s,a,u,d;return{c(){e=R("div"),t=R("button"),t.textContent="Home",r=J(),o=R("button"),o.textContent="About",s=J(),a=R("button"),a.textContent="Instructions",U(t,"type","button"),U(t,"onclick","window.open('index.html');"),U(o,"type","button"),U(a,"type","button"),U(e,"slot","nav")},m(f,g){L(f,e,g),k(e,t),k(e,r),k(e,o),k(e,s),k(e,a),u||(d=[le(o,"click",n[6]),le(a,"click",n[7])],u=!0)},p:Ie,d(f){f&&x(e),u=!1,Ct(d)}}}function Rf(n){let e,t,r,o,s,a,u,d,f,g,b,p;return s=new Ku({props:{boundaryGeojson:n[3]}}),u=new Wu({props:{authorityName:n[4]}}),b=new Du({}),{c(){e=R("div"),t=R("h1"),r=ge(n[4]),o=J(),be(s.$$.fragment),a=J(),be(u.$$.fragment),d=J(),f=R("br"),g=J(),be(b.$$.fragment),U(e,"slot","sidebar")},m(h,m){L(h,e,m),k(e,t),k(t,r),k(t,o),ve(s,t,null),k(e,a),ve(u,e,null),k(e,d),k(e,f),k(e,g),ve(b,e,null),p=!0},p(h,m){const E={};m&8&&(E.boundaryGeojson=h[3]),s.$set(E)},i(h){p||(V(s.$$.fragment,h),V(u.$$.fragment,h),V(b.$$.fragment,h),p=!0)},o(h){X(s.$$.fragment,h),X(u.$$.fragment,h),X(b.$$.fragment,h),p=!1},d(h){h&&x(e),_e(s),_e(u),_e(b)}}}function Ff(n){let e,t,r,o,s,a,u,d,f,g,b,p;return e=new ku({props:{boundaryGeojson:n[3]}}),r=new of({}),s=new lf({}),u=new Af({props:{routeUrl:n[2]}}),f=new ef({props:{style:n[5]}}),b=new nf({}),{c(){be(e.$$.fragment),t=J(),be(r.$$.fragment),o=J(),be(s.$$.fragment),a=J(),be(u.$$.fragment),d=J(),be(f.$$.fragment),g=J(),be(b.$$.fragment)},m(h,m){ve(e,h,m),L(h,t,m),ve(r,h,m),L(h,o,m),ve(s,h,m),L(h,a,m),ve(u,h,m),L(h,d,m),ve(f,h,m),L(h,g,m),ve(b,h,m),p=!0},p(h,m){const E={};m&8&&(E.boundaryGeojson=h[3]),e.$set(E);const M={};m&4&&(M.routeUrl=h[2]),u.$set(M)},i(h){p||(V(e.$$.fragment,h),V(r.$$.fragment,h),V(s.$$.fragment,h),V(u.$$.fragment,h),V(f.$$.fragment,h),V(b.$$.fragment,h),p=!0)},o(h){X(e.$$.fragment,h),X(r.$$.fragment,h),X(s.$$.fragment,h),X(u.$$.fragment,h),X(f.$$.fragment,h),X(b.$$.fragment,h),p=!1},d(h){_e(e,h),h&&x(t),_e(r,h),h&&x(o),_e(s,h),h&&x(a),_e(u,h),h&&x(d),_e(f,h),h&&x(g),_e(b,h)}}}function Df(n){let e,t,r;return t=new Ga({props:{style:n[5],$$slots:{default:[Ff]},$$scope:{ctx:n}}}),{c(){e=R("div"),be(t.$$.fragment),U(e,"slot","main")},m(o,s){L(o,e,s),ve(t,e,null),r=!0},p(o,s){const a={};s&8204&&(a.$$scope={dirty:s,ctx:o}),t.$set(a)},i(o){r||(V(t.$$.fragment,o),r=!0)},o(o){X(t.$$.fragment,o),r=!1},d(o){o&&x(e),_e(t)}}}function Uf(n){let e,t,r,o,s,a,u,d;e=new Wa({props:{$$slots:{main:[Df],sidebar:[Rf],nav:[Nf]},$$scope:{ctx:n}}});function f(h){n[8](h)}let g={};n[0]!==void 0&&(g.open=n[0]),r=new jl({props:g}),Be.push(()=>wt(r,"open",f,n[0]));function b(h){n[9](h)}let p={};return n[1]!==void 0&&(p.open=n[1]),a=new Fa({props:p}),Be.push(()=>wt(a,"open",b,n[1])),{c(){be(e.$$.fragment),t=J(),be(r.$$.fragment),s=J(),be(a.$$.fragment)},m(h,m){ve(e,h,m),L(h,t,m),ve(r,h,m),L(h,s,m),ve(a,h,m),d=!0},p(h,[m]){const E={};m&8204&&(E.$$scope={dirty:m,ctx:h}),e.$set(E);const M={};!o&&m&1&&(o=!0,M.open=h[0],St(()=>o=!1)),r.$set(M);const z={};!u&&m&2&&(u=!0,z.open=h[1],St(()=>u=!1)),a.$set(z)},i(h){d||(V(e.$$.fragment,h),V(r.$$.fragment,h),V(a.$$.fragment,h),d=!0)},o(h){X(e.$$.fragment,h),X(r.$$.fragment,h),X(a.$$.fragment,h),d=!1},d(h){_e(e,h),h&&x(t),_e(r,h),h&&x(s),_e(a,h)}}}function jf(n,e,t){let r=!1,o=!1,s=window.location.hostname.includes("atip.uk");const a=new URLSearchParams(window.location.search);let u=a.get("authority"),d=a.get("style")||"streets";var f=`https://atip.uk/route-snappers/${u}.bin`;s||(f=`https://atip.uk/route-snappers-dev/${u}.bin`);function g(){t(0,r=!r),t(1,o=!1)}function b(){t(1,o=!o),t(0,r=!1)}let p;Jn(async()=>{t(3,p=await h())});async function h(){const z=await(await fetch(Bl)).text(),D=JSON.parse(z);return D.features=D.features.filter(O=>O.properties.name==u),D}function m(M){r=M,t(0,r)}function E(M){o=M,t(1,o)}return[r,o,f,p,u,d,g,b,m,E]}class Bf extends Le{constructor(e){super(),xe(this,e,jf,Uf,Pe,{})}}new Bf({target:document.getElementById("app")});
