import{S as N,i as Q,s as U,e as _e,d as Y,f as B,q as ae,j as G,N as ue,an as ct,G as Ce,H as Se,I as ve,J as we,t as k,h as S,aA as Ze,O as bt,aB as De,D as Me,A as ge,v as he,av as Fe,x as H,E as ke,F as be,r as Ee,u as Ie,c as ne,m as ie,w as Be,k as re,a5 as oe,ap as se,aC as _t,ao as Ke,af as Ve,a3 as kt,ay as At,a4 as Ct,a as ye,aD as St,o as mt,aE as vt,l as wt,g as We,ar as Mt,ak as Ye,ag as Lt}from"./stores-4cf8ae40.js";import{J as dt,H as zt,E as Ot}from"./files-14973b3a.js";const Tt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Et(n){let e;return{c(){e=_e("div"),e.innerHTML=`<p class="govuk-phase-banner__content"><strong class="govuk-tag govuk-phase-banner__content__tag">Alpha</strong> <span class="govuk-phase-banner__text">This is a new service. Contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      with any feedback.</span></p>`,Y(e,"class","govuk-phase-banner")},m(t,o){B(t,e,o)},p:ae,i:ae,o:ae,d(t){t&&G(e)}}}class jo extends N{constructor(e){super(),Q(this,e,null,Et,U,{})}}const Ge=ue(""),Re=ue(null);async function It(n){let e=ct(Re);if(!n||!e)return"Google (attributions loading)";let[t,o]=e,r=n.getBounds(),i=`https://tile.googleapis.com/tile/v1/viewport?session=${o}&key=${t}&zoom=${Math.floor(n.getZoom())}&north=${r.getNorth()}&south=${r.getSouth()}&east=${r.getEast()}&west=${r.getWest()}`;return(await(await fetch(i)).json()).copyright}function No(){let n=[];return dt()=="Private (development)"&&(n=n.concat([["google","Google satellite"],["Road","OS Road"],["Light","OS Light"],["Outdoor","OS Outdoor"],["bluesky","Bluesky Satellite (12.5cm)"]])),n.concat([["streets","MapTiler Streets"],["hybrid","MapTiler Satellite"],["dataviz","MapTiler Dataviz"],["uk-openzoomstack-light","OS Open Zoomstack"]])}async function qe(n){if(Re.set(null),n=="streets"||n=="hybrid"||n=="dataviz"||n=="uk-openzoomstack-light")return Ge.set("&copy; MapTiler &copy; OpenStreetMap contributors"),`https://api.maptiler.com/maps/${n}/style.json?key=MZEJTanw3WpxRvt7qDfo`;let t=await(await fetch(`${zt()}/api_keys.json`)).json(),o,r;if(n=="google"){let i=t.google,l=await Bt(i);o=`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${l}&key=${i}`,r="Google (attributions loading)",Re.set([i,l])}else n=="bluesky"?(o=`https://ogc.apps.midgard.airbusds-cint.com/apgb/wmts/rest/apgb:AP-12CM5-GB-LATEST/default/EPSG-3857/EPSG:3857:{z}/{y}/{x}?GUID=${t.bluesky}&format=image/png&TRANSPARENT=FALSE,`,r="Bluesky"):(o=`https://api.os.uk/maps/raster/v1/zxy/${n}_3857/{z}/{x}/{y}.png?key=${t.ordnance_survey}`,r="Contains OS data &copy; Crown copyright and database rights 2023");return Ge.set(r),{version:8,sources:{"raster-tiles":{type:"raster",tiles:[o],tileSize:256,attribution:r}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:"https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=MZEJTanw3WpxRvt7qDfo"}}async function Bt(n){try{let t=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${n}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in t?t.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(t)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}function Gt(n){let e,t;const o=n[2].default,r=Ce(o,n,n[1],null);return{c(){e=_e("a"),r&&r.c(),Y(e,"href",n[0]),Y(e,"target","_blank"),Y(e,"rel","noreferrer")},m(i,l){B(i,e,l),r&&r.m(e,null),t=!0},p(i,[l]){r&&r.p&&(!t||l&2)&&Se(r,o,i,i[1],t?we(o,i[1],l,null):ve(i[1]),null),(!t||l&1)&&Y(e,"href",i[0])},i(i){t||(k(r,i),t=!0)},o(i){S(r,i),t=!1},d(i){i&&G(e),r&&r.d(i)}}}function Ht(n,e,t){let{$$slots:o={},$$scope:r}=e,{href:i}=e;return n.$$set=l=>{"href"in l&&t(0,i=l.href),"$$scope"in l&&t(1,r=l.$$scope)},[i,r,o]}class Qo extends N{constructor(e){super(),Q(this,e,Ht,Gt,U,{href:0})}}let Ft=Date.now();function Pe(n){return`${n}-${Ft++}`}const Ue=Symbol.for("svelte-maplibre");function ze(){return bt(Ue)}function Pt(n){let e=new WeakMap;return t=>{var l;let o=e.get(t.originalEvent);if(o!==void 0)return o;let i=(l=t.target.queryRenderedFeatures(t.point).find(f=>{var s;return(s=n.get(f.layer.id))==null?void 0:s.interactive}))==null?void 0:l.layer.id;return e.set(t.originalEvent,i),i}}function Dt(){let n=new Map;return Ze(Ue,{map:ue(null),source:De(null),layer:De(null),popupTarget:De(null),cluster:ue(),loadedImages:ue(new Set),minzoom:ue(0),maxzoom:ue(24),layerEvent:ue(null),layerInfo:n,eventTopMost:Pt(n)})}function Je(n){return{subscribe:n.subscribe}}function je({key:n,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:o=!1}){let r=ze(),i=ue(null),l=Je(i),f={...r,[n]:Je(i)};if(e&&(f.popupTarget=l),o){let s=ue(null);f.layerEvent=s,r.layerEvent=s}return t&&(f.cluster=ue()),Ze(Ue,f),{...r,self:i}}function Rt(){return je({key:"source",setCluster:!0})}function Zt(n=!0){return je({key:"layer",setPopupTarget:n,setMouseEvent:n})}function Ko(){return je({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function Ut(n){return"layerType"in n&&n.layerType==="deckgl"}function Xe(n){let e;return t=>{if(t)for(let o in t){let r=e==null?void 0:e[o],i=t[o];r!==i&&n(o,i,r)}else if(e)for(let o in e)n(o,void 0,e[o]);e=t}}function jt(n,...e){let t=[n];for(let o of e)if(o)Array.isArray(o)&&o[0]===n?t.push(...o.slice(1)):t.push(o);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Nt(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function Vo(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}var He=Qt;function Qt(n){var e,t,o;if(n){if(Array.isArray(n)){for(e=[],t=n.length,o=0;o<t;o++){var r=n[o];r!=null&&e.push(r)}return e}if(typeof n=="object"){e={};var i=Object.keys(n);for(t=i.length,o=0;o<t;o++){var l=i[o],f=n[l];f!=null&&(e[l]=f)}return e}}}function xe(n){let e=n[0],t,o,r=pe(n);return{c(){r.c(),t=Me()},m(i,l){r.m(i,l),B(i,t,l),o=!0},p(i,l){l[0]&1&&U(e,e=i[0])?(ge(),S(r,1,1,ae),he(),r=pe(i),r.c(),k(r,1),r.m(t.parentNode,t)):r.p(i,l)},i(i){o||(k(r),o=!0)},o(i){S(r),o=!1},d(i){i&&G(t),r.d(i)}}}function pe(n){let e;const t=n[36].default,o=Ce(t,n,n[35],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i[1]&16)&&Se(o,t,r,r[35],e?we(t,r[35],i,null):ve(r[35]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function Kt(n){let e,t,o=n[0]&&xe(n);return{c(){o&&o.c(),e=Me()},m(r,i){o&&o.m(r,i),B(r,e,i),t=!0},p(r,i){r[0]?o?(o.p(r,i),i[0]&1&&k(o,1)):(o=xe(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function Vt(n,e,t){let o,r,i,l,f,s,m,c,g,b,v,h,{$$slots:A={},$$scope:y}=e,{id:w=Pe("layer")}=e,{source:E=void 0}=e,{sourceLayer:T=void 0}=e,{beforeId:F=void 0}=e,{beforeLayerType:I=void 0}=e,{type:O}=e,{paint:L=void 0}=e,{layout:_=void 0}=e,{filter:z=void 0}=e,{applyToClusters:K=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:ce=void 0}=e,{manageHoverState:q=!1}=e,{hovered:p=null}=e,{interactive:$=!0}=e,{hoverCursor:J=void 0}=e,{eventsIfTopMost:C=!1}=e;const X=Fe(),{map:V,source:j,self:le,minzoom:P,maxzoom:D,eventTopMost:x,layerInfo:W}=Zt();H(n,V,u=>t(31,g=u)),H(n,j,u=>t(32,b=u)),H(n,le,u=>t(0,c=u)),H(n,P,u=>t(34,h=u)),H(n,D,u=>t(33,v=u)),ke(()=>{c&&g&&(W.delete(c),g==null||g.removeLayer(c))});let R;function ee(u){var de,Ae;if(!$||!c||!g||C&&x(u)!==c)return;let a=u.features??[],M=(Ae=(de=a[0])==null?void 0:de.properties)==null?void 0:Ae.cluster_id,Z={event:u,map:g,clusterId:M,layer:c,source:f,features:a};X(u.type,Z)}function me(u){var de,Ae;if(!$||!c||!g||C&&x(u)!==c)return;J&&(g.getCanvas().style.cursor=J);let a=u.features??[];t(6,p=a[0]??null);let M=(Ae=(de=a[0])==null?void 0:de.properties)==null?void 0:Ae.cluster_id;X("mouseenter",{event:u,map:g,clusterId:M,layer:c,source:f,features:a})}function Le(u){var de,Ae,Qe;if(!$||!g)return;if(C&&x(u)!==c){t(6,p=null),q&&R!==void 0&&(g==null||g.setFeatureState({source:f,sourceLayer:T,id:R},{hover:!1}),R=void 0);return}g.getCanvas().style.cursor=J;let a=u.features??[],M=(Ae=(de=a[0])==null?void 0:de.properties)==null?void 0:Ae.cluster_id,Z=(Qe=a[0])==null?void 0:Qe.id;Z!==R&&(q&&(R!==void 0&&(g==null||g.setFeatureState({source:f,id:R,sourceLayer:T},{hover:!1})),g==null||g.setFeatureState({source:f,id:Z,sourceLayer:T},{hover:!0})),R=Z,t(6,p=a[0]??null)),X("mousemove",{event:u,map:g,clusterId:M,layer:c,source:f,features:a})}function fe(u){if(!(!$||!c||!g)){if(J&&(g.getCanvas().style.cursor=""),t(6,p=null),q&&R!==void 0){const a={source:f,id:R,sourceLayer:T};g==null||g.setFeatureState(a,{hover:!1}),R=void 0}X("mouseleave",{map:g,layer:c,source:f})}}let te=!0;function Oe(u){g&&(g.off("click",u,ee),g.off("dblclick",u,ee),g.off("contextmenu",u,ee),g.off("mouseenter",u,me),g.off("mousemove",u,Le),g.off("mouseleave",u,fe))}return ke(()=>{g&&c&&Oe(c)}),n.$$set=u=>{"id"in u&&t(7,w=u.id),"source"in u&&t(8,E=u.source),"sourceLayer"in u&&t(9,T=u.sourceLayer),"beforeId"in u&&t(10,F=u.beforeId),"beforeLayerType"in u&&t(11,I=u.beforeLayerType),"type"in u&&t(12,O=u.type),"paint"in u&&t(13,L=u.paint),"layout"in u&&t(14,_=u.layout),"filter"in u&&t(15,z=u.filter),"applyToClusters"in u&&t(16,K=u.applyToClusters),"minzoom"in u&&t(17,d=u.minzoom),"maxzoom"in u&&t(18,ce=u.maxzoom),"manageHoverState"in u&&t(19,q=u.manageHoverState),"hovered"in u&&t(6,p=u.hovered),"interactive"in u&&t(20,$=u.interactive),"hoverCursor"in u&&t(21,J=u.hoverCursor),"eventsIfTopMost"in u&&t(22,C=u.eventsIfTopMost),"$$scope"in u&&t(35,y=u.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&65536&&t(30,o=Nt(K)),n.$$.dirty[0]&1073774592&&t(24,r=jt("all",o,z)),n.$$.dirty[0]&131072|n.$$.dirty[1]&8&&t(26,i=d??h),n.$$.dirty[0]&262144|n.$$.dirty[1]&4&&t(25,l=ce??v),n.$$.dirty[0]&256|n.$$.dirty[1]&2&&t(29,f=E||b),n.$$.dirty[0]&654343809|n.$$.dirty[1]&1&&g&&c!==w&&f){c&&(Oe(c),W.delete(c));let u=F;if(!F&&I){let a=g.getStyle().layers,M=typeof I=="function"?I:de=>de.type===I,Z=a==null?void 0:a.find(M);Z&&(u=Z.id)}be(le,c=w,c),g.addLayer(He({id:c,type:O,source:f,"source-layer":T,filter:r,paint:L,layout:_,minzoom:i,maxzoom:l}),u),t(23,te=!0),g.on("click",c,ee),g.on("dblclick",c,ee),g.on("contextmenu",c,ee),g.on("mouseenter",c,me),g.on("mousemove",c,Le),g.on("mouseleave",c,fe)}n.$$.dirty[0]&1048577&&c&&W.set(c,{interactive:$}),n.$$.dirty[0]&1|n.$$.dirty[1]&1&&t(28,s=c?Xe((u,a)=>g==null?void 0:g.setPaintProperty(c,u,a)):void 0),n.$$.dirty[0]&1|n.$$.dirty[1]&1&&t(27,m=c?Xe((u,a)=>g==null?void 0:g.setLayoutProperty(c,u,a)):void 0),n.$$.dirty[0]&268443648&&(s==null||s(L)),n.$$.dirty[0]&134234112&&(m==null||m(_)),n.$$.dirty[0]&100663297|n.$$.dirty[1]&1&&c&&(g==null||g.setLayerZoomRange(c,i,l)),n.$$.dirty[0]&25165825|n.$$.dirty[1]&1&&c&&(te?t(23,te=!1):g==null||g.setFilter(c,r))},[c,V,j,le,P,D,p,w,E,T,F,I,O,L,_,z,K,d,ce,q,$,J,C,te,r,l,i,m,s,f,o,g,b,v,h,y,A]}class gt extends N{constructor(e){super(),Q(this,e,Vt,Kt,U,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function Wt(n){let e;const t=n[15].default,o=Ce(t,n,n[23],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&8388608)&&Se(o,t,r,r[23],e?we(t,r[23],i,null):ve(r[23]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function Yt(n){let e,t,o;function r(l){n[16](l)}let i={id:n[1],type:"fill",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],interactive:n[14],$$slots:{default:[Wt]},$$scope:{ctx:n}};return n[0]!==void 0&&(i.hovered=n[0]),e=new gt({props:i}),Ee.push(()=>Ie(e,"hovered",r)),e.$on("click",n[17]),e.$on("dblclick",n[18]),e.$on("contextmenu",n[19]),e.$on("mouseenter",n[20]),e.$on("mousemove",n[21]),e.$on("mouseleave",n[22]),{c(){ne(e.$$.fragment)},m(l,f){ie(e,l,f),o=!0},p(l,[f]){const s={};f&2&&(s.id=l[1]),f&4&&(s.source=l[2]),f&8&&(s.sourceLayer=l[3]),f&16&&(s.beforeId=l[4]),f&32&&(s.beforeLayerType=l[5]),f&64&&(s.paint=l[6]),f&128&&(s.layout=l[7]),f&256&&(s.filter=l[8]),f&512&&(s.minzoom=l[9]),f&1024&&(s.maxzoom=l[10]),f&2048&&(s.hoverCursor=l[11]),f&4096&&(s.manageHoverState=l[12]),f&8192&&(s.eventsIfTopMost=l[13]),f&16384&&(s.interactive=l[14]),f&8388608&&(s.$$scope={dirty:f,ctx:l}),!t&&f&1&&(t=!0,s.hovered=l[0],Be(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){S(e.$$.fragment,l),o=!1},d(l){re(e,l)}}}function qt(n,e,t){let{$$slots:o={},$$scope:r}=e,{id:i=Pe("fill")}=e,{source:l=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c}=e,{layout:g=void 0}=e,{filter:b=void 0}=e,{minzoom:v=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:y=!1}=e,{hovered:w=null}=e,{eventsIfTopMost:E=!1}=e,{interactive:T=!0}=e;function F(d){w=d,t(0,w)}function I(d){oe.call(this,n,d)}function O(d){oe.call(this,n,d)}function L(d){oe.call(this,n,d)}function _(d){oe.call(this,n,d)}function z(d){oe.call(this,n,d)}function K(d){oe.call(this,n,d)}return n.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,l=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,s=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,c=d.paint),"layout"in d&&t(7,g=d.layout),"filter"in d&&t(8,b=d.filter),"minzoom"in d&&t(9,v=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,y=d.manageHoverState),"hovered"in d&&t(0,w=d.hovered),"eventsIfTopMost"in d&&t(13,E=d.eventsIfTopMost),"interactive"in d&&t(14,T=d.interactive),"$$scope"in d&&t(23,r=d.$$scope)},[w,i,l,f,s,m,c,g,b,v,h,A,y,E,T,o,F,I,O,L,_,z,K,r]}class Wo extends N{constructor(e){super(),Q(this,e,qt,Yt,U,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function Jt(n,e,t){let o;const{map:r}=ze();H(n,r,s=>t(4,o=s));let{position:i="top-left"}=e,{container:l=void 0}=e,f=null;return ke(()=>{o!=null&&o.loaded()&&f&&o.removeControl(f)}),n.$$set=s=>{"position"in s&&t(1,i=s.position),"container"in s&&t(2,l=s.container)},n.$$.update=()=>{if(n.$$.dirty&30&&o&&!f){let s;typeof l=="string"?s=document.querySelector(l)??void 0:s=l,t(3,f=new se.FullscreenControl({container:s})),o.addControl(f,i)}},[r,i,l,f,o]}class Xt extends N{constructor(e){super(),Q(this,e,Jt,null,U,{position:1,container:2})}}function xt(n,e,t,o,r){let i=!1;n.getSource(e)&&(i=!0,n.removeSource(e));const l=()=>{o(e)&&(n.addSource(e,t),r())};if(i){const f=()=>{e&&(n.getSource(e)?setTimeout(f,1):l())};f()}else l()}function pt(n,e,t){_t().then(()=>{let o=ct(n);if(!o)return;o.getSource(e)===t&&o.removeSource(e)})}function $e(n){let e=n[0],t,o,r=et(n);return{c(){r.c(),t=Me()},m(i,l){r.m(i,l),B(i,t,l),o=!0},p(i,l){l&1&&U(e,e=i[0])?(ge(),S(r,1,1,ae),he(),r=et(i),r.c(),k(r,1),r.m(t.parentNode,t)):r.p(i,l)},i(i){o||(k(r),o=!0)},o(i){S(r),o=!1},d(i){i&&G(t),r.d(i)}}}function et(n){let e;const t=n[19].default,o=Ce(t,n,n[18],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&262144)&&Se(o,t,r,r[18],e?we(t,r[18],i,null):ve(r[18]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function $t(n){let e,t,o=n[0]&&$e(n);return{c(){o&&o.c(),e=Me()},m(r,i){o&&o.m(r,i),B(r,e,i),t=!0},p(r,[i]){r[0]?o?(o.p(r,i),i&1&&k(o,1)):(o=$e(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function eo(n,e,t){let o,r,i,{$$slots:l={},$$scope:f}=e,{id:s=Pe("geojson")}=e,{data:m}=e,{generateId:c=!1}=e,{promoteId:g=void 0}=e,{filter:b=void 0}=e,{lineMetrics:v=void 0}=e,{cluster:h=void 0}=e,{maxzoom:A=void 0}=e,{attribution:y=void 0}=e,{buffer:w=void 0}=e,{tolerance:E=void 0}=e;const{map:T,cluster:F,self:I}=Rt();H(n,T,_=>t(17,r=_)),H(n,F,_=>t(20,i=_)),H(n,I,_=>t(0,o=_));let O,L=!0;return ke(()=>{o&&O&&r&&(pt(T,o,O),be(I,o=null,o),t(15,O=void 0))}),n.$$set=_=>{"id"in _&&t(4,s=_.id),"data"in _&&t(5,m=_.data),"generateId"in _&&t(6,c=_.generateId),"promoteId"in _&&t(7,g=_.promoteId),"filter"in _&&t(8,b=_.filter),"lineMetrics"in _&&t(9,v=_.lineMetrics),"cluster"in _&&t(10,h=_.cluster),"maxzoom"in _&&t(11,A=_.maxzoom),"attribution"in _&&t(12,y=_.attribution),"buffer"in _&&t(13,w=_.buffer),"tolerance"in _&&t(14,E=_.tolerance),"$$scope"in _&&t(18,f=_.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&be(F,i=h,i),n.$$.dirty&196593&&r&&o!==s&&(be(I,o=s,o),xt(r,o,He({type:"geojson",data:m,filter:b,lineMetrics:v,generateId:c,promoteId:g,cluster:!!h,clusterMinPoints:h==null?void 0:h.minPoints,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius,clusterProperties:h==null?void 0:h.properties,maxzoom:A,attribution:y,buffer:w,tolerance:E}),_=>r&&_===o,()=>{o&&(t(15,O=r==null?void 0:r.getSource(o)),t(16,L=!0))})),n.$$.dirty&131088&&(r==null||r.on("style.load",()=>{t(15,O=r==null?void 0:r.getSource(s))})),n.$$.dirty&98336&&O&&(L?t(16,L=!1):O.setData(m)),n.$$.dirty&33792&&(O==null||O.setClusterOptions(He({cluster:!!h,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius})))},[o,T,F,I,s,m,c,g,b,v,h,A,y,w,E,O,L,r,f,l]}class Yo extends N{constructor(e){super(),Q(this,e,eo,$t,U,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10,maxzoom:11,attribution:12,buffer:13,tolerance:14})}}function to(n,e,t){let o;const{map:r}=ze();H(n,r,b=>t(8,o=b));let{position:i="top-left"}=e,{positionOptions:l=void 0}=e,{fitBoundsOptions:f=void 0}=e,{trackUserLocation:s=!1}=e,{showAccuracyCircle:m=!0}=e,{showUserLocation:c=!0}=e,{control:g=null}=e;return ke(()=>{o!=null&&o.loaded()&&g&&o.removeControl(g)}),n.$$set=b=>{"position"in b&&t(2,i=b.position),"positionOptions"in b&&t(3,l=b.positionOptions),"fitBoundsOptions"in b&&t(4,f=b.fitBoundsOptions),"trackUserLocation"in b&&t(5,s=b.trackUserLocation),"showAccuracyCircle"in b&&t(6,m=b.showAccuracyCircle),"showUserLocation"in b&&t(7,c=b.showUserLocation),"control"in b&&t(1,g=b.control)},n.$$.update=()=>{n.$$.dirty&510&&o&&!g&&(t(1,g=new se.GeolocateControl({positionOptions:l,fitBoundsOptions:f,trackUserLocation:s,showAccuracyCircle:m,showUserLocation:c})),o.addControl(g,i))},[r,g,i,l,f,s,m,c,o]}class oo extends N{constructor(e){super(),Q(this,e,to,null,U,{position:2,positionOptions:3,fitBoundsOptions:4,trackUserLocation:5,showAccuracyCircle:6,showUserLocation:7,control:1})}}function no(n){let e;const t=n[15].default,o=Ce(t,n,n[23],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&8388608)&&Se(o,t,r,r[23],e?we(t,r[23],i,null):ve(r[23]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function io(n){let e,t,o;function r(l){n[16](l)}let i={id:n[1],type:"line",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],interactive:n[14],$$slots:{default:[no]},$$scope:{ctx:n}};return n[0]!==void 0&&(i.hovered=n[0]),e=new gt({props:i}),Ee.push(()=>Ie(e,"hovered",r)),e.$on("click",n[17]),e.$on("dblclick",n[18]),e.$on("contextmenu",n[19]),e.$on("mouseenter",n[20]),e.$on("mousemove",n[21]),e.$on("mouseleave",n[22]),{c(){ne(e.$$.fragment)},m(l,f){ie(e,l,f),o=!0},p(l,[f]){const s={};f&2&&(s.id=l[1]),f&4&&(s.source=l[2]),f&8&&(s.sourceLayer=l[3]),f&16&&(s.beforeId=l[4]),f&32&&(s.beforeLayerType=l[5]),f&64&&(s.paint=l[6]),f&128&&(s.layout=l[7]),f&256&&(s.filter=l[8]),f&512&&(s.minzoom=l[9]),f&1024&&(s.maxzoom=l[10]),f&2048&&(s.hoverCursor=l[11]),f&4096&&(s.manageHoverState=l[12]),f&8192&&(s.eventsIfTopMost=l[13]),f&16384&&(s.interactive=l[14]),f&8388608&&(s.$$scope={dirty:f,ctx:l}),!t&&f&1&&(t=!0,s.hovered=l[0],Be(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){S(e.$$.fragment,l),o=!1},d(l){re(e,l)}}}function ro(n,e,t){let{$$slots:o={},$$scope:r}=e,{id:i=Pe("line")}=e,{source:l=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c}=e,{layout:g=void 0}=e,{filter:b=void 0}=e,{minzoom:v=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:y=!1}=e,{hovered:w=null}=e,{eventsIfTopMost:E=!1}=e,{interactive:T=!0}=e;function F(d){w=d,t(0,w)}function I(d){oe.call(this,n,d)}function O(d){oe.call(this,n,d)}function L(d){oe.call(this,n,d)}function _(d){oe.call(this,n,d)}function z(d){oe.call(this,n,d)}function K(d){oe.call(this,n,d)}return n.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,l=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,s=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,c=d.paint),"layout"in d&&t(7,g=d.layout),"filter"in d&&t(8,b=d.filter),"minzoom"in d&&t(9,v=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,y=d.manageHoverState),"hovered"in d&&t(0,w=d.hovered),"eventsIfTopMost"in d&&t(13,E=d.eventsIfTopMost),"interactive"in d&&t(14,T=d.interactive),"$$scope"in d&&t(23,r=d.$$scope)},[w,i,l,f,s,m,c,g,b,v,h,A,y,E,T,o,F,I,O,L,_,z,K,r]}class qo extends N{constructor(e){super(),Q(this,e,ro,io,U,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function lo(n,e,t){let o;const r=Fe();let{layer:i=void 0}=e;const{map:l}=ze();H(n,l,c=>t(2,o=c));function f(c){r(c.type,{...c,map:l})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],m=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return ke(()=>{if(o)if(i)for(const c of s)o.off(c,i,f);else for(const c of m)o.off(c,f)}),n.$$set=c=>{"layer"in c&&t(1,i=c.layer)},n.$$.update=()=>{if(n.$$.dirty&6&&o)if(i)for(const c of s)o.on(c,i,f);else for(const c of m)o.on(c,f)},[l,i,o]}class fo extends N{constructor(e){super(),Q(this,e,lo,null,U,{layer:1})}}function uo(n){let e=n.getCenter(),t=Math.round(n.getZoom()*100)/100,o=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,o),i=Math.round(e.lat*r)/r,l=Math.round(e.lng*r)/r,f=`${t}/${i}/${l}`,s=n.getBearing(),m=n.getPitch();return(s||m)&&(f+=`/${Math.round(s*10)/10}`),m&&(f+=`/${Math.round(m)}`),`#${f}`}function so(n){return n.replace("#","").split("/").map(parseFloat)}var Te=Ne;function Ne(n,e){return n===e||n!==n&&e!==e?!0:typeof n!=typeof e||{}.toString.call(n)!={}.toString.call(e)||n!==Object(n)||!n?!1:Array.isArray(n)?tt(n,e):{}.toString.call(n)=="[object Set]"?tt(Array.from(n),Array.from(e)):{}.toString.call(n)=="[object Object]"?co(n,e):ao(n,e)}function ao(n,e){return n.toString()===e.toString()}function tt(n,e){var t=n.length;if(t!=e.length)return!1;for(var o=0;o<t;o++)if(!Ne(n[o],e[o]))return!1;return!0}function co(n,e){var t=Object.keys(n),o=t.length;if(o!=Object.keys(e).length)return!1;for(var r=0;r<o;r++){var i=t[r];if(!(e.hasOwnProperty(i)&&Ne(n[i],e[i])))return!1}return!0}function mo(n,e,t){let o;const{map:r}=ze();H(n,r,c=>t(6,o=c));let{position:i="top-left"}=e,{showCompass:l=!0}=e,{showZoom:f=!0}=e,{visualizePitch:s=!1}=e,m=null;return ke(()=>{o!=null&&o.loaded()&&m&&o.removeControl(m)}),n.$$set=c=>{"position"in c&&t(1,i=c.position),"showCompass"in c&&t(2,l=c.showCompass),"showZoom"in c&&t(3,f=c.showZoom),"visualizePitch"in c&&t(4,s=c.visualizePitch)},n.$$.update=()=>{n.$$.dirty&126&&o&&!m&&(t(5,m=new se.NavigationControl({showCompass:l,showZoom:f,visualizePitch:s})),o.addControl(m,i))},[r,i,l,f,s,m,o]}class ht extends N{constructor(e){super(),Q(this,e,mo,null,U,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function go(n,e,t){let o;const{map:r}=ze();H(n,r,m=>t(5,o=m));let{position:i="bottom-left"}=e,{maxWidth:l=void 0}=e,{unit:f="metric"}=e,s=null;return ke(()=>{o!=null&&o.loaded()&&s&&o.removeControl(s)}),n.$$set=m=>{"position"in m&&t(1,i=m.position),"maxWidth"in m&&t(2,l=m.maxWidth),"unit"in m&&t(3,f=m.unit)},n.$$.update=()=>{n.$$.dirty&62&&o&&!s&&(t(4,s=new se.ScaleControl({maxWidth:l,unit:f})),o.addControl(s,i))},[r,i,l,f,s,o]}class yt extends N{constructor(e){super(),Q(this,e,go,null,U,{position:1,maxWidth:2,unit:3})}}const{window:ho}=Tt,yo=n=>({map:n[0]&16,loadedImages:n[0]&32,allImagesLoaded:n[0]&64}),ot=n=>({map:n[4],loadedImages:n[5],allImagesLoaded:n[6]});function nt(n){let e,t,o=n[3]&&it(n);const r=n[40].default,i=Ce(r,n,n[39],ot);return{c(){o&&o.c(),e=ye(),i&&i.c()},m(l,f){o&&o.m(l,f),B(l,e,f),i&&i.m(l,f),t=!0},p(l,f){l[3]?o?(o.p(l,f),f[0]&8&&k(o,1)):(o=it(l),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he()),i&&i.p&&(!t||f[0]&112|f[1]&256)&&Se(i,r,l,l[39],t?we(r,l[39],f,yo):ve(l[39]),ot)},i(l){t||(k(o),k(i,l),t=!0)},o(l){S(o),S(i,l),t=!1},d(l){l&&G(e),o&&o.d(l),i&&i.d(l)}}}function it(n){let e,t,o,r,i,l,f,s;return e=new ht({props:{position:n[7]}}),o=new oo({props:{position:n[7],fitBoundsOptions:{maxZoom:12}}}),i=new Xt({props:{position:n[7]}}),f=new yt({props:{position:n[7]}}),{c(){ne(e.$$.fragment),t=ye(),ne(o.$$.fragment),r=ye(),ne(i.$$.fragment),l=ye(),ne(f.$$.fragment)},m(m,c){ie(e,m,c),B(m,t,c),ie(o,m,c),B(m,r,c),ie(i,m,c),B(m,l,c),ie(f,m,c),s=!0},p(m,c){const g={};c[0]&128&&(g.position=m[7]),e.$set(g);const b={};c[0]&128&&(b.position=m[7]),o.$set(b);const v={};c[0]&128&&(v.position=m[7]),i.$set(v);const h={};c[0]&128&&(h.position=m[7]),f.$set(h)},i(m){s||(k(e.$$.fragment,m),k(o.$$.fragment,m),k(i.$$.fragment,m),k(f.$$.fragment,m),s=!0)},o(m){S(e.$$.fragment,m),S(o.$$.fragment,m),S(i.$$.fragment,m),S(f.$$.fragment,m),s=!1},d(m){m&&(G(t),G(r),G(l)),re(e,m),re(o,m),re(i,m),re(f,m)}}}function bo(n){let e,t,o,r,i,l=n[4]&&n[0]&&nt(n);return{c(){e=_e("div"),l&&l.c(),Y(e,"class",t=Ke(n[2])+" svelte-p00lfq"),Y(e,"data-testid","map-container"),Ve(e,"expand-map",!n[2])},m(f,s){B(f,e,s),l&&l.m(e,null),n[41](e),o=!0,r||(i=[kt(ho,"hashchange",n[11]),At(n[10].call(null,e))],r=!0)},p(f,s){f[4]&&f[0]?l?(l.p(f,s),s[0]&17&&k(l,1)):(l=nt(f),l.c(),k(l,1),l.m(e,null)):l&&(ge(),S(l,1,1,()=>{l=null}),he()),(!o||s[0]&4&&t!==(t=Ke(f[2])+" svelte-p00lfq"))&&Y(e,"class",t),(!o||s[0]&4)&&Ve(e,"expand-map",!f[2])},i(f){o||(k(l),o=!0)},o(f){S(l),o=!1},d(f){f&&G(e),l&&l.d(),n[41](null),r=!1,Ct(i)}}}function _o(n,e,t){let o,r,i,l,{$$slots:f={},$$scope:s}=e,{map:m=null}=e,{mapContainer:c=void 0}=e,{class:g=void 0}=e,{style:b}=e,{diffStyleUpdates:v=!1}=e,{center:h=void 0}=e,{zoom:A=void 0}=e,{pitch:y=0}=e,{bearing:w=0}=e,{bounds:E=void 0}=e,{hash:T=!1}=e,{updateHash:F=u=>{window.history.replaceState(window.history.state,"",u)}}=e,{loaded:I=!1}=e,{minZoom:O=0}=e,{maxZoom:L=22}=e,{antialias:_=void 0}=e,{zoomOnDoubleClick:z=!0}=e,{locale:K=void 0}=e,{interactive:d=!0}=e,{attributionControl:ce=!0}=e,{cooperativeGestures:q=!1}=e,{preserveDrawingBuffer:p=!1}=e,{maxBounds:$=void 0}=e,{images:J=[]}=e,{standardControls:C=!1}=e,{filterLayers:X=void 0}=e,{transformRequest:V=void 0}=e;const j=Fe(),{map:le,loadedImages:P}=Dt();H(n,le,u=>t(4,i=u)),H(n,P,u=>t(5,l=u));let D=new Set;async function x(u,a=!1){if(i&&!(!i.loaded()&&!a))if("url"in u){D.add(u.id);try{let M=await i.loadImage(u.url);i==null||i.addImage(u.id,M.data,u.options),l.add(u.id),P.set(l)}catch(M){j("error",M)}finally{D.delete(u.id)}}else i.addImage(u.id,u.data,u.options),l.add(u.id),P.set(l)}let W,R,ee,me;function Le(u){return te(),be(le,i=new se.Map(He({container:u,style:b,locale:K,center:h,zoom:A,pitch:y,bearing:w,minZoom:O,maxZoom:L,antialias:_,interactive:d,preserveDrawingBuffer:p,maxBounds:$,bounds:E,attributionControl:ce,transformRequest:V,cooperativeGestures:q})),i),i.on("load",a=>{a.target.getContainer().setAttribute("data-testid","map"),a.target.getCanvas().setAttribute("data-testid","map-canvas"),t(0,I=!0),j("load",i)}),i.on("error",a=>j("error",{...a,map:i})),i.on("movestart",a=>j("movestart",{...a,map:i})),i.on("moveend",a=>{if(t(12,h=a.target.getCenter()),t(13,A=a.target.getZoom()),t(14,y=a.target.getPitch()),t(15,w=a.target.getBearing()),t(16,E=a.target.getBounds()),j("moveend",{...a,map:i}),T){let M=new URL(window.location.href.replace(/(#.+)?$/,uo(i)));F(M)}}),i.on("click",a=>j("click",{...a,map:i})),i.on("dblclick",a=>j("dblclick",{...a,map:i})),i.on("contextmenu",a=>j("contextmenu",{...a,map:i})),i.on("zoomstart",a=>j("zoomstart",{...a,map:i})),i.on("zoom",a=>{j("zoom",{...a,map:i})}),i.on("zoomend",a=>{j("zoomend",{...a,map:i})}),i.on("style.load",()=>{if(i){const a=i.getStyle();if(t(36,W=a.layers.map(M=>M.id)),t(37,R=Object.keys(a.sources)),me)for(const[M,Z]of Object.entries(me))i.addSource(M,Z);if(ee)for(const M of ee)i.addLayer(M);for(const M of J)x(M,!0)}}),i.on("styledata",a=>{if(i&&X){const M=i.getStyle().layers;if(M)for(let Z of M)X(Z)||i.setLayoutProperty(Z.id,"visibility","none")}j("styledata",{...a,map:i})}),{destroy(){t(0,I=!1),i==null||i.remove(),be(le,i=null,i)}}}let fe=b;function te(){if(T){let u=so(window.location.hash);u.length>=3&&(t(13,A=u[0]),t(12,h=[u[2],u[1]])),u.length==5&&(t(15,w=u[3]),t(14,y=u[4]))}}function Oe(u){Ee[u?"unshift":"push"](()=>{c=u,t(1,c)})}return n.$$set=u=>{"map"in u&&t(17,m=u.map),"mapContainer"in u&&t(1,c=u.mapContainer),"class"in u&&t(2,g=u.class),"style"in u&&t(18,b=u.style),"diffStyleUpdates"in u&&t(19,v=u.diffStyleUpdates),"center"in u&&t(12,h=u.center),"zoom"in u&&t(13,A=u.zoom),"pitch"in u&&t(14,y=u.pitch),"bearing"in u&&t(15,w=u.bearing),"bounds"in u&&t(16,E=u.bounds),"hash"in u&&t(20,T=u.hash),"updateHash"in u&&t(21,F=u.updateHash),"loaded"in u&&t(0,I=u.loaded),"minZoom"in u&&t(22,O=u.minZoom),"maxZoom"in u&&t(23,L=u.maxZoom),"antialias"in u&&t(24,_=u.antialias),"zoomOnDoubleClick"in u&&t(25,z=u.zoomOnDoubleClick),"locale"in u&&t(26,K=u.locale),"interactive"in u&&t(27,d=u.interactive),"attributionControl"in u&&t(28,ce=u.attributionControl),"cooperativeGestures"in u&&t(29,q=u.cooperativeGestures),"preserveDrawingBuffer"in u&&t(30,p=u.preserveDrawingBuffer),"maxBounds"in u&&t(31,$=u.maxBounds),"images"in u&&t(32,J=u.images),"standardControls"in u&&t(3,C=u.standardControls),"filterLayers"in u&&t(33,X=u.filterLayers),"transformRequest"in u&&t(34,V=u.transformRequest),"$$scope"in u&&t(39,s=u.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&8&&t(7,o=typeof C=="boolean"?void 0:C),n.$$.dirty[0]&16&&t(17,m=i),n.$$.dirty[0]&786448|n.$$.dirty[1]&224&&i&&!Te(b,fe)){const u=i.getStyle();if(W&&(ee=u.layers.filter(a=>!W.includes(a.id))),R){const a=Object.keys(u.sources).filter(M=>!R.includes(M));me={};for(const M of a)me[M]=u.sources[M]}t(38,fe=b),i.setStyle(b,{diff:v}),be(P,l=new Set,l),t(35,D=new Set)}if(n.$$.dirty[0]&49|n.$$.dirty[1]&18&&I&&i!=null&&i.loaded())for(let u of J)!l.has(u.id)&&!D.has(u.id)&&!i.hasImage(u.id)&&x(u);if(n.$$.dirty[0]&32|n.$$.dirty[1]&2&&t(6,r=J.every(u=>l.has(u.id))),n.$$.dirty[0]&61456&&i){let u={};h!=null&&!Te(h,i==null?void 0:i.getCenter())&&(u.center=h),A!=null&&!Te(A,i==null?void 0:i.getZoom())&&(u.zoom=A),w!=null&&!Te(w,i==null?void 0:i.getBearing())&&(u.bearing=w),y!=null&&!Te(y,i==null?void 0:i.getPitch())&&(u.pitch=y),Object.keys(u).length&&i.easeTo(u)}n.$$.dirty[0]&65552&&E&&!Te(E,i==null?void 0:i.getBounds())&&(i==null||i.fitBounds(E)),n.$$.dirty[0]&33554448&&(z?i==null||i.doubleClickZoom.enable():i==null||i.doubleClickZoom.disable())},[I,c,g,C,i,l,r,o,le,P,Le,te,h,A,y,w,E,m,b,v,T,F,O,L,_,z,K,d,ce,q,p,$,J,X,V,D,W,R,fe,s,f,Oe]}class ko extends N{constructor(e){super(),Q(this,e,_o,bo,U,{map:17,mapContainer:1,class:2,style:18,diffStyleUpdates:19,center:12,zoom:13,pitch:14,bearing:15,bounds:16,hash:20,updateHash:21,loaded:0,minZoom:22,maxZoom:23,antialias:24,zoomOnDoubleClick:25,locale:26,interactive:27,attributionControl:28,cooperativeGestures:29,preserveDrawingBuffer:30,maxBounds:31,images:32,standardControls:3,filterLayers:33,transformRequest:34},null,[-1,-1])}}const Ao=n=>({features:n[0]&16,data:n[0]&16,map:n[0]&4,close:n[0]&1}),rt=n=>{var e;return{features:n[4],data:(e=n[4])==null?void 0:e[0],map:n[2],close:n[31]}};function lt(n){let e,t,o=(n[4]||n[3]instanceof se.Marker)&&ft(n);return{c(){e=_e("div"),o&&o.c()},m(r,i){B(r,e,i),o&&o.m(e,null),n[32](e),t=!0},p(r,i){r[4]||r[3]instanceof se.Marker?o?(o.p(r,i),i[0]&24&&k(o,1)):(o=ft(r),o.c(),k(o,1),o.m(e,null)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(),n[32](null)}}}function ft(n){let e;const t=n[30].default,o=Ce(t,n,n[29],rt);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i[0]&536870933)&&Se(o,t,r,r[29],e?we(t,r[29],i,Ao):ve(r[29]),rt)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function Co(n){let e,t,o=n[9].default&&lt(n);return{c(){o&&o.c(),e=Me()},m(r,i){o&&o.m(r,i),B(r,e,i),t=!0},p(r,i){r[9].default?o?(o.p(r,i),i[0]&512&&k(o,1)):(o=lt(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function So(n,e,t){let o,r,i,l,f,s,{$$slots:m={},$$scope:c}=e;const g=St(m);let{closeButton:b=void 0}=e,{closeOnClickOutside:v=!0}=e,{closeOnClickInside:h=!1}=e,{closeOnMove:A=!1}=e,{openOn:y="click"}=e,{openIfTopMost:w=!0}=e,{focusAfterOpen:E=!0}=e,{anchor:T=void 0}=e,{offset:F=void 0}=e,{popupClass:I=void 0}=e,{maxWidth:O=void 0}=e,{lngLat:L=void 0}=e,{html:_=void 0}=e,{open:z=!1}=e;const K=Fe(),{map:d,popupTarget:ce,layerEvent:q,layer:p,eventTopMost:$}=ze();H(n,d,a=>t(2,i=a)),H(n,ce,a=>t(3,f=a)),H(n,q,a=>t(28,l=a)),H(n,p,a=>t(35,s=a));const J=["click","dblclick","contextmenu"];let C,X=!1,V;function j(){if(!C)return;let a=C.getElement();!a||a===V||(V=a,y==="hover"&&(V.style.pointerEvents="none"),V.addEventListener("mouseenter",()=>{t(24,X=!0)},{passive:!0}),V.addEventListener("mouseleave",()=>{t(24,X=!1)},{passive:!0}),V.addEventListener("click",()=>{h&&t(0,z=!1)},{passive:!0}))}mt(()=>{if(i)return i.on("click",fe),i.on("contextmenu",fe),typeof f=="string"&&(i.on("click",f,x),i.on("dblclick",f,x),i.on("contextmenu",f,x),i.on("mousemove",f,Le),i.on("mouseleave",f,me),i.on("touchstart",f,R),i.on("touchend",f,ee)),()=>{i!=null&&i.loaded()&&(C==null||C.remove(),i.off("click",fe),i.off("contextmenu",fe),f instanceof se.Marker?f.getPopup()===C&&f.setPopup(void 0):typeof f=="string"&&(i.off("click",f,x),i.off("dblclick",f,x),i.off("contextmenu",f,x),i.off("mousemove",f,Le),i.off("mouseleave",f,me),i.off("touchstart",f,R),i.off("touchend",f,ee)))}});function le(a){return w?!("marker"in a)&&!Ut(a)&&$(a)!==s:!1}let P=null,D="normal";function x(a){a.type===y&&(le(a)||("layerType"in a?a.layerType==="deckgl"?(t(10,L=a.coordinate),t(4,P=a.object?[a.object]:null)):(t(10,L=a.lngLat),t(4,P=a.features??[])):(t(10,L=a.lngLat),t(4,P=a.features??[])),setTimeout(()=>t(0,z=!0))))}let W=null;function R(a){W=a.point}function ee(a){if(!W||y!=="hover")return;let M=W.dist(a.point);W=null,M<3&&(t(10,L=a.lngLat),t(4,P=a.features??[]),C.isOpen()?t(25,D="justOpened"):(t(25,D="opening"),t(0,z=!0)))}function me(a){y!=="hover"||W||D!=="normal"||(t(0,z=!1),t(4,P=null))}function Le(a){if(!(y!=="hover"||W||D!=="normal")){if(le(a)){t(0,z=!1),t(4,P=null);return}t(0,z=!0),t(4,P=a.features??[]),t(10,L=a.lngLat)}}function fe(a){if(D==="justOpened"){t(25,D="normal");return}if(!v)return;let M=[V,f instanceof se.Marker?f==null?void 0:f.getElement():null];z&&C.isOpen()&&!M.some(Z=>Z==null?void 0:Z.contains(a.originalEvent.target))&&(a.type==="contextmenu"&&y==="contextmenu"||a.type!=="contextmenu")&&t(0,z=!1)}ke(()=>{i&&(C!=null&&C.isOpen())&&C.remove()});let te;const Oe=()=>t(0,z=!1);function u(a){Ee[a?"unshift":"push"](()=>{te=a,t(1,te)})}return n.$$set=a=>{"closeButton"in a&&t(11,b=a.closeButton),"closeOnClickOutside"in a&&t(12,v=a.closeOnClickOutside),"closeOnClickInside"in a&&t(13,h=a.closeOnClickInside),"closeOnMove"in a&&t(14,A=a.closeOnMove),"openOn"in a&&t(15,y=a.openOn),"openIfTopMost"in a&&t(16,w=a.openIfTopMost),"focusAfterOpen"in a&&t(17,E=a.focusAfterOpen),"anchor"in a&&t(18,T=a.anchor),"offset"in a&&t(19,F=a.offset),"popupClass"in a&&t(20,I=a.popupClass),"maxWidth"in a&&t(21,O=a.maxWidth),"lngLat"in a&&t(10,L=a.lngLat),"html"in a&&t(22,_=a.html),"open"in a&&t(0,z=a.open),"$$scope"in a&&t(29,c=a.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&14336&&t(27,o=b??(!v&&!h)),n.$$.dirty[0]&146685952&&(C||(t(23,C=new se.Popup({closeButton:o,closeOnClick:!1,closeOnMove:A,focusAfterOpen:E,maxWidth:O,className:I,anchor:T,offset:F})),V=C.getElement(),C.on("open",()=>{t(0,z=!0),j(),K("open",C)}),C.on("close",()=>{t(0,z=!1),K("close",C)}),C.on("hover",()=>{K("hover",C)}))),n.$$.dirty[0]&8421384&&C&&f instanceof se.Marker&&(y==="click"?f.setPopup(C):f.getPopup()===C&&f.setPopup(void 0)),n.$$.dirty[0]&268468224&&J.includes(y)&&(l==null?void 0:l.type)===y&&(x(l),be(q,l=null,l)),n.$$.dirty[0]&268468224&&t(26,r=y==="hover"&&((l==null?void 0:l.type)==="mousemove"||(l==null?void 0:l.type)==="mouseenter")),n.$$.dirty[0]&352354304&&y==="hover"&&q&&(r&&l&&(l.layerType==="deckgl"?(t(10,L=l.coordinate),t(4,P=l.object?[l.object]:null)):(t(10,L=l.lngLat),t(4,P=l.features??[]))),t(0,z=(r||X)??!1)),n.$$.dirty[0]&12582914&&(te?C.setDOMContent(te):_&&C.setHTML(_)),n.$$.dirty[0]&8389632&&L&&C.setLngLat(L),n.$$.dirty[0]&41943045&&i){let a=C.isOpen();z&&!a?(C.addTo(i),D==="opening"&&t(25,D="justOpened")):!z&&a&&C.remove()}},[z,te,i,f,P,d,ce,q,p,g,L,b,v,h,A,y,w,E,T,F,I,O,_,C,X,D,r,o,l,c,m,Oe,u]}class Jo extends N{constructor(e){super(),Q(this,e,So,Co,U,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}function vo(n){let e,t,o,r;const i=[Mo,wo],l=[];function f(s,m){return s[0]?0:1}return e=f(n),t=l[e]=i[e](n),{c(){t.c(),o=Me()},m(s,m){l[e].m(s,m),B(s,o,m),r=!0},p(s,m){t.p(s,m)},i(s){r||(k(t),r=!0)},o(s){S(t),r=!1},d(s){s&&G(o),l[e].d(s)}}}function wo(n){let e,t;return e=new Ot({props:{errorMessage:"You shouldn't be able to view this app without being logged in!"}}),{c(){ne(e.$$.fragment)},m(o,r){ie(e,o,r),t=!0},p:ae,i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){S(e.$$.fragment,o),t=!1},d(o){re(e,o)}}}function Mo(n){let e;return{c(){e=_e("p"),e.textContent=`Logged in as ${n[0]}`},m(t,o){B(t,e,o)},p:ae,i:ae,o:ae,d(t){t&&G(e)}}}function Lo(n){let e=dt()=="Private (development)",t,o,r=e&&vo(n);return{c(){r&&r.c(),t=Me()},m(i,l){r&&r.m(i,l),B(i,t,l),o=!0},p(i,[l]){e&&r.p(i,l)},i(i){o||(k(r),o=!0)},o(i){S(r),o=!1},d(i){i&&G(t),r&&r.d(i)}}}function zo(n){return[vt.get("email")]}class Xo extends N{constructor(e){super(),Q(this,e,zo,Lo,U,{})}}const Oo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAQAAAC1QeVaAAAAAmJLR0QA/4ePzL8AAACgSURBVBjTY2D4D4cvGHoY2BlQwH8U2I4pCQKsDHFg3VglGRjEgazvmJLlQNjIcAnIOobbztcM5piSHUBYzxDNwMfAgMtOGKjHJpnJ8IwhhcGFYREDM6ZkCMMqoPHXGC4zBKEa5cPwBKioAAiXMIQz/GZ4yuCFkHzC4MjgxPCNoZaBjeE+kOXEcB0h+RjIdWG4AGU7w9lg4A0UesBgj8oGAP6nSFElh0b7AAAAAElFTkSuQmCC",To="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAm0lEQVRIS+2U0Q2AIAxEYQM30Q3UDXQy3UhHkE0cweuHHxKTXpuQaALJ/cE9eoXGUHjFwv6hAtSEPxFRh2su0Ayd6pWzDUwFO8700AGNVggDaGAqkNYDYQBStBvCAtwQC8AF8QA2kORlJWjQmm4BSB9M5lIyC3CZswC3OQu4PxqVef7TmYikoSs0aQ19GyMMwDp+HvsrQI3v/xFduXoiGbi1DtQAAAAASUVORK5CYII=",Eo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC",Io="/atip/assets/google_on_non_white_hdpi-368415f0.png";function Bo(n){let e,t,o,r;return{c(){e=_e("div"),t=new Mt(!1),o=wt(` |
  `),r=_e("a"),r.textContent="MapLibre",t.a=o,Y(r,"href","https://maplibre.org/"),Y(r,"target","_blank"),Y(e,"class","svelte-1yeu1m4")},m(i,l){B(i,e,l),t.m(n[0],e),We(e,o),We(e,r)},p(i,[l]){l&1&&t.p(i[0])},i:ae,o:ae,d(i){i&&G(e)}}}function Go(n,e,t){let{attribution:o}=e;return n.$$set=r=>{"attribution"in r&&t(0,o=r.attribution)},[o]}class Ho extends N{constructor(e){super(),Q(this,e,Go,Bo,U,{attribution:0})}}function ut(n){let e,t,o,r;function i(s){n[9](s)}function l(s){n[10](s)}let f={style:n[4],bounds:n[0],hash:!0,images:[{id:"chevron",url:To},{id:"cycle_parking",url:Oo},{id:"railway_station",url:Eo}],attributionControl:!1,$$slots:{default:[Fo]},$$scope:{ctx:n}};return n[3]!==void 0&&(f.loaded=n[3]),n[2]!==void 0&&(f.map=n[2]),e=new ko({props:f}),Ee.push(()=>Ie(e,"loaded",i)),Ee.push(()=>Ie(e,"map",l)),e.$on("error",Do),{c(){ne(e.$$.fragment)},m(s,m){ie(e,s,m),r=!0},p(s,m){const c={};m&16&&(c.style=s[4]),m&1&&(c.bounds=s[0]),m&2146&&(c.$$scope={dirty:m,ctx:s}),!t&&m&8&&(t=!0,c.loaded=s[3],Be(()=>t=!1)),!o&&m&4&&(o=!0,c.map=s[2],Be(()=>o=!1)),e.$set(c)},i(s){r||(k(e.$$.fragment,s),r=!0)},o(s){S(e.$$.fragment,s),r=!1},d(s){re(e,s)}}}function st(n){let e,t,o,r,i,l,f,s,m,c;e=new fo({}),e.$on("zoomend",n[7]),e.$on("moveend",n[7]),o=new Ho({props:{attribution:n[6]}}),i=new yt({}),f=new ht({props:{position:"bottom-left",visualizePitch:!0}});let g=n[1]=="google"&&at();const b=n[8].default,v=Ce(b,n,n[11],null);return{c(){ne(e.$$.fragment),t=ye(),ne(o.$$.fragment),r=ye(),ne(i.$$.fragment),l=ye(),ne(f.$$.fragment),s=ye(),g&&g.c(),m=ye(),v&&v.c()},m(h,A){ie(e,h,A),B(h,t,A),ie(o,h,A),B(h,r,A),ie(i,h,A),B(h,l,A),ie(f,h,A),B(h,s,A),g&&g.m(h,A),B(h,m,A),v&&v.m(h,A),c=!0},p(h,A){const y={};A&64&&(y.attribution=h[6]),o.$set(y),h[1]=="google"?g||(g=at(),g.c(),g.m(m.parentNode,m)):g&&(g.d(1),g=null),v&&v.p&&(!c||A&2048)&&Se(v,b,h,h[11],c?we(b,h[11],A,null):ve(h[11]),null)},i(h){c||(k(e.$$.fragment,h),k(o.$$.fragment,h),k(i.$$.fragment,h),k(f.$$.fragment,h),k(v,h),c=!0)},o(h){S(e.$$.fragment,h),S(o.$$.fragment,h),S(i.$$.fragment,h),S(f.$$.fragment,h),S(v,h),c=!1},d(h){h&&(G(t),G(r),G(l),G(s),G(m)),re(e,h),re(o,h),re(i,h),re(f,h),g&&g.d(h),v&&v.d(h)}}}function at(n){let e,t;return{c(){e=_e("img"),Lt(e.src,t=Io)||Y(e,"src",t),Y(e,"alt","Google logo"),Y(e,"class","svelte-81xaz8")},m(o,r){B(o,e,r)},d(o){o&&G(e)}}}function Fo(n){let e,t,o=n[5]&&st(n);return{c(){o&&o.c(),e=Me()},m(r,i){o&&o.m(r,i),B(r,e,i),t=!0},p(r,i){r[5]?o?(o.p(r,i),i&32&&k(o,1)):(o=st(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function Po(n){let e,t,o=n[4]&&ut(n);return{c(){e=_e("div"),o&&o.c(),Y(e,"class","map svelte-81xaz8")},m(r,i){B(r,e,i),o&&o.m(e,null),t=!0},p(r,[i]){r[4]?o?(o.p(r,i),i&16&&k(o,1)):(o=ut(r),o.c(),k(o,1),o.m(e,null)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d()}}}function Do(n){console.error(`MapLibre error: ${n.detail.error}`)}function Ro(n,e,t){let o,r;H(n,Ye,y=>t(5,o=y)),H(n,Ge,y=>t(6,r=y));let{$$slots:i={},$$scope:l}=e,{style:f}=e,{startBounds:s=void 0}=e,m=null,c,g=!1;Ze("setCamera",!window.location.hash),window.location.hash&&(s=void 0),mt(async()=>{t(4,m=await qe(f))});async function b(y){t(4,m=await qe(f));let w=new URL(window.location.href);w.searchParams.set("style",y),window.history.replaceState(null,"",w.toString())}async function v(){f=="google"&&o&&be(Ge,r=await It(o),r)}function h(y){g=y,t(3,g)}function A(y){c=y,t(2,c)}return n.$$set=y=>{"style"in y&&t(1,f=y.style),"startBounds"in y&&t(0,s=y.startBounds),"$$scope"in y&&t(11,l=y.$$scope)},n.$$.update=()=>{n.$$.dirty&12&&g&&Ye.set(c),n.$$.dirty&2&&b(f)},[s,f,c,g,m,o,r,v,i,h,A,l]}class xo extends N{constructor(e){super(),Q(this,e,Ro,Po,U,{style:1,startBounds:0})}}export{jo as A,Qo as E,Wo as F,Yo as G,Xo as L,xo as M,Jo as P,qo as a,xt as b,He as c,fo as d,gt as e,To as f,Pe as g,Vo as h,Oo as i,Eo as j,No as k,Ko as l,Tt as m,pt as r,Rt as u};
