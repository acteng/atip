import{S as me,i as $e,s as ce,g,u as ve,j as d,k as E,l as L,v as K,o as M,b as ge,a as de,c as k,p as Q,n as i,m as y,t as b,e as w,w as be,d as he,f as S,x as we,q as Ae,h as q,y as ke,z as W,A as ye,r as Se,B as Le}from"./stores-90314b69.js";import{e as se,i as Me,c as Ce,a as ze}from"./files-214d1eef.js";import{A as Fe,P as Te}from"./Popup-1fd6f9bb.js";import{D as Ee}from"./DefaultButton-bd172b0a.js";import{E as oe,R as He,F as je,d as I,g as Oe}from"./index-045aa74c.js";import{A as Be,L as De,M as Ge,G as Ie,F as Pe,h as Ne,a as Je}from"./MapLibreMap-b11bd632.js";import"./spread-8a54911c.js";function Re(a){let t,r,l;return{c(){t=g("div"),t.innerHTML=`<a href="index.html"><img src="${ve}" alt="Active Travel England logo" class="svelte-13flgp1"/></a>`,r=d(),l=g("div"),E(t,"class","black-bar svelte-13flgp1"),E(l,"class","green-bar svelte-13flgp1")},m(n,e){L(n,t,e),L(n,r,e),L(n,l,e)},p:K,i:K,o:K,d(n){n&&(M(t),M(r),M(l))}}}class qe extends me{constructor(t){super(),$e(this,t,null,Re,ce,{})}}function ie(a,t,r){const l=a.slice();return l[17]=t[r][0],l[18]=t[r][1],l}function fe(a){let t,r,l;function n(s){a[12](s)}let e={label:"Select Transport Authority or Local Authority District",options:a[1].features.map(a[11])};return a[0]!==void 0&&(e.value=a[0]),t=new Fe({props:e}),ge.push(()=>de(t,"value",n)),{c(){k(t.$$.fragment)},m(s,h){y(t,s,h),l=!0},p(s,h){const $={};h&2&&($.options=s[1].features.map(s[11])),!r&&h&1&&(r=!0,$.value=s[0],he(()=>r=!1)),t.$set($)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){w(t.$$.fragment,s),l=!1},d(s){S(t,s)}}}function Ue(a){let t;return{c(){t=q("Start")},m(r,l){L(r,t,l)},d(r){r&&M(t)}}}function ue(a){let t,r,l,n,e,s,h,$,m=se(a[4]),p=[];for(let u=0;u<m.length;u+=1)p[u]=pe(ie(a,m,u));return{c(){t=g("hr"),r=d(),l=g("p"),l.textContent="Or choose an area with existing files",n=d(),e=g("table"),s=g("thead"),s.innerHTML="<tr><th>Area</th> <th>Number of files</th></tr>",h=d(),$=g("tbody");for(let u=0;u<p.length;u+=1)p[u].c()},m(u,c){L(u,t,c),L(u,r,c),L(u,l,c),L(u,n,c),L(u,e,c),i(e,s),i(e,h),i(e,$);for(let f=0;f<p.length;f+=1)p[f]&&p[f].m($,null)},p(u,c){if(c&80){m=se(u[4]);let f;for(f=0;f<m.length;f+=1){const H=ie(u,m,f);p[f]?p[f].p(H,c):(p[f]=pe(H),p[f].c(),p[f].m($,null))}for(;f<p.length;f+=1)p[f].d(1);p.length=m.length}},d(u){u&&(M(t),M(r),M(l),M(n),M(e)),ke(p,u)}}}function pe(a){let t,r,l,n=I(a[17])+"",e,s,h,$,m=a[18]+"",p,u;return{c(){t=g("tr"),r=g("td"),l=g("a"),e=q(n),h=d(),$=g("td"),p=q(m),u=d(),E(l,"href",s=`files.html?authority=${a[17]}&schema=${a[6]}`)},m(c,f){L(c,t,f),i(t,r),i(r,l),i(l,e),i(t,h),i(t,$),i($,p),i(t,u)},p(c,f){f&16&&n!==(n=I(c[17])+"")&&W(e,n),f&80&&s!==(s=`files.html?authority=${c[17]}&schema=${c[6]}`)&&E(l,"href",s),f&16&&m!==(m=c[18]+"")&&W(p,m)},d(c){c&&M(t)}}}function Ve(a){let t,r=I(a[16].full_name)+"",l;return{c(){t=g("p"),l=q(r)},m(n,e){L(n,t,e),i(t,l)},p(n,e){e&65536&&r!==(r=I(n[16].full_name)+"")&&W(l,r)},d(n){n&&M(t)}}}function Ke(a){let t,r;return t=new Te({props:{$$slots:{default:[Ve,({props:l})=>({16:l}),({props:l})=>l?65536:0]},$$scope:{ctx:a}}}),{c(){k(t.$$.fragment)},m(l,n){y(t,l,n),r=!0},p(l,n){const e={};n&2162688&&(e.$$scope={dirty:n,ctx:l}),t.$set(e)},i(l){r||(b(t.$$.fragment,l),r=!0)},o(l){w(t.$$.fragment,l),r=!1},d(l){S(t,l)}}}function Qe(a){let t,r,l,n;return t=new Pe({props:{id:"boundaries",filter:["==",["get","level"],a[3]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":Ne(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[Ke]},$$scope:{ctx:a}}}),t.$on("click",a[8]),l=new Je({props:{id:"boundaries-outline",filter:["==",["get","level"],a[3]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){k(t.$$.fragment),r=d(),k(l.$$.fragment)},m(e,s){y(t,e,s),L(e,r,s),y(l,e,s),n=!0},p(e,s){const h={};s&8&&(h.filter=["==",["get","level"],e[3]]),s&2097152&&(h.$$scope={dirty:s,ctx:e}),t.$set(h);const $={};s&8&&($.filter=["==",["get","level"],e[3]]),l.$set($)},i(e){n||(b(t.$$.fragment,e),b(l.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),w(l.$$.fragment,e),n=!1},d(e){e&&M(r),S(t,e),S(l,e)}}}function We(a){let t,r;return t=new Ie({props:{data:a[1],generateId:!0,$$slots:{default:[Qe]},$$scope:{ctx:a}}}),{c(){k(t.$$.fragment)},m(l,n){y(t,l,n),r=!0},p(l,n){const e={};n&2&&(e.data=l[1]),n&2097160&&(e.$$scope={dirty:n,ctx:l}),t.$set(e)},i(l){r||(b(t.$$.fragment,l),r=!0)},o(l){w(t.$$.fragment,l),r=!1},d(l){S(t,l)}}}function Xe(a){let t,r,l,n,e,s,h,$,m,p,u,c,f,H,z,D,F,P,_,N,T,U,X,Y,Z,j,x,B,ee,te,J,G,O,R;l=new qe({}),s=new Be({}),m=new De({}),f=new oe({props:{errorMessage:a[7]}});let v=a[1].features.length>0&&fe(a);F=new Ee({props:{disabled:!a[5],$$slots:{default:[Ue]},$$scope:{ctx:a}}}),F.$on("click",a[9]);function _e(o){a[13](o)}let le={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};a[3]!==void 0&&(le.value=a[3]),T=new He({props:le}),ge.push(()=>de(T,"value",_e)),j=new oe({props:{errorMessage:a[2]}}),B=new je({props:{label:"Or import a GeoJSON file",onLoad:a[10]}});let A=a[4].length>0&&ue(a);return O=new Ge({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[We]},$$scope:{ctx:a}}}),{c(){t=g("div"),r=g("div"),k(l.$$.fragment),n=d(),e=g("div"),k(s.$$.fragment),h=d(),$=g("div"),k(m.$$.fragment),p=d(),u=g("h1"),u.textContent="Scheme Sketcher",c=d(),k(f.$$.fragment),H=d(),z=g("div"),v&&v.c(),D=d(),k(F.$$.fragment),P=d(),_=g("hr"),N=d(),k(T.$$.fragment),X=d(),Y=g("hr"),Z=d(),k(j.$$.fragment),x=d(),k(B.$$.fragment),ee=d(),A&&A.c(),te=d(),J=g("div"),G=g("div"),k(O.$$.fragment),Q($,"border-bottom","1px solid #b1b4b6"),Q(z,"display","flex"),Q(z,"justify-content","space-between"),E(e,"class","left svelte-zzzis3"),E(r,"class","govuk-grid-column-one-half govuk-prose left-scroll svelte-zzzis3"),E(G,"id","map"),E(G,"class","svelte-zzzis3"),E(J,"class","govuk-grid-column-one-half"),E(t,"class","govuk-grid-row")},m(o,C){L(o,t,C),i(t,r),y(l,r,null),i(r,n),i(r,e),y(s,e,null),i(e,h),i(e,$),y(m,$,null),i(e,p),i(e,u),i(e,c),y(f,e,null),i(e,H),i(e,z),v&&v.m(z,null),i(z,D),y(F,z,null),i(e,P),i(e,_),i(e,N),y(T,e,null),i(e,X),i(e,Y),i(e,Z),y(j,e,null),i(e,x),y(B,e,null),i(e,ee),A&&A.m(e,null),i(t,te),i(t,J),i(J,G),y(O,G,null),R=!0},p(o,[C]){o[1].features.length>0?v?(v.p(o,C),C&2&&b(v,1)):(v=fe(o),v.c(),b(v,1),v.m(z,D)):v&&(ye(),w(v,1,1,()=>{v=null}),be());const V={};C&32&&(V.disabled=!o[5]),C&2097152&&(V.$$scope={dirty:C,ctx:o}),F.$set(V);const re={};!U&&C&8&&(U=!0,re.value=o[3],he(()=>U=!1)),T.$set(re);const ae={};C&4&&(ae.errorMessage=o[2]),j.$set(ae),o[4].length>0?A?A.p(o,C):(A=ue(o),A.c(),A.m(e,null)):A&&(A.d(1),A=null);const ne={};C&2097162&&(ne.$$scope={dirty:C,ctx:o}),O.$set(ne)},i(o){R||(b(l.$$.fragment,o),b(s.$$.fragment,o),b(m.$$.fragment,o),b(f.$$.fragment,o),b(v),b(F.$$.fragment,o),b(T.$$.fragment,o),b(j.$$.fragment,o),b(B.$$.fragment,o),b(O.$$.fragment,o),R=!0)},o(o){w(l.$$.fragment,o),w(s.$$.fragment,o),w(m.$$.fragment,o),w(f.$$.fragment,o),w(v),w(F.$$.fragment,o),w(T.$$.fragment,o),w(j.$$.fragment,o),w(B.$$.fragment,o),w(O.$$.fragment,o),R=!1},d(o){o&&M(t),S(l),S(s),S(m),S(f),v&&v.d(),S(F),S(T),S(j),S(B),A&&A.d(),S(O)}}}function Ye(a,t,r){let l,n;we(a,Le,_=>r(6,n=_));let e={type:"FeatureCollection",features:[]},h=new URLSearchParams(window.location.search).get("error")||"",$="",m,p=new Set,u="TA",c=[];Ae(async()=>{Se(),r(1,e=await Oe());for(let _ of e.features)p.add(_.properties.full_name),Me(_.properties.full_name);r(4,c=Ce())});function f(_){window.location.href=`files.html?authority=${_.detail.features[0].properties.full_name}&schema=${n}`}function H(){window.location.href=`files.html?authority=${m}&schema=${n}`}function z(_,N){try{window.location.href=ze(_,N,e)}catch(T){r(2,$=`Couldn't import file: ${T}`)}}const D=_=>[_.properties.full_name,I(_.properties.full_name)];function F(_){m=_,r(0,m)}function P(_){u=_,r(3,u)}return a.$$.update=()=>{a.$$.dirty&1&&r(5,l=p.has(m))},[m,e,$,u,c,l,n,h,f,H,z,D,F,P]}class Ze extends me{constructor(t){super(),$e(this,t,Ye,Xe,ce,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new Ze({target:document.getElementById("app")});
