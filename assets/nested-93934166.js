var no=Object.defineProperty;var io=(n,e,t)=>e in n?no(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ce=(n,e,t)=>(io(n,typeof e!="symbol"?e+"":e,t),t),ro=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var dt=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var me=(n,e,t)=>(ro(n,e,"access private method"),t);import{S as ie,i as re,s as oe,x as Q,y as Pe,f as I,z as ft,g as P,h as S,B as xe,C as ne,p as L,D as ce,E as we,t as H,F as de,G as tt,H as J,e as A,I as be,J as k,l as G,r as Ae,K as oo,L as mt,c as N,n as R,M as Se,o as z,N as Ee,O as Tr,P as xr,d as j,m as W,q as V,Q as Wn,R as pt,T as Oe,U as Ne,V as Ie,W as Fe,X as lo,Y as cn,Z as Yt,_ as dn,$ as ge,b as he,a0 as Ar,a1 as di,a2 as so,j as Et,a3 as ao,a as De,k as qe,a4 as Ut,a5 as uo,a6 as fo,a7 as yn,a8 as Vn,a9 as hi,w as Hn,aa as co,ab as ho,ac as mi,ad as mo,ae as po,af as Zn,A as go,u as bo}from"./authorities-77f9f56c.js";function pi(n){let e,t;return{c(){e=Pe("title"),t=H(n[1])},m(i,r){P(i,e,r),S(e,t)},p(i,r){r&2&&de(t,i[1])},d(i){i&&L(e)}}}function vo(n){let e,t,i=n[1]&&pi(n),r=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],o={};for(let l=0;l<r.length;l+=1)o=Q(o,r[l]);return{c(){e=Pe("svg"),i&&i.c(),t=Pe("path"),I(t,"d","M22 16L12 26 10.6 24.6 19.2 16 10.6 7.4 12 6z"),ft(e,o)},m(l,s){P(l,e,s),i&&i.m(e,null),S(e,t)},p(l,[s]){l[1]?i?i.p(l,s):(i=pi(l),i.c(),i.m(e,t)):i&&(i.d(1),i=null),ft(e,o=xe(r,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},s&1&&{width:l[0]},s&1&&{height:l[0]},s&4&&l[2],s&8&&l[3]]))},i:ne,o:ne,d(l){l&&L(e),i&&i.d()}}}function _o(n,e,t){let i,r;const o=["size","title"];let l=ce(e,o),{size:s=16}=e,{title:a=void 0}=e;return n.$$set=u=>{t(5,e=Q(Q({},e),we(u))),t(3,l=ce(e,o)),"size"in u&&t(0,s=u.size),"title"in u&&t(1,a=u.title)},n.$$.update=()=>{t(4,i=e["aria-label"]||e["aria-labelledby"]||a),t(2,r={"aria-hidden":i?void 0:!0,role:i?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=we(e),[s,a,r,l,i]}class yo extends ie{constructor(e){super(),re(this,e,_o,vo,oe,{size:0,title:1})}}const Qn=yo;function gi(n,e,t){const i=n.slice();return i[2]=e[t].width,i}function wo(n){let e,t,i,r,o=[n[4],{style:t="width: "+n[2]+";"+n[4].style}],l={};for(let s=0;s<o.length;s+=1)l=Q(l,o[s]);return{c(){e=A("p"),be(e,l),k(e,"bx--skeleton__text",!0),k(e,"bx--skeleton__heading",n[0])},m(s,a){P(s,e,a),i||(r=[G(e,"click",n[12]),G(e,"mouseover",n[13]),G(e,"mouseenter",n[14]),G(e,"mouseleave",n[15])],i=!0)},p(s,a){be(e,l=xe(o,[a&16&&s[4],a&20&&t!==(t="width: "+s[2]+";"+s[4].style)&&{style:t}])),k(e,"bx--skeleton__text",!0),k(e,"bx--skeleton__heading",s[0])},d(s){s&&L(e),i=!1,Ae(r)}}}function ko(n){let e,t,i,r=n[3],o=[];for(let a=0;a<r.length;a+=1)o[a]=bi(gi(n,r,a));let l=[n[4]],s={};for(let a=0;a<l.length;a+=1)s=Q(s,l[a]);return{c(){e=A("div");for(let a=0;a<o.length;a+=1)o[a].c();be(e,s)},m(a,u){P(a,e,u);for(let c=0;c<o.length;c+=1)o[c].m(e,null);t||(i=[G(e,"click",n[8]),G(e,"mouseover",n[9]),G(e,"mouseenter",n[10]),G(e,"mouseleave",n[11])],t=!0)},p(a,u){if(u&9){r=a[3];let c;for(c=0;c<r.length;c+=1){const g=gi(a,r,c);o[c]?o[c].p(g,u):(o[c]=bi(g),o[c].c(),o[c].m(e,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=r.length}be(e,s=xe(l,[u&16&&a[4]]))},d(a){a&&L(e),oo(o,a),t=!1,Ae(i)}}}function bi(n){let e;return{c(){e=A("p"),mt(e,"width",n[2]),k(e,"bx--skeleton__text",!0),k(e,"bx--skeleton__heading",n[0])},m(t,i){P(t,e,i)},p(t,i){i&8&&mt(e,"width",t[2]),i&1&&k(e,"bx--skeleton__heading",t[0])},d(t){t&&L(e)}}}function So(n){let e;function t(o,l){return o[1]?ko:wo}let i=t(n),r=i(n);return{c(){r.c(),e=tt()},m(o,l){r.m(o,l),P(o,e,l)},p(o,[l]){i===(i=t(o))&&r?r.p(o,l):(r.d(1),r=i(o),r&&(r.c(),r.m(e.parentNode,e)))},i:ne,o:ne,d(o){r.d(o),o&&L(e)}}}function Eo(n,e,t){let i,r,o;const l=["lines","heading","paragraph","width"];let s=ce(e,l),{lines:a=3}=e,{heading:u=!1}=e,{paragraph:c=!1}=e,{width:g="100%"}=e;const h=[.973,.153,.567];function f(y){J.call(this,n,y)}function d(y){J.call(this,n,y)}function b(y){J.call(this,n,y)}function _(y){J.call(this,n,y)}function x(y){J.call(this,n,y)}function m(y){J.call(this,n,y)}function p(y){J.call(this,n,y)}function v(y){J.call(this,n,y)}return n.$$set=y=>{e=Q(Q({},e),we(y)),t(4,s=ce(e,l)),"lines"in y&&t(5,a=y.lines),"heading"in y&&t(0,u=y.heading),"paragraph"in y&&t(1,c=y.paragraph),"width"in y&&t(2,g=y.width)},n.$$.update=()=>{if(n.$$.dirty&4&&t(7,r=parseInt(g,10)),n.$$.dirty&4&&t(6,o=g.includes("px")),n.$$.dirty&238&&c)for(let y=0;y<a;y++){const w=o?r-75:0,C=o?r:75,M=Math.floor(h[y%3]*(C-w+1))+w+"px";t(3,i=[...i,{width:o?M:`calc(${g} - ${M})`}])}},t(3,i=[]),[u,c,g,i,s,a,o,r,f,d,b,_,x,m,p,v]}class Mo extends ie{constructor(e){super(),re(this,e,Eo,So,oe,{lines:5,heading:0,paragraph:1,width:2})}}const Ct=Mo;function vi(n,e,t){const i=n.slice();return i[9]=e[t],i}function _i(n){let e,t,i,r,o,l,s,a,u,c,g,h,f;return i=new Qn({props:{class:"bx--accordion__arrow"}}),o=new Ct({props:{class:"bx--accordion__title"}}),a=new Ct({props:{width:"90%"}}),c=new Ct({props:{width:"80%"}}),h=new Ct({props:{width:"95%"}}),{c(){e=A("li"),t=A("span"),j(i.$$.fragment),r=N(),j(o.$$.fragment),l=N(),s=A("div"),j(a.$$.fragment),u=N(),j(c.$$.fragment),g=N(),j(h.$$.fragment),k(t,"bx--accordion__heading",!0),k(s,"bx--accordion__content",!0),k(e,"bx--accordion__item",!0),k(e,"bx--accordion__item--active",!0)},m(d,b){P(d,e,b),S(e,t),W(i,t,null),S(t,r),W(o,t,null),S(e,l),S(e,s),W(a,s,null),S(s,u),W(c,s,null),S(s,g),W(h,s,null),f=!0},i(d){f||(R(i.$$.fragment,d),R(o.$$.fragment,d),R(a.$$.fragment,d),R(c.$$.fragment,d),R(h.$$.fragment,d),f=!0)},o(d){z(i.$$.fragment,d),z(o.$$.fragment,d),z(a.$$.fragment,d),z(c.$$.fragment,d),z(h.$$.fragment,d),f=!1},d(d){d&&L(e),V(i),V(o),V(a),V(c),V(h)}}}function yi(n,e){let t,i,r,o,l,s,a;return r=new Qn({props:{class:"bx--accordion__arrow"}}),l=new Ct({props:{class:"bx--accordion__title"}}),{key:n,first:null,c(){t=A("li"),i=A("span"),j(r.$$.fragment),o=N(),j(l.$$.fragment),s=N(),k(i,"bx--accordion__heading",!0),k(t,"bx--accordion__item",!0),this.first=t},m(u,c){P(u,t,c),S(t,i),W(r,i,null),S(i,o),W(l,i,null),S(t,s),a=!0},p(u,c){},i(u){a||(R(r.$$.fragment,u),R(l.$$.fragment,u),a=!0)},o(u){z(r.$$.fragment,u),z(l.$$.fragment,u),a=!1},d(u){u&&L(t),V(r),V(l)}}}function Po(n){let e,t,i=[],r=new Map,o,l,s,a=n[3]&&_i(),u=Array.from({length:n[3]?n[0]-1:n[0]},wi);const c=f=>f[9];for(let f=0;f<u.length;f+=1){let d=vi(n,u,f),b=c(d);r.set(b,i[f]=yi(b))}let g=[n[4]],h={};for(let f=0;f<g.length;f+=1)h=Q(h,g[f]);return{c(){e=A("ul"),a&&a.c(),t=N();for(let f=0;f<i.length;f+=1)i[f].c();be(e,h),k(e,"bx--skeleton",!0),k(e,"bx--accordion",!0),k(e,"bx--accordion--start",n[1]==="start"),k(e,"bx--accordion--end",n[1]==="end"),k(e,"bx--accordion--sm",n[2]==="sm"),k(e,"bx--accordion--xl",n[2]==="xl")},m(f,d){P(f,e,d),a&&a.m(e,null),S(e,t);for(let b=0;b<i.length;b+=1)i[b].m(e,null);o=!0,l||(s=[G(e,"click",n[5]),G(e,"mouseover",n[6]),G(e,"mouseenter",n[7]),G(e,"mouseleave",n[8])],l=!0)},p(f,[d]){f[3]?a?d&8&&R(a,1):(a=_i(),a.c(),R(a,1),a.m(e,t)):a&&(Se(),z(a,1,1,()=>{a=null}),Ee()),d&9&&(u=Array.from({length:f[3]?f[0]-1:f[0]},wi),Se(),i=Tr(i,d,c,1,f,u,r,e,xr,yi,null,vi),Ee()),be(e,h=xe(g,[d&16&&f[4]])),k(e,"bx--skeleton",!0),k(e,"bx--accordion",!0),k(e,"bx--accordion--start",f[1]==="start"),k(e,"bx--accordion--end",f[1]==="end"),k(e,"bx--accordion--sm",f[2]==="sm"),k(e,"bx--accordion--xl",f[2]==="xl")},i(f){if(!o){R(a);for(let d=0;d<u.length;d+=1)R(i[d]);o=!0}},o(f){z(a);for(let d=0;d<i.length;d+=1)z(i[d]);o=!1},d(f){f&&L(e),a&&a.d();for(let d=0;d<i.length;d+=1)i[d].d();l=!1,Ae(s)}}}const wi=(n,e)=>e;function Lo(n,e,t){const i=["count","align","size","open"];let r=ce(e,i),{count:o=4}=e,{align:l="end"}=e,{size:s=void 0}=e,{open:a=!0}=e;function u(f){J.call(this,n,f)}function c(f){J.call(this,n,f)}function g(f){J.call(this,n,f)}function h(f){J.call(this,n,f)}return n.$$set=f=>{e=Q(Q({},e),we(f)),t(4,r=ce(e,i)),"count"in f&&t(0,o=f.count),"align"in f&&t(1,l=f.align),"size"in f&&t(2,s=f.size),"open"in f&&t(3,a=f.open)},[o,l,s,a,r,u,c,g,h]}class To extends ie{constructor(e){super(),re(this,e,Lo,Po,oe,{count:0,align:1,size:2,open:3})}}const xo=To;function Ao(n){let e,t,i,r;const o=n[6].default,l=Oe(o,n,n[5],null);let s=[n[3]],a={};for(let u=0;u<s.length;u+=1)a=Q(a,s[u]);return{c(){e=A("ul"),l&&l.c(),be(e,a),k(e,"bx--accordion",!0),k(e,"bx--accordion--start",n[0]==="start"),k(e,"bx--accordion--end",n[0]==="end"),k(e,"bx--accordion--sm",n[1]==="sm"),k(e,"bx--accordion--xl",n[1]==="xl")},m(u,c){P(u,e,c),l&&l.m(e,null),t=!0,i||(r=[G(e,"click",n[7]),G(e,"mouseover",n[8]),G(e,"mouseenter",n[9]),G(e,"mouseleave",n[10])],i=!0)},p(u,c){l&&l.p&&(!t||c&32)&&Ne(l,o,u,u[5],t?Fe(o,u[5],c,null):Ie(u[5]),null),be(e,a=xe(s,[c&8&&u[3]])),k(e,"bx--accordion",!0),k(e,"bx--accordion--start",u[0]==="start"),k(e,"bx--accordion--end",u[0]==="end"),k(e,"bx--accordion--sm",u[1]==="sm"),k(e,"bx--accordion--xl",u[1]==="xl")},i(u){t||(R(l,u),t=!0)},o(u){z(l,u),t=!1},d(u){u&&L(e),l&&l.d(u),i=!1,Ae(r)}}}function Co(n){let e,t;const i=[n[3],{align:n[0]},{size:n[1]}];let r={};for(let o=0;o<i.length;o+=1)r=Q(r,i[o]);return e=new xo({props:r}),e.$on("click",n[11]),e.$on("mouseover",n[12]),e.$on("mouseenter",n[13]),e.$on("mouseleave",n[14]),{c(){j(e.$$.fragment)},m(o,l){W(e,o,l),t=!0},p(o,l){const s=l&11?xe(i,[l&8&&lo(o[3]),l&1&&{align:o[0]},l&2&&{size:o[1]}]):{};e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){z(e.$$.fragment,o),t=!1},d(o){V(e,o)}}}function Ro(n){let e,t,i,r;const o=[Co,Ao],l=[];function s(a,u){return a[2]?0:1}return e=s(n),t=l[e]=o[e](n),{c(){t.c(),i=tt()},m(a,u){l[e].m(a,u),P(a,i,u),r=!0},p(a,[u]){let c=e;e=s(a),e===c?l[e].p(a,u):(Se(),z(l[c],1,1,()=>{l[c]=null}),Ee(),t=l[e],t?t.p(a,u):(t=l[e]=o[e](a),t.c()),R(t,1),t.m(i.parentNode,i))},i(a){r||(R(t),r=!0)},o(a){z(t),r=!1},d(a){l[e].d(a),a&&L(i)}}}function Oo(n,e,t){const i=["align","size","disabled","skeleton"];let r=ce(e,i),{$$slots:o={},$$scope:l}=e,{align:s="end"}=e,{size:a=void 0}=e,{disabled:u=!1}=e,{skeleton:c=!1}=e;const g=pt(u);Wn("Accordion",{disableItems:g});function h(v){J.call(this,n,v)}function f(v){J.call(this,n,v)}function d(v){J.call(this,n,v)}function b(v){J.call(this,n,v)}function _(v){J.call(this,n,v)}function x(v){J.call(this,n,v)}function m(v){J.call(this,n,v)}function p(v){J.call(this,n,v)}return n.$$set=v=>{e=Q(Q({},e),we(v)),t(3,r=ce(e,i)),"align"in v&&t(0,s=v.align),"size"in v&&t(1,a=v.size),"disabled"in v&&t(4,u=v.disabled),"skeleton"in v&&t(2,c=v.skeleton),"$$scope"in v&&t(5,l=v.$$scope)},n.$$.update=()=>{n.$$.dirty&16&&g.set(u)},[s,a,c,r,u,l,o,h,f,d,b,_,x,m,p]}class No extends ie{constructor(e){super(),re(this,e,Oo,Ro,oe,{align:0,size:1,disabled:4,skeleton:2})}}const Io=No,Fo=n=>({}),ki=n=>({});function Bo(n){let e;return{c(){e=H(n[2])},m(t,i){P(t,e,i)},p(t,i){i&4&&de(e,t[2])},d(t){t&&L(e)}}}function zo(n){let e,t,i,r,o,l,s,a,u,c;i=new Qn({props:{class:"bx--accordion__arrow","aria-label":n[3]}});const g=n[7].title,h=Oe(g,n,n[6],ki),f=h||Bo(n),d=n[7].default,b=Oe(d,n,n[6],null);let _=[n[5]],x={};for(let m=0;m<_.length;m+=1)x=Q(x,_[m]);return{c(){e=A("li"),t=A("button"),j(i.$$.fragment),r=N(),o=A("div"),f&&f.c(),l=N(),s=A("div"),b&&b.c(),k(o,"bx--accordion__title",!0),I(t,"type","button"),I(t,"title",n[3]),I(t,"aria-expanded",n[0]),t.disabled=n[1],k(t,"bx--accordion__heading",!0),k(s,"bx--accordion__content",!0),be(e,x),k(e,"bx--accordion__item",!0),k(e,"bx--accordion__item--active",n[0]),k(e,"bx--accordion__item--disabled",n[1]),k(e,"bx--accordion__item--expanding",n[4]==="expanding"),k(e,"bx--accordion__item--collapsing",n[4]==="collapsing")},m(m,p){P(m,e,p),S(e,t),W(i,t,null),S(t,r),S(t,o),f&&f.m(o,null),S(e,l),S(e,s),b&&b.m(s,null),a=!0,u||(c=[G(t,"click",n[9]),G(t,"click",n[14]),G(t,"mouseover",n[10]),G(t,"mouseenter",n[11]),G(t,"mouseleave",n[12]),G(t,"keydown",n[13]),G(t,"keydown",n[15]),G(e,"animationend",n[8]),G(e,"animationend",n[16])],u=!0)},p(m,[p]){const v={};p&8&&(v["aria-label"]=m[3]),i.$set(v),h?h.p&&(!a||p&64)&&Ne(h,g,m,m[6],a?Fe(g,m[6],p,Fo):Ie(m[6]),ki):f&&f.p&&(!a||p&4)&&f.p(m,a?p:-1),(!a||p&8)&&I(t,"title",m[3]),(!a||p&1)&&I(t,"aria-expanded",m[0]),(!a||p&2)&&(t.disabled=m[1]),b&&b.p&&(!a||p&64)&&Ne(b,d,m,m[6],a?Fe(d,m[6],p,null):Ie(m[6]),null),be(e,x=xe(_,[p&32&&m[5]])),k(e,"bx--accordion__item",!0),k(e,"bx--accordion__item--active",m[0]),k(e,"bx--accordion__item--disabled",m[1]),k(e,"bx--accordion__item--expanding",m[4]==="expanding"),k(e,"bx--accordion__item--collapsing",m[4]==="collapsing")},i(m){a||(R(i.$$.fragment,m),R(f,m),R(b,m),a=!0)},o(m){z(i.$$.fragment,m),z(f,m),z(b,m),a=!1},d(m){m&&L(e),V(i),f&&f.d(m),b&&b.d(m),u=!1,Ae(c)}}}function Do(n,e,t){const i=["title","open","disabled","iconDescription"];let r=ce(e,i),{$$slots:o={},$$scope:l}=e,{title:s="title"}=e,{open:a=!1}=e,{disabled:u=!1}=e,{iconDescription:c="Expand/Collapse"}=e,g=u;const f=cn("Accordion").disableItems.subscribe(M=>{!M&&g||t(1,u=M)});let d;Yt(()=>()=>{f()});function b(M){J.call(this,n,M)}function _(M){J.call(this,n,M)}function x(M){J.call(this,n,M)}function m(M){J.call(this,n,M)}function p(M){J.call(this,n,M)}function v(M){J.call(this,n,M)}const y=()=>{t(0,a=!a),t(4,d=a?"expanding":"collapsing")},w=({key:M})=>{a&&M==="Escape"&&t(0,a=!1)},C=()=>{t(4,d=void 0)};return n.$$set=M=>{e=Q(Q({},e),we(M)),t(5,r=ce(e,i)),"title"in M&&t(2,s=M.title),"open"in M&&t(0,a=M.open),"disabled"in M&&t(1,u=M.disabled),"iconDescription"in M&&t(3,c=M.iconDescription),"$$scope"in M&&t(6,l=M.$$scope)},[a,u,s,c,d,r,l,o,b,_,x,m,p,v,y,w,C]}class qo extends ie{constructor(e){super(),re(this,e,Do,zo,oe,{title:2,open:0,disabled:1,iconDescription:3})}}const Go=qo;function Si(n){let e,t;return{c(){e=Pe("title"),t=H(n[1])},m(i,r){P(i,e,r),S(e,t)},p(i,r){r&2&&de(t,i[1])},d(i){i&&L(e)}}}function Yo(n){let e,t,i,r=n[1]&&Si(n),o=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],l={};for(let s=0;s<o.length;s+=1)l=Q(l,o[s]);return{c(){e=Pe("svg"),r&&r.c(),t=Pe("path"),i=Pe("path"),I(t,"d","M16,2C8.3,2,2,8.3,2,16s6.3,14,14,14s14-6.3,14-14C30,8.3,23.7,2,16,2z M14.9,8h2.2v11h-2.2V8z M16,25	c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22c0.8,0,1.5,0.7,1.5,1.5S16.8,25,16,25z"),I(i,"fill","none"),I(i,"d","M17.5,23.5c0,0.8-0.7,1.5-1.5,1.5c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22	C16.8,22,17.5,22.7,17.5,23.5z M17.1,8h-2.2v11h2.2V8z"),I(i,"data-icon-path","inner-path"),I(i,"opacity","0"),ft(e,l)},m(s,a){P(s,e,a),r&&r.m(e,null),S(e,t),S(e,i)},p(s,[a]){s[1]?r?r.p(s,a):(r=Si(s),r.c(),r.m(e,t)):r&&(r.d(1),r=null),ft(e,l=xe(o,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},a&1&&{width:s[0]},a&1&&{height:s[0]},a&4&&s[2],a&8&&s[3]]))},i:ne,o:ne,d(s){s&&L(e),r&&r.d()}}}function Xo(n,e,t){let i,r;const o=["size","title"];let l=ce(e,o),{size:s=16}=e,{title:a=void 0}=e;return n.$$set=u=>{t(5,e=Q(Q({},e),we(u))),t(3,l=ce(e,o)),"size"in u&&t(0,s=u.size),"title"in u&&t(1,a=u.title)},n.$$.update=()=>{t(4,i=e["aria-label"]||e["aria-labelledby"]||a),t(2,r={"aria-hidden":i?void 0:!0,role:i?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=we(e),[s,a,r,l,i]}class Jo extends ie{constructor(e){super(),re(this,e,Xo,Yo,oe,{size:0,title:1})}}const Cr=Jo;function Ei(n){let e,t;return{c(){e=Pe("title"),t=H(n[1])},m(i,r){P(i,e,r),S(e,t)},p(i,r){r&2&&de(t,i[1])},d(i){i&&L(e)}}}function Uo(n){let e,t,i,r,o=n[1]&&Ei(n),l=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],s={};for(let a=0;a<l.length;a+=1)s=Q(s,l[a]);return{c(){e=Pe("svg"),o&&o.c(),t=Pe("path"),i=Pe("path"),r=Pe("path"),I(t,"fill","none"),I(t,"d","M16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Zm-1.125-5h2.25V12h-2.25Z"),I(t,"data-icon-path","inner-path"),I(i,"d","M16.002,6.1714h-.004L4.6487,27.9966,4.6506,28H27.3494l.0019-.0034ZM14.875,12h2.25v9h-2.25ZM16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Z"),I(r,"d","M29,30H3a1,1,0,0,1-.8872-1.4614l13-25a1,1,0,0,1,1.7744,0l13,25A1,1,0,0,1,29,30ZM4.6507,28H27.3493l.002-.0033L16.002,6.1714h-.004L4.6487,27.9967Z"),ft(e,s)},m(a,u){P(a,e,u),o&&o.m(e,null),S(e,t),S(e,i),S(e,r)},p(a,[u]){a[1]?o?o.p(a,u):(o=Ei(a),o.c(),o.m(e,t)):o&&(o.d(1),o=null),ft(e,s=xe(l,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},u&1&&{width:a[0]},u&1&&{height:a[0]},u&4&&a[2],u&8&&a[3]]))},i:ne,o:ne,d(a){a&&L(e),o&&o.d()}}}function jo(n,e,t){let i,r;const o=["size","title"];let l=ce(e,o),{size:s=16}=e,{title:a=void 0}=e;return n.$$set=u=>{t(5,e=Q(Q({},e),we(u))),t(3,l=ce(e,o)),"size"in u&&t(0,s=u.size),"title"in u&&t(1,a=u.title)},n.$$.update=()=>{t(4,i=e["aria-label"]||e["aria-labelledby"]||a),t(2,r={"aria-hidden":i?void 0:!0,role:i?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=we(e),[s,a,r,l,i]}class Wo extends ie{constructor(e){super(),re(this,e,jo,Uo,oe,{size:0,title:1})}}const Vo=Wo,Ho=n=>({}),Mi=n=>({});function Pi(n){let e,t;const i=n[16].labelText,r=Oe(i,n,n[15],Mi),o=r||Zo(n);return{c(){e=A("span"),o&&o.c(),k(e,"bx--visually-hidden",n[7])},m(l,s){P(l,e,s),o&&o.m(e,null),t=!0},p(l,s){r?r.p&&(!t||s&32768)&&Ne(r,i,l,l[15],t?Fe(i,l[15],s,Ho):Ie(l[15]),Mi):o&&o.p&&(!t||s&64)&&o.p(l,t?s:-1),(!t||s&128)&&k(e,"bx--visually-hidden",l[7])},i(l){t||(R(o,l),t=!0)},o(l){z(o,l),t=!1},d(l){l&&L(e),o&&o.d(l)}}}function Zo(n){let e;return{c(){e=H(n[6])},m(t,i){P(t,e,i)},p(t,i){i&64&&de(e,t[6])},d(t){t&&L(e)}}}function Qo(n){let e,t,i,r,o,l,s,a,u,c=(n[6]||n[13].labelText)&&Pi(n),g=[n[12]],h={};for(let f=0;f<g.length;f+=1)h=Q(h,g[f]);return{c(){e=A("div"),t=A("input"),i=N(),r=A("label"),o=A("span"),l=N(),c&&c.c(),I(t,"type","radio"),I(t,"id",n[8]),I(t,"name",n[9]),t.checked=n[0],t.disabled=n[3],t.required=n[4],t.value=n[2],k(t,"bx--radio-button",!0),k(o,"bx--radio-button__appearance",!0),I(r,"for",n[8]),k(r,"bx--radio-button__label",!0),be(e,h),k(e,"bx--radio-button-wrapper",!0),k(e,"bx--radio-button-wrapper--label-left",n[5]==="left")},m(f,d){P(f,e,d),S(e,t),n[18](t),S(e,i),S(e,r),S(r,o),S(r,l),c&&c.m(r,null),s=!0,a||(u=[G(t,"change",n[17]),G(t,"change",n[19])],a=!0)},p(f,[d]){(!s||d&256)&&I(t,"id",f[8]),(!s||d&512)&&I(t,"name",f[9]),(!s||d&1)&&(t.checked=f[0]),(!s||d&8)&&(t.disabled=f[3]),(!s||d&16)&&(t.required=f[4]),(!s||d&4)&&(t.value=f[2]),f[6]||f[13].labelText?c?(c.p(f,d),d&8256&&R(c,1)):(c=Pi(f),c.c(),R(c,1),c.m(r,null)):c&&(Se(),z(c,1,1,()=>{c=null}),Ee()),(!s||d&256)&&I(r,"for",f[8]),be(e,h=xe(g,[d&4096&&f[12]])),k(e,"bx--radio-button-wrapper",!0),k(e,"bx--radio-button-wrapper--label-left",f[5]==="left")},i(f){s||(R(c),s=!0)},o(f){z(c),s=!1},d(f){f&&L(e),n[18](null),c&&c.d(),a=!1,Ae(u)}}}function Ko(n,e,t){const i=["value","checked","disabled","required","labelPosition","labelText","hideLabel","id","name","ref"];let r=ce(e,i),o,{$$slots:l={},$$scope:s}=e;const a=dn(l);let{value:u=""}=e,{checked:c=!1}=e,{disabled:g=!1}=e,{required:h=!1}=e,{labelPosition:f="right"}=e,{labelText:d=""}=e,{hideLabel:b=!1}=e,{id:_="ccs-"+Math.random().toString(36)}=e,{name:x=""}=e,{ref:m=null}=e;const p=cn("RadioButtonGroup"),v=p?p.selectedValue:pt(c?u:void 0);ge(n,v,M=>t(14,o=M)),p&&p.add({id:_,checked:c,disabled:g,value:u});function y(M){J.call(this,n,M)}function w(M){he[M?"unshift":"push"](()=>{m=M,t(1,m)})}const C=()=>{p&&p.update(u)};return n.$$set=M=>{e=Q(Q({},e),we(M)),t(12,r=ce(e,i)),"value"in M&&t(2,u=M.value),"checked"in M&&t(0,c=M.checked),"disabled"in M&&t(3,g=M.disabled),"required"in M&&t(4,h=M.required),"labelPosition"in M&&t(5,f=M.labelPosition),"labelText"in M&&t(6,d=M.labelText),"hideLabel"in M&&t(7,b=M.hideLabel),"id"in M&&t(8,_=M.id),"name"in M&&t(9,x=M.name),"ref"in M&&t(1,m=M.ref),"$$scope"in M&&t(15,s=M.$$scope)},n.$$.update=()=>{n.$$.dirty&16388&&t(0,c=o===u)},[c,m,u,g,h,f,d,b,_,x,p,v,r,a,o,s,l,y,w,C]}class $o extends ie{constructor(e){super(),re(this,e,Ko,Qo,oe,{value:2,checked:0,disabled:3,required:4,labelPosition:5,labelText:6,hideLabel:7,id:8,name:9,ref:1})}}const jt=$o;function Li(n){let e,t;return{c(){e=Pe("title"),t=H(n[1])},m(i,r){P(i,e,r),S(e,t)},p(i,r){r&2&&de(t,i[1])},d(i){i&&L(e)}}}function el(n){let e,t,i=n[1]&&Li(n),r=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],o={};for(let l=0;l<r.length;l+=1)o=Q(o,r[l]);return{c(){e=Pe("svg"),i&&i.c(),t=Pe("path"),I(t,"d","M30 28.6L3.4 2 2 3.4l10.1 10.1L4 21.6V28h6.4l8.1-8.1L28.6 30 30 28.6zM9.6 26H6v-3.6l7.5-7.5 3.6 3.6L9.6 26zM29.4 6.2L29.4 6.2l-3.6-3.6c-.8-.8-2-.8-2.8 0l0 0 0 0-8 8 1.4 1.4L20 8.4l3.6 3.6L20 15.6l1.4 1.4 8-8C30.2 8.2 30.2 7 29.4 6.2L29.4 6.2zM25 10.6L21.4 7l3-3L28 7.6 25 10.6z"),ft(e,o)},m(l,s){P(l,e,s),i&&i.m(e,null),S(e,t)},p(l,[s]){l[1]?i?i.p(l,s):(i=Li(l),i.c(),i.m(e,t)):i&&(i.d(1),i=null),ft(e,o=xe(r,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},s&1&&{width:l[0]},s&1&&{height:l[0]},s&4&&l[2],s&8&&l[3]]))},i:ne,o:ne,d(l){l&&L(e),i&&i.d()}}}function tl(n,e,t){let i,r;const o=["size","title"];let l=ce(e,o),{size:s=16}=e,{title:a=void 0}=e;return n.$$set=u=>{t(5,e=Q(Q({},e),we(u))),t(3,l=ce(e,o)),"size"in u&&t(0,s=u.size),"title"in u&&t(1,a=u.title)},n.$$.update=()=>{t(4,i=e["aria-label"]||e["aria-labelledby"]||a),t(2,r={"aria-hidden":i?void 0:!0,role:i?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=we(e),[s,a,r,l,i]}class nl extends ie{constructor(e){super(),re(this,e,tl,el,oe,{size:0,title:1})}}const il=nl;function rl(n){let e,t,i,r;const o=n[5].default,l=Oe(o,n,n[4],null);let s=[n[3]],a={};for(let u=0;u<s.length;u+=1)a=Q(a,s[u]);return{c(){e=A("ol"),l&&l.c(),be(e,a),k(e,"bx--list--ordered",!n[1]),k(e,"bx--list--ordered--native",n[1]),k(e,"bx--list--nested",n[0]),k(e,"bx--list--expressive",n[2])},m(u,c){P(u,e,c),l&&l.m(e,null),t=!0,i||(r=[G(e,"click",n[6]),G(e,"mouseover",n[7]),G(e,"mouseenter",n[8]),G(e,"mouseleave",n[9])],i=!0)},p(u,[c]){l&&l.p&&(!t||c&16)&&Ne(l,o,u,u[4],t?Fe(o,u[4],c,null):Ie(u[4]),null),be(e,a=xe(s,[c&8&&u[3]])),k(e,"bx--list--ordered",!u[1]),k(e,"bx--list--ordered--native",u[1]),k(e,"bx--list--nested",u[0]),k(e,"bx--list--expressive",u[2])},i(u){t||(R(l,u),t=!0)},o(u){z(l,u),t=!1},d(u){u&&L(e),l&&l.d(u),i=!1,Ae(r)}}}function ol(n,e,t){const i=["nested","native","expressive"];let r=ce(e,i),{$$slots:o={},$$scope:l}=e,{nested:s=!1}=e,{native:a=!1}=e,{expressive:u=!1}=e;function c(d){J.call(this,n,d)}function g(d){J.call(this,n,d)}function h(d){J.call(this,n,d)}function f(d){J.call(this,n,d)}return n.$$set=d=>{e=Q(Q({},e),we(d)),t(3,r=ce(e,i)),"nested"in d&&t(0,s=d.nested),"native"in d&&t(1,a=d.native),"expressive"in d&&t(2,u=d.expressive),"$$scope"in d&&t(4,l=d.$$scope)},[s,a,u,r,l,o,c,g,h,f]}class ll extends ie{constructor(e){super(),re(this,e,ol,rl,oe,{nested:0,native:1,expressive:2})}}const sl=ll,al=n=>({}),Ti=n=>({});function xi(n){let e,t;const i=n[11].legendText,r=Oe(i,n,n[10],Ti),o=r||ul(n);return{c(){e=A("legend"),o&&o.c(),k(e,"bx--label",!0),k(e,"bx--visually-hidden",n[2])},m(l,s){P(l,e,s),o&&o.m(e,null),t=!0},p(l,s){r?r.p&&(!t||s&1024)&&Ne(r,i,l,l[10],t?Fe(i,l[10],s,al):Ie(l[10]),Ti):o&&o.p&&(!t||s&2)&&o.p(l,t?s:-1),(!t||s&4)&&k(e,"bx--visually-hidden",l[2])},i(l){t||(R(o,l),t=!0)},o(l){z(o,l),t=!1},d(l){l&&L(e),o&&o.d(l)}}}function ul(n){let e;return{c(){e=H(n[1])},m(t,i){P(t,e,i)},p(t,i){i&2&&de(e,t[1])},d(t){t&&L(e)}}}function fl(n){let e,t,i,r,o,l,s=(n[1]||n[8].legendText)&&xi(n);const a=n[11].default,u=Oe(a,n,n[10],null);let c=[{id:n[5]},n[7]],g={};for(let h=0;h<c.length;h+=1)g=Q(g,c[h]);return{c(){e=A("div"),t=A("fieldset"),s&&s.c(),i=N(),u&&u.c(),t.disabled=n[0],k(t,"bx--radio-button-group",!0),k(t,"bx--radio-button-group--vertical",n[4]==="vertical"),k(t,"bx--radio-button-group--label-left",n[3]==="left"),k(t,"bx--radio-button-group--label-right",n[3]==="right"),be(e,g),k(e,"bx--form-item",!0)},m(h,f){P(h,e,f),S(e,t),s&&s.m(t,null),S(t,i),u&&u.m(t,null),r=!0,o||(l=[G(e,"click",n[12]),G(e,"mouseover",n[13]),G(e,"mouseenter",n[14]),G(e,"mouseleave",n[15])],o=!0)},p(h,[f]){h[1]||h[8].legendText?s?(s.p(h,f),f&258&&R(s,1)):(s=xi(h),s.c(),R(s,1),s.m(t,i)):s&&(Se(),z(s,1,1,()=>{s=null}),Ee()),u&&u.p&&(!r||f&1024)&&Ne(u,a,h,h[10],r?Fe(a,h[10],f,null):Ie(h[10]),null),(!r||f&1)&&(t.disabled=h[0]),(!r||f&16)&&k(t,"bx--radio-button-group--vertical",h[4]==="vertical"),(!r||f&8)&&k(t,"bx--radio-button-group--label-left",h[3]==="left"),(!r||f&8)&&k(t,"bx--radio-button-group--label-right",h[3]==="right"),be(e,g=xe(c,[(!r||f&32)&&{id:h[5]},f&128&&h[7]])),k(e,"bx--form-item",!0)},i(h){r||(R(s),R(u,h),r=!0)},o(h){z(s),z(u,h),r=!1},d(h){h&&L(e),s&&s.d(),u&&u.d(h),o=!1,Ae(l)}}}function cl(n,e,t){const i=["selected","disabled","legendText","hideLegend","labelPosition","orientation","id"];let r=ce(e,i),o,{$$slots:l={},$$scope:s}=e;const a=dn(l);let{selected:u=void 0}=e,{disabled:c=!1}=e,{legendText:g=""}=e,{hideLegend:h=!1}=e,{labelPosition:f="right"}=e,{orientation:d="horizontal"}=e,{id:b=void 0}=e;const _=Ar(),x=pt(u);ge(n,x,w=>t(16,o=w)),Wn("RadioButtonGroup",{selectedValue:x,add:({checked:w,value:C})=>{w&&x.set(C)},update:w=>{t(9,u=w)}}),Yt(()=>{di(x,o=u,o)}),so(()=>{di(x,o=u,o)}),x.subscribe(w=>{t(9,u=w),_("change",w)});function m(w){J.call(this,n,w)}function p(w){J.call(this,n,w)}function v(w){J.call(this,n,w)}function y(w){J.call(this,n,w)}return n.$$set=w=>{e=Q(Q({},e),we(w)),t(7,r=ce(e,i)),"selected"in w&&t(9,u=w.selected),"disabled"in w&&t(0,c=w.disabled),"legendText"in w&&t(1,g=w.legendText),"hideLegend"in w&&t(2,h=w.hideLegend),"labelPosition"in w&&t(3,f=w.labelPosition),"orientation"in w&&t(4,d=w.orientation),"id"in w&&t(5,b=w.id),"$$scope"in w&&t(10,s=w.$$scope)},[c,g,h,f,d,b,x,r,a,u,s,l,m,p,v,y]}class dl extends ie{constructor(e){super(),re(this,e,cl,fl,oe,{selected:9,disabled:0,legendText:1,hideLegend:2,labelPosition:3,orientation:4,id:5})}}const hl=dl,ml=n=>({}),Ai=n=>({});function Ci(n){let e,t,i,r;const o=n[20].labelText,l=Oe(o,n,n[19],Ai),s=l||pl(n);let a=n[5]&&Ri(n);return{c(){e=A("div"),t=A("label"),s&&s.c(),i=N(),a&&a.c(),I(t,"for",n[14]),k(t,"bx--label",!0),k(t,"bx--visually-hidden",n[11]),k(t,"bx--label--disabled",n[7]),k(e,"bx--text-area__label-wrapper",!0)},m(u,c){P(u,e,c),S(e,t),s&&s.m(t,null),S(e,i),a&&a.m(e,null),r=!0},p(u,c){l?l.p&&(!r||c[0]&524288)&&Ne(l,o,u,u[19],r?Fe(o,u[19],c,ml):Ie(u[19]),Ai):s&&s.p&&(!r||c[0]&1024)&&s.p(u,r?c:[-1,-1]),(!r||c[0]&16384)&&I(t,"for",u[14]),(!r||c[0]&2048)&&k(t,"bx--visually-hidden",u[11]),(!r||c[0]&128)&&k(t,"bx--label--disabled",u[7]),u[5]?a?a.p(u,c):(a=Ri(u),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i(u){r||(R(s,u),r=!0)},o(u){z(s,u),r=!1},d(u){u&&L(e),s&&s.d(u),a&&a.d()}}}function pl(n){let e;return{c(){e=H(n[10])},m(t,i){P(t,e,i)},p(t,i){i[0]&1024&&de(e,t[10])},d(t){t&&L(e)}}}function Ri(n){let e,t=n[0].length+"",i,r,o;return{c(){e=A("div"),i=H(t),r=H("/"),o=H(n[5]),k(e,"bx--label",!0),k(e,"bx--label--disabled",n[7])},m(l,s){P(l,e,s),S(e,i),S(e,r),S(e,o)},p(l,s){s[0]&1&&t!==(t=l[0].length+"")&&de(i,t),s[0]&32&&de(o,l[5]),s[0]&128&&k(e,"bx--label--disabled",l[7])},d(l){l&&L(e)}}}function Oi(n){let e,t;return e=new Cr({props:{class:"bx--text-area__invalid-icon"}}),{c(){j(e.$$.fragment)},m(i,r){W(e,i,r),t=!0},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){z(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function Ni(n){let e,t;return{c(){e=A("div"),t=H(n[9]),k(e,"bx--form__helper-text",!0),k(e,"bx--form__helper-text--disabled",n[7])},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&512&&de(t,i[9]),r[0]&128&&k(e,"bx--form__helper-text--disabled",i[7])},d(i){i&&L(e)}}}function Ii(n){let e,t;return{c(){e=A("div"),t=H(n[13]),I(e,"id",n[16]),k(e,"bx--form-requirement",!0)},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&8192&&de(t,i[13]),r[0]&65536&&I(e,"id",i[16])},d(i){i&&L(e)}}}function gl(n){let e,t,i,r,o,l,s,a,u,c,g,h,f,d,b=(n[10]||n[17].labelText)&&!n[11]&&Ci(n),_=n[12]&&Oi(),x=[{"aria-invalid":l=n[12]||void 0},{"aria-describedby":s=n[12]?n[16]:void 0},{disabled:n[7]},{id:n[14]},{name:n[15]},{cols:n[3]},{rows:n[4]},{placeholder:n[2]},{readOnly:n[8]},{maxlength:a=n[5]??void 0},n[18]],m={};for(let y=0;y<x.length;y+=1)m=Q(m,x[y]);let p=!n[12]&&n[9]&&Ni(n),v=n[12]&&Ii(n);return{c(){e=A("div"),b&&b.c(),t=N(),i=A("div"),_&&_.c(),r=N(),o=A("textarea"),c=N(),p&&p.c(),g=N(),v&&v.c(),be(o,m),k(o,"bx--text-area",!0),k(o,"bx--text-area--light",n[6]),k(o,"bx--text-area--invalid",n[12]),I(i,"data-invalid",u=n[12]||void 0),k(i,"bx--text-area__wrapper",!0),k(e,"bx--form-item",!0)},m(y,w){P(y,e,w),b&&b.m(e,null),S(e,t),S(e,i),_&&_.m(i,null),S(i,r),S(i,o),o.autofocus&&o.focus(),n[32](o),Et(o,n[0]),S(e,c),p&&p.m(e,null),S(e,g),v&&v.m(e,null),h=!0,f||(d=[G(o,"input",n[33]),G(o,"change",n[25]),G(o,"input",n[26]),G(o,"keydown",n[27]),G(o,"keyup",n[28]),G(o,"focus",n[29]),G(o,"blur",n[30]),G(o,"paste",n[31]),G(e,"click",n[21]),G(e,"mouseover",n[22]),G(e,"mouseenter",n[23]),G(e,"mouseleave",n[24])],f=!0)},p(y,w){(y[10]||y[17].labelText)&&!y[11]?b?(b.p(y,w),w[0]&134144&&R(b,1)):(b=Ci(y),b.c(),R(b,1),b.m(e,t)):b&&(Se(),z(b,1,1,()=>{b=null}),Ee()),y[12]?_?w[0]&4096&&R(_,1):(_=Oi(),_.c(),R(_,1),_.m(i,r)):_&&(Se(),z(_,1,1,()=>{_=null}),Ee()),be(o,m=xe(x,[(!h||w[0]&4096&&l!==(l=y[12]||void 0))&&{"aria-invalid":l},(!h||w[0]&69632&&s!==(s=y[12]?y[16]:void 0))&&{"aria-describedby":s},(!h||w[0]&128)&&{disabled:y[7]},(!h||w[0]&16384)&&{id:y[14]},(!h||w[0]&32768)&&{name:y[15]},(!h||w[0]&8)&&{cols:y[3]},(!h||w[0]&16)&&{rows:y[4]},(!h||w[0]&4)&&{placeholder:y[2]},(!h||w[0]&256)&&{readOnly:y[8]},(!h||w[0]&32&&a!==(a=y[5]??void 0))&&{maxlength:a},w[0]&262144&&y[18]])),w[0]&1&&Et(o,y[0]),k(o,"bx--text-area",!0),k(o,"bx--text-area--light",y[6]),k(o,"bx--text-area--invalid",y[12]),(!h||w[0]&4096&&u!==(u=y[12]||void 0))&&I(i,"data-invalid",u),!y[12]&&y[9]?p?p.p(y,w):(p=Ni(y),p.c(),p.m(e,g)):p&&(p.d(1),p=null),y[12]?v?v.p(y,w):(v=Ii(y),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i(y){h||(R(b),R(_),h=!0)},o(y){z(b),z(_),h=!1},d(y){y&&L(e),b&&b.d(),_&&_.d(),n[32](null),p&&p.d(),v&&v.d(),f=!1,Ae(d)}}}function bl(n,e,t){let i;const r=["value","placeholder","cols","rows","maxCount","light","disabled","readonly","helperText","labelText","hideLabel","invalid","invalidText","id","name","ref"];let o=ce(e,r),{$$slots:l={},$$scope:s}=e;const a=dn(l);let{value:u=""}=e,{placeholder:c=""}=e,{cols:g=50}=e,{rows:h=4}=e,{maxCount:f=void 0}=e,{light:d=!1}=e,{disabled:b=!1}=e,{readonly:_=!1}=e,{helperText:x=""}=e,{labelText:m=""}=e,{hideLabel:p=!1}=e,{invalid:v=!1}=e,{invalidText:y=""}=e,{id:w="ccs-"+Math.random().toString(36)}=e,{name:C=void 0}=e,{ref:M=null}=e;function B(E){J.call(this,n,E)}function Y(E){J.call(this,n,E)}function T(E){J.call(this,n,E)}function D(E){J.call(this,n,E)}function F(E){J.call(this,n,E)}function O(E){J.call(this,n,E)}function q(E){J.call(this,n,E)}function U(E){J.call(this,n,E)}function se(E){J.call(this,n,E)}function te(E){J.call(this,n,E)}function le(E){J.call(this,n,E)}function fe(E){he[E?"unshift":"push"](()=>{M=E,t(1,M)})}function ae(){u=this.value,t(0,u)}return n.$$set=E=>{e=Q(Q({},e),we(E)),t(18,o=ce(e,r)),"value"in E&&t(0,u=E.value),"placeholder"in E&&t(2,c=E.placeholder),"cols"in E&&t(3,g=E.cols),"rows"in E&&t(4,h=E.rows),"maxCount"in E&&t(5,f=E.maxCount),"light"in E&&t(6,d=E.light),"disabled"in E&&t(7,b=E.disabled),"readonly"in E&&t(8,_=E.readonly),"helperText"in E&&t(9,x=E.helperText),"labelText"in E&&t(10,m=E.labelText),"hideLabel"in E&&t(11,p=E.hideLabel),"invalid"in E&&t(12,v=E.invalid),"invalidText"in E&&t(13,y=E.invalidText),"id"in E&&t(14,w=E.id),"name"in E&&t(15,C=E.name),"ref"in E&&t(1,M=E.ref),"$$scope"in E&&t(19,s=E.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&t(16,i=`error-${w}`)},[u,M,c,g,h,f,d,b,_,x,m,p,v,y,w,C,i,a,o,s,l,B,Y,T,D,F,O,q,U,se,te,le,fe,ae]}class vl extends ie{constructor(e){super(),re(this,e,bl,gl,oe,{value:0,placeholder:2,cols:3,rows:4,maxCount:5,light:6,disabled:7,readonly:8,helperText:9,labelText:10,hideLabel:11,invalid:12,invalidText:13,id:14,name:15,ref:1},null,[-1,-1])}}const _l=vl,yl=n=>({}),Fi=n=>({}),wl=n=>({}),Bi=n=>({});function zi(n){let e,t,i,r=n[9]&&Di(n),o=!n[20]&&n[6]&&qi(n);return{c(){e=A("div"),r&&r.c(),t=N(),o&&o.c(),k(e,"bx--text-input__label-helper-wrapper",!0)},m(l,s){P(l,e,s),r&&r.m(e,null),S(e,t),o&&o.m(e,null),i=!0},p(l,s){l[9]?r?(r.p(l,s),s[0]&512&&R(r,1)):(r=Di(l),r.c(),R(r,1),r.m(e,t)):r&&(Se(),z(r,1,1,()=>{r=null}),Ee()),!l[20]&&l[6]?o?o.p(l,s):(o=qi(l),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(l){i||(R(r),i=!0)},o(l){z(r),i=!1},d(l){l&&L(e),r&&r.d(),o&&o.d()}}}function Di(n){let e,t;const i=n[26].labelText,r=Oe(i,n,n[25],Bi),o=r||kl(n);return{c(){e=A("label"),o&&o.c(),I(e,"for",n[7]),k(e,"bx--label",!0),k(e,"bx--visually-hidden",n[10]),k(e,"bx--label--disabled",n[5]),k(e,"bx--label--inline",n[16]),k(e,"bx--label--inline--sm",n[2]==="sm"),k(e,"bx--label--inline--xl",n[2]==="xl")},m(l,s){P(l,e,s),o&&o.m(e,null),t=!0},p(l,s){r?r.p&&(!t||s[0]&33554432)&&Ne(r,i,l,l[25],t?Fe(i,l[25],s,wl):Ie(l[25]),Bi):o&&o.p&&(!t||s[0]&512)&&o.p(l,t?s:[-1,-1]),(!t||s[0]&128)&&I(e,"for",l[7]),(!t||s[0]&1024)&&k(e,"bx--visually-hidden",l[10]),(!t||s[0]&32)&&k(e,"bx--label--disabled",l[5]),(!t||s[0]&65536)&&k(e,"bx--label--inline",l[16]),(!t||s[0]&4)&&k(e,"bx--label--inline--sm",l[2]==="sm"),(!t||s[0]&4)&&k(e,"bx--label--inline--xl",l[2]==="xl")},i(l){t||(R(o,l),t=!0)},o(l){z(o,l),t=!1},d(l){l&&L(e),o&&o.d(l)}}}function kl(n){let e;return{c(){e=H(n[9])},m(t,i){P(t,e,i)},p(t,i){i[0]&512&&de(e,t[9])},d(t){t&&L(e)}}}function qi(n){let e,t;return{c(){e=A("div"),t=H(n[6]),k(e,"bx--form__helper-text",!0),k(e,"bx--form__helper-text--disabled",n[5]),k(e,"bx--form__helper-text--inline",n[16])},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&64&&de(t,i[6]),r[0]&32&&k(e,"bx--form__helper-text--disabled",i[5]),r[0]&65536&&k(e,"bx--form__helper-text--inline",i[16])},d(i){i&&L(e)}}}function Gi(n){let e,t;const i=n[26].labelText,r=Oe(i,n,n[25],Fi),o=r||Sl(n);return{c(){e=A("label"),o&&o.c(),I(e,"for",n[7]),k(e,"bx--label",!0),k(e,"bx--visually-hidden",n[10]),k(e,"bx--label--disabled",n[5]),k(e,"bx--label--inline",n[16]),k(e,"bx--label--inline-sm",n[16]&&n[2]==="sm"),k(e,"bx--label--inline-xl",n[16]&&n[2]==="xl")},m(l,s){P(l,e,s),o&&o.m(e,null),t=!0},p(l,s){r?r.p&&(!t||s[0]&33554432)&&Ne(r,i,l,l[25],t?Fe(i,l[25],s,yl):Ie(l[25]),Fi):o&&o.p&&(!t||s[0]&512)&&o.p(l,t?s:[-1,-1]),(!t||s[0]&128)&&I(e,"for",l[7]),(!t||s[0]&1024)&&k(e,"bx--visually-hidden",l[10]),(!t||s[0]&32)&&k(e,"bx--label--disabled",l[5]),(!t||s[0]&65536)&&k(e,"bx--label--inline",l[16]),(!t||s[0]&65540)&&k(e,"bx--label--inline-sm",l[16]&&l[2]==="sm"),(!t||s[0]&65540)&&k(e,"bx--label--inline-xl",l[16]&&l[2]==="xl")},i(l){t||(R(o,l),t=!0)},o(l){z(o,l),t=!1},d(l){l&&L(e),o&&o.d(l)}}}function Sl(n){let e;return{c(){e=H(n[9])},m(t,i){P(t,e,i)},p(t,i){i[0]&512&&de(e,t[9])},d(t){t&&L(e)}}}function Yi(n){let e,t;return e=new Cr({props:{class:"bx--text-input__invalid-icon"}}),{c(){j(e.$$.fragment)},m(i,r){W(e,i,r),t=!0},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){z(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function Xi(n){let e,t;return e=new Vo({props:{class:`bx--text-input__invalid-icon
            bx--text-input__invalid-icon--warning`}}),{c(){j(e.$$.fragment)},m(i,r){W(e,i,r),t=!0},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){z(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function Ji(n){let e,t;return e=new il({props:{class:"bx--text-input__readonly-icon"}}),{c(){j(e.$$.fragment)},m(i,r){W(e,i,r),t=!0},i(i){t||(R(e.$$.fragment,i),t=!0)},o(i){z(e.$$.fragment,i),t=!1},d(i){V(e,i)}}}function Ui(n){let e;return{c(){e=A("hr"),k(e,"bx--text-input__divider",!0)},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function ji(n){let e,t;return{c(){e=A("div"),t=H(n[12]),I(e,"id",n[19]),k(e,"bx--form-requirement",!0)},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&4096&&de(t,i[12]),r[0]&524288&&I(e,"id",i[19])},d(i){i&&L(e)}}}function Wi(n){let e,t;return{c(){e=A("div"),t=H(n[14]),I(e,"id",n[18]),k(e,"bx--form-requirement",!0)},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&16384&&de(t,i[14]),r[0]&262144&&I(e,"id",i[18])},d(i){i&&L(e)}}}function Vi(n){let e,t;return{c(){e=A("div"),t=H(n[6]),k(e,"bx--form__helper-text",!0),k(e,"bx--form__helper-text--disabled",n[5]),k(e,"bx--form__helper-text--inline",n[16])},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&64&&de(t,i[6]),r[0]&32&&k(e,"bx--form__helper-text--disabled",i[5]),r[0]&65536&&k(e,"bx--form__helper-text--inline",i[16])},d(i){i&&L(e)}}}function Hi(n){let e,t;return{c(){e=A("div"),t=H(n[12]),I(e,"id",n[19]),k(e,"bx--form-requirement",!0)},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&4096&&de(t,i[12]),r[0]&524288&&I(e,"id",i[19])},d(i){i&&L(e)}}}function Zi(n){let e,t;return{c(){e=A("div"),t=H(n[14]),I(e,"id",n[18]),k(e,"bx--form-requirement",!0)},m(i,r){P(i,e,r),S(e,t)},p(i,r){r[0]&16384&&de(t,i[14]),r[0]&262144&&I(e,"id",i[18])},d(i){i&&L(e)}}}function El(n){let e,t,i,r,o,l,s,a,u,c,g,h,f,d,b,_,x,m,p,v,y,w,C,M,B=n[16]&&zi(n),Y=!n[16]&&(n[9]||n[24].labelText)&&Gi(n),T=n[11]&&Yi(),D=!n[11]&&n[13]&&Xi(),F=n[17]&&Ji(),O=[{"data-invalid":c=n[11]||void 0},{"aria-invalid":g=n[11]||void 0},{"data-warn":h=n[13]||void 0},{"aria-describedby":f=n[11]?n[19]:n[13]?n[18]:void 0},{disabled:n[5]},{id:n[7]},{name:n[8]},{placeholder:n[3]},{required:n[15]},{readOnly:n[17]},n[23]],q={};for(let E=0;E<O.length;E+=1)q=Q(q,O[E]);let U=n[20]&&Ui(),se=n[20]&&!n[16]&&n[11]&&ji(n),te=n[20]&&!n[16]&&n[13]&&Wi(n),le=!n[11]&&!n[13]&&!n[20]&&!n[16]&&n[6]&&Vi(n),fe=!n[20]&&n[11]&&Hi(n),ae=!n[20]&&!n[11]&&n[13]&&Zi(n);return{c(){e=A("div"),B&&B.c(),t=N(),Y&&Y.c(),i=N(),r=A("div"),o=A("div"),T&&T.c(),l=N(),D&&D.c(),s=N(),F&&F.c(),a=N(),u=A("input"),d=N(),U&&U.c(),b=N(),se&&se.c(),_=N(),te&&te.c(),p=N(),le&&le.c(),v=N(),fe&&fe.c(),y=N(),ae&&ae.c(),be(u,q),k(u,"bx--text-input",!0),k(u,"bx--text-input--light",n[4]),k(u,"bx--text-input--invalid",n[11]),k(u,"bx--text-input--warn",n[13]),k(u,"bx--text-input--sm",n[2]==="sm"),k(u,"bx--text-input--xl",n[2]==="xl"),I(o,"data-invalid",x=n[11]||void 0),I(o,"data-warn",m=n[13]||void 0),k(o,"bx--text-input__field-wrapper",!0),k(o,"bx--text-input__field-wrapper--warning",!n[11]&&n[13]),k(r,"bx--text-input__field-outer-wrapper",!0),k(r,"bx--text-input__field-outer-wrapper--inline",n[16]),k(e,"bx--form-item",!0),k(e,"bx--text-input-wrapper",!0),k(e,"bx--text-input-wrapper--inline",n[16]),k(e,"bx--text-input-wrapper--light",n[4]),k(e,"bx--text-input-wrapper--readonly",n[17])},m(E,Z){P(E,e,Z),B&&B.m(e,null),S(e,t),Y&&Y.m(e,null),S(e,i),S(e,r),S(r,o),T&&T.m(o,null),S(o,l),D&&D.m(o,null),S(o,s),F&&F.m(o,null),S(o,a),S(o,u),u.autofocus&&u.focus(),n[36](u),Et(u,n[0]),S(o,d),U&&U.m(o,null),S(o,b),se&&se.m(o,null),S(o,_),te&&te.m(o,null),S(r,p),le&&le.m(r,null),S(r,v),fe&&fe.m(r,null),S(r,y),ae&&ae.m(r,null),w=!0,C||(M=[G(u,"input",n[37]),G(u,"change",n[22]),G(u,"input",n[21]),G(u,"keydown",n[31]),G(u,"keyup",n[32]),G(u,"focus",n[33]),G(u,"blur",n[34]),G(u,"paste",n[35]),G(e,"click",n[27]),G(e,"mouseover",n[28]),G(e,"mouseenter",n[29]),G(e,"mouseleave",n[30])],C=!0)},p(E,Z){E[16]?B?(B.p(E,Z),Z[0]&65536&&R(B,1)):(B=zi(E),B.c(),R(B,1),B.m(e,t)):B&&(Se(),z(B,1,1,()=>{B=null}),Ee()),!E[16]&&(E[9]||E[24].labelText)?Y?(Y.p(E,Z),Z[0]&16843264&&R(Y,1)):(Y=Gi(E),Y.c(),R(Y,1),Y.m(e,i)):Y&&(Se(),z(Y,1,1,()=>{Y=null}),Ee()),E[11]?T?Z[0]&2048&&R(T,1):(T=Yi(),T.c(),R(T,1),T.m(o,l)):T&&(Se(),z(T,1,1,()=>{T=null}),Ee()),!E[11]&&E[13]?D?Z[0]&10240&&R(D,1):(D=Xi(),D.c(),R(D,1),D.m(o,s)):D&&(Se(),z(D,1,1,()=>{D=null}),Ee()),E[17]?F?Z[0]&131072&&R(F,1):(F=Ji(),F.c(),R(F,1),F.m(o,a)):F&&(Se(),z(F,1,1,()=>{F=null}),Ee()),be(u,q=xe(O,[(!w||Z[0]&2048&&c!==(c=E[11]||void 0))&&{"data-invalid":c},(!w||Z[0]&2048&&g!==(g=E[11]||void 0))&&{"aria-invalid":g},(!w||Z[0]&8192&&h!==(h=E[13]||void 0))&&{"data-warn":h},(!w||Z[0]&796672&&f!==(f=E[11]?E[19]:E[13]?E[18]:void 0))&&{"aria-describedby":f},(!w||Z[0]&32)&&{disabled:E[5]},(!w||Z[0]&128)&&{id:E[7]},(!w||Z[0]&256)&&{name:E[8]},(!w||Z[0]&8)&&{placeholder:E[3]},(!w||Z[0]&32768)&&{required:E[15]},(!w||Z[0]&131072)&&{readOnly:E[17]},Z[0]&8388608&&E[23]])),Z[0]&1&&u.value!==E[0]&&Et(u,E[0]),k(u,"bx--text-input",!0),k(u,"bx--text-input--light",E[4]),k(u,"bx--text-input--invalid",E[11]),k(u,"bx--text-input--warn",E[13]),k(u,"bx--text-input--sm",E[2]==="sm"),k(u,"bx--text-input--xl",E[2]==="xl"),E[20]?U||(U=Ui(),U.c(),U.m(o,b)):U&&(U.d(1),U=null),E[20]&&!E[16]&&E[11]?se?se.p(E,Z):(se=ji(E),se.c(),se.m(o,_)):se&&(se.d(1),se=null),E[20]&&!E[16]&&E[13]?te?te.p(E,Z):(te=Wi(E),te.c(),te.m(o,null)):te&&(te.d(1),te=null),(!w||Z[0]&2048&&x!==(x=E[11]||void 0))&&I(o,"data-invalid",x),(!w||Z[0]&8192&&m!==(m=E[13]||void 0))&&I(o,"data-warn",m),(!w||Z[0]&10240)&&k(o,"bx--text-input__field-wrapper--warning",!E[11]&&E[13]),!E[11]&&!E[13]&&!E[20]&&!E[16]&&E[6]?le?le.p(E,Z):(le=Vi(E),le.c(),le.m(r,v)):le&&(le.d(1),le=null),!E[20]&&E[11]?fe?fe.p(E,Z):(fe=Hi(E),fe.c(),fe.m(r,y)):fe&&(fe.d(1),fe=null),!E[20]&&!E[11]&&E[13]?ae?ae.p(E,Z):(ae=Zi(E),ae.c(),ae.m(r,null)):ae&&(ae.d(1),ae=null),(!w||Z[0]&65536)&&k(r,"bx--text-input__field-outer-wrapper--inline",E[16]),(!w||Z[0]&65536)&&k(e,"bx--text-input-wrapper--inline",E[16]),(!w||Z[0]&16)&&k(e,"bx--text-input-wrapper--light",E[4]),(!w||Z[0]&131072)&&k(e,"bx--text-input-wrapper--readonly",E[17])},i(E){w||(R(B),R(Y),R(T),R(D),R(F),w=!0)},o(E){z(B),z(Y),z(T),z(D),z(F),w=!1},d(E){E&&L(e),B&&B.d(),Y&&Y.d(),T&&T.d(),D&&D.d(),F&&F.d(),n[36](null),U&&U.d(),se&&se.d(),te&&te.d(),le&&le.d(),fe&&fe.d(),ae&&ae.d(),C=!1,Ae(M)}}}function Ml(n,e,t){let i,r,o;const l=["size","value","placeholder","light","disabled","helperText","id","name","labelText","hideLabel","invalid","invalidText","warn","warnText","ref","required","inline","readonly"];let s=ce(e,l),{$$slots:a={},$$scope:u}=e;const c=dn(a);let{size:g=void 0}=e,{value:h=""}=e,{placeholder:f=""}=e,{light:d=!1}=e,{disabled:b=!1}=e,{helperText:_=""}=e,{id:x="ccs-"+Math.random().toString(36)}=e,{name:m=void 0}=e,{labelText:p=""}=e,{hideLabel:v=!1}=e,{invalid:y=!1}=e,{invalidText:w=""}=e,{warn:C=!1}=e,{warnText:M=""}=e,{ref:B=null}=e,{required:Y=!1}=e,{inline:T=!1}=e,{readonly:D=!1}=e;const F=cn("Form"),O=Ar();function q(X){return s.type!=="number"?X:X!=""?Number(X):null}const U=X=>{t(0,h=q(X.target.value)),O("input",h)},se=X=>{O("change",q(X.target.value))};function te(X){J.call(this,n,X)}function le(X){J.call(this,n,X)}function fe(X){J.call(this,n,X)}function ae(X){J.call(this,n,X)}function E(X){J.call(this,n,X)}function Z(X){J.call(this,n,X)}function Je(X){J.call(this,n,X)}function Tt(X){J.call(this,n,X)}function Jt(X){J.call(this,n,X)}function vn(X){he[X?"unshift":"push"](()=>{B=X,t(1,B)})}function pe(){h=this.value,t(0,h)}return n.$$set=X=>{e=Q(Q({},e),we(X)),t(23,s=ce(e,l)),"size"in X&&t(2,g=X.size),"value"in X&&t(0,h=X.value),"placeholder"in X&&t(3,f=X.placeholder),"light"in X&&t(4,d=X.light),"disabled"in X&&t(5,b=X.disabled),"helperText"in X&&t(6,_=X.helperText),"id"in X&&t(7,x=X.id),"name"in X&&t(8,m=X.name),"labelText"in X&&t(9,p=X.labelText),"hideLabel"in X&&t(10,v=X.hideLabel),"invalid"in X&&t(11,y=X.invalid),"invalidText"in X&&t(12,w=X.invalidText),"warn"in X&&t(13,C=X.warn),"warnText"in X&&t(14,M=X.warnText),"ref"in X&&t(1,B=X.ref),"required"in X&&t(15,Y=X.required),"inline"in X&&t(16,T=X.inline),"readonly"in X&&t(17,D=X.readonly),"$$scope"in X&&t(25,u=X.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&128&&t(19,r=`error-${x}`),n.$$.dirty[0]&128&&t(18,o=`warn-${x}`)},t(20,i=!!F&&F.isFluid),[h,B,g,f,d,b,_,x,m,p,v,y,w,C,M,Y,T,D,o,r,i,U,se,s,c,u,a,te,le,fe,ae,E,Z,Je,Tt,Jt,vn,pe]}class Pl extends ie{constructor(e){super(),re(this,e,Ml,El,oe,{size:2,value:0,placeholder:3,light:4,disabled:5,helperText:6,id:7,name:8,labelText:9,hideLabel:10,invalid:11,invalidText:12,warn:13,warnText:14,ref:1,required:15,inline:16,readonly:17},null,[-1,-1])}}const Ll=Pl;function Tl(n){let e;return{c(){e=H(`Click one of the draw icons to the top right of the map (the icons allow
      you to draw points, lines, polygons or routes)`)},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function xl(n){let e;return{c(){e=H(`Draw the intervention on the map, clicking the original point or 'Finish
      snapping' for the Polygon and Route tools respectively`)},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function Al(n){let e;return{c(){e=H("Fill in the details that appear (Intervention type, name, description)")},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function Cl(n){let e;return{c(){e=H(`Click the "Save" button or "Delete" button to save or remove the
      intervention`)},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function Rl(n){let e,t,i,r,o,l,s,a;return e=new Ut({props:{$$slots:{default:[Tl]},$$scope:{ctx:n}}}),i=new Ut({props:{$$slots:{default:[xl]},$$scope:{ctx:n}}}),o=new Ut({props:{$$slots:{default:[Al]},$$scope:{ctx:n}}}),s=new Ut({props:{$$slots:{default:[Cl]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment),t=N(),j(i.$$.fragment),r=N(),j(o.$$.fragment),l=N(),j(s.$$.fragment)},m(u,c){W(e,u,c),P(u,t,c),W(i,u,c),P(u,r,c),W(o,u,c),P(u,l,c),W(s,u,c),a=!0},p(u,c){const g={};c&4&&(g.$$scope={dirty:c,ctx:u}),e.$set(g);const h={};c&4&&(h.$$scope={dirty:c,ctx:u}),i.$set(h);const f={};c&4&&(f.$$scope={dirty:c,ctx:u}),o.$set(f);const d={};c&4&&(d.$$scope={dirty:c,ctx:u}),s.$set(d)},i(u){a||(R(e.$$.fragment,u),R(i.$$.fragment,u),R(o.$$.fragment,u),R(s.$$.fragment,u),a=!0)},o(u){z(e.$$.fragment,u),z(i.$$.fragment,u),z(o.$$.fragment,u),z(s.$$.fragment,u),a=!1},d(u){V(e,u),u&&L(t),V(i,u),u&&L(r),V(o,u),u&&L(l),V(s,u)}}}function Ol(n){let e,t,i,r,o,l,s,a,u,c,g,h,f,d,b,_,x,m,p,v,y,w,C,M,B,Y;return o=new sl({props:{$$slots:{default:[Rl]},$$scope:{ctx:n}}}),{c(){e=A("p"),e.textContent="For each intervention:",t=N(),i=A("br"),r=N(),j(o.$$.fragment),l=N(),s=A("br"),a=N(),u=A("p"),u.textContent=`Repeat the steps above for each substantial infrastructure intervention in
    the scheme.`,c=N(),g=A("br"),h=N(),f=A("p"),f.textContent=`To make further edits to attribute data, or to delete an intervention, click
    on its name in the left hand panel or its geometry in the map.`,d=N(),b=A("br"),_=N(),x=A("p"),x.textContent=`Click the "Export to GeoJSON" button to download the dataset representing
    the scheme, which can be made up of one or more intervention, as a GeoJSON
    file. After saving the file, you can delete the interventions, change the
    scheme name, and start a new set of interventions representing a new scheme.`,m=N(),p=A("br"),v=N(),y=A("p"),y.textContent=`To load a GeoJSON file that you have already saved from the tool, click the
    "Load from GeoJSON" button and select the file.`,w=N(),C=A("br"),M=N(),B=A("p"),B.innerHTML=`Note: the <strong>Route tool</strong> works by calculating routes between
    start and end points using the existing transport network according to
    OpenStreetMap. Use it by clicking on the location where you would like the
    route to start and then clicking on the location where you would like the
    route to end on the map. The route will be calculated and drawn on the map.
    After you click &quot;Finish snapping&quot; you can edit the route by dragging
    individual points. This can be useful for representing links that are not
    part of the existing transport network, such as a new bridge or path.
    However,
    <strong>you cannot add or remove points</strong> with the Route tool. If the
    planned route intervention you would like to sketch as part of a scheme contains
    one or more new links (for example containing new bridges or paths between cul-de-sacs),
    you may want to use the Line tool instead.`},m(T,D){P(T,e,D),P(T,t,D),P(T,i,D),P(T,r,D),W(o,T,D),P(T,l,D),P(T,s,D),P(T,a,D),P(T,u,D),P(T,c,D),P(T,g,D),P(T,h,D),P(T,f,D),P(T,d,D),P(T,b,D),P(T,_,D),P(T,x,D),P(T,m,D),P(T,p,D),P(T,v,D),P(T,y,D),P(T,w,D),P(T,C,D),P(T,M,D),P(T,B,D),Y=!0},p(T,D){const F={};D&4&&(F.$$scope={dirty:D,ctx:T}),o.$set(F)},i(T){Y||(R(o.$$.fragment,T),Y=!0)},o(T){z(o.$$.fragment,T),Y=!1},d(T){T&&L(e),T&&L(t),T&&L(i),T&&L(r),V(o,T),T&&L(l),T&&L(s),T&&L(a),T&&L(u),T&&L(c),T&&L(g),T&&L(h),T&&L(f),T&&L(d),T&&L(b),T&&L(_),T&&L(x),T&&L(m),T&&L(p),T&&L(v),T&&L(y),T&&L(w),T&&L(C),T&&L(M),T&&L(B)}}}function Nl(n){let e,t,i;function r(l){n[1](l)}let o={passiveModal:!0,modalHeading:"Instructions",$$slots:{default:[Ol]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.open=n[0]),e=new ao({props:o}),he.push(()=>De(e,"open",r,n[0])),{c(){j(e.$$.fragment)},m(l,s){W(e,l,s),i=!0},p(l,[s]){const a={};s&4&&(a.$$scope={dirty:s,ctx:l}),!t&&s&1&&(t=!0,a.open=l[0],qe(()=>t=!1)),e.$set(a)},i(l){i||(R(e.$$.fragment,l),i=!0)},o(l){z(e.$$.fragment,l),i=!1},d(l){V(e,l)}}}function Il(n,e,t){let{open:i}=e;function r(o){i=o,t(0,i)}return n.$$set=o=>{"open"in o&&t(0,i=o.open)},[i,r]}class Fl extends ie{constructor(e){super(),re(this,e,Il,Nl,oe,{open:0})}}const Bl={"line-cap":"round","line-join":"round"},Kn=["==","$type","Polygon"],$n=["==","$type","LineString"],ei=["==","$type","Point"];function tn(n,e,t=1){return{type:"line",layout:Bl,paint:{"line-color":n,"line-width":e,"line-opacity":t}}}function ti(n,e){return{type:"fill",paint:{"fill-color":n,"fill-opacity":e}}}function Xt(n,e,t=1){return{type:"circle",paint:{"circle-radius":e,"circle-color":n,"circle-opacity":t}}}function Lt(n,e,t){if(n.getSource(e)){let i=[];for(let r of n.getStyle().layers)r.source==e&&i.push(r.id);for(let r of i)n.removeLayer(r);n.removeSource(e)}n.addSource(e,t)}function Be(n,e,t=null){n.getLayer(e.id)&&n.removeLayer(e.id),t&&!n.getLayer(t)&&(t=null),n.addLayer(e,t)}function et(){return{type:"FeatureCollection",features:[]}}const Qe=pt(null),ue=pt(et()),Ue=pt(null),Ln=pt(null),hn=uo(ue,n=>{let e=n.features.find(t=>t.properties.editing);return e?e.id:null});function at(n){fo(hn)!=n&&(ue.update(e=>{for(let t of e.features)t.id==n?t.properties.editing=!0:delete t.properties.editing;return e}),Ue.set(n))}function mn(n){let e=new Set;for(let i of n.features)e.add(i.id);let t=e.size+1;for(;e.has(t);)t++;return t}function Qi(n){let e;const t=n[4].default,i=Oe(t,n,n[3],null);return{c(){i&&i.c()},m(r,o){i&&i.m(r,o),e=!0},p(r,o){i&&i.p&&(!e||o&8)&&Ne(i,t,r,r[3],e?Fe(t,r[3],o,null):Ie(r[3]),null)},i(r){e||(R(i,r),e=!0)},o(r){z(i,r),e=!1},d(r){i&&i.d(r)}}}function zl(n){let e,t,i=n[1]&&Qi(n);return{c(){e=A("div"),i&&i.c(),I(e,"class","map svelte-12dpf1u")},m(r,o){P(r,e,o),i&&i.m(e,null),n[5](e),t=!0},p(r,[o]){r[1]?i?(i.p(r,o),o&2&&R(i,1)):(i=Qi(r),i.c(),R(i,1),i.m(e,null)):i&&(Se(),z(i,1,1,()=>{i=null}),Ee())},i(r){t||(R(i),t=!0)},o(r){z(i),t=!1},d(r){r&&L(e),i&&i.d(),n[5](null)}}}function Dl(n,e,t){let{$$slots:i={},$$scope:r}=e,{style:o}=e,l,s,a=!1;Wn("setCamera",!window.location.hash),Yt(()=>{l=new yn.Map({container:s,style:`https://api.maptiler.com/maps/${o}/style.json?key=MZEJTanw3WpxRvt7qDfo`,hash:!0}),l.addControl(new yn.ScaleControl({})),l.addControl(new yn.NavigationControl({visualizePitch:!0}),"bottom-right"),l.on("load",()=>{t(1,a=!0),Qe.set(l)}),new ResizeObserver(()=>{l.resize()}).observe(s)}),Vn(()=>{l.remove()});function u(c){he[c?"unshift":"push"](()=>{s=c,t(0,s)})}return n.$$set=c=>{"style"in c&&t(2,o=c.style),"$$scope"in c&&t(3,r=c.$$scope)},[s,a,o,r,i,u]}class ql extends ie{constructor(e){super(),re(this,e,Dl,zl,oe,{style:2})}}const Gl=n=>({}),Ki=n=>({}),Yl=n=>({}),$i=n=>({}),Xl=n=>({}),er=n=>({});function Jl(n){let e,t,i,r,o,l,s,a,u,c,g,h;const f=n[3].nav,d=Oe(f,n,n[2],er),b=n[3].sidebar,_=Oe(b,n,n[2],$i),x=n[3].main,m=Oe(x,n,n[2],Ki);return{c(){e=A("aside"),t=A("div"),i=A("nav"),d&&d.c(),r=N(),_&&_.c(),o=N(),l=A("button"),l.textContent="",a=N(),u=A("main"),m&&m.c(),I(i,"class","svelte-1u7vg8a"),I(t,"class","sidebar-content content-container svelte-1u7vg8a"),I(l,"type","button"),I(l,"class","sidebar-toggle rounded-rect svelte-1u7vg8a"),I(e,"class",s=hi(n[0]?"":"collapsed")+" svelte-1u7vg8a"),I(u,"class","svelte-1u7vg8a")},m(p,v){P(p,e,v),S(e,t),S(t,i),d&&d.m(i,null),S(t,r),_&&_.m(t,null),S(e,o),S(e,l),P(p,a,v),P(p,u,v),m&&m.m(u,null),c=!0,g||(h=G(l,"click",n[1]),g=!0)},p(p,[v]){d&&d.p&&(!c||v&4)&&Ne(d,f,p,p[2],c?Fe(f,p[2],v,Xl):Ie(p[2]),er),_&&_.p&&(!c||v&4)&&Ne(_,b,p,p[2],c?Fe(b,p[2],v,Yl):Ie(p[2]),$i),(!c||v&1&&s!==(s=hi(p[0]?"":"collapsed")+" svelte-1u7vg8a"))&&I(e,"class",s),m&&m.p&&(!c||v&4)&&Ne(m,x,p,p[2],c?Fe(x,p[2],v,Gl):Ie(p[2]),Ki)},i(p){c||(R(d,p),R(_,p),R(m,p),c=!0)},o(p){z(d,p),z(_,p),z(m,p),c=!1},d(p){p&&L(e),d&&d.d(p),_&&_.d(p),p&&L(a),p&&L(u),m&&m.d(p),g=!1,h()}}}function Ul(n,e,t){let{$$slots:i={},$$scope:r}=e,o=!0;function l(){t(0,o=!o)}return n.$$set=s=>{"$$scope"in s&&t(2,r=s.$$scope)},[o,l,r,i]}class jl extends ie{constructor(e){super(),re(this,e,Ul,Jl,oe,{})}}var ke=63710088e-1,ni={centimeters:ke*100,centimetres:ke*100,degrees:ke/111325,feet:ke*3.28084,inches:ke*39.37,kilometers:ke/1e3,kilometres:ke/1e3,meters:ke,metres:ke,miles:ke/1609.344,millimeters:ke*1e3,millimetres:ke*1e3,nauticalmiles:ke/1852,radians:1,yards:ke*1.0936},Wl={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ke,yards:1.0936133},Tn={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Ye(n,e,t){t===void 0&&(t={});var i={type:"Feature"};return(t.id===0||t.id)&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.properties=e||{},i.geometry=n,i}function Vl(n,e,t){switch(n){case"Point":return Me(e).geometry;case"LineString":return Le(e).geometry;case"Polygon":return pn(e).geometry;case"MultiPoint":return Or(e).geometry;case"MultiLineString":return Rr(e).geometry;case"MultiPolygon":return ii(e).geometry;default:throw new Error(n+" is invalid")}}function Me(n,e,t){if(t===void 0&&(t={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!nn(n[0])||!nn(n[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:n};return Ye(i,e,t)}function Hl(n,e,t){return t===void 0&&(t={}),Ge(n.map(function(i){return Me(i,e)}),t)}function pn(n,e,t){t===void 0&&(t={});for(var i=0,r=n;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<o[o.length-1].length;l++)if(o[o.length-1][l]!==o[0][l])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:n};return Ye(s,e,t)}function Zl(n,e,t){return t===void 0&&(t={}),Ge(n.map(function(i){return pn(i,e)}),t)}function Le(n,e,t){if(t===void 0&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:n};return Ye(i,e,t)}function Ql(n,e,t){return t===void 0&&(t={}),Ge(n.map(function(i){return Le(i,e)}),t)}function Ge(n,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=n,t}function Rr(n,e,t){t===void 0&&(t={});var i={type:"MultiLineString",coordinates:n};return Ye(i,e,t)}function Or(n,e,t){t===void 0&&(t={});var i={type:"MultiPoint",coordinates:n};return Ye(i,e,t)}function ii(n,e,t){t===void 0&&(t={});var i={type:"MultiPolygon",coordinates:n};return Ye(i,e,t)}function Kl(n,e,t){t===void 0&&(t={});var i={type:"GeometryCollection",geometries:n};return Ye(i,e,t)}function $l(n,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(n*t)/t}function ri(n,e){e===void 0&&(e="kilometers");var t=ni[e];if(!t)throw new Error(e+" units is invalid");return n*t}function gn(n,e){e===void 0&&(e="kilometers");var t=ni[e];if(!t)throw new Error(e+" units is invalid");return n/t}function es(n,e){return It(gn(n,e))}function ts(n){var e=n%360;return e<0&&(e+=360),e}function It(n){var e=n%(2*Math.PI);return e*180/Math.PI}function ze(n){var e=n%360;return e*Math.PI/180}function ns(n,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(n>=0))throw new Error("length must be a positive number");return ri(gn(n,e),t)}function is(n,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(n>=0))throw new Error("area must be a positive number");var i=Tn[e];if(!i)throw new Error("invalid original units");var r=Tn[t];if(!r)throw new Error("invalid final units");return n/i*r}function nn(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function oi(n){return!!n&&n.constructor===Object}function rs(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(e){if(!nn(e))throw new Error("bbox must only contain numbers")})}function os(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")}const ls=Object.freeze(Object.defineProperty({__proto__:null,earthRadius:ke,factors:ni,unitsFactors:Wl,areaFactors:Tn,feature:Ye,geometry:Vl,point:Me,points:Hl,polygon:pn,polygons:Zl,lineString:Le,lineStrings:Ql,featureCollection:Ge,multiLineString:Rr,multiPoint:Or,multiPolygon:ii,geometryCollection:Kl,round:$l,radiansToLength:ri,lengthToRadians:gn,lengthToDegrees:es,bearingToAzimuth:ts,radiansToDegrees:It,degreesToRadians:ze,convertLength:ns,convertArea:is,isNumber:nn,isObject:oi,validateBBox:rs,validateId:os},Symbol.toStringTag,{value:"Module"}));/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function ss(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(u){return function(c){return a([u,c])}}function a(u){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(o=u[0]&2?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,r=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(c){u=[6,c],r=0}finally{i=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var ct=function(){function n(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return n}();function as(n,e){return n>e?1:n<e?-1:0}function rt(n,e,t){for(var i=new ct(null,null),r=i,o=i;;){var l=t(n,e.key);if(l<0){if(e.left===null)break;if(t(n,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}o.left=e,o=e,e=e.left}else if(l>0){if(e.right===null)break;if(t(n,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}r.right=e,r=e,e=e.right}else break}return r.right=e.left,o.left=e.right,e.left=i.right,e.right=i.left,e}function wn(n,e,t,i){var r=new ct(n,e);if(t===null)return r.left=r.right=null,r;t=rt(n,t,i);var o=i(n,t.key);return o<0?(r.left=t.left,r.right=t,t.left=null):o>=0&&(r.right=t.right,r.left=t,t.right=null),r}function tr(n,e,t){var i=null,r=null;if(e){e=rt(n,e,t);var o=t(e.key,n);o===0?(i=e.left,r=e.right):o<0?(r=e.right,e.right=null,i=e):(i=e.left,e.left=null,r=e)}return{left:i,right:r}}function us(n,e,t){return e===null?n:(n===null||(e=rt(n.key,e,t),e.left=n),e)}function xn(n,e,t,i,r){if(n){i(""+e+(t?" ":" ")+r(n)+`
`);var o=e+(t?"    ":"   ");n.left&&xn(n.left,o,!1,i,r),n.right&&xn(n.right,o,!0,i,r)}}var li=function(){function n(e){e===void 0&&(e=as),this._root=null,this._size=0,this._comparator=e}return n.prototype.insert=function(e,t){return this._size++,this._root=wn(e,t,this._root,this._comparator)},n.prototype.add=function(e,t){var i=new ct(e,t);this._root===null&&(i.left=i.right=null,this._size++,this._root=i);var r=this._comparator,o=rt(e,this._root,r),l=r(e,o.key);return l===0?this._root=o:(l<0?(i.left=o.left,i.right=o,o.left=null):l>0&&(i.right=o.right,i.left=o,o.right=null),this._size++,this._root=i),this._root},n.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},n.prototype._remove=function(e,t,i){var r;if(t===null)return null;t=rt(e,t,i);var o=i(e,t.key);return o===0?(t.left===null?r=t.right:(r=rt(e,t.left,i),r.right=t.right),this._size--,r):t},n.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=rt(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},n.prototype.findStatic=function(e){for(var t=this._root,i=this._comparator;t;){var r=i(e,t.key);if(r===0)return t;r<0?t=t.left:t=t.right}return null},n.prototype.find=function(e){return this._root&&(this._root=rt(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},n.prototype.contains=function(e){for(var t=this._root,i=this._comparator;t;){var r=i(e,t.key);if(r===0)return!0;r<0?t=t.left:t=t.right}return!1},n.prototype.forEach=function(e,t){for(var i=this._root,r=[],o=!1;!o;)i!==null?(r.push(i),i=i.left):r.length!==0?(i=r.pop(),e.call(t,i),i=i.right):o=!0;return this},n.prototype.range=function(e,t,i,r){for(var o=[],l=this._comparator,s=this._root,a;o.length!==0||s;)if(s)o.push(s),s=s.left;else{if(s=o.pop(),a=l(s.key,t),a>0)break;if(l(s.key,e)>=0&&i.call(r,s))return this;s=s.right}return this},n.prototype.keys=function(){var e=[];return this.forEach(function(t){var i=t.key;return e.push(i)}),e},n.prototype.values=function(){var e=[];return this.forEach(function(t){var i=t.data;return e.push(i)}),e},n.prototype.min=function(){return this._root?this.minNode(this._root).key:null},n.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},n.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},n.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},n.prototype.at=function(e){for(var t=this._root,i=!1,r=0,o=[];!i;)if(t)o.push(t),t=t.left;else if(o.length>0){if(t=o.pop(),r===e)return t;r++,t=t.right}else i=!0;return null},n.prototype.next=function(e){var t=this._root,i=null;if(e.right){for(i=e.right;i.left;)i=i.left;return i}for(var r=this._comparator;t;){var o=r(e.key,t.key);if(o===0)break;o<0?(i=t,t=t.left):t=t.right}return i},n.prototype.prev=function(e){var t=this._root,i=null;if(e.left!==null){for(i=e.left;i.right;)i=i.right;return i}for(var r=this._comparator;t;){var o=r(e.key,t.key);if(o===0)break;o<0?t=t.left:(i=t,t=t.right)}return i},n.prototype.clear=function(){return this._root=null,this._size=0,this},n.prototype.toList=function(){return cs(this._root)},n.prototype.load=function(e,t,i){t===void 0&&(t=[]),i===void 0&&(i=!1);var r=e.length,o=this._comparator;if(i&&Rn(e,t,0,r-1,o),this._root===null)this._root=An(e,t,0,r),this._size=r;else{var l=ds(this.toList(),fs(e,t),o);r=this._size+r,this._root=Cn({head:l},0,r)}return this},n.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){e===void 0&&(e=function(i){return String(i.key)});var t=[];return xn(this._root,"",!0,function(i){return t.push(i)},e),t.join("")},n.prototype.update=function(e,t,i){var r=this._comparator,o=tr(e,this._root,r),l=o.left,s=o.right;r(e,t)<0?s=wn(t,i,s,r):l=wn(t,i,l,r),this._root=us(l,s,r)},n.prototype.split=function(e){return tr(e,this._root,this._comparator)},n.prototype[Symbol.iterator]=function(){var e;return ss(this,function(t){switch(t.label){case 0:e=this.minNode(),t.label=1;case 1:return e?[4,e]:[3,3];case 2:return t.sent(),e=this.next(e),[3,1];case 3:return[2]}})},n}();function An(n,e,t,i){var r=i-t;if(r>0){var o=t+Math.floor(r/2),l=n[o],s=e[o],a=new ct(l,s);return a.left=An(n,e,t,o),a.right=An(n,e,o+1,i),a}return null}function fs(n,e){for(var t=new ct(null,null),i=t,r=0;r<n.length;r++)i=i.next=new ct(n[r],e[r]);return i.next=null,t.next}function cs(n){for(var e=n,t=[],i=!1,r=new ct(null,null),o=r;!i;)e?(t.push(e),e=e.left):t.length>0?(e=o=o.next=t.pop(),e=e.right):i=!0;return o.next=null,r.next}function Cn(n,e,t){var i=t-e;if(i>0){var r=e+Math.floor(i/2),o=Cn(n,e,r),l=n.head;return l.left=o,n.head=n.head.next,l.right=Cn(n,r+1,t),l}return null}function ds(n,e,t){for(var i=new ct(null,null),r=i,o=n,l=e;o!==null&&l!==null;)t(o.key,l.key)<0?(r.next=o,o=o.next):(r.next=l,l=l.next),r=r.next;return o!==null?r.next=o:l!==null&&(r.next=l),i.next}function Rn(n,e,t,i,r){if(!(t>=i)){for(var o=n[t+i>>1],l=t-1,s=i+1;;){do l++;while(r(n[l],o)<0);do s--;while(r(n[s],o)>0);if(l>=s)break;var a=n[l];n[l]=n[s],n[s]=a,a=e[l],e[l]=e[s],e[s]=a}Rn(n,e,t,s,r),Rn(n,e,s+1,i,r)}}function Xe(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function nr(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Te(n,e,t){return e&&nr(n.prototype,e),t&&nr(n,t),n}var At=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},On=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var i=e.ll.x<t.ll.x?t.ll.x:e.ll.x,r=e.ur.x<t.ur.x?e.ur.x:t.ur.x,o=e.ll.y<t.ll.y?t.ll.y:e.ll.y,l=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:i,y:o},ur:{x:r,y:l}}},lt=Number.EPSILON;lt===void 0&&(lt=Math.pow(2,-52));var hs=lt*lt,Nn=function(e,t){if(-lt<e&&e<lt&&-lt<t&&t<lt)return 0;var i=e-t;return i*i<hs*e*t?0:e<t?-1:1},ms=function(){function n(){Xe(this,n),this.reset()}return Te(n,[{key:"reset",value:function(){this.xRounder=new ir,this.yRounder=new ir}},{key:"round",value:function(t,i){return{x:this.xRounder.round(t),y:this.yRounder.round(i)}}}]),n}(),ir=function(){function n(){Xe(this,n),this.tree=new li,this.round(0)}return Te(n,[{key:"round",value:function(t){var i=this.tree.add(t),r=this.tree.prev(i);if(r!==null&&Nn(i.key,r.key)===0)return this.tree.remove(t),r.key;var o=this.tree.next(i);return o!==null&&Nn(i.key,o.key)===0?(this.tree.remove(t),o.key):t}}]),n}(),Ft=new ms,Rt=function(e,t){return e.x*t.y-e.y*t.x},Nr=function(e,t){return e.x*t.x+e.y*t.y},rr=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},o={x:i.x-e.x,y:i.y-e.y},l=Rt(r,o);return Nn(l,0)},rn=function(e){return Math.sqrt(Nr(e,e))},ps=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},o={x:i.x-e.x,y:i.y-e.y};return Rt(o,r)/rn(o)/rn(r)},gs=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},o={x:i.x-e.x,y:i.y-e.y};return Nr(o,r)/rn(o)/rn(r)},or=function(e,t,i){return t.y===0?null:{x:e.x+t.x/t.y*(i-e.y),y:i}},lr=function(e,t,i){return t.x===0?null:{x:i,y:e.y+t.y/t.x*(i-e.x)}},bs=function(e,t,i,r){if(t.x===0)return lr(i,r,e.x);if(r.x===0)return lr(e,t,i.x);if(t.y===0)return or(i,r,e.y);if(r.y===0)return or(e,t,i.y);var o=Rt(t,r);if(o==0)return null;var l={x:i.x-e.x,y:i.y-e.y},s=Rt(l,t)/o,a=Rt(l,r)/o,u=e.x+a*t.x,c=i.x+s*r.x,g=e.y+a*t.y,h=i.y+s*r.y,f=(u+c)/2,d=(g+h)/2;return{x:f,y:d}},Ve=function(){Te(n,null,[{key:"compare",value:function(t,i){var r=n.comparePoints(t.point,i.point);return r!==0?r:(t.point!==i.point&&t.link(i),t.isLeft!==i.isLeft?t.isLeft?1:-1:on.compare(t.segment,i.segment))}},{key:"comparePoints",value:function(t,i){return t.x<i.x?-1:t.x>i.x?1:t.y<i.y?-1:t.y>i.y?1:0}}]);function n(e,t){Xe(this,n),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}return Te(n,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var i=t.point.events,r=0,o=i.length;r<o;r++){var l=i[r];this.point.events.push(l),l.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,i=0;i<t;i++){var r=this.point.events[i];if(r.segment.consumedBy===void 0)for(var o=i+1;o<t;o++){var l=this.point.events[o];l.consumedBy===void 0&&r.otherSE.point.events===l.otherSE.point.events&&r.segment.consume(l.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],i=0,r=this.point.events.length;i<r;i++){var o=this.point.events[i];o!==this&&!o.segment.ringOut&&o.segment.isInResult()&&t.push(o)}return t}},{key:"getLeftmostComparator",value:function(t){var i=this,r=new Map,o=function(s){var a=s.otherSE;r.set(s,{sine:ps(i.point,t.point,a.point),cosine:gs(i.point,t.point,a.point)})};return function(l,s){r.has(l)||o(l),r.has(s)||o(s);var a=r.get(l),u=a.sine,c=a.cosine,g=r.get(s),h=g.sine,f=g.cosine;return u>=0&&h>=0?c<f?1:c>f?-1:0:u<0&&h<0?c<f?-1:c>f?1:0:h<u?-1:h>u?1:0}}}]),n}(),vs=0,on=function(){Te(n,null,[{key:"compare",value:function(t,i){var r=t.leftSE.point.x,o=i.leftSE.point.x,l=t.rightSE.point.x,s=i.rightSE.point.x;if(s<r)return 1;if(l<o)return-1;var a=t.leftSE.point.y,u=i.leftSE.point.y,c=t.rightSE.point.y,g=i.rightSE.point.y;if(r<o){if(u<a&&u<c)return 1;if(u>a&&u>c)return-1;var h=t.comparePoint(i.leftSE.point);if(h<0)return 1;if(h>0)return-1;var f=i.comparePoint(t.rightSE.point);return f!==0?f:-1}if(r>o){if(a<u&&a<g)return-1;if(a>u&&a>g)return 1;var d=i.comparePoint(t.leftSE.point);if(d!==0)return d;var b=t.comparePoint(i.rightSE.point);return b<0?1:b>0?-1:1}if(a<u)return-1;if(a>u)return 1;if(l<s){var _=i.comparePoint(t.rightSE.point);if(_!==0)return _}if(l>s){var x=t.comparePoint(i.rightSE.point);if(x<0)return 1;if(x>0)return-1}if(l!==s){var m=c-a,p=l-r,v=g-u,y=s-o;if(m>p&&v<y)return 1;if(m<p&&v>y)return-1}return l>s?1:l<s||c<g?-1:c>g?1:t.id<i.id?-1:t.id>i.id?1:0}}]);function n(e,t,i,r){Xe(this,n),this.id=++vs,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=i,this.windings=r}return Te(n,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,i=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<i?t:i},ur:{x:this.rightSE.point.x,y:t>i?t:i}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var i=this.leftSE.point,r=this.rightSE.point,o=this.vector();if(i.x===r.x)return t.x===i.x?0:t.x<i.x?1:-1;var l=(t.y-i.y)/o.y,s=i.x+l*o.x;if(t.x===s)return 0;var a=(t.x-i.x)/o.x,u=i.y+a*o.y;return t.y===u?0:t.y<u?-1:1}},{key:"getIntersection",value:function(t){var i=this.bbox(),r=t.bbox(),o=On(i,r);if(o===null)return null;var l=this.leftSE.point,s=this.rightSE.point,a=t.leftSE.point,u=t.rightSE.point,c=At(i,a)&&this.comparePoint(a)===0,g=At(r,l)&&t.comparePoint(l)===0,h=At(i,u)&&this.comparePoint(u)===0,f=At(r,s)&&t.comparePoint(s)===0;if(g&&c)return f&&!h?s:!f&&h?u:null;if(g)return h&&l.x===u.x&&l.y===u.y?null:l;if(c)return f&&s.x===a.x&&s.y===a.y?null:a;if(f&&h)return null;if(f)return s;if(h)return u;var d=bs(l,this.vector(),a,t.vector());return d===null||!At(o,d)?null:Ft.round(d.x,d.y)}},{key:"split",value:function(t){var i=[],r=t.events!==void 0,o=new Ve(t,!0),l=new Ve(t,!1),s=this.rightSE;this.replaceRightSE(l),i.push(l),i.push(o);var a=new n(o,s,this.rings.slice(),this.windings.slice());return Ve.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Ve.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(o.checkForConsuming(),l.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var i=0,r=this.windings.length;i<r;i++)this.windings[i]*=-1}},{key:"consume",value:function(t){for(var i=this,r=t;i.consumedBy;)i=i.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var o=n.compare(i,r);if(o!==0){if(o>0){var l=i;i=r,r=l}if(i.prev===r){var s=i;i=r,r=s}for(var a=0,u=r.rings.length;a<u;a++){var c=r.rings[a],g=r.windings[a],h=i.rings.indexOf(c);h===-1?(i.rings.push(c),i.windings.push(g)):i.windings[h]+=g}r.rings=null,r.windings=null,r.consumedBy=i,r.leftSE.consumedBy=i.leftSE,r.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var i=this._afterState.rings,r=this._afterState.windings,o=this._afterState.multiPolys,l=0,s=this.rings.length;l<s;l++){var a=this.rings[l],u=this.windings[l],c=i.indexOf(a);c===-1?(i.push(a),r.push(u)):r[c]+=u}for(var g=[],h=[],f=0,d=i.length;f<d;f++)if(r[f]!==0){var b=i[f],_=b.poly;if(h.indexOf(_)===-1)if(b.isExterior)g.push(_);else{h.indexOf(_)===-1&&h.push(_);var x=g.indexOf(b.poly);x!==-1&&g.splice(x,1)}}for(var m=0,p=g.length;m<p;m++){var v=g[m].multiPoly;o.indexOf(v)===-1&&o.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var t=this.beforeState().multiPolys,i=this.afterState().multiPolys;switch(je.type){case"union":{var r=t.length===0,o=i.length===0;this._isInResult=r!==o;break}case"intersection":{var l,s;t.length<i.length?(l=t.length,s=i.length):(l=i.length,s=t.length),this._isInResult=s===je.numMultiPolys&&l<s;break}case"xor":{var a=Math.abs(t.length-i.length);this._isInResult=a%2===1;break}case"difference":{var u=function(g){return g.length===1&&g[0].isSubject};this._isInResult=u(t)!==u(i);break}default:throw new Error("Unrecognized operation type found ".concat(je.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,i,r){var o,l,s,a=Ve.comparePoints(t,i);if(a<0)o=t,l=i,s=1;else if(a>0)o=i,l=t,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));var u=new Ve(o,!0),c=new Ve(l,!1);return new n(u,c,[r],[s])}}]),n}(),sr=function(){function n(e,t,i){if(Xe(this,n),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=i,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=Ft.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var o=r,l=1,s=e.length;l<s;l++){if(typeof e[l][0]!="number"||typeof e[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var a=Ft.round(e[l][0],e[l][1]);a.x===o.x&&a.y===o.y||(this.segments.push(on.fromRing(o,a,this)),a.x<this.bbox.ll.x&&(this.bbox.ll.x=a.x),a.y<this.bbox.ll.y&&(this.bbox.ll.y=a.y),a.x>this.bbox.ur.x&&(this.bbox.ur.x=a.x),a.y>this.bbox.ur.y&&(this.bbox.ur.y=a.y),o=a)}(r.x!==o.x||r.y!==o.y)&&this.segments.push(on.fromRing(o,r,this))}return Te(n,[{key:"getSweepEvents",value:function(){for(var t=[],i=0,r=this.segments.length;i<r;i++){var o=this.segments[i];t.push(o.leftSE),t.push(o.rightSE)}return t}}]),n}(),_s=function(){function n(e,t){if(Xe(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new sr(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,r=e.length;i<r;i++){var o=new sr(e[i],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=t}return Te(n,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),i=0,r=this.interiorRings.length;i<r;i++)for(var o=this.interiorRings[i].getSweepEvents(),l=0,s=o.length;l<s;l++)t.push(o[l]);return t}}]),n}(),ar=function(){function n(e,t){if(Xe(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,r=e.length;i<r;i++){var o=new _s(e[i],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=t}return Te(n,[{key:"getSweepEvents",value:function(){for(var t=[],i=0,r=this.polys.length;i<r;i++)for(var o=this.polys[i].getSweepEvents(),l=0,s=o.length;l<s;l++)t.push(o[l]);return t}}]),n}(),ys=function(){Te(n,null,[{key:"factory",value:function(t){for(var i=[],r=0,o=t.length;r<o;r++){var l=t[r];if(!(!l.isInResult()||l.ringOut)){for(var s=null,a=l.leftSE,u=l.rightSE,c=[a],g=a.point,h=[];s=a,a=u,c.push(a),a.point!==g;)for(;;){var f=a.getAvailableLinkedEvents();if(f.length===0){var d=c[0].point,b=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(b.x,", ").concat(b.y,"]."))}if(f.length===1){u=f[0].otherSE;break}for(var _=null,x=0,m=h.length;x<m;x++)if(h[x].point===a.point){_=x;break}if(_!==null){var p=h.splice(_)[0],v=c.splice(p.index);v.unshift(v[0].otherSE),i.push(new n(v.reverse()));continue}h.push({index:c.length,point:a.point});var y=a.getLeftmostComparator(s);u=f.sort(y)[0].otherSE;break}i.push(new n(c))}}return i}}]);function n(e){Xe(this,n),this.events=e;for(var t=0,i=e.length;t<i;t++)e[t].segment.ringOut=this;this.poly=null}return Te(n,[{key:"getGeom",value:function(){for(var t=this.events[0].point,i=[t],r=1,o=this.events.length-1;r<o;r++){var l=this.events[r].point,s=this.events[r+1].point;rr(l,t,s)!==0&&(i.push(l),t=l)}if(i.length===1)return null;var a=i[0],u=i[1];rr(a,t,u)===0&&i.shift(),i.push(i[0]);for(var c=this.isExteriorRing()?1:-1,g=this.isExteriorRing()?0:i.length-1,h=this.isExteriorRing()?i.length:-1,f=[],d=g;d!=h;d+=c)f.push([i[d].x,i[d].y]);return f}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],i=1,r=this.events.length;i<r;i++){var o=this.events[i];Ve.compare(t,o)>0&&(t=o)}for(var l=t.segment.prevInResult(),s=l?l.prevInResult():null;;){if(!l)return null;if(!s)return l.ringOut;if(s.ringOut!==l.ringOut)return s.ringOut.enclosingRing()!==l.ringOut?l.ringOut:l.ringOut.enclosingRing();l=s.prevInResult(),s=l?l.prevInResult():null}}}]),n}(),ur=function(){function n(e){Xe(this,n),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return Te(n,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(var i=0,r=this.interiorRings.length;i<r;i++){var o=this.interiorRings[i].getGeom();o!==null&&t.push(o)}return t}}]),n}(),ws=function(){function n(e){Xe(this,n),this.rings=e,this.polys=this._composePolys(e)}return Te(n,[{key:"getGeom",value:function(){for(var t=[],i=0,r=this.polys.length;i<r;i++){var o=this.polys[i].getGeom();o!==null&&t.push(o)}return t}},{key:"_composePolys",value:function(t){for(var i=[],r=0,o=t.length;r<o;r++){var l=t[r];if(!l.poly)if(l.isExteriorRing())i.push(new ur(l));else{var s=l.enclosingRing();s.poly||i.push(new ur(s)),s.poly.addInterior(l)}}return i}}]),n}(),ks=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:on.compare;Xe(this,n),this.queue=e,this.tree=new li(t),this.segments=[]}return Te(n,[{key:"process",value:function(t){var i=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(i),r;var o=t.isLeft?this.tree.insert(i):this.tree.find(i);if(!o)throw new Error("Unable to find segment #".concat(i.id," ")+"[".concat(i.leftSE.point.x,", ").concat(i.leftSE.point.y,"] -> ")+"[".concat(i.rightSE.point.x,", ").concat(i.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var l=o,s=o,a=void 0,u=void 0;a===void 0;)l=this.tree.prev(l),l===null?a=null:l.key.consumedBy===void 0&&(a=l.key);for(;u===void 0;)s=this.tree.next(s),s===null?u=null:s.key.consumedBy===void 0&&(u=s.key);if(t.isLeft){var c=null;if(a){var g=a.getIntersection(i);if(g!==null&&(i.isAnEndpoint(g)||(c=g),!a.isAnEndpoint(g)))for(var h=this._splitSafely(a,g),f=0,d=h.length;f<d;f++)r.push(h[f])}var b=null;if(u){var _=u.getIntersection(i);if(_!==null&&(i.isAnEndpoint(_)||(b=_),!u.isAnEndpoint(_)))for(var x=this._splitSafely(u,_),m=0,p=x.length;m<p;m++)r.push(x[m])}if(c!==null||b!==null){var v=null;if(c===null)v=b;else if(b===null)v=c;else{var y=Ve.comparePoints(c,b);v=y<=0?c:b}this.queue.remove(i.rightSE),r.push(i.rightSE);for(var w=i.split(v),C=0,M=w.length;C<M;C++)r.push(w[C])}r.length>0?(this.tree.remove(i),r.push(t)):(this.segments.push(i),i.prev=a)}else{if(a&&u){var B=a.getIntersection(u);if(B!==null){if(!a.isAnEndpoint(B))for(var Y=this._splitSafely(a,B),T=0,D=Y.length;T<D;T++)r.push(Y[T]);if(!u.isAnEndpoint(B))for(var F=this._splitSafely(u,B),O=0,q=F.length;O<q;O++)r.push(F[O])}}this.tree.remove(i)}return r}},{key:"_splitSafely",value:function(t,i){this.tree.remove(t);var r=t.rightSE;this.queue.remove(r);var o=t.split(i);return o.push(r),t.consumedBy===void 0&&this.tree.insert(t),o}}]),n}(),fr=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ss=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Es=function(){function n(){Xe(this,n)}return Te(n,[{key:"run",value:function(t,i,r){je.type=t,Ft.reset();for(var o=[new ar(i,!0)],l=0,s=r.length;l<s;l++)o.push(new ar(r[l],!1));if(je.numMultiPolys=o.length,je.type==="difference")for(var a=o[0],u=1;u<o.length;)On(o[u].bbox,a.bbox)!==null?u++:o.splice(u,1);if(je.type==="intersection"){for(var c=0,g=o.length;c<g;c++)for(var h=o[c],f=c+1,d=o.length;f<d;f++)if(On(h.bbox,o[f].bbox)===null)return[]}for(var b=new li(Ve.compare),_=0,x=o.length;_<x;_++)for(var m=o[_].getSweepEvents(),p=0,v=m.length;p<v;p++)if(b.insert(m[p]),b.size>fr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var y=new ks(b),w=b.size,C=b.pop();C;){var M=C.key;if(b.size===w){var B=M.segment;throw new Error("Unable to pop() ".concat(M.isLeft?"left":"right"," SweepEvent ")+"[".concat(M.point.x,", ").concat(M.point.y,"] from segment #").concat(B.id," ")+"[".concat(B.leftSE.point.x,", ").concat(B.leftSE.point.y,"] -> ")+"[".concat(B.rightSE.point.x,", ").concat(B.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(b.size>fr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(y.segments.length>Ss)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Y=y.process(M),T=0,D=Y.length;T<D;T++){var F=Y[T];F.consumedBy===void 0&&b.insert(F)}w=b.size,C=b.pop()}Ft.reset();var O=ys.factory(y.segments),q=new ws(O);return q.getGeom()}}]),n}(),je=new Es,Ms=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return je.run("union",e,i)},Ps=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return je.run("intersection",e,i)},Ls=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return je.run("xor",e,i)},Ts=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return je.run("difference",e,i)},Ht={union:Ms,intersection:Ps,xor:Ls,difference:Ts};function xs(n,e){var t=Cs(e),i=null;return n.type==="FeatureCollection"?i=As(n):i=Ir(Ht.union(n.geometry.coordinates)),i.geometry.coordinates.forEach(function(r){t.geometry.coordinates.push(r[0])}),t}function As(n){var e=n.features.length===2?Ht.union(n.features[0].geometry.coordinates,n.features[1].geometry.coordinates):Ht.union.apply(Ht,n.features.map(function(t){return t.geometry.coordinates}));return Ir(e)}function Ir(n){return ii(n)}function Cs(n){var e=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],t=n&&n.geometry.coordinates||e;return pn(t)}function Rs(n,e,t){let i;ge(n,Qe,l=>t(1,i=l));let{boundaryGeojson:r}=e;return cn("setCamera")&&i.fitBounds(Hn(r),{padding:20,animate:!1}),Lt(i,"boundary",{type:"geojson",data:xs(r)}),Be(i,{id:"boundary",source:"boundary",...ti("black",.5)}),n.$$set=l=>{"boundaryGeojson"in l&&t(0,r=l.boundaryGeojson)},[r]}class Os extends ie{constructor(e){super(),re(this,e,Rs,null,oe,{boundaryGeojson:0})}}function Ns(n){let e,t,i,r,o,l,s,a;return e=new jt({props:{labelText:"Area",value:"area"}}),i=new jt({props:{labelText:"Route",value:"route"}}),o=new jt({props:{labelText:"Crossing",value:"crossing"}}),s=new jt({props:{labelText:"Other",value:"other"}}),{c(){j(e.$$.fragment),t=N(),j(i.$$.fragment),r=N(),j(o.$$.fragment),l=N(),j(s.$$.fragment)},m(u,c){W(e,u,c),P(u,t,c),W(i,u,c),P(u,r,c),W(o,u,c),P(u,l,c),W(s,u,c),a=!0},p:ne,i(u){a||(R(e.$$.fragment,u),R(i.$$.fragment,u),R(o.$$.fragment,u),R(s.$$.fragment,u),a=!0)},o(u){z(e.$$.fragment,u),z(i.$$.fragment,u),z(o.$$.fragment,u),z(s.$$.fragment,u),a=!1},d(u){V(e,u),u&&L(t),V(i,u),u&&L(r),V(o,u),u&&L(l),V(s,u)}}}function cr(n){let e,t,i=dr(n[3])+"",r,o,l;return{c(){e=A("p"),t=H("Length: "),r=H(i),o=N(),l=A("br")},m(s,a){P(s,e,a),S(e,t),S(e,r),P(s,o,a),P(s,l,a)},p(s,a){a&8&&i!==(i=dr(s[3])+"")&&de(r,i)},d(s){s&&L(e),s&&L(o),s&&L(l)}}}function Is(n){let e,t,i,r,o,l,s,a,u,c,g,h,f,d,b,_,x,m,p,v,y,w,C;function M(q){n[7](q)}let B={labelText:"Name"};n[0]!==void 0&&(B.value=n[0]),e=new Ll({props:B}),he.push(()=>De(e,"value",M,n[0]));function Y(q){n[8](q)}let T={$$slots:{default:[Ns]},$$scope:{ctx:n}};n[1]!==void 0&&(T.selected=n[1]),l=new hl({props:T}),he.push(()=>De(l,"selected",Y,n[1]));function D(q){n[9](q)}let F={labelText:"Description"};n[2]!==void 0&&(F.value=n[2]),g=new _l({props:F}),he.push(()=>De(g,"value",D,n[2]));let O=n[3]&&cr(n);return{c(){j(e.$$.fragment),i=N(),r=A("br"),o=N(),j(l.$$.fragment),a=N(),u=A("br"),c=N(),j(g.$$.fragment),f=N(),d=A("br"),b=N(),O&&O.c(),_=N(),x=A("div"),m=A("button"),m.textContent="Delete",p=N(),v=A("button"),v.textContent="Save",I(m,"type","button"),I(v,"type","button"),mt(v,"float","right")},m(q,U){W(e,q,U),P(q,i,U),P(q,r,U),P(q,o,U),W(l,q,U),P(q,a,U),P(q,u,U),P(q,c,U),W(g,q,U),P(q,f,U),P(q,d,U),P(q,b,U),O&&O.m(q,U),P(q,_,U),P(q,x,U),S(x,m),S(x,p),S(x,v),n[11](x),y=!0,w||(C=[G(m,"click",n[5]),G(v,"click",n[10])],w=!0)},p(q,[U]){const se={};!t&&U&1&&(t=!0,se.value=q[0],qe(()=>t=!1)),e.$set(se);const te={};U&4096&&(te.$$scope={dirty:U,ctx:q}),!s&&U&2&&(s=!0,te.selected=q[1],qe(()=>s=!1)),l.$set(te);const le={};!h&&U&4&&(h=!0,le.value=q[2],qe(()=>h=!1)),g.$set(le),q[3]?O?O.p(q,U):(O=cr(q),O.c(),O.m(_.parentNode,_)):O&&(O.d(1),O=null)},i(q){y||(R(e.$$.fragment,q),R(l.$$.fragment,q),R(g.$$.fragment,q),y=!0)},o(q){z(e.$$.fragment,q),z(l.$$.fragment,q),z(g.$$.fragment,q),y=!1},d(q){V(e,q),q&&L(i),q&&L(r),q&&L(o),V(l,q),q&&L(a),q&&L(u),q&&L(c),V(g,q),q&&L(f),q&&L(d),q&&L(b),O&&O.d(q),q&&L(_),q&&L(x),n[11](null),w=!1,Ae(C)}}}function dr(n){return n<1e3?Math.round(n)+" m":(n/1e3).toFixed(1)+"km"}function Fs(n,e,t){let{id:i}=e,{name:r}=e,{intervention_type:o}=e,{description:l}=e,{length_meters:s}=e,a;hn.subscribe(b=>{i==b&&setTimeout(()=>a==null?void 0:a.scrollIntoView({behavior:"smooth"}),1)});function u(){ue.update(b=>(b.features=b.features.filter(_=>_.id!=i),b)),at(null)}function c(b){r=b,t(0,r)}function g(b){o=b,t(1,o)}function h(b){l=b,t(2,l)}const f=()=>at(null);function d(b){he[b?"unshift":"push"](()=>{a=b,t(4,a)})}return n.$$set=b=>{"id"in b&&t(6,i=b.id),"name"in b&&t(0,r=b.name),"intervention_type"in b&&t(1,o=b.intervention_type),"description"in b&&t(2,l=b.description),"length_meters"in b&&t(3,s=b.length_meters)},[r,o,l,s,a,u,i,c,g,h,f,d]}class Bs extends ie{constructor(e){super(),re(this,e,Fs,Is,oe,{id:6,name:0,intervention_type:1,description:2,length_meters:3})}}function hr(n,e,t){const i=n.slice();return i[13]=e[t],i[14]=e,i[15]=t,i}function zs(n){let e,t,i,r,o,l;function s(g){n[5](g,n[13])}function a(g){n[6](g,n[13])}function u(g){n[7](g,n[13])}let c={id:n[13].id,length_meters:n[13].properties.length_meters};return n[13].properties.name!==void 0&&(c.name=n[13].properties.name),n[13].properties.intervention_type!==void 0&&(c.intervention_type=n[13].properties.intervention_type),n[13].properties.description!==void 0&&(c.description=n[13].properties.description),e=new Bs({props:c}),he.push(()=>De(e,"name",s,n[13].properties.name)),he.push(()=>De(e,"intervention_type",a,n[13].properties.intervention_type)),he.push(()=>De(e,"description",u,n[13].properties.description)),{c(){j(e.$$.fragment),o=N()},m(g,h){W(e,g,h),P(g,o,h),l=!0},p(g,h){n=g;const f={};h&1&&(f.id=n[13].id),h&1&&(f.length_meters=n[13].properties.length_meters),!t&&h&1&&(t=!0,f.name=n[13].properties.name,qe(()=>t=!1)),!i&&h&1&&(i=!0,f.intervention_type=n[13].properties.intervention_type,qe(()=>i=!1)),!r&&h&1&&(r=!0,f.description=n[13].properties.description,qe(()=>r=!1)),e.$set(f)},i(g){l||(R(e.$$.fragment,g),l=!0)},o(g){z(e.$$.fragment,g),l=!1},d(g){V(e,g),g&&L(o)}}}function Ds(n){let e=n[15]+1+"",t,i,r=ln(n[13])+"",o;return{c(){t=H(e),i=H(") "),o=H(r)},m(l,s){P(l,t,s),P(l,i,s),P(l,o,s)},p(l,s){s&1&&e!==(e=l[15]+1+"")&&de(t,e),s&1&&r!==(r=ln(l[13])+"")&&de(o,r)},d(l){l&&L(t),l&&L(i),l&&L(o)}}}function qs(n){let e,t=n[15]+1+"",i,r,o=ln(n[13])+"",l;return{c(){e=A("strong"),i=H(t),r=H(") "),l=H(o)},m(s,a){P(s,e,a),S(e,i),S(e,r),S(e,l)},p(s,a){a&1&&t!==(t=s[15]+1+"")&&de(i,t),a&1&&o!==(o=ln(s[13])+"")&&de(l,o)},d(s){s&&L(e)}}}function Gs(n){let e;function t(o,l){return o[13].id==o[1]?qs:Ds}let i=t(n),r=i(n);return{c(){r.c(),e=N()},m(o,l){r.m(o,l),P(o,e,l)},p(o,l){i===(i=t(o))&&r?r.p(o,l):(r.d(1),r=i(o),r&&(r.c(),r.m(e.parentNode,e)))},d(o){r.d(o),o&&L(e)}}}function mr(n,e){let t,i,r,o;function l(c){e[8](c,e[13])}function s(){return e[9](e[13])}function a(){return e[10](e[13])}let u={$$slots:{title:[Gs],default:[zs]},$$scope:{ctx:e}};return e[13].properties.editing!==void 0&&(u.open=e[13].properties.editing),i=new Go({props:u}),he.push(()=>De(i,"open",l,e[13].properties.editing)),i.$on("click",s),i.$on("mouseenter",a),i.$on("mouseleave",e[11]),{key:n,first:null,c(){t=tt(),j(i.$$.fragment),this.first=t},m(c,g){P(c,t,g),W(i,c,g),o=!0},p(c,g){e=c;const h={};g&65539&&(h.$$scope={dirty:g,ctx:e}),!r&&g&1&&(r=!0,h.open=e[13].properties.editing,qe(()=>r=!1)),i.$set(h)},i(c){o||(R(i.$$.fragment,c),o=!0)},o(c){z(i.$$.fragment,c),o=!1},d(c){c&&L(t),V(i,c)}}}function Ys(n){let e=[],t=new Map,i,r,o=n[0].features;const l=s=>s[13].id;for(let s=0;s<o.length;s+=1){let a=hr(n,o,s),u=l(a);t.set(u,e[s]=mr(u,a))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();i=tt()},m(s,a){for(let u=0;u<e.length;u+=1)e[u].m(s,a);P(s,i,a),r=!0},p(s,a){a&15&&(o=s[0].features,Se(),e=Tr(e,a,l,1,s,o,t,i.parentNode,xr,mr,i,hr),Ee())},i(s){if(!r){for(let a=0;a<o.length;a+=1)R(e[a]);r=!0}},o(s){for(let a=0;a<e.length;a+=1)z(e[a]);r=!1},d(s){for(let a=0;a<e.length;a+=1)e[a].d(s);s&&L(i)}}}function Xs(n){let e,t,i,r;return e=new Io({props:{$$slots:{default:[Ys]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},m(o,l){W(e,o,l),t=!0,i||(r=G(window,"keydown",n[4]),i=!0)},p(o,[l]){const s={};l&65539&&(s.$$scope={dirty:l,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){z(e.$$.fragment,o),t=!1},d(o){V(e,o),i=!1,r()}}}function ln(n){if(n.properties.name)return n.properties.name;var e=n.properties.intervention_type;return e=="other"&&(n.geometry.type=="Point"?e="point":n.geometry.type=="LineString"?e="line":e="polygon"),`Untitled ${e}`}function Js(n,e,t){let i,r,o;ge(n,hn,_=>t(12,i=_)),ge(n,ue,_=>t(0,r=_)),ge(n,Ue,_=>t(1,o=_));function l(_){i==null&&Ue.set(_)}function s(_){console.log(`Clicked ${_} from the sidebar; going to edit-attribute`),Ln.set(null),Ln.set(_);for(let x of r.features)x.properties.editing&&x.id!=_&&delete x.properties.editing;Ue.set(_)}function a(_){const x=i;if(_.key=="Delete"){const m=_.target.tagName;if(m!="CANVAS"&&m!="BODY")return;_.preventDefault(),ue.update(p=>(p.features=p.features.filter(v=>v.id!=x),p))}}function u(_,x){n.$$.not_equal(x.properties.name,_)&&(x.properties.name=_,ue.set(r))}function c(_,x){n.$$.not_equal(x.properties.intervention_type,_)&&(x.properties.intervention_type=_,ue.set(r))}function g(_,x){n.$$.not_equal(x.properties.description,_)&&(x.properties.description=_,ue.set(r))}function h(_,x){n.$$.not_equal(x.properties.editing,_)&&(x.properties.editing=_,ue.set(r))}return[r,o,l,s,a,u,c,g,h,_=>s(_.id),_=>l(_.id),()=>l(null)]}class Us extends ie{constructor(e){super(),re(this,e,Js,Xs,oe,{})}}function ut(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ze(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function In(n,e){return n.type==="FeatureCollection"?"FeatureCollection":n.type==="GeometryCollection"?"GeometryCollection":n.type==="Feature"&&n.geometry!==null?n.geometry.type:n.type}function ot(n,e,t){t===void 0&&(t={});var i=ut(n),r=ut(e),o=ze(r[1]-i[1]),l=ze(r[0]-i[0]),s=ze(i[1]),a=ze(r[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(s)*Math.cos(a);return ri(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),t.units)}function gt(n,e,t){if(n!==null)for(var i,r,o,l,s,a,u,c=0,g=0,h,f=n.type,d=f==="FeatureCollection",b=f==="Feature",_=d?n.features.length:1,x=0;x<_;x++){u=d?n.features[x].geometry:b?n.geometry:n,h=u?u.type==="GeometryCollection":!1,s=h?u.geometries.length:1;for(var m=0;m<s;m++){var p=0,v=0;if(l=h?u.geometries[m]:u,l!==null){a=l.coordinates;var y=l.type;switch(c=t&&(y==="Polygon"||y==="MultiPolygon")?1:0,y){case null:break;case"Point":if(e(a,g,x,p,v)===!1)return!1;g++,p++;break;case"LineString":case"MultiPoint":for(i=0;i<a.length;i++){if(e(a[i],g,x,p,v)===!1)return!1;g++,y==="MultiPoint"&&p++}y==="LineString"&&p++;break;case"Polygon":case"MultiLineString":for(i=0;i<a.length;i++){for(r=0;r<a[i].length-c;r++){if(e(a[i][r],g,x,p,v)===!1)return!1;g++}y==="MultiLineString"&&p++,y==="Polygon"&&v++}y==="Polygon"&&p++;break;case"MultiPolygon":for(i=0;i<a.length;i++){for(v=0,r=0;r<a[i].length;r++){for(o=0;o<a[i][r].length-c;o++){if(e(a[i][r][o],g,x,p,v)===!1)return!1;g++}v++}p++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(gt(l.geometries[i],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function js(n,e,t,i){var r=t;return gt(n,function(o,l,s,a,u){l===0&&t===void 0?r=o:r=e(r,o,l,s,a,u)},i),r}function Fr(n,e){var t;switch(n.type){case"FeatureCollection":for(t=0;t<n.features.length&&e(n.features[t].properties,t)!==!1;t++);break;case"Feature":e(n.properties,0);break}}function Ws(n,e,t){var i=t;return Fr(n,function(r,o){o===0&&t===void 0?i=r:i=e(i,r,o)}),i}function Mt(n,e){if(n.type==="Feature")e(n,0);else if(n.type==="FeatureCollection")for(var t=0;t<n.features.length&&e(n.features[t],t)!==!1;t++);}function Br(n,e,t){var i=t;return Mt(n,function(r,o){o===0&&t===void 0?i=r:i=e(i,r,o)}),i}function Vs(n){var e=[];return gt(n,function(t){e.push(t)}),e}function si(n,e){var t,i,r,o,l,s,a,u,c,g,h=0,f=n.type==="FeatureCollection",d=n.type==="Feature",b=f?n.features.length:1;for(t=0;t<b;t++){for(s=f?n.features[t].geometry:d?n.geometry:n,u=f?n.features[t].properties:d?n.properties:{},c=f?n.features[t].bbox:d?n.bbox:void 0,g=f?n.features[t].id:d?n.id:void 0,a=s?s.type==="GeometryCollection":!1,l=a?s.geometries.length:1,r=0;r<l;r++){if(o=a?s.geometries[r]:s,o===null){if(e(null,h,u,c,g)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,h,u,c,g)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<o.geometries.length;i++)if(e(o.geometries[i],h,u,c,g)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}h++}}function Hs(n,e,t){var i=t;return si(n,function(r,o,l,s,a){o===0&&t===void 0?i=r:i=e(i,r,o,l,s,a)}),i}function bt(n,e){si(n,function(t,i,r,o,l){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(Ye(t,r,{bbox:o,id:l}),i,0)===!1?!1:void 0}var a;switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon";break}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u],g={type:a,coordinates:c};if(e(Ye(g,r),i,u)===!1)return!1}})}function Zs(n,e,t){var i=t;return bt(n,function(r,o,l){o===0&&l===0&&t===void 0?i=r:i=e(i,r,o,l)}),i}function zr(n,e){bt(n,function(t,i,r){var o=0;if(t.geometry){var l=t.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var s,a=0,u=0,c=0;if(gt(t,function(g,h,f,d,b){if(s===void 0||i>a||d>u||b>c){s=g,a=i,u=d,c=b,o=0;return}var _=Le([s,g],t.properties);if(e(_,i,r,b,o)===!1)return!1;o++,s=g})===!1)return!1}}})}function Dr(n,e,t){var i=t,r=!1;return zr(n,function(o,l,s,a,u){r===!1&&t===void 0?i=o:i=e(i,o,l,s,a,u),r=!0}),i}function qr(n,e){if(!n)throw new Error("geojson is required");bt(n,function(t,i,r){if(t.geometry!==null){var o=t.geometry.type,l=t.geometry.coordinates;switch(o){case"LineString":if(e(t,i,r,0,0)===!1)return!1;break;case"Polygon":for(var s=0;s<l.length;s++)if(e(Le(l[s],t.properties),i,r,s)===!1)return!1;break}}})}function Qs(n,e,t){var i=t;return qr(n,function(r,o,l,s){o===0&&t===void 0?i=r:i=e(i,r,o,l,s)}),i}function Ks(n,e){if(e=e||{},!oi(e))throw new Error("options is invalid");var t=e.featureIndex||0,i=e.multiFeatureIndex||0,r=e.geometryIndex||0,o=e.segmentIndex||0,l=e.properties,s;switch(n.type){case"FeatureCollection":t<0&&(t=n.features.length+t),l=l||n.features[t].properties,s=n.features[t].geometry;break;case"Feature":l=l||n.properties,s=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=n;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var a=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=a.length+o-1),Le([a[o],a[o+1]],l,e);case"Polygon":return r<0&&(r=a.length+r),o<0&&(o=a[r].length+o-1),Le([a[r][o],a[r][o+1]],l,e);case"MultiLineString":return i<0&&(i=a.length+i),o<0&&(o=a[i].length+o-1),Le([a[i][o],a[i][o+1]],l,e);case"MultiPolygon":return i<0&&(i=a.length+i),r<0&&(r=a[i].length+r),o<0&&(o=a[i][r].length-o-1),Le([a[i][r][o],a[i][r][o+1]],l,e)}throw new Error("geojson is invalid")}function $s(n,e){if(e=e||{},!oi(e))throw new Error("options is invalid");var t=e.featureIndex||0,i=e.multiFeatureIndex||0,r=e.geometryIndex||0,o=e.coordIndex||0,l=e.properties,s;switch(n.type){case"FeatureCollection":t<0&&(t=n.features.length+t),l=l||n.features[t].properties,s=n.features[t].geometry;break;case"Feature":l=l||n.properties,s=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=n;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var a=s.coordinates;switch(s.type){case"Point":return Me(a,l,e);case"MultiPoint":return i<0&&(i=a.length+i),Me(a[i],l,e);case"LineString":return o<0&&(o=a.length+o),Me(a[o],l,e);case"Polygon":return r<0&&(r=a.length+r),o<0&&(o=a[r].length+o),Me(a[r][o],l,e);case"MultiLineString":return i<0&&(i=a.length+i),o<0&&(o=a[i].length+o),Me(a[i][o],l,e);case"MultiPolygon":return i<0&&(i=a.length+i),r<0&&(r=a[i].length+r),o<0&&(o=a[i][r].length-o),Me(a[i][r][o],l,e)}throw new Error("geojson is invalid")}const ea=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Vs,coordEach:gt,coordReduce:js,featureEach:Mt,featureReduce:Br,findPoint:$s,findSegment:Ks,flattenEach:bt,flattenReduce:Zs,geomEach:si,geomReduce:Hs,lineEach:qr,lineReduce:Qs,propEach:Fr,propReduce:Ws,segmentEach:zr,segmentReduce:Dr},Symbol.toStringTag,{value:"Module"}));function Zt(n,e){return e===void 0&&(e={}),Dr(n,function(t,i){var r=i.geometry.coordinates;return t+ot(r[0],r[1],e)},0)}function ta(n){let e,t,i,r,o,l,s,a,u,c,g,h,f,d,b,_,x,m,p,v=n[0].features.length+"",y,w,C,M,B,Y,T,D;return{c(){e=A("div"),t=A("label"),i=H(`Scheme name:
    `),r=A("input"),o=N(),l=A("br"),s=N(),a=A("div"),u=A("label"),c=A("input"),g=N(),h=A("button"),h.textContent="Load from GeoJSON",f=N(),d=A("button"),d.textContent="Export to GeoJSON",b=N(),_=A("br"),x=N(),m=A("div"),p=A("span"),y=H(v),w=H(" interventions"),C=N(),M=A("button"),B=H("Clear all"),I(r,"type","text"),I(c,"type","file"),I(c,"id","load_geojson"),I(c,"class","svelte-lhyd1e"),I(h,"type","button"),I(d,"type","button"),I(d,"class","align-right svelte-lhyd1e"),I(M,"type","button"),I(M,"class","align-right svelte-lhyd1e"),M.disabled=Y=n[0].features.length==0},m(F,O){P(F,e,O),S(e,t),S(t,i),S(t,r),Et(r,n[0].scheme_name),P(F,o,O),P(F,l,O),P(F,s,O),P(F,a,O),S(a,u),S(u,c),S(u,g),S(u,h),S(a,f),S(a,d),P(F,b,O),P(F,_,O),P(F,x,O),P(F,m,O),S(m,p),S(p,y),S(p,w),S(m,C),S(m,M),S(M,B),T||(D=[G(r,"input",n[5]),G(c,"change",n[3]),G(h,"click",n[6]),G(d,"click",n[2]),G(M,"click",n[1])],T=!0)},p(F,[O]){O&1&&r.value!==F[0].scheme_name&&Et(r,F[0].scheme_name),O&1&&v!==(v=F[0].features.length+"")&&de(y,v),O&1&&Y!==(Y=F[0].features.length==0)&&(M.disabled=Y)},i:ne,o:ne,d(F){F&&L(e),F&&L(o),F&&L(l),F&&L(s),F&&L(a),F&&L(b),F&&L(_),F&&L(x),F&&L(m),T=!1,Ae(D)}}}function na(n,e){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(e)),t.setAttribute("download",n),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function ia(n,e,t){let i;ge(n,ue,f=>t(0,i=f));let{authorityName:r}=e,o=window.localStorage.getItem(r);if(o)try{ue.set(c(JSON.parse(o)))}catch(f){console.log(`Failed to load from local storage: ${f}`)}function l(){confirm("Do you want to clear the current scheme? (You should save it first!)")&&ue.update(f=>(delete f.scheme_name,f.features=[],f))}function s(){const f=JSON.parse(JSON.stringify(i));for(let d of f.features)delete d.properties.editing,delete d.properties.hide_while_editing;return f}function a(){let f=s();var d=r;f.authority=r,f.origin="atip-v1",f.scheme_name&&(d+="_"+f.scheme_name),d+=".txt",na(d,JSON.stringify(f,null,"  "))}function u(f){const d=new FileReader;d.onload=b=>{try{ue.set(c(JSON.parse(b.target.result)))}catch(_){window.alert(`Couldn't load scheme from a file: ${_}`)}},d.readAsText(f.target.files[0])}function c(f){let d=1;for(let b of f.features)b.geometry.type=="LineString"&&!b.properties.length_meters&&(b.properties.length_meters=Zt(b,{units:"kilometers"})*1e3),b.id=d++;return f}function g(){i.scheme_name=this.value,ue.set(i)}const h=()=>document.getElementById("load_geojson").click();return n.$$set=f=>{"authorityName"in f&&t(4,r=f.authorityName)},n.$$.update=()=>{n.$$.dirty&17&&i&&(console.log("GJ changed, saving to local storage"),window.localStorage.setItem(r,JSON.stringify(s())))},[i,l,a,u,r,g,h]}class ra extends ie{constructor(e){super(),re(this,e,ia,ta,oe,{authorityName:4})}}const oa="/atip/assets/zoom_out_map-b2e1091a.svg";function la(n){let e,t,i,r,o;return{c(){e=A("button"),t=A("img"),co(t.src,i=oa)||I(t,"src",i),I(t,"alt","Zoom to show entire boundary"),I(e,"type","button"),I(e,"title","Zoom to show entire boundary"),I(e,"class","svelte-qzjsqo")},m(l,s){P(l,e,s),S(e,t),r||(o=G(e,"click",n[0]),r=!0)},p:ne,i:ne,o:ne,d(l){l&&L(e),r=!1,o()}}}function sa(n,e,t){let i;ge(n,Qe,l=>t(2,i=l));let{boundaryGeojson:r}=e;function o(){i.fitBounds(Hn(r),{padding:20,animate:!0,duration:500})}return n.$$set=l=>{"boundaryGeojson"in l&&t(1,r=l.boundaryGeojson)},[o,r]}class aa extends ie{constructor(e){super(),re(this,e,sa,la,oe,{boundaryGeojson:1})}}function ua(n){let e,t,i,r,o,l,s;return{c(){e=A("div"),t=H(`Basemap:
  `),i=A("select"),r=A("option"),r.textContent="Streets",o=A("option"),o.textContent="Satellite",r.__value="streets",r.value=r.__value,o.__value="hybrid",o.value=o.__value,n[0]===void 0&&ho(()=>n[2].call(i)),I(e,"class","svelte-1tbnm6i")},m(a,u){P(a,e,u),S(e,t),S(e,i),S(i,r),S(i,o),mi(i,n[0]),l||(s=[G(i,"change",n[2]),G(i,"change",n[1])],l=!0)},p(a,[u]){u&1&&mi(i,a[0])},i:ne,o:ne,d(a){a&&L(e),l=!1,Ae(s)}}}function fa(n,e,t){let{style:i}=e;function r(){let l=new URLSearchParams(window.location.search);l.set("style",i);let s=`${window.location.pathname}?${l.toString()}${window.location.hash}`;window.location.href=s}function o(){i=mo(this),t(0,i)}return n.$$set=l=>{"style"in l&&t(0,i=l.style)},[i,r,o]}class ca extends ie{constructor(e){super(),re(this,e,fa,ua,oe,{style:0})}}const Re={area:"#e41a1c",route:"#377eb8",crossing:"#4daf4a",other:"#984ea3",hovering:"black",lineEndpointColor:"black"},bn=10,sn=10;function da(n){let e,t,i,r,o,l,s,a,u,c,g,h,f,d,b,_,x,m,p;return{c(){e=A("div"),t=A("h1"),t.textContent="Interventions",i=N(),r=A("ul"),o=A("li"),l=A("span"),s=H("Areas"),a=N(),u=A("li"),c=A("span"),g=H("Routes"),h=N(),f=A("li"),d=A("span"),b=H("Crossings"),_=N(),x=A("li"),m=A("span"),p=H("Other"),I(t,"class","svelte-p551i1"),I(l,"class","svelte-p551i1"),mt(l,"background",Re.area),I(c,"class","svelte-p551i1"),mt(c,"background",Re.route),I(d,"class","svelte-p551i1"),mt(d,"background",Re.crossing),I(m,"class","svelte-p551i1"),mt(m,"background",Re.other),I(e,"class","svelte-p551i1")},m(v,y){P(v,e,y),S(e,t),S(e,i),S(e,r),S(r,o),S(o,l),S(o,s),S(r,a),S(r,u),S(u,c),S(u,g),S(r,h),S(r,f),S(f,d),S(f,b),S(r,_),S(r,x),S(x,m),S(x,p)},p:ne,i:ne,o:ne,d(v){v&&L(e)}}}class ha extends ie{constructor(e){super(),re(this,e,null,da,oe,{})}}let vt="interventions";function ma(n,e,t){let i,r;ge(n,Qe,a=>t(0,i=a)),ge(n,ue,a=>t(1,r=a)),Lt(i,vt,{type:"geojson",data:r});const o=["match",["get","intervention_type"],"area",Re.area,"route",Re.route,"crossing",Re.crossing,"other",Re.other,"white"],l=["!=","hide_while_editing",!0];return Be(i,{id:"interventions-points",source:vt,filter:["all",ei,l,["!=","endpoint",!0]],...Xt(o,bn)}),Be(i,{id:"interventions-lines",source:vt,filter:["all",$n,l],...tn(o,sn)},"route-lines"),Be(i,{id:"interventions-lines-endpoints",source:vt,filter:["==","endpoint",!0],type:"circle",paint:{"circle-radius":.5*sn,"circle-opacity":0,"circle-stroke-color":Re.lineEndpointColor,"circle-stroke-width":2}}),Be(i,{id:"interventions-polygons",source:vt,filter:["all",Kn,l],...ti(o,.5)},"hover-polygons"),n.$$.update=()=>{if(n.$$.dirty&3){let a=JSON.parse(JSON.stringify(r)),u=[];for(let c of a.features)if(c.geometry.type=="LineString")for(let g of[c.geometry.coordinates[0],c.geometry.coordinates[c.geometry.coordinates.length-1]])u.push({type:"Feature",properties:{endpoint:!0},geometry:{type:"Point",coordinates:g}});a.features=a.features.concat(u),i.getSource(vt).setData(a)}},[i,r]}class pa extends ie{constructor(e){super(),re(this,e,ma,null,oe,{})}}let _t="hover";function ga(n,e,t){let i,r;return ge(n,Qe,o=>t(0,i=o)),ge(n,ue,o=>t(1,r=o)),Lt(i,_t,{type:"geojson",data:et()}),Be(i,{id:"hover-polygons",source:_t,filter:Kn,...tn(Re.hovering,.5*sn,1)}),Be(i,{id:"hover-lines",source:_t,filter:$n,...tn(Re.hovering,1.5*sn,1)},"interventions-lines"),Be(i,{id:"hover-points",source:_t,filter:ei,...Xt(Re.hovering,1.5*bn,1)},"interventions-points"),Ue.subscribe(o=>{o!=null?i.getSource(_t).setData(r.features.find(l=>l.id==o)):i.getSource(_t).setData(et())}),[]}class ba extends ie{constructor(e){super(),re(this,e,ga,null,oe,{})}}const Wt="edit-point-mode";var zt,Fn;class va{constructor(e){dt(this,zt);Ce(this,"map");Ce(this,"active");Ce(this,"eventListeners");Ce(this,"cursor");this.map=e,this.active=!1,this.eventListeners=[],this.cursor=null,e.on("mousemove",t=>{this.active&&(this.cursor=_a(t.lngLat.toArray()),me(this,zt,Fn).call(this))}),e.on("click",()=>{if(this.active&&this.cursor){for(let t of this.eventListeners)t(this.cursor);this.stop()}}),Lt(e,Wt,{type:"geojson",data:et()}),Be(e,{id:"edit-point-mode",source:Wt,...Xt(Re.hovering,bn,1)})}addEventListener(e){this.eventListeners.push(e)}tearDown(){this.map.removeLayer("edit-point-mode"),this.map.removeSource(Wt)}start(){this.active=!0}stop(){this.cursor=null,this.active=!1,me(this,zt,Fn).call(this)}}zt=new WeakSet,Fn=function(){let e=et();this.cursor&&e.features.push(this.cursor),this.map.getSource(Wt).setData(e)};function _a(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function Gr(n,e,t){if(t===void 0&&(t={}),t.final===!0)return ya(n,e);var i=ut(n),r=ut(e),o=ze(i[0]),l=ze(r[0]),s=ze(i[1]),a=ze(r[1]),u=Math.sin(l-o)*Math.cos(a),c=Math.cos(s)*Math.sin(a)-Math.sin(s)*Math.cos(a)*Math.cos(l-o);return It(Math.atan2(u,c))}function ya(n,e){var t=Gr(e,n);return t=(t+180)%360,t}function pr(n,e,t,i){i===void 0&&(i={});var r=ut(n),o=ze(r[0]),l=ze(r[1]),s=ze(t),a=gn(e,i.units),u=Math.asin(Math.sin(l)*Math.cos(a)+Math.cos(l)*Math.sin(a)*Math.cos(s)),c=o+Math.atan2(Math.sin(s)*Math.sin(a)*Math.cos(l),Math.cos(a)-Math.sin(l)*Math.sin(u)),g=It(c),h=It(u);return Me([g,h],i.properties)}function Bn(n){if(!n)throw new Error("geojson is required");var e=[];return bt(n,function(t){wa(t,e)}),Ge(e)}function wa(n,e){var t=[],i=n.geometry;if(i!==null){switch(i.type){case"Polygon":t=Ze(i);break;case"LineString":t=[Ze(i)]}t.forEach(function(r){var o=ka(r,n.properties);o.forEach(function(l){l.id=e.length,e.push(l)})})}}function ka(n,e){var t=[];return n.reduce(function(i,r){var o=Le([i,r],e);return o.bbox=Sa(i,r),t.push(o),r}),t}function Sa(n,e){var t=n[0],i=n[1],r=e[0],o=e[1],l=t<r?t:r,s=i<o?i:o,a=t>r?t:r,u=i>o?i:o;return[l,s,a,u]}var Pt={},Ea={get exports(){return Pt},set exports(n){Pt=n}},zn={},Ma={get exports(){return zn},set exports(n){zn=n}};(function(n,e){(function(t,i){n.exports=i()})(po,function(){function t(m,p,v,y,w){(function C(M,B,Y,T,D){for(;T>Y;){if(T-Y>600){var F=T-Y+1,O=B-Y+1,q=Math.log(F),U=.5*Math.exp(2*q/3),se=.5*Math.sqrt(q*U*(F-U)/F)*(O-F/2<0?-1:1),te=Math.max(Y,Math.floor(B-O*U/F+se)),le=Math.min(T,Math.floor(B+(F-O)*U/F+se));C(M,B,te,le,D)}var fe=M[B],ae=Y,E=T;for(i(M,Y,B),D(M[T],fe)>0&&i(M,Y,T);ae<E;){for(i(M,ae,E),ae++,E--;D(M[ae],fe)<0;)ae++;for(;D(M[E],fe)>0;)E--}D(M[Y],fe)===0?i(M,Y,E):i(M,++E,T),E<=B&&(Y=E+1),B<=E&&(T=E-1)}})(m,p,v||0,y||m.length-1,w||r)}function i(m,p,v){var y=m[p];m[p]=m[v],m[v]=y}function r(m,p){return m<p?-1:m>p?1:0}var o=function(m){m===void 0&&(m=9),this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(m,p,v){if(!v)return p.indexOf(m);for(var y=0;y<p.length;y++)if(v(m,p[y]))return y;return-1}function s(m,p){a(m,0,m.children.length,p,m)}function a(m,p,v,y,w){w||(w=_(null)),w.minX=1/0,w.minY=1/0,w.maxX=-1/0,w.maxY=-1/0;for(var C=p;C<v;C++){var M=m.children[C];u(w,m.leaf?y(M):M)}return w}function u(m,p){return m.minX=Math.min(m.minX,p.minX),m.minY=Math.min(m.minY,p.minY),m.maxX=Math.max(m.maxX,p.maxX),m.maxY=Math.max(m.maxY,p.maxY),m}function c(m,p){return m.minX-p.minX}function g(m,p){return m.minY-p.minY}function h(m){return(m.maxX-m.minX)*(m.maxY-m.minY)}function f(m){return m.maxX-m.minX+(m.maxY-m.minY)}function d(m,p){return m.minX<=p.minX&&m.minY<=p.minY&&p.maxX<=m.maxX&&p.maxY<=m.maxY}function b(m,p){return p.minX<=m.maxX&&p.minY<=m.maxY&&p.maxX>=m.minX&&p.maxY>=m.minY}function _(m){return{children:m,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function x(m,p,v,y,w){for(var C=[p,v];C.length;)if(!((v=C.pop())-(p=C.pop())<=y)){var M=p+Math.ceil((v-p)/y/2)*y;t(m,M,p,v,w),C.push(p,M,M,v)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(m){var p=this.data,v=[];if(!b(m,p))return v;for(var y=this.toBBox,w=[];p;){for(var C=0;C<p.children.length;C++){var M=p.children[C],B=p.leaf?y(M):M;b(m,B)&&(p.leaf?v.push(M):d(m,B)?this._all(M,v):w.push(M))}p=w.pop()}return v},o.prototype.collides=function(m){var p=this.data;if(!b(m,p))return!1;for(var v=[];p;){for(var y=0;y<p.children.length;y++){var w=p.children[y],C=p.leaf?this.toBBox(w):w;if(b(m,C)){if(p.leaf||d(m,C))return!0;v.push(w)}}p=v.pop()}return!1},o.prototype.load=function(m){if(!m||!m.length)return this;if(m.length<this._minEntries){for(var p=0;p<m.length;p++)this.insert(m[p]);return this}var v=this._build(m.slice(),0,m.length-1,0);if(this.data.children.length)if(this.data.height===v.height)this._splitRoot(this.data,v);else{if(this.data.height<v.height){var y=this.data;this.data=v,v=y}this._insert(v,this.data.height-v.height-1,!0)}else this.data=v;return this},o.prototype.insert=function(m){return m&&this._insert(m,this.data.height-1),this},o.prototype.clear=function(){return this.data=_([]),this},o.prototype.remove=function(m,p){if(!m)return this;for(var v,y,w,C=this.data,M=this.toBBox(m),B=[],Y=[];C||B.length;){if(C||(C=B.pop(),y=B[B.length-1],v=Y.pop(),w=!0),C.leaf){var T=l(m,C.children,p);if(T!==-1)return C.children.splice(T,1),B.push(C),this._condense(B),this}w||C.leaf||!d(C,M)?y?(v++,C=y.children[v],w=!1):C=null:(B.push(C),Y.push(v),v=0,y=C,C=C.children[0])}return this},o.prototype.toBBox=function(m){return m},o.prototype.compareMinX=function(m,p){return m.minX-p.minX},o.prototype.compareMinY=function(m,p){return m.minY-p.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(m){return this.data=m,this},o.prototype._all=function(m,p){for(var v=[];m;)m.leaf?p.push.apply(p,m.children):v.push.apply(v,m.children),m=v.pop();return p},o.prototype._build=function(m,p,v,y){var w,C=v-p+1,M=this._maxEntries;if(C<=M)return s(w=_(m.slice(p,v+1)),this.toBBox),w;y||(y=Math.ceil(Math.log(C)/Math.log(M)),M=Math.ceil(C/Math.pow(M,y-1))),(w=_([])).leaf=!1,w.height=y;var B=Math.ceil(C/M),Y=B*Math.ceil(Math.sqrt(M));x(m,p,v,Y,this.compareMinX);for(var T=p;T<=v;T+=Y){var D=Math.min(T+Y-1,v);x(m,T,D,B,this.compareMinY);for(var F=T;F<=D;F+=B){var O=Math.min(F+B-1,D);w.children.push(this._build(m,F,O,y-1))}}return s(w,this.toBBox),w},o.prototype._chooseSubtree=function(m,p,v,y){for(;y.push(p),!p.leaf&&y.length-1!==v;){for(var w=1/0,C=1/0,M=void 0,B=0;B<p.children.length;B++){var Y=p.children[B],T=h(Y),D=(F=m,O=Y,(Math.max(O.maxX,F.maxX)-Math.min(O.minX,F.minX))*(Math.max(O.maxY,F.maxY)-Math.min(O.minY,F.minY))-T);D<C?(C=D,w=T<w?T:w,M=Y):D===C&&T<w&&(w=T,M=Y)}p=M||p.children[0]}var F,O;return p},o.prototype._insert=function(m,p,v){var y=v?m:this.toBBox(m),w=[],C=this._chooseSubtree(y,this.data,p,w);for(C.children.push(m),u(C,y);p>=0&&w[p].children.length>this._maxEntries;)this._split(w,p),p--;this._adjustParentBBoxes(y,w,p)},o.prototype._split=function(m,p){var v=m[p],y=v.children.length,w=this._minEntries;this._chooseSplitAxis(v,w,y);var C=this._chooseSplitIndex(v,w,y),M=_(v.children.splice(C,v.children.length-C));M.height=v.height,M.leaf=v.leaf,s(v,this.toBBox),s(M,this.toBBox),p?m[p-1].children.push(M):this._splitRoot(v,M)},o.prototype._splitRoot=function(m,p){this.data=_([m,p]),this.data.height=m.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(m,p,v){for(var y,w,C,M,B,Y,T,D=1/0,F=1/0,O=p;O<=v-p;O++){var q=a(m,0,O,this.toBBox),U=a(m,O,v,this.toBBox),se=(w=q,C=U,M=void 0,B=void 0,Y=void 0,T=void 0,M=Math.max(w.minX,C.minX),B=Math.max(w.minY,C.minY),Y=Math.min(w.maxX,C.maxX),T=Math.min(w.maxY,C.maxY),Math.max(0,Y-M)*Math.max(0,T-B)),te=h(q)+h(U);se<D?(D=se,y=O,F=te<F?te:F):se===D&&te<F&&(F=te,y=O)}return y||v-p},o.prototype._chooseSplitAxis=function(m,p,v){var y=m.leaf?this.compareMinX:c,w=m.leaf?this.compareMinY:g;this._allDistMargin(m,p,v,y)<this._allDistMargin(m,p,v,w)&&m.children.sort(y)},o.prototype._allDistMargin=function(m,p,v,y){m.children.sort(y);for(var w=this.toBBox,C=a(m,0,p,w),M=a(m,v-p,v,w),B=f(C)+f(M),Y=p;Y<v-p;Y++){var T=m.children[Y];u(C,m.leaf?w(T):T),B+=f(C)}for(var D=v-p-1;D>=p;D--){var F=m.children[D];u(M,m.leaf?w(F):F),B+=f(M)}return B},o.prototype._adjustParentBBoxes=function(m,p,v){for(var y=v;y>=0;y--)u(p[y],m)},o.prototype._condense=function(m){for(var p=m.length-1,v=void 0;p>=0;p--)m[p].children.length===0?p>0?(v=m[p-1].children).splice(v.indexOf(m[p]),1):this.clear():s(m[p],this.toBBox)},o})})(Ma);const Pa=Zn(ls),La=Zn(ea);function an(n){var e=[1/0,1/0,-1/0,-1/0];return gt(n,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}an.default=an;const Ta=Object.freeze(Object.defineProperty({__proto__:null,default:an},Symbol.toStringTag,{value:"Module"})),xa=Zn(Ta);var We=zn,Yr=Pa,Xr=La,yt=xa.default,Aa=Xr.featureEach;Xr.coordEach;Yr.polygon;var gr=Yr.featureCollection;function Jr(n){var e=new We(n);return e.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:yt(t),We.prototype.insert.call(this,t)},e.load=function(t){var i=[];return Array.isArray(t)?t.forEach(function(r){if(r.type!=="Feature")throw new Error("invalid features");r.bbox=r.bbox?r.bbox:yt(r),i.push(r)}):Aa(t,function(r){if(r.type!=="Feature")throw new Error("invalid features");r.bbox=r.bbox?r.bbox:yt(r),i.push(r)}),We.prototype.load.call(this,i)},e.remove=function(t,i){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:yt(t),We.prototype.remove.call(this,t,i)},e.clear=function(){return We.prototype.clear.call(this)},e.search=function(t){var i=We.prototype.search.call(this,this.toBBox(t));return gr(i)},e.collides=function(t){return We.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=We.prototype.all.call(this);return gr(t)},e.toJSON=function(){return We.prototype.toJSON.call(this)},e.fromJSON=function(t){return We.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var i;if(t.bbox)i=t.bbox;else if(Array.isArray(t)&&t.length===4)i=t;else if(Array.isArray(t)&&t.length===6)i=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")i=yt(t);else if(t.type==="FeatureCollection")i=yt(t);else throw new Error("invalid geojson");return{minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]}},e}Ea.exports=Jr;Pt.default=Jr;function Ur(n,e){var t={},i=[];if(n.type==="LineString"&&(n=Ye(n)),e.type==="LineString"&&(e=Ye(e)),n.type==="Feature"&&e.type==="Feature"&&n.geometry!==null&&e.geometry!==null&&n.geometry.type==="LineString"&&e.geometry.type==="LineString"&&n.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var r=br(n,e);return r&&i.push(r),Ge(i)}var o=Pt();return o.load(Bn(e)),Mt(Bn(n),function(l){Mt(o.search(l),function(s){var a=br(l,s);if(a){var u=Ze(a).join(",");t[u]||(t[u]=!0,i.push(a))}})}),Ge(i)}function br(n,e){var t=Ze(n),i=Ze(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(i.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=t[0][0],o=t[0][1],l=t[1][0],s=t[1][1],a=i[0][0],u=i[0][1],c=i[1][0],g=i[1][1],h=(g-u)*(l-r)-(c-a)*(s-o),f=(c-a)*(o-u)-(g-u)*(r-a),d=(l-r)*(o-u)-(s-o)*(r-a);if(h===0)return f===0&&d===0,null;var b=f/h,_=d/h;if(b>=0&&b<=1&&_>=0&&_<=1){var x=r+b*(l-r),m=o+b*(s-o);return Me([x,m])}return null}function Bt(n,e,t){t===void 0&&(t={});var i=Me([1/0,1/0],{dist:1/0}),r=0;return bt(n,function(o){for(var l=Ze(o),s=0;s<l.length-1;s++){var a=Me(l[s]);a.properties.dist=ot(e,a,t);var u=Me(l[s+1]);u.properties.dist=ot(e,u,t);var c=ot(a,u,t),g=Math.max(a.properties.dist,u.properties.dist),h=Gr(a,u),f=pr(e,g,h+90,t),d=pr(e,g,h-90,t),b=Ur(Le([f.geometry.coordinates,d.geometry.coordinates]),Le([a.geometry.coordinates,u.geometry.coordinates])),_=null;b.features.length>0&&(_=b.features[0],_.properties.dist=ot(e,_,t),_.properties.location=r+ot(a,_,t)),a.properties.dist<i.properties.dist&&(i=a,i.properties.index=s,i.properties.location=r),u.properties.dist<i.properties.dist&&(i=u,i.properties.index=s+1,i.properties.location=r+c),_&&_.properties.dist<i.properties.dist&&(i=_,i.properties.index=s),r+=c}}),i}const wt="edit-polygon-mode";var Ke,ht,Dt,Dn,qt,qn;class Ca{constructor(e){dt(this,Ke);dt(this,Dt);dt(this,qt);Ce(this,"map");Ce(this,"active");Ce(this,"eventListeners");Ce(this,"points");Ce(this,"cursor");Ce(this,"hoverPolyon");Ce(this,"hoverPoint");Ce(this,"dragging");Ce(this,"dragFrom");this.map=e,this.active=!1,this.eventListeners=[],this.points=[],this.cursor=null,this.hoverPolyon=!1,this.hoverPoint=null,this.dragging=!1,this.dragFrom=null,e.on("mousemove",t=>{if(this.active&&!this.dragging)me(this,Dt,Dn).call(this,t);else if(this.active&&this.dragging){if(this.hoverPolyon){let i=this.dragFrom[0]-t.lngLat.lng,r=this.dragFrom[1]-t.lngLat.lat;for(let o of this.points)o[0]-=i,o[1]-=r}else this.points[this.hoverPoint]=t.lngLat.toArray();this.dragFrom=t.lngLat.toArray(),me(this,Ke,ht).call(this)}}),e.on("click",t=>{if(this.active&&this.cursor){let i=[];if(_r(this.points).forEach((r,o)=>{i.push([o+1,Bt(r,this.cursor).properties.dist])}),i.sort((r,o)=>r[1]-o[1]),i.length>0){let r=i[0][0];this.points.splice(r,0,this.cursor.geometry.coordinates),this.hoverPoint=r}else this.points.push(this.cursor.geometry.coordinates),this.hoverPoint=this.points.length-1;me(this,Ke,ht).call(this)}else this.active&&this.hoverPoint!=null&&(this.points.splice(this.hoverPoint,1),this.hoverPoint=null,me(this,Ke,ht).call(this),me(this,Dt,Dn).call(this,t))}),e.on("mousedown",t=>{this.active&&!this.dragging&&(this.hoverPolyon||this.hoverPoint!=null)&&(t.preventDefault(),this.cursor=null,this.dragging=!0,this.dragFrom=t.lngLat.toArray())}),e.on("mouseup",()=>{this.active&&this.dragging&&(this.dragging=!1,this.dragFrom=null)}),document.addEventListener("keypress",t=>{if(this.active&&t.key=="Enter"){t.preventDefault();let i=me(this,qt,qn).call(this);if(i)for(let r of this.eventListeners)r(i);this.stop()}}),Lt(e,wt,{type:"geojson",data:et()}),Be(e,{id:"edit-polygon-fill",source:wt,filter:Kn,...ti("red",["case",["boolean",["get","hover"],"false"],1,.5])}),Be(e,{id:"edit-polygon-lines",source:wt,filter:$n,...tn("black",8,.5)}),Be(e,{id:"edit-polygon-vertices",source:wt,filter:ei,...Xt(Re.hovering,bn,["case",["boolean",["get","hover"],"false"],1,.5])})}addEventListener(e){this.eventListeners.push(e)}tearDown(){this.map.removeLayer("edit-polygon-vertices"),this.map.removeLayer("edit-polygon-fill"),this.map.removeLayer("edit-polygon-lines"),this.map.removeSource(wt)}startNew(){this.active=!0}editExisting(e){this.active=!0,this.points=e.geometry.coordinates[0],this.points.pop(),me(this,Ke,ht).call(this)}stop(){this.points=[],this.cursor=null,this.active=!1,this.hoverPolyon=!1,this.hoverPoint=null,this.dragging=!1,this.dragFrom=null,me(this,Ke,ht).call(this)}}Ke=new WeakSet,ht=function(){let e=et();this.points.forEach((i,r)=>{let o=vr(i);o.properties.hover=this.hoverPoint==r,o.properties.idx=r,e.features.push(o)}),this.cursor&&e.features.push(this.cursor),e.features=e.features.concat(_r(this.points));let t=me(this,qt,qn).call(this);t&&(t.properties.hover=this.hoverPolyon,e.features.push(t)),this.map.getSource(wt).setData(e)},Dt=new WeakSet,Dn=function(e){this.cursor=null,this.hoverPolyon=!1,this.hoverPoint=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hoverPolyon=!0;break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hoverPoint=t.properties.idx;break}!this.hoverPolyon&&this.hoverPoint==null&&(this.cursor=vr(e.lngLat.toArray())),me(this,Ke,ht).call(this)},qt=new WeakSet,qn=function(){if(this.points.length<3)return null;let e={type:"Feature",geometry:{type:"Polygon",coordinates:[JSON.parse(JSON.stringify(this.points))]},properties:{}};return e.geometry.coordinates[0].push(e.geometry.coordinates[0][0]),e};function vr(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function _r(n){let e=[];for(let t=0;t<n.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[t],n[t+1]]}});return n.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[n.length-1],n[0]]}}),e}function yr(n){let e;return{c(){e=A("p"),e.textContent="Click an intervention to fill out its attributes"},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function Ra(n){let e,t=n[0]==kt&&yr();return{c(){t&&t.c(),e=tt()},m(i,r){t&&t.m(i,r),P(i,e,r)},p(i,[r]){i[0]==kt?t||(t=yr(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(i){t&&t.d(i),i&&L(e)}}}const kt="edit-attribute";function jr(){}function Oa(n,e,t){let i,r,o;ge(n,Qe,u=>t(4,i=u)),ge(n,ue,u=>t(5,r=u)),ge(n,hn,u=>t(6,o=u));let{mode:l}=e,{changeMode:s}=e;function a(){at(null)}return i.on("mousemove",u=>{if(l==kt&&o==null){let g=i.queryRenderedFeatures(u.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var c=null;g.length>0&&(c=g[0].id),Ue.set(c)}}),i.on("mouseout",()=>{l==kt&&o==null&&Ue.set(null)}),i.on("click",u=>{if(l==kt){let c=i.queryRenderedFeatures(u.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});c.length>0?at(c[0].id):at(null)}}),Ln.subscribe(u=>{if(u){let c=r.features.find(g=>g.id==u);c.geometry.type=="Point"?i.flyTo({center:c.geometry.coordinates}):i.fitBounds(Hn(c),{padding:200,animate:!0,duration:500}),s(kt)}}),n.$$set=u=>{"mode"in u&&t(0,l=u.mode),"changeMode"in u&&t(1,s=u.changeMode)},[l,s,jr,a]}class Na extends ie{constructor(e){super(),re(this,e,Oa,Ra,oe,{mode:0,changeMode:1,start:2,stop:3})}get start(){return jr}get stop(){return this.$$.ctx[3]}}function wr(n){let e;return{c(){e=A("p"),e.textContent="Click an intervention to edit its geometry"},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function Ia(n){let e,t=n[0]==it&&wr();return{c(){t&&t.c(),e=tt()},m(i,r){t&&t.m(i,r),P(i,e,r)},p(i,[r]){i[0]==it?t||(t=wr(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(i){t&&t.d(i),i&&L(e)}}}const it="edit-geometry";function Wr(){}function Fa(n,e,t){let i;ge(n,Qe,h=>t(8,i=h));let{mode:r}=e,{routeSnapper:o}=e,{snapTool:l}=e,{pointTool:s}=e,{polygonTool:a}=e;function u(){c&&(o.stop(),s.stop(),a.stop(),ue.update(h=>{let f=h.features.find(d=>d.id==c);return delete f.properties.hide_while_editing,h})),c=null,Ue.set(null)}let c=null;i.on("mousemove",h=>{if(r==it&&c==null){let d=i.queryRenderedFeatures(h.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var f=null;d.length>0&&(f=d[0].id),Ue.set(f)}}),i.on("mouseout",()=>{r==it&&c==null&&Ue.set(null)}),i.on("click",h=>{if(r==it&&c==null){let f=i.queryRenderedFeatures(h.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});f.length>0&&g(f[0].id)}}),l.addEventListener("new-route",h=>{if(r==it){const f=h.detail;ue.update(d=>{let b=d.features.find(_=>_.id==c);return b.properties.length_meters=f.properties.length_meters,b.properties.waypoints=f.properties.waypoints,delete b.properties.hide_while_editing,b.geometry=f.geometry,d}),c=null}}),l.addEventListener("no-new-route",()=>{r==it&&(ue.update(h=>{let f=h.features.find(d=>d.id==c);return delete f.properties.hide_while_editing,h}),c=null)});for(let h of[s,a])h.addEventListener(f=>{r==it&&(ue.update(d=>{let b=d.features.find(_=>_.id==c);return b.geometry=f.geometry,delete b.properties.hide_while_editing,d}),c=null)});function g(h){Ue.set(null);let f;ue.update(d=>(f=d.features.find(b=>b.id==h),f.properties.hide_while_editing=!0,d)),c=h,f.geometry.type=="LineString"?o.editExisting(f):f.geometry.type=="Polygon"?a.editExisting(f):f.geometry.type=="Point"&&s.start()}return n.$$set=h=>{"mode"in h&&t(0,r=h.mode),"routeSnapper"in h&&t(1,o=h.routeSnapper),"snapTool"in h&&t(2,l=h.snapTool),"pointTool"in h&&t(3,s=h.pointTool),"polygonTool"in h&&t(4,a=h.polygonTool)},[r,o,l,s,a,Wr,u]}class Ba extends ie{constructor(e){super(),re(this,e,Fa,Ia,oe,{mode:0,routeSnapper:1,snapTool:2,pointTool:3,polygonTool:4,start:5,stop:6})}get start(){return Wr}get stop(){return this.$$.ctx[6]}}let K;const Vr=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Vr.decode();let Qt=new Uint8Array;function Ot(){return Qt.byteLength===0&&(Qt=new Uint8Array(K.memory.buffer)),Qt}function St(n,e){return Vr.decode(Ot().subarray(n,n+e))}const $e=new Array(32).fill(void 0);$e.push(void 0,null,!0,!1);let Nt=$e.length;function ve(n){Nt===$e.length&&$e.push($e.length+1);const e=Nt;return Nt=$e[e],$e[e]=n,e}function ee(n){return $e[n]}function za(n){n<36||($e[n]=Nt,Nt=n)}function Gn(n){const e=ee(n);return za(n),e}function kn(n){return n==null}let Kt=new Float64Array;function Da(){return Kt.byteLength===0&&(Kt=new Float64Array(K.memory.buffer)),Kt}let $t=new Int32Array;function _e(){return $t.byteLength===0&&($t=new Int32Array(K.memory.buffer)),$t}let st=0;const en=new TextEncoder("utf-8"),qa=typeof en.encodeInto=="function"?function(n,e){return en.encodeInto(n,e)}:function(n,e){const t=en.encode(n);return e.set(t),{read:n.length,written:t.length}};function Vt(n,e,t){if(t===void 0){const s=en.encode(n),a=e(s.length);return Ot().subarray(a,a+s.length).set(s),st=s.length,a}let i=n.length,r=e(i);const o=Ot();let l=0;for(;l<i;l++){const s=n.charCodeAt(l);if(s>127)break;o[r+l]=s}if(l!==i){l!==0&&(n=n.slice(l)),r=t(r,i,i=l+n.length*3);const s=Ot().subarray(r+l,r+i),a=qa(n,s);l+=a.written}return st=l,r}function Yn(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const r=n.description;return r==null?"Symbol":`Symbol(${r})`}if(e=="function"){const r=n.name;return typeof r=="string"&&r.length>0?`Function(${r})`:"Function"}if(Array.isArray(n)){const r=n.length;let o="[";r>0&&(o+=Yn(n[0]));for(let l=1;l<r;l++)o+=", "+Yn(n[l]);return o+="]",o}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let i;if(t.length>1)i=t[1];else return toString.call(n);if(i=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:i}function Ga(n,e){const t=e(n.length*1);return Ot().set(n,t/1),st=n.length,t}function Sn(n,e){try{return n.apply(this,e)}catch(t){K.__wbindgen_exn_store(ve(t))}}class un{static __wrap(e){const t=Object.create(un.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();K.__wbg_jsroutesnapper_free(e)}constructor(e){try{const o=K.__wbindgen_add_to_stack_pointer(-16),l=Ga(e,K.__wbindgen_malloc),s=st;K.jsroutesnapper_new(o,l,s);var t=_e()[o/4+0],i=_e()[o/4+1],r=_e()[o/4+2];if(r)throw Gn(i);return un.__wrap(t)}finally{K.__wbindgen_add_to_stack_pointer(16)}}setConfig(e){K.jsroutesnapper_setConfig(this.ptr,ve(e))}toFinalFeature(){try{const i=K.__wbindgen_add_to_stack_pointer(-16);K.jsroutesnapper_toFinalFeature(i,this.ptr);var e=_e()[i/4+0],t=_e()[i/4+1];let r;return e!==0&&(r=St(e,t).slice(),K.__wbindgen_free(e,t*1)),r}finally{K.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){try{const i=K.__wbindgen_add_to_stack_pointer(-16);K.jsroutesnapper_renderGeojson(i,this.ptr);var e=_e()[i/4+0],t=_e()[i/4+1];return St(e,t)}finally{K.__wbindgen_add_to_stack_pointer(16),K.__wbindgen_free(e,t)}}setSnapMode(e){K.jsroutesnapper_setSnapMode(this.ptr,e)}onMouseMove(e,t,i){return K.jsroutesnapper_onMouseMove(this.ptr,e,t,i)!==0}onClick(){K.jsroutesnapper_onClick(this.ptr)}onDragStart(){return K.jsroutesnapper_onDragStart(this.ptr)!==0}onMouseUp(){return K.jsroutesnapper_onMouseUp(this.ptr)!==0}clearState(){K.jsroutesnapper_clearState(this.ptr)}editExisting(e){try{const r=K.__wbindgen_add_to_stack_pointer(-16);K.jsroutesnapper_editExisting(r,this.ptr,ve(e));var t=_e()[r/4+0],i=_e()[r/4+1];if(i)throw Gn(t)}finally{K.__wbindgen_add_to_stack_pointer(16)}}}async function Ya(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(i){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function Xa(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const i=St(e,t);return ve(i)},n.wbg.__wbindgen_object_drop_ref=function(e){Gn(e)},n.wbg.__wbindgen_boolean_get=function(e){const t=ee(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_error_new=function(e,t){const i=new Error(St(e,t));return ve(i)},n.wbg.__wbindgen_is_object=function(e){const t=ee(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return ee(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return ee(e)in ee(t)},n.wbg.__wbindgen_number_get=function(e,t){const i=ee(t),r=typeof i=="number"?i:void 0;Da()[e/8+1]=kn(r)?0:r,_e()[e/4+0]=!kn(r)},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return ee(e)==ee(t)},n.wbg.__wbindgen_string_get=function(e,t){const i=ee(t),r=typeof i=="string"?i:void 0;var o=kn(r)?0:Vt(r,K.__wbindgen_malloc,K.__wbindgen_realloc),l=st;_e()[e/4+1]=l,_e()[e/4+0]=o},n.wbg.__wbg_String_91fba7ded13ba54c=function(e,t){const i=String(ee(t)),r=Vt(i,K.__wbindgen_malloc,K.__wbindgen_realloc),o=st;_e()[e/4+1]=o,_e()[e/4+0]=r},n.wbg.__wbindgen_object_clone_ref=function(e){const t=ee(e);return ve(t)},n.wbg.__wbg_getwithrefkey_15c62c2b8546208d=function(e,t){const i=ee(e)[ee(t)];return ve(i)},n.wbg.__wbg_log_4b5638ad60bdc54a=function(e){console.log(ee(e))},n.wbg.__wbg_get_57245cc7d7c7619d=function(e,t){const i=ee(e)[t>>>0];return ve(i)},n.wbg.__wbg_length_6e3bbe7c8bd4dbd8=function(e){return ee(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof ee(e)=="function"},n.wbg.__wbg_next_579e583d33566a86=function(e){const t=ee(e).next;return ve(t)},n.wbg.__wbg_next_aaef7c8aa5e212ac=function(){return Sn(function(e){const t=ee(e).next();return ve(t)},arguments)},n.wbg.__wbg_done_1b73b0672e15f234=function(e){return ee(e).done},n.wbg.__wbg_value_1ccc36bc03462d71=function(e){const t=ee(e).value;return ve(t)},n.wbg.__wbg_iterator_6f9d4f28845f426c=function(){return ve(Symbol.iterator)},n.wbg.__wbg_get_765201544a2b6869=function(){return Sn(function(e,t){const i=Reflect.get(ee(e),ee(t));return ve(i)},arguments)},n.wbg.__wbg_call_97ae9d8645dc388b=function(){return Sn(function(e,t){const i=ee(e).call(ee(t));return ve(i)},arguments)},n.wbg.__wbg_isArray_27c46c67f498e15d=function(e){return Array.isArray(ee(e))},n.wbg.__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b=function(e){let t;try{t=ee(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_buffer_3f3d764d4747d564=function(e){const t=ee(e).buffer;return ve(t)},n.wbg.__wbg_new_8c3f0052272a457a=function(e){const t=new Uint8Array(ee(e));return ve(t)},n.wbg.__wbg_set_83db9690f9353e79=function(e,t,i){ee(e).set(ee(t),i>>>0)},n.wbg.__wbg_length_9e1ae1900cb0fbd5=function(e){return ee(e).length},n.wbg.__wbg_instanceof_Uint8Array_971eeda69eb75003=function(e){let t;try{t=ee(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return ve(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const i=ee(t).stack,r=Vt(i,K.__wbindgen_malloc,K.__wbindgen_realloc),o=st;_e()[e/4+1]=o,_e()[e/4+0]=r},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){try{console.error(St(e,t))}finally{K.__wbindgen_free(e,t)}},n.wbg.__wbindgen_debug_string=function(e,t){const i=Yn(ee(t)),r=Vt(i,K.__wbindgen_malloc,K.__wbindgen_realloc),o=st;_e()[e/4+1]=o,_e()[e/4+0]=r},n.wbg.__wbindgen_throw=function(e,t){throw new Error(St(e,t))},n.wbg.__wbindgen_memory=function(){const e=K.memory;return ve(e)},n}function Ja(n,e){return K=n.exports,Hr.__wbindgen_wasm_module=e,Kt=new Float64Array,$t=new Int32Array,Qt=new Uint8Array,K}async function Hr(n){typeof n>"u"&&(n="/atip/assets/route_snapper_bg.wasm");const e=Xa();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:i}=await Ya(await n,e);return Ja(t,i)}var Gt,Xn,He,nt;class Ua{constructor(e,t,i){dt(this,Gt);dt(this,He);this.controlDiv=i,this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new un(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),console.log("JsRouteSnapper ready, waiting for idle event"),this.active=!1,this.loaded=!1,this.map.once("idle",()=>{console.log("JsRouteSnapper now usable"),this.map.addSource("route-snapper",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"route-points",type:"circle",source:"route-snapper",paint:{"circle-radius":["match",["get","type"],"unimportant",10/2,10],"circle-color":["match",["get","type"],"hovered","green","important","red","black"]},filter:["in","$type","Point"]}),this.map.addLayer({id:"route-lines",type:"line",source:"route-snapper",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"black","line-width":2.5},filter:["in","$type","LineString"]}),this.loaded=!0,this.map.on("mousemove",l=>{if(!this.active)return;const s={x:l.point.x-30,y:l.point.y},a=this.map.unproject(l.point).distanceTo(this.map.unproject(s));this.inner.onMouseMove(l.lngLat.lng,l.lngLat.lat,a)&&me(this,He,nt).call(this)}),this.map.on("click",()=>{this.active&&(this.inner.onClick(),me(this,He,nt).call(this))}),this.map.on("dragstart",l=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()}),this.map.on("mouseup",l=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()}),document.addEventListener("keypress",l=>{this.active&&l.key=="Enter"&&(l.preventDefault(),me(this,Gt,Xn).call(this))}),document.addEventListener("keydown",l=>{this.active&&l.key=="Shift"&&(l.preventDefault(),this.inner.setSnapMode(!1),me(this,He,nt).call(this))}),document.addEventListener("keyup",l=>{this.active&&l.key=="Shift"&&(l.preventDefault(),this.inner.setSnapMode(!0),me(this,He,nt).call(this))}),this.stop()})}isActive(){return this.active}tearDown(){this.loaded&&(this.map.removeLayer("route-points"),this.map.removeLayer("route-lines"),this.map.removeSource("route-snapper"))}editExisting(e){if(!this.loaded){console.error("editExisting called before the map idle event received. Not starting tool.");return}e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.start(),this.inner.editExisting(e.properties.waypoints),me(this,He,nt).call(this)}stop(){if(!this.loaded)return;this.active=!1,this.inner.clearState(),me(this,He,nt).call(this),this.controlDiv.innerHTML="";let e=document.createElement("button");e.innerText="Route tool",e.type="button",e.onclick=()=>{this.controlDiv.dispatchEvent(new CustomEvent("activate")),this.start()},this.controlDiv.appendChild(e)}start(){if(this.active)return;this.active=!0;let e=document.createElement("button");e.type="button",e.innerText="Finish route",e.onclick=()=>{me(this,Gt,Xn).call(this)};let t=document.createElement("button");t.type="button",t.innerText="Cancel",t.onclick=()=>{this.controlDiv.dispatchEvent(new CustomEvent("no-new-route")),this.stop()},this.controlDiv.innerHTML="";let i=document.createElement("div");i.style="display: flex; justify-content: space-evenly;",i.appendChild(e),i.appendChild(t),this.controlDiv.appendChild(i);let r=document.createElement("input");r.type="checkbox",r.id="avoidDoublingBack",r.onclick=()=>{this.inner.setConfig({avoid_doubling_back:r.checked}),me(this,He,nt).call(this)};let o=document.createElement("label");o.innerText="Avoid doubling back",o.for=r.id;let l=document.createElement("div");l.appendChild(r),l.appendChild(o),this.controlDiv.append(l);const s=document.createElement("ul");s.innerHTML="<li><b>Click</b> green points on the transport network</br>to create snapped routes</li><li>Hold <b>Shift</b> to draw a point anywhere</li><li><b>Click and drag</b> any point to move it</li><li><b>Click</b> a red waypoint to delete it</li><li>Press <b>Enter</b> to finish route</li>",this.controlDiv.appendChild(s)}}Gt=new WeakSet,Xn=function(){const e=this.inner.toFinalFeature();e?this.controlDiv.dispatchEvent(new CustomEvent("new-route",{detail:JSON.parse(e)})):this.controlDiv.dispatchEvent(new CustomEvent("no-new-route")),this.stop()},He=new WeakSet,nt=function(){this.loaded&&this.map.getSource("route-snapper").setData(JSON.parse(this.inner.renderGeojson()))};async function ja(n,e){const t=await fetch(n),i=t.body.getReader(),r=t.headers.get("Content-Length");let o=0,l=[];for(;;){const{done:u,value:c}=await i.read();if(u)break;l.push(c),o+=c.length;const g=100*o/r;e.style=`background: linear-gradient(to right, red ${g}%, transparent 0);`}let s=new Uint8Array(o),a=0;for(let u of l)s.set(u,a),a+=u.length;return s}function Wa(n){let e,t;return{c(){e=A("div"),t=A("div"),t.textContent="Route tool loading..."},m(i,r){P(i,e,r),S(e,t),n[8](t),n[9](e)},p:ne,i:ne,o:ne,d(i){i&&L(e),n[8](null),n[9](null)}}}const En="route";function Va(n,e,t){let i;ge(n,Qe,d=>t(10,i=d));let{mode:r}=e,{changeMode:o}=e,{url:l}=e,{snapTool:s}=e,a,{routeSnapper:u}=e;function c(){u.isActive()||u.start()}function g(){u==null||u.stop()}Yt(async()=>{await Hr(),console.log(`Grabbing ${l}`);try{const d=await ja(l,a);t(2,u=new Ua(i,d,s))}catch(d){console.log(`Route tool broke: ${d}`),t(0,s.innerHTML="Failed to load",s)}s.addEventListener("activate",()=>{o(En)}),s.addEventListener("no-new-route",()=>{r==En&&o("edit-attribute")}),s.addEventListener("new-route",d=>{if(r==En){const b=d.detail;ue.update(_=>(b.id=mn(_),b.properties.intervention_type="route",_.features.push(b),_)),o("edit-attribute"),at(b.id)}})}),Vn(()=>{u==null||u.tearDown()});function h(d){he[d?"unshift":"push"](()=>{a=d,t(1,a)})}function f(d){he[d?"unshift":"push"](()=>{s=d,t(0,s)})}return n.$$set=d=>{"mode"in d&&t(3,r=d.mode),"changeMode"in d&&t(4,o=d.changeMode),"url"in d&&t(5,l=d.url),"snapTool"in d&&t(0,s=d.snapTool),"routeSnapper"in d&&t(2,u=d.routeSnapper)},[s,a,u,r,o,l,c,g,h,f]}class Ha extends ie{constructor(e){super(),re(this,e,Va,Wa,oe,{mode:3,changeMode:4,url:5,snapTool:0,routeSnapper:2,start:6,stop:7})}get start(){return this.$$.ctx[6]}get stop(){return this.$$.ctx[7]}}function kr(n){let e;return{c(){e=A("p"),e.textContent="Click to add a new point"},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function Za(n){let e,t=n[0]==Jn&&kr();return{c(){t&&t.c(),e=tt()},m(i,r){t&&t.m(i,r),P(i,e,r)},p(i,[r]){i[0]==Jn?t||(t=kr(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(i){t&&t.d(i),i&&L(e)}}}const Jn="point";function Qa(n,e,t){let{mode:i}=e,{changeMode:r}=e,{pointTool:o}=e;function l(){o.start()}function s(){o.stop()}return o.addEventListener(a=>{i==Jn&&(ue.update(u=>(a.id=mn(u),a.properties.intervention_type="other",u.features.push(a),u)),r("edit-attribute"),at(a.id))}),n.$$set=a=>{"mode"in a&&t(0,i=a.mode),"changeMode"in a&&t(1,r=a.changeMode),"pointTool"in a&&t(2,o=a.pointTool)},[i,r,o,l,s]}class Ka extends ie{constructor(e){super(),re(this,e,Qa,Za,oe,{mode:0,changeMode:1,pointTool:2,start:3,stop:4})}get start(){return this.$$.ctx[3]}get stop(){return this.$$.ctx[4]}}function Sr(n){let e;return{c(){e=A("p"),e.innerHTML="Click the map to add a vertex, or click a vertex to delete it. Press <strong>Enter</strong> to finish. Drag a vertex or the polygon to move."},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function $a(n){let e,t=n[0]==Un&&Sr();return{c(){t&&t.c(),e=tt()},m(i,r){t&&t.m(i,r),P(i,e,r)},p(i,[r]){i[0]==Un?t||(t=Sr(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(i){t&&t.d(i),i&&L(e)}}}const Un="polygon";function eu(n,e,t){let{mode:i}=e,{changeMode:r}=e,{polygonTool:o}=e;function l(){o.startNew()}function s(){o.stop()}return o.addEventListener(a=>{i==Un&&(ue.update(u=>(a.id=mn(u),a.properties.intervention_type="area",u.features.push(a),u)),r("edit-attribute"),at(a.id))}),n.$$set=a=>{"mode"in a&&t(0,i=a.mode),"changeMode"in a&&t(1,r=a.changeMode),"polygonTool"in a&&t(2,o=a.polygonTool)},[i,r,o,l,s]}class tu extends ie{constructor(e){super(),re(this,e,eu,$a,oe,{mode:0,changeMode:1,polygonTool:2,start:3,stop:4})}get start(){return this.$$.ctx[3]}get stop(){return this.$$.ctx[4]}}function nu(n){var e=n[0],t=n[1],i=n[2],r=n[3],o=ot(n.slice(0,2),[i,t]),l=ot(n.slice(0,2),[e,r]);if(o>=l){var s=(t+r)/2;return[e,s-(i-e)/2,i,s+(i-e)/2]}else{var a=(e+i)/2;return[a-(r-t)/2,t,a+(r-t)/2,r]}}function iu(n,e){e===void 0&&(e={});var t=e.precision,i=e.coordinates,r=e.mutate;if(t=t==null||isNaN(t)?6:t,i=i==null||isNaN(i)?3:i,!n)throw new Error("<geojson> is required");if(typeof t!="number")throw new Error("<precision> must be a number");if(typeof i!="number")throw new Error("<coordinates> must be a number");(r===!1||r===void 0)&&(n=JSON.parse(JSON.stringify(n)));var o=Math.pow(10,t);return gt(n,function(l){ru(l,o,i)}),n}function ru(n,e,t){n.length>t&&n.splice(t,n.length);for(var i=0;i<n.length;i++)n[i]=Math.round(n[i]*e)/e;return n}function ou(n,e){if(!n)throw new Error("line is required");if(!e)throw new Error("splitter is required");var t=In(n),i=In(e);if(t!=="LineString")throw new Error("line must be LineString");if(i==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(i==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var r=iu(e,{precision:7});switch(i){case"Point":return jn(n,r);case"MultiPoint":return Er(n,r);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Er(n,Ur(n,r))}}function Er(n,e){var t=[],i=Pt();return bt(e,function(r){if(t.forEach(function(s,a){s.id=a}),!t.length)t=jn(n,r).features,t.forEach(function(s){s.bbox||(s.bbox=nu(an(s)))}),i.load(Ge(t));else{var o=i.search(r);if(o.features.length){var l=Zr(r,o);t=t.filter(function(s){return s.id!==l.id}),i.remove(l),Mt(jn(l,r),function(s){t.push(s),i.insert(s)})}}}),Ge(t)}function jn(n,e){var t=[],i=Ze(n)[0],r=Ze(n)[n.geometry.coordinates.length-1];if(Mn(i,ut(e))||Mn(r,ut(e)))return Ge([n]);var o=Pt(),l=Bn(n);o.load(l);var s=o.search(e);if(!s.features.length)return Ge([n]);var a=Zr(e,s),u=[i],c=Br(l,function(g,h,f){var d=Ze(h)[1],b=ut(e);return f===a.id?(g.push(b),t.push(Le(g)),Mn(b,d)?[b]:[b,d]):(g.push(d),g)},u);return c.length>1&&t.push(Le(c)),Ge(t)}function Zr(n,e){if(!e.features.length)throw new Error("lines must contain features");if(e.features.length===1)return e.features[0];var t,i=1/0;return Mt(e,function(r){var o=Bt(r,n),l=o.properties.dist;l<i&&(t=r,i=l)}),t}function Mn(n,e){return n[0]===e[0]&&n[1]===e[1]}function lu(n,e,t){var i=Ze(t);if(In(t)!=="LineString")throw new Error("line must be a LineString");var r=Bt(t,n),o=Bt(t,e),l;r.properties.index<=o.properties.index?l=[r,o]:l=[o,r];for(var s=[l[0].geometry.coordinates],a=l[0].properties.index+1;a<l[1].properties.index+1;a++)s.push(i[a]);return s.push(l[1].geometry.coordinates),Le(s,t.properties)}function Mr(n){let e;return{c(){e=A("p"),e.textContent="Click near a route to split it, or click on the map to cancel"},m(t,i){P(t,e,i)},d(t){t&&L(e)}}}function su(n){let e,t=n[0]==fn&&Mr();return{c(){t&&t.c(),e=tt()},m(i,r){t&&t.m(i,r),P(i,e,r)},p(i,[r]){i[0]==fn?t||(t=Mr(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(i){t&&t.d(i),i&&L(e)}}}const fn="split-route",au=10,uu=30;let Pn="split-route";function Qr(){}function Pr(n,e){return{type:"Feature",properties:{snapped:e},geometry:{type:"Point",coordinates:n}}}function fu(n,e,t){let i,r;ge(n,Qe,h=>t(5,i=h)),ge(n,ue,h=>t(7,r=h));let{mode:o}=e,{changeMode:l}=e;function s(){t(4,a=null),u=null}let a=null,u=null;i.on("mousemove",h=>{if(o!=fn)return;t(4,a=Pr(h.lngLat.toArray(),!1)),u=null;const f=[h.point.x-uu,h.point.y],d=i.unproject(h.point).distanceTo(i.unproject(f))/1e3;let b=[];for(let[_,x]of r.features.entries())if(x.geometry.type=="LineString"){let m=Bt(x.geometry,a,{units:"kilometers"});m.properties.dist<=d&&b.push([_,m.geometry.coordinates,m.properties.dist])}b.sort((_,x)=>_[2]-x[2]),b.length>0&&(t(4,a=Pr(b[0][1],!0)),u=b[0][0])}),i.on("click",()=>{if(o==fn)if(u==null)l("edit-attribute");else{let h=ou(r.features[u],a);if(h.features.length==2){let f=h.features[0],d=h.features[1];ue.update(b=>(f.id=b.features[u].id,d.id=mn(b),f.properties=JSON.parse(JSON.stringify(b.features[u].properties)),d.properties=JSON.parse(JSON.stringify(f.properties)),c(b.features[u],f,d,a),b.features.splice(u,1,f,d),b))}s()}}),Lt(i,Pn,{type:"geojson",data:et()}),Be(i,{id:"draw-split-route",source:Pn,...Xt("black",au,["case",["==",["get","snapped"],!0],1,.5])});function c(h,f,d,b){f.properties.length_meters=Zt(f,{units:"kilometers"})*1e3,d.properties.length_meters=Zt(d,{units:"kilometers"})*1e3,f.properties.waypoints=[],d.properties.waypoints=[];let _=g(h,b),x=!0,m=0;for(let p of h.properties.waypoints){let v=g(h,Me([p.lon,p.lat]));if(x)if(v<_)f.properties.waypoints.push(p);else{let y=p.snapped&&h.properties.waypoints[m-1].snapped;f.properties.waypoints.push({lon:b.geometry.coordinates[0],lat:b.geometry.coordinates[1],snapped:y}),x=!1,d.properties.waypoints.push({lon:b.geometry.coordinates[0],lat:b.geometry.coordinates[1],snapped:y}),d.properties.waypoints.push(p)}else d.properties.waypoints.push(p);m++}}function g(h,f){let d=h.geometry.coordinates[0],b=lu(d,f,h);return Zt(b,{units:"kilometers"})*1e3}return n.$$set=h=>{"mode"in h&&t(0,o=h.mode),"changeMode"in h&&t(1,l=h.changeMode)},n.$$.update=()=>{if(n.$$.dirty&48){let h=et();a&&h.features.push(a),i.getSource(Pn).setData(h)}},[o,l,Qr,s,a,i]}class cu extends ie{constructor(e){super(),re(this,e,fu,su,oe,{mode:0,changeMode:1,start:2,stop:3})}get start(){return Qr}get stop(){return this.$$.ctx[3]}}function Lr(n){let e,t,i={mode:n[3],routeSnapper:n[1],snapTool:n[2],pointTool:n[10],polygonTool:n[11]};return e=new Ba({props:i}),n[16](e),{c(){j(e.$$.fragment)},m(r,o){W(e,r,o),t=!0},p(r,o){const l={};o&8&&(l.mode=r[3]),o&2&&(l.routeSnapper=r[1]),o&4&&(l.snapTool=r[2]),e.$set(l)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){z(e.$$.fragment,r),t=!1},d(r){n[16](null),V(e,r)}}}function du(n){let e,t,i,r,o,l,s,a,u,c,g,h,f,d,b,_,x,m,p,v,y,w,C,M,B,Y,T,D,F,O,q,U,se,te,le,fe,ae,E,Z,Je,Tt,Jt,vn={mode:n[3],changeMode:n[12]};s=new Na({props:vn}),n[14](s);let pe=n[1]&&n[2]&&Lr(n),X={mode:n[3],changeMode:n[12],pointTool:n[10]};v=new Ka({props:X}),n[18](v);let Kr={mode:n[3],changeMode:n[12],polygonTool:n[11]};T=new tu({props:Kr}),n[20](T);function $r($){n[22]($)}function eo($){n[23]($)}let _n={mode:n[3],changeMode:n[12],url:n[0]};n[1]!==void 0&&(_n.routeSnapper=n[1]),n[2]!==void 0&&(_n.snapTool=n[2]),O=new Ha({props:_n}),n[21](O),he.push(()=>De(O,"routeSnapper",$r,n[1])),he.push(()=>De(O,"snapTool",eo,n[2]));let to={mode:n[3],changeMode:n[12]};return Z=new cu({props:to}),n[25](Z),{c(){e=A("div"),t=A("div"),i=A("button"),r=H("Edit attributes"),l=N(),j(s.$$.fragment),a=N(),u=A("div"),c=A("button"),g=H("Edit geometry"),f=N(),pe&&pe.c(),d=N(),b=A("div"),_=A("button"),x=H("New point"),p=N(),j(v.$$.fragment),y=N(),w=A("div"),C=A("button"),M=H("New polygon"),Y=N(),j(T.$$.fragment),D=N(),F=A("div"),j(O.$$.fragment),se=N(),te=A("div"),le=A("button"),fe=H("Split route"),E=N(),j(Z.$$.fragment),I(i,"type","button"),i.disabled=o=n[3]=="edit-attribute",I(i,"class","svelte-cej5os"),I(c,"type","button"),c.disabled=h=n[3]=="edit-geometry",I(c,"class","svelte-cej5os"),I(_,"type","button"),_.disabled=m=n[3]=="point",I(_,"class","svelte-cej5os"),I(C,"type","button"),C.disabled=B=n[3]=="polygon",I(C,"class","svelte-cej5os"),I(le,"type","button"),le.disabled=ae=n[3]=="split-route",I(le,"class","svelte-cej5os"),I(e,"class","toolbox svelte-cej5os")},m($,ye){P($,e,ye),S(e,t),S(t,i),S(i,r),S(t,l),W(s,t,null),S(e,a),S(e,u),S(u,c),S(c,g),S(u,f),pe&&pe.m(u,null),S(e,d),S(e,b),S(b,_),S(_,x),S(b,p),W(v,b,null),S(e,y),S(e,w),S(w,C),S(C,M),S(w,Y),W(T,w,null),S(e,D),S(e,F),W(O,F,null),S(e,se),S(e,te),S(te,le),S(le,fe),S(te,E),W(Z,te,null),Je=!0,Tt||(Jt=[G(i,"click",n[13]),G(c,"click",n[15]),G(_,"click",n[17]),G(C,"click",n[19]),G(le,"click",n[24])],Tt=!0)},p($,[ye]){(!Je||ye&8&&o!==(o=$[3]=="edit-attribute"))&&(i.disabled=o);const ai={};ye&8&&(ai.mode=$[3]),s.$set(ai),(!Je||ye&8&&h!==(h=$[3]=="edit-geometry"))&&(c.disabled=h),$[1]&&$[2]?pe?(pe.p($,ye),ye&6&&R(pe,1)):(pe=Lr($),pe.c(),R(pe,1),pe.m(u,null)):pe&&(Se(),z(pe,1,1,()=>{pe=null}),Ee()),(!Je||ye&8&&m!==(m=$[3]=="point"))&&(_.disabled=m);const ui={};ye&8&&(ui.mode=$[3]),v.$set(ui),(!Je||ye&8&&B!==(B=$[3]=="polygon"))&&(C.disabled=B);const fi={};ye&8&&(fi.mode=$[3]),T.$set(fi);const xt={};ye&8&&(xt.mode=$[3]),ye&1&&(xt.url=$[0]),!q&&ye&2&&(q=!0,xt.routeSnapper=$[1],qe(()=>q=!1)),!U&&ye&4&&(U=!0,xt.snapTool=$[2],qe(()=>U=!1)),O.$set(xt),(!Je||ye&8&&ae!==(ae=$[3]=="split-route"))&&(le.disabled=ae);const ci={};ye&8&&(ci.mode=$[3]),Z.$set(ci)},i($){Je||(R(s.$$.fragment,$),R(pe),R(v.$$.fragment,$),R(T.$$.fragment,$),R(O.$$.fragment,$),R(Z.$$.fragment,$),Je=!0)},o($){z(s.$$.fragment,$),z(pe),z(v.$$.fragment,$),z(T.$$.fragment,$),z(O.$$.fragment,$),z(Z.$$.fragment,$),Je=!1},d($){$&&L(e),n[14](null),V(s),pe&&pe.d(),n[18](null),V(v),n[20](null),V(T),n[21](null),V(O),n[25](null),V(Z),Tt=!1,Ae(Jt)}}}function hu(n,e,t){let i;ge(n,Qe,O=>t(26,i=O));let{routeUrl:r}=e,o,l,s=new va(i),a=new Ca(i),u="edit-attribute",c,g,h,f,d,b;function _(O){let q={"edit-attribute":c,"edit-geometry":g,route:h,point:f,polygon:d,"split-route":b};if(u==O){console.log(`Mode is already ${u}, not changing`);return}console.log(`Stopping old mode ${u}`),q[u].stop(),t(3,u=O),console.log(`Starting new mode ${u}`),q[u].start()}Vn(()=>{s==null||s.tearDown(),a==null||a.tearDown()});const x=()=>_("edit-attribute");function m(O){he[O?"unshift":"push"](()=>{c=O,t(4,c)})}const p=()=>_("edit-geometry");function v(O){he[O?"unshift":"push"](()=>{g=O,t(5,g)})}const y=()=>_("point");function w(O){he[O?"unshift":"push"](()=>{f=O,t(7,f)})}const C=()=>_("polygon");function M(O){he[O?"unshift":"push"](()=>{d=O,t(8,d)})}function B(O){he[O?"unshift":"push"](()=>{h=O,t(6,h)})}function Y(O){o=O,t(1,o)}function T(O){l=O,t(2,l)}const D=()=>_("split-route");function F(O){he[O?"unshift":"push"](()=>{b=O,t(9,b)})}return n.$$set=O=>{"routeUrl"in O&&t(0,r=O.routeUrl)},[r,o,l,u,c,g,h,f,d,b,s,a,_,x,m,p,v,y,w,C,M,B,Y,T,D,F]}class mu extends ie{constructor(e){super(),re(this,e,hu,du,oe,{routeUrl:0})}}function pu(n){let e,t,i,r,o,l,s,a;return{c(){e=A("div"),t=A("button"),t.textContent="Home",i=N(),r=A("button"),r.textContent="About",o=N(),l=A("button"),l.textContent="Instructions",I(t,"type","button"),I(r,"type","button"),I(l,"type","button"),I(e,"slot","nav")},m(u,c){P(u,e,c),S(e,t),S(e,i),S(e,r),S(e,o),S(e,l),s||(a=[G(t,"click",n[8]),G(r,"click",n[6]),G(l,"click",n[7])],s=!0)},p:ne,d(u){u&&L(e),s=!1,Ae(a)}}}function gu(n){let e,t,i,r,o,l,s,a,u,c,g,h;return o=new aa({props:{boundaryGeojson:n[3]}}),s=new ra({props:{authorityName:n[4]}}),g=new Us({}),{c(){e=A("div"),t=A("h1"),i=H(n[4]),r=N(),j(o.$$.fragment),l=N(),j(s.$$.fragment),a=N(),u=A("br"),c=N(),j(g.$$.fragment),I(e,"slot","sidebar")},m(f,d){P(f,e,d),S(e,t),S(t,i),S(t,r),W(o,t,null),S(e,l),W(s,e,null),S(e,a),S(e,u),S(e,c),W(g,e,null),h=!0},p(f,d){const b={};d&8&&(b.boundaryGeojson=f[3]),o.$set(b)},i(f){h||(R(o.$$.fragment,f),R(s.$$.fragment,f),R(g.$$.fragment,f),h=!0)},o(f){z(o.$$.fragment,f),z(s.$$.fragment,f),z(g.$$.fragment,f),h=!1},d(f){f&&L(e),V(o),V(s),V(g)}}}function bu(n){let e,t,i,r,o,l,s,a,u,c,g,h;return e=new Os({props:{boundaryGeojson:n[3]}}),i=new pa({}),o=new ba({}),s=new mu({props:{routeUrl:n[2]}}),u=new ca({props:{style:n[5]}}),g=new ha({}),{c(){j(e.$$.fragment),t=N(),j(i.$$.fragment),r=N(),j(o.$$.fragment),l=N(),j(s.$$.fragment),a=N(),j(u.$$.fragment),c=N(),j(g.$$.fragment)},m(f,d){W(e,f,d),P(f,t,d),W(i,f,d),P(f,r,d),W(o,f,d),P(f,l,d),W(s,f,d),P(f,a,d),W(u,f,d),P(f,c,d),W(g,f,d),h=!0},p(f,d){const b={};d&8&&(b.boundaryGeojson=f[3]),e.$set(b);const _={};d&4&&(_.routeUrl=f[2]),s.$set(_)},i(f){h||(R(e.$$.fragment,f),R(i.$$.fragment,f),R(o.$$.fragment,f),R(s.$$.fragment,f),R(u.$$.fragment,f),R(g.$$.fragment,f),h=!0)},o(f){z(e.$$.fragment,f),z(i.$$.fragment,f),z(o.$$.fragment,f),z(s.$$.fragment,f),z(u.$$.fragment,f),z(g.$$.fragment,f),h=!1},d(f){V(e,f),f&&L(t),V(i,f),f&&L(r),V(o,f),f&&L(l),V(s,f),f&&L(a),V(u,f),f&&L(c),V(g,f)}}}function vu(n){let e,t,i;return t=new ql({props:{style:n[5],$$slots:{default:[bu]},$$scope:{ctx:n}}}),{c(){e=A("div"),j(t.$$.fragment),I(e,"slot","main")},m(r,o){P(r,e,o),W(t,e,null),i=!0},p(r,o){const l={};o&16396&&(l.$$scope={dirty:o,ctx:r}),t.$set(l)},i(r){i||(R(t.$$.fragment,r),i=!0)},o(r){z(t.$$.fragment,r),i=!1},d(r){r&&L(e),V(t)}}}function _u(n){let e,t,i,r,o,l,s,a;e=new jl({props:{$$slots:{main:[vu],sidebar:[gu],nav:[pu]},$$scope:{ctx:n}}});function u(f){n[9](f)}let c={};n[0]!==void 0&&(c.open=n[0]),i=new go({props:c}),he.push(()=>De(i,"open",u,n[0]));function g(f){n[10](f)}let h={};return n[1]!==void 0&&(h.open=n[1]),l=new Fl({props:h}),he.push(()=>De(l,"open",g,n[1])),{c(){j(e.$$.fragment),t=N(),j(i.$$.fragment),o=N(),j(l.$$.fragment)},m(f,d){W(e,f,d),P(f,t,d),W(i,f,d),P(f,o,d),W(l,f,d),a=!0},p(f,[d]){const b={};d&16396&&(b.$$scope={dirty:d,ctx:f}),e.$set(b);const _={};!r&&d&1&&(r=!0,_.open=f[0],qe(()=>r=!1)),i.$set(_);const x={};!s&&d&2&&(s=!0,x.open=f[1],qe(()=>s=!1)),l.$set(x)},i(f){a||(R(e.$$.fragment,f),R(i.$$.fragment,f),R(l.$$.fragment,f),a=!0)},o(f){z(e.$$.fragment,f),z(i.$$.fragment,f),z(l.$$.fragment,f),a=!1},d(f){V(e,f),f&&L(t),V(i,f),f&&L(o),V(l,f)}}}function yu(n,e,t){let i=!1,r=!1,o=window.location.hostname.includes("atip.uk");const l=new URLSearchParams(window.location.search);let s=l.get("authority"),a=l.get("style")||"streets";var u=`https://atip.uk/route-snappers/${s}.bin`;o||(u=`https://atip.uk/route-snappers-dev/${s}.bin`);function c(){t(0,i=!i),t(1,r=!1)}function g(){t(1,r=!r),t(0,i=!1)}let h;Yt(async()=>{t(3,h=await f())});async function f(){const m=await(await fetch(bo)).text(),p=JSON.parse(m);return p.features=p.features.filter(v=>v.properties.name==s),p}const d=()=>window.open("index.html");function b(x){i=x,t(0,i)}function _(x){r=x,t(1,r)}return[i,r,u,h,s,a,c,g,d,b,_]}class wu extends ie{constructor(e){super(),re(this,e,yu,_u,oe,{})}}new wu({target:document.getElementById("app")});
