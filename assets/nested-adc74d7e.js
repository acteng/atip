var Vi=Object.defineProperty;var Zi=(n,e,t)=>e in n?Vi(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ee=(n,e,t)=>(Zi(n,typeof e!="symbol"?e+"":e,t),t),Qi=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var dt=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var he=(n,e,t)=>(Qi(n,e,"access private method"),t);import{S as oe,i as le,s as se,x as fe,y as Le,f as A,z as kt,g as M,h as S,B as ut,C as ne,p as P,D as ye,E as Xe,t as j,F as pe,e as T,c as z,G as L,H as Ve,l as X,n as I,I as Me,o as D,J as Pe,r as Je,K as un,L as Jn,M as ft,N as ce,O as Re,P as Ae,Q as Oe,R as Ne,T as ie,b as ue,U as yi,V as wi,W as fn,X as ar,Y as Ki,j as St,d as H,m as V,q as Z,Z as $i,a as De,k as Ye,_ as Xt,$ as vn,a0 as Un,a1 as ur,w as jn,a2 as Ct,a3 as ct,a4 as ki,a5 as fr,a6 as eo,a7 as to,a8 as no,a9 as cr,aa as ro,ab as io,ac as Wn,A as oo,u as lo}from"./authorities-8d7d3573.js";function dr(n){let e,t;return{c(){e=Le("title"),t=j(n[1])},m(r,i){M(r,e,i),S(e,t)},p(r,i){i&2&&pe(t,r[1])},d(r){r&&P(e)}}}function so(n){let e,t,r,i=n[1]&&dr(n),o=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],l={};for(let s=0;s<o.length;s+=1)l=fe(l,o[s]);return{c(){e=Le("svg"),i&&i.c(),t=Le("path"),r=Le("path"),A(t,"d","M16,2C8.3,2,2,8.3,2,16s6.3,14,14,14s14-6.3,14-14C30,8.3,23.7,2,16,2z M14.9,8h2.2v11h-2.2V8z M16,25	c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22c0.8,0,1.5,0.7,1.5,1.5S16.8,25,16,25z"),A(r,"fill","none"),A(r,"d","M17.5,23.5c0,0.8-0.7,1.5-1.5,1.5c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22	C16.8,22,17.5,22.7,17.5,23.5z M17.1,8h-2.2v11h2.2V8z"),A(r,"data-icon-path","inner-path"),A(r,"opacity","0"),kt(e,l)},m(s,u){M(s,e,u),i&&i.m(e,null),S(e,t),S(e,r)},p(s,[u]){s[1]?i?i.p(s,u):(i=dr(s),i.c(),i.m(e,t)):i&&(i.d(1),i=null),kt(e,l=ut(o,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},u&1&&{width:s[0]},u&1&&{height:s[0]},u&4&&s[2],u&8&&s[3]]))},i:ne,o:ne,d(s){s&&P(e),i&&i.d()}}}function ao(n,e,t){let r,i;const o=["size","title"];let l=ye(e,o),{size:s=16}=e,{title:u=void 0}=e;return n.$$set=a=>{t(5,e=fe(fe({},e),Xe(a))),t(3,l=ye(e,o)),"size"in a&&t(0,s=a.size),"title"in a&&t(1,u=a.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||u),t(2,i={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Xe(e),[s,u,i,l,r]}class uo extends oe{constructor(e){super(),le(this,e,ao,so,se,{size:0,title:1})}}const Si=uo;function hr(n){let e,t;return{c(){e=Le("title"),t=j(n[1])},m(r,i){M(r,e,i),S(e,t)},p(r,i){i&2&&pe(t,r[1])},d(r){r&&P(e)}}}function fo(n){let e,t,r,i,o=n[1]&&hr(n),l=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],s={};for(let u=0;u<l.length;u+=1)s=fe(s,l[u]);return{c(){e=Le("svg"),o&&o.c(),t=Le("path"),r=Le("path"),i=Le("path"),A(t,"fill","none"),A(t,"d","M16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Zm-1.125-5h2.25V12h-2.25Z"),A(t,"data-icon-path","inner-path"),A(r,"d","M16.002,6.1714h-.004L4.6487,27.9966,4.6506,28H27.3494l.0019-.0034ZM14.875,12h2.25v9h-2.25ZM16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Z"),A(i,"d","M29,30H3a1,1,0,0,1-.8872-1.4614l13-25a1,1,0,0,1,1.7744,0l13,25A1,1,0,0,1,29,30ZM4.6507,28H27.3493l.002-.0033L16.002,6.1714h-.004L4.6487,27.9967Z"),kt(e,s)},m(u,a){M(u,e,a),o&&o.m(e,null),S(e,t),S(e,r),S(e,i)},p(u,[a]){u[1]?o?o.p(u,a):(o=hr(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null),kt(e,s=ut(l,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},a&1&&{width:u[0]},a&1&&{height:u[0]},a&4&&u[2],a&8&&u[3]]))},i:ne,o:ne,d(u){u&&P(e),o&&o.d()}}}function co(n,e,t){let r,i;const o=["size","title"];let l=ye(e,o),{size:s=16}=e,{title:u=void 0}=e;return n.$$set=a=>{t(5,e=fe(fe({},e),Xe(a))),t(3,l=ye(e,o)),"size"in a&&t(0,s=a.size),"title"in a&&t(1,u=a.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||u),t(2,i={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Xe(e),[s,u,i,l,r]}class ho extends oe{constructor(e){super(),le(this,e,co,fo,se,{size:0,title:1})}}const po=ho,mo=n=>({}),pr=n=>({});function mr(n){let e,t;const r=n[16].labelText,i=Re(r,n,n[15],pr),o=i||go(n);return{c(){e=T("span"),o&&o.c(),L(e,"bx--visually-hidden",n[7])},m(l,s){M(l,e,s),o&&o.m(e,null),t=!0},p(l,s){i?i.p&&(!t||s&32768)&&Ae(i,r,l,l[15],t?Ne(r,l[15],s,mo):Oe(l[15]),pr):o&&o.p&&(!t||s&64)&&o.p(l,t?s:-1),(!t||s&128)&&L(e,"bx--visually-hidden",l[7])},i(l){t||(I(o,l),t=!0)},o(l){D(o,l),t=!1},d(l){l&&P(e),o&&o.d(l)}}}function go(n){let e;return{c(){e=j(n[6])},m(t,r){M(t,e,r)},p(t,r){r&64&&pe(e,t[6])},d(t){t&&P(e)}}}function vo(n){let e,t,r,i,o,l,s,u,a,c=(n[6]||n[13].labelText)&&mr(n),g=[n[12]],d={};for(let f=0;f<g.length;f+=1)d=fe(d,g[f]);return{c(){e=T("div"),t=T("input"),r=z(),i=T("label"),o=T("span"),l=z(),c&&c.c(),A(t,"type","radio"),A(t,"id",n[8]),A(t,"name",n[9]),t.checked=n[0],t.disabled=n[3],t.required=n[4],t.value=n[2],L(t,"bx--radio-button",!0),L(o,"bx--radio-button__appearance",!0),A(i,"for",n[8]),L(i,"bx--radio-button__label",!0),Ve(e,d),L(e,"bx--radio-button-wrapper",!0),L(e,"bx--radio-button-wrapper--label-left",n[5]==="left")},m(f,m){M(f,e,m),S(e,t),n[18](t),S(e,r),S(e,i),S(i,o),S(i,l),c&&c.m(i,null),s=!0,u||(a=[X(t,"change",n[17]),X(t,"change",n[19])],u=!0)},p(f,[m]){(!s||m&256)&&A(t,"id",f[8]),(!s||m&512)&&A(t,"name",f[9]),(!s||m&1)&&(t.checked=f[0]),(!s||m&8)&&(t.disabled=f[3]),(!s||m&16)&&(t.required=f[4]),(!s||m&4)&&(t.value=f[2]),f[6]||f[13].labelText?c?(c.p(f,m),m&8256&&I(c,1)):(c=mr(f),c.c(),I(c,1),c.m(i,null)):c&&(Me(),D(c,1,1,()=>{c=null}),Pe()),(!s||m&256)&&A(i,"for",f[8]),Ve(e,d=ut(g,[m&4096&&f[12]])),L(e,"bx--radio-button-wrapper",!0),L(e,"bx--radio-button-wrapper--label-left",f[5]==="left")},i(f){s||(I(c),s=!0)},o(f){D(c),s=!1},d(f){f&&P(e),n[18](null),c&&c.d(),u=!1,Je(a)}}}function bo(n,e,t){const r=["value","checked","disabled","required","labelPosition","labelText","hideLabel","id","name","ref"];let i=ye(e,r),o,{$$slots:l={},$$scope:s}=e;const u=un(l);let{value:a=""}=e,{checked:c=!1}=e,{disabled:g=!1}=e,{required:d=!1}=e,{labelPosition:f="right"}=e,{labelText:m=""}=e,{hideLabel:b=!1}=e,{id:k="ccs-"+Math.random().toString(36)}=e,{name:C=""}=e,{ref:h=null}=e;const p=Jn("RadioButtonGroup"),v=p?p.selectedValue:ft(c?a:void 0);ce(n,v,x=>t(14,o=x)),p&&p.add({id:k,checked:c,disabled:g,value:a});function w(x){ie.call(this,n,x)}function _(x){ue[x?"unshift":"push"](()=>{h=x,t(1,h)})}const O=()=>{p&&p.update(a)};return n.$$set=x=>{e=fe(fe({},e),Xe(x)),t(12,i=ye(e,r)),"value"in x&&t(2,a=x.value),"checked"in x&&t(0,c=x.checked),"disabled"in x&&t(3,g=x.disabled),"required"in x&&t(4,d=x.required),"labelPosition"in x&&t(5,f=x.labelPosition),"labelText"in x&&t(6,m=x.labelText),"hideLabel"in x&&t(7,b=x.hideLabel),"id"in x&&t(8,k=x.id),"name"in x&&t(9,C=x.name),"ref"in x&&t(1,h=x.ref),"$$scope"in x&&t(15,s=x.$$scope)},n.$$.update=()=>{n.$$.dirty&16388&&t(0,c=o===a)},[c,h,a,g,d,f,m,b,k,C,p,v,i,u,o,s,l,w,_,O]}class _o extends oe{constructor(e){super(),le(this,e,bo,vo,se,{value:2,checked:0,disabled:3,required:4,labelPosition:5,labelText:6,hideLabel:7,id:8,name:9,ref:1})}}const Jt=_o;function yo(n){const e=n-1;return e*e*e+1}function gr(n,{delay:e=0,duration:t=400,easing:r=yo}={}){const i=getComputedStyle(n),o=+i.opacity,l=parseFloat(i.height),s=parseFloat(i.paddingTop),u=parseFloat(i.paddingBottom),a=parseFloat(i.marginTop),c=parseFloat(i.marginBottom),g=parseFloat(i.borderTopWidth),d=parseFloat(i.borderBottomWidth);return{delay:e,duration:t,easing:r,css:f=>`overflow: hidden;opacity: ${Math.min(f*20,1)*o};height: ${f*l}px;padding-top: ${f*s}px;padding-bottom: ${f*u}px;margin-top: ${f*a}px;margin-bottom: ${f*c}px;border-top-width: ${f*g}px;border-bottom-width: ${f*d}px;`}}function vr(n){let e,t;return{c(){e=Le("title"),t=j(n[1])},m(r,i){M(r,e,i),S(e,t)},p(r,i){i&2&&pe(t,r[1])},d(r){r&&P(e)}}}function wo(n){let e,t,r=n[1]&&vr(n),i=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],o={};for(let l=0;l<i.length;l+=1)o=fe(o,i[l]);return{c(){e=Le("svg"),r&&r.c(),t=Le("path"),A(t,"d","M30 28.6L3.4 2 2 3.4l10.1 10.1L4 21.6V28h6.4l8.1-8.1L28.6 30 30 28.6zM9.6 26H6v-3.6l7.5-7.5 3.6 3.6L9.6 26zM29.4 6.2L29.4 6.2l-3.6-3.6c-.8-.8-2-.8-2.8 0l0 0 0 0-8 8 1.4 1.4L20 8.4l3.6 3.6L20 15.6l1.4 1.4 8-8C30.2 8.2 30.2 7 29.4 6.2L29.4 6.2zM25 10.6L21.4 7l3-3L28 7.6 25 10.6z"),kt(e,o)},m(l,s){M(l,e,s),r&&r.m(e,null),S(e,t)},p(l,[s]){l[1]?r?r.p(l,s):(r=vr(l),r.c(),r.m(e,t)):r&&(r.d(1),r=null),kt(e,o=ut(i,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},s&1&&{width:l[0]},s&1&&{height:l[0]},s&4&&l[2],s&8&&l[3]]))},i:ne,o:ne,d(l){l&&P(e),r&&r.d()}}}function ko(n,e,t){let r,i;const o=["size","title"];let l=ye(e,o),{size:s=16}=e,{title:u=void 0}=e;return n.$$set=a=>{t(5,e=fe(fe({},e),Xe(a))),t(3,l=ye(e,o)),"size"in a&&t(0,s=a.size),"title"in a&&t(1,u=a.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||u),t(2,i={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=Xe(e),[s,u,i,l,r]}class So extends oe{constructor(e){super(),le(this,e,ko,wo,se,{size:0,title:1})}}const Eo=So;function Mo(n){let e,t,r,i;const o=n[5].default,l=Re(o,n,n[4],null);let s=[n[3]],u={};for(let a=0;a<s.length;a+=1)u=fe(u,s[a]);return{c(){e=T("ol"),l&&l.c(),Ve(e,u),L(e,"bx--list--ordered",!n[1]),L(e,"bx--list--ordered--native",n[1]),L(e,"bx--list--nested",n[0]),L(e,"bx--list--expressive",n[2])},m(a,c){M(a,e,c),l&&l.m(e,null),t=!0,r||(i=[X(e,"click",n[6]),X(e,"mouseover",n[7]),X(e,"mouseenter",n[8]),X(e,"mouseleave",n[9])],r=!0)},p(a,[c]){l&&l.p&&(!t||c&16)&&Ae(l,o,a,a[4],t?Ne(o,a[4],c,null):Oe(a[4]),null),Ve(e,u=ut(s,[c&8&&a[3]])),L(e,"bx--list--ordered",!a[1]),L(e,"bx--list--ordered--native",a[1]),L(e,"bx--list--nested",a[0]),L(e,"bx--list--expressive",a[2])},i(a){t||(I(l,a),t=!0)},o(a){D(l,a),t=!1},d(a){a&&P(e),l&&l.d(a),r=!1,Je(i)}}}function Po(n,e,t){const r=["nested","native","expressive"];let i=ye(e,r),{$$slots:o={},$$scope:l}=e,{nested:s=!1}=e,{native:u=!1}=e,{expressive:a=!1}=e;function c(m){ie.call(this,n,m)}function g(m){ie.call(this,n,m)}function d(m){ie.call(this,n,m)}function f(m){ie.call(this,n,m)}return n.$$set=m=>{e=fe(fe({},e),Xe(m)),t(3,i=ye(e,r)),"nested"in m&&t(0,s=m.nested),"native"in m&&t(1,u=m.native),"expressive"in m&&t(2,a=m.expressive),"$$scope"in m&&t(4,l=m.$$scope)},[s,u,a,i,l,o,c,g,d,f]}class xo extends oe{constructor(e){super(),le(this,e,Po,Mo,se,{nested:0,native:1,expressive:2})}}const Lo=xo,To=n=>({}),br=n=>({});function _r(n){let e,t;const r=n[11].legendText,i=Re(r,n,n[10],br),o=i||Co(n);return{c(){e=T("legend"),o&&o.c(),L(e,"bx--label",!0),L(e,"bx--visually-hidden",n[2])},m(l,s){M(l,e,s),o&&o.m(e,null),t=!0},p(l,s){i?i.p&&(!t||s&1024)&&Ae(i,r,l,l[10],t?Ne(r,l[10],s,To):Oe(l[10]),br):o&&o.p&&(!t||s&2)&&o.p(l,t?s:-1),(!t||s&4)&&L(e,"bx--visually-hidden",l[2])},i(l){t||(I(o,l),t=!0)},o(l){D(o,l),t=!1},d(l){l&&P(e),o&&o.d(l)}}}function Co(n){let e;return{c(){e=j(n[1])},m(t,r){M(t,e,r)},p(t,r){r&2&&pe(e,t[1])},d(t){t&&P(e)}}}function Ro(n){let e,t,r,i,o,l,s=(n[1]||n[8].legendText)&&_r(n);const u=n[11].default,a=Re(u,n,n[10],null);let c=[{id:n[5]},n[7]],g={};for(let d=0;d<c.length;d+=1)g=fe(g,c[d]);return{c(){e=T("div"),t=T("fieldset"),s&&s.c(),r=z(),a&&a.c(),t.disabled=n[0],L(t,"bx--radio-button-group",!0),L(t,"bx--radio-button-group--vertical",n[4]==="vertical"),L(t,"bx--radio-button-group--label-left",n[3]==="left"),L(t,"bx--radio-button-group--label-right",n[3]==="right"),Ve(e,g),L(e,"bx--form-item",!0)},m(d,f){M(d,e,f),S(e,t),s&&s.m(t,null),S(t,r),a&&a.m(t,null),i=!0,o||(l=[X(e,"click",n[12]),X(e,"mouseover",n[13]),X(e,"mouseenter",n[14]),X(e,"mouseleave",n[15])],o=!0)},p(d,[f]){d[1]||d[8].legendText?s?(s.p(d,f),f&258&&I(s,1)):(s=_r(d),s.c(),I(s,1),s.m(t,r)):s&&(Me(),D(s,1,1,()=>{s=null}),Pe()),a&&a.p&&(!i||f&1024)&&Ae(a,u,d,d[10],i?Ne(u,d[10],f,null):Oe(d[10]),null),(!i||f&1)&&(t.disabled=d[0]),(!i||f&16)&&L(t,"bx--radio-button-group--vertical",d[4]==="vertical"),(!i||f&8)&&L(t,"bx--radio-button-group--label-left",d[3]==="left"),(!i||f&8)&&L(t,"bx--radio-button-group--label-right",d[3]==="right"),Ve(e,g=ut(c,[(!i||f&32)&&{id:d[5]},f&128&&d[7]])),L(e,"bx--form-item",!0)},i(d){i||(I(s),I(a,d),i=!0)},o(d){D(s),D(a,d),i=!1},d(d){d&&P(e),s&&s.d(),a&&a.d(d),o=!1,Je(l)}}}function Ao(n,e,t){const r=["selected","disabled","legendText","hideLegend","labelPosition","orientation","id"];let i=ye(e,r),o,{$$slots:l={},$$scope:s}=e;const u=un(l);let{selected:a=void 0}=e,{disabled:c=!1}=e,{legendText:g=""}=e,{hideLegend:d=!1}=e,{labelPosition:f="right"}=e,{orientation:m="horizontal"}=e,{id:b=void 0}=e;const k=yi(),C=ft(a);ce(n,C,_=>t(16,o=_)),wi("RadioButtonGroup",{selectedValue:C,add:({checked:_,value:O})=>{_&&C.set(O)},update:_=>{t(9,a=_)}}),fn(()=>{ar(C,o=a,o)}),Ki(()=>{ar(C,o=a,o)}),C.subscribe(_=>{t(9,a=_),k("change",_)});function h(_){ie.call(this,n,_)}function p(_){ie.call(this,n,_)}function v(_){ie.call(this,n,_)}function w(_){ie.call(this,n,_)}return n.$$set=_=>{e=fe(fe({},e),Xe(_)),t(7,i=ye(e,r)),"selected"in _&&t(9,a=_.selected),"disabled"in _&&t(0,c=_.disabled),"legendText"in _&&t(1,g=_.legendText),"hideLegend"in _&&t(2,d=_.hideLegend),"labelPosition"in _&&t(3,f=_.labelPosition),"orientation"in _&&t(4,m=_.orientation),"id"in _&&t(5,b=_.id),"$$scope"in _&&t(10,s=_.$$scope)},[c,g,d,f,m,b,C,i,u,a,s,l,h,p,v,w]}class Oo extends oe{constructor(e){super(),le(this,e,Ao,Ro,se,{selected:9,disabled:0,legendText:1,hideLegend:2,labelPosition:3,orientation:4,id:5})}}const No=Oo,Fo=n=>({}),yr=n=>({});function wr(n){let e,t,r,i;const o=n[20].labelText,l=Re(o,n,n[19],yr),s=l||Io(n);let u=n[5]&&kr(n);return{c(){e=T("div"),t=T("label"),s&&s.c(),r=z(),u&&u.c(),A(t,"for",n[14]),L(t,"bx--label",!0),L(t,"bx--visually-hidden",n[11]),L(t,"bx--label--disabled",n[7]),L(e,"bx--text-area__label-wrapper",!0)},m(a,c){M(a,e,c),S(e,t),s&&s.m(t,null),S(e,r),u&&u.m(e,null),i=!0},p(a,c){l?l.p&&(!i||c[0]&524288)&&Ae(l,o,a,a[19],i?Ne(o,a[19],c,Fo):Oe(a[19]),yr):s&&s.p&&(!i||c[0]&1024)&&s.p(a,i?c:[-1,-1]),(!i||c[0]&16384)&&A(t,"for",a[14]),(!i||c[0]&2048)&&L(t,"bx--visually-hidden",a[11]),(!i||c[0]&128)&&L(t,"bx--label--disabled",a[7]),a[5]?u?u.p(a,c):(u=kr(a),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(a){i||(I(s,a),i=!0)},o(a){D(s,a),i=!1},d(a){a&&P(e),s&&s.d(a),u&&u.d()}}}function Io(n){let e;return{c(){e=j(n[10])},m(t,r){M(t,e,r)},p(t,r){r[0]&1024&&pe(e,t[10])},d(t){t&&P(e)}}}function kr(n){let e,t=n[0].length+"",r,i,o;return{c(){e=T("div"),r=j(t),i=j("/"),o=j(n[5]),L(e,"bx--label",!0),L(e,"bx--label--disabled",n[7])},m(l,s){M(l,e,s),S(e,r),S(e,i),S(e,o)},p(l,s){s[0]&1&&t!==(t=l[0].length+"")&&pe(r,t),s[0]&32&&pe(o,l[5]),s[0]&128&&L(e,"bx--label--disabled",l[7])},d(l){l&&P(e)}}}function Sr(n){let e,t;return e=new Si({props:{class:"bx--text-area__invalid-icon"}}),{c(){H(e.$$.fragment)},m(r,i){V(e,r,i),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){Z(e,r)}}}function Er(n){let e,t;return{c(){e=T("div"),t=j(n[9]),L(e,"bx--form__helper-text",!0),L(e,"bx--form__helper-text--disabled",n[7])},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&512&&pe(t,r[9]),i[0]&128&&L(e,"bx--form__helper-text--disabled",r[7])},d(r){r&&P(e)}}}function Mr(n){let e,t;return{c(){e=T("div"),t=j(n[13]),A(e,"id",n[16]),L(e,"bx--form-requirement",!0)},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&8192&&pe(t,r[13]),i[0]&65536&&A(e,"id",r[16])},d(r){r&&P(e)}}}function Bo(n){let e,t,r,i,o,l,s,u,a,c,g,d,f,m,b=(n[10]||n[17].labelText)&&!n[11]&&wr(n),k=n[12]&&Sr(),C=[{"aria-invalid":l=n[12]||void 0},{"aria-describedby":s=n[12]?n[16]:void 0},{disabled:n[7]},{id:n[14]},{name:n[15]},{cols:n[3]},{rows:n[4]},{placeholder:n[2]},{readOnly:n[8]},{maxlength:u=n[5]??void 0},n[18]],h={};for(let w=0;w<C.length;w+=1)h=fe(h,C[w]);let p=!n[12]&&n[9]&&Er(n),v=n[12]&&Mr(n);return{c(){e=T("div"),b&&b.c(),t=z(),r=T("div"),k&&k.c(),i=z(),o=T("textarea"),c=z(),p&&p.c(),g=z(),v&&v.c(),Ve(o,h),L(o,"bx--text-area",!0),L(o,"bx--text-area--light",n[6]),L(o,"bx--text-area--invalid",n[12]),A(r,"data-invalid",a=n[12]||void 0),L(r,"bx--text-area__wrapper",!0),L(e,"bx--form-item",!0)},m(w,_){M(w,e,_),b&&b.m(e,null),S(e,t),S(e,r),k&&k.m(r,null),S(r,i),S(r,o),o.autofocus&&o.focus(),n[32](o),St(o,n[0]),S(e,c),p&&p.m(e,null),S(e,g),v&&v.m(e,null),d=!0,f||(m=[X(o,"input",n[33]),X(o,"change",n[25]),X(o,"input",n[26]),X(o,"keydown",n[27]),X(o,"keyup",n[28]),X(o,"focus",n[29]),X(o,"blur",n[30]),X(o,"paste",n[31]),X(e,"click",n[21]),X(e,"mouseover",n[22]),X(e,"mouseenter",n[23]),X(e,"mouseleave",n[24])],f=!0)},p(w,_){(w[10]||w[17].labelText)&&!w[11]?b?(b.p(w,_),_[0]&134144&&I(b,1)):(b=wr(w),b.c(),I(b,1),b.m(e,t)):b&&(Me(),D(b,1,1,()=>{b=null}),Pe()),w[12]?k?_[0]&4096&&I(k,1):(k=Sr(),k.c(),I(k,1),k.m(r,i)):k&&(Me(),D(k,1,1,()=>{k=null}),Pe()),Ve(o,h=ut(C,[(!d||_[0]&4096&&l!==(l=w[12]||void 0))&&{"aria-invalid":l},(!d||_[0]&69632&&s!==(s=w[12]?w[16]:void 0))&&{"aria-describedby":s},(!d||_[0]&128)&&{disabled:w[7]},(!d||_[0]&16384)&&{id:w[14]},(!d||_[0]&32768)&&{name:w[15]},(!d||_[0]&8)&&{cols:w[3]},(!d||_[0]&16)&&{rows:w[4]},(!d||_[0]&4)&&{placeholder:w[2]},(!d||_[0]&256)&&{readOnly:w[8]},(!d||_[0]&32&&u!==(u=w[5]??void 0))&&{maxlength:u},_[0]&262144&&w[18]])),_[0]&1&&St(o,w[0]),L(o,"bx--text-area",!0),L(o,"bx--text-area--light",w[6]),L(o,"bx--text-area--invalid",w[12]),(!d||_[0]&4096&&a!==(a=w[12]||void 0))&&A(r,"data-invalid",a),!w[12]&&w[9]?p?p.p(w,_):(p=Er(w),p.c(),p.m(e,g)):p&&(p.d(1),p=null),w[12]?v?v.p(w,_):(v=Mr(w),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i(w){d||(I(b),I(k),d=!0)},o(w){D(b),D(k),d=!1},d(w){w&&P(e),b&&b.d(),k&&k.d(),n[32](null),p&&p.d(),v&&v.d(),f=!1,Je(m)}}}function zo(n,e,t){let r;const i=["value","placeholder","cols","rows","maxCount","light","disabled","readonly","helperText","labelText","hideLabel","invalid","invalidText","id","name","ref"];let o=ye(e,i),{$$slots:l={},$$scope:s}=e;const u=un(l);let{value:a=""}=e,{placeholder:c=""}=e,{cols:g=50}=e,{rows:d=4}=e,{maxCount:f=void 0}=e,{light:m=!1}=e,{disabled:b=!1}=e,{readonly:k=!1}=e,{helperText:C=""}=e,{labelText:h=""}=e,{hideLabel:p=!1}=e,{invalid:v=!1}=e,{invalidText:w=""}=e,{id:_="ccs-"+Math.random().toString(36)}=e,{name:O=void 0}=e,{ref:x=null}=e;function F(y){ie.call(this,n,y)}function q(y){ie.call(this,n,y)}function E(y){ie.call(this,n,y)}function B(y){ie.call(this,n,y)}function N(y){ie.call(this,n,y)}function R(y){ie.call(this,n,y)}function G(y){ie.call(this,n,y)}function J(y){ie.call(this,n,y)}function te(y){ie.call(this,n,y)}function $(y){ie.call(this,n,y)}function ee(y){ie.call(this,n,y)}function ae(y){ue[y?"unshift":"push"](()=>{x=y,t(1,x)})}function re(){a=this.value,t(0,a)}return n.$$set=y=>{e=fe(fe({},e),Xe(y)),t(18,o=ye(e,i)),"value"in y&&t(0,a=y.value),"placeholder"in y&&t(2,c=y.placeholder),"cols"in y&&t(3,g=y.cols),"rows"in y&&t(4,d=y.rows),"maxCount"in y&&t(5,f=y.maxCount),"light"in y&&t(6,m=y.light),"disabled"in y&&t(7,b=y.disabled),"readonly"in y&&t(8,k=y.readonly),"helperText"in y&&t(9,C=y.helperText),"labelText"in y&&t(10,h=y.labelText),"hideLabel"in y&&t(11,p=y.hideLabel),"invalid"in y&&t(12,v=y.invalid),"invalidText"in y&&t(13,w=y.invalidText),"id"in y&&t(14,_=y.id),"name"in y&&t(15,O=y.name),"ref"in y&&t(1,x=y.ref),"$$scope"in y&&t(19,s=y.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&t(16,r=`error-${_}`)},[a,x,c,g,d,f,m,b,k,C,h,p,v,w,_,O,r,u,o,s,l,F,q,E,B,N,R,G,J,te,$,ee,ae,re]}class Go extends oe{constructor(e){super(),le(this,e,zo,Bo,se,{value:0,placeholder:2,cols:3,rows:4,maxCount:5,light:6,disabled:7,readonly:8,helperText:9,labelText:10,hideLabel:11,invalid:12,invalidText:13,id:14,name:15,ref:1},null,[-1,-1])}}const qo=Go,Do=n=>({}),Pr=n=>({}),Yo=n=>({}),xr=n=>({});function Lr(n){let e,t,r,i=n[9]&&Tr(n),o=!n[20]&&n[6]&&Cr(n);return{c(){e=T("div"),i&&i.c(),t=z(),o&&o.c(),L(e,"bx--text-input__label-helper-wrapper",!0)},m(l,s){M(l,e,s),i&&i.m(e,null),S(e,t),o&&o.m(e,null),r=!0},p(l,s){l[9]?i?(i.p(l,s),s[0]&512&&I(i,1)):(i=Tr(l),i.c(),I(i,1),i.m(e,t)):i&&(Me(),D(i,1,1,()=>{i=null}),Pe()),!l[20]&&l[6]?o?o.p(l,s):(o=Cr(l),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(l){r||(I(i),r=!0)},o(l){D(i),r=!1},d(l){l&&P(e),i&&i.d(),o&&o.d()}}}function Tr(n){let e,t;const r=n[26].labelText,i=Re(r,n,n[25],xr),o=i||Xo(n);return{c(){e=T("label"),o&&o.c(),A(e,"for",n[7]),L(e,"bx--label",!0),L(e,"bx--visually-hidden",n[10]),L(e,"bx--label--disabled",n[5]),L(e,"bx--label--inline",n[16]),L(e,"bx--label--inline--sm",n[2]==="sm"),L(e,"bx--label--inline--xl",n[2]==="xl")},m(l,s){M(l,e,s),o&&o.m(e,null),t=!0},p(l,s){i?i.p&&(!t||s[0]&33554432)&&Ae(i,r,l,l[25],t?Ne(r,l[25],s,Yo):Oe(l[25]),xr):o&&o.p&&(!t||s[0]&512)&&o.p(l,t?s:[-1,-1]),(!t||s[0]&128)&&A(e,"for",l[7]),(!t||s[0]&1024)&&L(e,"bx--visually-hidden",l[10]),(!t||s[0]&32)&&L(e,"bx--label--disabled",l[5]),(!t||s[0]&65536)&&L(e,"bx--label--inline",l[16]),(!t||s[0]&4)&&L(e,"bx--label--inline--sm",l[2]==="sm"),(!t||s[0]&4)&&L(e,"bx--label--inline--xl",l[2]==="xl")},i(l){t||(I(o,l),t=!0)},o(l){D(o,l),t=!1},d(l){l&&P(e),o&&o.d(l)}}}function Xo(n){let e;return{c(){e=j(n[9])},m(t,r){M(t,e,r)},p(t,r){r[0]&512&&pe(e,t[9])},d(t){t&&P(e)}}}function Cr(n){let e,t;return{c(){e=T("div"),t=j(n[6]),L(e,"bx--form__helper-text",!0),L(e,"bx--form__helper-text--disabled",n[5]),L(e,"bx--form__helper-text--inline",n[16])},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&64&&pe(t,r[6]),i[0]&32&&L(e,"bx--form__helper-text--disabled",r[5]),i[0]&65536&&L(e,"bx--form__helper-text--inline",r[16])},d(r){r&&P(e)}}}function Rr(n){let e,t;const r=n[26].labelText,i=Re(r,n,n[25],Pr),o=i||Jo(n);return{c(){e=T("label"),o&&o.c(),A(e,"for",n[7]),L(e,"bx--label",!0),L(e,"bx--visually-hidden",n[10]),L(e,"bx--label--disabled",n[5]),L(e,"bx--label--inline",n[16]),L(e,"bx--label--inline-sm",n[16]&&n[2]==="sm"),L(e,"bx--label--inline-xl",n[16]&&n[2]==="xl")},m(l,s){M(l,e,s),o&&o.m(e,null),t=!0},p(l,s){i?i.p&&(!t||s[0]&33554432)&&Ae(i,r,l,l[25],t?Ne(r,l[25],s,Do):Oe(l[25]),Pr):o&&o.p&&(!t||s[0]&512)&&o.p(l,t?s:[-1,-1]),(!t||s[0]&128)&&A(e,"for",l[7]),(!t||s[0]&1024)&&L(e,"bx--visually-hidden",l[10]),(!t||s[0]&32)&&L(e,"bx--label--disabled",l[5]),(!t||s[0]&65536)&&L(e,"bx--label--inline",l[16]),(!t||s[0]&65540)&&L(e,"bx--label--inline-sm",l[16]&&l[2]==="sm"),(!t||s[0]&65540)&&L(e,"bx--label--inline-xl",l[16]&&l[2]==="xl")},i(l){t||(I(o,l),t=!0)},o(l){D(o,l),t=!1},d(l){l&&P(e),o&&o.d(l)}}}function Jo(n){let e;return{c(){e=j(n[9])},m(t,r){M(t,e,r)},p(t,r){r[0]&512&&pe(e,t[9])},d(t){t&&P(e)}}}function Ar(n){let e,t;return e=new Si({props:{class:"bx--text-input__invalid-icon"}}),{c(){H(e.$$.fragment)},m(r,i){V(e,r,i),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){Z(e,r)}}}function Or(n){let e,t;return e=new po({props:{class:`bx--text-input__invalid-icon
            bx--text-input__invalid-icon--warning`}}),{c(){H(e.$$.fragment)},m(r,i){V(e,r,i),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){Z(e,r)}}}function Nr(n){let e,t;return e=new Eo({props:{class:"bx--text-input__readonly-icon"}}),{c(){H(e.$$.fragment)},m(r,i){V(e,r,i),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){Z(e,r)}}}function Fr(n){let e;return{c(){e=T("hr"),L(e,"bx--text-input__divider",!0)},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function Ir(n){let e,t;return{c(){e=T("div"),t=j(n[12]),A(e,"id",n[19]),L(e,"bx--form-requirement",!0)},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&4096&&pe(t,r[12]),i[0]&524288&&A(e,"id",r[19])},d(r){r&&P(e)}}}function Br(n){let e,t;return{c(){e=T("div"),t=j(n[14]),A(e,"id",n[18]),L(e,"bx--form-requirement",!0)},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&16384&&pe(t,r[14]),i[0]&262144&&A(e,"id",r[18])},d(r){r&&P(e)}}}function zr(n){let e,t;return{c(){e=T("div"),t=j(n[6]),L(e,"bx--form__helper-text",!0),L(e,"bx--form__helper-text--disabled",n[5]),L(e,"bx--form__helper-text--inline",n[16])},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&64&&pe(t,r[6]),i[0]&32&&L(e,"bx--form__helper-text--disabled",r[5]),i[0]&65536&&L(e,"bx--form__helper-text--inline",r[16])},d(r){r&&P(e)}}}function Gr(n){let e,t;return{c(){e=T("div"),t=j(n[12]),A(e,"id",n[19]),L(e,"bx--form-requirement",!0)},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&4096&&pe(t,r[12]),i[0]&524288&&A(e,"id",r[19])},d(r){r&&P(e)}}}function qr(n){let e,t;return{c(){e=T("div"),t=j(n[14]),A(e,"id",n[18]),L(e,"bx--form-requirement",!0)},m(r,i){M(r,e,i),S(e,t)},p(r,i){i[0]&16384&&pe(t,r[14]),i[0]&262144&&A(e,"id",r[18])},d(r){r&&P(e)}}}function Uo(n){let e,t,r,i,o,l,s,u,a,c,g,d,f,m,b,k,C,h,p,v,w,_,O,x,F=n[16]&&Lr(n),q=!n[16]&&(n[9]||n[24].labelText)&&Rr(n),E=n[11]&&Ar(),B=!n[11]&&n[13]&&Or(),N=n[17]&&Nr(),R=[{"data-invalid":c=n[11]||void 0},{"aria-invalid":g=n[11]||void 0},{"data-warn":d=n[13]||void 0},{"aria-describedby":f=n[11]?n[19]:n[13]?n[18]:void 0},{disabled:n[5]},{id:n[7]},{name:n[8]},{placeholder:n[3]},{required:n[15]},{readOnly:n[17]},n[23]],G={};for(let y=0;y<R.length;y+=1)G=fe(G,R[y]);let J=n[20]&&Fr(),te=n[20]&&!n[16]&&n[11]&&Ir(n),$=n[20]&&!n[16]&&n[13]&&Br(n),ee=!n[11]&&!n[13]&&!n[20]&&!n[16]&&n[6]&&zr(n),ae=!n[20]&&n[11]&&Gr(n),re=!n[20]&&!n[11]&&n[13]&&qr(n);return{c(){e=T("div"),F&&F.c(),t=z(),q&&q.c(),r=z(),i=T("div"),o=T("div"),E&&E.c(),l=z(),B&&B.c(),s=z(),N&&N.c(),u=z(),a=T("input"),m=z(),J&&J.c(),b=z(),te&&te.c(),k=z(),$&&$.c(),p=z(),ee&&ee.c(),v=z(),ae&&ae.c(),w=z(),re&&re.c(),Ve(a,G),L(a,"bx--text-input",!0),L(a,"bx--text-input--light",n[4]),L(a,"bx--text-input--invalid",n[11]),L(a,"bx--text-input--warn",n[13]),L(a,"bx--text-input--sm",n[2]==="sm"),L(a,"bx--text-input--xl",n[2]==="xl"),A(o,"data-invalid",C=n[11]||void 0),A(o,"data-warn",h=n[13]||void 0),L(o,"bx--text-input__field-wrapper",!0),L(o,"bx--text-input__field-wrapper--warning",!n[11]&&n[13]),L(i,"bx--text-input__field-outer-wrapper",!0),L(i,"bx--text-input__field-outer-wrapper--inline",n[16]),L(e,"bx--form-item",!0),L(e,"bx--text-input-wrapper",!0),L(e,"bx--text-input-wrapper--inline",n[16]),L(e,"bx--text-input-wrapper--light",n[4]),L(e,"bx--text-input-wrapper--readonly",n[17])},m(y,U){M(y,e,U),F&&F.m(e,null),S(e,t),q&&q.m(e,null),S(e,r),S(e,i),S(i,o),E&&E.m(o,null),S(o,l),B&&B.m(o,null),S(o,s),N&&N.m(o,null),S(o,u),S(o,a),a.autofocus&&a.focus(),n[36](a),St(a,n[0]),S(o,m),J&&J.m(o,null),S(o,b),te&&te.m(o,null),S(o,k),$&&$.m(o,null),S(i,p),ee&&ee.m(i,null),S(i,v),ae&&ae.m(i,null),S(i,w),re&&re.m(i,null),_=!0,O||(x=[X(a,"input",n[37]),X(a,"change",n[22]),X(a,"input",n[21]),X(a,"keydown",n[31]),X(a,"keyup",n[32]),X(a,"focus",n[33]),X(a,"blur",n[34]),X(a,"paste",n[35]),X(e,"click",n[27]),X(e,"mouseover",n[28]),X(e,"mouseenter",n[29]),X(e,"mouseleave",n[30])],O=!0)},p(y,U){y[16]?F?(F.p(y,U),U[0]&65536&&I(F,1)):(F=Lr(y),F.c(),I(F,1),F.m(e,t)):F&&(Me(),D(F,1,1,()=>{F=null}),Pe()),!y[16]&&(y[9]||y[24].labelText)?q?(q.p(y,U),U[0]&16843264&&I(q,1)):(q=Rr(y),q.c(),I(q,1),q.m(e,r)):q&&(Me(),D(q,1,1,()=>{q=null}),Pe()),y[11]?E?U[0]&2048&&I(E,1):(E=Ar(),E.c(),I(E,1),E.m(o,l)):E&&(Me(),D(E,1,1,()=>{E=null}),Pe()),!y[11]&&y[13]?B?U[0]&10240&&I(B,1):(B=Or(),B.c(),I(B,1),B.m(o,s)):B&&(Me(),D(B,1,1,()=>{B=null}),Pe()),y[17]?N?U[0]&131072&&I(N,1):(N=Nr(),N.c(),I(N,1),N.m(o,u)):N&&(Me(),D(N,1,1,()=>{N=null}),Pe()),Ve(a,G=ut(R,[(!_||U[0]&2048&&c!==(c=y[11]||void 0))&&{"data-invalid":c},(!_||U[0]&2048&&g!==(g=y[11]||void 0))&&{"aria-invalid":g},(!_||U[0]&8192&&d!==(d=y[13]||void 0))&&{"data-warn":d},(!_||U[0]&796672&&f!==(f=y[11]?y[19]:y[13]?y[18]:void 0))&&{"aria-describedby":f},(!_||U[0]&32)&&{disabled:y[5]},(!_||U[0]&128)&&{id:y[7]},(!_||U[0]&256)&&{name:y[8]},(!_||U[0]&8)&&{placeholder:y[3]},(!_||U[0]&32768)&&{required:y[15]},(!_||U[0]&131072)&&{readOnly:y[17]},U[0]&8388608&&y[23]])),U[0]&1&&a.value!==y[0]&&St(a,y[0]),L(a,"bx--text-input",!0),L(a,"bx--text-input--light",y[4]),L(a,"bx--text-input--invalid",y[11]),L(a,"bx--text-input--warn",y[13]),L(a,"bx--text-input--sm",y[2]==="sm"),L(a,"bx--text-input--xl",y[2]==="xl"),y[20]?J||(J=Fr(),J.c(),J.m(o,b)):J&&(J.d(1),J=null),y[20]&&!y[16]&&y[11]?te?te.p(y,U):(te=Ir(y),te.c(),te.m(o,k)):te&&(te.d(1),te=null),y[20]&&!y[16]&&y[13]?$?$.p(y,U):($=Br(y),$.c(),$.m(o,null)):$&&($.d(1),$=null),(!_||U[0]&2048&&C!==(C=y[11]||void 0))&&A(o,"data-invalid",C),(!_||U[0]&8192&&h!==(h=y[13]||void 0))&&A(o,"data-warn",h),(!_||U[0]&10240)&&L(o,"bx--text-input__field-wrapper--warning",!y[11]&&y[13]),!y[11]&&!y[13]&&!y[20]&&!y[16]&&y[6]?ee?ee.p(y,U):(ee=zr(y),ee.c(),ee.m(i,v)):ee&&(ee.d(1),ee=null),!y[20]&&y[11]?ae?ae.p(y,U):(ae=Gr(y),ae.c(),ae.m(i,w)):ae&&(ae.d(1),ae=null),!y[20]&&!y[11]&&y[13]?re?re.p(y,U):(re=qr(y),re.c(),re.m(i,null)):re&&(re.d(1),re=null),(!_||U[0]&65536)&&L(i,"bx--text-input__field-outer-wrapper--inline",y[16]),(!_||U[0]&65536)&&L(e,"bx--text-input-wrapper--inline",y[16]),(!_||U[0]&16)&&L(e,"bx--text-input-wrapper--light",y[4]),(!_||U[0]&131072)&&L(e,"bx--text-input-wrapper--readonly",y[17])},i(y){_||(I(F),I(q),I(E),I(B),I(N),_=!0)},o(y){D(F),D(q),D(E),D(B),D(N),_=!1},d(y){y&&P(e),F&&F.d(),q&&q.d(),E&&E.d(),B&&B.d(),N&&N.d(),n[36](null),J&&J.d(),te&&te.d(),$&&$.d(),ee&&ee.d(),ae&&ae.d(),re&&re.d(),O=!1,Je(x)}}}function jo(n,e,t){let r,i,o;const l=["size","value","placeholder","light","disabled","helperText","id","name","labelText","hideLabel","invalid","invalidText","warn","warnText","ref","required","inline","readonly"];let s=ye(e,l),{$$slots:u={},$$scope:a}=e;const c=un(u);let{size:g=void 0}=e,{value:d=""}=e,{placeholder:f=""}=e,{light:m=!1}=e,{disabled:b=!1}=e,{helperText:k=""}=e,{id:C="ccs-"+Math.random().toString(36)}=e,{name:h=void 0}=e,{labelText:p=""}=e,{hideLabel:v=!1}=e,{invalid:w=!1}=e,{invalidText:_=""}=e,{warn:O=!1}=e,{warnText:x=""}=e,{ref:F=null}=e,{required:q=!1}=e,{inline:E=!1}=e,{readonly:B=!1}=e;const N=Jn("Form"),R=yi();function G(Y){return s.type!=="number"?Y:Y!=""?Number(Y):null}const J=Y=>{t(0,d=G(Y.target.value)),R("input",d)},te=Y=>{R("change",G(Y.target.value))};function $(Y){ie.call(this,n,Y)}function ee(Y){ie.call(this,n,Y)}function ae(Y){ie.call(this,n,Y)}function re(Y){ie.call(this,n,Y)}function y(Y){ie.call(this,n,Y)}function U(Y){ie.call(this,n,Y)}function Ge(Y){ie.call(this,n,Y)}function xt(Y){ie.call(this,n,Y)}function Yt(Y){ie.call(this,n,Y)}function mn(Y){ue[Y?"unshift":"push"](()=>{F=Y,t(1,F)})}function me(){d=this.value,t(0,d)}return n.$$set=Y=>{e=fe(fe({},e),Xe(Y)),t(23,s=ye(e,l)),"size"in Y&&t(2,g=Y.size),"value"in Y&&t(0,d=Y.value),"placeholder"in Y&&t(3,f=Y.placeholder),"light"in Y&&t(4,m=Y.light),"disabled"in Y&&t(5,b=Y.disabled),"helperText"in Y&&t(6,k=Y.helperText),"id"in Y&&t(7,C=Y.id),"name"in Y&&t(8,h=Y.name),"labelText"in Y&&t(9,p=Y.labelText),"hideLabel"in Y&&t(10,v=Y.hideLabel),"invalid"in Y&&t(11,w=Y.invalid),"invalidText"in Y&&t(12,_=Y.invalidText),"warn"in Y&&t(13,O=Y.warn),"warnText"in Y&&t(14,x=Y.warnText),"ref"in Y&&t(1,F=Y.ref),"required"in Y&&t(15,q=Y.required),"inline"in Y&&t(16,E=Y.inline),"readonly"in Y&&t(17,B=Y.readonly),"$$scope"in Y&&t(25,a=Y.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&128&&t(19,i=`error-${C}`),n.$$.dirty[0]&128&&t(18,o=`warn-${C}`)},t(20,r=!!N&&N.isFluid),[d,F,g,f,m,b,k,C,h,p,v,w,_,O,x,q,E,B,o,i,r,J,te,s,c,a,u,$,ee,ae,re,y,U,Ge,xt,Yt,mn,me]}class Wo extends oe{constructor(e){super(),le(this,e,jo,Uo,se,{size:2,value:0,placeholder:3,light:4,disabled:5,helperText:6,id:7,name:8,labelText:9,hideLabel:10,invalid:11,invalidText:12,warn:13,warnText:14,ref:1,required:15,inline:16,readonly:17},null,[-1,-1])}}const Ho=Wo;function Vo(n){let e;return{c(){e=j(`Click one of the draw icons to the top right of the map (the icons allow
      you to draw points, lines, polygons or routes)`)},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function Zo(n){let e;return{c(){e=j(`Draw the intervention on the map, clicking the original point or 'Finish
      snapping' for the Polygon and Route tools respectively`)},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function Qo(n){let e;return{c(){e=j("Fill in the details that appear (Intervention type, name, description)")},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function Ko(n){let e;return{c(){e=j(`Click the "Save" button or "Delete" button to save or remove the
      intervention`)},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function $o(n){let e,t,r,i,o,l,s,u;return e=new Xt({props:{$$slots:{default:[Vo]},$$scope:{ctx:n}}}),r=new Xt({props:{$$slots:{default:[Zo]},$$scope:{ctx:n}}}),o=new Xt({props:{$$slots:{default:[Qo]},$$scope:{ctx:n}}}),s=new Xt({props:{$$slots:{default:[Ko]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),t=z(),H(r.$$.fragment),i=z(),H(o.$$.fragment),l=z(),H(s.$$.fragment)},m(a,c){V(e,a,c),M(a,t,c),V(r,a,c),M(a,i,c),V(o,a,c),M(a,l,c),V(s,a,c),u=!0},p(a,c){const g={};c&4&&(g.$$scope={dirty:c,ctx:a}),e.$set(g);const d={};c&4&&(d.$$scope={dirty:c,ctx:a}),r.$set(d);const f={};c&4&&(f.$$scope={dirty:c,ctx:a}),o.$set(f);const m={};c&4&&(m.$$scope={dirty:c,ctx:a}),s.$set(m)},i(a){u||(I(e.$$.fragment,a),I(r.$$.fragment,a),I(o.$$.fragment,a),I(s.$$.fragment,a),u=!0)},o(a){D(e.$$.fragment,a),D(r.$$.fragment,a),D(o.$$.fragment,a),D(s.$$.fragment,a),u=!1},d(a){Z(e,a),a&&P(t),Z(r,a),a&&P(i),Z(o,a),a&&P(l),Z(s,a)}}}function el(n){let e,t,r,i,o,l,s,u,a,c,g,d,f,m,b,k,C,h,p,v,w,_,O,x,F,q;return o=new Lo({props:{$$slots:{default:[$o]},$$scope:{ctx:n}}}),{c(){e=T("p"),e.textContent="For each intervention:",t=z(),r=T("br"),i=z(),H(o.$$.fragment),l=z(),s=T("br"),u=z(),a=T("p"),a.textContent=`Repeat the steps above for each substantial infrastructure intervention in
    the scheme.`,c=z(),g=T("br"),d=z(),f=T("p"),f.textContent=`To make further edits to attribute data, or to delete an intervention, click
    on its name in the left hand panel or its geometry in the map.`,m=z(),b=T("br"),k=z(),C=T("p"),C.textContent=`Click the "Export to GeoJSON" button to download the dataset representing
    the scheme, which can be made up of one or more intervention, as a GeoJSON
    file. After saving the file, you can delete the interventions, change the
    scheme name, and start a new set of interventions representing a new scheme.`,h=z(),p=T("br"),v=z(),w=T("p"),w.textContent=`To load a GeoJSON file that you have already saved from the tool, click the
    "Load from GeoJSON" button and select the file.`,_=z(),O=T("br"),x=z(),F=T("p"),F.innerHTML=`Note: the <strong>Route tool</strong> works by calculating routes between
    start and end points using the existing transport network according to
    OpenStreetMap. Use it by clicking on the location where you would like the
    route to start and then clicking on the location where you would like the
    route to end on the map. The route will be calculated and drawn on the map.
    After you click &quot;Finish snapping&quot; you can edit the route by dragging
    individual points. This can be useful for representing links that are not
    part of the existing transport network, such as a new bridge or path.
    However,
    <strong>you cannot add or remove points</strong> with the Route tool. If the
    planned route intervention you would like to sketch as part of a scheme contains
    one or more new links (for example containing new bridges or paths between cul-de-sacs),
    you may want to use the Line tool instead.`},m(E,B){M(E,e,B),M(E,t,B),M(E,r,B),M(E,i,B),V(o,E,B),M(E,l,B),M(E,s,B),M(E,u,B),M(E,a,B),M(E,c,B),M(E,g,B),M(E,d,B),M(E,f,B),M(E,m,B),M(E,b,B),M(E,k,B),M(E,C,B),M(E,h,B),M(E,p,B),M(E,v,B),M(E,w,B),M(E,_,B),M(E,O,B),M(E,x,B),M(E,F,B),q=!0},p(E,B){const N={};B&4&&(N.$$scope={dirty:B,ctx:E}),o.$set(N)},i(E){q||(I(o.$$.fragment,E),q=!0)},o(E){D(o.$$.fragment,E),q=!1},d(E){E&&P(e),E&&P(t),E&&P(r),E&&P(i),Z(o,E),E&&P(l),E&&P(s),E&&P(u),E&&P(a),E&&P(c),E&&P(g),E&&P(d),E&&P(f),E&&P(m),E&&P(b),E&&P(k),E&&P(C),E&&P(h),E&&P(p),E&&P(v),E&&P(w),E&&P(_),E&&P(O),E&&P(x),E&&P(F)}}}function tl(n){let e,t,r;function i(l){n[1](l)}let o={passiveModal:!0,modalHeading:"Instructions",$$slots:{default:[el]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.open=n[0]),e=new $i({props:o}),ue.push(()=>De(e,"open",i,n[0])),{c(){H(e.$$.fragment)},m(l,s){V(e,l,s),r=!0},p(l,[s]){const u={};s&4&&(u.$$scope={dirty:s,ctx:l}),!t&&s&1&&(t=!0,u.open=l[0],Ye(()=>t=!1)),e.$set(u)},i(l){r||(I(e.$$.fragment,l),r=!0)},o(l){D(e.$$.fragment,l),r=!1},d(l){Z(e,l)}}}function nl(n,e,t){let{open:r}=e;function i(o){r=o,t(0,r)}return n.$$set=o=>{"open"in o&&t(0,r=o.open)},[r,i]}class rl extends oe{constructor(e){super(),le(this,e,nl,tl,se,{open:0})}}const il={"line-cap":"round","line-join":"round"},Hn=["==","$type","Polygon"],Vn=["==","$type","LineString"],Zn=["==","$type","Point"];function $t(n,e,t=1){return{type:"line",layout:il,paint:{"line-color":n,"line-width":e,"line-opacity":t}}}function Qn(n,e){return{type:"fill",paint:{"fill-color":n,"fill-opacity":e}}}function Dt(n,e,t=1){return{type:"circle",paint:{"circle-radius":e,"circle-color":n,"circle-opacity":t}}}function Pt(n,e,t){if(n.getSource(e)){let r=[];for(let i of n.getStyle().layers)i.source==e&&r.push(i.id);for(let i of r)n.removeLayer(i);n.removeSource(e)}n.addSource(e,t)}function Te(n,e,t=null){n.getLayer(e.id)&&n.removeLayer(e.id),t&&!n.getLayer(t)&&(t=null),n.addLayer(e,t)}function et(){return{type:"FeatureCollection",features:[]}}const Ze=ft(null),de=ft(et()),Fe=ft(null),$e=ft(null),en=ft(null),En=ft(null);function cn(n){let e=new Set;for(let r of n.features)e.add(r.id);let t=e.size+1;for(;e.has(t);)t++;return t}function Ei(n){de.update(e=>(e.features=e.features.filter(t=>t.id!=n),e)),Fe.set(null),$e.set(null),en.set(null)}function Dr(n){let e;const t=n[4].default,r=Re(t,n,n[3],null);return{c(){r&&r.c()},m(i,o){r&&r.m(i,o),e=!0},p(i,o){r&&r.p&&(!e||o&8)&&Ae(r,t,i,i[3],e?Ne(t,i[3],o,null):Oe(i[3]),null)},i(i){e||(I(r,i),e=!0)},o(i){D(r,i),e=!1},d(i){r&&r.d(i)}}}function ol(n){let e,t,r=n[1]&&Dr(n);return{c(){e=T("div"),r&&r.c(),A(e,"class","map svelte-12dpf1u")},m(i,o){M(i,e,o),r&&r.m(e,null),n[5](e),t=!0},p(i,[o]){i[1]?r?(r.p(i,o),o&2&&I(r,1)):(r=Dr(i),r.c(),I(r,1),r.m(e,null)):r&&(Me(),D(r,1,1,()=>{r=null}),Pe())},i(i){t||(I(r),t=!0)},o(i){D(r),t=!1},d(i){i&&P(e),r&&r.d(),n[5](null)}}}function ll(n,e,t){let{$$slots:r={},$$scope:i}=e,{style:o}=e,l,s,u=!1;wi("setCamera",!window.location.hash),fn(()=>{l=new vn.Map({container:s,style:`https://api.maptiler.com/maps/${o}/style.json?key=MZEJTanw3WpxRvt7qDfo`,hash:!0}),l.addControl(new vn.ScaleControl({})),l.addControl(new vn.NavigationControl({visualizePitch:!0}),"bottom-right"),l.on("load",()=>{t(1,u=!0),Ze.set(l)}),new ResizeObserver(()=>{l.resize()}).observe(s)}),Un(()=>{l.remove()});function a(c){ue[c?"unshift":"push"](()=>{s=c,t(0,s)})}return n.$$set=c=>{"style"in c&&t(2,o=c.style),"$$scope"in c&&t(3,i=c.$$scope)},[s,u,o,i,r,a]}class sl extends oe{constructor(e){super(),le(this,e,ll,ol,se,{style:2})}}const al=n=>({}),Yr=n=>({}),ul=n=>({}),Xr=n=>({}),fl=n=>({}),Jr=n=>({});function cl(n){let e,t,r,i,o,l,s,u,a,c,g,d;const f=n[3].nav,m=Re(f,n,n[2],Jr),b=n[3].sidebar,k=Re(b,n,n[2],Xr),C=n[3].main,h=Re(C,n,n[2],Yr);return{c(){e=T("aside"),t=T("div"),r=T("nav"),m&&m.c(),i=z(),k&&k.c(),o=z(),l=T("button"),l.textContent="→",u=z(),a=T("main"),h&&h.c(),A(r,"class","svelte-1u7vg8a"),A(t,"class","sidebar-content content-container svelte-1u7vg8a"),A(l,"type","button"),A(l,"class","sidebar-toggle rounded-rect svelte-1u7vg8a"),A(e,"class",s=ur(n[0]?"":"collapsed")+" svelte-1u7vg8a"),A(a,"class","svelte-1u7vg8a")},m(p,v){M(p,e,v),S(e,t),S(t,r),m&&m.m(r,null),S(t,i),k&&k.m(t,null),S(e,o),S(e,l),M(p,u,v),M(p,a,v),h&&h.m(a,null),c=!0,g||(d=X(l,"click",n[1]),g=!0)},p(p,[v]){m&&m.p&&(!c||v&4)&&Ae(m,f,p,p[2],c?Ne(f,p[2],v,fl):Oe(p[2]),Jr),k&&k.p&&(!c||v&4)&&Ae(k,b,p,p[2],c?Ne(b,p[2],v,ul):Oe(p[2]),Xr),(!c||v&1&&s!==(s=ur(p[0]?"":"collapsed")+" svelte-1u7vg8a"))&&A(e,"class",s),h&&h.p&&(!c||v&4)&&Ae(h,C,p,p[2],c?Ne(C,p[2],v,al):Oe(p[2]),Yr)},i(p){c||(I(m,p),I(k,p),I(h,p),c=!0)},o(p){D(m,p),D(k,p),D(h,p),c=!1},d(p){p&&P(e),m&&m.d(p),k&&k.d(p),p&&P(u),p&&P(a),h&&h.d(p),g=!1,d()}}}function dl(n,e,t){let{$$slots:r={},$$scope:i}=e,o=!0;function l(){t(0,o=!o)}return n.$$set=s=>{"$$scope"in s&&t(2,i=s.$$scope)},[o,l,i,r]}class hl extends oe{constructor(e){super(),le(this,e,dl,cl,se,{})}}var _e=63710088e-1,Kn={centimeters:_e*100,centimetres:_e*100,degrees:_e/111325,feet:_e*3.28084,inches:_e*39.37,kilometers:_e/1e3,kilometres:_e/1e3,meters:_e,metres:_e,miles:_e/1609.344,millimeters:_e*1e3,millimetres:_e*1e3,nauticalmiles:_e/1852,radians:1,yards:_e*1.0936},pl={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/_e,yards:1.0936133},Mn={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Be(n,e,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=n,r}function ml(n,e,t){switch(n){case"Point":return we(e).geometry;case"LineString":return ke(e).geometry;case"Polygon":return dn(e).geometry;case"MultiPoint":return Pi(e).geometry;case"MultiLineString":return Mi(e).geometry;case"MultiPolygon":return $n(e).geometry;default:throw new Error(n+" is invalid")}}function we(n,e,t){if(t===void 0&&(t={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!tn(n[0])||!tn(n[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:n};return Be(r,e,t)}function gl(n,e,t){return t===void 0&&(t={}),Ie(n.map(function(r){return we(r,e)}),t)}function dn(n,e,t){t===void 0&&(t={});for(var r=0,i=n;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<o[o.length-1].length;l++)if(o[o.length-1][l]!==o[0][l])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:n};return Be(s,e,t)}function vl(n,e,t){return t===void 0&&(t={}),Ie(n.map(function(r){return dn(r,e)}),t)}function ke(n,e,t){if(t===void 0&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:n};return Be(r,e,t)}function bl(n,e,t){return t===void 0&&(t={}),Ie(n.map(function(r){return ke(r,e)}),t)}function Ie(n,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=n,t}function Mi(n,e,t){t===void 0&&(t={});var r={type:"MultiLineString",coordinates:n};return Be(r,e,t)}function Pi(n,e,t){t===void 0&&(t={});var r={type:"MultiPoint",coordinates:n};return Be(r,e,t)}function $n(n,e,t){t===void 0&&(t={});var r={type:"MultiPolygon",coordinates:n};return Be(r,e,t)}function _l(n,e,t){t===void 0&&(t={});var r={type:"GeometryCollection",geometries:n};return Be(r,e,t)}function yl(n,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var t=Math.pow(10,e||0);return Math.round(n*t)/t}function er(n,e){e===void 0&&(e="kilometers");var t=Kn[e];if(!t)throw new Error(e+" units is invalid");return n*t}function hn(n,e){e===void 0&&(e="kilometers");var t=Kn[e];if(!t)throw new Error(e+" units is invalid");return n/t}function wl(n,e){return Nt(hn(n,e))}function kl(n){var e=n%360;return e<0&&(e+=360),e}function Nt(n){var e=n%(2*Math.PI);return e*180/Math.PI}function Ce(n){var e=n%360;return e*Math.PI/180}function Sl(n,e,t){if(e===void 0&&(e="kilometers"),t===void 0&&(t="kilometers"),!(n>=0))throw new Error("length must be a positive number");return er(hn(n,e),t)}function El(n,e,t){if(e===void 0&&(e="meters"),t===void 0&&(t="kilometers"),!(n>=0))throw new Error("area must be a positive number");var r=Mn[e];if(!r)throw new Error("invalid original units");var i=Mn[t];if(!i)throw new Error("invalid final units");return n/r*i}function tn(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function tr(n){return!!n&&n.constructor===Object}function Ml(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(e){if(!tn(e))throw new Error("bbox must only contain numbers")})}function Pl(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")}const xl=Object.freeze(Object.defineProperty({__proto__:null,earthRadius:_e,factors:Kn,unitsFactors:pl,areaFactors:Mn,feature:Be,geometry:ml,point:we,points:gl,polygon:dn,polygons:vl,lineString:ke,lineStrings:bl,featureCollection:Ie,multiLineString:Mi,multiPoint:Pi,multiPolygon:$n,geometryCollection:_l,round:yl,radiansToLength:er,lengthToRadians:hn,lengthToDegrees:wl,bearingToAzimuth:kl,radiansToDegrees:Nt,degreesToRadians:Ce,convertLength:Sl,convertArea:El,isNumber:tn,isObject:tr,validateBBox:Ml,validateId:Pl},Symbol.toStringTag,{value:"Module"}));/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Ll(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(a){return function(c){return u([a,c])}}function u(a){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return t.label++,{value:a[1],done:!1};case 5:t.label++,i=a[1],a=[0];continue;case 7:a=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){t.label=a[1];break}if(a[0]===6&&t.label<o[1]){t.label=o[1],o=a;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(a);break}o[2]&&t.ops.pop(),t.trys.pop();continue}a=e.call(n,t)}catch(c){a=[6,c],i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}var at=function(){function n(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return n}();function Tl(n,e){return n>e?1:n<e?-1:0}function rt(n,e,t){for(var r=new at(null,null),i=r,o=r;;){var l=t(n,e.key);if(l<0){if(e.left===null)break;if(t(n,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}o.left=e,o=e,e=e.left}else if(l>0){if(e.right===null)break;if(t(n,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,o.left=e.right,e.left=r.right,e.right=r.left,e}function bn(n,e,t,r){var i=new at(n,e);if(t===null)return i.left=i.right=null,i;t=rt(n,t,r);var o=r(n,t.key);return o<0?(i.left=t.left,i.right=t,t.left=null):o>=0&&(i.right=t.right,i.left=t,t.right=null),i}function Ur(n,e,t){var r=null,i=null;if(e){e=rt(n,e,t);var o=t(e.key,n);o===0?(r=e.left,i=e.right):o<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function Cl(n,e,t){return e===null?n:(n===null||(e=rt(n.key,e,t),e.left=n),e)}function Pn(n,e,t,r,i){if(n){r(""+e+(t?"└── ":"├── ")+i(n)+`
`);var o=e+(t?"    ":"│   ");n.left&&Pn(n.left,o,!1,r,i),n.right&&Pn(n.right,o,!0,r,i)}}var nr=function(){function n(e){e===void 0&&(e=Tl),this._root=null,this._size=0,this._comparator=e}return n.prototype.insert=function(e,t){return this._size++,this._root=bn(e,t,this._root,this._comparator)},n.prototype.add=function(e,t){var r=new at(e,t);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,o=rt(e,this._root,i),l=i(e,o.key);return l===0?this._root=o:(l<0?(r.left=o.left,r.right=o,o.left=null):l>0&&(r.right=o.right,r.left=o,o.right=null),this._size++,this._root=r),this._root},n.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},n.prototype._remove=function(e,t,r){var i;if(t===null)return null;t=rt(e,t,r);var o=r(e,t.key);return o===0?(t.left===null?i=t.right:(i=rt(e,t.left,r),i.right=t.right),this._size--,i):t},n.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=rt(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},n.prototype.findStatic=function(e){for(var t=this._root,r=this._comparator;t;){var i=r(e,t.key);if(i===0)return t;i<0?t=t.left:t=t.right}return null},n.prototype.find=function(e){return this._root&&(this._root=rt(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},n.prototype.contains=function(e){for(var t=this._root,r=this._comparator;t;){var i=r(e,t.key);if(i===0)return!0;i<0?t=t.left:t=t.right}return!1},n.prototype.forEach=function(e,t){for(var r=this._root,i=[],o=!1;!o;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),e.call(t,r),r=r.right):o=!0;return this},n.prototype.range=function(e,t,r,i){for(var o=[],l=this._comparator,s=this._root,u;o.length!==0||s;)if(s)o.push(s),s=s.left;else{if(s=o.pop(),u=l(s.key,t),u>0)break;if(l(s.key,e)>=0&&r.call(i,s))return this;s=s.right}return this},n.prototype.keys=function(){var e=[];return this.forEach(function(t){var r=t.key;return e.push(r)}),e},n.prototype.values=function(){var e=[];return this.forEach(function(t){var r=t.data;return e.push(r)}),e},n.prototype.min=function(){return this._root?this.minNode(this._root).key:null},n.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},n.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},n.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},n.prototype.at=function(e){for(var t=this._root,r=!1,i=0,o=[];!r;)if(t)o.push(t),t=t.left;else if(o.length>0){if(t=o.pop(),i===e)return t;i++,t=t.right}else r=!0;return null},n.prototype.next=function(e){var t=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var i=this._comparator;t;){var o=i(e.key,t.key);if(o===0)break;o<0?(r=t,t=t.left):t=t.right}return r},n.prototype.prev=function(e){var t=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var i=this._comparator;t;){var o=i(e.key,t.key);if(o===0)break;o<0?t=t.left:(r=t,t=t.right)}return r},n.prototype.clear=function(){return this._root=null,this._size=0,this},n.prototype.toList=function(){return Al(this._root)},n.prototype.load=function(e,t,r){t===void 0&&(t=[]),r===void 0&&(r=!1);var i=e.length,o=this._comparator;if(r&&Tn(e,t,0,i-1,o),this._root===null)this._root=xn(e,t,0,i),this._size=i;else{var l=Ol(this.toList(),Rl(e,t),o);i=this._size+i,this._root=Ln({head:l},0,i)}return this},n.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var t=[];return Pn(this._root,"",!0,function(r){return t.push(r)},e),t.join("")},n.prototype.update=function(e,t,r){var i=this._comparator,o=Ur(e,this._root,i),l=o.left,s=o.right;i(e,t)<0?s=bn(t,r,s,i):l=bn(t,r,l,i),this._root=Cl(l,s,i)},n.prototype.split=function(e){return Ur(e,this._root,this._comparator)},n.prototype[Symbol.iterator]=function(){var e;return Ll(this,function(t){switch(t.label){case 0:e=this.minNode(),t.label=1;case 1:return e?[4,e]:[3,3];case 2:return t.sent(),e=this.next(e),[3,1];case 3:return[2]}})},n}();function xn(n,e,t,r){var i=r-t;if(i>0){var o=t+Math.floor(i/2),l=n[o],s=e[o],u=new at(l,s);return u.left=xn(n,e,t,o),u.right=xn(n,e,o+1,r),u}return null}function Rl(n,e){for(var t=new at(null,null),r=t,i=0;i<n.length;i++)r=r.next=new at(n[i],e[i]);return r.next=null,t.next}function Al(n){for(var e=n,t=[],r=!1,i=new at(null,null),o=i;!r;)e?(t.push(e),e=e.left):t.length>0?(e=o=o.next=t.pop(),e=e.right):r=!0;return o.next=null,i.next}function Ln(n,e,t){var r=t-e;if(r>0){var i=e+Math.floor(r/2),o=Ln(n,e,i),l=n.head;return l.left=o,n.head=n.head.next,l.right=Ln(n,i+1,t),l}return null}function Ol(n,e,t){for(var r=new at(null,null),i=r,o=n,l=e;o!==null&&l!==null;)t(o.key,l.key)<0?(i.next=o,o=o.next):(i.next=l,l=l.next),i=i.next;return o!==null?i.next=o:l!==null&&(i.next=l),r.next}function Tn(n,e,t,r,i){if(!(t>=r)){for(var o=n[t+r>>1],l=t-1,s=r+1;;){do l++;while(i(n[l],o)<0);do s--;while(i(n[s],o)>0);if(l>=s)break;var u=n[l];n[l]=n[s],n[s]=u,u=e[l],e[l]=e[s],e[s]=u}Tn(n,e,t,s,i),Tn(n,e,s+1,r,i)}}function ze(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function jr(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Se(n,e,t){return e&&jr(n.prototype,e),t&&jr(n,t),n}var Tt=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},Cn=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,i=e.ur.x<t.ur.x?e.ur.x:t.ur.x,o=e.ll.y<t.ll.y?t.ll.y:e.ll.y,l=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:r,y:o},ur:{x:i,y:l}}},ot=Number.EPSILON;ot===void 0&&(ot=Math.pow(2,-52));var Nl=ot*ot,Rn=function(e,t){if(-ot<e&&e<ot&&-ot<t&&t<ot)return 0;var r=e-t;return r*r<Nl*e*t?0:e<t?-1:1},Fl=function(){function n(){ze(this,n),this.reset()}return Se(n,[{key:"reset",value:function(){this.xRounder=new Wr,this.yRounder=new Wr}},{key:"round",value:function(t,r){return{x:this.xRounder.round(t),y:this.yRounder.round(r)}}}]),n}(),Wr=function(){function n(){ze(this,n),this.tree=new nr,this.round(0)}return Se(n,[{key:"round",value:function(t){var r=this.tree.add(t),i=this.tree.prev(r);if(i!==null&&Rn(r.key,i.key)===0)return this.tree.remove(t),i.key;var o=this.tree.next(r);return o!==null&&Rn(r.key,o.key)===0?(this.tree.remove(t),o.key):t}}]),n}(),Ft=new Fl,Rt=function(e,t){return e.x*t.y-e.y*t.x},xi=function(e,t){return e.x*t.x+e.y*t.y},Hr=function(e,t,r){var i={x:t.x-e.x,y:t.y-e.y},o={x:r.x-e.x,y:r.y-e.y},l=Rt(i,o);return Rn(l,0)},nn=function(e){return Math.sqrt(xi(e,e))},Il=function(e,t,r){var i={x:t.x-e.x,y:t.y-e.y},o={x:r.x-e.x,y:r.y-e.y};return Rt(o,i)/nn(o)/nn(i)},Bl=function(e,t,r){var i={x:t.x-e.x,y:t.y-e.y},o={x:r.x-e.x,y:r.y-e.y};return xi(o,i)/nn(o)/nn(i)},Vr=function(e,t,r){return t.y===0?null:{x:e.x+t.x/t.y*(r-e.y),y:r}},Zr=function(e,t,r){return t.x===0?null:{x:r,y:e.y+t.y/t.x*(r-e.x)}},zl=function(e,t,r,i){if(t.x===0)return Zr(r,i,e.x);if(i.x===0)return Zr(e,t,r.x);if(t.y===0)return Vr(r,i,e.y);if(i.y===0)return Vr(e,t,r.y);var o=Rt(t,i);if(o==0)return null;var l={x:r.x-e.x,y:r.y-e.y},s=Rt(l,t)/o,u=Rt(l,i)/o,a=e.x+u*t.x,c=r.x+s*i.x,g=e.y+u*t.y,d=r.y+s*i.y,f=(a+c)/2,m=(g+d)/2;return{x:f,y:m}},je=function(){Se(n,null,[{key:"compare",value:function(t,r){var i=n.comparePoints(t.point,r.point);return i!==0?i:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:rn.compare(t.segment,r.segment))}},{key:"comparePoints",value:function(t,r){return t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0}}]);function n(e,t){ze(this,n),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}return Se(n,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var r=t.point.events,i=0,o=r.length;i<o;i++){var l=r[i];this.point.events.push(l),l.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,r=0;r<t;r++){var i=this.point.events[r];if(i.segment.consumedBy===void 0)for(var o=r+1;o<t;o++){var l=this.point.events[o];l.consumedBy===void 0&&i.otherSE.point.events===l.otherSE.point.events&&i.segment.consume(l.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],r=0,i=this.point.events.length;r<i;r++){var o=this.point.events[r];o!==this&&!o.segment.ringOut&&o.segment.isInResult()&&t.push(o)}return t}},{key:"getLeftmostComparator",value:function(t){var r=this,i=new Map,o=function(s){var u=s.otherSE;i.set(s,{sine:Il(r.point,t.point,u.point),cosine:Bl(r.point,t.point,u.point)})};return function(l,s){i.has(l)||o(l),i.has(s)||o(s);var u=i.get(l),a=u.sine,c=u.cosine,g=i.get(s),d=g.sine,f=g.cosine;return a>=0&&d>=0?c<f?1:c>f?-1:0:a<0&&d<0?c<f?-1:c>f?1:0:d<a?-1:d>a?1:0}}}]),n}(),Gl=0,rn=function(){Se(n,null,[{key:"compare",value:function(t,r){var i=t.leftSE.point.x,o=r.leftSE.point.x,l=t.rightSE.point.x,s=r.rightSE.point.x;if(s<i)return 1;if(l<o)return-1;var u=t.leftSE.point.y,a=r.leftSE.point.y,c=t.rightSE.point.y,g=r.rightSE.point.y;if(i<o){if(a<u&&a<c)return 1;if(a>u&&a>c)return-1;var d=t.comparePoint(r.leftSE.point);if(d<0)return 1;if(d>0)return-1;var f=r.comparePoint(t.rightSE.point);return f!==0?f:-1}if(i>o){if(u<a&&u<g)return-1;if(u>a&&u>g)return 1;var m=r.comparePoint(t.leftSE.point);if(m!==0)return m;var b=t.comparePoint(r.rightSE.point);return b<0?1:b>0?-1:1}if(u<a)return-1;if(u>a)return 1;if(l<s){var k=r.comparePoint(t.rightSE.point);if(k!==0)return k}if(l>s){var C=t.comparePoint(r.rightSE.point);if(C<0)return 1;if(C>0)return-1}if(l!==s){var h=c-u,p=l-i,v=g-a,w=s-o;if(h>p&&v<w)return 1;if(h<p&&v>w)return-1}return l>s?1:l<s||c<g?-1:c>g?1:t.id<r.id?-1:t.id>r.id?1:0}}]);function n(e,t,r,i){ze(this,n),this.id=++Gl,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=r,this.windings=i}return Se(n,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<r?t:r},ur:{x:this.rightSE.point.x,y:t>r?t:r}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var r=this.leftSE.point,i=this.rightSE.point,o=this.vector();if(r.x===i.x)return t.x===r.x?0:t.x<r.x?1:-1;var l=(t.y-r.y)/o.y,s=r.x+l*o.x;if(t.x===s)return 0;var u=(t.x-r.x)/o.x,a=r.y+u*o.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var r=this.bbox(),i=t.bbox(),o=Cn(r,i);if(o===null)return null;var l=this.leftSE.point,s=this.rightSE.point,u=t.leftSE.point,a=t.rightSE.point,c=Tt(r,u)&&this.comparePoint(u)===0,g=Tt(i,l)&&t.comparePoint(l)===0,d=Tt(r,a)&&this.comparePoint(a)===0,f=Tt(i,s)&&t.comparePoint(s)===0;if(g&&c)return f&&!d?s:!f&&d?a:null;if(g)return d&&l.x===a.x&&l.y===a.y?null:l;if(c)return f&&s.x===u.x&&s.y===u.y?null:u;if(f&&d)return null;if(f)return s;if(d)return a;var m=zl(l,this.vector(),u,t.vector());return m===null||!Tt(o,m)?null:Ft.round(m.x,m.y)}},{key:"split",value:function(t){var r=[],i=t.events!==void 0,o=new je(t,!0),l=new je(t,!1),s=this.rightSE;this.replaceRightSE(l),r.push(l),r.push(o);var u=new n(o,s,this.rings.slice(),this.windings.slice());return je.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),je.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(o.checkForConsuming(),l.checkForConsuming()),r}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var r=0,i=this.windings.length;r<i;r++)this.windings[r]*=-1}},{key:"consume",value:function(t){for(var r=this,i=t;r.consumedBy;)r=r.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var o=n.compare(r,i);if(o!==0){if(o>0){var l=r;r=i,i=l}if(r.prev===i){var s=r;r=i,i=s}for(var u=0,a=i.rings.length;u<a;u++){var c=i.rings[u],g=i.windings[u],d=r.rings.indexOf(c);d===-1?(r.rings.push(c),r.windings.push(g)):r.windings[d]+=g}i.rings=null,i.windings=null,i.consumedBy=r,i.leftSE.consumedBy=r.leftSE,i.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var r=this._afterState.rings,i=this._afterState.windings,o=this._afterState.multiPolys,l=0,s=this.rings.length;l<s;l++){var u=this.rings[l],a=this.windings[l],c=r.indexOf(u);c===-1?(r.push(u),i.push(a)):i[c]+=a}for(var g=[],d=[],f=0,m=r.length;f<m;f++)if(i[f]!==0){var b=r[f],k=b.poly;if(d.indexOf(k)===-1)if(b.isExterior)g.push(k);else{d.indexOf(k)===-1&&d.push(k);var C=g.indexOf(b.poly);C!==-1&&g.splice(C,1)}}for(var h=0,p=g.length;h<p;h++){var v=g[h].multiPoly;o.indexOf(v)===-1&&o.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var t=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(qe.type){case"union":{var i=t.length===0,o=r.length===0;this._isInResult=i!==o;break}case"intersection":{var l,s;t.length<r.length?(l=t.length,s=r.length):(l=r.length,s=t.length),this._isInResult=s===qe.numMultiPolys&&l<s;break}case"xor":{var u=Math.abs(t.length-r.length);this._isInResult=u%2===1;break}case"difference":{var a=function(g){return g.length===1&&g[0].isSubject};this._isInResult=a(t)!==a(r);break}default:throw new Error("Unrecognized operation type found ".concat(qe.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,r,i){var o,l,s,u=je.comparePoints(t,r);if(u<0)o=t,l=r,s=1;else if(u>0)o=r,l=t,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));var a=new je(o,!0),c=new je(l,!1);return new n(a,c,[i],[s])}}]),n}(),Qr=function(){function n(e,t,r){if(ze(this,n),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=Ft.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var o=i,l=1,s=e.length;l<s;l++){if(typeof e[l][0]!="number"||typeof e[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=Ft.round(e[l][0],e[l][1]);u.x===o.x&&u.y===o.y||(this.segments.push(rn.fromRing(o,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),o=u)}(i.x!==o.x||i.y!==o.y)&&this.segments.push(rn.fromRing(o,i,this))}return Se(n,[{key:"getSweepEvents",value:function(){for(var t=[],r=0,i=this.segments.length;r<i;r++){var o=this.segments[r];t.push(o.leftSE),t.push(o.rightSE)}return t}}]),n}(),ql=function(){function n(e,t){if(ze(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Qr(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,i=e.length;r<i;r++){var o=new Qr(e[r],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=t}return Se(n,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),r=0,i=this.interiorRings.length;r<i;r++)for(var o=this.interiorRings[r].getSweepEvents(),l=0,s=o.length;l<s;l++)t.push(o[l]);return t}}]),n}(),Kr=function(){function n(e,t){if(ze(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,i=e.length;r<i;r++){var o=new ql(e[r],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=t}return Se(n,[{key:"getSweepEvents",value:function(){for(var t=[],r=0,i=this.polys.length;r<i;r++)for(var o=this.polys[r].getSweepEvents(),l=0,s=o.length;l<s;l++)t.push(o[l]);return t}}]),n}(),Dl=function(){Se(n,null,[{key:"factory",value:function(t){for(var r=[],i=0,o=t.length;i<o;i++){var l=t[i];if(!(!l.isInResult()||l.ringOut)){for(var s=null,u=l.leftSE,a=l.rightSE,c=[u],g=u.point,d=[];s=u,u=a,c.push(u),u.point!==g;)for(;;){var f=u.getAvailableLinkedEvents();if(f.length===0){var m=c[0].point,b=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(m.x,",")+" ".concat(m.y,"]. Last matching segment found ends at")+" [".concat(b.x,", ").concat(b.y,"]."))}if(f.length===1){a=f[0].otherSE;break}for(var k=null,C=0,h=d.length;C<h;C++)if(d[C].point===u.point){k=C;break}if(k!==null){var p=d.splice(k)[0],v=c.splice(p.index);v.unshift(v[0].otherSE),r.push(new n(v.reverse()));continue}d.push({index:c.length,point:u.point});var w=u.getLeftmostComparator(s);a=f.sort(w)[0].otherSE;break}r.push(new n(c))}}return r}}]);function n(e){ze(this,n),this.events=e;for(var t=0,r=e.length;t<r;t++)e[t].segment.ringOut=this;this.poly=null}return Se(n,[{key:"getGeom",value:function(){for(var t=this.events[0].point,r=[t],i=1,o=this.events.length-1;i<o;i++){var l=this.events[i].point,s=this.events[i+1].point;Hr(l,t,s)!==0&&(r.push(l),t=l)}if(r.length===1)return null;var u=r[0],a=r[1];Hr(u,t,a)===0&&r.shift(),r.push(r[0]);for(var c=this.isExteriorRing()?1:-1,g=this.isExteriorRing()?0:r.length-1,d=this.isExteriorRing()?r.length:-1,f=[],m=g;m!=d;m+=c)f.push([r[m].x,r[m].y]);return f}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],r=1,i=this.events.length;r<i;r++){var o=this.events[r];je.compare(t,o)>0&&(t=o)}for(var l=t.segment.prevInResult(),s=l?l.prevInResult():null;;){if(!l)return null;if(!s)return l.ringOut;if(s.ringOut!==l.ringOut)return s.ringOut.enclosingRing()!==l.ringOut?l.ringOut:l.ringOut.enclosingRing();l=s.prevInResult(),s=l?l.prevInResult():null}}}]),n}(),$r=function(){function n(e){ze(this,n),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return Se(n,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(var r=0,i=this.interiorRings.length;r<i;r++){var o=this.interiorRings[r].getGeom();o!==null&&t.push(o)}return t}}]),n}(),Yl=function(){function n(e){ze(this,n),this.rings=e,this.polys=this._composePolys(e)}return Se(n,[{key:"getGeom",value:function(){for(var t=[],r=0,i=this.polys.length;r<i;r++){var o=this.polys[r].getGeom();o!==null&&t.push(o)}return t}},{key:"_composePolys",value:function(t){for(var r=[],i=0,o=t.length;i<o;i++){var l=t[i];if(!l.poly)if(l.isExteriorRing())r.push(new $r(l));else{var s=l.enclosingRing();s.poly||r.push(new $r(s)),s.poly.addInterior(l)}}return r}}]),n}(),Xl=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rn.compare;ze(this,n),this.queue=e,this.tree=new nr(t),this.segments=[]}return Se(n,[{key:"process",value:function(t){var r=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(r),i;var o=t.isLeft?this.tree.insert(r):this.tree.find(r);if(!o)throw new Error("Unable to find segment #".concat(r.id," ")+"[".concat(r.leftSE.point.x,", ").concat(r.leftSE.point.y,"] -> ")+"[".concat(r.rightSE.point.x,", ").concat(r.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var l=o,s=o,u=void 0,a=void 0;u===void 0;)l=this.tree.prev(l),l===null?u=null:l.key.consumedBy===void 0&&(u=l.key);for(;a===void 0;)s=this.tree.next(s),s===null?a=null:s.key.consumedBy===void 0&&(a=s.key);if(t.isLeft){var c=null;if(u){var g=u.getIntersection(r);if(g!==null&&(r.isAnEndpoint(g)||(c=g),!u.isAnEndpoint(g)))for(var d=this._splitSafely(u,g),f=0,m=d.length;f<m;f++)i.push(d[f])}var b=null;if(a){var k=a.getIntersection(r);if(k!==null&&(r.isAnEndpoint(k)||(b=k),!a.isAnEndpoint(k)))for(var C=this._splitSafely(a,k),h=0,p=C.length;h<p;h++)i.push(C[h])}if(c!==null||b!==null){var v=null;if(c===null)v=b;else if(b===null)v=c;else{var w=je.comparePoints(c,b);v=w<=0?c:b}this.queue.remove(r.rightSE),i.push(r.rightSE);for(var _=r.split(v),O=0,x=_.length;O<x;O++)i.push(_[O])}i.length>0?(this.tree.remove(r),i.push(t)):(this.segments.push(r),r.prev=u)}else{if(u&&a){var F=u.getIntersection(a);if(F!==null){if(!u.isAnEndpoint(F))for(var q=this._splitSafely(u,F),E=0,B=q.length;E<B;E++)i.push(q[E]);if(!a.isAnEndpoint(F))for(var N=this._splitSafely(a,F),R=0,G=N.length;R<G;R++)i.push(N[R])}}this.tree.remove(r)}return i}},{key:"_splitSafely",value:function(t,r){this.tree.remove(t);var i=t.rightSE;this.queue.remove(i);var o=t.split(r);return o.push(i),t.consumedBy===void 0&&this.tree.insert(t),o}}]),n}(),ei=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Jl=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Ul=function(){function n(){ze(this,n)}return Se(n,[{key:"run",value:function(t,r,i){qe.type=t,Ft.reset();for(var o=[new Kr(r,!0)],l=0,s=i.length;l<s;l++)o.push(new Kr(i[l],!1));if(qe.numMultiPolys=o.length,qe.type==="difference")for(var u=o[0],a=1;a<o.length;)Cn(o[a].bbox,u.bbox)!==null?a++:o.splice(a,1);if(qe.type==="intersection"){for(var c=0,g=o.length;c<g;c++)for(var d=o[c],f=c+1,m=o.length;f<m;f++)if(Cn(d.bbox,o[f].bbox)===null)return[]}for(var b=new nr(je.compare),k=0,C=o.length;k<C;k++)for(var h=o[k].getSweepEvents(),p=0,v=h.length;p<v;p++)if(b.insert(h[p]),b.size>ei)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new Xl(b),_=b.size,O=b.pop();O;){var x=O.key;if(b.size===_){var F=x.segment;throw new Error("Unable to pop() ".concat(x.isLeft?"left":"right"," SweepEvent ")+"[".concat(x.point.x,", ").concat(x.point.y,"] from segment #").concat(F.id," ")+"[".concat(F.leftSE.point.x,", ").concat(F.leftSE.point.y,"] -> ")+"[".concat(F.rightSE.point.x,", ").concat(F.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(b.size>ei)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>Jl)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var q=w.process(x),E=0,B=q.length;E<B;E++){var N=q[E];N.consumedBy===void 0&&b.insert(N)}_=b.size,O=b.pop()}Ft.reset();var R=Dl.factory(w.segments),G=new Yl(R);return G.getGeom()}}]),n}(),qe=new Ul,jl=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return qe.run("union",e,r)},Wl=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return qe.run("intersection",e,r)},Hl=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return qe.run("xor",e,r)},Vl=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return qe.run("difference",e,r)},Wt={union:jl,intersection:Wl,xor:Hl,difference:Vl};function Zl(n,e){var t=Kl(e),r=null;return n.type==="FeatureCollection"?r=Ql(n):r=Li(Wt.union(n.geometry.coordinates)),r.geometry.coordinates.forEach(function(i){t.geometry.coordinates.push(i[0])}),t}function Ql(n){var e=n.features.length===2?Wt.union(n.features[0].geometry.coordinates,n.features[1].geometry.coordinates):Wt.union.apply(Wt,n.features.map(function(t){return t.geometry.coordinates}));return Li(e)}function Li(n){return $n(n)}function Kl(n){var e=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],t=n&&n.geometry.coordinates||e;return dn(t)}function $l(n,e,t){let r;ce(n,Ze,l=>t(1,r=l));let{boundaryGeojson:i}=e;return Jn("setCamera")&&r.fitBounds(jn(i),{padding:20,animate:!1}),Pt(r,"boundary",{type:"geojson",data:Zl(i)}),Te(r,{id:"boundary",source:"boundary",...Qn("black",.5)}),n.$$set=l=>{"boundaryGeojson"in l&&t(0,i=l.boundaryGeojson)},[i]}class es extends oe{constructor(e){super(),le(this,e,$l,null,se,{boundaryGeojson:0})}}function ts(n){let e,t,r,i,o,l,s,u;return e=new Jt({props:{labelText:"Area",value:"area"}}),r=new Jt({props:{labelText:"Route",value:"route"}}),o=new Jt({props:{labelText:"Crossing",value:"crossing"}}),s=new Jt({props:{labelText:"Other",value:"other"}}),{c(){H(e.$$.fragment),t=z(),H(r.$$.fragment),i=z(),H(o.$$.fragment),l=z(),H(s.$$.fragment)},m(a,c){V(e,a,c),M(a,t,c),V(r,a,c),M(a,i,c),V(o,a,c),M(a,l,c),V(s,a,c),u=!0},p:ne,i(a){u||(I(e.$$.fragment,a),I(r.$$.fragment,a),I(o.$$.fragment,a),I(s.$$.fragment,a),u=!0)},o(a){D(e.$$.fragment,a),D(r.$$.fragment,a),D(o.$$.fragment,a),D(s.$$.fragment,a),u=!1},d(a){Z(e,a),a&&P(t),Z(r,a),a&&P(i),Z(o,a),a&&P(l),Z(s,a)}}}function ti(n){let e,t,r=ni(n[4])+"",i,o,l;return{c(){e=T("p"),t=j("Length: "),i=j(r),o=z(),l=T("br")},m(s,u){M(s,e,u),S(e,t),S(e,i),M(s,o,u),M(s,l,u)},p(s,u){u&16&&r!==(r=ni(s[4])+"")&&pe(i,r)},d(s){s&&P(e),s&&P(o),s&&P(l)}}}function ns(n){let e,t,r,i,o,l,s,u,a,c,g,d,f,m,b,k,C,h,p,v,w,_,O;function x(G){n[5](G)}let F={labelText:"Name"};n[0]!==void 0&&(F.value=n[0]),e=new Ho({props:F}),ue.push(()=>De(e,"value",x,n[0]));function q(G){n[6](G)}let E={$$slots:{default:[ts]},$$scope:{ctx:n}};n[1]!==void 0&&(E.selected=n[1]),l=new No({props:E}),ue.push(()=>De(l,"selected",q,n[1]));function B(G){n[7](G)}let N={labelText:"Description"};n[2]!==void 0&&(N.value=n[2]),g=new qo({props:N}),ue.push(()=>De(g,"value",B,n[2]));let R=n[4]&&ti(n);return{c(){H(e.$$.fragment),r=z(),i=T("br"),o=z(),H(l.$$.fragment),u=z(),a=T("br"),c=z(),H(g.$$.fragment),f=z(),m=T("br"),b=z(),R&&R.c(),k=z(),C=T("div"),h=T("button"),h.textContent="Delete",p=z(),v=T("button"),v.textContent="Save",A(h,"type","button"),A(v,"type","button"),Ct(v,"float","right")},m(G,J){V(e,G,J),M(G,r,J),M(G,i,J),M(G,o,J),V(l,G,J),M(G,u,J),M(G,a,J),M(G,c,J),V(g,G,J),M(G,f,J),M(G,m,J),M(G,b,J),R&&R.m(G,J),M(G,k,J),M(G,C,J),S(C,h),S(C,p),S(C,v),w=!0,_||(O=[X(h,"click",n[8]),X(v,"click",n[9])],_=!0)},p(G,[J]){const te={};!t&&J&1&&(t=!0,te.value=G[0],Ye(()=>t=!1)),e.$set(te);const $={};J&1024&&($.$$scope={dirty:J,ctx:G}),!s&&J&2&&(s=!0,$.selected=G[1],Ye(()=>s=!1)),l.$set($);const ee={};!d&&J&4&&(d=!0,ee.value=G[2],Ye(()=>d=!1)),g.$set(ee),G[4]?R?R.p(G,J):(R=ti(G),R.c(),R.m(k.parentNode,k)):R&&(R.d(1),R=null)},i(G){w||(I(e.$$.fragment,G),I(l.$$.fragment,G),I(g.$$.fragment,G),w=!0)},o(G){D(e.$$.fragment,G),D(l.$$.fragment,G),D(g.$$.fragment,G),w=!1},d(G){Z(e,G),G&&P(r),G&&P(i),G&&P(o),Z(l,G),G&&P(u),G&&P(a),G&&P(c),Z(g,G),G&&P(f),G&&P(m),G&&P(b),R&&R.d(G),G&&P(k),G&&P(C),_=!1,Je(O)}}}function ni(n){return n<1e3?Math.round(n)+" m":(n/1e3).toFixed(1)+"km"}function rs(n,e,t){let{id:r}=e,{name:i}=e,{intervention_type:o}=e,{description:l}=e,{length_meters:s}=e;function u(f){i=f,t(0,i)}function a(f){o=f,t(1,o)}function c(f){l=f,t(2,l)}const g=()=>Ei(r),d=()=>Fe.set(null);return n.$$set=f=>{"id"in f&&t(3,r=f.id),"name"in f&&t(0,i=f.name),"intervention_type"in f&&t(1,o=f.intervention_type),"description"in f&&t(2,l=f.description),"length_meters"in f&&t(4,s=f.length_meters)},[i,o,l,r,s,u,a,c,g,d]}class is extends oe{constructor(e){super(),le(this,e,rs,ns,se,{id:3,name:0,intervention_type:1,description:2,length_meters:4})}}function ri(n){let e,t,r,i,o;const l=n[10].default,s=Re(l,n,n[9],null);return{c(){e=T("div"),s&&s.c()},m(u,a){M(u,e,a),s&&s.m(e,null),n[13](e),r=!0,i||(o=X(e,"introend",n[14]),i=!0)},p(u,a){s&&s.p&&(!r||a&512)&&Ae(s,l,u,u[9],r?Ne(l,u[9],a,null):Oe(u[9]),null)},i(u){r||(I(s,u),ki(()=>{t||(t=fr(e,gr,{duration:100},!0)),t.run(1)}),r=!0)},o(u){D(s,u),t||(t=fr(e,gr,{duration:100},!1)),t.run(0),r=!1},d(u){u&&P(e),s&&s.d(u),n[13](null),u&&t&&t.end(),i=!1,o()}}}function os(n){let e,t,r,i,o,l,s,u,a,c,g=n[4]&&ri(n);return{c(){e=T("button"),t=Le("svg"),r=Le("path"),i=z(),o=j(n[1]),l=z(),g&&g.c(),s=ct(),A(r,"d","M9 5l7 7-7 7"),A(t,"style","tran"),A(t,"width","20"),A(t,"height","20"),A(t,"fill","none"),A(t,"stroke-linecap","round"),A(t,"stroke-linejoin","round"),A(t,"stroke-width","2"),A(t,"viewBox","0 0 24 24"),A(t,"stroke","currentColor"),A(t,"class","svelte-75u8ea"),A(e,"aria-expanded",n[4]),A(e,"class","svelte-75u8ea"),L(e,"underlined",n[3])},m(d,f){M(d,e,f),S(e,t),S(t,r),S(e,i),S(e,o),M(d,l,f),g&&g.m(d,f),M(d,s,f),u=!0,a||(c=[X(e,"click",n[5]),X(e,"mouseenter",n[11]),X(e,"mouseleave",n[12])],a=!0)},p(d,[f]){(!u||f&2)&&pe(o,d[1]),(!u||f&16)&&A(e,"aria-expanded",d[4]),(!u||f&8)&&L(e,"underlined",d[3]),d[4]?g?(g.p(d,f),f&16&&I(g,1)):(g=ri(d),g.c(),I(g,1),g.m(s.parentNode,s)):g&&(Me(),D(g,1,1,()=>{g=null}),Pe())},i(d){u||(I(g),u=!0)},o(d){D(g),u=!1},d(d){d&&P(e),d&&P(l),g&&g.d(d),d&&P(s),a=!1,Je(c)}}}function ls(n,e,t){let r,i,o,l;ce(n,$e,h=>t(7,o=h)),ce(n,Fe,h=>t(8,l=h));let{$$slots:s={},$$scope:u}=e,{id:a}=e,{label:c}=e;const g=()=>{Fe.update(h=>h==a?null:a),l==a&&(En.set(null),En.set(a))};let d;function f(){d==null||d.scrollIntoView({behavior:"smooth"})}const m=()=>en.set(a),b=()=>en.set(null);function k(h){ue[h?"unshift":"push"](()=>{d=h,t(2,d)})}const C=()=>f();return n.$$set=h=>{"id"in h&&t(0,a=h.id),"label"in h&&t(1,c=h.label),"$$scope"in h&&t(9,u=h.$$scope)},n.$$.update=()=>{n.$$.dirty&257&&t(4,r=l==a),n.$$.dirty&129&&t(3,i=o==a)},[a,c,d,i,r,g,f,o,l,u,s,m,b,k,C]}class ss extends oe{constructor(e){super(),le(this,e,ls,os,se,{id:0,label:1})}}function ii(n,e,t){const r=n.slice();return r[6]=e[t],r[7]=e,r[8]=t,r}function as(n){let e,t,r,i,o,l;function s(g){n[2](g,n[6])}function u(g){n[3](g,n[6])}function a(g){n[4](g,n[6])}let c={id:n[6].id,length_meters:n[6].properties.length_meters};return n[6].properties.name!==void 0&&(c.name=n[6].properties.name),n[6].properties.intervention_type!==void 0&&(c.intervention_type=n[6].properties.intervention_type),n[6].properties.description!==void 0&&(c.description=n[6].properties.description),e=new is({props:c}),ue.push(()=>De(e,"name",s,n[6].properties.name)),ue.push(()=>De(e,"intervention_type",u,n[6].properties.intervention_type)),ue.push(()=>De(e,"description",a,n[6].properties.description)),{c(){H(e.$$.fragment),o=z()},m(g,d){V(e,g,d),M(g,o,d),l=!0},p(g,d){n=g;const f={};d&1&&(f.id=n[6].id),d&1&&(f.length_meters=n[6].properties.length_meters),!t&&d&1&&(t=!0,f.name=n[6].properties.name,Ye(()=>t=!1)),!r&&d&1&&(r=!0,f.intervention_type=n[6].properties.intervention_type,Ye(()=>r=!1)),!i&&d&1&&(i=!0,f.description=n[6].properties.description,Ye(()=>i=!1)),e.$set(f)},i(g){l||(I(e.$$.fragment,g),l=!0)},o(g){D(e.$$.fragment,g),l=!1},d(g){Z(e,g),g&&P(o)}}}function oi(n,e){let t,r,i;return r=new ss({props:{id:e[6].id,label:e[8]+1+") "+li(e[6]),$$slots:{default:[as]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=ct(),H(r.$$.fragment),this.first=t},m(o,l){M(o,t,l),V(r,o,l),i=!0},p(o,l){e=o;const s={};l&1&&(s.id=e[6].id),l&1&&(s.label=e[8]+1+") "+li(e[6])),l&513&&(s.$$scope={dirty:l,ctx:e}),r.$set(s)},i(o){i||(I(r.$$.fragment,o),i=!0)},o(o){D(r.$$.fragment,o),i=!1},d(o){o&&P(t),Z(r,o)}}}function us(n){let e=[],t=new Map,r,i,o,l,s=n[0].features;const u=a=>a[6].id;for(let a=0;a<s.length;a+=1){let c=ii(n,s,a),g=u(c);t.set(g,e[a]=oi(g,c))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=ct()},m(a,c){for(let g=0;g<e.length;g+=1)e[g].m(a,c);M(a,r,c),i=!0,o||(l=X(window,"keydown",n[1]),o=!0)},p(a,[c]){c&1&&(s=a[0].features,Me(),e=eo(e,c,u,1,a,s,t,r.parentNode,to,oi,r,ii),Pe())},i(a){if(!i){for(let c=0;c<s.length;c+=1)I(e[c]);i=!0}},o(a){for(let c=0;c<e.length;c+=1)D(e[c]);i=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&P(r),o=!1,l()}}}function li(n){if(n.properties.name)return n.properties.name;var e=n.properties.intervention_type;return e=="other"&&(n.geometry.type=="Point"?e="point":n.geometry.type=="LineString"?e="line":e="polygon"),`Untitled ${e}`}function fs(n,e,t){let r,i;ce(n,Fe,a=>t(5,r=a)),ce(n,de,a=>t(0,i=a));function o(a){if(a.key=="Delete"){const c=a.target.tagName;if(c=="INPUT"||c=="TEXTAREA")return;a.preventDefault();const g=r;g&&Ei(g)}}function l(a,c){n.$$.not_equal(c.properties.name,a)&&(c.properties.name=a,de.set(i))}function s(a,c){n.$$.not_equal(c.properties.intervention_type,a)&&(c.properties.intervention_type=a,de.set(i))}function u(a,c){n.$$.not_equal(c.properties.description,a)&&(c.properties.description=a,de.set(i))}return[i,o,l,s,u]}class cs extends oe{constructor(e){super(),le(this,e,fs,us,se,{})}}function st(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function He(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function An(n,e){return n.type==="FeatureCollection"?"FeatureCollection":n.type==="GeometryCollection"?"GeometryCollection":n.type==="Feature"&&n.geometry!==null?n.geometry.type:n.type}function it(n,e,t){t===void 0&&(t={});var r=st(n),i=st(e),o=Ce(i[1]-r[1]),l=Ce(i[0]-r[0]),s=Ce(r[1]),u=Ce(i[1]),a=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(s)*Math.cos(u);return er(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),t.units)}function pt(n,e,t){if(n!==null)for(var r,i,o,l,s,u,a,c=0,g=0,d,f=n.type,m=f==="FeatureCollection",b=f==="Feature",k=m?n.features.length:1,C=0;C<k;C++){a=m?n.features[C].geometry:b?n.geometry:n,d=a?a.type==="GeometryCollection":!1,s=d?a.geometries.length:1;for(var h=0;h<s;h++){var p=0,v=0;if(l=d?a.geometries[h]:a,l!==null){u=l.coordinates;var w=l.type;switch(c=t&&(w==="Polygon"||w==="MultiPolygon")?1:0,w){case null:break;case"Point":if(e(u,g,C,p,v)===!1)return!1;g++,p++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(e(u[r],g,C,p,v)===!1)return!1;g++,w==="MultiPoint"&&p++}w==="LineString"&&p++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(i=0;i<u[r].length-c;i++){if(e(u[r][i],g,C,p,v)===!1)return!1;g++}w==="MultiLineString"&&p++,w==="Polygon"&&v++}w==="Polygon"&&p++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(v=0,i=0;i<u[r].length;i++){for(o=0;o<u[r][i].length-c;o++){if(e(u[r][i][o],g,C,p,v)===!1)return!1;g++}v++}p++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(pt(l.geometries[r],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ds(n,e,t,r){var i=t;return pt(n,function(o,l,s,u,a){l===0&&t===void 0?i=o:i=e(i,o,l,s,u,a)},r),i}function Ti(n,e){var t;switch(n.type){case"FeatureCollection":for(t=0;t<n.features.length&&e(n.features[t].properties,t)!==!1;t++);break;case"Feature":e(n.properties,0);break}}function hs(n,e,t){var r=t;return Ti(n,function(i,o){o===0&&t===void 0?r=i:r=e(r,i,o)}),r}function Et(n,e){if(n.type==="Feature")e(n,0);else if(n.type==="FeatureCollection")for(var t=0;t<n.features.length&&e(n.features[t],t)!==!1;t++);}function Ci(n,e,t){var r=t;return Et(n,function(i,o){o===0&&t===void 0?r=i:r=e(r,i,o)}),r}function ps(n){var e=[];return pt(n,function(t){e.push(t)}),e}function rr(n,e){var t,r,i,o,l,s,u,a,c,g,d=0,f=n.type==="FeatureCollection",m=n.type==="Feature",b=f?n.features.length:1;for(t=0;t<b;t++){for(s=f?n.features[t].geometry:m?n.geometry:n,a=f?n.features[t].properties:m?n.properties:{},c=f?n.features[t].bbox:m?n.bbox:void 0,g=f?n.features[t].id:m?n.id:void 0,u=s?s.type==="GeometryCollection":!1,l=u?s.geometries.length:1,i=0;i<l;i++){if(o=u?s.geometries[i]:s,o===null){if(e(null,d,a,c,g)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,d,a,c,g)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<o.geometries.length;r++)if(e(o.geometries[r],d,a,c,g)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}function ms(n,e,t){var r=t;return rr(n,function(i,o,l,s,u){o===0&&t===void 0?r=i:r=e(r,i,o,l,s,u)}),r}function mt(n,e){rr(n,function(t,r,i,o,l){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(Be(t,i,{bbox:o,id:l}),r,0)===!1?!1:void 0}var u;switch(s){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var a=0;a<t.coordinates.length;a++){var c=t.coordinates[a],g={type:u,coordinates:c};if(e(Be(g,i),r,a)===!1)return!1}})}function gs(n,e,t){var r=t;return mt(n,function(i,o,l){o===0&&l===0&&t===void 0?r=i:r=e(r,i,o,l)}),r}function Ri(n,e){mt(n,function(t,r,i){var o=0;if(t.geometry){var l=t.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var s,u=0,a=0,c=0;if(pt(t,function(g,d,f,m,b){if(s===void 0||r>u||m>a||b>c){s=g,u=r,a=m,c=b,o=0;return}var k=ke([s,g],t.properties);if(e(k,r,i,b,o)===!1)return!1;o++,s=g})===!1)return!1}}})}function Ai(n,e,t){var r=t,i=!1;return Ri(n,function(o,l,s,u,a){i===!1&&t===void 0?r=o:r=e(r,o,l,s,u,a),i=!0}),r}function Oi(n,e){if(!n)throw new Error("geojson is required");mt(n,function(t,r,i){if(t.geometry!==null){var o=t.geometry.type,l=t.geometry.coordinates;switch(o){case"LineString":if(e(t,r,i,0,0)===!1)return!1;break;case"Polygon":for(var s=0;s<l.length;s++)if(e(ke(l[s],t.properties),r,i,s)===!1)return!1;break}}})}function vs(n,e,t){var r=t;return Oi(n,function(i,o,l,s){o===0&&t===void 0?r=i:r=e(r,i,o,l,s)}),r}function bs(n,e){if(e=e||{},!tr(e))throw new Error("options is invalid");var t=e.featureIndex||0,r=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,l=e.properties,s;switch(n.type){case"FeatureCollection":t<0&&(t=n.features.length+t),l=l||n.features[t].properties,s=n.features[t].geometry;break;case"Feature":l=l||n.properties,s=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=n;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var u=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=u.length+o-1),ke([u[o],u[o+1]],l,e);case"Polygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o-1),ke([u[i][o],u[i][o+1]],l,e);case"MultiLineString":return r<0&&(r=u.length+r),o<0&&(o=u[r].length+o-1),ke([u[r][o],u[r][o+1]],l,e);case"MultiPolygon":return r<0&&(r=u.length+r),i<0&&(i=u[r].length+i),o<0&&(o=u[r][i].length-o-1),ke([u[r][i][o],u[r][i][o+1]],l,e)}throw new Error("geojson is invalid")}function _s(n,e){if(e=e||{},!tr(e))throw new Error("options is invalid");var t=e.featureIndex||0,r=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,l=e.properties,s;switch(n.type){case"FeatureCollection":t<0&&(t=n.features.length+t),l=l||n.features[t].properties,s=n.features[t].geometry;break;case"Feature":l=l||n.properties,s=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=n;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var u=s.coordinates;switch(s.type){case"Point":return we(u,l,e);case"MultiPoint":return r<0&&(r=u.length+r),we(u[r],l,e);case"LineString":return o<0&&(o=u.length+o),we(u[o],l,e);case"Polygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),we(u[i][o],l,e);case"MultiLineString":return r<0&&(r=u.length+r),o<0&&(o=u[r].length+o),we(u[r][o],l,e);case"MultiPolygon":return r<0&&(r=u.length+r),i<0&&(i=u[r].length+i),o<0&&(o=u[r][i].length-o),we(u[r][i][o],l,e)}throw new Error("geojson is invalid")}const ys=Object.freeze(Object.defineProperty({__proto__:null,coordAll:ps,coordEach:pt,coordReduce:ds,featureEach:Et,featureReduce:Ci,findPoint:_s,findSegment:bs,flattenEach:mt,flattenReduce:gs,geomEach:rr,geomReduce:ms,lineEach:Oi,lineReduce:vs,propEach:Ti,propReduce:hs,segmentEach:Ri,segmentReduce:Ai},Symbol.toStringTag,{value:"Module"}));function Ht(n,e){return e===void 0&&(e={}),Ai(n,function(t,r){var i=r.geometry.coordinates;return t+it(i[0],i[1],e)},0)}function ws(n){let e,t,r,i,o,l,s,u,a,c,g,d,f,m,b,k,C,h,p,v=n[0].features.length+"",w,_,O,x,F,q,E,B;return{c(){e=T("div"),t=T("label"),r=j(`Scheme name:
    `),i=T("input"),o=z(),l=T("br"),s=z(),u=T("div"),a=T("label"),c=T("input"),g=z(),d=T("button"),d.textContent="Load from GeoJSON",f=z(),m=T("button"),m.textContent="Export to GeoJSON",b=z(),k=T("br"),C=z(),h=T("div"),p=T("span"),w=j(v),_=j(" interventions"),O=z(),x=T("button"),F=j("Clear all"),A(i,"type","text"),A(c,"type","file"),A(c,"id","load_geojson"),A(c,"class","svelte-lhyd1e"),A(d,"type","button"),A(m,"type","button"),A(m,"class","align-right svelte-lhyd1e"),A(x,"type","button"),A(x,"class","align-right svelte-lhyd1e"),x.disabled=q=n[0].features.length==0},m(N,R){M(N,e,R),S(e,t),S(t,r),S(t,i),St(i,n[0].scheme_name),M(N,o,R),M(N,l,R),M(N,s,R),M(N,u,R),S(u,a),S(a,c),S(a,g),S(a,d),S(u,f),S(u,m),M(N,b,R),M(N,k,R),M(N,C,R),M(N,h,R),S(h,p),S(p,w),S(p,_),S(h,O),S(h,x),S(x,F),E||(B=[X(i,"input",n[5]),X(c,"change",n[3]),X(d,"click",n[6]),X(m,"click",n[2]),X(x,"click",n[1])],E=!0)},p(N,[R]){R&1&&i.value!==N[0].scheme_name&&St(i,N[0].scheme_name),R&1&&v!==(v=N[0].features.length+"")&&pe(w,v),R&1&&q!==(q=N[0].features.length==0)&&(x.disabled=q)},i:ne,o:ne,d(N){N&&P(e),N&&P(o),N&&P(l),N&&P(s),N&&P(u),N&&P(b),N&&P(k),N&&P(C),N&&P(h),E=!1,Je(B)}}}function ks(n,e){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(e)),t.setAttribute("download",n),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Ss(n,e,t){let r;ce(n,de,f=>t(0,r=f));let{authorityName:i}=e,o=window.localStorage.getItem(i);if(o)try{de.set(c(JSON.parse(o)))}catch(f){console.log(`Failed to load from local storage: ${f}`)}function l(){confirm("Do you want to clear the current scheme? (You should save it first!)")&&de.update(f=>(delete f.scheme_name,f.features=[],f))}function s(){const f=JSON.parse(JSON.stringify(r));for(let m of f.features)delete m.properties.hide_while_editing;return f}function u(){let f=s();var m=i;f.authority=i,f.origin="atip-v1",f.scheme_name&&(m+="_"+f.scheme_name),m+=".txt",ks(m,JSON.stringify(f,null,"  "))}function a(f){const m=new FileReader;m.onload=b=>{try{de.set(c(JSON.parse(b.target.result)))}catch(k){window.alert(`Couldn't load scheme from a file: ${k}`)}},m.readAsText(f.target.files[0])}function c(f){let m=1;for(let b of f.features)b.geometry.type=="LineString"&&!b.properties.length_meters&&(b.properties.length_meters=Ht(b,{units:"kilometers"})*1e3),b.id=m++;return f}function g(){r.scheme_name=this.value,de.set(r)}const d=()=>document.getElementById("load_geojson").click();return n.$$set=f=>{"authorityName"in f&&t(4,i=f.authorityName)},n.$$.update=()=>{n.$$.dirty&17&&r&&(console.log("GJ changed, saving to local storage"),window.localStorage.setItem(i,JSON.stringify(s())))},[r,l,u,a,i,g,d]}class Es extends oe{constructor(e){super(),le(this,e,Ss,ws,se,{authorityName:4})}}const Ms="/atip/assets/zoom_out_map-b2e1091a.svg";function Ps(n){let e,t,r,i,o;return{c(){e=T("button"),t=T("img"),no(t.src,r=Ms)||A(t,"src",r),A(t,"alt","Zoom to show entire boundary"),A(e,"type","button"),A(e,"title","Zoom to show entire boundary"),A(e,"class","svelte-qzjsqo")},m(l,s){M(l,e,s),S(e,t),i||(o=X(e,"click",n[0]),i=!0)},p:ne,i:ne,o:ne,d(l){l&&P(e),i=!1,o()}}}function xs(n,e,t){let r;ce(n,Ze,l=>t(2,r=l));let{boundaryGeojson:i}=e;function o(){r.fitBounds(jn(i),{padding:20,animate:!0,duration:500})}return n.$$set=l=>{"boundaryGeojson"in l&&t(1,i=l.boundaryGeojson)},[o,i]}class Ls extends oe{constructor(e){super(),le(this,e,xs,Ps,se,{boundaryGeojson:1})}}function Ts(n){let e,t,r,i,o,l,s;return{c(){e=T("div"),t=j(`Basemap:
  `),r=T("select"),i=T("option"),i.textContent="Streets",o=T("option"),o.textContent="Satellite",i.__value="streets",i.value=i.__value,o.__value="hybrid",o.value=o.__value,n[0]===void 0&&ki(()=>n[2].call(r)),A(e,"class","svelte-1tbnm6i")},m(u,a){M(u,e,a),S(e,t),S(e,r),S(r,i),S(r,o),cr(r,n[0]),l||(s=[X(r,"change",n[2]),X(r,"change",n[1])],l=!0)},p(u,[a]){a&1&&cr(r,u[0])},i:ne,o:ne,d(u){u&&P(e),l=!1,Je(s)}}}function Cs(n,e,t){let{style:r}=e;function i(){let l=new URLSearchParams(window.location.search);l.set("style",r);let s=`${window.location.pathname}?${l.toString()}${window.location.hash}`;window.location.href=s}function o(){r=ro(this),t(0,r)}return n.$$set=l=>{"style"in l&&t(0,r=l.style)},[r,i,o]}class Rs extends oe{constructor(e){super(),le(this,e,Cs,Ts,se,{style:0})}}const xe={area:"#e41a1c",route:"#377eb8",crossing:"#4daf4a",other:"#984ea3",hovering:"black",lineEndpointColor:"black"},pn=10,on=10;function As(n){let e,t,r,i,o,l,s,u,a,c,g,d,f,m,b,k,C,h,p;return{c(){e=T("div"),t=T("h1"),t.textContent="Interventions",r=z(),i=T("ul"),o=T("li"),l=T("span"),s=j("Areas"),u=z(),a=T("li"),c=T("span"),g=j("Routes"),d=z(),f=T("li"),m=T("span"),b=j("Crossings"),k=z(),C=T("li"),h=T("span"),p=j("Other"),A(t,"class","svelte-p551i1"),A(l,"class","svelte-p551i1"),Ct(l,"background",xe.area),A(c,"class","svelte-p551i1"),Ct(c,"background",xe.route),A(m,"class","svelte-p551i1"),Ct(m,"background",xe.crossing),A(h,"class","svelte-p551i1"),Ct(h,"background",xe.other),A(e,"class","svelte-p551i1")},m(v,w){M(v,e,w),S(e,t),S(e,r),S(e,i),S(i,o),S(o,l),S(o,s),S(i,u),S(i,a),S(a,c),S(a,g),S(i,d),S(i,f),S(f,m),S(f,b),S(i,k),S(i,C),S(C,h),S(C,p)},p:ne,i:ne,o:ne,d(v){v&&P(e)}}}class Os extends oe{constructor(e){super(),le(this,e,null,As,se,{})}}let gt="interventions";function Ns(n,e,t){let r,i;ce(n,Ze,u=>t(0,r=u)),ce(n,de,u=>t(1,i=u)),Pt(r,gt,{type:"geojson",data:i});const o=["match",["get","intervention_type"],"area",xe.area,"route",xe.route,"crossing",xe.crossing,"other",xe.other,"white"],l=["!=","hide_while_editing",!0];return Te(r,{id:"interventions-points",source:gt,filter:["all",Zn,l,["!=","endpoint",!0]],...Dt(o,pn)}),Te(r,{id:"interventions-lines",source:gt,filter:["all",Vn,l],...$t(o,on)},"route-lines"),Te(r,{id:"interventions-lines-endpoints",source:gt,filter:["==","endpoint",!0],type:"circle",paint:{"circle-radius":.5*on,"circle-opacity":0,"circle-stroke-color":xe.lineEndpointColor,"circle-stroke-width":2}}),Te(r,{id:"interventions-polygons",source:gt,filter:["all",Hn,l],...Qn(o,.5)},"hover-polygons"),n.$$.update=()=>{if(n.$$.dirty&3){let u=JSON.parse(JSON.stringify(i)),a=[];for(let c of u.features)if(c.geometry.type=="LineString")for(let g of[c.geometry.coordinates[0],c.geometry.coordinates[c.geometry.coordinates.length-1]])a.push({type:"Feature",properties:{endpoint:!0},geometry:{type:"Point",coordinates:g}});u.features=u.features.concat(a),r.getSource(gt).setData(u)}},[r,i]}class Fs extends oe{constructor(e){super(),le(this,e,Ns,null,se,{})}}let vt="hover";function Is(n,e,t){let r,i,o,l,s;return ce(n,Ze,u=>t(0,r=u)),ce(n,de,u=>t(1,i=u)),ce(n,en,u=>t(2,o=u)),ce(n,$e,u=>t(3,l=u)),ce(n,Fe,u=>t(4,s=u)),Pt(r,vt,{type:"geojson",data:et()}),Te(r,{id:"hover-polygons",source:vt,filter:Hn,...$t(xe.hovering,.5*on,1)}),Te(r,{id:"hover-lines",source:vt,filter:Vn,...$t(xe.hovering,1.5*on,1)},"interventions-lines"),Te(r,{id:"hover-points",source:vt,filter:Zn,...Dt(xe.hovering,1.5*pn,1)},"interventions-points"),n.$$.update=()=>{if(n.$$.dirty&31){let u=s||l||o;u!=null?r.getSource(vt).setData(i.features.find(a=>a.id==u)):r.getSource(vt).setData(et())}},[r,i,o,l,s]}class Bs extends oe{constructor(e){super(),le(this,e,Is,null,se,{})}}const Ut="edit-point-mode";var Bt,On;class zs{constructor(e){dt(this,Bt);Ee(this,"map");Ee(this,"active");Ee(this,"eventListeners");Ee(this,"cursor");this.map=e,this.active=!1,this.eventListeners=[],this.cursor=null,e.on("mousemove",t=>{this.active&&(this.cursor=Gs(t.lngLat.toArray()),he(this,Bt,On).call(this))}),e.on("click",()=>{if(this.active&&this.cursor){for(let t of this.eventListeners)t(this.cursor);this.stop()}}),Pt(e,Ut,{type:"geojson",data:et()}),Te(e,{id:"edit-point-mode",source:Ut,...Dt(xe.hovering,pn,1)})}addEventListener(e){this.eventListeners.push(e)}tearDown(){this.map.removeLayer("edit-point-mode"),this.map.removeSource(Ut)}start(){this.active=!0}stop(){this.cursor=null,this.active=!1,he(this,Bt,On).call(this)}}Bt=new WeakSet,On=function(){let e=et();this.cursor&&e.features.push(this.cursor),this.map.getSource(Ut).setData(e)};function Gs(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function Ni(n,e,t){if(t===void 0&&(t={}),t.final===!0)return qs(n,e);var r=st(n),i=st(e),o=Ce(r[0]),l=Ce(i[0]),s=Ce(r[1]),u=Ce(i[1]),a=Math.sin(l-o)*Math.cos(u),c=Math.cos(s)*Math.sin(u)-Math.sin(s)*Math.cos(u)*Math.cos(l-o);return Nt(Math.atan2(a,c))}function qs(n,e){var t=Ni(e,n);return t=(t+180)%360,t}function si(n,e,t,r){r===void 0&&(r={});var i=st(n),o=Ce(i[0]),l=Ce(i[1]),s=Ce(t),u=hn(e,r.units),a=Math.asin(Math.sin(l)*Math.cos(u)+Math.cos(l)*Math.sin(u)*Math.cos(s)),c=o+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(l),Math.cos(u)-Math.sin(l)*Math.sin(a)),g=Nt(c),d=Nt(a);return we([g,d],r.properties)}function Nn(n){if(!n)throw new Error("geojson is required");var e=[];return mt(n,function(t){Ds(t,e)}),Ie(e)}function Ds(n,e){var t=[],r=n.geometry;if(r!==null){switch(r.type){case"Polygon":t=He(r);break;case"LineString":t=[He(r)]}t.forEach(function(i){var o=Ys(i,n.properties);o.forEach(function(l){l.id=e.length,e.push(l)})})}}function Ys(n,e){var t=[];return n.reduce(function(r,i){var o=ke([r,i],e);return o.bbox=Xs(r,i),t.push(o),i}),t}function Xs(n,e){var t=n[0],r=n[1],i=e[0],o=e[1],l=t<i?t:i,s=r<o?r:o,u=t>i?t:i,a=r>o?r:o;return[l,s,u,a]}var Mt={},Js={get exports(){return Mt},set exports(n){Mt=n}},Fn={},Us={get exports(){return Fn},set exports(n){Fn=n}};(function(n,e){(function(t,r){n.exports=r()})(io,function(){function t(h,p,v,w,_){(function O(x,F,q,E,B){for(;E>q;){if(E-q>600){var N=E-q+1,R=F-q+1,G=Math.log(N),J=.5*Math.exp(2*G/3),te=.5*Math.sqrt(G*J*(N-J)/N)*(R-N/2<0?-1:1),$=Math.max(q,Math.floor(F-R*J/N+te)),ee=Math.min(E,Math.floor(F+(N-R)*J/N+te));O(x,F,$,ee,B)}var ae=x[F],re=q,y=E;for(r(x,q,F),B(x[E],ae)>0&&r(x,q,E);re<y;){for(r(x,re,y),re++,y--;B(x[re],ae)<0;)re++;for(;B(x[y],ae)>0;)y--}B(x[q],ae)===0?r(x,q,y):r(x,++y,E),y<=F&&(q=y+1),F<=y&&(E=y-1)}})(h,p,v||0,w||h.length-1,_||i)}function r(h,p,v){var w=h[p];h[p]=h[v],h[v]=w}function i(h,p){return h<p?-1:h>p?1:0}var o=function(h){h===void 0&&(h=9),this._maxEntries=Math.max(4,h),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function l(h,p,v){if(!v)return p.indexOf(h);for(var w=0;w<p.length;w++)if(v(h,p[w]))return w;return-1}function s(h,p){u(h,0,h.children.length,p,h)}function u(h,p,v,w,_){_||(_=k(null)),_.minX=1/0,_.minY=1/0,_.maxX=-1/0,_.maxY=-1/0;for(var O=p;O<v;O++){var x=h.children[O];a(_,h.leaf?w(x):x)}return _}function a(h,p){return h.minX=Math.min(h.minX,p.minX),h.minY=Math.min(h.minY,p.minY),h.maxX=Math.max(h.maxX,p.maxX),h.maxY=Math.max(h.maxY,p.maxY),h}function c(h,p){return h.minX-p.minX}function g(h,p){return h.minY-p.minY}function d(h){return(h.maxX-h.minX)*(h.maxY-h.minY)}function f(h){return h.maxX-h.minX+(h.maxY-h.minY)}function m(h,p){return h.minX<=p.minX&&h.minY<=p.minY&&p.maxX<=h.maxX&&p.maxY<=h.maxY}function b(h,p){return p.minX<=h.maxX&&p.minY<=h.maxY&&p.maxX>=h.minX&&p.maxY>=h.minY}function k(h){return{children:h,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function C(h,p,v,w,_){for(var O=[p,v];O.length;)if(!((v=O.pop())-(p=O.pop())<=w)){var x=p+Math.ceil((v-p)/w/2)*w;t(h,x,p,v,_),O.push(p,x,x,v)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(h){var p=this.data,v=[];if(!b(h,p))return v;for(var w=this.toBBox,_=[];p;){for(var O=0;O<p.children.length;O++){var x=p.children[O],F=p.leaf?w(x):x;b(h,F)&&(p.leaf?v.push(x):m(h,F)?this._all(x,v):_.push(x))}p=_.pop()}return v},o.prototype.collides=function(h){var p=this.data;if(!b(h,p))return!1;for(var v=[];p;){for(var w=0;w<p.children.length;w++){var _=p.children[w],O=p.leaf?this.toBBox(_):_;if(b(h,O)){if(p.leaf||m(h,O))return!0;v.push(_)}}p=v.pop()}return!1},o.prototype.load=function(h){if(!h||!h.length)return this;if(h.length<this._minEntries){for(var p=0;p<h.length;p++)this.insert(h[p]);return this}var v=this._build(h.slice(),0,h.length-1,0);if(this.data.children.length)if(this.data.height===v.height)this._splitRoot(this.data,v);else{if(this.data.height<v.height){var w=this.data;this.data=v,v=w}this._insert(v,this.data.height-v.height-1,!0)}else this.data=v;return this},o.prototype.insert=function(h){return h&&this._insert(h,this.data.height-1),this},o.prototype.clear=function(){return this.data=k([]),this},o.prototype.remove=function(h,p){if(!h)return this;for(var v,w,_,O=this.data,x=this.toBBox(h),F=[],q=[];O||F.length;){if(O||(O=F.pop(),w=F[F.length-1],v=q.pop(),_=!0),O.leaf){var E=l(h,O.children,p);if(E!==-1)return O.children.splice(E,1),F.push(O),this._condense(F),this}_||O.leaf||!m(O,x)?w?(v++,O=w.children[v],_=!1):O=null:(F.push(O),q.push(v),v=0,w=O,O=O.children[0])}return this},o.prototype.toBBox=function(h){return h},o.prototype.compareMinX=function(h,p){return h.minX-p.minX},o.prototype.compareMinY=function(h,p){return h.minY-p.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(h){return this.data=h,this},o.prototype._all=function(h,p){for(var v=[];h;)h.leaf?p.push.apply(p,h.children):v.push.apply(v,h.children),h=v.pop();return p},o.prototype._build=function(h,p,v,w){var _,O=v-p+1,x=this._maxEntries;if(O<=x)return s(_=k(h.slice(p,v+1)),this.toBBox),_;w||(w=Math.ceil(Math.log(O)/Math.log(x)),x=Math.ceil(O/Math.pow(x,w-1))),(_=k([])).leaf=!1,_.height=w;var F=Math.ceil(O/x),q=F*Math.ceil(Math.sqrt(x));C(h,p,v,q,this.compareMinX);for(var E=p;E<=v;E+=q){var B=Math.min(E+q-1,v);C(h,E,B,F,this.compareMinY);for(var N=E;N<=B;N+=F){var R=Math.min(N+F-1,B);_.children.push(this._build(h,N,R,w-1))}}return s(_,this.toBBox),_},o.prototype._chooseSubtree=function(h,p,v,w){for(;w.push(p),!p.leaf&&w.length-1!==v;){for(var _=1/0,O=1/0,x=void 0,F=0;F<p.children.length;F++){var q=p.children[F],E=d(q),B=(N=h,R=q,(Math.max(R.maxX,N.maxX)-Math.min(R.minX,N.minX))*(Math.max(R.maxY,N.maxY)-Math.min(R.minY,N.minY))-E);B<O?(O=B,_=E<_?E:_,x=q):B===O&&E<_&&(_=E,x=q)}p=x||p.children[0]}var N,R;return p},o.prototype._insert=function(h,p,v){var w=v?h:this.toBBox(h),_=[],O=this._chooseSubtree(w,this.data,p,_);for(O.children.push(h),a(O,w);p>=0&&_[p].children.length>this._maxEntries;)this._split(_,p),p--;this._adjustParentBBoxes(w,_,p)},o.prototype._split=function(h,p){var v=h[p],w=v.children.length,_=this._minEntries;this._chooseSplitAxis(v,_,w);var O=this._chooseSplitIndex(v,_,w),x=k(v.children.splice(O,v.children.length-O));x.height=v.height,x.leaf=v.leaf,s(v,this.toBBox),s(x,this.toBBox),p?h[p-1].children.push(x):this._splitRoot(v,x)},o.prototype._splitRoot=function(h,p){this.data=k([h,p]),this.data.height=h.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(h,p,v){for(var w,_,O,x,F,q,E,B=1/0,N=1/0,R=p;R<=v-p;R++){var G=u(h,0,R,this.toBBox),J=u(h,R,v,this.toBBox),te=(_=G,O=J,x=void 0,F=void 0,q=void 0,E=void 0,x=Math.max(_.minX,O.minX),F=Math.max(_.minY,O.minY),q=Math.min(_.maxX,O.maxX),E=Math.min(_.maxY,O.maxY),Math.max(0,q-x)*Math.max(0,E-F)),$=d(G)+d(J);te<B?(B=te,w=R,N=$<N?$:N):te===B&&$<N&&(N=$,w=R)}return w||v-p},o.prototype._chooseSplitAxis=function(h,p,v){var w=h.leaf?this.compareMinX:c,_=h.leaf?this.compareMinY:g;this._allDistMargin(h,p,v,w)<this._allDistMargin(h,p,v,_)&&h.children.sort(w)},o.prototype._allDistMargin=function(h,p,v,w){h.children.sort(w);for(var _=this.toBBox,O=u(h,0,p,_),x=u(h,v-p,v,_),F=f(O)+f(x),q=p;q<v-p;q++){var E=h.children[q];a(O,h.leaf?_(E):E),F+=f(O)}for(var B=v-p-1;B>=p;B--){var N=h.children[B];a(x,h.leaf?_(N):N),F+=f(x)}return F},o.prototype._adjustParentBBoxes=function(h,p,v){for(var w=v;w>=0;w--)a(p[w],h)},o.prototype._condense=function(h){for(var p=h.length-1,v=void 0;p>=0;p--)h[p].children.length===0?p>0?(v=h[p-1].children).splice(v.indexOf(h[p]),1):this.clear():s(h[p],this.toBBox)},o})})(Us);const js=Wn(xl),Ws=Wn(ys);function ln(n){var e=[1/0,1/0,-1/0,-1/0];return pt(n,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}ln.default=ln;const Hs=Object.freeze(Object.defineProperty({__proto__:null,default:ln},Symbol.toStringTag,{value:"Module"})),Vs=Wn(Hs);var Ue=Fn,Fi=js,Ii=Ws,bt=Vs.default,Zs=Ii.featureEach;Ii.coordEach;Fi.polygon;var ai=Fi.featureCollection;function Bi(n){var e=new Ue(n);return e.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:bt(t),Ue.prototype.insert.call(this,t)},e.load=function(t){var r=[];return Array.isArray(t)?t.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:bt(i),r.push(i)}):Zs(t,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:bt(i),r.push(i)}),Ue.prototype.load.call(this,r)},e.remove=function(t,r){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:bt(t),Ue.prototype.remove.call(this,t,r)},e.clear=function(){return Ue.prototype.clear.call(this)},e.search=function(t){var r=Ue.prototype.search.call(this,this.toBBox(t));return ai(r)},e.collides=function(t){return Ue.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=Ue.prototype.all.call(this);return ai(t)},e.toJSON=function(){return Ue.prototype.toJSON.call(this)},e.fromJSON=function(t){return Ue.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var r;if(t.bbox)r=t.bbox;else if(Array.isArray(t)&&t.length===4)r=t;else if(Array.isArray(t)&&t.length===6)r=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")r=bt(t);else if(t.type==="FeatureCollection")r=bt(t);else throw new Error("invalid geojson");return{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},e}Js.exports=Bi;Mt.default=Bi;function zi(n,e){var t={},r=[];if(n.type==="LineString"&&(n=Be(n)),e.type==="LineString"&&(e=Be(e)),n.type==="Feature"&&e.type==="Feature"&&n.geometry!==null&&e.geometry!==null&&n.geometry.type==="LineString"&&e.geometry.type==="LineString"&&n.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=ui(n,e);return i&&r.push(i),Ie(r)}var o=Mt();return o.load(Nn(e)),Et(Nn(n),function(l){Et(o.search(l),function(s){var u=ui(l,s);if(u){var a=He(u).join(",");t[a]||(t[a]=!0,r.push(u))}})}),Ie(r)}function ui(n,e){var t=He(n),r=He(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=t[0][0],o=t[0][1],l=t[1][0],s=t[1][1],u=r[0][0],a=r[0][1],c=r[1][0],g=r[1][1],d=(g-a)*(l-i)-(c-u)*(s-o),f=(c-u)*(o-a)-(g-a)*(i-u),m=(l-i)*(o-a)-(s-o)*(i-u);if(d===0)return f===0&&m===0,null;var b=f/d,k=m/d;if(b>=0&&b<=1&&k>=0&&k<=1){var C=i+b*(l-i),h=o+b*(s-o);return we([C,h])}return null}function It(n,e,t){t===void 0&&(t={});var r=we([1/0,1/0],{dist:1/0}),i=0;return mt(n,function(o){for(var l=He(o),s=0;s<l.length-1;s++){var u=we(l[s]);u.properties.dist=it(e,u,t);var a=we(l[s+1]);a.properties.dist=it(e,a,t);var c=it(u,a,t),g=Math.max(u.properties.dist,a.properties.dist),d=Ni(u,a),f=si(e,g,d+90,t),m=si(e,g,d-90,t),b=zi(ke([f.geometry.coordinates,m.geometry.coordinates]),ke([u.geometry.coordinates,a.geometry.coordinates])),k=null;b.features.length>0&&(k=b.features[0],k.properties.dist=it(e,k,t),k.properties.location=i+it(u,k,t)),u.properties.dist<r.properties.dist&&(r=u,r.properties.index=s,r.properties.location=i),a.properties.dist<r.properties.dist&&(r=a,r.properties.index=s+1,r.properties.location=i+c),k&&k.properties.dist<r.properties.dist&&(r=k,r.properties.index=s),i+=c}}),r}const _t="edit-polygon-mode";var Qe,ht,zt,In,Gt,Bn;class Qs{constructor(e){dt(this,Qe);dt(this,zt);dt(this,Gt);Ee(this,"map");Ee(this,"active");Ee(this,"eventListeners");Ee(this,"points");Ee(this,"cursor");Ee(this,"hoverPolyon");Ee(this,"hoverPoint");Ee(this,"dragging");Ee(this,"dragFrom");this.map=e,this.active=!1,this.eventListeners=[],this.points=[],this.cursor=null,this.hoverPolyon=!1,this.hoverPoint=null,this.dragging=!1,this.dragFrom=null,e.on("mousemove",t=>{if(this.active&&!this.dragging)he(this,zt,In).call(this,t);else if(this.active&&this.dragging){if(this.hoverPolyon){let r=this.dragFrom[0]-t.lngLat.lng,i=this.dragFrom[1]-t.lngLat.lat;for(let o of this.points)o[0]-=r,o[1]-=i}else this.points[this.hoverPoint]=t.lngLat.toArray();this.dragFrom=t.lngLat.toArray(),he(this,Qe,ht).call(this)}}),e.on("click",t=>{if(this.active&&this.cursor){let r=[];if(ci(this.points).forEach((i,o)=>{r.push([o+1,It(i,this.cursor).properties.dist])}),r.sort((i,o)=>i[1]-o[1]),r.length>0){let i=r[0][0];this.points.splice(i,0,this.cursor.geometry.coordinates),this.hoverPoint=i}else this.points.push(this.cursor.geometry.coordinates),this.hoverPoint=this.points.length-1;he(this,Qe,ht).call(this)}else this.active&&this.hoverPoint!=null&&(this.points.splice(this.hoverPoint,1),this.hoverPoint=null,he(this,Qe,ht).call(this),he(this,zt,In).call(this,t))}),e.on("mousedown",t=>{this.active&&!this.dragging&&(this.hoverPolyon||this.hoverPoint!=null)&&(t.preventDefault(),this.cursor=null,this.dragging=!0,this.dragFrom=t.lngLat.toArray())}),e.on("mouseup",()=>{this.active&&this.dragging&&(this.dragging=!1,this.dragFrom=null)}),document.addEventListener("keypress",t=>{if(this.active&&t.key=="Enter"){t.preventDefault();let r=he(this,Gt,Bn).call(this);if(r)for(let i of this.eventListeners)i(r);this.stop()}}),Pt(e,_t,{type:"geojson",data:et()}),Te(e,{id:"edit-polygon-fill",source:_t,filter:Hn,...Qn("red",["case",["boolean",["get","hover"],"false"],1,.5])}),Te(e,{id:"edit-polygon-lines",source:_t,filter:Vn,...$t("black",8,.5)}),Te(e,{id:"edit-polygon-vertices",source:_t,filter:Zn,...Dt(xe.hovering,pn,["case",["boolean",["get","hover"],"false"],1,.5])})}addEventListener(e){this.eventListeners.push(e)}tearDown(){this.map.removeLayer("edit-polygon-vertices"),this.map.removeLayer("edit-polygon-fill"),this.map.removeLayer("edit-polygon-lines"),this.map.removeSource(_t)}startNew(){this.active=!0}editExisting(e){this.active=!0,this.points=e.geometry.coordinates[0],this.points.pop(),he(this,Qe,ht).call(this)}stop(){this.points=[],this.cursor=null,this.active=!1,this.hoverPolyon=!1,this.hoverPoint=null,this.dragging=!1,this.dragFrom=null,he(this,Qe,ht).call(this)}}Qe=new WeakSet,ht=function(){let e=et();this.points.forEach((r,i)=>{let o=fi(r);o.properties.hover=this.hoverPoint==i,o.properties.idx=i,e.features.push(o)}),this.cursor&&e.features.push(this.cursor),e.features=e.features.concat(ci(this.points));let t=he(this,Gt,Bn).call(this);t&&(t.properties.hover=this.hoverPolyon,e.features.push(t)),this.map.getSource(_t).setData(e)},zt=new WeakSet,In=function(e){this.cursor=null,this.hoverPolyon=!1,this.hoverPoint=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hoverPolyon=!0;break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hoverPoint=t.properties.idx;break}!this.hoverPolyon&&this.hoverPoint==null&&(this.cursor=fi(e.lngLat.toArray())),he(this,Qe,ht).call(this)},Gt=new WeakSet,Bn=function(){if(this.points.length<3)return null;let e=[JSON.parse(JSON.stringify(this.points))];return e[0].push(JSON.parse(JSON.stringify(e[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:e},properties:{}}};function fi(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}}}function ci(n){let e=[];for(let t=0;t<n.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[t],n[t+1]]}});return n.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[n.length-1],n[0]]}}),e}function di(n){let e;return{c(){e=T("p"),e.textContent="Click an intervention to fill out its attributes"},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function Ks(n){let e,t=n[0]==yt&&di();return{c(){t&&t.c(),e=ct()},m(r,i){t&&t.m(r,i),M(r,e,i)},p(r,[i]){r[0]==yt?t||(t=di(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(r){t&&t.d(r),r&&P(e)}}}const yt="edit-attribute";function Gi(){}function $s(n,e,t){let r,i;ce(n,Ze,u=>t(4,r=u)),ce(n,de,u=>t(5,i=u));let{mode:o}=e,{changeMode:l}=e;function s(){Fe.set(null)}return r.on("mousemove",u=>{if(o==yt){let c=r.queryRenderedFeatures(u.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var a=null;c.length>0&&(a=c[0].id),$e.set(a)}}),r.on("mouseout",()=>{o==yt&&$e.set(null)}),r.on("click",u=>{if(o==yt){let a=r.queryRenderedFeatures(u.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});a.length>0?Fe.set(a[0].id):Fe.set(null)}}),En.subscribe(u=>{if(u){let a=i.features.find(c=>c.id==u);a.geometry.type=="Point"?r.flyTo({center:a.geometry.coordinates}):r.fitBounds(jn(a),{padding:200,animate:!0,duration:500}),l(yt)}}),n.$$set=u=>{"mode"in u&&t(0,o=u.mode),"changeMode"in u&&t(1,l=u.changeMode)},[o,l,Gi,s]}class ea extends oe{constructor(e){super(),le(this,e,$s,Ks,se,{mode:0,changeMode:1,start:2,stop:3})}get start(){return Gi}get stop(){return this.$$.ctx[3]}}function hi(n){let e;return{c(){e=T("p"),e.textContent="Click an intervention to edit its geometry"},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function ta(n){let e,t=n[0]==nt&&hi();return{c(){t&&t.c(),e=ct()},m(r,i){t&&t.m(r,i),M(r,e,i)},p(r,[i]){r[0]==nt?t||(t=hi(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(r){t&&t.d(r),r&&P(e)}}}const nt="edit-geometry";function qi(){}function na(n,e,t){let r;ce(n,Ze,d=>t(8,r=d));let{mode:i}=e,{routeSnapper:o}=e,{snapTool:l}=e,{pointTool:s}=e,{polygonTool:u}=e;function a(){c&&(o.stop(),s.stop(),u.stop(),de.update(d=>{let f=d.features.find(m=>m.id==c);return delete f.properties.hide_while_editing,d})),c=null,$e.set(null)}let c=null;r.on("mousemove",d=>{if(i==nt&&c==null){let m=r.queryRenderedFeatures(d.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var f=null;m.length>0&&(f=m[0].id),$e.set(f)}}),r.on("mouseout",()=>{i==nt&&c==null&&$e.set(null)}),r.on("click",d=>{if(i==nt&&c==null){let f=r.queryRenderedFeatures(d.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});f.length>0&&g(f[0].id)}}),l.addEventListener("new-route",d=>{if(i==nt){const f=d.detail;de.update(m=>{let b=m.features.find(k=>k.id==c);return b.properties.length_meters=f.properties.length_meters,b.properties.waypoints=f.properties.waypoints,delete b.properties.hide_while_editing,b.geometry=f.geometry,m}),c=null}}),l.addEventListener("no-new-route",()=>{i==nt&&(de.update(d=>{let f=d.features.find(m=>m.id==c);return delete f.properties.hide_while_editing,d}),c=null)});for(let d of[s,u])d.addEventListener(f=>{i==nt&&(de.update(m=>{let b=m.features.find(k=>k.id==c);return b.geometry=f.geometry,delete b.properties.hide_while_editing,m}),c=null)});function g(d){$e.set(null);let f;de.update(m=>(f=m.features.find(b=>b.id==d),f.properties.hide_while_editing=!0,m)),c=d,f.geometry.type=="LineString"?o.editExisting(f):f.geometry.type=="Polygon"?u.editExisting(f):f.geometry.type=="Point"&&s.start()}return n.$$set=d=>{"mode"in d&&t(0,i=d.mode),"routeSnapper"in d&&t(1,o=d.routeSnapper),"snapTool"in d&&t(2,l=d.snapTool),"pointTool"in d&&t(3,s=d.pointTool),"polygonTool"in d&&t(4,u=d.polygonTool)},[i,o,l,s,u,qi,a]}class ra extends oe{constructor(e){super(),le(this,e,na,ta,se,{mode:0,routeSnapper:1,snapTool:2,pointTool:3,polygonTool:4,start:5,stop:6})}get start(){return qi}get stop(){return this.$$.ctx[6]}}let W;const Di=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Di.decode();let Vt=new Uint8Array;function At(){return Vt.byteLength===0&&(Vt=new Uint8Array(W.memory.buffer)),Vt}function wt(n,e){return Di.decode(At().subarray(n,n+e))}const Ke=new Array(32).fill(void 0);Ke.push(void 0,null,!0,!1);let Ot=Ke.length;function ge(n){Ot===Ke.length&&Ke.push(Ke.length+1);const e=Ot;return Ot=Ke[e],Ke[e]=n,e}function K(n){return Ke[n]}function ia(n){n<36||(Ke[n]=Ot,Ot=n)}function zn(n){const e=K(n);return ia(n),e}function _n(n){return n==null}let Zt=new Float64Array;function oa(){return Zt.byteLength===0&&(Zt=new Float64Array(W.memory.buffer)),Zt}let Qt=new Int32Array;function ve(){return Qt.byteLength===0&&(Qt=new Int32Array(W.memory.buffer)),Qt}let lt=0;const Kt=new TextEncoder("utf-8"),la=typeof Kt.encodeInto=="function"?function(n,e){return Kt.encodeInto(n,e)}:function(n,e){const t=Kt.encode(n);return e.set(t),{read:n.length,written:t.length}};function jt(n,e,t){if(t===void 0){const s=Kt.encode(n),u=e(s.length);return At().subarray(u,u+s.length).set(s),lt=s.length,u}let r=n.length,i=e(r);const o=At();let l=0;for(;l<r;l++){const s=n.charCodeAt(l);if(s>127)break;o[i+l]=s}if(l!==r){l!==0&&(n=n.slice(l)),i=t(i,r,r=l+n.length*3);const s=At().subarray(i+l,i+r),u=la(n,s);l+=u.written}return lt=l,i}function Gn(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const i=n.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=n.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(n)){const i=n.length;let o="[";i>0&&(o+=Gn(n[0]));for(let l=1;l<i;l++)o+=", "+Gn(n[l]);return o+="]",o}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function sa(n,e){const t=e(n.length*1);return At().set(n,t/1),lt=n.length,t}function yn(n,e){try{return n.apply(this,e)}catch(t){W.__wbindgen_exn_store(ge(t))}}class sn{static __wrap(e){const t=Object.create(sn.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();W.__wbg_jsroutesnapper_free(e)}constructor(e){try{const o=W.__wbindgen_add_to_stack_pointer(-16),l=sa(e,W.__wbindgen_malloc),s=lt;W.jsroutesnapper_new(o,l,s);var t=ve()[o/4+0],r=ve()[o/4+1],i=ve()[o/4+2];if(i)throw zn(r);return sn.__wrap(t)}finally{W.__wbindgen_add_to_stack_pointer(16)}}setConfig(e){W.jsroutesnapper_setConfig(this.ptr,ge(e))}toFinalFeature(){try{const r=W.__wbindgen_add_to_stack_pointer(-16);W.jsroutesnapper_toFinalFeature(r,this.ptr);var e=ve()[r/4+0],t=ve()[r/4+1];let i;return e!==0&&(i=wt(e,t).slice(),W.__wbindgen_free(e,t*1)),i}finally{W.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){try{const r=W.__wbindgen_add_to_stack_pointer(-16);W.jsroutesnapper_renderGeojson(r,this.ptr);var e=ve()[r/4+0],t=ve()[r/4+1];return wt(e,t)}finally{W.__wbindgen_add_to_stack_pointer(16),W.__wbindgen_free(e,t)}}setSnapMode(e){W.jsroutesnapper_setSnapMode(this.ptr,e)}onMouseMove(e,t,r){return W.jsroutesnapper_onMouseMove(this.ptr,e,t,r)!==0}onClick(){W.jsroutesnapper_onClick(this.ptr)}onDragStart(){return W.jsroutesnapper_onDragStart(this.ptr)!==0}onMouseUp(){return W.jsroutesnapper_onMouseUp(this.ptr)!==0}clearState(){W.jsroutesnapper_clearState(this.ptr)}editExisting(e){try{const i=W.__wbindgen_add_to_stack_pointer(-16);W.jsroutesnapper_editExisting(i,this.ptr,ge(e));var t=ve()[i/4+0],r=ve()[i/4+1];if(r)throw zn(t)}finally{W.__wbindgen_add_to_stack_pointer(16)}}}async function aa(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function ua(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const r=wt(e,t);return ge(r)},n.wbg.__wbindgen_object_drop_ref=function(e){zn(e)},n.wbg.__wbindgen_boolean_get=function(e){const t=K(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_error_new=function(e,t){const r=new Error(wt(e,t));return ge(r)},n.wbg.__wbindgen_is_object=function(e){const t=K(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return K(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return K(e)in K(t)},n.wbg.__wbindgen_number_get=function(e,t){const r=K(t),i=typeof r=="number"?r:void 0;oa()[e/8+1]=_n(i)?0:i,ve()[e/4+0]=!_n(i)},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return K(e)==K(t)},n.wbg.__wbindgen_string_get=function(e,t){const r=K(t),i=typeof r=="string"?r:void 0;var o=_n(i)?0:jt(i,W.__wbindgen_malloc,W.__wbindgen_realloc),l=lt;ve()[e/4+1]=l,ve()[e/4+0]=o},n.wbg.__wbg_String_91fba7ded13ba54c=function(e,t){const r=String(K(t)),i=jt(r,W.__wbindgen_malloc,W.__wbindgen_realloc),o=lt;ve()[e/4+1]=o,ve()[e/4+0]=i},n.wbg.__wbindgen_object_clone_ref=function(e){const t=K(e);return ge(t)},n.wbg.__wbg_getwithrefkey_15c62c2b8546208d=function(e,t){const r=K(e)[K(t)];return ge(r)},n.wbg.__wbg_log_4b5638ad60bdc54a=function(e){console.log(K(e))},n.wbg.__wbg_get_57245cc7d7c7619d=function(e,t){const r=K(e)[t>>>0];return ge(r)},n.wbg.__wbg_length_6e3bbe7c8bd4dbd8=function(e){return K(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof K(e)=="function"},n.wbg.__wbg_next_579e583d33566a86=function(e){const t=K(e).next;return ge(t)},n.wbg.__wbg_next_aaef7c8aa5e212ac=function(){return yn(function(e){const t=K(e).next();return ge(t)},arguments)},n.wbg.__wbg_done_1b73b0672e15f234=function(e){return K(e).done},n.wbg.__wbg_value_1ccc36bc03462d71=function(e){const t=K(e).value;return ge(t)},n.wbg.__wbg_iterator_6f9d4f28845f426c=function(){return ge(Symbol.iterator)},n.wbg.__wbg_get_765201544a2b6869=function(){return yn(function(e,t){const r=Reflect.get(K(e),K(t));return ge(r)},arguments)},n.wbg.__wbg_call_97ae9d8645dc388b=function(){return yn(function(e,t){const r=K(e).call(K(t));return ge(r)},arguments)},n.wbg.__wbg_isArray_27c46c67f498e15d=function(e){return Array.isArray(K(e))},n.wbg.__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b=function(e){let t;try{t=K(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_buffer_3f3d764d4747d564=function(e){const t=K(e).buffer;return ge(t)},n.wbg.__wbg_new_8c3f0052272a457a=function(e){const t=new Uint8Array(K(e));return ge(t)},n.wbg.__wbg_set_83db9690f9353e79=function(e,t,r){K(e).set(K(t),r>>>0)},n.wbg.__wbg_length_9e1ae1900cb0fbd5=function(e){return K(e).length},n.wbg.__wbg_instanceof_Uint8Array_971eeda69eb75003=function(e){let t;try{t=K(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return ge(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const r=K(t).stack,i=jt(r,W.__wbindgen_malloc,W.__wbindgen_realloc),o=lt;ve()[e/4+1]=o,ve()[e/4+0]=i},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){try{console.error(wt(e,t))}finally{W.__wbindgen_free(e,t)}},n.wbg.__wbindgen_debug_string=function(e,t){const r=Gn(K(t)),i=jt(r,W.__wbindgen_malloc,W.__wbindgen_realloc),o=lt;ve()[e/4+1]=o,ve()[e/4+0]=i},n.wbg.__wbindgen_throw=function(e,t){throw new Error(wt(e,t))},n.wbg.__wbindgen_memory=function(){const e=W.memory;return ge(e)},n}function fa(n,e){return W=n.exports,Yi.__wbindgen_wasm_module=e,Zt=new Float64Array,Qt=new Int32Array,Vt=new Uint8Array,W}async function Yi(n){typeof n>"u"&&(n="/atip/assets/route_snapper_bg.wasm");const e=ua();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await aa(await n,e);return fa(t,r)}var qt,qn,We,tt;class ca{constructor(e,t,r){dt(this,qt);dt(this,We);this.controlDiv=r,this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new sn(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),console.log("JsRouteSnapper ready, waiting for idle event"),this.active=!1,this.loaded=!1,this.map.once("idle",()=>{console.log("JsRouteSnapper now usable"),this.map.addSource("route-snapper",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"route-points",type:"circle",source:"route-snapper",paint:{"circle-radius":["match",["get","type"],"unimportant",10/2,10],"circle-color":["match",["get","type"],"hovered","green","important","red","black"]},filter:["in","$type","Point"]}),this.map.addLayer({id:"route-lines",type:"line",source:"route-snapper",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"black","line-width":2.5},filter:["in","$type","LineString"]}),this.loaded=!0,this.map.on("mousemove",l=>{if(!this.active)return;const s={x:l.point.x-30,y:l.point.y},u=this.map.unproject(l.point).distanceTo(this.map.unproject(s));this.inner.onMouseMove(l.lngLat.lng,l.lngLat.lat,u)&&he(this,We,tt).call(this)}),this.map.on("click",()=>{this.active&&(this.inner.onClick(),he(this,We,tt).call(this))}),this.map.on("dragstart",l=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()}),this.map.on("mouseup",l=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()}),document.addEventListener("keypress",l=>{this.active&&l.key=="Enter"&&(l.preventDefault(),he(this,qt,qn).call(this))}),document.addEventListener("keydown",l=>{this.active&&l.key=="Shift"&&(l.preventDefault(),this.inner.setSnapMode(!1),he(this,We,tt).call(this))}),document.addEventListener("keyup",l=>{this.active&&l.key=="Shift"&&(l.preventDefault(),this.inner.setSnapMode(!0),he(this,We,tt).call(this))}),this.stop()})}isActive(){return this.active}tearDown(){this.loaded&&(this.map.removeLayer("route-points"),this.map.removeLayer("route-lines"),this.map.removeSource("route-snapper"))}editExisting(e){if(!this.loaded){console.error("editExisting called before the map idle event received. Not starting tool.");return}e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.start(),this.inner.editExisting(e.properties.waypoints),he(this,We,tt).call(this)}stop(){if(!this.loaded)return;this.active=!1,this.inner.clearState(),he(this,We,tt).call(this),this.controlDiv.innerHTML="";let e=document.createElement("button");e.innerText="Route tool",e.type="button",e.onclick=()=>{this.controlDiv.dispatchEvent(new CustomEvent("activate")),this.start()},this.controlDiv.appendChild(e)}start(){if(this.active)return;this.active=!0;let e=document.createElement("button");e.type="button",e.innerText="Finish route",e.onclick=()=>{he(this,qt,qn).call(this)};let t=document.createElement("button");t.type="button",t.innerText="Cancel",t.onclick=()=>{this.controlDiv.dispatchEvent(new CustomEvent("no-new-route")),this.stop()},this.controlDiv.innerHTML="";let r=document.createElement("div");r.style="display: flex; justify-content: space-evenly;",r.appendChild(e),r.appendChild(t),this.controlDiv.appendChild(r);let i=document.createElement("input");i.type="checkbox",i.id="avoidDoublingBack",i.onclick=()=>{this.inner.setConfig({avoid_doubling_back:i.checked}),he(this,We,tt).call(this)};let o=document.createElement("label");o.innerText="Avoid doubling back",o.for=i.id;let l=document.createElement("div");l.appendChild(i),l.appendChild(o),this.controlDiv.append(l);const s=document.createElement("ul");s.innerHTML="<li><b>Click</b> green points on the transport network</br>to create snapped routes</li><li>Hold <b>Shift</b> to draw a point anywhere</li><li><b>Click and drag</b> any point to move it</li><li><b>Click</b> a red waypoint to delete it</li><li>Press <b>Enter</b> to finish route</li>",this.controlDiv.appendChild(s)}}qt=new WeakSet,qn=function(){const e=this.inner.toFinalFeature();e?this.controlDiv.dispatchEvent(new CustomEvent("new-route",{detail:JSON.parse(e)})):this.controlDiv.dispatchEvent(new CustomEvent("no-new-route")),this.stop()},We=new WeakSet,tt=function(){this.loaded&&this.map.getSource("route-snapper").setData(JSON.parse(this.inner.renderGeojson()))};async function da(n,e){const t=await fetch(n),r=t.body.getReader(),i=t.headers.get("Content-Length");let o=0,l=[];for(;;){const{done:a,value:c}=await r.read();if(a)break;l.push(c),o+=c.length;const g=100*o/i;e.style=`background: linear-gradient(to right, red ${g}%, transparent 0);`}let s=new Uint8Array(o),u=0;for(let a of l)s.set(a,u),u+=a.length;return s}function ha(n){let e,t;return{c(){e=T("div"),t=T("div"),t.textContent="Route tool loading..."},m(r,i){M(r,e,i),S(e,t),n[8](t),n[9](e)},p:ne,i:ne,o:ne,d(r){r&&P(e),n[8](null),n[9](null)}}}const wn="route";function pa(n,e,t){let r;ce(n,Ze,m=>t(10,r=m));let{mode:i}=e,{changeMode:o}=e,{url:l}=e,{snapTool:s}=e,u,{routeSnapper:a}=e;function c(){a.isActive()||a.start()}function g(){a==null||a.stop()}fn(async()=>{await Yi(),console.log(`Grabbing ${l}`);try{const m=await da(l,u);t(2,a=new ca(r,m,s))}catch(m){console.log(`Route tool broke: ${m}`),t(0,s.innerHTML="Failed to load",s)}s.addEventListener("activate",()=>{o(wn)}),s.addEventListener("no-new-route",()=>{i==wn&&o("edit-attribute")}),s.addEventListener("new-route",m=>{if(i==wn){const b=m.detail;de.update(k=>(b.id=cn(k),b.properties.intervention_type="route",k.features.push(b),k)),o("edit-attribute"),Fe.set(b.id)}})}),Un(()=>{a==null||a.tearDown()});function d(m){ue[m?"unshift":"push"](()=>{u=m,t(1,u)})}function f(m){ue[m?"unshift":"push"](()=>{s=m,t(0,s)})}return n.$$set=m=>{"mode"in m&&t(3,i=m.mode),"changeMode"in m&&t(4,o=m.changeMode),"url"in m&&t(5,l=m.url),"snapTool"in m&&t(0,s=m.snapTool),"routeSnapper"in m&&t(2,a=m.routeSnapper)},[s,u,a,i,o,l,c,g,d,f]}class ma extends oe{constructor(e){super(),le(this,e,pa,ha,se,{mode:3,changeMode:4,url:5,snapTool:0,routeSnapper:2,start:6,stop:7})}get start(){return this.$$.ctx[6]}get stop(){return this.$$.ctx[7]}}function pi(n){let e;return{c(){e=T("p"),e.textContent="Click to add a new point"},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function ga(n){let e,t=n[0]==Dn&&pi();return{c(){t&&t.c(),e=ct()},m(r,i){t&&t.m(r,i),M(r,e,i)},p(r,[i]){r[0]==Dn?t||(t=pi(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(r){t&&t.d(r),r&&P(e)}}}const Dn="point";function va(n,e,t){let{mode:r}=e,{changeMode:i}=e,{pointTool:o}=e;function l(){o.start()}function s(){o.stop()}return o.addEventListener(u=>{r==Dn&&(de.update(a=>(u.id=cn(a),u.properties.intervention_type="other",a.features.push(u),a)),i("edit-attribute"),Fe.set(u.id))}),n.$$set=u=>{"mode"in u&&t(0,r=u.mode),"changeMode"in u&&t(1,i=u.changeMode),"pointTool"in u&&t(2,o=u.pointTool)},[r,i,o,l,s]}class ba extends oe{constructor(e){super(),le(this,e,va,ga,se,{mode:0,changeMode:1,pointTool:2,start:3,stop:4})}get start(){return this.$$.ctx[3]}get stop(){return this.$$.ctx[4]}}function mi(n){let e;return{c(){e=T("p"),e.innerHTML="Click the map to add a vertex, or click a vertex to delete it. Press <strong>Enter</strong> to finish. Drag a vertex or the polygon to move."},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function _a(n){let e,t=n[0]==Yn&&mi();return{c(){t&&t.c(),e=ct()},m(r,i){t&&t.m(r,i),M(r,e,i)},p(r,[i]){r[0]==Yn?t||(t=mi(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(r){t&&t.d(r),r&&P(e)}}}const Yn="polygon";function ya(n,e,t){let{mode:r}=e,{changeMode:i}=e,{polygonTool:o}=e;function l(){o.startNew()}function s(){o.stop()}return o.addEventListener(u=>{r==Yn&&(de.update(a=>(u.id=cn(a),u.properties.intervention_type="area",a.features.push(u),a)),i("edit-attribute"),Fe.set(u.id))}),n.$$set=u=>{"mode"in u&&t(0,r=u.mode),"changeMode"in u&&t(1,i=u.changeMode),"polygonTool"in u&&t(2,o=u.polygonTool)},[r,i,o,l,s]}class wa extends oe{constructor(e){super(),le(this,e,ya,_a,se,{mode:0,changeMode:1,polygonTool:2,start:3,stop:4})}get start(){return this.$$.ctx[3]}get stop(){return this.$$.ctx[4]}}function ka(n){var e=n[0],t=n[1],r=n[2],i=n[3],o=it(n.slice(0,2),[r,t]),l=it(n.slice(0,2),[e,i]);if(o>=l){var s=(t+i)/2;return[e,s-(r-e)/2,r,s+(r-e)/2]}else{var u=(e+r)/2;return[u-(i-t)/2,t,u+(i-t)/2,i]}}function Sa(n,e){e===void 0&&(e={});var t=e.precision,r=e.coordinates,i=e.mutate;if(t=t==null||isNaN(t)?6:t,r=r==null||isNaN(r)?3:r,!n)throw new Error("<geojson> is required");if(typeof t!="number")throw new Error("<precision> must be a number");if(typeof r!="number")throw new Error("<coordinates> must be a number");(i===!1||i===void 0)&&(n=JSON.parse(JSON.stringify(n)));var o=Math.pow(10,t);return pt(n,function(l){Ea(l,o,r)}),n}function Ea(n,e,t){n.length>t&&n.splice(t,n.length);for(var r=0;r<n.length;r++)n[r]=Math.round(n[r]*e)/e;return n}function Ma(n,e){if(!n)throw new Error("line is required");if(!e)throw new Error("splitter is required");var t=An(n),r=An(e);if(t!=="LineString")throw new Error("line must be LineString");if(r==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(r==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var i=Sa(e,{precision:7});switch(r){case"Point":return Xn(n,i);case"MultiPoint":return gi(n,i);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return gi(n,zi(n,i))}}function gi(n,e){var t=[],r=Mt();return mt(e,function(i){if(t.forEach(function(s,u){s.id=u}),!t.length)t=Xn(n,i).features,t.forEach(function(s){s.bbox||(s.bbox=ka(ln(s)))}),r.load(Ie(t));else{var o=r.search(i);if(o.features.length){var l=Xi(i,o);t=t.filter(function(s){return s.id!==l.id}),r.remove(l),Et(Xn(l,i),function(s){t.push(s),r.insert(s)})}}}),Ie(t)}function Xn(n,e){var t=[],r=He(n)[0],i=He(n)[n.geometry.coordinates.length-1];if(kn(r,st(e))||kn(i,st(e)))return Ie([n]);var o=Mt(),l=Nn(n);o.load(l);var s=o.search(e);if(!s.features.length)return Ie([n]);var u=Xi(e,s),a=[r],c=Ci(l,function(g,d,f){var m=He(d)[1],b=st(e);return f===u.id?(g.push(b),t.push(ke(g)),kn(b,m)?[b]:[b,m]):(g.push(m),g)},a);return c.length>1&&t.push(ke(c)),Ie(t)}function Xi(n,e){if(!e.features.length)throw new Error("lines must contain features");if(e.features.length===1)return e.features[0];var t,r=1/0;return Et(e,function(i){var o=It(i,n),l=o.properties.dist;l<r&&(t=i,r=l)}),t}function kn(n,e){return n[0]===e[0]&&n[1]===e[1]}function Pa(n,e,t){var r=He(t);if(An(t)!=="LineString")throw new Error("line must be a LineString");var i=It(t,n),o=It(t,e),l;i.properties.index<=o.properties.index?l=[i,o]:l=[o,i];for(var s=[l[0].geometry.coordinates],u=l[0].properties.index+1;u<l[1].properties.index+1;u++)s.push(r[u]);return s.push(l[1].geometry.coordinates),ke(s,t.properties)}function vi(n){let e;return{c(){e=T("p"),e.textContent="Click near a route to split it, or click on the map to cancel"},m(t,r){M(t,e,r)},d(t){t&&P(e)}}}function xa(n){let e,t=n[0]==an&&vi();return{c(){t&&t.c(),e=ct()},m(r,i){t&&t.m(r,i),M(r,e,i)},p(r,[i]){r[0]==an?t||(t=vi(),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ne,o:ne,d(r){t&&t.d(r),r&&P(e)}}}const an="split-route",La=10,Ta=30;let Sn="split-route";function Ji(){}function bi(n,e){return{type:"Feature",properties:{snapped:e},geometry:{type:"Point",coordinates:n}}}function Ca(n,e,t){let r,i;ce(n,Ze,d=>t(5,r=d)),ce(n,de,d=>t(7,i=d));let{mode:o}=e,{changeMode:l}=e;function s(){t(4,u=null),a=null}let u=null,a=null;r.on("mousemove",d=>{if(o!=an)return;t(4,u=bi(d.lngLat.toArray(),!1)),a=null;const f=[d.point.x-Ta,d.point.y],m=r.unproject(d.point).distanceTo(r.unproject(f))/1e3;let b=[];for(let[k,C]of i.features.entries())if(C.geometry.type=="LineString"){let h=It(C.geometry,u,{units:"kilometers"});h.properties.dist<=m&&b.push([k,h.geometry.coordinates,h.properties.dist])}b.sort((k,C)=>k[2]-C[2]),b.length>0&&(t(4,u=bi(b[0][1],!0)),a=b[0][0])}),r.on("click",()=>{if(o==an)if(a==null)l("edit-attribute");else{let d=Ma(i.features[a],u);if(d.features.length==2){let f=d.features[0],m=d.features[1];de.update(b=>(f.id=b.features[a].id,m.id=cn(b),f.properties=JSON.parse(JSON.stringify(b.features[a].properties)),m.properties=JSON.parse(JSON.stringify(f.properties)),c(b.features[a],f,m,u),b.features.splice(a,1,f,m),b))}s()}}),Pt(r,Sn,{type:"geojson",data:et()}),Te(r,{id:"draw-split-route",source:Sn,...Dt("black",La,["case",["==",["get","snapped"],!0],1,.5])});function c(d,f,m,b){f.properties.length_meters=Ht(f,{units:"kilometers"})*1e3,m.properties.length_meters=Ht(m,{units:"kilometers"})*1e3,f.properties.waypoints=[],m.properties.waypoints=[];let k=g(d,b),C=!0,h=0;for(let p of d.properties.waypoints){let v=g(d,we([p.lon,p.lat]));if(C)if(v<k)f.properties.waypoints.push(p);else{let w=p.snapped&&d.properties.waypoints[h-1].snapped;f.properties.waypoints.push({lon:b.geometry.coordinates[0],lat:b.geometry.coordinates[1],snapped:w}),C=!1,m.properties.waypoints.push({lon:b.geometry.coordinates[0],lat:b.geometry.coordinates[1],snapped:w}),m.properties.waypoints.push(p)}else m.properties.waypoints.push(p);h++}}function g(d,f){let m=d.geometry.coordinates[0],b=Pa(m,f,d);return Ht(b,{units:"kilometers"})*1e3}return n.$$set=d=>{"mode"in d&&t(0,o=d.mode),"changeMode"in d&&t(1,l=d.changeMode)},n.$$.update=()=>{if(n.$$.dirty&48){let d=et();u&&d.features.push(u),r.getSource(Sn).setData(d)}},[o,l,Ji,s,u,r]}class Ra extends oe{constructor(e){super(),le(this,e,Ca,xa,se,{mode:0,changeMode:1,start:2,stop:3})}get start(){return Ji}get stop(){return this.$$.ctx[3]}}function _i(n){let e,t,r={mode:n[3],routeSnapper:n[1],snapTool:n[2],pointTool:n[10],polygonTool:n[11]};return e=new ra({props:r}),n[16](e),{c(){H(e.$$.fragment)},m(i,o){V(e,i,o),t=!0},p(i,o){const l={};o&8&&(l.mode=i[3]),o&2&&(l.routeSnapper=i[1]),o&4&&(l.snapTool=i[2]),e.$set(l)},i(i){t||(I(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){n[16](null),Z(e,i)}}}function Aa(n){let e,t,r,i,o,l,s,u,a,c,g,d,f,m,b,k,C,h,p,v,w,_,O,x,F,q,E,B,N,R,G,J,te,$,ee,ae,re,y,U,Ge,xt,Yt,mn={mode:n[3],changeMode:n[12]};s=new ea({props:mn}),n[14](s);let me=n[1]&&n[2]&&_i(n),Y={mode:n[3],changeMode:n[12],pointTool:n[10]};v=new ba({props:Y}),n[18](v);let Ui={mode:n[3],changeMode:n[12],polygonTool:n[11]};E=new wa({props:Ui}),n[20](E);function ji(Q){n[22](Q)}function Wi(Q){n[23](Q)}let gn={mode:n[3],changeMode:n[12],url:n[0]};n[1]!==void 0&&(gn.routeSnapper=n[1]),n[2]!==void 0&&(gn.snapTool=n[2]),R=new ma({props:gn}),n[21](R),ue.push(()=>De(R,"routeSnapper",ji,n[1])),ue.push(()=>De(R,"snapTool",Wi,n[2]));let Hi={mode:n[3],changeMode:n[12]};return U=new Ra({props:Hi}),n[25](U),{c(){e=T("div"),t=T("div"),r=T("button"),i=j("Edit attributes"),l=z(),H(s.$$.fragment),u=z(),a=T("div"),c=T("button"),g=j("Edit geometry"),f=z(),me&&me.c(),m=z(),b=T("div"),k=T("button"),C=j("New point"),p=z(),H(v.$$.fragment),w=z(),_=T("div"),O=T("button"),x=j("New polygon"),q=z(),H(E.$$.fragment),B=z(),N=T("div"),H(R.$$.fragment),te=z(),$=T("div"),ee=T("button"),ae=j("Split route"),y=z(),H(U.$$.fragment),A(r,"type","button"),r.disabled=o=n[3]=="edit-attribute",A(r,"class","svelte-cej5os"),A(c,"type","button"),c.disabled=d=n[3]=="edit-geometry",A(c,"class","svelte-cej5os"),A(k,"type","button"),k.disabled=h=n[3]=="point",A(k,"class","svelte-cej5os"),A(O,"type","button"),O.disabled=F=n[3]=="polygon",A(O,"class","svelte-cej5os"),A(ee,"type","button"),ee.disabled=re=n[3]=="split-route",A(ee,"class","svelte-cej5os"),A(e,"class","toolbox svelte-cej5os")},m(Q,be){M(Q,e,be),S(e,t),S(t,r),S(r,i),S(t,l),V(s,t,null),S(e,u),S(e,a),S(a,c),S(c,g),S(a,f),me&&me.m(a,null),S(e,m),S(e,b),S(b,k),S(k,C),S(b,p),V(v,b,null),S(e,w),S(e,_),S(_,O),S(O,x),S(_,q),V(E,_,null),S(e,B),S(e,N),V(R,N,null),S(e,te),S(e,$),S($,ee),S(ee,ae),S($,y),V(U,$,null),Ge=!0,xt||(Yt=[X(r,"click",n[13]),X(c,"click",n[15]),X(k,"click",n[17]),X(O,"click",n[19]),X(ee,"click",n[24])],xt=!0)},p(Q,[be]){(!Ge||be&8&&o!==(o=Q[3]=="edit-attribute"))&&(r.disabled=o);const ir={};be&8&&(ir.mode=Q[3]),s.$set(ir),(!Ge||be&8&&d!==(d=Q[3]=="edit-geometry"))&&(c.disabled=d),Q[1]&&Q[2]?me?(me.p(Q,be),be&6&&I(me,1)):(me=_i(Q),me.c(),I(me,1),me.m(a,null)):me&&(Me(),D(me,1,1,()=>{me=null}),Pe()),(!Ge||be&8&&h!==(h=Q[3]=="point"))&&(k.disabled=h);const or={};be&8&&(or.mode=Q[3]),v.$set(or),(!Ge||be&8&&F!==(F=Q[3]=="polygon"))&&(O.disabled=F);const lr={};be&8&&(lr.mode=Q[3]),E.$set(lr);const Lt={};be&8&&(Lt.mode=Q[3]),be&1&&(Lt.url=Q[0]),!G&&be&2&&(G=!0,Lt.routeSnapper=Q[1],Ye(()=>G=!1)),!J&&be&4&&(J=!0,Lt.snapTool=Q[2],Ye(()=>J=!1)),R.$set(Lt),(!Ge||be&8&&re!==(re=Q[3]=="split-route"))&&(ee.disabled=re);const sr={};be&8&&(sr.mode=Q[3]),U.$set(sr)},i(Q){Ge||(I(s.$$.fragment,Q),I(me),I(v.$$.fragment,Q),I(E.$$.fragment,Q),I(R.$$.fragment,Q),I(U.$$.fragment,Q),Ge=!0)},o(Q){D(s.$$.fragment,Q),D(me),D(v.$$.fragment,Q),D(E.$$.fragment,Q),D(R.$$.fragment,Q),D(U.$$.fragment,Q),Ge=!1},d(Q){Q&&P(e),n[14](null),Z(s),me&&me.d(),n[18](null),Z(v),n[20](null),Z(E),n[21](null),Z(R),n[25](null),Z(U),xt=!1,Je(Yt)}}}function Oa(n,e,t){let r;ce(n,Ze,R=>t(26,r=R));let{routeUrl:i}=e,o,l,s=new zs(r),u=new Qs(r),a="edit-attribute",c,g,d,f,m,b;function k(R){let G={"edit-attribute":c,"edit-geometry":g,route:d,point:f,polygon:m,"split-route":b};if(a==R){console.log(`Mode is already ${a}, not changing`);return}console.log(`Stopping old mode ${a}`),G[a].stop(),t(3,a=R),console.log(`Starting new mode ${a}`),G[a].start()}Un(()=>{s==null||s.tearDown(),u==null||u.tearDown()});const C=()=>k("edit-attribute");function h(R){ue[R?"unshift":"push"](()=>{c=R,t(4,c)})}const p=()=>k("edit-geometry");function v(R){ue[R?"unshift":"push"](()=>{g=R,t(5,g)})}const w=()=>k("point");function _(R){ue[R?"unshift":"push"](()=>{f=R,t(7,f)})}const O=()=>k("polygon");function x(R){ue[R?"unshift":"push"](()=>{m=R,t(8,m)})}function F(R){ue[R?"unshift":"push"](()=>{d=R,t(6,d)})}function q(R){o=R,t(1,o)}function E(R){l=R,t(2,l)}const B=()=>k("split-route");function N(R){ue[R?"unshift":"push"](()=>{b=R,t(9,b)})}return n.$$set=R=>{"routeUrl"in R&&t(0,i=R.routeUrl)},[i,o,l,a,c,g,d,f,m,b,s,u,k,C,h,p,v,w,_,O,x,F,q,E,B,N]}class Na extends oe{constructor(e){super(),le(this,e,Oa,Aa,se,{routeUrl:0})}}function Fa(n){let e,t,r,i,o,l,s,u;return{c(){e=T("div"),t=T("button"),t.textContent="Home",r=z(),i=T("button"),i.textContent="About",o=z(),l=T("button"),l.textContent="Instructions",A(t,"type","button"),A(i,"type","button"),A(l,"type","button"),A(e,"slot","nav")},m(a,c){M(a,e,c),S(e,t),S(e,r),S(e,i),S(e,o),S(e,l),s||(u=[X(t,"click",n[8]),X(i,"click",n[6]),X(l,"click",n[7])],s=!0)},p:ne,d(a){a&&P(e),s=!1,Je(u)}}}function Ia(n){let e,t,r,i,o,l,s,u,a,c,g,d;return o=new Ls({props:{boundaryGeojson:n[3]}}),s=new Es({props:{authorityName:n[4]}}),g=new cs({}),{c(){e=T("div"),t=T("h1"),r=j(n[4]),i=z(),H(o.$$.fragment),l=z(),H(s.$$.fragment),u=z(),a=T("br"),c=z(),H(g.$$.fragment),A(e,"slot","sidebar")},m(f,m){M(f,e,m),S(e,t),S(t,r),S(t,i),V(o,t,null),S(e,l),V(s,e,null),S(e,u),S(e,a),S(e,c),V(g,e,null),d=!0},p(f,m){const b={};m&8&&(b.boundaryGeojson=f[3]),o.$set(b)},i(f){d||(I(o.$$.fragment,f),I(s.$$.fragment,f),I(g.$$.fragment,f),d=!0)},o(f){D(o.$$.fragment,f),D(s.$$.fragment,f),D(g.$$.fragment,f),d=!1},d(f){f&&P(e),Z(o),Z(s),Z(g)}}}function Ba(n){let e,t,r,i,o,l,s,u,a,c,g,d;return e=new es({props:{boundaryGeojson:n[3]}}),r=new Fs({}),o=new Bs({}),s=new Na({props:{routeUrl:n[2]}}),a=new Rs({props:{style:n[5]}}),g=new Os({}),{c(){H(e.$$.fragment),t=z(),H(r.$$.fragment),i=z(),H(o.$$.fragment),l=z(),H(s.$$.fragment),u=z(),H(a.$$.fragment),c=z(),H(g.$$.fragment)},m(f,m){V(e,f,m),M(f,t,m),V(r,f,m),M(f,i,m),V(o,f,m),M(f,l,m),V(s,f,m),M(f,u,m),V(a,f,m),M(f,c,m),V(g,f,m),d=!0},p(f,m){const b={};m&8&&(b.boundaryGeojson=f[3]),e.$set(b);const k={};m&4&&(k.routeUrl=f[2]),s.$set(k)},i(f){d||(I(e.$$.fragment,f),I(r.$$.fragment,f),I(o.$$.fragment,f),I(s.$$.fragment,f),I(a.$$.fragment,f),I(g.$$.fragment,f),d=!0)},o(f){D(e.$$.fragment,f),D(r.$$.fragment,f),D(o.$$.fragment,f),D(s.$$.fragment,f),D(a.$$.fragment,f),D(g.$$.fragment,f),d=!1},d(f){Z(e,f),f&&P(t),Z(r,f),f&&P(i),Z(o,f),f&&P(l),Z(s,f),f&&P(u),Z(a,f),f&&P(c),Z(g,f)}}}function za(n){let e,t,r;return t=new sl({props:{style:n[5],$$slots:{default:[Ba]},$$scope:{ctx:n}}}),{c(){e=T("div"),H(t.$$.fragment),A(e,"slot","main")},m(i,o){M(i,e,o),V(t,e,null),r=!0},p(i,o){const l={};o&16396&&(l.$$scope={dirty:o,ctx:i}),t.$set(l)},i(i){r||(I(t.$$.fragment,i),r=!0)},o(i){D(t.$$.fragment,i),r=!1},d(i){i&&P(e),Z(t)}}}function Ga(n){let e,t,r,i,o,l,s,u;e=new hl({props:{$$slots:{main:[za],sidebar:[Ia],nav:[Fa]},$$scope:{ctx:n}}});function a(f){n[9](f)}let c={};n[0]!==void 0&&(c.open=n[0]),r=new oo({props:c}),ue.push(()=>De(r,"open",a,n[0]));function g(f){n[10](f)}let d={};return n[1]!==void 0&&(d.open=n[1]),l=new rl({props:d}),ue.push(()=>De(l,"open",g,n[1])),{c(){H(e.$$.fragment),t=z(),H(r.$$.fragment),o=z(),H(l.$$.fragment)},m(f,m){V(e,f,m),M(f,t,m),V(r,f,m),M(f,o,m),V(l,f,m),u=!0},p(f,[m]){const b={};m&16396&&(b.$$scope={dirty:m,ctx:f}),e.$set(b);const k={};!i&&m&1&&(i=!0,k.open=f[0],Ye(()=>i=!1)),r.$set(k);const C={};!s&&m&2&&(s=!0,C.open=f[1],Ye(()=>s=!1)),l.$set(C)},i(f){u||(I(e.$$.fragment,f),I(r.$$.fragment,f),I(l.$$.fragment,f),u=!0)},o(f){D(e.$$.fragment,f),D(r.$$.fragment,f),D(l.$$.fragment,f),u=!1},d(f){Z(e,f),f&&P(t),Z(r,f),f&&P(o),Z(l,f)}}}function qa(n,e,t){let r=!1,i=!1,o=window.location.hostname.includes("atip.uk");const l=new URLSearchParams(window.location.search);let s=l.get("authority"),u=l.get("style")||"streets";var a=`https://atip.uk/route-snappers/${s}.bin`;o||(a=`https://atip.uk/route-snappers-dev/${s}.bin`);function c(){t(0,r=!r),t(1,i=!1)}function g(){t(1,i=!i),t(0,r=!1)}let d;fn(async()=>{t(3,d=await f())});async function f(){const h=await(await fetch(lo)).text(),p=JSON.parse(h);return p.features=p.features.filter(v=>v.properties.name==s),p}const m=()=>window.open("index.html");function b(C){r=C,t(0,r)}function k(C){i=C,t(1,i)}return[r,i,a,d,s,u,c,g,m,b,k]}class Da extends oe{constructor(e){super(),le(this,e,qa,Ga,se,{})}}new Da({target:document.getElementById("app")});
