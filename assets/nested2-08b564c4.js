import{S as Ce,i as Oe,s as Fe,F as je,H as F,I as j,t as $,j as h,L as M,o as ne,e as T,a2 as Me,r as D,au as Ie,d as b,v as g,av as ie,l as Ne,k as w,y as Ae,at as ze,A as ee,p as C,w as Z,U as ue,M as Ee,a3 as Je,C as le,G as Te,q as L,am as ce,O as re,J as se,Q as me,N as Ge,D as _e,E as pe,K as ge,x as Pe}from"./maplibre_helpers-09c65b90.js";import{i as qe}from"./all-cc94300b.js";import{L as De,Z as He,C as Be,p as Ue,g as te,I as Ze,B as Ke,q as Qe,M as Re,m as Ve}from"./ZoomOutMap-bbe13584.js";function $e(r,e,t){const n=r.slice();return n[6]=e[t][0],n[7]=e[t][1],n}function de(r){let e;return{c(){e=T("option"),e.__value="",ee(e,e.__value)},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function he(r){let e,t=r[7]+"",n,l;return{c(){e=T("option"),n=C(t),e.__value=l=r[6],ee(e,e.__value)},m(s,u){b(s,e,u),g(e,n)},p(s,u){u&8&&t!==(t=s[7]+"")&&Z(n,t),u&8&&l!==(l=s[6])&&(e.__value=l,ee(e,e.__value))},d(s){s&&w(e)}}}function We(r){let e,t,n,l,s=r[4]&&de(),u=ne(r[3]),o=[];for(let f=0;f<u.length;f+=1)o[f]=he($e(r,u,f));return{c(){e=T("select"),s&&s.c(),t=Me();for(let f=0;f<o.length;f+=1)o[f].c();D(e,"class","govuk-select"),D(e,"id",r[2]),r[0]===void 0&&Ie(()=>r[5].call(e))},m(f,a){b(f,e,a),s&&s.m(e,null),g(e,t);for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(e,null);ie(e,r[0],!0),n||(l=Ne(e,"change",r[5]),n=!0)},p(f,a){if(f[4]?s||(s=de(),s.c(),s.m(e,t)):s&&(s.d(1),s=null),a&8){u=ne(f[3]);let i;for(i=0;i<u.length;i+=1){const O=$e(f,u,i);o[i]?o[i].p(O,a):(o[i]=he(O),o[i].c(),o[i].m(e,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=u.length}a&4&&D(e,"id",f[2]),a&9&&ie(e,f[0])},d(f){f&&w(e),s&&s.d(),Ae(o,f),n=!1,l()}}}function Xe(r){let e,t;return e=new je({props:{label:r[1],id:r[2],$$slots:{default:[We]},$$scope:{ctx:r}}}),{c(){F(e.$$.fragment)},m(n,l){j(e,n,l),t=!0},p(n,[l]){const s={};l&2&&(s.label=n[1]),l&4&&(s.id=n[2]),l&1053&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){h(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function Ye(r,e,t){let{label:n}=e,{id:l}=e,{choices:s}=e,{emptyOption:u=!0}=e,{value:o}=e;function f(){o=ze(this),t(0,o),t(3,s)}return r.$$set=a=>{"label"in a&&t(1,n=a.label),"id"in a&&t(2,l=a.id),"choices"in a&&t(3,s=a.choices),"emptyOption"in a&&t(4,u=a.emptyOption),"value"in a&&t(0,o=a.value)},[o,n,l,s,u,f]}class be extends Ce{constructor(e){super(),Oe(this,e,Ye,Xe,Fe,{label:1,id:2,choices:3,emptyOption:4,value:0})}}function we(r,e,t){const n=r.slice();return n[24]=e[t],n}function xe(r){let e;return{c(){e=C("Home")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function ve(r){let e,t;return e=new Ge({props:{errorMessage:r[7]}}),{c(){F(e.$$.fragment)},m(n,l){j(e,n,l),t=!0},p(n,l){const s={};l&128&&(s.errorMessage=n[7]),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){h(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function et(r){let e;return{c(){e=C("Clear")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function tt(r){let e,t,n,l,s,u;return n=new le({props:{$$slots:{default:[et]},$$scope:{ctx:r}}}),n.$on("click",r[18]),{c(){e=T("input"),t=L(),F(n.$$.fragment),D(e,"type","text"),D(e,"class","govuk-input govuk-input--width-10"),D(e,"id","filterText")},m(o,f){b(o,e,f),ee(e,r[1]),b(o,t,f),j(n,o,f),l=!0,s||(u=Ne(e,"input",r[17]),s=!0)},p(o,f){f&2&&e.value!==o[1]&&ee(e,o[1]);const a={};f&134217728&&(a.$$scope={dirty:f,ctx:o}),n.$set(a)},i(o){l||($(n.$$.fragment,o),l=!0)},o(o){h(n.$$.fragment,o),l=!1},d(o){o&&(w(e),w(t)),M(n,o),s=!1,u()}}}function nt(r){let e,t,n,l,s,u,o,f;function a(c){r[15](c)}let i={label:"Authority or region",id:"filterAuthority",choices:r[8]};r[4]!==void 0&&(i.value=r[4]),e=new be({props:i}),_e.push(()=>pe(e,"value",a));function O(c){r[16](c)}let I={label:"Funding programme",id:"filterFundingProgramme",choices:r[9]};return r[5]!==void 0&&(I.value=r[5]),l=new be({props:I}),_e.push(()=>pe(l,"value",O)),o=new je({props:{label:"Any field",id:"filterText",$$slots:{default:[tt]},$$scope:{ctx:r}}}),{c(){F(e.$$.fragment),n=L(),F(l.$$.fragment),u=L(),F(o.$$.fragment)},m(c,p){j(e,c,p),b(c,n,p),j(l,c,p),b(c,u,p),j(o,c,p),f=!0},p(c,p){const N={};p&256&&(N.choices=c[8]),!t&&p&16&&(t=!0,N.value=c[4],ge(()=>t=!1)),e.$set(N);const A={};p&512&&(A.choices=c[9]),!s&&p&32&&(s=!0,A.value=c[5],ge(()=>s=!1)),l.$set(A);const z={};p&134217730&&(z.$$scope={dirty:p,ctx:c}),o.$set(z)},i(c){f||($(e.$$.fragment,c),$(l.$$.fragment,c),$(o.$$.fragment,c),f=!0)},o(c){h(e.$$.fragment,c),h(l.$$.fragment,c),h(o.$$.fragment,c),f=!1},d(c){c&&(w(n),w(u)),M(e,c),M(l,c),M(o,c)}}}function ke(r){let e,t;return e=new Be({props:{label:`${r[24].scheme_reference}: ${r[24].num_features} features`,$$slots:{default:[st]},$$scope:{ctx:r}}}),{c(){F(e.$$.fragment)},m(n,l){j(e,n,l),t=!0},p(n,l){const s={};l&1&&(s.label=`${n[24].scheme_reference}: ${n[24].num_features} features`),l&134217729&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){h(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}function lt(r){let e;return{c(){e=C("Show on map")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function rt(r){let e;return{c(){e=C("Edit scheme")},m(t,n){b(t,e,n)},d(t){t&&w(e)}}}function st(r){let e,t,n=r[24].authority_or_region+"",l,s,u,o,f=r[24].capital_scheme_id+"",a,i,O,I,c=r[24].funding_programme+"",p,N,A,z,K,E,H,G;function Q(){return r[19](r[24])}z=new le({props:{$$slots:{default:[lt]},$$scope:{ctx:r}}}),z.$on("click",Q);function V(){return r[20](r[24])}return E=new le({props:{$$slots:{default:[rt]},$$scope:{ctx:r}}}),E.$on("click",V),{c(){e=T("p"),t=C("Authority or region: "),l=C(n),s=L(),u=T("p"),o=C("Capital scheme ID: "),a=C(f),i=L(),O=T("p"),I=C("Funding programme: "),p=C(c),N=L(),A=T("div"),F(z.$$.fragment),K=L(),F(E.$$.fragment),H=L(),D(A,"class","govuk-button-group")},m(k,y){b(k,e,y),g(e,t),g(e,l),b(k,s,y),b(k,u,y),g(u,o),g(u,a),b(k,i,y),b(k,O,y),g(O,I),g(O,p),b(k,N,y),b(k,A,y),j(z,A,null),g(A,K),j(E,A,null),b(k,H,y),G=!0},p(k,y){r=k,(!G||y&1)&&n!==(n=r[24].authority_or_region+"")&&Z(l,n),(!G||y&1)&&f!==(f=r[24].capital_scheme_id+"")&&Z(a,f),(!G||y&1)&&c!==(c=r[24].funding_programme+"")&&Z(p,c);const R={};y&134217728&&(R.$$scope={dirty:y,ctx:r}),z.$set(R);const _={};y&134217728&&(_.$$scope={dirty:y,ctx:r}),E.$set(_)},i(k){G||($(z.$$.fragment,k),$(E.$$.fragment,k),G=!0)},o(k){h(z.$$.fragment,k),h(E.$$.fragment,k),G=!1},d(k){k&&(w(e),w(s),w(u),w(i),w(O),w(N),w(A),w(H)),M(z),M(E)}}}function ye(r){let e=r[2].has(r[24].scheme_reference),t,n,l=e&&ke(r);return{c(){l&&l.c(),t=Me()},m(s,u){l&&l.m(s,u),b(s,t,u),n=!0},p(s,u){u&5&&(e=s[2].has(s[24].scheme_reference)),e?l?(l.p(s,u),u&5&&$(l,1)):(l=ke(s),l.c(),$(l,1),l.m(t.parentNode,t)):l&&(re(),h(l,1,1,()=>{l=null}),se())},i(s){n||($(l),n=!0)},o(s){h(l),n=!1},d(s){s&&w(t),l&&l.d(s)}}}function ot(r){let e,t,n,l,s,u,o,f,a,i,O,I,c,p,N,A=r[2].size+"",z,K,E=r[3].route+"",H,G,Q=r[3].area+"",V,k,y=r[3].crossing+"",R,_,d=r[3].other+"",q,W,P,x,U;t=new le({props:{$$slots:{default:[xe]},$$scope:{ctx:r}}}),t.$on("click",r[14]),o=new He({props:{boundaryGeojson:r[6]}});let B=r[7]&&ve(r);i=new Te({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:r[11]}}),I=new Be({props:{label:"Filters",$$slots:{default:[nt]},$$scope:{ctx:r}}});let X=ne(r[0]),S=[];for(let m=0;m<X.length;m+=1)S[m]=ye(we(r,X,m));const Le=m=>h(S[m],1,1,()=>{S[m]=null});return{c(){e=T("div"),F(t.$$.fragment),n=L(),l=T("div"),s=T("h1"),s.textContent="Browse schemes",u=L(),F(o.$$.fragment),f=L(),B&&B.c(),a=L(),F(i.$$.fragment),O=L(),F(I.$$.fragment),c=L(),p=T("p"),N=C("Showing "),z=C(A),K=C(" schemes ("),H=C(E),G=C(" routes, "),V=C(Q),k=C(` areas,
      `),R=C(y),_=C(" crossings, "),q=C(d),W=C(" other)"),P=L(),x=T("ul");for(let m=0;m<S.length;m+=1)S[m].c();ce(l,"display","flex"),ce(l,"justify-content","space-between"),D(e,"slot","sidebar"),D(e,"class","govuk-prose")},m(m,v){b(m,e,v),j(t,e,null),g(e,n),g(e,l),g(l,s),g(l,u),j(o,l,null),g(e,f),B&&B.m(e,null),g(e,a),j(i,e,null),g(e,O),j(I,e,null),g(e,c),g(e,p),g(p,N),g(p,z),g(p,K),g(p,H),g(p,G),g(p,V),g(p,k),g(p,R),g(p,_),g(p,q),g(p,W),g(e,P),g(e,x);for(let Y=0;Y<S.length;Y+=1)S[Y]&&S[Y].m(x,null);U=!0},p(m,v){const Y={};v&134217728&&(Y.$$scope={dirty:v,ctx:m}),t.$set(Y);const oe={};v&64&&(oe.boundaryGeojson=m[6]),o.$set(oe),m[7]?B?(B.p(m,v),v&128&&$(B,1)):(B=ve(m),B.c(),$(B,1),B.m(e,a)):B&&(re(),h(B,1,1,()=>{B=null}),se());const ae={};if(v&134218546&&(ae.$$scope={dirty:v,ctx:m}),I.$set(ae),(!U||v&4)&&A!==(A=m[2].size+"")&&Z(z,A),(!U||v&8)&&E!==(E=m[3].route+"")&&Z(H,E),(!U||v&8)&&Q!==(Q=m[3].area+"")&&Z(V,Q),(!U||v&8)&&y!==(y=m[3].crossing+"")&&Z(R,y),(!U||v&8)&&d!==(d=m[3].other+"")&&Z(q,d),v&12293){X=ne(m[0]);let J;for(J=0;J<X.length;J+=1){const fe=we(m,X,J);S[J]?(S[J].p(fe,v),$(S[J],1)):(S[J]=ye(fe),S[J].c(),$(S[J],1),S[J].m(x,null))}for(re(),J=X.length;J<S.length;J+=1)Le(J);se()}},i(m){if(!U){$(t.$$.fragment,m),$(o.$$.fragment,m),$(B),$(i.$$.fragment,m),$(I.$$.fragment,m);for(let v=0;v<X.length;v+=1)$(S[v]);U=!0}},o(m){h(t.$$.fragment,m),h(o.$$.fragment,m),h(B),h(i.$$.fragment,m),h(I.$$.fragment,m),S=S.filter(Boolean);for(let v=0;v<S.length;v+=1)h(S[v]);U=!1},d(m){m&&w(e),M(t),M(o),B&&B.d(),M(i),M(I),Ae(S,m)}}}function at(r){let e,t,n,l,s,u,o,f;return e=new Ze({props:{schema:Se}}),n=new Ke({props:{style:r[10]}}),s=new Qe({props:{schema:Se}}),o=new Re({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:ut}}),{c(){F(e.$$.fragment),t=L(),F(n.$$.fragment),l=L(),F(s.$$.fragment),u=L(),F(o.$$.fragment)},m(a,i){j(e,a,i),b(a,t,i),j(n,a,i),b(a,l,i),j(s,a,i),b(a,u,i),j(o,a,i),f=!0},p:Pe,i(a){f||($(e.$$.fragment,a),$(n.$$.fragment,a),$(s.$$.fragment,a),$(o.$$.fragment,a),f=!0)},o(a){h(e.$$.fragment,a),h(n.$$.fragment,a),h(s.$$.fragment,a),h(o.$$.fragment,a),f=!1},d(a){a&&(w(t),w(l),w(u)),M(e,a),M(n,a),M(s,a),M(o,a)}}}function ft(r){let e,t,n;return t=new Ue({props:{style:r[10],$$slots:{default:[at]},$$scope:{ctx:r}}}),{c(){e=T("div"),F(t.$$.fragment),D(e,"slot","main")},m(l,s){b(l,e,s),j(t,e,null),n=!0},p(l,s){const u={};s&134217728&&(u.$$scope={dirty:s,ctx:l}),t.$set(u)},i(l){n||($(t.$$.fragment,l),n=!0)},o(l){h(t.$$.fragment,l),n=!1},d(l){l&&w(e),M(t)}}}function it(r){let e,t;return e=new De({props:{$$slots:{main:[ft],sidebar:[ot]},$$scope:{ctx:r}}}),{c(){F(e.$$.fragment)},m(n,l){j(e,n,l),t=!0},p(n,[l]){const s={};l&134218751&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){h(e.$$.fragment,n),t=!1},d(n){M(e,n)}}}const Se="v1";function ut(r){var e="<table>";for(let[t,n]of Object.entries(r))e+=`<tr><td>${t}</td><td>${n}</td></tr>`;return e+="</table>",e}function ct(r,e,t){let n,l;ue(r,te,_=>t(6,n=_)),ue(r,Ve,_=>t(21,l=_)),Ee(()=>{qe()});let u=new URLSearchParams(window.location.search).get("style")||"streets",o="",f=[],a="",i=new Set,O={area:0,route:0,crossing:0,other:0},I=[],c="",p=[],N="";Je(()=>{te.set(null)});function A(_){try{let d=JSON.parse(_);te.set(d),z(d),t(7,o=""),l==null||l.fitBounds(me(d),{padding:20,animate:!1})}catch(d){t(7,o=`Couldn't load schemes from a file: ${d}`)}}function z(_){let d={};for(let[P,x]of Object.entries(_.schemes))d[P]={scheme_reference:P,num_features:0,...x};for(let P of _.features)d[P.properties.scheme_reference].num_features++;t(0,f=Object.values(d));let q=new Set,W=new Set;for(let P of f)P.authority_or_region&&q.add(P.authority_or_region),P.funding_programme&&W.add(P.funding_programme);t(8,I=Array.from(q.entries())),I.sort(),t(9,p=Array.from(W.entries())),p.sort()}function K(_){let d={type:"FeatureCollection",features:n.features.filter(q=>q.properties.scheme_reference==_.scheme_reference)};l==null||l.fitBounds(me(d),{padding:20,animate:!1})}function E(_){let d={type:"FeatureCollection",features:n.features.filter(W=>W.properties.scheme_reference==_.scheme_reference)},q=_.authority_or_region;window.localStorage.setItem(q,JSON.stringify(d)),window.open(`scheme.html?authority=${_.authority_or_region}`,"_blank")}const H=()=>window.open("index.html");function G(_){c=_,t(4,c)}function Q(_){N=_,t(5,N)}function V(){a=this.value,t(1,a)}const k=()=>t(1,a=""),y=_=>K(_),R=_=>E(_);return r.$$.update=()=>{if(r.$$.dirty&127&&n){if(i.clear(),a||c||N){let _=a.toLowerCase();for(let d of n.features)JSON.stringify(d.properties).toLowerCase().includes(_)&&(c&&d.properties.authority_or_region!=c||N&&d.properties.funding_programme!=N||i.add(d.properties.scheme_reference))}else for(let _ of f)i.add(_.scheme_reference);te.update(_=>{if(!_)return null;for(let d of _.features)i.has(d.properties.scheme_reference)?delete d.properties.hide_while_editing:d.properties.hide_while_editing=!0;return _}),t(3,O={area:0,route:0,crossing:0,other:0});for(let _ of n==null?void 0:n.features)i.has(_.properties.scheme_reference)&&t(3,O[_.properties.intervention_type]++,O);t(2,i),t(6,n),t(1,a),t(4,c),t(5,N),t(0,f),t(3,O)}},[f,a,i,O,c,N,n,o,I,p,u,A,K,E,H,G,Q,V,k,y,R]}class mt extends Ce{constructor(e){super(),Oe(this,e,ct,it,Fe,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new mt({target:document.getElementById("app")});
