import{S as F,i as z,s as G,b as V,c as K,I as Y,g as _,f as A,m as w,j as m,o as Z,t as g,l as d,p as h,q as k,Z as q,B as X,aV as _e,a6 as we,D as pe,u as b,x as ee,e as O,h as I,aU as H,k as S,U as Ee,W as de,V as et,T as ae,y as ye,n as Le,a0 as Se,aW as Mt,$ as st,a7 as Et,ay as sn,a1 as Ue,r as ot,F as on,a as je,v as mt,w as ln,G as xt,K as Pt,L as Ut,M as Ht,C as Wt,aX as ht,af as Rt,d as an,z as fn,a8 as un,aO as cn,E as $n,ac as pn}from"./MapLibreMap.svelte_svelte_type_style_lang-f203533d.js";import{d as Q,j as me,H as te,S as tt,h as mn,i as gt,g as It,C as Ae,a as hn,L as gn,Z as dn,M as _n,I as wn,B as kn,b as lt}from"./schemas-a086ad29.js";const bn=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"],j={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function vn(s){let e,n,t;return e=new me({props:{color:j.bus_route_with_lane}}),{c(){_(e.$$.fragment),n=b(`
  Bus routes`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function yn(s){let e;return{c(){e=b(`GTFS
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ln(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Sn(s){let e,n,t,r,o,i,c,l,u,a,f;return o=new H({props:{href:"https://gtfs.org",$$slots:{default:[yn]},$$scope:{ctx:s}}}),a=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ln]},$$scope:{ctx:s}}}),{c(){e=O("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,n=A(),t=O("p"),r=b("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(o.$$.fragment),i=b(`, and doesn't include which routes are run or the
        frequency of service.`),c=A(),l=O("p"),u=b("License: "),_(a.$$.fragment)},m($,p){m($,e,p),m($,n,p),m($,t,p),S(t,r),w(o,t,null),S(t,i),m($,c,p),m($,l,p),S(l,u),w(a,l,null),f=!0},p($,p){const y={};p&8&&(y.$$scope={dirty:p,ctx:$}),o.$set(y);const v={};p&8&&(v.$$scope={dirty:p,ctx:$}),a.$set(v)},i($){f||(g(o.$$.fragment,$),g(a.$$.fragment,$),f=!0)},o($){d(o.$$.fragment,$),d(a.$$.fragment,$),f=!1},d($){$&&(h(e),h(n),h(t),h(c),h(l)),k(o),k(a)}}}function Cn(s){let e,n,t;return n=new te({props:{$$slots:{default:[Sn]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&8&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Tn(s){let e,n,t,r,o;function i(l){s[1](l)}let c={id:De,$$slots:{right:[Cn],default:[vn]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:De,tooltip:Dn,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&8&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let De="bus_routes";function Dn(s){return s.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Bn(s,e,n){let t;q(s,X,i=>n(2,t=i)),_e(t,De,`https://atip.uk/layers/v1/${De}.pmtiles`),we(t,{id:De,source:De,sourceLayer:De,color:["case",["boolean",["get","has_bus_lane"],!1],j.bus_route_with_lane,j.bus_route_without_lane],width:5,opacity:pe(.5,1)});let r=!1;function o(i){r=i,n(0,r)}return[r,o]}class Nn extends F{constructor(e){super(),z(this,e,Bn,Tn,G,{})}}function dt(s,e,n){const t=s.slice();return t[2]=e[n],t}function _t(s,e,n){const t=s.slice();return t[5]=e[n],t}function wt(s){let e,n;return{c(){e=O("span"),n=b(` 
    `),de(e,"background",s[5]),de(e,"width","100%"),de(e,"border","1px solid black")},m(t,r){m(t,e,r),S(e,n)},p(t,r){r&1&&de(e,"background",t[5])},d(t){t&&h(e)}}}function kt(s){let e,n=s[2]+"",t;return{c(){e=O("span"),t=b(n)},m(r,o){m(r,e,o),S(e,t)},p(r,o){o&2&&n!==(n=r[2]+"")&&ae(t,n)},d(r){r&&h(e)}}}function An(s){let e,n,t,r=Ee(s[0]),o=[];for(let l=0;l<r.length;l+=1)o[l]=wt(_t(s,r,l));let i=Ee(s[1]),c=[];for(let l=0;l<i.length;l+=1)c[l]=kt(dt(s,i,l));return{c(){e=O("div");for(let l=0;l<o.length;l+=1)o[l].c();n=A(),t=O("div");for(let l=0;l<c.length;l+=1)c[l].c();de(e,"display","flex"),de(t,"display","flex"),de(t,"justify-content","space-between")},m(l,u){m(l,e,u);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);m(l,n,u),m(l,t,u);for(let a=0;a<c.length;a+=1)c[a]&&c[a].m(t,null)},p(l,[u]){if(u&1){r=Ee(l[0]);let a;for(a=0;a<r.length;a+=1){const f=_t(l,r,a);o[a]?o[a].p(f,u):(o[a]=wt(f),o[a].c(),o[a].m(e,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}if(u&2){i=Ee(l[1]);let a;for(a=0;a<i.length;a+=1){const f=dt(l,i,a);c[a]?c[a].p(f,u):(c[a]=kt(f),c[a].c(),c[a].m(t,null))}for(;a<c.length;a+=1)c[a].d(1);c.length=i.length}},i:ee,o:ee,d(l){l&&(h(e),h(n),h(t)),et(o,l),et(c,l)}}}function On(s,e,n){let{colorScale:t}=e,{limits:r}=e;return s.$$set=o=>{"colorScale"in o&&n(0,t=o.colorScale),"limits"in o&&n(1,r=o.limits)},[t,r]}class Ke extends F{constructor(e){super(),z(this,e,On,An,G,{colorScale:0,limits:1})}}function Mn(s){let e;return{c(){e=b("Percent of households with a car")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function En(s){let e;return{c(){e=b(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function xn(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Pn(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Un(s){let e,n,t,r,o,i,c,l,u,a,f,$;return t=new H({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[En]},$$scope:{ctx:s}}}),o=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[xn]},$$scope:{ctx:s}}}),a=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Pn]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Car/van availability data is from the 2021 census, via "),_(t.$$.fragment),r=b(". Output area boundaries from "),_(o.$$.fragment),i=b("."),c=A(),l=O("p"),u=b("License: "),_(a.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,c,y),m(p,l,y),S(l,u),w(a,l,null),S(l,f),$=!0},p(p,y){const v={};y&65536&&(v.$$scope={dirty:y,ctx:p}),t.$set(v);const C={};y&65536&&(C.$$scope={dirty:y,ctx:p}),o.$set(C);const B={};y&65536&&(B.$$scope={dirty:y,ctx:p}),a.$set(B)},i(p){$||(g(t.$$.fragment,p),g(o.$$.fragment,p),g(a.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(o.$$.fragment,p),d(a.$$.fragment,p),$=!1},d(p){p&&(h(e),h(c),h(l)),k(t),k(o),k(a)}}}function Hn(s){let e,n,t;return n=new te({props:{$$slots:{default:[Un]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&65536&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function bt(s){let e,n;return e=new Ke({props:{colorScale:s[4],limits:s[7]()}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:ee,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Wn(s){let e;return{c(){e=b("Average cars per household")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Rn(s){let e;return{c(){e=b(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function In(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Fn(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function zn(s){let e,n,t,r,o,i,c,l,u,a,f,$,p,y;return o=new H({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Rn]},$$scope:{ctx:s}}}),c=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[In]},$$scope:{ctx:s}}}),$=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Fn]},$$scope:{ctx:s}}}),{c(){e=O("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,n=A(),t=O("p"),r=b("Car/van availability data is from the 2021 census, via "),_(o.$$.fragment),i=b(". Output area boundaries from "),_(c.$$.fragment),l=b("."),u=A(),a=O("p"),f=b("License: "),_($.$$.fragment),p=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(v,C){m(v,e,C),m(v,n,C),m(v,t,C),S(t,r),w(o,t,null),S(t,i),w(c,t,null),S(t,l),m(v,u,C),m(v,a,C),S(a,f),w($,a,null),S(a,p),y=!0},p(v,C){const B={};C&65536&&(B.$$scope={dirty:C,ctx:v}),o.$set(B);const D={};C&65536&&(D.$$scope={dirty:C,ctx:v}),c.$set(D);const M={};C&65536&&(M.$$scope={dirty:C,ctx:v}),$.$set(M)},i(v){y||(g(o.$$.fragment,v),g(c.$$.fragment,v),g($.$$.fragment,v),y=!0)},o(v){d(o.$$.fragment,v),d(c.$$.fragment,v),d($.$$.fragment,v),y=!1},d(v){v&&(h(e),h(n),h(t),h(u),h(a)),k(o),k(c),k($)}}}function Gn(s){let e,n,t;return n=new te({props:{$$slots:{default:[zn]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&65536&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function vt(s){let e,n;return e=new Ke({props:{colorScale:s[4],limits:s[7]()}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:ee,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function jn(s){let e;return{c(){e=b("Population density")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Vn(s){let e;return{c(){e=b(`NOMIS TS006
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Kn(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Zn(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function qn(s){let e,n,t,r,o,i,c,l,u,a,f,$;return t=new H({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Vn]},$$scope:{ctx:s}}}),o=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Kn]},$$scope:{ctx:s}}}),a=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Zn]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Population density data is from the 2021 census, via "),_(t.$$.fragment),r=b(". Output area boundaries from "),_(o.$$.fragment),i=b("."),c=A(),l=O("p"),u=b("License: "),_(a.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,c,y),m(p,l,y),S(l,u),w(a,l,null),S(l,f),$=!0},p(p,y){const v={};y&65536&&(v.$$scope={dirty:y,ctx:p}),t.$set(v);const C={};y&65536&&(C.$$scope={dirty:y,ctx:p}),o.$set(C);const B={};y&65536&&(B.$$scope={dirty:y,ctx:p}),a.$set(B)},i(p){$||(g(t.$$.fragment,p),g(o.$$.fragment,p),g(a.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(o.$$.fragment,p),d(a.$$.fragment,p),$=!1},d(p){p&&(h(e),h(c),h(l)),k(t),k(o),k(a)}}}function Jn(s){let e,n,t;return n=new te({props:{$$slots:{default:[qn]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&65536&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function yt(s){let e,n,t,r;return t=new Ke({props:{colorScale:s[4],limits:s[7]().map(Xn)}}),{c(){e=O("p"),e.textContent="(people per square kilometres)",n=A(),_(t.$$.fragment)},m(o,i){m(o,e,i),m(o,n,i),w(t,o,i),r=!0},p:ee,i(o){r||(g(t.$$.fragment,o),r=!0)},o(o){d(t.$$.fragment,o),r=!1},d(o){o&&(h(e),h(n)),k(t,o)}}}function Yn(s){let e,n,t,r,o,i,c,l,u,a,f,$,p,y;function v(T){s[9](T)}let C={id:"percent_households_with_car",$$slots:{right:[Hn],default:[Mn]},$$scope:{ctx:s}};s[0]!==void 0&&(C.checked=s[0]),e=new Q({props:C}),V.push(()=>K(e,"checked",v)),e.$on("change",s[10]);let B=s[3]=="percent_households_with_car"&&bt(s);function D(T){s[11](T)}let M={id:"average_cars_per_household",$$slots:{right:[Gn],default:[Wn]},$$scope:{ctx:s}};s[1]!==void 0&&(M.checked=s[1]),o=new Q({props:M}),V.push(()=>K(o,"checked",D)),o.$on("change",s[12]);let L=s[3]=="average_cars_per_household"&&vt(s);function N(T){s[13](T)}let U={id:"population_density",$$slots:{right:[Jn],default:[jn]},$$scope:{ctx:s}};s[2]!==void 0&&(U.checked=s[2]),u=new Q({props:U}),V.push(()=>K(u,"checked",N)),u.$on("change",s[14]);let E=s[3]=="population_density"&&yt(s);return p=new Y({props:{layer:ie,tooltip:s[5],show:s[3]!="",clickable:!0}}),p.$on("click",s[6]),{c(){_(e.$$.fragment),t=A(),B&&B.c(),r=A(),_(o.$$.fragment),c=A(),L&&L.c(),l=A(),_(u.$$.fragment),f=A(),E&&E.c(),$=A(),_(p.$$.fragment)},m(T,P){w(e,T,P),m(T,t,P),B&&B.m(T,P),m(T,r,P),w(o,T,P),m(T,c,P),L&&L.m(T,P),m(T,l,P),w(u,T,P),m(T,f,P),E&&E.m(T,P),m(T,$,P),w(p,T,P),y=!0},p(T,[P]){const x={};P&65536&&(x.$$scope={dirty:P,ctx:T}),!n&&P&1&&(n=!0,x.checked=T[0],Z(()=>n=!1)),e.$set(x),T[3]=="percent_households_with_car"?B?(B.p(T,P),P&8&&g(B,1)):(B=bt(T),B.c(),g(B,1),B.m(r.parentNode,r)):B&&(ye(),d(B,1,1,()=>{B=null}),Le());const R={};P&65536&&(R.$$scope={dirty:P,ctx:T}),!i&&P&2&&(i=!0,R.checked=T[1],Z(()=>i=!1)),o.$set(R),T[3]=="average_cars_per_household"?L?(L.p(T,P),P&8&&g(L,1)):(L=vt(T),L.c(),g(L,1),L.m(l.parentNode,l)):L&&(ye(),d(L,1,1,()=>{L=null}),Le());const ke={};P&65536&&(ke.$$scope={dirty:P,ctx:T}),!a&&P&4&&(a=!0,ke.checked=T[2],Z(()=>a=!1)),u.$set(ke),T[3]=="population_density"?E?(E.p(T,P),P&8&&g(E,1)):(E=yt(T),E.c(),g(E,1),E.m($.parentNode,$)):E&&(ye(),d(E,1,1,()=>{E=null}),Le());const Ce={};P&8&&(Ce.show=T[3]!=""),p.$set(Ce)},i(T){y||(g(e.$$.fragment,T),g(B),g(o.$$.fragment,T),g(L),g(u.$$.fragment,T),g(E),g(p.$$.fragment,T),y=!0)},o(T){d(e.$$.fragment,T),d(B),d(o.$$.fragment,T),d(L),d(u.$$.fragment,T),d(E),d(p.$$.fragment,T),y=!1},d(T){T&&(h(t),h(r),h(c),h(l),h(f),h($)),k(e,T),B&&B.d(T),k(o,T),L&&L.d(T),k(u,T),E&&E.d(T),k(p,T)}}}let ie="census_output_areas";const Xn=s=>s.toLocaleString();function Qn(s,e,n){let t;q(s,X,M=>n(8,t=M));let r=`${ie}-outline`,o=j.sequential_low_to_high,i=!1,c=!1,l=!1,u="";_e(t,ie,`https://atip.uk/layers/v1/${ie}.pmtiles`),Se(t,{id:ie,source:ie,sourceLayer:ie,color:"black",opacity:pe(.5,.7)}),we(t,{id:r,source:ie,sourceLayer:ie,color:"black",width:.5});function a(M){let L=M.properties.OA21CD,N=M.properties[u];return u=="percent_households_with_car"?`<p>${N}% of households in ${L} have 1 or more cars</p>`:u=="average_cars_per_household"?`<p>Households in ${L} have an average of ${N} cars</p>`:`<p>There are ${N.toLocaleString()} people per square kilometre in ${L}</p>`}function f(M){let L=M.detail.properties.OA21CD;u=="percent_households_with_car"||u=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${L}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${L}`,"_blank")}function $(){return u=="percent_households_with_car"?[0,20,40,60,80,100]:u=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function p(M){i=M,n(0,i)}const y=()=>{n(1,c=!1),n(2,l=!1)};function v(M){c=M,n(1,c)}const C=()=>{n(0,i=!1),n(2,l=!1)};function B(M){l=M,n(2,l)}const D=()=>{n(0,i=!1),n(1,c=!1)};return s.$$.update=()=>{s.$$.dirty&271&&(i?n(3,u="percent_households_with_car"):c?n(3,u="average_cars_per_household"):l?n(3,u="population_density"):n(3,u=""),u?(t.setPaintProperty(ie,"fill-color",Mt(["get",u],$(),o)),t.setLayoutProperty(r,"visibility","visible")):t.setLayoutProperty(r,"visibility","none"))},[i,c,l,u,o,a,f,$,t,p,y,v,C,B,D]}class er extends F{constructor(e){super(),z(this,e,Qn,Yn,G,{})}}function tr(s){let e,n,t;return e=new me({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=b(`
  Combined authorities`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function nr(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function rr(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function sr(s){let e,n,t,r,o,i,c,l,u,a;return t=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[nr]},$$scope:{ctx:s}}}),l=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[rr]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of December 2022."),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment),u=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,c),w(l,i,null),S(i,u),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:f}),l.$set(y)},i(f){a||(g(t.$$.fragment,f),g(l.$$.fragment,f),a=!0)},o(f){d(t.$$.fragment,f),d(l.$$.fragment,f),a=!1},d(f){f&&(h(e),h(o),h(i)),k(t),k(l)}}}function or(s){let e,n,t;return n=new te({props:{$$slots:{default:[sr]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function lr(s){let e,n,t,r,o;function i(l){s[3](l)}let c={id:be,$$slots:{right:[or],default:[tr]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:be,tooltip:ar,show:s[0],clickable:!0}}),r.$on("click",ir),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let be="combined_authorities";function ar(s){return`<p>${s.properties.name}</p>`}function ir(s){window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.CAUTH22CD}`,"_blank")}function fr(s,e,n){let t;q(s,X,l=>n(2,t=l));let r=j.combined_authorities,o=`${be}-outline`;st(t,be,`https://atip.uk/layers/v1/${be}.geojson`),Se(t,{id:be,source:be,color:r,opacity:pe(.5,.1)}),we(t,{id:o,source:be,color:r,width:2.5});let i=!1;function c(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,c]}class ur extends F{constructor(e){super(),z(this,e,fr,lr,G,{})}}function cr(s){let e,n,t;return e=new me({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=b(`
  Cycle parking`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function $r(s){let e;return{c(){e=b("OpenStreetMap")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function pr(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function mr(s){let e,n,t,r,o,i,c,l,u;return t=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[$r]},$$scope:{ctx:s}}}),l=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[pr]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Cycle parking, according to "),_(t.$$.fragment),r=b(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,c),w(l,i,null),u=!0},p(a,f){const $={};f&16&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&16&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){u||(g(t.$$.fragment,a),g(l.$$.fragment,a),u=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),u=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function hr(s){let e,n,t;return n=new te({props:{$$slots:{default:[mr]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&16&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function gr(s){let e,n,t,r,o;function i(l){s[2](l)}let c={id:Be,$$slots:{right:[hr],default:[cr]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:Be,tooltip:dr,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&16&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Be="cycle_parking";function dr(s){return`<p>Capacity: ${s.properties.capacity??"unknown"}</p>`}function _r(s,e,n){let t;q(s,X,c=>n(3,t=c));let r=j.cycle_parking;_e(t,Be,`https://atip.uk/layers/v1/${Be}.pmtiles`),Et(t,{id:Be,source:Be,sourceLayer:Be,color:r,radius:5});let o=!1;function i(c){o=c,n(0,o)}return[o,r,i]}class wr extends F{constructor(e){super(),z(this,e,_r,gr,G,{})}}function kr(s){let e=new Map;for(let[t,r]of Object.entries(s.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:r.authority_or_region,capital_scheme_id:r.capital_scheme_id,funding_programme:r.funding_programme});let n=1;for(let t of s.features){let r=e.get(t.properties.scheme_reference);r.num_features++,t.properties.funding_programme=r.funding_programme,t.id=n++}return e}function br(s){let e,n,t,r,o;function i(l){s[3](l)}let c={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return s[0]!==void 0&&(c.value=s[0]),e=new tt({props:c}),V.push(()=>K(e,"value",i)),e.$on("change",s[2]),r=new mn({props:{rows:s[1]}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};!n&&u&1&&(n=!0,a.value=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&2&&(f.rows=l[1]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function vr(s,e,n){let t;q(s,X,l=>n(4,t=l));let r="interventionType",o=gt("v1");function i(){let l;r=="interventionType"?(l=It("v1"),n(1,o=gt("v1"))):(l=sn(["get","funding_programme"],{ATF2:j.atf2,ATF3:j.atf3,ATF4:j.atf4},"grey"),n(1,o=[["ATF2",j.atf2],["ATF3",j.atf3],["ATF4",j.atf4]])),t.setPaintProperty("interventions-points","circle-color",l),t.setPaintProperty("interventions-lines","line-color",l),t.setPaintProperty("interventions-polygons","fill-color",l),t.setPaintProperty("interventions-polygon-outlines","line-color",l)}function c(l){r=l,n(0,r)}return[r,o,i,c]}class yr extends F{constructor(e){super(),z(this,e,vr,br,G,{})}}function Lr(s){let e;return{c(){e=b("Clear")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Sr(s){let e,n,t,r,o,i;return t=new je({props:{$$slots:{default:[Lr]},$$scope:{ctx:s}}}),t.$on("click",s[11]),{c(){e=O("input"),n=A(),_(t.$$.fragment),I(e,"type","text"),I(e,"class","govuk-input govuk-input--width-10"),I(e,"id","filterText")},m(c,l){m(c,e,l),mt(e,s[0]),m(c,n,l),w(t,c,l),r=!0,o||(i=ln(e,"input",s[10]),o=!0)},p(c,l){l&1&&e.value!==c[0]&&mt(e,c[0]);const u={};l&16384&&(u.$$scope={dirty:l,ctx:c}),t.$set(u)},i(c){r||(g(t.$$.fragment,c),r=!0)},o(c){d(t.$$.fragment,c),r=!1},d(c){c&&(h(e),h(n)),k(t,c),o=!1,i()}}}function Cr(s){let e,n,t,r,o,i,c,l,u,a;function f(v){s[8](v)}let $={label:"Authority or region",id:"filterAuthority",choices:s[4],emptyOption:!0};s[2]!==void 0&&($.value=s[2]),e=new tt({props:$}),V.push(()=>K(e,"value",f));function p(v){s[9](v)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:s[5],emptyOption:!0};return s[3]!==void 0&&(y.value=s[3]),r=new tt({props:y}),V.push(()=>K(r,"value",p)),c=new on({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[Sr]},$$scope:{ctx:s}}}),u=new yr({}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment),i=A(),_(c.$$.fragment),l=A(),_(u.$$.fragment)},m(v,C){w(e,v,C),m(v,t,C),w(r,v,C),m(v,i,C),w(c,v,C),m(v,l,C),w(u,v,C),a=!0},p(v,C){const B={};C&16&&(B.choices=v[4]),!n&&C&4&&(n=!0,B.value=v[2],Z(()=>n=!1)),e.$set(B);const D={};C&32&&(D.choices=v[5]),!o&&C&8&&(o=!0,D.value=v[3],Z(()=>o=!1)),r.$set(D);const M={};C&16385&&(M.$$scope={dirty:C,ctx:v}),c.$set(M)},i(v){a||(g(e.$$.fragment,v),g(r.$$.fragment,v),g(c.$$.fragment,v),g(u.$$.fragment,v),a=!0)},o(v){d(e.$$.fragment,v),d(r.$$.fragment,v),d(c.$$.fragment,v),d(u.$$.fragment,v),a=!1},d(v){v&&(h(t),h(i),h(l)),k(e,v),k(r,v),k(c,v),k(u,v)}}}function Tr(s){let e,n,t,r,o=s[1].size+"",i,c,l=s[6].route+"",u,a,f=s[6].area+"",$,p,y=s[6].crossing+"",v,C,B=s[6].other+"",D,M,L;return e=new Ae({props:{label:"Filters",$$slots:{default:[Cr]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),n=A(),t=O("p"),r=b("Showing "),i=b(o),c=b(" schemes ("),u=b(l),a=b(" routes, "),$=b(f),p=b(` areas,
  `),v=b(y),C=b(" crossings, "),D=b(B),M=b(" other)")},m(N,U){w(e,N,U),m(N,n,U),m(N,t,U),S(t,r),S(t,i),S(t,c),S(t,u),S(t,a),S(t,$),S(t,p),S(t,v),S(t,C),S(t,D),S(t,M),L=!0},p(N,[U]){const E={};U&16445&&(E.$$scope={dirty:U,ctx:N}),e.$set(E),(!L||U&2)&&o!==(o=N[1].size+"")&&ae(i,o),(!L||U&64)&&l!==(l=N[6].route+"")&&ae(u,l),(!L||U&64)&&f!==(f=N[6].area+"")&&ae($,f),(!L||U&64)&&y!==(y=N[6].crossing+"")&&ae(v,y),(!L||U&64)&&B!==(B=N[6].other+"")&&ae(D,B)},i(N){L||(g(e.$$.fragment,N),L=!0)},o(N){d(e.$$.fragment,N),L=!1},d(N){N&&(h(n),h(t)),k(e,N)}}}function Dr(s,e,n){let t;q(s,Ue,B=>n(12,t=B));let{schemes:r}=e,{schemesToBeShown:o=new Set}=e,{filterText:i=""}=e,c=[],l="",u=[],a="",f={area:0,route:0,crossing:0,other:0};ot(()=>{let B=new Set,D=new Set;for(let M of r.values())M.authority_or_region&&B.add(M.authority_or_region),M.funding_programme&&D.add(M.funding_programme);n(4,c=Array.from(B.entries())),c.sort(),n(5,u=Array.from(D.entries())),u.sort()});function $(B,D,M){let L=B.toLowerCase(),N=E=>{var T,P;if(L&&!((T=E.properties.name)!=null&&T.toLowerCase().includes(L))&&!((P=E.properties.description)!=null&&P.toLowerCase().includes(L)))return!1;if(D||M){let x=r.get(E.properties.scheme_reference);if(D&&x.authority_or_region!=D||M&&x.funding_programme!=M)return!1}return!0};n(1,o=new Set(t.features.filter(N).map(E=>E.properties.scheme_reference))),n(6,f={area:0,route:0,crossing:0,other:0});let U=E=>{var T,P;return!(!o.has(E.properties.scheme_reference)||L&&!((T=E.properties.name)!=null&&T.toLowerCase().includes(L))&&!((P=E.properties.description)!=null&&P.toLowerCase().includes(L)))};Ue.update(E=>{for(let T of E.features)U(T)?(delete T.properties.hide_while_editing,n(6,f[T.properties.intervention_type]++,f)):T.properties.hide_while_editing=!0;return E}),n(6,f)}function p(B){l=B,n(2,l)}function y(B){a=B,n(3,a)}function v(){i=this.value,n(0,i)}const C=()=>n(0,i="");return s.$$set=B=>{"schemes"in B&&n(7,r=B.schemes),"schemesToBeShown"in B&&n(1,o=B.schemesToBeShown),"filterText"in B&&n(0,i=B.filterText)},s.$$.update=()=>{s.$$.dirty&13&&$(i,l,a)},[i,o,l,a,c,u,f,r,p,y,v,C]}class Br extends F{constructor(e){super(),z(this,e,Dr,Tr,G,{schemes:7,schemesToBeShown:1,filterText:0})}}function Nr(s){let e,n,t,r;return e=new me({props:{color:s[3]}}),{c(){_(e.$$.fragment),n=A(),t=b(s[1])},m(o,i){w(e,o,i),m(o,n,i),m(o,t,i),r=!0},p(o,i){(!r||i&2)&&ae(t,o[1])},i(o){r||(g(e.$$.fragment,o),r=!0)},o(o){d(e.$$.fragment,o),r=!1},d(o){o&&(h(n),h(t)),k(e,o)}}}function Ar(s){let e;const n=s[6].default,t=xt(n,s,s[8],null);return{c(){t&&t.c()},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&256)&&Pt(t,n,r,r[8],e?Ht(n,r[8],o,null):Ut(r[8]),null)},i(r){e||(g(t,r),e=!0)},o(r){d(t,r),e=!1},d(r){t&&t.d(r)}}}function Or(s){let e,n,t;return n=new te({props:{$$slots:{default:[Ar]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&256&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Mr(s){let e,n,t,r,o;function i(l){s[7](l)}let c={id:s[0],$$slots:{right:[Or],default:[Nr]},$$scope:{ctx:s}};return s[2]!==void 0&&(c.checked=s[2]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:s[0],tooltip:s[4],show:s[2],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&1&&(a.id=l[0]),u&258&&(a.$$scope={dirty:u,ctx:l}),!n&&u&4&&(n=!0,a.checked=l[2],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.layer=l[0]),u&4&&(f.show=l[2]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function Er(s,e,n){let t;q(s,X,p=>n(9,t=p));let{$$slots:r={},$$scope:o}=e,{name:i}=e,{singularNoun:c}=e,{pluralNoun:l}=e,u=j[i];_e(t,i,`https://atip.uk/layers/v1/${i}.pmtiles`),Se(t,{id:i,source:i,sourceLayer:i,color:u,opacity:pe(1,.7)});let a=!1;function f(p){return`<p>${p.properties.name??`Unnamed ${c}`}</p>`}function $(p){a=p,n(2,a)}return s.$$set=p=>{"name"in p&&n(0,i=p.name),"singularNoun"in p&&n(5,c=p.singularNoun),"pluralNoun"in p&&n(1,l=p.pluralNoun),"$$scope"in p&&n(8,o=p.$$scope)},[i,l,a,u,f,c,r,$,o]}class at extends F{constructor(e){super(),z(this,e,Er,Mr,G,{name:0,singularNoun:5,pluralNoun:1})}}function xr(s){let e;return{c(){e=b("hospital")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Pr(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ur(s){let e,n,t,r,o,i,c,l,u;return t=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[xr]},$$scope:{ctx:s}}}),l=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Pr]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("This shows "),_(t.$$.fragment),r=b(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,c),w(l,i,null),u=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){u||(g(t.$$.fragment,a),g(l.$$.fragment,a),u=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),u=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function Hr(s){let e,n;return e=new at({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Ur]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class Wr extends F{constructor(e){super(),z(this,e,null,Hr,G,{})}}function Rr(s){let e;return{c(){e=b("Indices of Multiple Deprivation")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ir(s){let e;return{c(){e=b(`DLUCH GIS
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Fr(s){let e;return{c(){e=b(`here
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function zr(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Gr(s){let e,n,t,r,o,i,c,l,u,a,f,$;return t=new H({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Ir]},$$scope:{ctx:s}}}),o=new H({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Fr]},$$scope:{ctx:s}}}),a=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[zr]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("The 2019 English IMD scores come from "),_(t.$$.fragment),r=b(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(o.$$.fragment),i=b("."),c=A(),l=O("p"),u=b("License: "),_(a.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,c,y),m(p,l,y),S(l,u),w(a,l,null),S(l,f),$=!0},p(p,y){const v={};y&64&&(v.$$scope={dirty:y,ctx:p}),t.$set(v);const C={};y&64&&(C.$$scope={dirty:y,ctx:p}),o.$set(C);const B={};y&64&&(B.$$scope={dirty:y,ctx:p}),a.$set(B)},i(p){$||(g(t.$$.fragment,p),g(o.$$.fragment,p),g(a.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(o.$$.fragment,p),d(a.$$.fragment,p),$=!1},d(p){p&&(h(e),h(c),h(l)),k(t),k(o),k(a)}}}function jr(s){let e,n,t;return n=new te({props:{$$slots:{default:[Gr]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&64&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Lt(s){let e,n;return e=new Ke({props:{colorScale:s[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:ee,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Vr(s){let e,n,t,r,o,i;function c(a){s[3](a)}let l={id:fe,$$slots:{right:[jr],default:[Rr]},$$scope:{ctx:s}};s[0]!==void 0&&(l.checked=s[0]),e=new Q({props:l}),V.push(()=>K(e,"checked",c));let u=s[0]&&Lt(s);return o=new Y({props:{layer:fe,tooltip:Kr,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),u&&u.c(),r=A(),_(o.$$.fragment)},m(a,f){w(e,a,f),m(a,t,f),u&&u.m(a,f),m(a,r,f),w(o,a,f),i=!0},p(a,[f]){const $={};f&64&&($.$$scope={dirty:f,ctx:a}),!n&&f&1&&(n=!0,$.checked=a[0],Z(()=>n=!1)),e.$set($),a[0]?u?(u.p(a,f),f&1&&g(u,1)):(u=Lt(a),u.c(),g(u,1),u.m(r.parentNode,r)):u&&(ye(),d(u,1,1,()=>{u=null}),Le());const p={};f&1&&(p.show=a[0]),o.$set(p)},i(a){i||(g(e.$$.fragment,a),g(u),g(o.$$.fragment,a),i=!0)},o(a){d(e.$$.fragment,a),d(u),d(o.$$.fragment,a),i=!1},d(a){a&&(h(t),h(r)),k(e,a),u&&u.d(a),k(o,a)}}}let fe="imd";function Kr(s){return`<p>${s.properties.LSOA11CD} has an IMD score of <b>${s.properties.score}</b></p><p>Rank: <b>${s.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function Zr(s,e,n){let t;q(s,X,u=>n(2,t=u));let r=`${fe}-outline`,o=j.sequential_low_to_high,i=[0,2,4,6,8,10];_e(t,fe,`https://atip.uk/layers/v1/${fe}.pmtiles`),Se(t,{id:fe,source:fe,sourceLayer:fe,color:Mt(["-",10,["get","decile"]],i,o),opacity:pe(.5,.7)}),we(t,{id:r,source:fe,sourceLayer:fe,color:"black",width:.5});let c=!1;function l(u){c=u,n(0,c)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(r)&&t.setLayoutProperty(r,"visibility",c?"visible":"none")},[c,o,t,l]}class qr extends F{constructor(e){super(),z(this,e,Zr,Vr,G,{})}}function Jr(s){let e,n,t;return e=new me({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=b(`
  Local Authority Districts`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Yr(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Xr(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Qr(s){let e,n,t,r,o,i,c,l,u,a;return t=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Yr]},$$scope:{ctx:s}}}),l=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Xr]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of May 2023."),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment),u=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,c),w(l,i,null),S(i,u),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:f}),l.$set(y)},i(f){a||(g(t.$$.fragment,f),g(l.$$.fragment,f),a=!0)},o(f){d(t.$$.fragment,f),d(l.$$.fragment,f),a=!1},d(f){f&&(h(e),h(o),h(i)),k(t),k(l)}}}function es(s){let e,n,t;return n=new te({props:{$$slots:{default:[Qr]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function ts(s){let e,n,t,r,o;function i(l){s[3](l)}let c={id:ve,$$slots:{right:[es],default:[Jr]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:ve,tooltip:ns,show:s[0],clickable:!0}}),r.$on("click",rs),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let ve="local_authority_districts";function ns(s){return`<p>${s.properties.name}</p>`}function rs(s){window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.LAD23CD}`,"_blank")}function ss(s,e,n){let t;q(s,X,l=>n(2,t=l));let r=j.local_authority_districts,o=`${ve}-outline`;st(t,ve,`https://atip.uk/layers/v1/${ve}.geojson`),Se(t,{id:ve,source:ve,color:r,opacity:pe(.5,.1)}),we(t,{id:o,source:ve,color:r,width:2.5});let i=!1;function c(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,c]}class os extends F{constructor(e){super(),z(this,e,ss,ts,G,{})}}function ls(s){let e,n,t;return e=new me({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=b(`
  Local Planning Authorities`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function as(s){let e;return{c(){e=b(`local authority
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function is(s){let e;return{c(){e=b(`national park authorit
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function fs(s){let e;return{c(){e=b(`development corporation
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function us(s){let e;return{c(){e=b("this map")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function cs(s){let e;return{c(){e=b(`planning.data.gov.uk
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function $s(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ps(s){let e,n,t,r,o,i,c,l,u,a,f,$,p,y,v,C,B,D,M,L,N,U,E,T,P;return t=new H({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[as]},$$scope:{ctx:s}}}),o=new H({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[is]},$$scope:{ctx:s}}}),c=new H({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[fs]},$$scope:{ctx:s}}}),p=new H({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[us]},$$scope:{ctx:s}}}),D=new H({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[cs]},$$scope:{ctx:s}}}),E=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[$s]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("LPAs may be a "),_(t.$$.fragment),r=b(", "),_(o.$$.fragment),i=b("y, or "),_(c.$$.fragment),l=b("."),u=A(),a=O("p"),f=O("strong"),$=b(`Note there are overlapping LPAs near Northhamptonshire, shown in a
          darker shade. Only one authority name is shown when hovering. Use `),_(p.$$.fragment),y=b(" to get more details."),v=A(),C=O("p"),B=b("Data from ONS Geography via "),_(D.$$.fragment),M=b(", as of November 2022."),L=A(),N=O("p"),U=b("License: "),_(E.$$.fragment),T=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(x,R){m(x,e,R),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),w(c,e,null),S(e,l),m(x,u,R),m(x,a,R),S(a,f),S(f,$),w(p,f,null),S(f,y),m(x,v,R),m(x,C,R),S(C,B),w(D,C,null),S(C,M),m(x,L,R),m(x,N,R),S(N,U),w(E,N,null),S(N,T),P=!0},p(x,R){const ke={};R&32&&(ke.$$scope={dirty:R,ctx:x}),t.$set(ke);const Ce={};R&32&&(Ce.$$scope={dirty:R,ctx:x}),o.$set(Ce);const He={};R&32&&(He.$$scope={dirty:R,ctx:x}),c.$set(He);const he={};R&32&&(he.$$scope={dirty:R,ctx:x}),p.$set(he);const Te={};R&32&&(Te.$$scope={dirty:R,ctx:x}),D.$set(Te);const We={};R&32&&(We.$$scope={dirty:R,ctx:x}),E.$set(We)},i(x){P||(g(t.$$.fragment,x),g(o.$$.fragment,x),g(c.$$.fragment,x),g(p.$$.fragment,x),g(D.$$.fragment,x),g(E.$$.fragment,x),P=!0)},o(x){d(t.$$.fragment,x),d(o.$$.fragment,x),d(c.$$.fragment,x),d(p.$$.fragment,x),d(D.$$.fragment,x),d(E.$$.fragment,x),P=!1},d(x){x&&(h(e),h(u),h(a),h(v),h(C),h(L),h(N)),k(t),k(o),k(c),k(p),k(D),k(E)}}}function ms(s){let e,n,t;return n=new te({props:{$$slots:{default:[ps]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function hs(s){let e,n,t,r,o;function i(l){s[3](l)}let c={id:ue,$$slots:{right:[ms],default:[ls]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:ue,tooltip:gs,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let ue="local_planning_authorities";function gs(s){return`<p>${s.properties.name}</p>`}function ds(s,e,n){let t;q(s,X,l=>n(2,t=l));let r=j.local_planning_authorities,o=`${ue}-outline`;_e(t,ue,`https://atip.uk/layers/v1/${ue}.pmtiles`),Se(t,{id:ue,source:ue,sourceLayer:ue,color:r,opacity:pe(.5,.1)}),we(t,{id:o,source:ue,sourceLayer:ue,color:r,width:2.5});let i=!1;function c(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,c]}class _s extends F{constructor(e){super(),z(this,e,ds,hs,G,{})}}function ws(s){let e,n,t;return e=new me({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=b(`
  Major Road Network`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function ks(s){let e;return{c(){e=b(`Major Road Network
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function bs(s){let e;return{c(){e=b("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function vs(s){let e,n,t,r,o,i,c,l,u;return t=new H({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[ks]},$$scope:{ctx:s}}}),l=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[bs]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Data from the "),_(t.$$.fragment),r=b(", as of September 2021."),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,c),w(l,i,null),u=!0},p(a,f){const $={};f&16&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&16&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){u||(g(t.$$.fragment,a),g(l.$$.fragment,a),u=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),u=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function ys(s){let e,n,t;return n=new te({props:{$$slots:{default:[vs]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&16&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ls(s){let e,n,t,r,o;function i(l){s[2](l)}let c={id:Ne,$$slots:{right:[ys],default:[ws]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:Ne,tooltip:Ss,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&16&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Ne="mrn";function Ss(s){return`<p>${s.properties.name??"Unknown MRN road"}</p>`}function Cs(s,e,n){let t;q(s,X,c=>n(3,t=c));let r=j.mrn;_e(t,Ne,`https://atip.uk/layers/v1/${Ne}.pmtiles`),we(t,{id:Ne,source:Ne,sourceLayer:Ne,color:r,width:7,opacity:pe(.5,1)});let o=!1;function i(c){o=c,n(0,o)}return[o,r,i]}class Ts extends F{constructor(e){super(),z(this,e,Cs,Ls,G,{})}}function Ds(s){let e,n,t;return e=new me({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=b(`
  Parliamentary constituencies`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Bs(s){let e;return{c(){e=b(`Ordnance Survey Boundary-Line
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ns(s){let e;return{c(){e=b("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function As(s){let e,n,t,r,o,i,c,l,u;return t=new H({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Bs]},$$scope:{ctx:s}}}),l=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ns]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of May 2023."),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,c),w(l,i,null),u=!0},p(a,f){const $={};f&32&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&32&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){u||(g(t.$$.fragment,a),g(l.$$.fragment,a),u=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),u=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function Os(s){let e,n,t;return n=new te({props:{$$slots:{default:[As]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ms(s){let e,n,t,r,o;function i(l){s[3](l)}let c={id:ce,$$slots:{right:[Os],default:[Ds]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:ce,tooltip:Es,show:s[0],clickable:!0}}),r.$on("click",xs),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let ce="parliamentary_constituencies";function Es(s){return`<p>${s.properties.Name}</p>`}function xs(s){let e=s.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function Ps(s,e,n){let t;q(s,X,l=>n(2,t=l));let r=j.parliamentary_constituencies,o=`${ce}-outline`;_e(t,ce,`https://atip.uk/layers/v1/${ce}.pmtiles`),Se(t,{id:ce,source:ce,sourceLayer:ce,color:r,opacity:pe(.5,.1)}),we(t,{id:o,source:ce,sourceLayer:ce,color:r,width:5});let i=!1;function c(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,c]}class Us extends F{constructor(e){super(),z(this,e,Ps,Ms,G,{})}}function Hs(s){let e,n,t,r;return e=new me({props:{color:s[3]}}),{c(){_(e.$$.fragment),n=A(),t=b(s[1])},m(o,i){w(e,o,i),m(o,n,i),m(o,t,i),r=!0},p(o,i){(!r||i&2)&&ae(t,o[1])},i(o){r||(g(e.$$.fragment,o),r=!0)},o(o){d(e.$$.fragment,o),r=!1},d(o){o&&(h(n),h(t)),k(e,o)}}}function Ws(s){let e;const n=s[7].default,t=xt(n,s,s[9],null);return{c(){t&&t.c()},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&512)&&Pt(t,n,r,r[9],e?Ht(n,r[9],o,null):Ut(r[9]),null)},i(r){e||(g(t,r),e=!0)},o(r){d(t,r),e=!1},d(r){t&&t.d(r)}}}function Rs(s){let e,n,t;return n=new te({props:{$$slots:{default:[Ws]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&512&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Is(s){let e,n,t,r,o;function i(l){s[8](l)}let c={id:s[0],$$slots:{right:[Rs],default:[Hs]},$$scope:{ctx:s}};return s[2]!==void 0&&(c.checked=s[2]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:s[0],tooltip:s[4],show:s[2],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&1&&(a.id=l[0]),u&514&&(a.$$scope={dirty:u,ctx:l}),!n&&u&4&&(n=!0,a.checked=l[2],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.layer=l[0]),u&4&&(f.show=l[2]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function Fs(s,e,n){let t;q(s,X,y=>n(10,t=y));let{$$slots:r={},$$scope:o}=e,{name:i}=e,{singularNoun:c}=e,{pluralNoun:l}=e,{circleRadius:u}=e,a=j[i];st(t,i,`https://atip.uk/layers/v1/${i}.geojson`),Et(t,{id:i,source:i,color:a,radius:u/2});let f=!1;function $(y){return`<p>${y.properties.name??`Unnamed ${c}`}</p>`}function p(y){f=y,n(2,f)}return s.$$set=y=>{"name"in y&&n(0,i=y.name),"singularNoun"in y&&n(5,c=y.singularNoun),"pluralNoun"in y&&n(1,l=y.pluralNoun),"circleRadius"in y&&n(6,u=y.circleRadius),"$$scope"in y&&n(9,o=y.$$scope)},[i,l,f,a,$,c,u,r,p,o]}class zs extends F{constructor(e){super(),z(this,e,Fs,Is,G,{name:0,singularNoun:5,pluralNoun:1,circleRadius:6})}}function Gs(s){let e;return{c(){e=b("railway station")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function js(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Vs(s){let e,n,t,r,o,i,c,l,u;return t=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[Gs]},$$scope:{ctx:s}}}),l=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[js]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("This shows "),_(t.$$.fragment),r=b(" data from OpenStreetMap (as of 9 August 2023)."),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,c),w(l,i,null),u=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){u||(g(t.$$.fragment,a),g(l.$$.fragment,a),u=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),u=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function Ks(s){let e,n;return e=new zs({props:{name:Zs,singularNoun:"railway station",pluralNoun:"Railway stations",circleRadius:hn,$$slots:{default:[Vs]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}const Zs="railway_stations";class qs extends F{constructor(e){super(),z(this,e,null,Ks,G,{})}}function Js(s){let e;return{c(){e=b("Show on map")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ys(s){let e;return{c(){e=b("Edit scheme locally")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Xs(s){let e,n,t=s[0].authority_or_region+"",r,o,i,c,l=s[0].capital_scheme_id+"",u,a,f,$,p=s[0].funding_programme+"",y,v,C,B,D,M,L;return B=new je({props:{$$slots:{default:[Js]},$$scope:{ctx:s}}}),B.$on("click",s[3]),M=new je({props:{disabled:s[1],title:s[2],$$slots:{default:[Ys]},$$scope:{ctx:s}}}),M.$on("click",s[4]),{c(){e=O("p"),n=b("Authority or region: "),r=b(t),o=A(),i=O("p"),c=b("Capital scheme ID: "),u=b(l),a=A(),f=O("p"),$=b("Funding programme: "),y=b(p),v=A(),C=O("div"),_(B.$$.fragment),D=A(),_(M.$$.fragment),I(C,"class","govuk-button-group")},m(N,U){m(N,e,U),S(e,n),S(e,r),m(N,o,U),m(N,i,U),S(i,c),S(i,u),m(N,a,U),m(N,f,U),S(f,$),S(f,y),m(N,v,U),m(N,C,U),w(B,C,null),S(C,D),w(M,C,null),L=!0},p(N,U){(!L||U&1)&&t!==(t=N[0].authority_or_region+"")&&ae(r,t),(!L||U&1)&&l!==(l=N[0].capital_scheme_id+"")&&ae(u,l),(!L||U&1)&&p!==(p=N[0].funding_programme+"")&&ae(y,p);const E={};U&256&&(E.$$scope={dirty:U,ctx:N}),B.$set(E);const T={};U&256&&(T.$$scope={dirty:U,ctx:N}),M.$set(T)},i(N){L||(g(B.$$.fragment,N),g(M.$$.fragment,N),L=!0)},o(N){d(B.$$.fragment,N),d(M.$$.fragment,N),L=!1},d(N){N&&(h(e),h(o),h(i),h(a),h(f),h(v),h(C)),k(B),k(M)}}}function Qs(s){let e,n;return e=new Ae({props:{label:`${s[0].scheme_reference}: ${s[0].num_features} features`,$$slots:{default:[Xs]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),r&257&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function eo(s,e,n){let t,r;q(s,Ue,f=>n(6,t=f)),q(s,X,f=>n(7,r=f));let{scheme:o}=e,{authorityNames:i}=e,c=!i.has(o.authority_or_region),l=c?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function u(){let f={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==o.scheme_reference)};r==null||r.fitBounds(Wt(f),{padding:20,animate:!1})}function a(){let f={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==o.scheme_reference)},$=o.authority_or_region;window.localStorage.setItem($,JSON.stringify(f)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return s.$$set=f=>{"scheme"in f&&n(0,o=f.scheme),"authorityNames"in f&&n(5,i=f.authorityNames)},[o,c,l,u,a,i]}class to extends F{constructor(e){super(),z(this,e,eo,Qs,G,{scheme:0,authorityNames:5})}}function no(s){let e;return{c(){e=b("primary and secondary schools")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ro(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function so(s){let e,n,t,r,o,i,c,l,u;return t=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[no]},$$scope:{ctx:s}}}),l=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ro]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("This shows "),_(t.$$.fragment),r=b(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,c),w(l,i,null),u=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){u||(g(t.$$.fragment,a),g(l.$$.fragment,a),u=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),u=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function oo(s){let e,n;return e=new at({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[so]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class lo extends F{constructor(e){super(),z(this,e,null,oo,G,{})}}function ao(s){let e;return{c(){e=b("sports pitches")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function io(s){let e;return{c(){e=b("sports centres")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function fo(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function uo(s){let e,n,t,r,o,i,c,l,u,a,f;return t=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[ao]},$$scope:{ctx:s}}}),o=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[io]},$$scope:{ctx:s}}}),a=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[fo]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("This shows "),_(t.$$.fragment),r=b(" and "),_(o.$$.fragment),i=b(" data from OpenStreetMap (as of 9 August 2023)."),c=A(),l=O("p"),u=b("License: "),_(a.$$.fragment)},m($,p){m($,e,p),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m($,c,p),m($,l,p),S(l,u),w(a,l,null),f=!0},p($,p){const y={};p&1&&(y.$$scope={dirty:p,ctx:$}),t.$set(y);const v={};p&1&&(v.$$scope={dirty:p,ctx:$}),o.$set(v);const C={};p&1&&(C.$$scope={dirty:p,ctx:$}),a.$set(C)},i($){f||(g(t.$$.fragment,$),g(o.$$.fragment,$),g(a.$$.fragment,$),f=!0)},o($){d(t.$$.fragment,$),d(o.$$.fragment,$),d(a.$$.fragment,$),f=!1},d($){$&&(h(e),h(c),h(l)),k(t),k(o),k(a)}}}function co(s){let e,n;return e=new at({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[uo]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class $o extends F{constructor(e){super(),z(this,e,null,co,G,{})}}function po(s){let e,n,t;return e=new me({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=b(`
  Wards`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ee,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function mo(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ho(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function go(s){let e,n,t,r,o,i,c,l,u,a;return t=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[mo]},$$scope:{ctx:s}}}),l=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ho]},$$scope:{ctx:s}}}),{c(){e=O("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of May 2023."),o=A(),i=O("p"),c=b("License: "),_(l.$$.fragment),u=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,c),w(l,i,null),S(i,u),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:f}),l.$set(y)},i(f){a||(g(t.$$.fragment,f),g(l.$$.fragment,f),a=!0)},o(f){d(t.$$.fragment,f),d(l.$$.fragment,f),a=!1},d(f){f&&(h(e),h(o),h(i)),k(t),k(l)}}}function _o(s){let e,n,t;return n=new te({props:{$$slots:{default:[go]},$$scope:{ctx:s}}}),{c(){e=O("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function wo(s){let e,n,t,r,o;function i(l){s[3](l)}let c={id:$e,$$slots:{right:[_o],default:[po]},$$scope:{ctx:s}};return s[0]!==void 0&&(c.checked=s[0]),e=new Q({props:c}),V.push(()=>K(e,"checked",i)),r=new Y({props:{layer:$e,tooltip:ko,show:s[0],clickable:!0}}),r.$on("click",bo),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,u){w(e,l,u),m(l,t,u),w(r,l,u),o=!0},p(l,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:l}),!n&&u&1&&(n=!0,a.checked=l[0],Z(()=>n=!1)),e.$set(a);const f={};u&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let $e="wards";function ko(s){return`<p>${s.properties.name}</p>`}function bo(s){let e=encodeURIComponent(s.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function vo(s,e,n){let t;q(s,X,l=>n(2,t=l));let r=j.wards,o=`${$e}-outline`;_e(t,$e,`https://atip.uk/layers/v1/${$e}.pmtiles`),Se(t,{id:$e,source:$e,sourceLayer:$e,color:r,opacity:pe(.5,.1)}),we(t,{id:o,source:$e,sourceLayer:$e,color:r,width:2.5});let i=!1;function c(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,c]}class yo extends F{constructor(e){super(),z(this,e,vo,wo,G,{})}}var J=(s,e,n)=>new Promise((t,r)=>{var o=l=>{try{c(n.next(l))}catch(u){r(u)}},i=l=>{try{c(n.throw(l))}catch(u){r(u)}},c=l=>l.done?t(l.value):Promise.resolve(l.value).then(o,i);c((n=n.apply(s,e)).next())}),re=Uint8Array,xe=Uint16Array,Lo=Int32Array,Ft=new re([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zt=new re([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),So=new re([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gt=function(s,e){for(var n=new xe(31),t=0;t<31;++t)n[t]=e+=1<<s[t-1];for(var r=new Lo(n[30]),t=1;t<30;++t)for(var o=n[t];o<n[t+1];++o)r[o]=o-n[t]<<5|t;return{b:n,r}},jt=Gt(Ft,2),Vt=jt.b,Co=jt.r;Vt[28]=258,Co[258]=28;var To=Gt(zt,0),Do=To.b,nt=new xe(32768);for(W=0;W<32768;++W)ge=(W&43690)>>1|(W&21845)<<1,ge=(ge&52428)>>2|(ge&13107)<<2,ge=(ge&61680)>>4|(ge&3855)<<4,nt[W]=((ge&65280)>>8|(ge&255)<<8)>>1;var ge,W,ze=function(s,e,n){for(var t=s.length,r=0,o=new xe(e);r<t;++r)s[r]&&++o[s[r]-1];var i=new xe(e);for(r=1;r<e;++r)i[r]=i[r-1]+o[r-1]<<1;var c;if(n){c=new xe(1<<e);var l=15-e;for(r=0;r<t;++r)if(s[r])for(var u=r<<4|s[r],a=e-s[r],f=i[s[r]-1]++<<a,$=f|(1<<a)-1;f<=$;++f)c[nt[f]>>l]=u}else for(c=new xe(t),r=0;r<t;++r)s[r]&&(c[r]=nt[i[s[r]-1]++]>>15-s[r]);return c},Ge=new re(288);for(W=0;W<144;++W)Ge[W]=8;var W;for(W=144;W<256;++W)Ge[W]=9;var W;for(W=256;W<280;++W)Ge[W]=7;var W;for(W=280;W<288;++W)Ge[W]=8;var W,Kt=new re(32);for(W=0;W<32;++W)Kt[W]=5;var W,Bo=ze(Ge,9,1),No=ze(Kt,5,1),Xe=function(s){for(var e=s[0],n=1;n<s.length;++n)s[n]>e&&(e=s[n]);return e},oe=function(s,e,n){var t=e/8|0;return(s[t]|s[t+1]<<8)>>(e&7)&n},Qe=function(s,e){var n=e/8|0;return(s[n]|s[n+1]<<8|s[n+2]<<16)>>(e&7)},Ao=function(s){return(s+7)/8|0},Oo=function(s,e,n){(e==null||e<0)&&(e=0),(n==null||n>s.length)&&(n=s.length);var t=new re(n-e);return t.set(s.subarray(e,n)),t},Mo=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ne=function(s,e,n){var t=new Error(e||Mo[s]);if(t.code=s,Error.captureStackTrace&&Error.captureStackTrace(t,ne),!n)throw t;return t},it=function(s,e,n,t){var r=s.length,o=t?t.length:0;if(!r||e.f&&!e.l)return n||new re(0);var i=!n||e.i!=2,c=e.i;n||(n=new re(r*3));var l=function(ct){var $t=n.length;if(ct>$t){var pt=new re(Math.max($t*2,ct));pt.set(n),n=pt}},u=e.f||0,a=e.p||0,f=e.b||0,$=e.l,p=e.d,y=e.m,v=e.n,C=r*8;do{if(!$){u=oe(s,a,1);var B=oe(s,a+1,3);if(a+=3,B)if(B==1)$=Bo,p=No,y=9,v=5;else if(B==2){var N=oe(s,a,31)+257,U=oe(s,a+10,15)+4,E=N+oe(s,a+5,31)+1;a+=14;for(var T=new re(E),P=new re(19),x=0;x<U;++x)P[So[x]]=oe(s,a+x*3,7);a+=U*3;for(var R=Xe(P),ke=(1<<R)-1,Ce=ze(P,R,1),x=0;x<E;){var He=Ce[oe(s,a,ke)];a+=He&15;var D=He>>4;if(D<16)T[x++]=D;else{var he=0,Te=0;for(D==16?(Te=3+oe(s,a,3),a+=2,he=T[x-1]):D==17?(Te=3+oe(s,a,7),a+=3):D==18&&(Te=11+oe(s,a,127),a+=7);Te--;)T[x++]=he}}var We=T.subarray(0,N),se=T.subarray(N);y=Xe(We),v=Xe(se),$=ze(We,y,1),p=ze(se,v,1)}else ne(1);else{var D=Ao(a)+4,M=s[D-4]|s[D-3]<<8,L=D+M;if(L>r){c&&ne(0);break}i&&l(f+M),n.set(s.subarray(D,L),f),e.b=f+=M,e.p=a=L*8,e.f=u;continue}if(a>C){c&&ne(0);break}}i&&l(f+131072);for(var tn=(1<<y)-1,nn=(1<<v)-1,Ze=a;;Ze=a){var he=$[Qe(s,a)&tn],Oe=he>>4;if(a+=he&15,a>C){c&&ne(0);break}if(he||ne(2),Oe<256)n[f++]=Oe;else if(Oe==256){Ze=a,$=null;break}else{var ft=Oe-254;if(Oe>264){var x=Oe-257,Re=Ft[x];ft=oe(s,a,(1<<Re)-1)+Vt[x],a+=Re}var qe=p[Qe(s,a)&nn],Je=qe>>4;qe||ne(3),a+=qe&15;var se=Do[Je];if(Je>3){var Re=zt[Je];se+=Qe(s,a)&(1<<Re)-1,a+=Re}if(a>C){c&&ne(0);break}i&&l(f+131072);var Ye=f+ft;if(f<se){var ut=o-se,rn=Math.min(se,Ye);for(ut+f<0&&ne(3);f<rn;++f)n[f]=t[ut+f]}for(;f<Ye;f+=4)n[f]=n[f-se],n[f+1]=n[f+1-se],n[f+2]=n[f+2-se],n[f+3]=n[f+3-se];f=Ye}}e.l=$,e.p=Ze,e.b=f,e.f=u,$&&(u=1,e.m=y,e.d=p,e.n=v)}while(!u);return f==n.length?n:Oo(n,0,f)},Eo=new re(0),xo=function(s){(s[0]!=31||s[1]!=139||s[2]!=8)&&ne(6,"invalid gzip data");var e=s[3],n=10;e&4&&(n+=(s[10]|s[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!s[n++]);return n+(e&2)},Po=function(s){var e=s.length;return(s[e-4]|s[e-3]<<8|s[e-2]<<16|s[e-1]<<24)>>>0},Uo=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&ne(6,"invalid zlib data"),(s[1]>>5&1)==+!e&&ne(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function Ho(s,e){return it(s,{i:2},e&&e.out,e&&e.dictionary)}function Wo(s,e){var n=xo(s);return n+8>s.length&&ne(6,"invalid gzip data"),it(s.subarray(n,-8),{i:2},e&&e.out||new re(Po(s)),e&&e.dictionary)}function Ro(s,e){return it(s.subarray(Uo(s,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function rt(s,e){return s[0]==31&&s[1]==139&&s[2]==8?Wo(s,e):(s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31?Ho(s,e):Ro(s,e)}var Io=typeof TextDecoder<"u"&&new TextDecoder,Fo=0;try{Io.decode(Eo,{stream:!0}),Fo=1}catch{}var Zt=(s,e)=>s*Math.pow(2,e),Ie=(s,e)=>Math.floor(s/Math.pow(2,e)),Ve=(s,e)=>Zt(s.getUint16(e+1,!0),8)+s.getUint8(e),qt=(s,e)=>Zt(s.getUint32(e+2,!0),16)+s.getUint16(e,!0),zo=(s,e,n,t,r)=>{if(s!=t.getUint8(r))return s-t.getUint8(r);const o=Ve(t,r+1);if(e!=o)return e-o;const i=Ve(t,r+4);return n!=i?n-i:0},Go=(s,e,n,t)=>{const r=Jt(s,e|128,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!0}:null},St=(s,e,n,t)=>{const r=Jt(s,e,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!1}:null},Jt=(s,e,n,t)=>{let r=0,o=s.byteLength/17-1;for(;r<=o;){const i=o+r>>1,c=zo(e,n,t,s,i*17);if(c>0)r=i+1;else if(c<0)o=i-1;else return[qt(s,i*17+7),s.getUint32(i*17+13,!0)]}return null},jo=(s,e)=>s.is_dir&&!e.is_dir?1:!s.is_dir&&e.is_dir?-1:s.z!==e.z?s.z-e.z:s.x!==e.x?s.x-e.x:s.y-e.y,Yt=(s,e)=>{const n=s.getUint8(e*17);return{z:n&127,x:Ve(s,e*17+1),y:Ve(s,e*17+4),offset:qt(s,e*17+7),length:s.getUint32(e*17+13,!0),is_dir:n>>7===1}},Ct=s=>{const e=[],n=new DataView(s);for(let t=0;t<n.byteLength/17;t++)e.push(Yt(n,t));return Vo(e)},Vo=s=>{s.sort(jo);const e=new ArrayBuffer(17*s.length),n=new Uint8Array(e);for(let t=0;t<s.length;t++){const r=s[t];let o=r.z;r.is_dir&&(o=o|128),n[t*17]=o,n[t*17+1]=r.x&255,n[t*17+2]=r.x>>8&255,n[t*17+3]=r.x>>16&255,n[t*17+4]=r.y&255,n[t*17+5]=r.y>>8&255,n[t*17+6]=r.y>>16&255,n[t*17+7]=r.offset&255,n[t*17+8]=Ie(r.offset,8)&255,n[t*17+9]=Ie(r.offset,16)&255,n[t*17+10]=Ie(r.offset,24)&255,n[t*17+11]=Ie(r.offset,32)&255,n[t*17+12]=Ie(r.offset,48)&255,n[t*17+13]=r.length&255,n[t*17+14]=r.length>>8&255,n[t*17+15]=r.length>>16&255,n[t*17+16]=r.length>>24&255}return e},Ko=(s,e)=>{if(s.byteLength<17)return null;const n=s.byteLength/17,t=Yt(s,n-1);if(t.is_dir){const r=t.z,o=e.z-r,i=Math.trunc(e.x/(1<<o)),c=Math.trunc(e.y/(1<<o));return{z:r,x:i,y:c}}return null};function Zo(s){return J(this,null,function*(){const e=yield s.getBytes(0,512e3),n=new DataView(e.data),t=n.getUint32(4,!0),r=n.getUint16(8,!0),o=new TextDecoder("utf-8"),i=JSON.parse(o.decode(new DataView(e.data,10,t)));let c=0;i.compression==="gzip"&&(c=2);let l=0;"minzoom"in i&&(l=+i.minzoom);let u=0;"maxzoom"in i&&(u=+i.maxzoom);let a=0,f=0,$=0,p=-180,y=-85,v=180,C=85;if(i.bounds){const D=i.bounds.split(",");p=+D[0],y=+D[1],v=+D[2],C=+D[3]}if(i.center){const D=i.center.split(",");a=+D[0],f=+D[1],$=+D[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:c,tileType:1,minZoom:l,maxZoom:u,minLon:p,minLat:y,maxLon:v,maxLat:C,centerZoom:$,centerLon:a,centerLat:f,etag:e.etag}})}function qo(s,e,n,t,r,o,i){return J(this,null,function*(){let c=yield n.getArrayBuffer(e,s.rootDirectoryOffset,s.rootDirectoryLength,s);s.specVersion===1&&(c=Ct(c));const l=St(new DataView(c),t,r,o);if(l){let f=(yield e.getBytes(l.offset,l.length,i)).data;const $=new DataView(f);return $.getUint8(0)==31&&$.getUint8(1)==139&&(f=rt(new Uint8Array(f))),{data:f}}const u=Ko(new DataView(c),{z:t,x:r,y:o});if(u){const a=Go(new DataView(c),u.z,u.x,u.y);if(a){let f=yield n.getArrayBuffer(e,a.offset,a.length,s);s.specVersion===1&&(f=Ct(f));const $=St(new DataView(f),t,r,o);if($){let y=(yield e.getBytes($.offset,$.length,i)).data;const v=new DataView(y);return v.getUint8(0)==31&&v.getUint8(1)==139&&(y=rt(new Uint8Array(y))),{data:y}}}}})}var Xt={getHeader:Zo,getZxy:qo},Jo=class{constructor(){this.tile=(s,e)=>{if(s.type=="json"){const n=s.url.substr(10);let t=this.tiles.get(n);return t||(t=new Tt(n),this.tiles.set(n,t)),t.getHeader().then(r=>{const o={tiles:[s.url+"/{z}/{x}/{y}"],minzoom:r.minZoom,maxzoom:r.maxZoom,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat]};e(null,o,null,null)}).catch(r=>{e(r,null,null,null)}),{cancel:()=>{}}}else{const n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=s.url.match(n);if(!t)throw new Error("Invalid PMTiles protocol URL");const r=t[1];let o=this.tiles.get(r);o||(o=new Tt(r),this.tiles.set(r,o));const i=t[2],c=t[3],l=t[4],u=new AbortController,a=u.signal;let f=()=>{u.abort()};return o.getHeader().then($=>{o.getZxy(+i,+c,+l,a).then(p=>{p?e(null,new Uint8Array(p.data),p.cacheControl,p.expires):$.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(p=>{p.name!=="AbortError"&&e(p,null,null,null)})}),{cancel:f}}},this.tiles=new Map}add(s){this.tiles.set(s.source.getKey(),s)}get(s){return this.tiles.get(s)}};function Me(s,e){return(e>>>0)*4294967296+(s>>>0)}function Yo(s,e){const n=e.buf;let t,r;if(r=n[e.pos++],t=(r&112)>>4,r<128||(r=n[e.pos++],t|=(r&127)<<3,r<128)||(r=n[e.pos++],t|=(r&127)<<10,r<128)||(r=n[e.pos++],t|=(r&127)<<17,r<128)||(r=n[e.pos++],t|=(r&127)<<24,r<128)||(r=n[e.pos++],t|=(r&1)<<31,r<128))return Me(s,t);throw new Error("Expected varint not more than 10 bytes")}function Fe(s){const e=s.buf;let n,t;return t=e[s.pos++],n=t&127,t<128||(t=e[s.pos++],n|=(t&127)<<7,t<128)||(t=e[s.pos++],n|=(t&127)<<14,t<128)||(t=e[s.pos++],n|=(t&127)<<21,t<128)?n:(t=e[s.pos],n|=(t&15)<<28,Yo(n,s))}function Xo(s,e,n,t){if(t==0){n==1&&(e[0]=s-1-e[0],e[1]=s-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}var Qo=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function el(s,e,n){if(s>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,s)-1||n>Math.pow(2,s)-1)throw Error("tile x/y outside zoom level bounds");const t=Qo[s],r=Math.pow(2,s);let o=0,i=0,c=0;const l=[e,n];let u=r/2;for(;u>0;)o=(l[0]&u)>0?1:0,i=(l[1]&u)>0?1:0,c+=u*u*(3*o^i),Xo(u,l,o,i),u=u/2;return t+c}function Qt(s,e){return J(this,null,function*(){if(e===1||e===0)return s;if(e===2){if(typeof globalThis.DecompressionStream>"u")return rt(new Uint8Array(s));{let t=new Response(s).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var tl=127;function nl(s,e){let n=0,t=s.length-1;for(;n<=t;){const r=t+n>>1,o=e-s[r].tileId;if(o>0)n=r+1;else if(o<0)t=r-1;else return s[r]}return t>=0&&(s[t].runLength===0||e-s[t].tileId<s[t].runLength)?s[t]:null}var rl=class{constructor(s){this.url=s}getKey(){return this.url}getBytes(s,e,n){return J(this,null,function*(){let t;n||(t=new AbortController,n=t.signal);let r=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+s+"-"+(s+e-1)}});if(r.status===416&&s===0){const c=r.headers.get("Content-Range");if(!c||!c.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const l=+c.substr(8);r=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(l-1)}})}if(r.status>=300)throw Error("Bad response code: "+r.status);const o=r.headers.get("Content-Length");if(r.status===200&&(!o||+o>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield r.arrayBuffer(),etag:r.headers.get("ETag")||void 0,cacheControl:r.headers.get("Cache-Control")||void 0,expires:r.headers.get("Expires")||void 0}})}};function le(s,e){const n=s.getUint32(e+4,!0),t=s.getUint32(e+0,!0);return n*Math.pow(2,32)+t}function sl(s,e){const n=new DataView(s),t=n.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:le(n,8),rootDirectoryLength:le(n,16),jsonMetadataOffset:le(n,24),jsonMetadataLength:le(n,32),leafDirectoryOffset:le(n,40),leafDirectoryLength:le(n,48),tileDataOffset:le(n,56),tileDataLength:le(n,64),numAddressedTiles:le(n,72),numTileEntries:le(n,80),numTileContents:le(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function en(s){const e={buf:new Uint8Array(s),pos:0},n=Fe(e),t=[];let r=0;for(let o=0;o<n;o++){const i=Fe(e);t.push({tileId:r+i,offset:0,length:0,runLength:1}),r+=i}for(let o=0;o<n;o++)t[o].runLength=Fe(e);for(let o=0;o<n;o++)t[o].length=Fe(e);for(let o=0;o<n;o++){const i=Fe(e);i===0&&o>0?t[o].offset=t[o-1].offset+t[o-1].length:t[o].offset=i-1}return t}function ol(s){const e=new DataView(s);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Pe=class extends Error{};function ll(s,e,n,t){return J(this,null,function*(){const r=yield s.getBytes(0,16384);if(new DataView(r.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(ol(r.data)<3)return[yield Xt.getHeader(s)];const i=r.data.slice(0,tl);let c=r.etag;t&&r.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+s.getKey()),c=void 0);const l=sl(i,c);if(n){const u=r.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),a=s.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,f=en(yield e(u,l.internalCompression));return[l,[a,f.length,f]]}return[l,void 0]})}function al(s,e,n,t,r){return J(this,null,function*(){const o=yield s.getBytes(n,t);if(r.etag&&r.etag!==o.etag)throw new Pe(o.etag);const i=yield e(o.data,r.internalCompression),c=en(i);if(c.length===0)throw new Error("Empty directory is invalid");return c})}var il=class{constructor(s=100,e=!0,n=Qt){this.cache=new Map,this.maxCacheEntries=s,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(s,e){return J(this,null,function*(){const n=s.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const t=new Promise((r,o)=>{ll(s,this.decompress,this.prefetch,e).then(i=>{i[1]&&this.cache.set(i[1][0],{lastUsed:this.counter++,data:Promise.resolve(i[1][2])}),r(i[0]),this.prune()}).catch(i=>{o(i)})});return this.cache.set(n,{lastUsed:this.counter++,data:t}),t})}getDirectory(s,e,n,t){return J(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const o=new Promise((i,c)=>{al(s,this.decompress,e,n,t).then(l=>{i(l),this.prune()}).catch(l=>{c(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(s,e,n,t){return J(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const o=new Promise((i,c)=>{s.getBytes(e,n).then(l=>{if(t.etag&&t.etag!==l.etag)throw new Pe(l.etag);i(l.data),this.cache.has(r),this.prune()}).catch(l=>{c(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let s=1/0,e;this.cache.forEach((n,t)=>{n.lastUsed<s&&(s=n.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(s,e){return J(this,null,function*(){this.cache.delete(s.getKey()),yield this.getHeader(s,e)})}},Tt=class{constructor(s,e,n){typeof s=="string"?this.source=new rl(s):this.source=s,n?this.decompress=n:this.decompress=Qt,e?this.cache=e:this.cache=new il}getHeader(){return J(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(s,e,n,t){return J(this,null,function*(){const r=el(s,e,n),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return Xt.getZxy(o,this.source,this.cache,s,e,n,t);if(s<o.minZoom||s>o.maxZoom)return;let i=o.rootDirectoryOffset,c=o.rootDirectoryLength;for(let l=0;l<=3;l++){const u=yield this.cache.getDirectory(this.source,i,c,o),a=nl(u,r);if(a)if(a.runLength>0){const f=yield this.source.getBytes(o.tileDataOffset+a.offset,a.length,t);if(o.etag&&o.etag!==f.etag)throw new Pe(f.etag);return{data:yield this.decompress(f.data,o.tileCompression),cacheControl:f.cacheControl,expires:f.expires}}else i=o.leafDirectoryOffset+a.offset,c=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(s,e,n,t){return J(this,null,function*(){try{return yield this.getZxyAttempt(s,e,n,t)}catch(r){if(r instanceof Pe)return this.cache.invalidate(this.source,r.message),yield this.getZxyAttempt(s,e,n,t);throw r}})}getMetadataAttempt(){return J(this,null,function*(){const s=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(s.jsonMetadataOffset,s.jsonMetadataLength);if(s.etag&&s.etag!==e.etag)throw new Pe(e.etag);const n=yield this.decompress(e.data,s.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(n))})}getMetadata(){return J(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(s){if(s instanceof Pe)return this.cache.invalidate(this.source,s.message),yield this.getMetadataAttempt();throw s}})}};function fl(s){return ot(()=>{let e=new Jo;ht.addProtocol("pmtiles",e.tile)}),Rt(()=>{ht.removeProtocol("pmtiles")}),[]}class ul extends F{constructor(e){super(),z(this,e,fl,null,G,{})}}function Dt(s,e,n){const t=s.slice();return t[15]=e[n],t}function cl(s){let e;return{c(){e=b("Home")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Bt(s){let e,n;return e=new $n({props:{errorMessage:s[0]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&1&&(o.errorMessage=t[0]),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Nt(s){let e,n,t,r;function o(l){s[10](l)}function i(l){s[11](l)}let c={schemes:s[1]};return s[2]!==void 0&&(c.schemesToBeShown=s[2]),s[3]!==void 0&&(c.filterText=s[3]),e=new Br({props:c}),V.push(()=>K(e,"schemesToBeShown",o)),V.push(()=>K(e,"filterText",i)),{c(){_(e.$$.fragment)},m(l,u){w(e,l,u),r=!0},p(l,u){const a={};u&2&&(a.schemes=l[1]),!n&&u&4&&(n=!0,a.schemesToBeShown=l[2],Z(()=>n=!1)),!t&&u&8&&(t=!0,a.filterText=l[3],Z(()=>t=!1)),e.$set(a)},i(l){r||(g(e.$$.fragment,l),r=!0)},o(l){d(e.$$.fragment,l),r=!1},d(l){k(e,l)}}}function At(s){let e,n;return e=new to({props:{scheme:s[15],authorityNames:s[5]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&2&&(o.scheme=t[15]),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Ot(s){let e=s[2].has(s[15].scheme_reference),n,t,r=e&&At(s);return{c(){r&&r.c(),n=pn()},m(o,i){r&&r.m(o,i),m(o,n,i),t=!0},p(o,i){i&6&&(e=o[2].has(o[15].scheme_reference)),e?r?(r.p(o,i),i&6&&g(r,1)):(r=At(o),r.c(),g(r,1),r.m(n.parentNode,n)):r&&(ye(),d(r,1,1,()=>{r=null}),Le())},i(o){t||(g(r),t=!0)},o(o){d(r),t=!1},d(o){o&&h(n),r&&r.d(o)}}}function $l(s){let e,n,t,r,o,i,c,l,u,a,f,$,p,y;n=new je({props:{$$slots:{default:[cl]},$$scope:{ctx:s}}}),n.$on("click",s[9]),c=new dn({props:{boundaryGeojson:s[4]}});let v=s[0]&&Bt(s);a=new an({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:s[7]}});let C=s[1].size>0&&Nt(s),B=Ee(s[1].values()),D=[];for(let L=0;L<B.length;L+=1)D[L]=Ot(Dt(s,B,L));const M=L=>d(D[L],1,1,()=>{D[L]=null});return{c(){e=O("div"),_(n.$$.fragment),t=A(),r=O("div"),o=O("h1"),o.textContent="Browse schemes",i=A(),_(c.$$.fragment),l=A(),v&&v.c(),u=A(),_(a.$$.fragment),f=A(),C&&C.c(),$=A(),p=O("ul");for(let L=0;L<D.length;L+=1)D[L].c();de(r,"display","flex"),de(r,"justify-content","space-between"),I(e,"slot","sidebar"),I(e,"class","govuk-prose")},m(L,N){m(L,e,N),w(n,e,null),S(e,t),S(e,r),S(r,o),S(r,i),w(c,r,null),S(e,l),v&&v.m(e,null),S(e,u),w(a,e,null),S(e,f),C&&C.m(e,null),S(e,$),S(e,p);for(let U=0;U<D.length;U+=1)D[U]&&D[U].m(p,null);y=!0},p(L,N){const U={};N&262144&&(U.$$scope={dirty:N,ctx:L}),n.$set(U);const E={};if(N&16&&(E.boundaryGeojson=L[4]),c.$set(E),L[0]?v?(v.p(L,N),N&1&&g(v,1)):(v=Bt(L),v.c(),g(v,1),v.m(e,u)):v&&(ye(),d(v,1,1,()=>{v=null}),Le()),L[1].size>0?C?(C.p(L,N),N&2&&g(C,1)):(C=Nt(L),C.c(),g(C,1),C.m(e,$)):C&&(ye(),d(C,1,1,()=>{C=null}),Le()),N&38){B=Ee(L[1].values());let T;for(T=0;T<B.length;T+=1){const P=Dt(L,B,T);D[T]?(D[T].p(P,N),g(D[T],1)):(D[T]=Ot(P),D[T].c(),g(D[T],1),D[T].m(p,null))}for(ye(),T=B.length;T<D.length;T+=1)M(T);Le()}},i(L){if(!y){g(n.$$.fragment,L),g(c.$$.fragment,L),g(v),g(a.$$.fragment,L),g(C);for(let N=0;N<B.length;N+=1)g(D[N]);y=!0}},o(L){d(n.$$.fragment,L),d(c.$$.fragment,L),d(v),d(a.$$.fragment,L),d(C),D=D.filter(Boolean);for(let N=0;N<D.length;N+=1)d(D[N]);y=!1},d(L){L&&h(e),k(n),k(c),v&&v.d(),k(a),C&&C.d(),et(D,L)}}}function pl(s){let e,n,t,r,o,i,c,l;return e=new lo({}),t=new Wr({}),o=new $o({}),c=new qs({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(o.$$.fragment),i=A(),_(c.$$.fragment)},m(u,a){w(e,u,a),m(u,n,a),w(t,u,a),m(u,r,a),w(o,u,a),m(u,i,a),w(c,u,a),l=!0},i(u){l||(g(e.$$.fragment,u),g(t.$$.fragment,u),g(o.$$.fragment,u),g(c.$$.fragment,u),l=!0)},o(u){d(e.$$.fragment,u),d(t.$$.fragment,u),d(o.$$.fragment,u),d(c.$$.fragment,u),l=!1},d(u){u&&(h(n),h(r),h(i)),k(e,u),k(t,u),k(o,u),k(c,u)}}}function ml(s){let e,n;return e=new lt({props:{small:!0,$$slots:{default:[pl]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&262144&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function hl(s){let e,n,t,r,o,i;return e=new Ts({}),t=new Nn({}),o=new wr({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(o.$$.fragment)},m(c,l){w(e,c,l),m(c,n,l),w(t,c,l),m(c,r,l),w(o,c,l),i=!0},i(c){i||(g(e.$$.fragment,c),g(t.$$.fragment,c),g(o.$$.fragment,c),i=!0)},o(c){d(e.$$.fragment,c),d(t.$$.fragment,c),d(o.$$.fragment,c),i=!1},d(c){c&&(h(n),h(r)),k(e,c),k(t,c),k(o,c)}}}function gl(s){let e,n;return e=new lt({props:{small:!0,$$slots:{default:[hl]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&262144&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function dl(s){let e,n,t,r,o,i,c,l,u,a;return e=new Us({}),t=new yo({}),o=new ur({}),c=new os({}),u=new _s({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(o.$$.fragment),i=A(),_(c.$$.fragment),l=A(),_(u.$$.fragment)},m(f,$){w(e,f,$),m(f,n,$),w(t,f,$),m(f,r,$),w(o,f,$),m(f,i,$),w(c,f,$),m(f,l,$),w(u,f,$),a=!0},i(f){a||(g(e.$$.fragment,f),g(t.$$.fragment,f),g(o.$$.fragment,f),g(c.$$.fragment,f),g(u.$$.fragment,f),a=!0)},o(f){d(e.$$.fragment,f),d(t.$$.fragment,f),d(o.$$.fragment,f),d(c.$$.fragment,f),d(u.$$.fragment,f),a=!1},d(f){f&&(h(n),h(r),h(i),h(l)),k(e,f),k(t,f),k(o,f),k(c,f),k(u,f)}}}function _l(s){let e,n;return e=new lt({props:{small:!0,$$slots:{default:[dl]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&262144&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function wl(s){let e,n,t,r;return e=new er({}),t=new qr({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment)},m(o,i){w(e,o,i),m(o,n,i),w(t,o,i),r=!0},i(o){r||(g(e.$$.fragment,o),g(t.$$.fragment,o),r=!0)},o(o){d(e.$$.fragment,o),d(t.$$.fragment,o),r=!1},d(o){o&&h(n),k(e,o),k(t,o)}}}function kl(s){let e,n,t,r,o,i,c,l,u,a;return e=new Ae({props:{label:"Trip generators",$$slots:{default:[ml]},$$scope:{ctx:s}}}),t=new Ae({props:{label:"Existing infrastructure",$$slots:{default:[gl]},$$scope:{ctx:s}}}),o=new Ae({props:{label:"Boundaries",$$slots:{default:[_l]},$$scope:{ctx:s}}}),c=new Ae({props:{label:"Census",$$slots:{default:[wl]},$$scope:{ctx:s}}}),u=new kn({props:{style:s[6]}}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(o.$$.fragment),i=A(),_(c.$$.fragment),l=A(),_(u.$$.fragment)},m(f,$){w(e,f,$),m(f,n,$),w(t,f,$),m(f,r,$),w(o,f,$),m(f,i,$),w(c,f,$),m(f,l,$),w(u,f,$),a=!0},p(f,$){const p={};$&262144&&(p.$$scope={dirty:$,ctx:f}),e.$set(p);const y={};$&262144&&(y.$$scope={dirty:$,ctx:f}),t.$set(y);const v={};$&262144&&(v.$$scope={dirty:$,ctx:f}),o.$set(v);const C={};$&262144&&(C.$$scope={dirty:$,ctx:f}),c.$set(C)},i(f){a||(g(e.$$.fragment,f),g(t.$$.fragment,f),g(o.$$.fragment,f),g(c.$$.fragment,f),g(u.$$.fragment,f),a=!0)},o(f){d(e.$$.fragment,f),d(t.$$.fragment,f),d(o.$$.fragment,f),d(c.$$.fragment,f),d(u.$$.fragment,f),a=!1},d(f){f&&(h(n),h(r),h(i),h(l)),k(e,f),k(t,f),k(o,f),k(c,f),k(u,f)}}}function bl(s){let e,n,t,r,o,i,c,l,u,a,f;return e=new wn({props:{colorInterventions:It("v1")}}),t=new Y({props:{layer:"interventions-points",tooltip:s[8],clickable:!1}}),o=new Y({props:{layer:"interventions-lines",tooltip:s[8],clickable:!1}}),c=new Y({props:{layer:"interventions-polygons",tooltip:s[8],clickable:!1}}),a=new Ae({props:{label:"Layers",open:!0,$$slots:{default:[kl]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(o.$$.fragment),i=A(),_(c.$$.fragment),l=A(),u=O("div"),_(a.$$.fragment),I(u,"class","top-right svelte-12h3i77")},m($,p){w(e,$,p),m($,n,p),w(t,$,p),m($,r,p),w(o,$,p),m($,i,p),w(c,$,p),m($,l,p),m($,u,p),w(a,u,null),f=!0},p($,p){const y={};p&262144&&(y.$$scope={dirty:p,ctx:$}),a.$set(y)},i($){f||(g(e.$$.fragment,$),g(t.$$.fragment,$),g(o.$$.fragment,$),g(c.$$.fragment,$),g(a.$$.fragment,$),f=!0)},o($){d(e.$$.fragment,$),d(t.$$.fragment,$),d(o.$$.fragment,$),d(c.$$.fragment,$),d(a.$$.fragment,$),f=!1},d($){$&&(h(n),h(r),h(i),h(l),h(u)),k(e,$),k(t,$),k(o,$),k(c,$),k(a)}}}function vl(s){let e,n,t,r,o;return n=new ul({}),r=new _n({props:{style:s[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[bl]},$$scope:{ctx:s}}}),{c(){e=O("div"),_(n.$$.fragment),t=A(),_(r.$$.fragment),I(e,"slot","main")},m(i,c){m(i,e,c),w(n,e,null),S(e,t),w(r,e,null),o=!0},p(i,c){const l={};c&262144&&(l.$$scope={dirty:c,ctx:i}),r.$set(l)},i(i){o||(g(n.$$.fragment,i),g(r.$$.fragment,i),o=!0)},o(i){d(n.$$.fragment,i),d(r.$$.fragment,i),o=!1},d(i){i&&h(e),k(n),k(r)}}}function yl(s){let e,n;return e=new gn({props:{$$slots:{main:[vl],sidebar:[$l]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&262175&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Ll(s,e,n){let t,r;q(s,X,D=>n(12,t=D)),q(s,Ue,D=>n(4,r=D));let o=new Set(bn);ot(()=>{fn()});let c=new URLSearchParams(window.location.search).get("style")||"dataviz",l="",u=new Map,a=new Set,f="";Rt(()=>{Ue.set(un())});function $(D){try{let M=JSON.parse(D);n(1,u=kr(M)),Ue.set(M),n(0,l=""),t==null||t.fitBounds(Wt(M),{padding:20,animate:!1})}catch(M){n(0,l=`Couldn't load schemes from a file: ${M}`)}}function p(D){let M=D.properties;var L='<div style="max-width: 30vw;">';return L+=`<h2>${y(M.name)} (${M.intervention_type})</h2>`,L+=`<p>Scheme reference: ${M.scheme_reference}</p>`,M.length_meters&&(L+=`<p>Length: ${cn(M.length_meters)}</p>`),M.description&&(L+=`<p>${y(M.description)}</p>`),L+="</div>",L}function y(D){return f?D.replace(new RegExp(f,"gi"),M=>`<mark>${M}</mark>`):D}const v=()=>window.open("index.html");function C(D){a=D,n(2,a)}function B(D){f=D,n(3,f)}return[l,u,a,f,r,o,c,$,p,v,C,B]}class Sl extends F{constructor(e){super(),z(this,e,Ll,yl,G,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Sl({target:document.getElementById("app")});
