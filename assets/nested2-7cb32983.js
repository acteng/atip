import{S as q,i as W,s as Y,g as L,f as A,e as P,u as U,m as D,j as v,k as M,T as J,t as d,l as $,p as w,q as S,Z as X,a1 as ae,r as Ce,b as ee,c as te,F as Ut,o as ne,a as ve,h as x,v as Ze,w as Mt,M as Ee,C as de,aV as nt,a0 as Ct,G as Et,J as Bt,K as At,L as zt,aU as fe,ay as Pt,a6 as Ot,x as Nt,D as rt,aW as He,af as st,d as Ft,W as xe,y as pe,n as he,z as It,A as jt,a8 as Vt,aO as Zt,E as Ht,U as Re,V as xt,ac as Rt}from"./data_getter-343c14cc.js";import{C as Be,S as Se,d as ot,j as it,H as lt,h as Kt,i as Ke,g as at,L as Gt,Z as Jt,M as qt,I as Wt,b as Yt,B as Qt}from"./Map-161a82d2.js";function Xt(n){let e=new Map;for(let[r,t]of Object.entries(n.schemes))e.set(r,{scheme_reference:r,num_features:0,authority_or_region:t.authority_or_region,capital_scheme_id:t.capital_scheme_id,funding_programme:t.funding_programme});for(let r of n.features){let t=e.get(r.properties.scheme_reference);t.num_features++,r.properties.funding_programme=t.funding_programme}return e}function en(n){let e;return{c(){e=U("Clear")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function tn(n){let e,r,t,s,o,l;return t=new ve({props:{$$slots:{default:[en]},$$scope:{ctx:n}}}),t.$on("click",n[11]),{c(){e=P("input"),r=A(),L(t.$$.fragment),x(e,"type","text"),x(e,"class","govuk-input govuk-input--width-10"),x(e,"id","filterText")},m(a,i){v(a,e,i),Ze(e,n[0]),v(a,r,i),D(t,a,i),s=!0,o||(l=Mt(e,"input",n[10]),o=!0)},p(a,i){i&1&&e.value!==a[0]&&Ze(e,a[0]);const u={};i&16384&&(u.$$scope={dirty:i,ctx:a}),t.$set(u)},i(a){s||(d(t.$$.fragment,a),s=!0)},o(a){$(t.$$.fragment,a),s=!1},d(a){a&&(w(e),w(r)),S(t,a),o=!1,l()}}}function nn(n){let e,r,t,s,o,l,a,i;function u(m){n[8](m)}let f={label:"Authority or region",id:"filterAuthority",choices:n[4],emptyOption:!0};n[2]!==void 0&&(f.value=n[2]),e=new Se({props:f}),ee.push(()=>te(e,"value",u));function c(m){n[9](m)}let _={label:"Funding programme",id:"filterFundingProgramme",choices:n[5],emptyOption:!0};return n[3]!==void 0&&(_.value=n[3]),s=new Se({props:_}),ee.push(()=>te(s,"value",c)),a=new Ut({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[tn]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment),t=A(),L(s.$$.fragment),l=A(),L(a.$$.fragment)},m(m,g){D(e,m,g),v(m,t,g),D(s,m,g),v(m,l,g),D(a,m,g),i=!0},p(m,g){const y={};g&16&&(y.choices=m[4]),!r&&g&4&&(r=!0,y.value=m[2],ne(()=>r=!1)),e.$set(y);const k={};g&32&&(k.choices=m[5]),!o&&g&8&&(o=!0,k.value=m[3],ne(()=>o=!1)),s.$set(k);const h={};g&16385&&(h.$$scope={dirty:g,ctx:m}),a.$set(h)},i(m){i||(d(e.$$.fragment,m),d(s.$$.fragment,m),d(a.$$.fragment,m),i=!0)},o(m){$(e.$$.fragment,m),$(s.$$.fragment,m),$(a.$$.fragment,m),i=!1},d(m){m&&(w(t),w(l)),S(e,m),S(s,m),S(a,m)}}}function rn(n){let e,r,t,s,o=n[1].size+"",l,a,i=n[6].route+"",u,f,c=n[6].area+"",_,m,g=n[6].crossing+"",y,k,h=n[6].other+"",p,T,E;return e=new Be({props:{label:"Filters",$$slots:{default:[nn]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment),r=A(),t=P("p"),s=U("Showing "),l=U(o),a=U(" schemes ("),u=U(i),f=U(" routes, "),_=U(c),m=U(` areas,
  `),y=U(g),k=U(" crossings, "),p=U(h),T=U(" other)")},m(b,C){D(e,b,C),v(b,r,C),v(b,t,C),M(t,s),M(t,l),M(t,a),M(t,u),M(t,f),M(t,_),M(t,m),M(t,y),M(t,k),M(t,p),M(t,T),E=!0},p(b,[C]){const z={};C&16445&&(z.$$scope={dirty:C,ctx:b}),e.$set(z),(!E||C&2)&&o!==(o=b[1].size+"")&&J(l,o),(!E||C&64)&&i!==(i=b[6].route+"")&&J(u,i),(!E||C&64)&&c!==(c=b[6].area+"")&&J(_,c),(!E||C&64)&&g!==(g=b[6].crossing+"")&&J(y,g),(!E||C&64)&&h!==(h=b[6].other+"")&&J(p,h)},i(b){E||(d(e.$$.fragment,b),E=!0)},o(b){$(e.$$.fragment,b),E=!1},d(b){b&&(w(r),w(t)),S(e,b)}}}function sn(n,e,r){let t;X(n,ae,h=>r(12,t=h));let{schemes:s}=e,{schemesToBeShown:o=new Set}=e,{filterText:l=""}=e,a=[],i="",u=[],f="",c={area:0,route:0,crossing:0,other:0};Ce(()=>{let h=new Set,p=new Set;for(let T of s.values())T.authority_or_region&&h.add(T.authority_or_region),T.funding_programme&&p.add(T.funding_programme);r(4,a=Array.from(h.entries())),a.sort(),r(5,u=Array.from(p.entries())),u.sort()});function _(h,p,T){let E=h.toLowerCase(),b=z=>{var O,R;if(E&&!((O=z.properties.name)!=null&&O.toLowerCase().includes(E))&&!((R=z.properties.description)!=null&&R.toLowerCase().includes(E)))return!1;if(p||T){let N=s.get(z.properties.scheme_reference);if(p&&N.authority_or_region!=p||T&&N.funding_programme!=T)return!1}return!0};r(1,o=new Set(t.features.filter(b).map(z=>z.properties.scheme_reference))),r(6,c={area:0,route:0,crossing:0,other:0});let C=z=>{var O,R;return!(!o.has(z.properties.scheme_reference)||E&&!((O=z.properties.name)!=null&&O.toLowerCase().includes(E))&&!((R=z.properties.description)!=null&&R.toLowerCase().includes(E)))};ae.update(z=>{for(let O of z.features)C(O)?(delete O.properties.hide_while_editing,r(6,c[O.properties.intervention_type]++,c)):O.properties.hide_while_editing=!0;return z}),r(6,c)}function m(h){i=h,r(2,i)}function g(h){f=h,r(3,f)}function y(){l=this.value,r(0,l)}const k=()=>r(0,l="");return n.$$set=h=>{"schemes"in h&&r(7,s=h.schemes),"schemesToBeShown"in h&&r(1,o=h.schemesToBeShown),"filterText"in h&&r(0,l=h.filterText)},n.$$.update=()=>{n.$$.dirty&13&&_(l,i,f)},[l,o,i,f,a,u,c,s,m,g,y,k]}class on extends q{constructor(e){super(),W(this,e,sn,rn,Y,{schemes:7,schemesToBeShown:1,filterText:0})}}const Q={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function ln(n){let e,r,t,s;return e=new it({props:{color:n[3]}}),{c(){L(e.$$.fragment),r=A(),t=U(n[1])},m(o,l){D(e,o,l),v(o,r,l),v(o,t,l),s=!0},p(o,l){(!s||l&2)&&J(t,o[1])},i(o){s||(d(e.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),s=!1},d(o){o&&(w(r),w(t)),S(e,o)}}}function an(n){let e;const r=n[7].default,t=Et(r,n,n[9],null);return{c(){t&&t.c()},m(s,o){t&&t.m(s,o),e=!0},p(s,o){t&&t.p&&(!e||o&512)&&Bt(t,r,s,s[9],e?zt(r,s[9],o,null):At(s[9]),null)},i(s){e||(d(t,s),e=!0)},o(s){$(t,s),e=!1},d(s){t&&t.d(s)}}}function fn(n){let e,r,t;return r=new lt({props:{$$slots:{default:[an]},$$scope:{ctx:n}}}),{c(){e=P("span"),L(r.$$.fragment),x(e,"slot","right")},m(s,o){v(s,e,o),D(r,e,null),t=!0},p(s,o){const l={};o&512&&(l.$$scope={dirty:o,ctx:s}),r.$set(l)},i(s){t||(d(r.$$.fragment,s),t=!0)},o(s){$(r.$$.fragment,s),t=!1},d(s){s&&w(e),S(r)}}}function un(n){let e,r,t,s,o;function l(i){n[8](i)}let a={id:n[0],$$slots:{right:[fn],default:[ln]},$$scope:{ctx:n}};return n[2]!==void 0&&(a.checked=n[2]),e=new ot({props:a}),ee.push(()=>te(e,"checked",l)),s=new Ee({props:{layers:[n[0]],contents:n[4]}}),{c(){L(e.$$.fragment),t=A(),L(s.$$.fragment)},m(i,u){D(e,i,u),v(i,t,u),D(s,i,u),o=!0},p(i,[u]){const f={};u&1&&(f.id=i[0]),u&514&&(f.$$scope={dirty:u,ctx:i}),!r&&u&4&&(r=!0,f.checked=i[2],ne(()=>r=!1)),e.$set(f);const c={};u&1&&(c.layers=[i[0]]),s.$set(c)},i(i){o||(d(e.$$.fragment,i),d(s.$$.fragment,i),o=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&w(t),S(e,i),S(s,i)}}}function cn(n,e,r){let t;X(n,de,m=>r(6,t=m));let{$$slots:s={},$$scope:o}=e,{name:l}=e,{singularNoun:a}=e,{pluralNoun:i}=e,u=Q[l];nt(t,l,`https://atip.uk/layers/v1/${l}.pmtiles`),Ct(t,{id:l,source:l,sourceLayer:l,color:u,opacity:.8});let f=!1;function c(m){return`<p>${m.name??`Unnamed ${a}`}</p>`}function _(m){f=m,r(2,f)}return n.$$set=m=>{"name"in m&&r(0,l=m.name),"singularNoun"in m&&r(5,a=m.singularNoun),"pluralNoun"in m&&r(1,i=m.pluralNoun),"$$scope"in m&&r(9,o=m.$$scope)},n.$$.update=()=>{n.$$.dirty&69&&t.getLayer(l)&&t.setLayoutProperty(l,"visibility",f?"visible":"none")},[l,i,f,u,c,a,t,s,_,o]}class ft extends q{constructor(e){super(),W(this,e,cn,un,Y,{name:0,singularNoun:5,pluralNoun:1})}}function mn(n){let e;return{c(){e=U("hospital")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function pn(n){let e;return{c(){e=U("Open Data Commons Open Database License")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function hn(n){let e,r,t,s,o,l,a,i,u;return t=new fe({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[mn]},$$scope:{ctx:n}}}),i=new fe({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[pn]},$$scope:{ctx:n}}}),{c(){e=P("p"),r=U("This shows "),L(t.$$.fragment),s=U(` data from OpenStreetMap. It doesn't include outpatient clinics
    or individual doctor's offices.`),o=A(),l=P("p"),a=U("License: "),L(i.$$.fragment)},m(f,c){v(f,e,c),M(e,r),D(t,e,null),M(e,s),v(f,o,c),v(f,l,c),M(l,a),D(i,l,null),u=!0},p(f,c){const _={};c&1&&(_.$$scope={dirty:c,ctx:f}),t.$set(_);const m={};c&1&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||(d(t.$$.fragment,f),d(i.$$.fragment,f),u=!0)},o(f){$(t.$$.fragment,f),$(i.$$.fragment,f),u=!1},d(f){f&&(w(e),w(o),w(l)),S(t),S(i)}}}function gn(n){let e,r;return e=new ft({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[hn]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){D(e,t,s),r=!0},p(t,[s]){const o={};s&1&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}class dn extends q{constructor(e){super(),W(this,e,null,gn,Y,{})}}function $n(n){let e,r,t,s,o;function l(i){n[3](i)}let a={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return n[0]!==void 0&&(a.value=n[0]),e=new Se({props:a}),ee.push(()=>te(e,"value",l)),e.$on("change",n[2]),s=new Kt({props:{rows:n[1]}}),{c(){L(e.$$.fragment),t=A(),L(s.$$.fragment)},m(i,u){D(e,i,u),v(i,t,u),D(s,i,u),o=!0},p(i,[u]){const f={};!r&&u&1&&(r=!0,f.value=i[0],ne(()=>r=!1)),e.$set(f);const c={};u&2&&(c.rows=i[1]),s.$set(c)},i(i){o||(d(e.$$.fragment,i),d(s.$$.fragment,i),o=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&w(t),S(e,i),S(s,i)}}}function _n(n,e,r){let t;X(n,de,i=>r(4,t=i));let s="interventionType",o=Ke("v1");function l(){let i;s=="interventionType"?(i=at("v1"),r(1,o=Ke("v1"))):(i=Pt(["get","funding_programme"],{ATF2:Q.atf2,ATF3:Q.atf3,ATF4:Q.atf4},"grey"),r(1,o=[["ATF2",Q.atf2],["ATF3",Q.atf3],["ATF4",Q.atf4]])),t.setPaintProperty("interventions-points","circle-color",i),t.setPaintProperty("interventions-lines","line-color",i),t.setPaintProperty("interventions-polygons","fill-color",i),t.setPaintProperty("interventions-polygon-outlines","line-color",i)}function a(i){s=i,r(0,s)}return[s,o,l,a]}class vn extends q{constructor(e){super(),W(this,e,_n,$n,Y,{})}}function wn(n){let e,r,t;return e=new it({props:{color:n[1]}}),{c(){L(e.$$.fragment),r=U(`
  MRN`)},m(s,o){D(e,s,o),v(s,r,o),t=!0},p:Nt,i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){s&&w(r),S(e,s)}}}function yn(n){let e;return{c(){e=U(`Major Road Network
        `)},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function bn(n){let e;return{c(){e=U("Open Government License")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function kn(n){let e,r,t,s,o,l,a,i,u;return t=new fe({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[yn]},$$scope:{ctx:n}}}),i=new fe({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[bn]},$$scope:{ctx:n}}}),{c(){e=P("p"),r=U("Data from the "),L(t.$$.fragment),s=U("."),o=A(),l=P("p"),a=U("License: "),L(i.$$.fragment)},m(f,c){v(f,e,c),M(e,r),D(t,e,null),M(e,s),v(f,o,c),v(f,l,c),M(l,a),D(i,l,null),u=!0},p(f,c){const _={};c&16&&(_.$$scope={dirty:c,ctx:f}),t.$set(_);const m={};c&16&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||(d(t.$$.fragment,f),d(i.$$.fragment,f),u=!0)},o(f){$(t.$$.fragment,f),$(i.$$.fragment,f),u=!1},d(f){f&&(w(e),w(o),w(l)),S(t),S(i)}}}function Tn(n){let e,r,t;return r=new lt({props:{$$slots:{default:[kn]},$$scope:{ctx:n}}}),{c(){e=P("span"),L(r.$$.fragment),x(e,"slot","right")},m(s,o){v(s,e,o),D(r,e,null),t=!0},p(s,o){const l={};o&16&&(l.$$scope={dirty:o,ctx:s}),r.$set(l)},i(s){t||(d(r.$$.fragment,s),t=!0)},o(s){$(r.$$.fragment,s),t=!1},d(s){s&&w(e),S(r)}}}function Ln(n){let e,r,t,s,o;function l(i){n[3](i)}let a={id:G,$$slots:{right:[Tn],default:[wn]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new ot({props:a}),ee.push(()=>te(e,"checked",l)),s=new Ee({props:{layers:[G],contents:Dn}}),{c(){L(e.$$.fragment),t=A(),L(s.$$.fragment)},m(i,u){D(e,i,u),v(i,t,u),D(s,i,u),o=!0},p(i,[u]){const f={};u&16&&(f.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,f.checked=i[0],ne(()=>r=!1)),e.$set(f)},i(i){o||(d(e.$$.fragment,i),d(s.$$.fragment,i),o=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&w(t),S(e,i),S(s,i)}}}let G="mrn";function Dn(n){return`<p>${n.name??"Unknown MRN road"}</p>`}function Sn(n,e,r){let t;X(n,de,a=>r(2,t=a));let s=Q.mrn;nt(t,G,`https://atip.uk/layers/v1/${G}.pmtiles`),Ot(t,{id:G,source:G,sourceLayer:G,color:s,width:7});let o=!1;function l(a){o=a,r(0,o)}return n.$$.update=()=>{n.$$.dirty&5&&t.getLayer(G)&&t.setLayoutProperty(G,"visibility",o?"visible":"none")},[o,s,t,l]}class Un extends q{constructor(e){super(),W(this,e,Sn,Ln,Y,{})}}function Mn(n){let e;return{c(){e=U("Show on map")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function Cn(n){let e;return{c(){e=U("Edit scheme locally")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function En(n){let e,r,t=n[0].authority_or_region+"",s,o,l,a,i=n[0].capital_scheme_id+"",u,f,c,_,m=n[0].funding_programme+"",g,y,k,h,p,T,E;return h=new ve({props:{$$slots:{default:[Mn]},$$scope:{ctx:n}}}),h.$on("click",n[3]),T=new ve({props:{disabled:n[1],title:n[2],$$slots:{default:[Cn]},$$scope:{ctx:n}}}),T.$on("click",n[4]),{c(){e=P("p"),r=U("Authority or region: "),s=U(t),o=A(),l=P("p"),a=U("Capital scheme ID: "),u=U(i),f=A(),c=P("p"),_=U("Funding programme: "),g=U(m),y=A(),k=P("div"),L(h.$$.fragment),p=A(),L(T.$$.fragment),x(k,"class","govuk-button-group")},m(b,C){v(b,e,C),M(e,r),M(e,s),v(b,o,C),v(b,l,C),M(l,a),M(l,u),v(b,f,C),v(b,c,C),M(c,_),M(c,g),v(b,y,C),v(b,k,C),D(h,k,null),M(k,p),D(T,k,null),E=!0},p(b,C){(!E||C&1)&&t!==(t=b[0].authority_or_region+"")&&J(s,t),(!E||C&1)&&i!==(i=b[0].capital_scheme_id+"")&&J(u,i),(!E||C&1)&&m!==(m=b[0].funding_programme+"")&&J(g,m);const z={};C&256&&(z.$$scope={dirty:C,ctx:b}),h.$set(z);const O={};C&256&&(O.$$scope={dirty:C,ctx:b}),T.$set(O)},i(b){E||(d(h.$$.fragment,b),d(T.$$.fragment,b),E=!0)},o(b){$(h.$$.fragment,b),$(T.$$.fragment,b),E=!1},d(b){b&&(w(e),w(o),w(l),w(f),w(c),w(y),w(k)),S(h),S(T)}}}function Bn(n){let e,r;return e=new Be({props:{label:`${n[0].scheme_reference}: ${n[0].num_features} features`,$$slots:{default:[En]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){D(e,t,s),r=!0},p(t,[s]){const o={};s&1&&(o.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),s&257&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function An(n,e,r){let t,s;X(n,ae,c=>r(6,t=c)),X(n,de,c=>r(7,s=c));let{scheme:o}=e,{authorityNames:l}=e,a=!l.has(o.authority_or_region),i=a?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function u(){let c={type:"FeatureCollection",features:t.features.filter(_=>_.properties.scheme_reference==o.scheme_reference)};s==null||s.fitBounds(rt(c),{padding:20,animate:!1})}function f(){let c={type:"FeatureCollection",features:t.features.filter(m=>m.properties.scheme_reference==o.scheme_reference)},_=o.authority_or_region;window.localStorage.setItem(_,JSON.stringify(c)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return n.$$set=c=>{"scheme"in c&&r(0,o=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[o,a,i,u,f,l]}class zn extends q{constructor(e){super(),W(this,e,An,Bn,Y,{scheme:0,authorityNames:5})}}function Pn(n){let e;return{c(){e=U("primary and secondary schools")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function On(n){let e;return{c(){e=U("Open Data Commons Open Database License")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function Nn(n){let e,r,t,s,o,l,a,i,u;return t=new fe({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Pn]},$$scope:{ctx:n}}}),i=new fe({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[On]},$$scope:{ctx:n}}}),{c(){e=P("p"),r=U("This shows "),L(t.$$.fragment),s=U(` from OpenStreetMap. It doesn't include kindergartens, colleges,
    universities, or other training schools.`),o=A(),l=P("p"),a=U("License: "),L(i.$$.fragment)},m(f,c){v(f,e,c),M(e,r),D(t,e,null),M(e,s),v(f,o,c),v(f,l,c),M(l,a),D(i,l,null),u=!0},p(f,c){const _={};c&1&&(_.$$scope={dirty:c,ctx:f}),t.$set(_);const m={};c&1&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||(d(t.$$.fragment,f),d(i.$$.fragment,f),u=!0)},o(f){$(t.$$.fragment,f),$(i.$$.fragment,f),u=!1},d(f){f&&(w(e),w(o),w(l)),S(t),S(i)}}}function Fn(n){let e,r;return e=new ft({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Nn]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){D(e,t,s),r=!0},p(t,[s]){const o={};s&1&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}class In extends q{constructor(e){super(),W(this,e,null,Fn,Y,{})}}var F=(n,e,r)=>new Promise((t,s)=>{var o=i=>{try{a(r.next(i))}catch(u){s(u)}},l=i=>{try{a(r.throw(i))}catch(u){s(u)}},a=i=>i.done?t(i.value):Promise.resolve(i.value).then(o,l);a((r=r.apply(n,e)).next())}),j=Uint8Array,ie=Uint16Array,jn=Int32Array,ut=new j([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ct=new j([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Vn=new j([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mt=function(n,e){for(var r=new ie(31),t=0;t<31;++t)r[t]=e+=1<<n[t-1];for(var s=new jn(r[30]),t=1;t<30;++t)for(var o=r[t];o<r[t+1];++o)s[o]=o-r[t]<<5|t;return{b:r,r:s}},pt=mt(ut,2),ht=pt.b,Zn=pt.r;ht[28]=258,Zn[258]=28;var Hn=mt(ct,0),xn=Hn.b,Ue=new ie(32768);for(B=0;B<32768;++B)K=(B&43690)>>1|(B&21845)<<1,K=(K&52428)>>2|(K&13107)<<2,K=(K&61680)>>4|(K&3855)<<4,Ue[B]=((K&65280)>>8|(K&255)<<8)>>1;var K,B,ge=function(n,e,r){for(var t=n.length,s=0,o=new ie(e);s<t;++s)n[s]&&++o[n[s]-1];var l=new ie(e);for(s=1;s<e;++s)l[s]=l[s-1]+o[s-1]<<1;var a;if(r){a=new ie(1<<e);var i=15-e;for(s=0;s<t;++s)if(n[s])for(var u=s<<4|n[s],f=e-n[s],c=l[n[s]-1]++<<f,_=c|(1<<f)-1;c<=_;++c)a[Ue[c]>>i]=u}else for(a=new ie(t),s=0;s<t;++s)n[s]&&(a[s]=Ue[l[n[s]-1]++]>>15-n[s]);return a},$e=new j(288);for(B=0;B<144;++B)$e[B]=8;var B;for(B=144;B<256;++B)$e[B]=9;var B;for(B=256;B<280;++B)$e[B]=7;var B;for(B=280;B<288;++B)$e[B]=8;var B,gt=new j(32);for(B=0;B<32;++B)gt[B]=5;var B,Rn=ge($e,9,1),Kn=ge(gt,5,1),Le=function(n){for(var e=n[0],r=1;r<n.length;++r)n[r]>e&&(e=n[r]);return e},Z=function(n,e,r){var t=e/8|0;return(n[t]|n[t+1]<<8)>>(e&7)&r},De=function(n,e){var r=e/8|0;return(n[r]|n[r+1]<<8|n[r+2]<<16)>>(e&7)},Gn=function(n){return(n+7)/8|0},Jn=function(n,e,r){(e==null||e<0)&&(e=0),(r==null||r>n.length)&&(r=n.length);var t=new j(r-e);return t.set(n.subarray(e,r)),t},qn=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],I=function(n,e,r){var t=new Error(e||qn[n]);if(t.code=n,Error.captureStackTrace&&Error.captureStackTrace(t,I),!r)throw t;return t},Ae=function(n,e,r,t){var s=n.length,o=t?t.length:0;if(!s||e.f&&!e.l)return r||new j(0);var l=!r||e.i!=2,a=e.i;r||(r=new j(s*3));var i=function(Ie){var je=r.length;if(Ie>je){var Ve=new j(Math.max(je*2,Ie));Ve.set(r),r=Ve}},u=e.f||0,f=e.p||0,c=e.b||0,_=e.l,m=e.d,g=e.m,y=e.n,k=s*8;do{if(!_){u=Z(n,f,1);var h=Z(n,f+1,3);if(f+=3,h)if(h==1)_=Rn,m=Kn,g=9,y=5;else if(h==2){var b=Z(n,f,31)+257,C=Z(n,f+10,15)+4,z=b+Z(n,f+5,31)+1;f+=14;for(var O=new j(z),R=new j(19),N=0;N<C;++N)R[Vn[N]]=Z(n,f+N*3,7);f+=C*3;for(var ze=Le(R),kt=(1<<ze)-1,Tt=ge(R,ze,1),N=0;N<z;){var Pe=Tt[Z(n,f,kt)];f+=Pe&15;var p=Pe>>4;if(p<16)O[N++]=p;else{var re=0,_e=0;for(p==16?(_e=3+Z(n,f,3),f+=2,re=O[N-1]):p==17?(_e=3+Z(n,f,7),f+=3):p==18&&(_e=11+Z(n,f,127),f+=7);_e--;)O[N++]=re}}var Oe=O.subarray(0,b),V=O.subarray(b);g=Le(Oe),y=Le(V),_=ge(Oe,g,1),m=ge(V,y,1)}else I(1);else{var p=Gn(f)+4,T=n[p-4]|n[p-3]<<8,E=p+T;if(E>s){a&&I(0);break}l&&i(c+T),r.set(n.subarray(p,E),c),e.b=c+=T,e.p=f=E*8,e.f=u;continue}if(f>k){a&&I(0);break}}l&&i(c+131072);for(var Lt=(1<<g)-1,Dt=(1<<y)-1,ye=f;;ye=f){var re=_[De(n,f)&Lt],se=re>>4;if(f+=re&15,f>k){a&&I(0);break}if(re||I(2),se<256)r[c++]=se;else if(se==256){ye=f,_=null;break}else{var Ne=se-254;if(se>264){var N=se-257,ue=ut[N];Ne=Z(n,f,(1<<ue)-1)+ht[N],f+=ue}var be=m[De(n,f)&Dt],ke=be>>4;be||I(3),f+=be&15;var V=xn[ke];if(ke>3){var ue=ct[ke];V+=De(n,f)&(1<<ue)-1,f+=ue}if(f>k){a&&I(0);break}l&&i(c+131072);var Te=c+Ne;if(c<V){var Fe=o-V,St=Math.min(V,Te);for(Fe+c<0&&I(3);c<St;++c)r[c]=t[Fe+c]}for(;c<Te;c+=4)r[c]=r[c-V],r[c+1]=r[c+1-V],r[c+2]=r[c+2-V],r[c+3]=r[c+3-V];c=Te}}e.l=_,e.p=ye,e.b=c,e.f=u,_&&(u=1,e.m=g,e.d=m,e.n=y)}while(!u);return c==r.length?r:Jn(r,0,c)},Wn=new j(0),Yn=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&I(6,"invalid gzip data");var e=n[3],r=10;e&4&&(r+=(n[10]|n[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!n[r++]);return r+(e&2)},Qn=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},Xn=function(n,e){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&I(6,"invalid zlib data"),(n[1]>>5&1)==+!e&&I(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function er(n,e){return Ae(n,{i:2},e&&e.out,e&&e.dictionary)}function tr(n,e){var r=Yn(n);return r+8>n.length&&I(6,"invalid gzip data"),Ae(n.subarray(r,-8),{i:2},e&&e.out||new j(Qn(n)),e&&e.dictionary)}function nr(n,e){return Ae(n.subarray(Xn(n,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Me(n,e){return n[0]==31&&n[1]==139&&n[2]==8?tr(n,e):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?er(n,e):nr(n,e)}var rr=typeof TextDecoder<"u"&&new TextDecoder,sr=0;try{rr.decode(Wn,{stream:!0}),sr=1}catch{}var dt=(n,e)=>n*Math.pow(2,e),ce=(n,e)=>Math.floor(n/Math.pow(2,e)),we=(n,e)=>dt(n.getUint16(e+1,!0),8)+n.getUint8(e),$t=(n,e)=>dt(n.getUint32(e+2,!0),16)+n.getUint16(e,!0),or=(n,e,r,t,s)=>{if(n!=t.getUint8(s))return n-t.getUint8(s);const o=we(t,s+1);if(e!=o)return e-o;const l=we(t,s+4);return r!=l?r-l:0},ir=(n,e,r,t)=>{const s=_t(n,e|128,r,t);return s?{z:e,x:r,y:t,offset:s[0],length:s[1],is_dir:!0}:null},Ge=(n,e,r,t)=>{const s=_t(n,e,r,t);return s?{z:e,x:r,y:t,offset:s[0],length:s[1],is_dir:!1}:null},_t=(n,e,r,t)=>{let s=0,o=n.byteLength/17-1;for(;s<=o;){const l=o+s>>1,a=or(e,r,t,n,l*17);if(a>0)s=l+1;else if(a<0)o=l-1;else return[$t(n,l*17+7),n.getUint32(l*17+13,!0)]}return null},lr=(n,e)=>n.is_dir&&!e.is_dir?1:!n.is_dir&&e.is_dir?-1:n.z!==e.z?n.z-e.z:n.x!==e.x?n.x-e.x:n.y-e.y,vt=(n,e)=>{const r=n.getUint8(e*17);return{z:r&127,x:we(n,e*17+1),y:we(n,e*17+4),offset:$t(n,e*17+7),length:n.getUint32(e*17+13,!0),is_dir:r>>7===1}},Je=n=>{const e=[],r=new DataView(n);for(let t=0;t<r.byteLength/17;t++)e.push(vt(r,t));return ar(e)},ar=n=>{n.sort(lr);const e=new ArrayBuffer(17*n.length),r=new Uint8Array(e);for(let t=0;t<n.length;t++){const s=n[t];let o=s.z;s.is_dir&&(o=o|128),r[t*17]=o,r[t*17+1]=s.x&255,r[t*17+2]=s.x>>8&255,r[t*17+3]=s.x>>16&255,r[t*17+4]=s.y&255,r[t*17+5]=s.y>>8&255,r[t*17+6]=s.y>>16&255,r[t*17+7]=s.offset&255,r[t*17+8]=ce(s.offset,8)&255,r[t*17+9]=ce(s.offset,16)&255,r[t*17+10]=ce(s.offset,24)&255,r[t*17+11]=ce(s.offset,32)&255,r[t*17+12]=ce(s.offset,48)&255,r[t*17+13]=s.length&255,r[t*17+14]=s.length>>8&255,r[t*17+15]=s.length>>16&255,r[t*17+16]=s.length>>24&255}return e},fr=(n,e)=>{if(n.byteLength<17)return null;const r=n.byteLength/17,t=vt(n,r-1);if(t.is_dir){const s=t.z,o=e.z-s,l=Math.trunc(e.x/(1<<o)),a=Math.trunc(e.y/(1<<o));return{z:s,x:l,y:a}}return null};function ur(n){return F(this,null,function*(){const e=yield n.getBytes(0,512e3),r=new DataView(e.data),t=r.getUint32(4,!0),s=r.getUint16(8,!0),o=new TextDecoder("utf-8"),l=JSON.parse(o.decode(new DataView(e.data,10,t)));let a=0;l.compression==="gzip"&&(a=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let u=0;"maxzoom"in l&&(u=+l.maxzoom);let f=0,c=0,_=0,m=-180,g=-85,y=180,k=85;if(l.bounds){const p=l.bounds.split(",");m=+p[0],g=+p[1],y=+p[2],k=+p[3]}if(l.center){const p=l.center.split(",");f=+p[0],c=+p[1],_=+p[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:a,tileType:1,minZoom:i,maxZoom:u,minLon:m,minLat:g,maxLon:y,maxLat:k,centerZoom:_,centerLon:f,centerLat:c,etag:e.etag}})}function cr(n,e,r,t,s,o,l){return F(this,null,function*(){let a=yield r.getArrayBuffer(e,n.rootDirectoryOffset,n.rootDirectoryLength,n);n.specVersion===1&&(a=Je(a));const i=Ge(new DataView(a),t,s,o);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const _=new DataView(c);return _.getUint8(0)==31&&_.getUint8(1)==139&&(c=Me(new Uint8Array(c))),{data:c}}const u=fr(new DataView(a),{z:t,x:s,y:o});if(u){const f=ir(new DataView(a),u.z,u.x,u.y);if(f){let c=yield r.getArrayBuffer(e,f.offset,f.length,n);n.specVersion===1&&(c=Je(c));const _=Ge(new DataView(c),t,s,o);if(_){let g=(yield e.getBytes(_.offset,_.length,l)).data;const y=new DataView(g);return y.getUint8(0)==31&&y.getUint8(1)==139&&(g=Me(new Uint8Array(g))),{data:g}}}}})}var wt={getHeader:ur,getZxy:cr},mr=class{constructor(){this.tile=(n,e)=>{if(n.type=="json"){const r=n.url.substr(10);let t=this.tiles.get(r);return t||(t=new qe(r),this.tiles.set(r,t)),t.getHeader().then(s=>{const o={tiles:[n.url+"/{z}/{x}/{y}"],minzoom:s.minZoom,maxzoom:s.maxZoom,bounds:[s.minLon,s.minLat,s.maxLon,s.maxLat]};e(null,o,null,null)}).catch(s=>{e(s,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=n.url.match(r);if(!t)throw new Error("Invalid PMTiles protocol URL");const s=t[1];let o=this.tiles.get(s);o||(o=new qe(s),this.tiles.set(s,o));const l=t[2],a=t[3],i=t[4],u=new AbortController,f=u.signal;let c=()=>{u.abort()};return o.getHeader().then(_=>{o.getZxy(+l,+a,+i,f).then(m=>{m?e(null,new Uint8Array(m.data),m.cacheControl,m.expires):_.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(m=>{m.name!=="AbortError"&&e(m,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(n){this.tiles.set(n.source.getKey(),n)}get(n){return this.tiles.get(n)}};function oe(n,e){return(e>>>0)*4294967296+(n>>>0)}function pr(n,e){const r=e.buf;let t,s;if(s=r[e.pos++],t=(s&112)>>4,s<128||(s=r[e.pos++],t|=(s&127)<<3,s<128)||(s=r[e.pos++],t|=(s&127)<<10,s<128)||(s=r[e.pos++],t|=(s&127)<<17,s<128)||(s=r[e.pos++],t|=(s&127)<<24,s<128)||(s=r[e.pos++],t|=(s&1)<<31,s<128))return oe(n,t);throw new Error("Expected varint not more than 10 bytes")}function me(n){const e=n.buf;let r,t;return t=e[n.pos++],r=t&127,t<128||(t=e[n.pos++],r|=(t&127)<<7,t<128)||(t=e[n.pos++],r|=(t&127)<<14,t<128)||(t=e[n.pos++],r|=(t&127)<<21,t<128)?r:(t=e[n.pos],r|=(t&15)<<28,pr(r,n))}function hr(n,e,r,t){if(t==0){r==1&&(e[0]=n-1-e[0],e[1]=n-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}var gr=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function dr(n,e,r){if(n>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,n)-1||r>Math.pow(2,n)-1)throw Error("tile x/y outside zoom level bounds");const t=gr[n],s=Math.pow(2,n);let o=0,l=0,a=0;const i=[e,r];let u=s/2;for(;u>0;)o=(i[0]&u)>0?1:0,l=(i[1]&u)>0?1:0,a+=u*u*(3*o^l),hr(u,i,o,l),u=u/2;return t+a}function yt(n,e){return F(this,null,function*(){if(e===1||e===0)return n;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Me(new Uint8Array(n));{let t=new Response(n).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var $r=127;function _r(n,e){let r=0,t=n.length-1;for(;r<=t;){const s=t+r>>1,o=e-n[s].tileId;if(o>0)r=s+1;else if(o<0)t=s-1;else return n[s]}return t>=0&&(n[t].runLength===0||e-n[t].tileId<n[t].runLength)?n[t]:null}var vr=class{constructor(n){this.url=n}getKey(){return this.url}getBytes(n,e,r){return F(this,null,function*(){let t;r||(t=new AbortController,r=t.signal);let s=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+n+"-"+(n+e-1)}});if(s.status===416&&n===0){const a=s.headers.get("Content-Range");if(!a||!a.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+a.substr(8);s=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const o=s.headers.get("Content-Length");if(s.status===200&&(!o||+o>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function H(n,e){const r=n.getUint32(e+4,!0),t=n.getUint32(e+0,!0);return r*Math.pow(2,32)+t}function wr(n,e){const r=new DataView(n),t=r.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:H(r,8),rootDirectoryLength:H(r,16),jsonMetadataOffset:H(r,24),jsonMetadataLength:H(r,32),leafDirectoryOffset:H(r,40),leafDirectoryLength:H(r,48),tileDataOffset:H(r,56),tileDataLength:H(r,64),numAddressedTiles:H(r,72),numTileEntries:H(r,80),numTileContents:H(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function bt(n){const e={buf:new Uint8Array(n),pos:0},r=me(e),t=[];let s=0;for(let o=0;o<r;o++){const l=me(e);t.push({tileId:s+l,offset:0,length:0,runLength:1}),s+=l}for(let o=0;o<r;o++)t[o].runLength=me(e);for(let o=0;o<r;o++)t[o].length=me(e);for(let o=0;o<r;o++){const l=me(e);l===0&&o>0?t[o].offset=t[o-1].offset+t[o-1].length:t[o].offset=l-1}return t}function yr(n){const e=new DataView(n);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var le=class extends Error{};function br(n,e,r,t){return F(this,null,function*(){const s=yield n.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(yr(s.data)<3)return[yield wt.getHeader(n)];const l=s.data.slice(0,$r);let a=s.etag;t&&s.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+n.getKey()),a=void 0);const i=wr(l,a);if(r){const u=s.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),f=n.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=bt(yield e(u,i.internalCompression));return[i,[f,c.length,c]]}return[i,void 0]})}function kr(n,e,r,t,s){return F(this,null,function*(){const o=yield n.getBytes(r,t);if(s.etag&&s.etag!==o.etag)throw new le(o.etag);const l=yield e(o.data,s.internalCompression),a=bt(l);if(a.length===0)throw new Error("Empty directory is invalid");return a})}var Tr=class{constructor(n=100,e=!0,r=yt){this.cache=new Map,this.maxCacheEntries=n,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(n,e){return F(this,null,function*(){const r=n.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const t=new Promise((s,o)=>{br(n,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),s(l[0]),this.prune()}).catch(l=>{o(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:t}),t})}getDirectory(n,e,r,t){return F(this,null,function*(){const s=n.getKey()+"|"+(t.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((l,a)=>{kr(n,this.decompress,e,r,t).then(i=>{l(i),this.prune()}).catch(i=>{a(i)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(n,e,r,t){return F(this,null,function*(){const s=n.getKey()+"|"+(t.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((l,a)=>{n.getBytes(e,r).then(i=>{if(t.etag&&t.etag!==i.etag)throw new le(i.etag);l(i.data),this.cache.has(s),this.prune()}).catch(i=>{a(i)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let n=1/0,e;this.cache.forEach((r,t)=>{r.lastUsed<n&&(n=r.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(n,e){return F(this,null,function*(){this.cache.delete(n.getKey()),yield this.getHeader(n,e)})}},qe=class{constructor(n,e,r){typeof n=="string"?this.source=new vr(n):this.source=n,r?this.decompress=r:this.decompress=yt,e?this.cache=e:this.cache=new Tr}getHeader(){return F(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(n,e,r,t){return F(this,null,function*(){const s=dr(n,e,r),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return wt.getZxy(o,this.source,this.cache,n,e,r,t);if(n<o.minZoom||n>o.maxZoom)return;let l=o.rootDirectoryOffset,a=o.rootDirectoryLength;for(let i=0;i<=3;i++){const u=yield this.cache.getDirectory(this.source,l,a,o),f=_r(u,s);if(f)if(f.runLength>0){const c=yield this.source.getBytes(o.tileDataOffset+f.offset,f.length,t);if(o.etag&&o.etag!==c.etag)throw new le(c.etag);return{data:yield this.decompress(c.data,o.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=o.leafDirectoryOffset+f.offset,a=f.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(n,e,r,t){return F(this,null,function*(){try{return yield this.getZxyAttempt(n,e,r,t)}catch(s){if(s instanceof le)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(n,e,r,t);throw s}})}getMetadataAttempt(){return F(this,null,function*(){const n=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(n.jsonMetadataOffset,n.jsonMetadataLength);if(n.etag&&n.etag!==e.etag)throw new le(e.etag);const r=yield this.decompress(e.data,n.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(r))})}getMetadata(){return F(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(n){if(n instanceof le)return this.cache.invalidate(this.source,n.message),yield this.getMetadataAttempt();throw n}})}};function Lr(n){return Ce(()=>{let e=new mr;He.addProtocol("pmtiles",e.tile)}),st(()=>{He.removeProtocol("pmtiles")}),[]}class Dr extends q{constructor(e){super(),W(this,e,Lr,null,Y,{})}}function We(n,e,r){const t=n.slice();return t[15]=e[r],t}function Sr(n){let e;return{c(){e=U("Home")},m(r,t){v(r,e,t)},d(r){r&&w(e)}}}function Ye(n){let e,r;return e=new Ht({props:{errorMessage:n[1]}}),{c(){L(e.$$.fragment)},m(t,s){D(e,t,s),r=!0},p(t,s){const o={};s&2&&(o.errorMessage=t[1]),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function Qe(n){let e,r,t,s;function o(i){n[10](i)}function l(i){n[11](i)}let a={schemes:n[2]};return n[3]!==void 0&&(a.schemesToBeShown=n[3]),n[4]!==void 0&&(a.filterText=n[4]),e=new on({props:a}),ee.push(()=>te(e,"schemesToBeShown",o)),ee.push(()=>te(e,"filterText",l)),{c(){L(e.$$.fragment)},m(i,u){D(e,i,u),s=!0},p(i,u){const f={};u&4&&(f.schemes=i[2]),!r&&u&8&&(r=!0,f.schemesToBeShown=i[3],ne(()=>r=!1)),!t&&u&16&&(t=!0,f.filterText=i[4],ne(()=>t=!1)),e.$set(f)},i(i){s||(d(e.$$.fragment,i),s=!0)},o(i){$(e.$$.fragment,i),s=!1},d(i){S(e,i)}}}function Xe(n){let e,r,t=Re(n[2].values()),s=[];for(let l=0;l<t.length;l+=1)s[l]=tt(We(n,t,l));const o=l=>$(s[l],1,1,()=>{s[l]=null});return{c(){e=P("ul");for(let l=0;l<s.length;l+=1)s[l].c()},m(l,a){v(l,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);r=!0},p(l,a){if(a&13){t=Re(l[2].values());let i;for(i=0;i<t.length;i+=1){const u=We(l,t,i);s[i]?(s[i].p(u,a),d(s[i],1)):(s[i]=tt(u),s[i].c(),d(s[i],1),s[i].m(e,null))}for(pe(),i=t.length;i<s.length;i+=1)o(i);he()}},i(l){if(!r){for(let a=0;a<t.length;a+=1)d(s[a]);r=!0}},o(l){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)$(s[a]);r=!1},d(l){l&&w(e),xt(s,l)}}}function et(n){let e,r;return e=new zn({props:{scheme:n[15],authorityNames:n[0]}}),{c(){L(e.$$.fragment)},m(t,s){D(e,t,s),r=!0},p(t,s){const o={};s&4&&(o.scheme=t[15]),s&1&&(o.authorityNames=t[0]),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function tt(n){let e=n[3].has(n[15].scheme_reference),r,t,s=e&&et(n);return{c(){s&&s.c(),r=Rt()},m(o,l){s&&s.m(o,l),v(o,r,l),t=!0},p(o,l){l&12&&(e=o[3].has(o[15].scheme_reference)),e?s?(s.p(o,l),l&12&&d(s,1)):(s=et(o),s.c(),d(s,1),s.m(r.parentNode,r)):s&&(pe(),$(s,1,1,()=>{s=null}),he())},i(o){t||(d(s),t=!0)},o(o){$(s),t=!1},d(o){o&&w(r),s&&s.d(o)}}}function Ur(n){let e,r,t,s,o,l,a,i,u,f,c,_,m;r=new ve({props:{$$slots:{default:[Sr]},$$scope:{ctx:n}}}),r.$on("click",n[9]),a=new Jt({props:{boundaryGeojson:n[5]}});let g=n[1]&&Ye(n);f=new Ft({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:n[7]}});let y=n[2].size>0&&Qe(n),k=n[0]&&Xe(n);return{c(){e=P("div"),L(r.$$.fragment),t=A(),s=P("div"),o=P("h1"),o.textContent="Browse schemes",l=A(),L(a.$$.fragment),i=A(),g&&g.c(),u=A(),L(f.$$.fragment),c=A(),y&&y.c(),_=A(),k&&k.c(),xe(s,"display","flex"),xe(s,"justify-content","space-between"),x(e,"slot","sidebar"),x(e,"class","govuk-prose")},m(h,p){v(h,e,p),D(r,e,null),M(e,t),M(e,s),M(s,o),M(s,l),D(a,s,null),M(e,i),g&&g.m(e,null),M(e,u),D(f,e,null),M(e,c),y&&y.m(e,null),M(e,_),k&&k.m(e,null),m=!0},p(h,p){const T={};p&262144&&(T.$$scope={dirty:p,ctx:h}),r.$set(T);const E={};p&32&&(E.boundaryGeojson=h[5]),a.$set(E),h[1]?g?(g.p(h,p),p&2&&d(g,1)):(g=Ye(h),g.c(),d(g,1),g.m(e,u)):g&&(pe(),$(g,1,1,()=>{g=null}),he()),h[2].size>0?y?(y.p(h,p),p&4&&d(y,1)):(y=Qe(h),y.c(),d(y,1),y.m(e,_)):y&&(pe(),$(y,1,1,()=>{y=null}),he()),h[0]?k?(k.p(h,p),p&1&&d(k,1)):(k=Xe(h),k.c(),d(k,1),k.m(e,null)):k&&(pe(),$(k,1,1,()=>{k=null}),he())},i(h){m||(d(r.$$.fragment,h),d(a.$$.fragment,h),d(g),d(f.$$.fragment,h),d(y),d(k),m=!0)},o(h){$(r.$$.fragment,h),$(a.$$.fragment,h),$(g),$(f.$$.fragment,h),$(y),$(k),m=!1},d(h){h&&w(e),S(r),S(a),g&&g.d(),S(f),y&&y.d(),k&&k.d()}}}function Mr(n){let e,r,t,s,o,l;return e=new In({}),t=new dn({}),o=new Un({}),{c(){L(e.$$.fragment),r=A(),L(t.$$.fragment),s=A(),L(o.$$.fragment)},m(a,i){D(e,a,i),v(a,r,i),D(t,a,i),v(a,s,i),D(o,a,i),l=!0},i(a){l||(d(e.$$.fragment,a),d(t.$$.fragment,a),d(o.$$.fragment,a),l=!0)},o(a){$(e.$$.fragment,a),$(t.$$.fragment,a),$(o.$$.fragment,a),l=!1},d(a){a&&(w(r),w(s)),S(e,a),S(t,a),S(o,a)}}}function Cr(n){let e,r,t,s,o,l,a,i;return e=new vn({}),o=new Yt({props:{small:!0,$$slots:{default:[Mr]},$$scope:{ctx:n}}}),a=new Qt({props:{style:n[6]}}),{c(){L(e.$$.fragment),r=A(),t=P("hr"),s=A(),L(o.$$.fragment),l=A(),L(a.$$.fragment)},m(u,f){D(e,u,f),v(u,r,f),v(u,t,f),v(u,s,f),D(o,u,f),v(u,l,f),D(a,u,f),i=!0},p(u,f){const c={};f&262144&&(c.$$scope={dirty:f,ctx:u}),o.$set(c)},i(u){i||(d(e.$$.fragment,u),d(o.$$.fragment,u),d(a.$$.fragment,u),i=!0)},o(u){$(e.$$.fragment,u),$(o.$$.fragment,u),$(a.$$.fragment,u),i=!1},d(u){u&&(w(r),w(t),w(s),w(l)),S(e,u),S(o,u),S(a,u)}}}function Er(n){let e,r,t,s,o,l,a;return e=new Wt({props:{colorInterventions:at("v1")}}),t=new Ee({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:n[8]}}),l=new Be({props:{label:"Layers",open:!0,$$slots:{default:[Cr]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment),r=A(),L(t.$$.fragment),s=A(),o=P("div"),L(l.$$.fragment),x(o,"class","top-right svelte-nlvvhu")},m(i,u){D(e,i,u),v(i,r,u),D(t,i,u),v(i,s,u),v(i,o,u),D(l,o,null),a=!0},p(i,u){const f={};u&262144&&(f.$$scope={dirty:u,ctx:i}),l.$set(f)},i(i){a||(d(e.$$.fragment,i),d(t.$$.fragment,i),d(l.$$.fragment,i),a=!0)},o(i){$(e.$$.fragment,i),$(t.$$.fragment,i),$(l.$$.fragment,i),a=!1},d(i){i&&(w(r),w(s),w(o)),S(e,i),S(t,i),S(l)}}}function Br(n){let e,r,t,s,o;return r=new Dr({}),s=new qt({props:{style:n[6],$$slots:{default:[Er]},$$scope:{ctx:n}}}),{c(){e=P("div"),L(r.$$.fragment),t=A(),L(s.$$.fragment),x(e,"slot","main")},m(l,a){v(l,e,a),D(r,e,null),M(e,t),D(s,e,null),o=!0},p(l,a){const i={};a&262144&&(i.$$scope={dirty:a,ctx:l}),s.$set(i)},i(l){o||(d(r.$$.fragment,l),d(s.$$.fragment,l),o=!0)},o(l){$(r.$$.fragment,l),$(s.$$.fragment,l),o=!1},d(l){l&&w(e),S(r),S(s)}}}function Ar(n){let e,r;return e=new Gt({props:{$$slots:{main:[Br],sidebar:[Ur]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){D(e,t,s),r=!0},p(t,[s]){const o={};s&262207&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){S(e,t)}}}function zr(n,e,r){let t,s;X(n,de,p=>r(12,t=p)),X(n,ae,p=>r(5,s=p));let o=null;Ce(async()=>{It();let p=await jt();r(0,o=new Set(p.features.map(T=>T.properties.name)))});let a=new URLSearchParams(window.location.search).get("style")||"dataviz",i="",u=new Map,f=new Set,c="";st(()=>{ae.set(Vt())});function _(p){try{let T=JSON.parse(p);r(2,u=Xt(T)),ae.set(T),r(1,i=""),t==null||t.fitBounds(rt(T),{padding:20,animate:!1})}catch(T){r(1,i=`Couldn't load schemes from a file: ${T}`)}}function m(p){var T='<div style="max-width: 30vw;">';return T+=`<h2>${g(p.name)} (${p.intervention_type})</h2>`,T+=`<p>Scheme reference: ${p.scheme_reference}</p>`,p.length_meters&&(T+=`<p>Length: ${Zt(p.length_meters)}</p>`),p.description&&(T+=`<p>${g(p.description)}</p>`),T+="</div>",T}function g(p){return c?p.replace(new RegExp(c,"gi"),T=>`<mark>${T}</mark>`):p}const y=()=>window.open("index.html");function k(p){f=p,r(3,f)}function h(p){c=p,r(4,c)}return[o,i,u,f,c,s,a,_,m,y,k,h]}class Pr extends q{constructor(e){super(),W(this,e,zr,Ar,Y,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Pr({target:document.getElementById("app")});
