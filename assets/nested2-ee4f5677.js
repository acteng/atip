import{S as q,i as J,s as G,g as T,f as A,e as j,u as z,m as U,j as k,k as E,x as R,t as b,l as S,p as M,q as D,W as ne,$ as re,r as Te,b as he,c as me,F as yt,o as ge,a as pe,h as x,v as Ne,w as wt,X as Ue,aV as bt,_ as St,P as Qe,B as Xe,aW as Ve,ad as Ye,d as Lt,O as Ie,R as je,y as ue,n as ce,Q as Tt,z as Ut,a6 as Dt,aN as kt,E as Mt,aa as Et}from"./stores-a3f37a6d.js";import{C as De,S as Ze,d as Bt,M as et,g as Ct,L as zt,Z as At,e as Ot,I as Pt,f as Nt,B as Vt,b as It}from"./Map-f88f4992.js";function jt(t){let e=new Map;for(let[r,n]of Object.entries(t.schemes))e.set(r,{scheme_reference:r,num_features:0,authority_or_region:n.authority_or_region,capital_scheme_id:n.capital_scheme_id,funding_programme:n.funding_programme});for(let r of t.features)e.get(r.properties.scheme_reference).num_features++,delete r.properties.id,delete r.properties.authority_or_region,delete r.properties.capital_scheme_id,delete r.properties.funding_programme,delete r.properties.valid,delete r.properties.centroid_lon,delete r.properties.centroid_lat;return e}function Zt(t){let e;return{c(){e=z("Clear")},m(r,n){k(r,e,n)},d(r){r&&M(e)}}}function Ht(t){let e,r,n,s,o,i;return n=new pe({props:{$$slots:{default:[Zt]},$$scope:{ctx:t}}}),n.$on("click",t[11]),{c(){e=j("input"),r=A(),T(n.$$.fragment),x(e,"type","text"),x(e,"class","govuk-input govuk-input--width-10"),x(e,"id","filterText")},m(l,a){k(l,e,a),Ne(e,t[1]),k(l,r,a),U(n,l,a),s=!0,o||(i=wt(e,"input",t[10]),o=!0)},p(l,a){a&2&&e.value!==l[1]&&Ne(e,l[1]);const c={};a&16384&&(c.$$scope={dirty:a,ctx:l}),n.$set(c)},i(l){s||(b(n.$$.fragment,l),s=!0)},o(l){S(n.$$.fragment,l),s=!1},d(l){l&&(M(e),M(r)),D(n,l),o=!1,i()}}}function Ft(t){let e,r,n,s,o,i,l,a;function c(m){t[8](m)}let f={label:"Authority or region",id:"filterAuthority",choices:t[4],emptyOption:!0};t[2]!==void 0&&(f.value=t[2]),e=new Ze({props:f}),he.push(()=>me(e,"value",c));function u(m){t[9](m)}let p={label:"Funding programme",id:"filterFundingProgramme",choices:t[5],emptyOption:!0};return t[3]!==void 0&&(p.value=t[3]),s=new Ze({props:p}),he.push(()=>me(s,"value",u)),l=new yt({props:{label:"Any field",id:"filterText",$$slots:{default:[Ht]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment),n=A(),T(s.$$.fragment),i=A(),T(l.$$.fragment)},m(m,d){U(e,m,d),k(m,n,d),U(s,m,d),k(m,i,d),U(l,m,d),a=!0},p(m,d){const _={};d&16&&(_.choices=m[4]),!r&&d&4&&(r=!0,_.value=m[2],ge(()=>r=!1)),e.$set(_);const w={};d&32&&(w.choices=m[5]),!o&&d&8&&(o=!0,w.value=m[3],ge(()=>o=!1)),s.$set(w);const y={};d&16386&&(y.$$scope={dirty:d,ctx:m}),l.$set(y)},i(m){a||(b(e.$$.fragment,m),b(s.$$.fragment,m),b(l.$$.fragment,m),a=!0)},o(m){S(e.$$.fragment,m),S(s.$$.fragment,m),S(l.$$.fragment,m),a=!1},d(m){m&&(M(n),M(i)),D(e,m),D(s,m),D(l,m)}}}function Kt(t){let e,r,n,s,o=t[0].size+"",i,l,a=t[6].route+"",c,f,u=t[6].area+"",p,m,d=t[6].crossing+"",_,w,y=t[6].other+"",$,B,g;return e=new De({props:{label:"Filters",$$slots:{default:[Ft]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment),r=A(),n=j("p"),s=z("Showing "),i=z(o),l=z(" schemes ("),c=z(a),f=z(" routes, "),p=z(u),m=z(` areas,
  `),_=z(d),w=z(" crossings, "),$=z(y),B=z(" other)")},m(h,v){U(e,h,v),k(h,r,v),k(h,n,v),E(n,s),E(n,i),E(n,l),E(n,c),E(n,f),E(n,p),E(n,m),E(n,_),E(n,w),E(n,$),E(n,B),g=!0},p(h,[v]){const O={};v&16446&&(O.$$scope={dirty:v,ctx:h}),e.$set(O),(!g||v&1)&&o!==(o=h[0].size+"")&&R(i,o),(!g||v&64)&&a!==(a=h[6].route+"")&&R(c,a),(!g||v&64)&&u!==(u=h[6].area+"")&&R(p,u),(!g||v&64)&&d!==(d=h[6].crossing+"")&&R(_,d),(!g||v&64)&&y!==(y=h[6].other+"")&&R($,y)},i(h){g||(b(e.$$.fragment,h),g=!0)},o(h){S(e.$$.fragment,h),g=!1},d(h){h&&(M(r),M(n)),D(e,h)}}}function Rt(t,e,r){let n;ne(t,re,y=>r(12,n=y));let{schemes:s}=e,{schemesToBeShown:o=new Set}=e,i="",l=[],a="",c=[],f="",u={area:0,route:0,crossing:0,other:0};Te(()=>{let y=new Set,$=new Set;for(let B of s.values())B.authority_or_region&&y.add(B.authority_or_region),B.funding_programme&&$.add(B.funding_programme);r(4,l=Array.from(y.entries())),l.sort(),r(5,c=Array.from($.entries())),c.sort()});function p(y,$,B){let g=y.toLowerCase(),h=v=>{if(g&&!JSON.stringify(v.properties).toLowerCase().includes(g))return!1;if($||B){let O=s.get(v.properties.scheme_reference);if($&&O.authority_or_region!=$||B&&O.funding_programme!=B)return!1}return!0};r(0,o=new Set(n.features.filter(h).map(v=>v.properties.scheme_reference))),r(6,u={area:0,route:0,crossing:0,other:0}),re.update(v=>{for(let O of v.features)o.has(O.properties.scheme_reference)?(delete O.properties.hide_while_editing,r(6,u[O.properties.intervention_type]++,u)):O.properties.hide_while_editing=!0;return v}),r(6,u)}function m(y){a=y,r(2,a)}function d(y){f=y,r(3,f)}function _(){i=this.value,r(1,i)}const w=()=>r(1,i="");return t.$$set=y=>{"schemes"in y&&r(7,s=y.schemes),"schemesToBeShown"in y&&r(0,o=y.schemesToBeShown)},t.$$.update=()=>{t.$$.dirty&14&&p(i,a,f)},[o,i,a,f,l,c,u,s,m,d,_,w]}class xt extends q{constructor(e){super(),J(this,e,Rt,Kt,G,{schemes:7,schemesToBeShown:0})}}function qt(t){let e,r,n,s;return e=new Ct({props:{color:t[2]}}),{c(){T(e.$$.fragment),r=A(),n=z(t[1])},m(o,i){U(e,o,i),k(o,r,i),k(o,n,i),s=!0},p(o,i){const l={};i&4&&(l.color=o[2]),e.$set(l),(!s||i&2)&&R(n,o[1])},i(o){s||(b(e.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),s=!1},d(o){o&&(M(r),M(n)),D(e,o)}}}function Jt(t){let e,r,n,s,o;function i(a){t[8](a)}let l={id:t[0],hint:t[3],$$slots:{default:[qt]},$$scope:{ctx:t}};return t[4]!==void 0&&(l.checked=t[4]),e=new Bt({props:l}),he.push(()=>me(e,"checked",i)),s=new et({props:{layers:[t[0]],contents:t[5]}}),{c(){T(e.$$.fragment),n=A(),T(s.$$.fragment)},m(a,c){U(e,a,c),k(a,n,c),U(s,a,c),o=!0},p(a,[c]){const f={};c&1&&(f.id=a[0]),c&8&&(f.hint=a[3]),c&518&&(f.$$scope={dirty:c,ctx:a}),!r&&c&16&&(r=!0,f.checked=a[4],ge(()=>r=!1)),e.$set(f);const u={};c&1&&(u.layers=[a[0]]),s.$set(u)},i(a){o||(b(e.$$.fragment,a),b(s.$$.fragment,a),o=!0)},o(a){S(e.$$.fragment,a),S(s.$$.fragment,a),o=!1},d(a){a&&M(n),D(e,a),D(s,a)}}}function Gt(t,e,r){let n;ne(t,Ue,p=>r(7,n=p));let{name:s}=e,{singularNoun:o}=e,{pluralNoun:i}=e,{color:l}=e,{hint:a}=e;bt(n,s,`https://atip.uk/layers/v1/${s}.pmtiles`),St(n,{id:s,source:s,sourceLayer:s,color:l,opacity:.8});let c=!0;function f(p){return`<div class="govuk-prose"><p>${p.name??`Unnamed ${o}`}</p></div>`}function u(p){c=p,r(4,c)}return t.$$set=p=>{"name"in p&&r(0,s=p.name),"singularNoun"in p&&r(6,o=p.singularNoun),"pluralNoun"in p&&r(1,i=p.pluralNoun),"color"in p&&r(2,l=p.color),"hint"in p&&r(3,a=p.hint)},t.$$.update=()=>{t.$$.dirty&145&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",c?"visible":"none")},[s,i,l,a,c,f,o,n,u]}class tt extends q{constructor(e){super(),J(this,e,Gt,Jt,G,{name:0,singularNoun:6,pluralNoun:1,color:2,hint:3})}}function Wt(t){let e,r;return e=new tt({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",color:"blue",hint:"Hospital data from OpenStreetMap. Doesn't include outpatient clinics or individual doctor's offices."}}),{c(){T(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p:Qe,i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}class Qt extends q{constructor(e){super(),J(this,e,null,Wt,G,{})}}function Xt(t){let e;return{c(){e=z("Show on map")},m(r,n){k(r,e,n)},d(r){r&&M(e)}}}function Yt(t){let e;return{c(){e=z("Edit scheme")},m(r,n){k(r,e,n)},d(r){r&&M(e)}}}function er(t){let e,r,n=t[0].authority_or_region+"",s,o,i,l,a=t[0].capital_scheme_id+"",c,f,u,p,m=t[0].funding_programme+"",d,_,w,y,$,B,g;return y=new pe({props:{$$slots:{default:[Xt]},$$scope:{ctx:t}}}),y.$on("click",t[1]),B=new pe({props:{$$slots:{default:[Yt]},$$scope:{ctx:t}}}),B.$on("click",t[2]),{c(){e=j("p"),r=z("Authority or region: "),s=z(n),o=A(),i=j("p"),l=z("Capital scheme ID: "),c=z(a),f=A(),u=j("p"),p=z("Funding programme: "),d=z(m),_=A(),w=j("div"),T(y.$$.fragment),$=A(),T(B.$$.fragment),x(w,"class","govuk-button-group")},m(h,v){k(h,e,v),E(e,r),E(e,s),k(h,o,v),k(h,i,v),E(i,l),E(i,c),k(h,f,v),k(h,u,v),E(u,p),E(u,d),k(h,_,v),k(h,w,v),U(y,w,null),E(w,$),U(B,w,null),g=!0},p(h,v){(!g||v&1)&&n!==(n=h[0].authority_or_region+"")&&R(s,n),(!g||v&1)&&a!==(a=h[0].capital_scheme_id+"")&&R(c,a),(!g||v&1)&&m!==(m=h[0].funding_programme+"")&&R(d,m);const O={};v&32&&(O.$$scope={dirty:v,ctx:h}),y.$set(O);const C={};v&32&&(C.$$scope={dirty:v,ctx:h}),B.$set(C)},i(h){g||(b(y.$$.fragment,h),b(B.$$.fragment,h),g=!0)},o(h){S(y.$$.fragment,h),S(B.$$.fragment,h),g=!1},d(h){h&&(M(e),M(o),M(i),M(f),M(u),M(_),M(w)),D(y),D(B)}}}function tr(t){let e,r;return e=new De({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[er]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,[s]){const o={};s&1&&(o.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),s&33&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}function rr(t,e,r){let n,s;ne(t,re,a=>r(3,n=a)),ne(t,Ue,a=>r(4,s=a));let{scheme:o}=e;function i(){let a={type:"FeatureCollection",features:n.features.filter(c=>c.properties.scheme_reference==o.scheme_reference)};s==null||s.fitBounds(Xe(a),{padding:20,animate:!1})}function l(){let a={type:"FeatureCollection",features:n.features.filter(f=>f.properties.scheme_reference==o.scheme_reference)},c=o.authority_or_region;window.localStorage.setItem(c,JSON.stringify(a)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return t.$$set=a=>{"scheme"in a&&r(0,o=a.scheme)},[o,i,l]}class nr extends q{constructor(e){super(),J(this,e,rr,tr,G,{scheme:0})}}function sr(t){let e,r;return e=new tt({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",color:"red",hint:"Primary and secondary schools, from OpenStreetMap."}}),{c(){T(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p:Qe,i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}class or extends q{constructor(e){super(),J(this,e,null,sr,G,{})}}var P=(t,e,r)=>new Promise((n,s)=>{var o=a=>{try{l(r.next(a))}catch(c){s(c)}},i=a=>{try{l(r.throw(a))}catch(c){s(c)}},l=a=>a.done?n(a.value):Promise.resolve(a.value).then(o,i);l((r=r.apply(t,e)).next())}),V=Uint8Array,ee=Uint16Array,ir=Int32Array,rt=new V([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nt=new V([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ar=new V([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),st=function(t,e){for(var r=new ee(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new ir(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)s[o]=o-r[n]<<5|n;return{b:r,r:s}},ot=st(rt,2),it=ot.b,lr=ot.r;it[28]=258,lr[258]=28;var fr=st(nt,0),ur=fr.b,Se=new ee(32768);for(L=0;L<32768;++L)K=(L&43690)>>1|(L&21845)<<1,K=(K&52428)>>2|(K&13107)<<2,K=(K&61680)>>4|(K&3855)<<4,Se[L]=((K&65280)>>8|(K&255)<<8)>>1;var K,L,ae=function(t,e,r){for(var n=t.length,s=0,o=new ee(e);s<n;++s)t[s]&&++o[t[s]-1];var i=new ee(e);for(s=1;s<e;++s)i[s]=i[s-1]+o[s-1]<<1;var l;if(r){l=new ee(1<<e);var a=15-e;for(s=0;s<n;++s)if(t[s])for(var c=s<<4|t[s],f=e-t[s],u=i[t[s]-1]++<<f,p=u|(1<<f)-1;u<=p;++u)l[Se[u]>>a]=c}else for(l=new ee(n),s=0;s<n;++s)t[s]&&(l[s]=Se[i[t[s]-1]++]>>15-t[s]);return l},le=new V(288);for(L=0;L<144;++L)le[L]=8;var L;for(L=144;L<256;++L)le[L]=9;var L;for(L=256;L<280;++L)le[L]=7;var L;for(L=280;L<288;++L)le[L]=8;var L,at=new V(32);for(L=0;L<32;++L)at[L]=5;var L,cr=ae(le,9,1),hr=ae(at,5,1),we=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},H=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},be=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},mr=function(t){return(t+7)/8|0},gr=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new V(r-e);return n.set(t.subarray(e,r)),n},pr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],N=function(t,e,r){var n=new Error(e||pr[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,N),!r)throw n;return n},ke=function(t,e,r,n){var s=t.length,o=n?n.length:0;if(!s||e.f&&!e.l)return r||new V(0);var i=!r||e.i!=2,l=e.i;r||(r=new V(s*3));var a=function(Ae){var Oe=r.length;if(Ae>Oe){var Pe=new V(Math.max(Oe*2,Ae));Pe.set(r),r=Pe}},c=e.f||0,f=e.p||0,u=e.b||0,p=e.l,m=e.d,d=e.m,_=e.n,w=s*8;do{if(!p){c=H(t,f,1);var y=H(t,f+1,3);if(f+=3,y)if(y==1)p=cr,m=hr,d=9,_=5;else if(y==2){var h=H(t,f,31)+257,v=H(t,f+10,15)+4,O=h+H(t,f+5,31)+1;f+=14;for(var C=new V(O),W=new V(19),I=0;I<v;++I)W[ar[I]]=H(t,f+I*3,7);f+=v*3;for(var Me=we(W),pt=(1<<Me)-1,dt=ae(W,Me,1),I=0;I<O;){var Ee=dt[H(t,f,pt)];f+=Ee&15;var $=Ee>>4;if($<16)C[I++]=$;else{var Q=0,fe=0;for($==16?(fe=3+H(t,f,3),f+=2,Q=C[I-1]):$==17?(fe=3+H(t,f,7),f+=3):$==18&&(fe=11+H(t,f,127),f+=7);fe--;)C[I++]=Q}}var Be=C.subarray(0,h),Z=C.subarray(h);d=we(Be),_=we(Z),p=ae(Be,d,1),m=ae(Z,_,1)}else N(1);else{var $=mr(f)+4,B=t[$-4]|t[$-3]<<8,g=$+B;if(g>s){l&&N(0);break}i&&a(u+B),r.set(t.subarray($,g),u),e.b=u+=B,e.p=f=g*8,e.f=c;continue}if(f>w){l&&N(0);break}}i&&a(u+131072);for(var _t=(1<<d)-1,$t=(1<<_)-1,_e=f;;_e=f){var Q=p[be(t,f)&_t],X=Q>>4;if(f+=Q&15,f>w){l&&N(0);break}if(Q||N(2),X<256)r[u++]=X;else if(X==256){_e=f,p=null;break}else{var Ce=X-254;if(X>264){var I=X-257,se=rt[I];Ce=H(t,f,(1<<se)-1)+it[I],f+=se}var $e=m[be(t,f)&$t],ve=$e>>4;$e||N(3),f+=$e&15;var Z=ur[ve];if(ve>3){var se=nt[ve];Z+=be(t,f)&(1<<se)-1,f+=se}if(f>w){l&&N(0);break}i&&a(u+131072);var ye=u+Ce;if(u<Z){var ze=o-Z,vt=Math.min(Z,ye);for(ze+u<0&&N(3);u<vt;++u)r[u]=n[ze+u]}for(;u<ye;u+=4)r[u]=r[u-Z],r[u+1]=r[u+1-Z],r[u+2]=r[u+2-Z],r[u+3]=r[u+3-Z];u=ye}}e.l=p,e.p=_e,e.b=u,e.f=c,p&&(c=1,e.m=d,e.d=m,e.n=_)}while(!c);return u==r.length?r:gr(r,0,u)},dr=new V(0),_r=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&N(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},$r=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},vr=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&N(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&N(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function yr(t,e){return ke(t,{i:2},e&&e.out,e&&e.dictionary)}function wr(t,e){var r=_r(t);return r+8>t.length&&N(6,"invalid gzip data"),ke(t.subarray(r,-8),{i:2},e&&e.out||new V($r(t)),e&&e.dictionary)}function br(t,e){return ke(t.subarray(vr(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Le(t,e){return t[0]==31&&t[1]==139&&t[2]==8?wr(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?yr(t,e):br(t,e)}var Sr=typeof TextDecoder<"u"&&new TextDecoder,Lr=0;try{Sr.decode(dr,{stream:!0}),Lr=1}catch{}var lt=(t,e)=>t*Math.pow(2,e),oe=(t,e)=>Math.floor(t/Math.pow(2,e)),de=(t,e)=>lt(t.getUint16(e+1,!0),8)+t.getUint8(e),ft=(t,e)=>lt(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),Tr=(t,e,r,n,s)=>{if(t!=n.getUint8(s))return t-n.getUint8(s);const o=de(n,s+1);if(e!=o)return e-o;const i=de(n,s+4);return r!=i?r-i:0},Ur=(t,e,r,n)=>{const s=ut(t,e|128,r,n);return s?{z:e,x:r,y:n,offset:s[0],length:s[1],is_dir:!0}:null},He=(t,e,r,n)=>{const s=ut(t,e,r,n);return s?{z:e,x:r,y:n,offset:s[0],length:s[1],is_dir:!1}:null},ut=(t,e,r,n)=>{let s=0,o=t.byteLength/17-1;for(;s<=o;){const i=o+s>>1,l=Tr(e,r,n,t,i*17);if(l>0)s=i+1;else if(l<0)o=i-1;else return[ft(t,i*17+7),t.getUint32(i*17+13,!0)]}return null},Dr=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,ct=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:de(t,e*17+1),y:de(t,e*17+4),offset:ft(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Fe=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(ct(r,n));return kr(e)},kr=t=>{t.sort(Dr);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const s=t[n];let o=s.z;s.is_dir&&(o=o|128),r[n*17]=o,r[n*17+1]=s.x&255,r[n*17+2]=s.x>>8&255,r[n*17+3]=s.x>>16&255,r[n*17+4]=s.y&255,r[n*17+5]=s.y>>8&255,r[n*17+6]=s.y>>16&255,r[n*17+7]=s.offset&255,r[n*17+8]=oe(s.offset,8)&255,r[n*17+9]=oe(s.offset,16)&255,r[n*17+10]=oe(s.offset,24)&255,r[n*17+11]=oe(s.offset,32)&255,r[n*17+12]=oe(s.offset,48)&255,r[n*17+13]=s.length&255,r[n*17+14]=s.length>>8&255,r[n*17+15]=s.length>>16&255,r[n*17+16]=s.length>>24&255}return e},Mr=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=ct(t,r-1);if(n.is_dir){const s=n.z,o=e.z-s,i=Math.trunc(e.x/(1<<o)),l=Math.trunc(e.y/(1<<o));return{z:s,x:i,y:l}}return null};function Er(t){return P(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),s=r.getUint16(8,!0),o=new TextDecoder("utf-8"),i=JSON.parse(o.decode(new DataView(e.data,10,n)));let l=0;i.compression==="gzip"&&(l=2);let a=0;"minzoom"in i&&(a=+i.minzoom);let c=0;"maxzoom"in i&&(c=+i.maxzoom);let f=0,u=0,p=0,m=-180,d=-85,_=180,w=85;if(i.bounds){const $=i.bounds.split(",");m=+$[0],d=+$[1],_=+$[2],w=+$[3]}if(i.center){const $=i.center.split(",");f=+$[0],u=+$[1],p=+$[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:l,tileType:1,minZoom:a,maxZoom:c,minLon:m,minLat:d,maxLon:_,maxLat:w,centerZoom:p,centerLon:f,centerLat:u,etag:e.etag}})}function Br(t,e,r,n,s,o,i){return P(this,null,function*(){let l=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(l=Fe(l));const a=He(new DataView(l),n,s,o);if(a){let u=(yield e.getBytes(a.offset,a.length,i)).data;const p=new DataView(u);return p.getUint8(0)==31&&p.getUint8(1)==139&&(u=Le(new Uint8Array(u))),{data:u}}const c=Mr(new DataView(l),{z:n,x:s,y:o});if(c){const f=Ur(new DataView(l),c.z,c.x,c.y);if(f){let u=yield r.getArrayBuffer(e,f.offset,f.length,t);t.specVersion===1&&(u=Fe(u));const p=He(new DataView(u),n,s,o);if(p){let d=(yield e.getBytes(p.offset,p.length,i)).data;const _=new DataView(d);return _.getUint8(0)==31&&_.getUint8(1)==139&&(d=Le(new Uint8Array(d))),{data:d}}}}})}var ht={getHeader:Er,getZxy:Br},Cr=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Ke(r),this.tiles.set(r,n)),n.getHeader().then(s=>{const o={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:s.minZoom,maxzoom:s.maxZoom,bounds:[s.minLon,s.minLat,s.maxLon,s.maxLat]};e(null,o,null,null)}).catch(s=>{e(s,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const s=n[1];let o=this.tiles.get(s);o||(o=new Ke(s),this.tiles.set(s,o));const i=n[2],l=n[3],a=n[4],c=new AbortController,f=c.signal;let u=()=>{c.abort()};return o.getHeader().then(p=>{o.getZxy(+i,+l,+a,f).then(m=>{m?e(null,new Uint8Array(m.data),m.cacheControl,m.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(m=>{m.name!=="AbortError"&&e(m,null,null,null)})}),{cancel:u}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function Y(t,e){return(e>>>0)*4294967296+(t>>>0)}function zr(t,e){const r=e.buf;let n,s;if(s=r[e.pos++],n=(s&112)>>4,s<128||(s=r[e.pos++],n|=(s&127)<<3,s<128)||(s=r[e.pos++],n|=(s&127)<<10,s<128)||(s=r[e.pos++],n|=(s&127)<<17,s<128)||(s=r[e.pos++],n|=(s&127)<<24,s<128)||(s=r[e.pos++],n|=(s&1)<<31,s<128))return Y(t,n);throw new Error("Expected varint not more than 10 bytes")}function ie(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,zr(r,t))}function Ar(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}var Or=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Pr(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=Or[t],s=Math.pow(2,t);let o=0,i=0,l=0;const a=[e,r];let c=s/2;for(;c>0;)o=(a[0]&c)>0?1:0,i=(a[1]&c)>0?1:0,l+=c*c*(3*o^i),Ar(c,a,o,i),c=c/2;return n+l}function mt(t,e){return P(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Le(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Nr=127;function Vr(t,e){let r=0,n=t.length-1;for(;r<=n;){const s=n+r>>1,o=e-t[s].tileId;if(o>0)r=s+1;else if(o<0)n=s-1;else return t[s]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Ir=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return P(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let s=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(s.status===416&&t===0){const l=s.headers.get("Content-Range");if(!l||!l.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const a=+l.substr(8);s=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(a-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const o=s.headers.get("Content-Length");if(s.status===200&&(!o||+o>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function F(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function jr(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:F(r,8),rootDirectoryLength:F(r,16),jsonMetadataOffset:F(r,24),jsonMetadataLength:F(r,32),leafDirectoryOffset:F(r,40),leafDirectoryLength:F(r,48),tileDataOffset:F(r,56),tileDataLength:F(r,64),numAddressedTiles:F(r,72),numTileEntries:F(r,80),numTileContents:F(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function gt(t){const e={buf:new Uint8Array(t),pos:0},r=ie(e),n=[];let s=0;for(let o=0;o<r;o++){const i=ie(e);n.push({tileId:s+i,offset:0,length:0,runLength:1}),s+=i}for(let o=0;o<r;o++)n[o].runLength=ie(e);for(let o=0;o<r;o++)n[o].length=ie(e);for(let o=0;o<r;o++){const i=ie(e);i===0&&o>0?n[o].offset=n[o-1].offset+n[o-1].length:n[o].offset=i-1}return n}function Zr(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var te=class extends Error{};function Hr(t,e,r,n){return P(this,null,function*(){const s=yield t.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Zr(s.data)<3)return[yield ht.getHeader(t)];const i=s.data.slice(0,Nr);let l=s.etag;n&&s.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),l=void 0);const a=jr(i,l);if(r){const c=s.data.slice(a.rootDirectoryOffset,a.rootDirectoryOffset+a.rootDirectoryLength),f=t.getKey()+"|"+(a.etag||"")+"|"+a.rootDirectoryOffset+"|"+a.rootDirectoryLength,u=gt(yield e(c,a.internalCompression));return[a,[f,u.length,u]]}return[a,void 0]})}function Fr(t,e,r,n,s){return P(this,null,function*(){const o=yield t.getBytes(r,n);if(s.etag&&s.etag!==o.etag)throw new te(o.etag);const i=yield e(o.data,s.internalCompression),l=gt(i);if(l.length===0)throw new Error("Empty directory is invalid");return l})}var Kr=class{constructor(t=100,e=!0,r=mt){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return P(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((s,o)=>{Hr(t,this.decompress,this.prefetch,e).then(i=>{i[1]&&this.cache.set(i[1][0],{lastUsed:this.counter++,data:Promise.resolve(i[1][2])}),s(i[0]),this.prune()}).catch(i=>{o(i)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return P(this,null,function*(){const s=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((i,l)=>{Fr(t,this.decompress,e,r,n).then(a=>{i(a),this.prune()}).catch(a=>{l(a)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(t,e,r,n){return P(this,null,function*(){const s=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((i,l)=>{t.getBytes(e,r).then(a=>{if(n.etag&&n.etag!==a.etag)throw new te(a.etag);i(a.data),this.cache.has(s),this.prune()}).catch(a=>{l(a)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return P(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Ke=class{constructor(t,e,r){typeof t=="string"?this.source=new Ir(t):this.source=t,r?this.decompress=r:this.decompress=mt,e?this.cache=e:this.cache=new Kr}getHeader(){return P(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return P(this,null,function*(){const s=Pr(t,e,r),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return ht.getZxy(o,this.source,this.cache,t,e,r,n);if(t<o.minZoom||t>o.maxZoom)return;let i=o.rootDirectoryOffset,l=o.rootDirectoryLength;for(let a=0;a<=3;a++){const c=yield this.cache.getDirectory(this.source,i,l,o),f=Vr(c,s);if(f)if(f.runLength>0){const u=yield this.source.getBytes(o.tileDataOffset+f.offset,f.length,n);if(o.etag&&o.etag!==u.etag)throw new te(u.etag);return{data:yield this.decompress(u.data,o.tileCompression),cacheControl:u.cacheControl,expires:u.expires}}else i=o.leafDirectoryOffset+f.offset,l=f.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return P(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(s){if(s instanceof te)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(t,e,r,n);throw s}})}getMetadataAttempt(){return P(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new te(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return P(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof te)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Rr(t){return Te(()=>{let e=new Cr;Ve.addProtocol("pmtiles",e.tile)}),Ye(()=>{Ve.removeProtocol("pmtiles")}),[]}class xr extends q{constructor(e){super(),J(this,e,Rr,null,G,{})}}function Re(t,e,r){const n=t.slice();return n[11]=e[r],n}function qr(t){let e;return{c(){e=z("Home")},m(r,n){k(r,e,n)},d(r){r&&M(e)}}}function xe(t){let e,r;return e=new Mt({props:{errorMessage:t[0]}}),{c(){T(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,s){const o={};s&1&&(o.errorMessage=n[0]),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}function qe(t){let e,r,n;function s(i){t[8](i)}let o={schemes:t[1]};return t[2]!==void 0&&(o.schemesToBeShown=t[2]),e=new xt({props:o}),he.push(()=>me(e,"schemesToBeShown",s)),{c(){T(e.$$.fragment)},m(i,l){U(e,i,l),n=!0},p(i,l){const a={};l&2&&(a.schemes=i[1]),!r&&l&4&&(r=!0,a.schemesToBeShown=i[2],ge(()=>r=!1)),e.$set(a)},i(i){n||(b(e.$$.fragment,i),n=!0)},o(i){S(e.$$.fragment,i),n=!1},d(i){D(e,i)}}}function Je(t){let e,r;return e=new nr({props:{scheme:t[11]}}),{c(){T(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,s){const o={};s&2&&(o.scheme=n[11]),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}function Ge(t){let e=t[2].has(t[11].scheme_reference),r,n,s=e&&Je(t);return{c(){s&&s.c(),r=Et()},m(o,i){s&&s.m(o,i),k(o,r,i),n=!0},p(o,i){i&6&&(e=o[2].has(o[11].scheme_reference)),e?s?(s.p(o,i),i&6&&b(s,1)):(s=Je(o),s.c(),b(s,1),s.m(r.parentNode,r)):s&&(ue(),S(s,1,1,()=>{s=null}),ce())},i(o){n||(b(s),n=!0)},o(o){S(s),n=!1},d(o){o&&M(r),s&&s.d(o)}}}function Jr(t){let e,r,n,s,o,i,l,a,c,f,u,p,m,d;r=new pe({props:{$$slots:{default:[qr]},$$scope:{ctx:t}}}),r.$on("click",t[7]),l=new At({props:{boundaryGeojson:t[3]}});let _=t[0]&&xe(t);f=new Lt({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:t[5]}});let w=t[1].size>0&&qe(t),y=Ie(t[1].values()),$=[];for(let g=0;g<y.length;g+=1)$[g]=Ge(Re(t,y,g));const B=g=>S($[g],1,1,()=>{$[g]=null});return{c(){e=j("div"),T(r.$$.fragment),n=A(),s=j("div"),o=j("h1"),o.textContent="Browse schemes",i=A(),T(l.$$.fragment),a=A(),_&&_.c(),c=A(),T(f.$$.fragment),u=A(),w&&w.c(),p=A(),m=j("ul");for(let g=0;g<$.length;g+=1)$[g].c();je(s,"display","flex"),je(s,"justify-content","space-between"),x(e,"slot","sidebar"),x(e,"class","govuk-prose")},m(g,h){k(g,e,h),U(r,e,null),E(e,n),E(e,s),E(s,o),E(s,i),U(l,s,null),E(e,a),_&&_.m(e,null),E(e,c),U(f,e,null),E(e,u),w&&w.m(e,null),E(e,p),E(e,m);for(let v=0;v<$.length;v+=1)$[v]&&$[v].m(m,null);d=!0},p(g,h){const v={};h&16384&&(v.$$scope={dirty:h,ctx:g}),r.$set(v);const O={};if(h&8&&(O.boundaryGeojson=g[3]),l.$set(O),g[0]?_?(_.p(g,h),h&1&&b(_,1)):(_=xe(g),_.c(),b(_,1),_.m(e,c)):_&&(ue(),S(_,1,1,()=>{_=null}),ce()),g[1].size>0?w?(w.p(g,h),h&2&&b(w,1)):(w=qe(g),w.c(),b(w,1),w.m(e,p)):w&&(ue(),S(w,1,1,()=>{w=null}),ce()),h&6){y=Ie(g[1].values());let C;for(C=0;C<y.length;C+=1){const W=Re(g,y,C);$[C]?($[C].p(W,h),b($[C],1)):($[C]=Ge(W),$[C].c(),b($[C],1),$[C].m(m,null))}for(ue(),C=y.length;C<$.length;C+=1)B(C);ce()}},i(g){if(!d){b(r.$$.fragment,g),b(l.$$.fragment,g),b(_),b(f.$$.fragment,g),b(w);for(let h=0;h<y.length;h+=1)b($[h]);d=!0}},o(g){S(r.$$.fragment,g),S(l.$$.fragment,g),S(_),S(f.$$.fragment,g),S(w),$=$.filter(Boolean);for(let h=0;h<$.length;h+=1)S($[h]);d=!1},d(g){g&&M(e),D(r),D(l),_&&_.d(),D(f),w&&w.d(),Tt($,g)}}}function Gr(t){let e,r,n,s;return e=new or({}),n=new Qt({}),{c(){T(e.$$.fragment),r=A(),T(n.$$.fragment)},m(o,i){U(e,o,i),k(o,r,i),U(n,o,i),s=!0},i(o){s||(b(e.$$.fragment,o),b(n.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),S(n.$$.fragment,o),s=!1},d(o){o&&M(r),D(e,o),D(n,o)}}}function Wr(t){let e,r,n,s;return e=new Vt({props:{style:t[4]}}),n=new It({props:{small:!0,$$slots:{default:[Gr]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment),r=A(),T(n.$$.fragment)},m(o,i){U(e,o,i),k(o,r,i),U(n,o,i),s=!0},p(o,i){const l={};i&16384&&(l.$$scope={dirty:i,ctx:o}),n.$set(l)},i(o){s||(b(e.$$.fragment,o),b(n.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),S(n.$$.fragment,o),s=!1},d(o){o&&M(r),D(e,o),D(n,o)}}}function Qr(t){let e,r,n,s,o,i,l,a,c;return e=new Pt({props:{schema:We}}),n=new Nt({props:{schema:We}}),o=new et({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:t[6]}}),a=new De({props:{label:"Layers",open:!0,$$slots:{default:[Wr]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment),r=A(),T(n.$$.fragment),s=A(),T(o.$$.fragment),i=A(),l=j("div"),T(a.$$.fragment),x(l,"class","top-right svelte-nlvvhu")},m(f,u){U(e,f,u),k(f,r,u),U(n,f,u),k(f,s,u),U(o,f,u),k(f,i,u),k(f,l,u),U(a,l,null),c=!0},p(f,u){const p={};u&16384&&(p.$$scope={dirty:u,ctx:f}),a.$set(p)},i(f){c||(b(e.$$.fragment,f),b(n.$$.fragment,f),b(o.$$.fragment,f),b(a.$$.fragment,f),c=!0)},o(f){S(e.$$.fragment,f),S(n.$$.fragment,f),S(o.$$.fragment,f),S(a.$$.fragment,f),c=!1},d(f){f&&(M(r),M(s),M(i),M(l)),D(e,f),D(n,f),D(o,f),D(a)}}}function Xr(t){let e,r,n,s,o;return r=new xr({}),s=new Ot({props:{style:t[4],$$slots:{default:[Qr]},$$scope:{ctx:t}}}),{c(){e=j("div"),T(r.$$.fragment),n=A(),T(s.$$.fragment),x(e,"slot","main")},m(i,l){k(i,e,l),U(r,e,null),E(e,n),U(s,e,null),o=!0},p(i,l){const a={};l&16384&&(a.$$scope={dirty:l,ctx:i}),s.$set(a)},i(i){o||(b(r.$$.fragment,i),b(s.$$.fragment,i),o=!0)},o(i){S(r.$$.fragment,i),S(s.$$.fragment,i),o=!1},d(i){i&&M(e),D(r),D(s)}}}function Yr(t){let e,r;return e=new zt({props:{$$slots:{main:[Xr],sidebar:[Jr]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,[s]){const o={};s&16399&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}const We="v1";function en(t,e,r){let n,s;ne(t,Ue,d=>r(9,n=d)),ne(t,re,d=>r(3,s=d)),Te(()=>{Ut()});let i=new URLSearchParams(window.location.search).get("style")||"streets",l="",a=new Map,c=new Set;Ye(()=>{re.set(Dt())});function f(d){try{let _=JSON.parse(d);r(1,a=jt(_)),re.set(_),r(0,l=""),n==null||n.fitBounds(Xe(_),{padding:20,animate:!1})}catch(_){r(0,l=`Couldn't load schemes from a file: ${_}`)}}function u(d){var _='<div class="govuk-prose" style="max-width: 30vw;">';return _+=`<h2>${d.name} (${d.intervention_type})</h2>`,_+=`<p>Scheme reference: ${d.scheme_reference}</p>`,d.length_meters&&(_+=`<p>Length: ${kt(d.length_meters)}</p>`),d.description&&(_+=`<p>${d.description}</p>`),_}const p=()=>window.open("index.html");function m(d){c=d,r(2,c)}return[l,a,c,s,i,f,u,p,m]}class tn extends q{constructor(e){super(),J(this,e,en,Yr,G,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new tn({target:document.getElementById("app")});
