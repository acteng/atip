import{S as V,i as q,s as K,M as Vn,b as U,c as z,e as D,d as O,g as _,ax as qn,h as R,j as m,k as T,m as w,w as Ft,l as G,t as d,n as g,p as h,q as b,aJ as nn,aK as on,aL as sn,aM as ln,u as y,f as sr,x as Q,an as Kn,N as X,C as re,ap as an,T as ht,r as xt,F as fn,a as Zt,v as mr,I as Oe,aR as ae,aS as se,Y as _e,G as ce,aQ as B,az as Ge,ao as Be,aA as Pt,y as fe,o as ue,Q as qe,aT as Ve,P as ir,aU as Zn,_ as un,Z as dt,E as cn,a2 as Bt,R as pn,aV as lr,aW as hr,D as Xn,aX as dr,a5 as $n,L as Yn,z as Jn,aG as Qn}from"./index-28e71748.js";import{e as Mt,C as xe,b as Ct,d as te,a as eo,S as to,L as ro,M as no}from"./StreetViewController-5f40d743.js";import{L as oo,d as gr,c as mn,C as we,B as so,Z as io,I as lo}from"./schemas-88a26e3e.js";import{I as J}from"./InteractiveLayer-213b481a.js";import{F as ao}from"./FileInput-c1cce0b6.js";const fo="/atip/assets/help-d011708a.svg";function uo(t){let e,r;const n=t[1].default,o=nn(n,t,t[4],null);return{c(){e=D("div"),o&&o.c(),R(e,"class","govuk-prose")},m(s,l){m(s,e,l),o&&o.m(e,null),r=!0},p(s,l){o&&o.p&&(!r||l&16)&&on(o,n,s,s[4],r?ln(n,s[4],l,null):sn(s[4]),null)},i(s){r||(d(o,s),r=!0)},o(s){g(o,s),r=!1},d(s){s&&h(e),o&&o.d(s)}}}function co(t){let e,r,n,o,s,l,u,i,f;function a(p){t[3](p)}let c={title:"Help",$$slots:{default:[uo]},$$scope:{ctx:t}};return t[0]!==void 0&&(c.open=t[0]),s=new Vn({props:c}),U.push(()=>z(s,"open",a)),{c(){e=D("button"),r=D("img"),o=O(),_(s.$$.fragment),qn(r.src,n=fo)||R(r,"src",n),R(r,"title","Help"),R(r,"alt","Help"),R(e,"class","svelte-7d9d1l")},m(p,$){m(p,e,$),T(e,r),m(p,o,$),w(s,p,$),u=!0,i||(f=Ft(e,"click",t[2]),i=!0)},p(p,[$]){const v={};$&16&&(v.$$scope={dirty:$,ctx:p}),!l&&$&1&&(l=!0,v.open=p[0],G(()=>l=!1)),s.$set(v)},i(p){u||(d(s.$$.fragment,p),u=!0)},o(p){g(s.$$.fragment,p),u=!1},d(p){p&&(h(e),h(o)),b(s,p),i=!1,f()}}}function po(t,e,r){let{$$slots:n={},$$scope:o}=e,s=!1;const l=()=>r(0,s=!0);function u(i){s=i,r(0,s)}return t.$$set=i=>{"$$scope"in i&&r(4,o=i.$$scope)},[s,n,l,u,o]}class ne extends V{constructor(e){super(),q(this,e,po,co,K,{})}}function $o(t){let e;return{c(){e=D("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function mo(t){let e,r,n,o,s=t[0]=="Private (development)"&&$o();return{c(){s&&s.c(),e=O(),r=D("p"),r.textContent="Note the ATF scheme data has not been validated.",n=O(),o=D("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,u){s&&s.m(l,u),m(l,e,u),m(l,r,u),m(l,n,u),m(l,o,u)},p:Q,d(l){l&&(h(e),h(r),h(n),h(o)),s&&s.d(l)}}}function ho(t){let e,r,n,o,s,l;return s=new ne({props:{$$slots:{default:[mo]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("App version: "),n=y(t[0]),o=O(),_(s.$$.fragment)},m(u,i){m(u,e,i),T(e,r),T(e,n),T(e,o),w(s,e,null),l=!0},p(u,[i]){const f={};i&2&&(f.$$scope={dirty:i,ctx:u}),s.$set(f)},i(u){l||(d(s.$$.fragment,u),l=!0)},o(u){g(s.$$.fragment,u),l=!1},d(u){u&&h(e),b(s)}}}function go(t){return[sr()]}class _o extends V{constructor(e){super(),q(this,e,go,ho,K,{})}}const wo={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var he=Uint8Array,nt=Uint16Array,hn=Uint32Array,dn=new he([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gn=new he([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),bo=new he([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_n=function(t,e){for(var r=new nt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new hn(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},wn=_n(dn,2),bn=wn[0],vo=wn[1];bn[28]=258,vo[258]=28;var yo=_n(gn,0),ko=yo[0],Xt=new nt(32768);for(var Y=0;Y<32768;++Y){var Re=(Y&43690)>>>1|(Y&21845)<<1;Re=(Re&52428)>>>2|(Re&13107)<<2,Re=(Re&61680)>>>4|(Re&3855)<<4,Xt[Y]=((Re&65280)>>>8|(Re&255)<<8)>>>1}var vt=function(t,e,r){for(var n=t.length,o=0,s=new nt(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new nt(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var u;if(r){u=new nt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)u[Xt[c]>>>i]=f}else for(u=new nt(n),o=0;o<n;++o)t[o]&&(u[o]=Xt[l[t[o]-1]++]>>>15-t[o]);return u},Lt=new he(288);for(var Y=0;Y<144;++Y)Lt[Y]=8;for(var Y=144;Y<256;++Y)Lt[Y]=9;for(var Y=256;Y<280;++Y)Lt[Y]=7;for(var Y=280;Y<288;++Y)Lt[Y]=8;var vn=new he(32);for(var Y=0;Y<32;++Y)vn[Y]=5;var So=vt(Lt,9,1),Co=vt(vn,5,1),Rt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ye=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Ut=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Lo=function(t){return(t+7)/8|0},ar=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?nt:t.BYTES_PER_ELEMENT==4?hn:he)(r-e);return n.set(t.subarray(e,r)),n},Oo=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ce=function(t,e,r){var n=new Error(e||Oo[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Ce),!r)throw n;return n},To=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new he(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new he(n*3));var l=function(ft){var ut=e.length;if(ft>ut){var _t=new he(Math.max(ut*2,ft));_t.set(e),e=_t}},u=r.f||0,i=r.p||0,f=r.b||0,a=r.l,c=r.d,p=r.m,$=r.n,v=n*8;do{if(!a){u=ye(t,i,1);var k=ye(t,i+1,3);if(i+=3,k)if(k==1)a=So,c=Co,p=9,$=5;else if(k==2){var F=ye(t,i,31)+257,C=ye(t,i+10,15)+4,A=F+ye(t,i+5,31)+1;i+=14;for(var x=new he(A),I=new he(19),P=0;P<C;++P)I[bo[P]]=ye(t,i+P*3,7);i+=C*3;for(var M=Rt(I),N=(1<<M)-1,j=vt(I,M,1),P=0;P<A;){var ee=j[ye(t,i,N)];i+=ee&15;var S=ee>>>4;if(S<16)x[P++]=S;else{var H=0,pe=0;for(S==16?(pe=3+ye(t,i,3),i+=2,H=x[P-1]):S==17?(pe=3+ye(t,i,7),i+=3):S==18&&(pe=11+ye(t,i,127),i+=7);pe--;)x[P++]=H}}var be=x.subarray(0,F),oe=x.subarray(F);p=Rt(be),$=Rt(oe),a=vt(be,p,1),c=vt(oe,$,1)}else Ce(1);else{var S=Lo(i)+4,L=t[S-4]|t[S-3]<<8,E=S+L;if(E>n){s&&Ce(0);break}o&&l(f+L),e.set(t.subarray(S,E),f),r.b=f+=L,r.p=i=E*8,r.f=u;continue}if(i>v){s&&Ce(0);break}}o&&l(f+131072);for(var Ze=(1<<p)-1,$e=(1<<$)-1,gt=i;;gt=i){var H=a[Ut(t,i)&Ze],je=H>>>4;if(i+=H&15,i>v){s&&Ce(0);break}if(H||Ce(2),je<256)e[f++]=je;else if(je==256){gt=i,a=null;break}else{var it=je-254;if(je>264){var P=je-257,ve=dn[P];it=ye(t,i,(1<<ve)-1)+bn[P],i+=ve}var lt=c[Ut(t,i)&$e],Ie=lt>>>4;lt||Ce(3),i+=lt&15;var oe=ko[Ie];if(Ie>3){var ve=gn[Ie];oe+=Ut(t,i)&(1<<ve)-1,i+=ve}if(i>v){s&&Ce(0);break}o&&l(f+131072);for(var at=f+it;f<at;f+=4)e[f]=e[f-oe],e[f+1]=e[f+1-oe],e[f+2]=e[f+2-oe],e[f+3]=e[f+3-oe];f=at}}r.l=a,r.p=gt,r.b=f,r.f=u,a&&(u=1,r.m=p,r.d=c,r.n=$)}while(!u);return f==e.length?e:ar(e,0,f)},Ao=new he(0),Me=function(t,e){return t[e]|t[e+1]<<8},Le=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Ht=function(t,e){return Le(t,e)+Le(t,e+4)*4294967296};function Do(t,e){return To(t,e)}var Yt=typeof TextDecoder<"u"&&new TextDecoder,Eo=0;try{Yt.decode(Ao,{stream:!0}),Eo=1}catch{}var Po=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,ar(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function yn(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Yt)return Yt.decode(t);var o=Po(t),s=o[0],l=o[1];return l.length&&Ce(8),s}}var Mo=function(t,e){return e+30+Me(t,e+26)+Me(t,e+28)},No=function(t,e,r){var n=Me(t,e+28),o=yn(t.subarray(e+46,e+46+n),!(Me(t,e+8)&2048)),s=e+46+n,l=Le(t,e+20),u=r&&l==4294967295?Io(t,s):[l,Le(t,e+24),Le(t,e+42)],i=u[0],f=u[1],a=u[2];return[Me(t,e+10),i,f,o,s+Me(t,e+30)+Me(t,e+32),a]},Io=function(t,e){for(;Me(t,e)!=1;e+=4+Me(t,e+2));return[Ht(t,e+12),Ht(t,e+4),Ht(t,e+20)]};function Fo(t,e){for(var r={},n=t.length-22;Le(t,n)!=101010256;--n)(!n||t.length-n>65558)&&Ce(13);var o=Me(t,n+8);if(!o)return{};var s=Le(t,n+16),l=s==4294967295||o==65535;if(l){var u=Le(t,n-12);l=Le(t,u)==101075792,l&&(o=Le(t,u+32),s=Le(t,u+48))}for(var i=e&&e.filter,f=0;f<o;++f){var a=No(t,s,l),c=a[0],p=a[1],$=a[2],v=a[3],k=a[4],S=a[5],L=Mo(t,S);s=k,(!i||i({name:v,size:p,originalSize:$,compression:c}))&&(c?c==8?r[v]=Do(t.subarray(L,L+p),new he($)):Ce(14,"unknown compression type "+c):r[v]=ar(t,L,L+p))}return r}function xo(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Wt):Wt(t)}function Wt(t){var e=new Uint8Array(t),r=Fo(e);return Promise.resolve(Bo(r))}function Bo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=yn(t[o])}return e}function Ne(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&st(n)===e)return n;r++}}function Ot(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&st(o)===e&&r.push(o),n++}return r}function Nt(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&st(o)===e&&r(o,n):r(o,n),n++}}function jo(t,e,r){var n=[];return Nt(t,e,function(o,s){n.push(r(o,s))}),n}var Ro=/.+\:/;function st(t){return t.tagName.replace(Ro,"")}function kn(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+st(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=kn(t.childNodes[n]),n++;return e+="</"+st(t)+">",e}function Uo(t){var e=t.documentElement,r=Ne(e,"sheetData"),n=[];return Nt(r,"row",function(o){Nt(o,"c",function(s){n.push(s)})}),n}function Ho(t,e){return Ne(e,"v")}function Wo(t,e){if(e.firstChild&&st(e.firstChild)==="is"&&e.firstChild.firstChild&&st(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function zo(t){var e=t.documentElement,r=Ne(e,"dimension");if(r)return r.getAttribute("ref")}function Go(t){var e=t.documentElement,r=Ne(e,"cellStyleXfs");return r?Ot(r,"xf"):[]}function Vo(t){var e=t.documentElement,r=Ne(e,"cellXfs");return r?Ot(r,"xf"):[]}function qo(t){var e=t.documentElement,r=Ne(e,"numFmts");return r?Ot(r,"numFmt"):[]}function Ko(t){var e=t.documentElement;return jo(e,"si",function(r){var n=Ne(r,"t");if(n)return n.textContent;var o="";return Nt(r,"r",function(s){o+=Ne(s,"t").textContent}),o})}function Zo(t){var e=t.documentElement;return Ne(e,"workbookPr")}function Xo(t){var e=t.documentElement;return Ot(e,"Relationship")}function Yo(t){var e=t.documentElement,r=Ne(e,"sheets");return Ot(r,"sheet")}function Jo(t,e){var r=e.createDocument(t),n={},o=Zo(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(u){u.getAttribute("name")&&n.sheets.push({id:u.getAttribute("sheetId"),name:u.getAttribute("name"),relationId:u.getAttribute("r:id")})};return Yo(r).forEach(s),n}function Qo(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var u=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=zt(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=zt(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=zt(u);break}};return Xo(r).forEach(o),n}function zt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function _r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function wr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_r(Object(r),!0).forEach(function(n){es(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function es(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ts(t,e){if(!t)return{};var r=e.createDocument(t),n=Go(r).map(Gt),o=qo(r).map(rs).reduce(function(l,u){return l[u.id]=u,l},[]),s=function(u){return u.hasAttribute("xfId")?wr(wr({},n[u.xfId]),Gt(u,o)):Gt(u,o)};return Vo(r).map(s)}function rs(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function Gt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function ns(t,e){return t?Ko(e.createDocument(t)):[]}function Sn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function os(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ss(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ss(t,e){if(t){if(typeof t=="string")return br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(t,e)}}function br(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function is(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(ls.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&us(o.numberFormat.template))return!0}}var ls=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],as=/^\[\$-414\]/,fs=/;@$/;function us(t){t=t.toLowerCase(),t=t.replace(as,""),t=t.replace(fs,"");for(var e=t.split(/\W+/),r=os(e),n;!(n=r()).done;){var o=n.value;if(cs.indexOf(o)<0)return!1}return!0}var cs=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function ps(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,u=r.values,i=r.properties,f=r.options;switch(e||(e="n"),e){case"str":t=Vt(t,f);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Vt(t,f);break;case"s":var a=Number(t);if(isNaN(a))throw new Error('Invalid "shared" string index: '.concat(t));if(a>=u.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=u[a],t=Vt(t,f);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=$s(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,is(t,s(),l,f)&&(t=Sn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function $s(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Vt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var ms=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function hs(t){var e=function(f,a){return f-a},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],u=n[n.length-1];return[{row:o,column:l},{row:s,column:u}]}function ds(t){for(var e=0,r=0;r<t.length;)e*=26,e+=ms.indexOf(t[r]),r++;return e}function Cn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),ds(t[0].trim())]}function gs(t,e,r,n,o,s,l){var u=Cn(t.getAttribute("r")),i=Ho(e,t),f=i&&i.textContent,a;return t.hasAttribute("t")&&(a=t.getAttribute("t")),{row:u[0],column:u[1],value:ps(f,a,{getInlineStringValue:function(){return Wo(e,t)},getInlineStringXml:function(){return kn(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function _s(t,e,r,n,o,s){var l=Uo(t);return l.length===0?[]:l.map(function(u){return gs(u,t,e,r,n,o,s)})}function ws(t,e){return ks(t)||ys(t,e)||vs(t,e)||bs()}function bs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vs(t,e){if(t){if(typeof t=="string")return vr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vr(t,e)}}function vr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ys(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function ks(t){if(Array.isArray(t))return t}function Ss(t){var e=zo(t);if(e)return e=e.split(":").map(Cn).map(function(r){var n=ws(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function Cs(t,e,r,n,o,s){var l=e.createDocument(t),u=_s(l,e,r,n,o,s),i=Ss(l)||hs(u);return{cells:u,dimensions:i}}function Ls(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Os(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Os(t,e){if(t){if(typeof t=="string")return yr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(t,e)}}function yr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ts(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var u=!0,i=Ls(t[l]),f;!(f=i()).done;){var a=f.value;if(o(a)!==null){u=!1;break}}if(u)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function As(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ds(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ds(t,e){if(t){if(typeof t=="string")return kr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kr(t,e)}}function kr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Es(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,u=As(t),i;!(i=u()).done;){var f=i.value;if(n(f[s])!==null){l=!1;break}}if(l)for(var a=0;a<t.length;)t[a].splice(s,1),a++;else if(o)break;s--}return t}function Ps(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ln(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ms(t,e){return Fs(t)||Is(t,e)||Ln(t,e)||Ns()}function Ns(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ln(t,e){if(t){if(typeof t=="string")return Sr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sr(t,e)}}function Sr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Is(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function Fs(t){if(Array.isArray(t))return t}function xs(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Ms(r,2);o[0];for(var s=o[1],l=s.column,u=s.row,i=new Array(u),f=0;f<u;){i[f]=new Array(l);for(var a=0;a<l;)i[f][a]=null,a++;f++}for(var c=Ps(n),p;!(p=c()).done;){var $=p.value,v=$.row-1,k=$.column-1;k<l&&v<u&&(i[v][k]=$.value)}var S=e.rowMap;if(S)for(var L=0;L<i.length;)S[L]=L,L++;return i=Ts(Es(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:S}),e.transformData&&(i=e.transformData(i)),i}function Bs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=js(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function js(t,e){if(t){if(typeof t=="string")return Cr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(t,e)}}function Cr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Lr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Rs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lr(Object(r),!0).forEach(function(n){Us(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Us(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=Rs({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=Qo(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?ns(n(o.sharedStrings),e):[],l=o.styles?ts(n(o.styles),e):{},u=Jo(n("xl/workbook.xml"),e);if(r.getSheets)return u.sheets.map(function(c){var p=c.name;return{name:p}});var i=Ws(r.sheet,u.sheets);if(!i||!o.sheets[i])throw zs(r.sheet,u.sheets);var f=Cs(n(o.sheets[i]),e,s,l,u,r),a=xs(f,r);return r.properties?{data:a,properties:u}:a}function Ws(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Bs(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function zs(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function Jt(t){"@babel/helpers - typeof";return Jt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jt(t)}function Or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Gs(t,e,r){return e&&Or(t.prototype,e),r&&Or(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kt(t,e)}function Ks(t){var e=On();return function(){var n=St(t),o;if(e){var s=St(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Zs(this,o)}}function Zs(t,e){if(e&&(Jt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xs(t)}function Xs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qt(t){var e=typeof Map=="function"?new Map:void 0;return Qt=function(n){if(n===null||!Ys(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Dt(n,arguments,St(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),kt(o,n)},Qt(t)}function Dt(t,e,r){return On()?Dt=Reflect.construct:Dt=function(o,s,l){var u=[null];u.push.apply(u,s);var i=Function.bind.apply(o,u),f=new i;return l&&kt(f,l.prototype),f},Dt.apply(null,arguments)}function On(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ys(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function kt(t,e){return kt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},kt(t,e)}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},St(t)}var de=function(t){qs(r,t);var e=Ks(r);function r(n){var o;return Vs(this,r),o=e.call(this,"invalid"),o.reason=n,o}return Gs(r)}(Qt(Error));function Js(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new de("not_a_number")}if(typeof t!="number")throw new de("not_a_number");if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");return t}function Qs(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");return String(t)}throw new de("not_a_string")}function ei(t){if(typeof t=="boolean")return t;throw new de("not_a_boolean")}function ti(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new de("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");var n=Sn(t,r);if(isNaN(n.valueOf()))throw new de("out_of_bounds");return n}throw new de("not_a_date")}function ri(t,e){return si(t)||oi(t,e)||Tn(t,e)||ni()}function ni(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oi(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function si(t){if(Array.isArray(t))return t}function er(t){"@babel/helpers - typeof";return er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(t)}function ii(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Tn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tn(t,e){if(t){if(typeof t=="string")return Tr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tr(t,e)}}function Tr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ar(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ar(Object(r),!0).forEach(function(n){li(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function li(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Er={isColumnOriented:!1};function ai(t,e,r){r?r=Dr(Dr({},Er),r):r=Er;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;pi(e),o&&(t=ci(t));for(var u=t[0],i=[],f=[],a=1;a<t.length;a++){var c=An(e,t[a],a,u,f,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=ii(f),$;!($=p()).done;){var v=$.value;v.row=s[v.row-1]+1}return{rows:i,errors:f}}function An(t,e,r,n,o,s){for(var l={},u=!0,i=function(){var p=a[f],$=t[p],v=er($.type)==="object"&&!Array.isArray($.type),k=e[n.indexOf(p)];k===void 0&&(k=null);var S=void 0,L=void 0,E=void 0;if(v)S=An($.type,e,r,n,o,s);else if(k===null)S=null;else if(Array.isArray($.type)){var F=!1,C=ui(k).map(function(x){var I=Pr(x,$,s);return I.error&&(S=x,L=I.error,E=I.reason),I.value!==null&&(F=!0),I.value});L||(S=F?C:null)}else{var A=Pr(k,$,s);L=A.error,E=A.reason,S=L?k:A.value}!L&&S===null&&$.required&&(L="required"),L?(L={error:L,row:r+1,column:p,value:S},E&&(L.reason=E),$.type&&(L.type=$.type),o.push(L)):(u&&S!==null&&(u=!1),(S!==null||s.includeNullValues)&&(l[$.prop]=S))},f=0,a=Object.keys(t);f<a.length;f++)i();return u?null:l}function Pr(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=pt(t,e.parse):e.type?n=fi(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function pt(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function fi(t,e,r){switch(e){case String:return pt(t,Qs);case Number:return pt(t,Js);case Date:return pt(t,function(n){return ti(n,{properties:r.properties})});case Boolean:return pt(t,ei);default:if(typeof e=="function")return pt(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Dn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=Dn(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function ui(t){for(var e=[],r=0;r<t.length;){var n=Dn(t,",",r),o=ri(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var ci=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function pi(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function tr(t){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(t)}function En(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;tr(s)==="object"&&(s=Object.keys(t[o])[0],l=En(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var $i=["schema","map"];function Mr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function At(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mr(Object(r),!0).forEach(function(n){mi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hi(t,e){if(t==null)return{};var r=di(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function di(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function gi(t,e,r){var n=r.schema,o=r.map,s=hi(r,$i);!n&&o&&(n=En(o));var l=Hs(t,e,At(At({},s),{},{properties:n||s.properties}));return n?ai(l.data,n,At(At({},s),{},{properties:l.properties})):l}function _i(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return xo(t).then(function(r){return gi(r,wo,e)})}function wi(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function bi(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await _i(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=Kn(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const W={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},jt=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function vi(t){let e,r,n,o,s;function l(i){t[3](i)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(u.value=t[0]),e=new Mt({props:u}),U.push(()=>z(e,"value",l)),e.$on("change",t[2]),o=new oo({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};!r&&f&1&&(r=!0,a.value=i[0],G(()=>r=!1)),e.$set(a);const c={};f&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function yi(t,e,r){let n;X(t,re,i=>r(4,n=i));let o="interventionType",s=gr("v1");function l(){let i;o=="interventionType"?(i=mn("v1"),r(1,s=gr("v1"))):(i=an(["get","funding_programme"],{ATF2:W.atf2,ATF3:W.atf3,ATF4:W.atf4},"grey"),r(1,s=[["ATF2",W.atf2],["ATF3",W.atf3],["ATF4",W.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function u(i){o=i,r(0,o)}return[o,s,l,u]}class ki extends V{constructor(e){super(),q(this,e,yi,vi,K,{})}}function Si(t){let e;return{c(){e=y("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ci(t){let e,r,n,o,s,l;return n=new Zt({props:{$$slots:{default:[Si]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=D("input"),r=O(),_(n.$$.fragment),R(e,"type","text"),R(e,"class","govuk-input govuk-input--width-10"),R(e,"id","filterText")},m(u,i){m(u,e,i),mr(e,t[0]),m(u,r,i),w(n,u,i),o=!0,s||(l=Ft(e,"input",t[12]),s=!0)},p(u,i){i&1&&e.value!==u[0]&&mr(e,u[0]);const f={};i&131072&&(f.$$scope={dirty:i,ctx:u}),n.$set(f)},i(u){o||(d(n.$$.fragment,u),o=!0)},o(u){g(n.$$.fragment,u),o=!1},d(u){u&&(h(e),h(r)),b(n,u),s=!1,l()}}}function Li(t){let e,r,n,o,s,l,u,i,f,a;function c(k){t[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Mt({props:p}),U.push(()=>z(e,"value",c));function $(k){t[11](k)}let v={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(v.value=t[3]),o=new Mt({props:v}),U.push(()=>z(o,"value",$)),u=new fn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[Ci]},$$scope:{ctx:t}}}),f=new ki({}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(k,S){w(e,k,S),m(k,n,S),w(o,k,S),m(k,l,S),w(u,k,S),m(k,i,S),w(f,k,S),a=!0},p(k,S){const L={};S&32&&(L.choices=k[5]),!r&&S&4&&(r=!0,L.value=k[2],G(()=>r=!1)),e.$set(L);const E={};S&64&&(E.choices=k[6]),!s&&S&8&&(s=!0,E.value=k[3],G(()=>s=!1)),o.$set(E);const F={};S&131073&&(F.$$scope={dirty:S,ctx:k}),u.$set(F)},i(k){a||(d(e.$$.fragment,k),d(o.$$.fragment,k),d(u.$$.fragment,k),d(f.$$.fragment,k),a=!0)},o(k){g(e.$$.fragment,k),g(o.$$.fragment,k),g(u.$$.fragment,k),g(f.$$.fragment,k),a=!1},d(k){k&&(h(n),h(l),h(i)),b(e,k),b(o,k),b(u,k),b(f,k)}}}function Oi(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,u,i=t[7].area.toLocaleString()+"",f,a,c=t[7].crossing.toLocaleString()+"",p,$,v=t[7].other.toLocaleString()+"",k,S;return{c(){e=y("Showing "),n=y(r),o=y(" schemes ("),l=y(s),u=y(`
    routes, `),f=y(i),a=y(` areas,
    `),p=y(c),$=y(" crossings, "),k=y(v),S=y(`
    other)`)},m(L,E){m(L,e,E),m(L,n,E),m(L,o,E),m(L,l,E),m(L,u,E),m(L,f,E),m(L,a,E),m(L,p,E),m(L,$,E),m(L,k,E),m(L,S,E)},p(L,E){E&2&&r!==(r=L[1].size.toLocaleString()+"")&&Oe(n,r),E&128&&s!==(s=L[7].route.toLocaleString()+"")&&Oe(l,s),E&128&&i!==(i=L[7].area.toLocaleString()+"")&&Oe(f,i),E&128&&c!==(c=L[7].crossing.toLocaleString()+"")&&Oe(p,c),E&128&&v!==(v=L[7].other.toLocaleString()+"")&&Oe(k,v)},d(L){L&&(h(e),h(n),h(o),h(l),h(u),h(f),h(a),h(p),h($),h(k),h(S))}}}function Ti(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[Oi]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),U.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,u){w(e,l,u),n=!0},p(l,u){const i={};u&131202&&(i.$$scope={dirty:u,ctx:l}),!r&&u&16&&(r=!0,i.checked=l[4],G(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function Ai(t){let e,r,n,o;return e=new xe({props:{label:"Filters",$$slots:{default:[Li]},$$scope:{ctx:t}}}),n=new Ct({props:{small:!0,$$slots:{default:[Ti]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},p(s,[l]){const u={};l&131181&&(u.$$scope={dirty:l,ctx:s}),e.$set(u);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Di(t,e,r){let n,o;X(t,ht,C=>r(15,n=C)),X(t,re,C=>r(9,o=C));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:u=""}=e,i=[],f="",a=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;xt(()=>{let C=new Set,A=new Set;for(let x of s.values())x.authority_or_region&&C.add(x.authority_or_region),x.funding_programme&&A.add(x.funding_programme);r(5,i=Array.from(C.entries())),i.sort(),r(6,a=Array.from(A.entries())),a.sort()});function v(C,A,x){let I=C.toLowerCase(),P=N=>{var j,ee;if(I&&!((j=N.properties.name)!=null&&j.toLowerCase().includes(I))&&!((ee=N.properties.description)!=null&&ee.toLowerCase().includes(I)))return!1;if(A||x){let H=s.get(N.properties.scheme_reference);if(A&&H.authority_or_region!=A||x&&H.funding_programme!=x)return!1}return!0};r(1,l=new Set(n.features.filter(P).map(N=>N.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let M=N=>{var j,ee;return!(!l.has(N.properties.scheme_reference)||I&&!((j=N.properties.name)!=null&&j.toLowerCase().includes(I))&&!((ee=N.properties.description)!=null&&ee.toLowerCase().includes(I)))};ht.update(N=>{for(let j of N.features)M(j)?(delete j.properties.hide_while_editing,r(7,p[j.properties.intervention_type]++,p)):j.properties.hide_while_editing=!0;return N}),r(7,p)}function k(C){f=C,r(2,f)}function S(C){c=C,r(3,c)}function L(){u=this.value,r(0,u)}const E=()=>r(0,u="");function F(C){$=C,r(4,$)}return t.$$set=C=>{"schemes"in C&&r(8,s=C.schemes),"schemesToBeShown"in C&&r(1,l=C.schemesToBeShown),"filterText"in C&&r(0,u=C.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let C of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(C)&&o.setLayoutProperty(C,"visibility",$?"visible":"none");t.$$.dirty&13&&v(u,f,c)},[u,l,f,c,$,i,a,p,s,o,k,S,L,E,F]}class Ei extends V{constructor(e){super(),q(this,e,Di,Ai,K,{schemes:8,schemesToBeShown:1,filterText:0})}}function Pi(t){let e,r,n;return e=new we({props:{color:W.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=y(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Mi(t){let e;return{c(){e=y(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ni(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ii(t){let e,r,n,o,s,l,u,i,f,a,c;return s=new B({props:{href:"https://gtfs.org",$$slots:{default:[Mi]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ni]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=O(),n=D("p"),o=y("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),l=y(`, and doesn't include which routes are run or the
        frequency of service.`),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment)},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),T(n,o),w(s,n,null),T(n,l),m(p,u,$),m(p,i,$),T(i,f),w(a,i,null),c=!0},p(p,$){const v={};$&8&&(v.$$scope={dirty:$,ctx:p}),s.$set(v);const k={};$&8&&(k.$$scope={dirty:$,ctx:p}),a.$set(k)},i(p){c||(d(s.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(s.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(u),h(i)),b(s),b(a)}}}function Fi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ii]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function xi(t){let e,r,n,o,s;function l(i){t[1](i)}let u={id:Xe,$$slots:{right:[Fi],default:[Pi]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Xe,tooltip:Bi,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&8&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Xe="bus_routes";function Bi(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function ji(t,e,r){let n;X(t,re,l=>r(2,n=l)),ae(n,Xe,`${se()}/v1/${Xe}.pmtiles`),_e(n,{id:Xe,source:Xe,sourceLayer:Xe,color:["case",["boolean",["get","has_bus_lane"],!1],W.bus_route_with_lane,W.bus_route_without_lane],width:5,opacity:ce(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class Ri extends V{constructor(e){super(),q(this,e,ji,xi,K,{})}}function Nr(t,e,r){const n=t.slice();return n[2]=e[r],n}function Ir(t,e,r){const n=t.slice();return n[5]=e[r],n}function Fr(t){let e,r;return{c(){e=D("span"),r=y(` 
    `),Be(e,"background",t[5]),Be(e,"width","100%"),Be(e,"border","1px solid black")},m(n,o){m(n,e,o),T(e,r)},p(n,o){o&1&&Be(e,"background",n[5])},d(n){n&&h(e)}}}function xr(t){let e,r=t[2]+"",n;return{c(){e=D("span"),n=y(r)},m(o,s){m(o,e,s),T(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&Oe(n,r)},d(o){o&&h(e)}}}function Ui(t){let e,r,n,o=Ge(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Fr(Ir(t,o,i));let l=Ge(t[1]),u=[];for(let i=0;i<l.length;i+=1)u[i]=xr(Nr(t,l,i));return{c(){e=D("div");for(let i=0;i<s.length;i+=1)s[i].c();r=O(),n=D("div");for(let i=0;i<u.length;i+=1)u[i].c();Be(e,"display","flex"),Be(n,"display","flex"),Be(n,"justify-content","space-between")},m(i,f){m(i,e,f);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);m(i,r,f),m(i,n,f);for(let a=0;a<u.length;a+=1)u[a]&&u[a].m(n,null)},p(i,[f]){if(f&1){o=Ge(i[0]);let a;for(a=0;a<o.length;a+=1){const c=Ir(i,o,a);s[a]?s[a].p(c,f):(s[a]=Fr(c),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=o.length}if(f&2){l=Ge(i[1]);let a;for(a=0;a<l.length;a+=1){const c=Nr(i,l,a);u[a]?u[a].p(c,f):(u[a]=xr(c),u[a].c(),u[a].m(n,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=l.length}},i:Q,o:Q,d(i){i&&(h(e),h(r),h(n)),Pt(s,i),Pt(u,i)}}}function Hi(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class Ke extends V{constructor(e){super(),q(this,e,Hi,Ui,K,{colorScale:0,limits:1})}}function Wi(t){let e;return{c(){e=y("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zi(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gi(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vi(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function qi(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[zi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Gi]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Vi]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&65536&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&65536&&(S.$$scope={dirty:v,ctx:$}),s.$set(S);const L={};v&65536&&(L.$$scope={dirty:v,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function Ki(t){let e,r,n;return r=new ne({props:{$$slots:{default:[qi]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Br(t){let e,r;return e=new Ke({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Zi(t){let e;return{c(){e=y("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xi(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yi(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ji(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qi(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v;return s=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Xi]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Yi]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ji]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=O(),n=D("p"),o=y("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),l=y(". Output area boundaries from "),_(u.$$.fragment),i=y("."),f=O(),a=D("p"),c=y("License: "),_(p.$$.fragment),$=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(k,S){m(k,e,S),m(k,r,S),m(k,n,S),T(n,o),w(s,n,null),T(n,l),w(u,n,null),T(n,i),m(k,f,S),m(k,a,S),T(a,c),w(p,a,null),T(a,$),v=!0},p(k,S){const L={};S&65536&&(L.$$scope={dirty:S,ctx:k}),s.$set(L);const E={};S&65536&&(E.$$scope={dirty:S,ctx:k}),u.$set(E);const F={};S&65536&&(F.$$scope={dirty:S,ctx:k}),p.$set(F)},i(k){v||(d(s.$$.fragment,k),d(u.$$.fragment,k),d(p.$$.fragment,k),v=!0)},o(k){g(s.$$.fragment,k),g(u.$$.fragment,k),g(p.$$.fragment,k),v=!1},d(k){k&&(h(e),h(r),h(n),h(f),h(a)),b(s),b(u),b(p)}}}function el(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Qi]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function jr(t){let e,r;return e=new Ke({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function tl(t){let e;return{c(){e=y("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rl(t){let e;return{c(){e=y(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ol(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function sl(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[rl]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[nl]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ol]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&65536&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&65536&&(S.$$scope={dirty:v,ctx:$}),s.$set(S);const L={};v&65536&&(L.$$scope={dirty:v,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function il(t){let e,r,n;return r=new ne({props:{$$slots:{default:[sl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Rr(t){let e,r,n,o;return n=new Ke({props:{colorScale:t[4],limits:t[7]().map(al)}}),{c(){e=D("p"),e.textContent="(people per square kilometres)",r=O(),_(n.$$.fragment)},m(s,l){m(s,e,l),m(s,r,l),w(n,s,l),o=!0},p:Q,i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function ll(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v;function k(P){t[9](P)}let S={id:"percent_households_with_car",$$slots:{right:[Ki],default:[Wi]},$$scope:{ctx:t}};t[0]!==void 0&&(S.checked=t[0]),e=new te({props:S}),U.push(()=>z(e,"checked",k)),e.$on("change",t[10]);let L=t[3]=="percent_households_with_car"&&Br(t);function E(P){t[11](P)}let F={id:"average_cars_per_household",$$slots:{right:[el],default:[Zi]},$$scope:{ctx:t}};t[1]!==void 0&&(F.checked=t[1]),s=new te({props:F}),U.push(()=>z(s,"checked",E)),s.$on("change",t[12]);let C=t[3]=="average_cars_per_household"&&jr(t);function A(P){t[13](P)}let x={id:"population_density",$$slots:{right:[il],default:[tl]},$$scope:{ctx:t}};t[2]!==void 0&&(x.checked=t[2]),f=new te({props:x}),U.push(()=>z(f,"checked",A)),f.$on("change",t[14]);let I=t[3]=="population_density"&&Rr(t);return $=new J({props:{layer:Te,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=O(),L&&L.c(),o=O(),_(s.$$.fragment),u=O(),C&&C.c(),i=O(),_(f.$$.fragment),c=O(),I&&I.c(),p=O(),_($.$$.fragment)},m(P,M){w(e,P,M),m(P,n,M),L&&L.m(P,M),m(P,o,M),w(s,P,M),m(P,u,M),C&&C.m(P,M),m(P,i,M),w(f,P,M),m(P,c,M),I&&I.m(P,M),m(P,p,M),w($,P,M),v=!0},p(P,[M]){const N={};M&65536&&(N.$$scope={dirty:M,ctx:P}),!r&&M&1&&(r=!0,N.checked=P[0],G(()=>r=!1)),e.$set(N),P[3]=="percent_households_with_car"?L?(L.p(P,M),M&8&&d(L,1)):(L=Br(P),L.c(),d(L,1),L.m(o.parentNode,o)):L&&(fe(),g(L,1,1,()=>{L=null}),ue());const j={};M&65536&&(j.$$scope={dirty:M,ctx:P}),!l&&M&2&&(l=!0,j.checked=P[1],G(()=>l=!1)),s.$set(j),P[3]=="average_cars_per_household"?C?(C.p(P,M),M&8&&d(C,1)):(C=jr(P),C.c(),d(C,1),C.m(i.parentNode,i)):C&&(fe(),g(C,1,1,()=>{C=null}),ue());const ee={};M&65536&&(ee.$$scope={dirty:M,ctx:P}),!a&&M&4&&(a=!0,ee.checked=P[2],G(()=>a=!1)),f.$set(ee),P[3]=="population_density"?I?(I.p(P,M),M&8&&d(I,1)):(I=Rr(P),I.c(),d(I,1),I.m(p.parentNode,p)):I&&(fe(),g(I,1,1,()=>{I=null}),ue());const H={};M&8&&(H.show=P[3]!=""),$.$set(H)},i(P){v||(d(e.$$.fragment,P),d(L),d(s.$$.fragment,P),d(C),d(f.$$.fragment,P),d(I),d($.$$.fragment,P),v=!0)},o(P){g(e.$$.fragment,P),g(L),g(s.$$.fragment,P),g(C),g(f.$$.fragment,P),g(I),g($.$$.fragment,P),v=!1},d(P){P&&(h(n),h(o),h(u),h(i),h(c),h(p)),b(e,P),L&&L.d(P),b(s,P),C&&C.d(P),b(f,P),I&&I.d(P),b($,P)}}}let Te="census_output_areas";const al=t=>t.toLocaleString();function fl(t,e,r){let n;X(t,re,F=>r(8,n=F));let o=`${Te}-outline`,s=W.sequential_low_to_high,l=!1,u=!1,i=!1,f="";ae(n,Te,`${se()}/v1/${Te}.pmtiles`),qe(n,{id:Te,source:Te,sourceLayer:Te,color:"black",opacity:ce(.5,.7)}),_e(n,{id:o,source:Te,sourceLayer:Te,color:"black",width:.5});function a(F){let C=F.properties.OA21CD,A=F.properties[f];return f=="percent_households_with_car"?`<p>${A}% of households in ${C} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${C} have an average of ${A} cars</p>`:`<p>There are ${A.toLocaleString()} people per square kilometre in ${C}</p>`}function c(F){let C=F.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${C}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${C}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(F){l=F,r(0,l)}const v=()=>{r(1,u=!1),r(2,i=!1)};function k(F){u=F,r(1,u)}const S=()=>{r(0,l=!1),r(2,i=!1)};function L(F){i=F,r(2,i)}const E=()=>{r(0,l=!1),r(1,u=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,f="percent_households_with_car"):u?r(3,f="average_cars_per_household"):i?r(3,f="population_density"):r(3,f=""),f?(n.setPaintProperty(Te,"fill-color",Ve(["get",f],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,u,i,f,s,a,c,p,n,$,v,k,S,L,E]}class ul extends V{constructor(e){super(),q(this,e,fl,ll,K,{})}}function cl(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function pl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $l(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ml(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[pl]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[$l]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of December 2022."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment),f=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const v={};p&32&&(v.$$scope={dirty:p,ctx:c}),i.$set(v)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function hl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ml]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function dl(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Ue,$$slots:{right:[hl],default:[cl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ue,tooltip:gl,show:t[0],clickable:!0}}),o.$on("click",_l),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ue="combined_authorities";function gl(t){return`<p>${t.properties.name}</p>`}function _l(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function wl(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.combined_authorities,s=`${Ue}-outline`;ir(n,Ue,`${se()}/v1/${Ue}.geojson`),qe(n,{id:Ue,source:Ue,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:Ue,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class bl extends V{constructor(e){super(),q(this,e,wl,dl,K,{})}}function vl(t){let e,r,n;return{c(){e=D("input"),R(e,"class","govuk-file-upload"),R(e,"id","load-criticals"),R(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=Ft(e,"change",t[4]),r=!0)},p:Q,d(o){o&&h(e),t[7](null),r=!1,n()}}}function Ur(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[kl]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function yl(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new we({props:{color:rr}}),{c(){_(e.$$.fragment),r=y(`
        Show `),o=y(n),s=y(" issues")},m(u,i){w(e,u,i),m(u,r,i),m(u,o,i),m(u,s,i),l=!0},p(u,i){(!l||i&4)&&n!==(n=u[2].toLocaleString()+"")&&Oe(o,n)},i(u){l||(d(e.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),l=!1},d(u){u&&(h(r),h(o),h(s)),b(e,u)}}}function kl(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[yl]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),U.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,u){w(e,l,u),n=!0},p(l,u){const i={};u&516&&(i.$$scope={dirty:u,ctx:l}),!r&&u&1&&(r=!0,i.checked=l[0],G(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function Sl(t){let e,r,n,o,s,l;e=new fn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[vl]},$$scope:{ctx:t}}}),n=new cn({props:{errorMessage:t[3]}});let u=t[2]>0&&Ur(t);return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),u&&u.c(),s=Bt()},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),m(i,o,f),u&&u.m(i,f),m(i,s,f),l=!0},p(i,f){const a={};f&514&&(a.$$scope={dirty:f,ctx:i}),e.$set(a);const c={};f&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?u?(u.p(i,f),f&4&&d(u,1)):(u=Ur(i),u.c(),d(u,1),u.m(s.parentNode,s)):u&&(fe(),g(u,1,1,()=>{u=null}),ue())},i(i){l||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(u),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(u),l=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),u&&u.d(i)}}}function Cl(t){let e,r,n,o,s,l;return e=new xe({props:{label:"Critical Issues",$$slots:{default:[Sl]},$$scope:{ctx:t}}}),n=new J({props:{layer:ie+"-points",tooltip:Ll,show:t[0],clickable:!1}}),s=new J({props:{layer:ie+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[ie+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment)},m(u,i){w(e,u,i),m(u,r,i),w(n,u,i),m(u,o,i),w(s,u,i),l=!0},p(u,[i]){const f={};i&527&&(f.$$scope={dirty:i,ctx:u}),e.$set(f);const a={};i&1&&(a.show=u[0]),n.$set(a);const c={};i&1&&(c.show=u[0]),s.$set(c)},i(u){l||(d(e.$$.fragment,u),d(n.$$.fragment,u),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),l=!1},d(u){u&&(h(r),h(o)),b(e,u),b(n,u),b(s,u)}}}let ie="criticals",rr="red";function Ll(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function Ol(t,e,r){let n;X(t,re,p=>r(6,n=p));let o,s=!0,l=0,u="";Zn(n,ie),n.addSource(ie,{type:"geojson",data:un(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),dt(n,{id:`${ie}-clusters`,source:ie,filter:["has","point_count"],color:rr,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${ie}-counts`,source:ie,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),dt(n,{id:`${ie}-points`,source:ie,filter:["!",["has","point_count"]],color:rr,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await bi(o.files[0]);n.getSource(ie).setData($),r(2,l=$.features.length),r(3,u="")}catch($){r(3,u=`The file you loaded is broken: ${$}`)}}function f(p){n.getSource(ie).getClusterExpansionZoom(p.detail.properties.cluster_id,($,v)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:v})})}function a(p){U[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${ie}-counts`)&&n.setLayoutProperty(`${ie}-counts`,"visibility",s?"visible":"none")},[s,o,l,u,i,f,n,a,c]}class Tl extends V{constructor(e){super(),q(this,e,Ol,Cl,K,{})}}function Al(t){let e,r,n;return e=new we({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=y(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Dl(t){let e;return{c(){e=y("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function El(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pl(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[Dl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[El]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Ml(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Pl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Nl(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:He,$$slots:{right:[Ml],default:[Al]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:He,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",Il),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&64&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const He="crossings";function Il(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function Fl(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=!1;function s(f){const a=f.properties.crossing;return`<p>${l.get(a)??`Crossing with unknown type (${a})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);ae(n,He,`${se()}/v1/${He}.pmtiles`);let u=W[He];dt(n,{id:He,source:He,sourceLayer:He,color:u,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(f){o=f,r(0,o)}return[o,s,u,i]}class xl extends V{constructor(e){super(),q(this,e,Fl,Nl,K,{})}}function Bl(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function jl(t){let e;return{c(){e=y("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Rl(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ul(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[jl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Rl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Cycle parking, according to "),_(n.$$.fragment),o=y(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Hl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ul]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Wl(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:Ye,$$slots:{right:[Hl],default:[Bl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ye,tooltip:zl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&16&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ye="cycle_parking";function zl(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function Gl(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=W.cycle_parking;ae(n,Ye,`${se()}/v1/${Ye}.pmtiles`),dt(n,{id:Ye,source:Ye,sourceLayer:Ye,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class Vl extends V{constructor(e){super(),q(this,e,Gl,Wl,K,{})}}function Hr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function ql(t){let e;return{c(){e=y("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Kl(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zl(t){let e,r,n,o,s,l,u,i,f,a;return f=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Kl]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=O(),n=D("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=O(),s=D("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=O(),u=D("p"),i=y("License: "),_(f.$$.fragment)},m(c,p){m(c,e,p),m(c,r,p),m(c,n,p),m(c,o,p),m(c,s,p),m(c,l,p),m(c,u,p),T(u,i),w(f,u,null),a=!0},p(c,p){const $={};p&256&&($.$$scope={dirty:p,ctx:c}),f.$set($)},i(c){a||(d(f.$$.fragment,c),a=!0)},o(c){g(f.$$.fragment,c),a=!1},d(c){c&&(h(e),h(r),h(n),h(o),h(s),h(l),h(u)),b(f)}}}function Xl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Zl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Wr(t){let e,r,n=Ge(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=zr(Hr(t,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=Bt()},m(l,u){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,u);m(l,e,u),r=!0},p(l,u){if(u&2){n=Ge(l[1]);let i;for(i=0;i<n.length;i+=1){const f=Hr(l,n,i);o[i]?(o[i].p(f,u),d(o[i],1)):(o[i]=zr(f),o[i].c(),d(o[i],1),o[i].m(e.parentNode,e))}for(fe(),i=n.length;i<o.length;i+=1)s(i);ue()}},i(l){if(!r){for(let u=0;u<n.length;u+=1)d(o[u]);r=!0}},o(l){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)g(o[u]);r=!1},d(l){l&&h(e),Pt(o,l)}}}function zr(t){let e,r,n,o=t[4]+"",s,l,u;return r=new we({props:{color:t[5]}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),s=y(o),l=O()},m(i,f){m(i,e,f),w(r,e,null),T(e,n),T(e,s),T(e,l),u=!0},p:Q,i(i){u||(d(r.$$.fragment,i),u=!0)},o(i){g(r.$$.fragment,i),u=!1},d(i){i&&h(e),b(r)}}}function Yl(t){let e,r,n,o,s,l;function u(a){t[2](a)}let i={id:Je,$$slots:{right:[Xl],default:[ql]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&Wr(t);return s=new J({props:{layer:Je,tooltip:Jl,show:t[0],clickable:!0}}),s.$on("click",Ql),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Wr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let Je="cycle_paths";function Jl(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Ql(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function ea(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=[["Separated tracks",W.cycle_paths.track],["Unprotected lanes",W.cycle_paths.lane],["Shared-use (segregated)",W.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",W.cycle_paths.shared_use_unsegregated]];ae(n,Je,`${se()}/v1/${Je}.pmtiles`),_e(n,{id:Je,source:Je,sourceLayer:Je,color:an(["get","kind"],{track:W.cycle_paths.track,lane:W.cycle_paths.lane,shared_use_segregated:W.cycle_paths.shared_use_segregated,shared_use_unsegregated:W.cycle_paths.shared_use_unsegregated},"red"),width:jt,opacity:ce(.5,1)});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class ta extends V{constructor(e){super(),q(this,e,ea,Yl,K,{})}}function ra(t){let e,r,n,o;return e=new we({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=O(),n=y(t[1])},m(s,l){w(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&Oe(n,s[1])},i(s){o||(d(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function na(t){let e;const r=t[6].default,n=nn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&on(n,r,o,o[8],e?ln(r,o[8],s,null):sn(o[8]),null)},i(o){e||(d(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function oa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[na]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function sa(t){let e,r,n,o,s;function l(i){t[7](i)}let u={id:t[0],$$slots:{right:[oa],default:[ra]},$$scope:{ctx:t}};return t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&1&&(a.id=i[0]),f&258&&(a.$$scope={dirty:f,ctx:i}),!r&&f&4&&(r=!0,a.checked=i[2],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.layer=i[0]),f&4&&(c.show=i[2]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function ia(t,e,r){let n;X(t,re,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:u}=e,{pluralNoun:i}=e,f=W[l];ae(n,l,`${se()}/v1/${l}.pmtiles`),qe(n,{id:l,source:l,sourceLayer:l,color:f,opacity:ce(1,.7)});let a=!1;function c($){return`<p>${$.properties.name??`Unnamed ${u}`}</p>`}function p($){a=$,r(2,a)}return t.$$set=$=>{"name"in $&&r(0,l=$.name),"singularNoun"in $&&r(5,u=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[l,i,a,f,c,u,o,p,s]}class fr extends V{constructor(e){super(),q(this,e,ia,sa,K,{name:0,singularNoun:5,pluralNoun:1})}}function la(t){let e;return{c(){e=y("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function aa(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fa(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[la]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[aa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function ua(t){let e,r;return e=new fr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[fa]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class ca extends V{constructor(e){super(),q(this,e,null,ua,K,{})}}function pa(t){let e;return{c(){e=y("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $a(t){let e;return{c(){e=y(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ma(t){let e;return{c(){e=y(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ha(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function da(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[$a]},$$scope:{ctx:t}}}),s=new B({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[ma]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ha]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("The 2019 English IMD scores come from "),_(n.$$.fragment),o=y(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),l=y("."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&64&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&64&&(S.$$scope={dirty:v,ctx:$}),s.$set(S);const L={};v&64&&(L.$$scope={dirty:v,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function ga(t){let e,r,n;return r=new ne({props:{$$slots:{default:[da]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Gr(t){let e,r;return e=new Ke({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function _a(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:Ae,$$slots:{right:[ga],default:[pa]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&Gr(t);return s=new J({props:{layer:Ae,tooltip:wa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Gr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let Ae="imd";function wa(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function ba(t,e,r){let n;X(t,re,f=>r(2,n=f));let o=`${Ae}-outline`,s=W.sequential_low_to_high,l=[0,2,4,6,8,10];ae(n,Ae,`${se()}/v1/${Ae}.pmtiles`),qe(n,{id:Ae,source:Ae,sourceLayer:Ae,color:Ve(["-",10,["get","decile"]],l,s),opacity:ce(.5,.7)}),_e(n,{id:o,source:Ae,sourceLayer:Ae,color:"black",width:.5});let u=!1;function i(f){u=f,r(0,u)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",u?"visible":"none")},[u,s,n,i]}class va extends V{constructor(e){super(),q(this,e,ba,_a,K,{})}}function ya(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ka(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Sa(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ca(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[ka]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Sa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment),f=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const v={};p&32&&(v.$$scope={dirty:p,ctx:c}),i.$set(v)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function La(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ca]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Oa(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:We,$$slots:{right:[La],default:[ya]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:We,tooltip:Ta,show:t[0],clickable:!0}}),o.$on("click",Aa),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let We="local_authority_districts";function Ta(t){return`<p>${t.properties.name}</p>`}function Aa(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function Da(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.local_authority_districts,s=`${We}-outline`;ir(n,We,`${se()}/v1/${We}.geojson`),qe(n,{id:We,source:We,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:We,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class Ea extends V{constructor(e){super(),q(this,e,Da,Oa,K,{})}}function Pa(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ma(t){let e;return{c(){e=y(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Na(t){let e;return{c(){e=y(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ia(t){let e;return{c(){e=y(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fa(t){let e;return{c(){e=y("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xa(t){let e;return{c(){e=y(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ba(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ja(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v,k,S,L,E,F,C,A,x,I,P,M;return n=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Ma]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Na]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Ia]},$$scope:{ctx:t}}}),$=new B({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Fa]},$$scope:{ctx:t}}}),E=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[xa]},$$scope:{ctx:t}}}),I=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ba]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("LPAs may be a "),_(n.$$.fragment),o=y(", "),_(s.$$.fragment),l=y("y, or "),_(u.$$.fragment),i=y("."),f=O(),a=D("p"),c=D("strong"),p=y(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),v=y(" to get more details."),k=O(),S=D("p"),L=y("Data from ONS Geography via "),_(E.$$.fragment),F=y(", as of November 2022."),C=O(),A=D("p"),x=y("License: "),_(I.$$.fragment),P=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(N,j){m(N,e,j),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),w(u,e,null),T(e,i),m(N,f,j),m(N,a,j),T(a,c),T(c,p),w($,c,null),T(c,v),m(N,k,j),m(N,S,j),T(S,L),w(E,S,null),T(S,F),m(N,C,j),m(N,A,j),T(A,x),w(I,A,null),T(A,P),M=!0},p(N,j){const ee={};j&32&&(ee.$$scope={dirty:j,ctx:N}),n.$set(ee);const H={};j&32&&(H.$$scope={dirty:j,ctx:N}),s.$set(H);const pe={};j&32&&(pe.$$scope={dirty:j,ctx:N}),u.$set(pe);const be={};j&32&&(be.$$scope={dirty:j,ctx:N}),$.$set(be);const oe={};j&32&&(oe.$$scope={dirty:j,ctx:N}),E.$set(oe);const Ze={};j&32&&(Ze.$$scope={dirty:j,ctx:N}),I.$set(Ze)},i(N){M||(d(n.$$.fragment,N),d(s.$$.fragment,N),d(u.$$.fragment,N),d($.$$.fragment,N),d(E.$$.fragment,N),d(I.$$.fragment,N),M=!0)},o(N){g(n.$$.fragment,N),g(s.$$.fragment,N),g(u.$$.fragment,N),g($.$$.fragment,N),g(E.$$.fragment,N),g(I.$$.fragment,N),M=!1},d(N){N&&(h(e),h(f),h(a),h(k),h(S),h(C),h(A)),b(n),b(s),b(u),b($),b(E),b(I)}}}function Ra(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ja]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ua(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:De,$$slots:{right:[Ra],default:[Pa]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:De,tooltip:Ha,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="local_planning_authorities";function Ha(t){return`<p>${t.properties.name}</p>`}function Wa(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.local_planning_authorities,s=`${De}-outline`;ae(n,De,`${se()}/v1/${De}.pmtiles`),qe(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:De,sourceLayer:De,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class za extends V{constructor(e){super(),q(this,e,Wa,Ua,K,{})}}function Ga(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Va(t){let e;return{c(){e=y(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function qa(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ka(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Va]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[qa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from the "),_(n.$$.fragment),o=y(", as of September 2021."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Za(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ka]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Xa(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:Qe,$$slots:{right:[Za],default:[Ga]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Qe,tooltip:Ya,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&16&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Qe="mrn";function Ya(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Ja(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=W.mrn;ae(n,Qe,`${se()}/v1/${Qe}.pmtiles`),_e(n,{id:Qe,source:Qe,sourceLayer:Qe,color:o,width:7,opacity:ce(.5,1)});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class Qa extends V{constructor(e){super(),q(this,e,Ja,Xa,K,{})}}function ef(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function tf(t){let e;return{c(){e=y(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rf(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nf(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[tf]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[rf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function of(t){let e,r,n;return r=new ne({props:{$$slots:{default:[nf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function sf(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Ee,$$slots:{right:[of],default:[ef]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ee,tooltip:lf,show:t[0],clickable:!0}}),o.$on("click",af),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="parliamentary_constituencies";function lf(t){return`<p>${t.properties.Name}</p>`}function af(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function ff(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.parliamentary_constituencies,s=`${Ee}-outline`;ae(n,Ee,`${se()}/v1/${Ee}.pmtiles`),qe(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class uf extends V{constructor(e){super(),q(this,e,ff,sf,K,{})}}function cf(t){let e;return{c(){e=y("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pf(t){let e;return{c(){e=y("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $f(t){let e;return{c(){e=y("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function mf(t){let e,r,n,o,s,l,u,i,f,a,c;return u=new B({props:{href:"https://www.pct.bike",$$slots:{default:[pf]},$$scope:{ctx:t}}}),f=new B({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[$f]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=O(),n=D("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=O(),s=D("p"),l=y("See "),_(u.$$.fragment),i=y(" and "),_(f.$$.fragment),a=y(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),T(s,l),w(u,s,null),T(s,i),w(f,s,null),T(s,a),c=!0},p(p,$){const v={};$&2048&&(v.$$scope={dirty:$,ctx:p}),u.$set(v);const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),f.$set(k)},i(p){c||(d(u.$$.fragment,p),d(f.$$.fragment,p),c=!0)},o(p){g(u.$$.fragment,p),g(f.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(u),b(f)}}}function hf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[mf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Vr(t){let e,r,n,o,s,l,u,i;e=new Ke({props:{colorScale:t[3],limits:t[4]}});function f($){t[8]($)}let a={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(a.value=t[0]),n=new pn({props:a}),U.push(()=>z(n,"value",f)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new Mt({props:p}),U.push(()=>z(l,"value",c)),l.$on("change",t[6]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),s=O(),_(l.$$.fragment)},m($,v){w(e,$,v),m($,r,v),w(n,$,v),m($,s,v),w(l,$,v),i=!0},p($,v){const k={};!o&&v&1&&(o=!0,k.value=$[0],G(()=>o=!1)),n.$set(k);const S={};!u&&v&2&&(u=!0,S.value=$[1],G(()=>u=!1)),l.$set(S)},i($){i||(d(e.$$.fragment,$),d(n.$$.fragment,$),d(l.$$.fragment,$),i=!0)},o($){g(e.$$.fragment,$),g(n.$$.fragment,$),g(l.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(l,$)}}}function df(t){let e,r,n,o,s,l,u,i;function f(p){t[7](p)}let a={id:ot,$$slots:{right:[hf],default:[cf]},$$scope:{ctx:t}};t[2]!==void 0&&(a.checked=t[2]),e=new te({props:a}),U.push(()=>z(e,"checked",f));let c=t[2]&&Vr(t);return s=new J({props:{layer:ot,tooltip:t[5],show:t[2]&&t[0]==ot,clickable:!1}}),u=new J({props:{layer:Et,tooltip:t[5],show:t[2]&&t[0]==Et,clickable:!1}}),{c(){_(e.$$.fragment),n=O(),c&&c.c(),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(u,p,$),i=!0},p(p,[$]){const v={};$&2048&&(v.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,v.checked=p[2],G(()=>r=!1)),e.$set(v),p[2]?c?(c.p(p,$),$&4&&d(c,1)):(c=Vr(p),c.c(),d(c,1),c.m(o.parentNode,o)):c&&(fe(),g(c,1,1,()=>{c=null}),ue());const k={};$&5&&(k.show=p[2]&&p[0]==ot),s.$set(k);const S={};$&5&&(S.show=p[2]&&p[0]==Et),u.$set(S)},i(p){i||(d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(u.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(u.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(l)),b(e,p),c&&c.d(p),b(s,p),b(u,p)}}}let ot="pct_commute",Et="pct_school";function gf(t,e,r){let n;X(t,re,v=>r(10,n=v));let o=W.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=ot,u="baseline";for(let v of[ot,Et])ae(n,v,`${se()}/v1/${v}.pmtiles`),_e(n,{id:v,source:v,sourceLayer:v,color:Ve(["get",u],s,o),width:jt,opacity:ce(.5,1)});let i=!1;function f(v){let k=v.properties.baseline,S=v.properties.gov_target,L=v.properties.go_dutch,E=`<h2>Trip purpose: ${l==ot?"commuting":"school"}</h2>`;if(E+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)E+=`<p>Government target (2025): <b>${S.toLocaleString()}</b></p>`,E+=`<p>Go Dutch: <b>${L.toLocaleString()}</b></p>`;else{let F=(S/k).toFixed(1),C=(L/k).toFixed(1);E+=`<p>Government target (2025): ${S.toLocaleString()} (<b>${F}x</b> of baseline)</p>`,E+=`<p>Go Dutch: ${L.toLocaleString()} (<b>${C}x</b> of baseline)</p>`}return E}function a(){n.setPaintProperty(l,"line-color",Ve(["get",u],s,o))}function c(v){i=v,r(2,i)}function p(v){l=v,r(0,l)}function $(v){u=v,r(1,u)}return[l,u,i,o,s,f,a,c,p,$]}class _f extends V{constructor(e){super(),q(this,e,gf,df,K,{})}}function wf(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function bf(t){let e;return{c(){e=y("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function vf(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yf(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[bf]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[vf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function kf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[yf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Sf(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:et,$$slots:{right:[kf],default:[wf]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:et,tooltip:Cf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const et="railway_stations";function Cf(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function Lf(t,e,r){let n;X(t,re,i=>r(3,n=i));const o=`${se()}/v1/${et}.geojson`;let s=!1;ir(n,et,o);let l=W[et];dt(n,{id:et,source:et,color:l,radius:eo/2});function u(i){s=i,r(0,s)}return[s,l,u]}class Of extends V{constructor(e){super(),q(this,e,Lf,Sf,K,{})}}function Tf(t){let e;return{c(){e=y("OS Speeds")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Af(t){let e;return{c(){e=y("Basemap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Df(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ef(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[Af]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Df]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=y(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=O(),l=D("p"),l.textContent="Data valid as of 1 September, 2023",u=O(),i=D("p"),f=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(a.$$.fragment),c=y(".")},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),m($,s,v),m($,l,v),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&256&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&256&&(S.$$scope={dirty:v,ctx:$}),a.$set(S)},i($){p||(d(n.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(s),h(l),h(u),h(i)),b(n),b(a)}}}function Pf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ef]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function qr(t){let e,r,n,o,s;e=new Ke({props:{colorScale:t[2],limits:t[3]}});function l(i){t[6](i)}let u={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(u.value=t[0]),n=new pn({props:u}),U.push(()=>z(n,"value",l)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),s=!0},p(i,f){const a={};!o&&f&1&&(o=!0,a.value=i[0],G(()=>o=!1)),n.$set(a)},i(i){s||(d(e.$$.fragment,i),d(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(e,i),b(n,i)}}}function Mf(t){let e,r,n,o,s,l;function u(a){t[5](a)}let i={id:ze,$$slots:{right:[Pf],default:[Tf]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[1]&&qr(t);return s=new J({props:{layer:ze,tooltip:Nf,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:a}),!r&&c&2&&(r=!0,p.checked=a[1],G(()=>r=!1)),e.$set(p),a[1]?f?(f.p(a,c),c&2&&d(f,1)):(f=qr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&2&&($.show=a[1]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let ze="road_speeds";function Nf(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function If(t,e,r){let n;X(t,re,c=>r(7,n=c));let o=W.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";ae(n,ze,`${lr()}/v1/${ze}.pmtiles`),_e(n,{id:ze,source:ze,sourceLayer:ze,color:Ve(["get",l],s,o),width:jt,opacity:ce(.5,1)});let u=!1;function i(){n.setPaintProperty(ze,"line-color",Ve(["get",l],s,o))}function f(c){u=c,r(1,u)}function a(c){l=c,r(0,l)}return[l,u,o,s,i,f,a]}class Ff extends V{constructor(e){super(),q(this,e,If,Mf,K,{})}}function xf(t){let e;return{c(){e=y("OS Road widths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bf(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function jf(t){let e,r,n,o,s,l,u,i,f;return u=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Bf]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=O(),n=D("p"),n.textContent="Data valid as of 1 September, 2023",o=O(),s=D("p"),l=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),i=y(".")},m(a,c){m(a,e,c),m(a,r,c),m(a,n,c),m(a,o,c),m(a,s,c),T(s,l),w(u,s,null),T(s,i),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),u.$set(p)},i(a){f||(d(u.$$.fragment,a),f=!0)},o(a){g(u.$$.fragment,a),f=!1},d(a){a&&(h(e),h(r),h(n),h(o),h(s)),b(u)}}}function Rf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[jf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kr(t){let e,r;return e=new Ke({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Uf(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:tt,$$slots:{right:[Rf],default:[xf]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&Kr(t);return s=new J({props:{layer:tt,tooltip:Hf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Kr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let tt="road_widths";function Hf(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function Wf(t,e,r){let n;X(t,re,i=>r(4,n=i));let o=W.sequential_low_to_high,s=[0,5,10,15,20,100];ae(n,tt,`${lr()}/v1/${tt}.pmtiles`),_e(n,{id:tt,source:tt,sourceLayer:tt,color:Ve(["get","average"],s,o),width:jt,opacity:ce(.5,1)});let l=!1;function u(i){l=i,r(0,l)}return[l,o,s,u]}class zf extends V{constructor(e){super(),q(this,e,Wf,Uf,K,{})}}function Gf(t){let e;return{c(){e=y("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vf(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function qf(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Gf]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Vf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Kf(t){let e,r;return e=new fr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[qf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Zf extends V{constructor(e){super(),q(this,e,null,Kf,K,{})}}function Xf(t){let e;return{c(){e=y("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yf(t){let e;return{c(){e=y("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Jf(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qf(t){let e,r,n,o,s,l,u,i,f,a,c;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[Xf]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Yf]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Jf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(" and "),_(s.$$.fragment),l=y(" data from OpenStreetMap (as of 9 August 2023)."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment)},m(p,$){m(p,e,$),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m(p,u,$),m(p,i,$),T(i,f),w(a,i,null),c=!0},p(p,$){const v={};$&1&&(v.$$scope={dirty:$,ctx:p}),n.$set(v);const k={};$&1&&(k.$$scope={dirty:$,ctx:p}),s.$set(k);const S={};$&1&&(S.$$scope={dirty:$,ctx:p}),a.$set(S)},i(p){c||(d(n.$$.fragment,p),d(s.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function eu(t){let e,r;return e=new fr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Qf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class tu extends V{constructor(e){super(),q(this,e,null,eu,K,{})}}function ru(t){let e;return{c(){e=y("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nu(t){let e;return{c(){e=y(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ou(t){let e;return{c(){e=y("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function su(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function iu(t){let e,r,n,o,s,l,u,i,f,a,c,p,$;return n=new B({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[nu]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[ou]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[su]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=y(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),l=y(" for details and caveats about the measurements."),u=O(),i=D("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=O(),a=D("p"),c=y("License: "),_(p.$$.fragment)},m(v,k){m(v,e,k),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m(v,u,k),m(v,i,k),m(v,f,k),m(v,a,k),T(a,c),w(p,a,null),$=!0},p(v,k){const S={};k&64&&(S.$$scope={dirty:k,ctx:v}),n.$set(S);const L={};k&64&&(L.$$scope={dirty:k,ctx:v}),s.$set(L);const E={};k&64&&(E.$$scope={dirty:k,ctx:v}),p.$set(E)},i(v){$||(d(n.$$.fragment,v),d(s.$$.fragment,v),d(p.$$.fragment,v),$=!0)},o(v){g(n.$$.fragment,v),g(s.$$.fragment,v),g(p.$$.fragment,v),$=!1},d(v){v&&(h(e),h(u),h(i),h(f),h(a)),b(n),b(s),b(p)}}}function lu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[iu]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Zr(t){let e,r;return e=new Ke({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function au(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:rt,$$slots:{right:[lu],default:[ru]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&Zr(t);return s=new J({props:{layer:rt,tooltip:fu,show:t[0],clickable:!0}}),s.$on("click",uu),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Zr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let rt="vehicle_counts";function fu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function uu(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function cu(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=W.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];ae(n,rt,`${se()}/v1/${rt}.pmtiles`),dt(n,{id:rt,source:rt,sourceLayer:rt,color:Ve(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let u=!1;function i(f){u=f,r(0,u)}return[u,o,l,i]}class pu extends V{constructor(e){super(),q(this,e,cu,au,K,{})}}function $u(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function mu(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function hu(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function du(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[mu]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[hu]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment),f=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const v={};p&32&&(v.$$scope={dirty:p,ctx:c}),i.$set(v)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function gu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[du]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function _u(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Pe,$$slots:{right:[gu],default:[$u]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Pe,tooltip:wu,show:t[0],clickable:!0}}),o.$on("click",bu),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Pe="wards";function wu(t){return`<p>${t.properties.name}</p>`}function bu(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function vu(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.wards,s=`${Pe}-outline`;ae(n,Pe,`${se()}/v1/${Pe}.pmtiles`),qe(n,{id:Pe,source:Pe,sourceLayer:Pe,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:Pe,sourceLayer:Pe,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class yu extends V{constructor(e){super(),q(this,e,vu,_u,K,{})}}function ku(t){let e,r,n,o,s,l,u,i;return e=new Zf({}),n=new ca({}),s=new tu({}),u=new Of({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment)},m(f,a){w(e,f,a),m(f,r,a),w(n,f,a),m(f,o,a),w(s,f,a),m(f,l,a),w(u,f,a),i=!0},i(f){i||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),d(u.$$.fragment,f),i=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),g(u.$$.fragment,f),i=!1},d(f){f&&(h(r),h(o),h(l)),b(e,f),b(n,f),b(s,f),b(u,f)}}}function Su(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[ku]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Cu(t){let e,r,n,o,s,l,u,i,f,a;return e=new ta({}),n=new Qa({}),s=new Ri({}),u=new Vl({}),f=new xl({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(u,c,p),m(c,i,p),w(f,c,p),a=!0},i(c){a||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),a=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),a=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function Lu(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[Cu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ou(t){let e,r,n,o,s,l,u,i,f,a;return e=new uf({}),n=new yu({}),s=new bl({}),u=new Ea({}),f=new za({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(u,c,p),m(c,i,p),w(f,c,p),a=!0},i(c){a||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),a=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),a=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function Tu(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[Ou]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Au(t){let e,r,n,o;return e=new ul({}),n=new va({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Du(t){let e,r,n,o;return e=new zf({}),n=new Ff({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Eu(t){let e,r,n,o,s=sr()=="Private (development)",l,u;e=new pu({}),n=new _f({});let i=s&&Du();return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),i&&i.c(),l=Bt()},m(f,a){w(e,f,a),m(f,r,a),w(n,f,a),m(f,o,a),i&&i.m(f,a),m(f,l,a),u=!0},p:Q,i(f){u||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(i),u=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(i),u=!1},d(f){f&&(h(r),h(o),h(l)),b(e,f),b(n,f),i&&i.d(f)}}}function Pu(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v,k,S,L;e=new Tl({}),n=new xe({props:{label:"Trip generators",$$slots:{default:[Su]},$$scope:{ctx:t}}}),s=new xe({props:{label:"Existing infrastructure",$$slots:{default:[Lu]},$$scope:{ctx:t}}}),u=new xe({props:{label:"Boundaries",$$slots:{default:[Tu]},$$scope:{ctx:t}}}),f=new xe({props:{label:"Census",$$slots:{default:[Au]},$$scope:{ctx:t}}}),c=new xe({props:{label:"Other",$$slots:{default:[Eu]},$$scope:{ctx:t}}});function E(C){t[5](C)}let F={displayEnableButton:!0};return t[2]!==void 0&&(F.isInactive=t[2]),$=new to({props:F}),t[4]($),U.push(()=>z($,"isInactive",E)),S=new so({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),a=O(),_(c.$$.fragment),p=O(),_($.$$.fragment),k=O(),_(S.$$.fragment)},m(C,A){w(e,C,A),m(C,r,A),w(n,C,A),m(C,o,A),w(s,C,A),m(C,l,A),w(u,C,A),m(C,i,A),w(f,C,A),m(C,a,A),w(c,C,A),m(C,p,A),w($,C,A),m(C,k,A),w(S,C,A),L=!0},p(C,A){const x={};A&64&&(x.$$scope={dirty:A,ctx:C}),n.$set(x);const I={};A&64&&(I.$$scope={dirty:A,ctx:C}),s.$set(I);const P={};A&64&&(P.$$scope={dirty:A,ctx:C}),u.$set(P);const M={};A&64&&(M.$$scope={dirty:A,ctx:C}),f.$set(M);const N={};A&64&&(N.$$scope={dirty:A,ctx:C}),c.$set(N);const j={};!v&&A&4&&(v=!0,j.isInactive=C[2],G(()=>v=!1)),$.$set(j);const ee={};A&1&&(ee.style=C[0]),S.$set(ee)},i(C){L||(d(e.$$.fragment,C),d(n.$$.fragment,C),d(s.$$.fragment,C),d(u.$$.fragment,C),d(f.$$.fragment,C),d(c.$$.fragment,C),d($.$$.fragment,C),d(S.$$.fragment,C),L=!0)},o(C){g(e.$$.fragment,C),g(n.$$.fragment,C),g(s.$$.fragment,C),g(u.$$.fragment,C),g(f.$$.fragment,C),g(c.$$.fragment,C),g($.$$.fragment,C),g(S.$$.fragment,C),L=!1},d(C){C&&(h(r),h(o),h(l),h(i),h(a),h(p),h(k)),b(e,C),b(n,C),b(s,C),b(u,C),b(f,C),b(c,C),t[4](null),b($,C),b(S,C)}}}function Mu(t){let e,r,n,o;return e=new xe({props:{label:"Layers",open:!0,$$slots:{default:[Pu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,l){w(e,s,l),r=!0,n||(o=Ft(window,"keydown",t[3]),n=!0)},p(s,[l]){const u={};l&71&&(u.$$scope={dirty:l,ctx:s}),e.$set(u)},i(s){r||(d(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function Nu(t,e,r){let n;X(t,hr,f=>r(2,n=f));let{style:o}=e,s;function l(f){!n&&f.key=="Escape"&&(s.disableStreetView(),f.preventDefault())}function u(f){U[f?"unshift":"push"](()=>{s=f,r(1,s)})}function i(f){n=f,hr.set(n)}return t.$$set=f=>{"style"in f&&r(0,o=f.style)},[o,s,n,l,u,i]}class Iu extends V{constructor(e){super(),q(this,e,Nu,Mu,K,{style:0})}}function Fu(t,e,r){let{loadFile:n}=e;return xt(async()=>{let s=await(await fetch(`${lr()}/v1/random_schemes.geojson`)).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class xu extends V{constructor(e){super(),q(this,e,Fu,null,K,{loadFile:0})}}function Bu(t){let e;return{c(){e=y("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ju(t){let e;return{c(){e=y("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ru(t){let e,r,n=t[0].authority_or_region+"",o,s,l,u,i=t[0].capital_scheme_id+"",f,a,c,p,$=t[0].funding_programme+"",v,k,S,L,E,F,C;return L=new Zt({props:{$$slots:{default:[Bu]},$$scope:{ctx:t}}}),L.$on("click",t[3]),F=new Zt({props:{disabled:t[1],title:t[2],$$slots:{default:[ju]},$$scope:{ctx:t}}}),F.$on("click",t[4]),{c(){e=D("p"),r=y("Authority or region: "),o=y(n),s=O(),l=D("p"),u=y("Capital scheme ID: "),f=y(i),a=O(),c=D("p"),p=y("Funding programme: "),v=y($),k=O(),S=D("div"),_(L.$$.fragment),E=O(),_(F.$$.fragment),R(S,"class","govuk-button-group")},m(A,x){m(A,e,x),T(e,r),T(e,o),m(A,s,x),m(A,l,x),T(l,u),T(l,f),m(A,a,x),m(A,c,x),T(c,p),T(c,v),m(A,k,x),m(A,S,x),w(L,S,null),T(S,E),w(F,S,null),C=!0},p(A,x){(!C||x&1)&&n!==(n=A[0].authority_or_region+"")&&Oe(o,n),(!C||x&1)&&i!==(i=A[0].capital_scheme_id+"")&&Oe(f,i),(!C||x&1)&&$!==($=A[0].funding_programme+"")&&Oe(v,$);const I={};x&256&&(I.$$scope={dirty:x,ctx:A}),L.$set(I);const P={};x&256&&(P.$$scope={dirty:x,ctx:A}),F.$set(P)},i(A){C||(d(L.$$.fragment,A),d(F.$$.fragment,A),C=!0)},o(A){g(L.$$.fragment,A),g(F.$$.fragment,A),C=!1},d(A){A&&(h(e),h(s),h(l),h(a),h(c),h(k),h(S)),b(L),b(F)}}}function Uu(t){let e,r;return e=new xe({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Ru]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Hu(t,e,r){let n,o;X(t,ht,c=>r(6,n=c)),X(t,re,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,u=!l.has(s.authority_or_region),i=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(Xn(c),{padding:20,animate:!1})}function a(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,u,i,f,a,l]}class Wu extends V{constructor(e){super(),q(this,e,Hu,Uu,K,{scheme:0,authorityNames:5})}}const zu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var le=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{u(r.next(i))}catch(f){o(f)}},l=i=>{try{u(r.throw(i))}catch(f){o(f)}},u=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);u((r=r.apply(t,e)).next())}),ge=Uint8Array,$t=Uint16Array,Gu=Int32Array,Pn=new ge([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Mn=new ge([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Vu=new ge([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Nn=function(t,e){for(var r=new $t(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new Gu(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},In=Nn(Pn,2),Fn=In.b,qu=In.r;Fn[28]=258,qu[258]=28;var Ku=Nn(Mn,0),Zu=Ku.b,nr=new $t(32768);for(Z=0;Z<32768;++Z)Fe=(Z&43690)>>1|(Z&21845)<<1,Fe=(Fe&52428)>>2|(Fe&13107)<<2,Fe=(Fe&61680)>>4|(Fe&3855)<<4,nr[Z]=((Fe&65280)>>8|(Fe&255)<<8)>>1;var Fe,Z,yt=function(t,e,r){for(var n=t.length,o=0,s=new $t(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new $t(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var u;if(r){u=new $t(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)u[nr[c]>>i]=f}else for(u=new $t(n),o=0;o<n;++o)t[o]&&(u[o]=nr[l[t[o]-1]++]>>15-t[o]);return u},Tt=new ge(288);for(Z=0;Z<144;++Z)Tt[Z]=8;var Z;for(Z=144;Z<256;++Z)Tt[Z]=9;var Z;for(Z=256;Z<280;++Z)Tt[Z]=7;var Z;for(Z=280;Z<288;++Z)Tt[Z]=8;var Z,xn=new ge(32);for(Z=0;Z<32;++Z)xn[Z]=5;var Z,Xu=yt(Tt,9,1),Yu=yt(xn,5,1),qt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ke=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Kt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Ju=function(t){return(t+7)/8|0},Qu=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new ge(r-e);return n.set(t.subarray(e,r)),n},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],me=function(t,e,r){var n=new Error(e||ec[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,me),!r)throw n;return n},ur=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new ge(0);var l=!r||e.i!=2,u=e.i;r||(r=new ge(o*3));var i=function(cr){var pr=r.length;if(cr>pr){var $r=new ge(Math.max(pr*2,cr));$r.set(r),r=$r}},f=e.f||0,a=e.p||0,c=e.b||0,p=e.l,$=e.d,v=e.m,k=e.n,S=o*8;do{if(!p){f=ke(t,a,1);var L=ke(t,a+1,3);if(a+=3,L)if(L==1)p=Xu,$=Yu,v=9,k=5;else if(L==2){var A=ke(t,a,31)+257,x=ke(t,a+10,15)+4,I=A+ke(t,a+5,31)+1;a+=14;for(var P=new ge(I),M=new ge(19),N=0;N<x;++N)M[Vu[N]]=ke(t,a+N*3,7);a+=x*3;for(var j=qt(M),ee=(1<<j)-1,H=yt(M,j,1),N=0;N<I;){var pe=H[ke(t,a,ee)];a+=pe&15;var E=pe>>4;if(E<16)P[N++]=E;else{var be=0,oe=0;for(E==16?(oe=3+ke(t,a,3),a+=2,be=P[N-1]):E==17?(oe=3+ke(t,a,7),a+=3):E==18&&(oe=11+ke(t,a,127),a+=7);oe--;)P[N++]=be}}var Ze=P.subarray(0,A),$e=P.subarray(A);v=qt(Ze),k=qt($e),p=yt(Ze,v,1),$=yt($e,k,1)}else me(1);else{var E=Ju(a)+4,F=t[E-4]|t[E-3]<<8,C=E+F;if(C>o){u&&me(0);break}l&&i(c+F),r.set(t.subarray(E,C),c),e.b=c+=F,e.p=a=C*8,e.f=f;continue}if(a>S){u&&me(0);break}}l&&i(c+131072);for(var gt=(1<<v)-1,je=(1<<k)-1,it=a;;it=a){var be=p[Kt(t,a)&gt],ve=be>>4;if(a+=be&15,a>S){u&&me(0);break}if(be||me(2),ve<256)r[c++]=ve;else if(ve==256){it=a,p=null;break}else{var lt=ve-254;if(ve>264){var N=ve-257,Ie=Pn[N];lt=ke(t,a,(1<<Ie)-1)+Fn[N],a+=Ie}var at=$[Kt(t,a)&je],ft=at>>4;at||me(3),a+=at&15;var $e=Zu[ft];if(ft>3){var Ie=Mn[ft];$e+=Kt(t,a)&(1<<Ie)-1,a+=Ie}if(a>S){u&&me(0);break}l&&i(c+131072);var ut=c+lt;if(c<$e){var _t=s-$e,Gn=Math.min($e,ut);for(_t+c<0&&me(3);c<Gn;++c)r[c]=n[_t+c]}for(;c<ut;c+=4)r[c]=r[c-$e],r[c+1]=r[c+1-$e],r[c+2]=r[c+2-$e],r[c+3]=r[c+3-$e];c=ut}}e.l=p,e.p=it,e.b=c,e.f=f,p&&(f=1,e.m=v,e.d=$,e.n=k)}while(!f);return c==r.length?r:Qu(r,0,c)},tc=new ge(0),rc=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&me(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},nc=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},oc=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&me(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&me(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function sc(t,e){return ur(t,{i:2},e&&e.out,e&&e.dictionary)}function ic(t,e){var r=rc(t);return r+8>t.length&&me(6,"invalid gzip data"),ur(t.subarray(r,-8),{i:2},e&&e.out||new ge(nc(t)),e&&e.dictionary)}function lc(t,e){return ur(t.subarray(oc(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function or(t,e){return t[0]==31&&t[1]==139&&t[2]==8?ic(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?sc(t,e):lc(t,e)}var ac=typeof TextDecoder<"u"&&new TextDecoder,fc=0;try{ac.decode(tc,{stream:!0}),fc=1}catch{}var Bn=(t,e)=>t*Math.pow(2,e),wt=(t,e)=>Math.floor(t/Math.pow(2,e)),It=(t,e)=>Bn(t.getUint16(e+1,!0),8)+t.getUint8(e),jn=(t,e)=>Bn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),uc=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=It(n,o+1);if(e!=s)return e-s;const l=It(n,o+4);return r!=l?r-l:0},cc=(t,e,r,n)=>{const o=Rn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Xr=(t,e,r,n)=>{const o=Rn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},Rn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,u=uc(e,r,n,t,l*17);if(u>0)o=l+1;else if(u<0)s=l-1;else return[jn(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},pc=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,Un=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:It(t,e*17+1),y:It(t,e*17+4),offset:jn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Yr=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(Un(r,n));return $c(e)},$c=t=>{t.sort(pc);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=wt(o.offset,8)&255,r[n*17+9]=wt(o.offset,16)&255,r[n*17+10]=wt(o.offset,24)&255,r[n*17+11]=wt(o.offset,32)&255,r[n*17+12]=wt(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},mc=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=Un(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),u=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:u}}return null};function hc(t){return le(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let u=0;l.compression==="gzip"&&(u=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let f=0;"maxzoom"in l&&(f=+l.maxzoom);let a=0,c=0,p=0,$=-180,v=-85,k=180,S=85;if(l.bounds){const E=l.bounds.split(",");$=+E[0],v=+E[1],k=+E[2],S=+E[3]}if(l.center){const E=l.center.split(",");a=+E[0],c=+E[1],p=+E[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:i,maxZoom:f,minLon:$,minLat:v,maxLon:k,maxLat:S,centerZoom:p,centerLon:a,centerLat:c,etag:e.etag}})}function dc(t,e,r,n,o,s,l){return le(this,null,function*(){let u=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(u=Yr(u));const i=Xr(new DataView(u),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=or(new Uint8Array(c))),{data:c}}const f=mc(new DataView(u),{z:n,x:o,y:s});if(f){const a=cc(new DataView(u),f.z,f.x,f.y);if(a){let c=yield r.getArrayBuffer(e,a.offset,a.length,t);t.specVersion===1&&(c=Yr(c));const p=Xr(new DataView(c),n,o,s);if(p){let v=(yield e.getBytes(p.offset,p.length,l)).data;const k=new DataView(v);return k.getUint8(0)==31&&k.getUint8(1)==139&&(v=or(new Uint8Array(v))),{data:v}}}}})}var Hn={getHeader:hc,getZxy:dc},gc=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Jr(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new Jr(o),this.tiles.set(o,s));const l=n[2],u=n[3],i=n[4],f=new AbortController,a=f.signal;let c=()=>{f.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+u,+i,a).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function ct(t,e){return(e>>>0)*4294967296+(t>>>0)}function _c(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return ct(t,n);throw new Error("Expected varint not more than 10 bytes")}function bt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,_c(r,t))}function wc(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var bc=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function vc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=bc[t],o=Math.pow(2,t);let s=0,l=0,u=0;const i=[e,r];let f=o/2;for(;f>0;)s=(i[0]&f)>0?1:0,l=(i[1]&f)>0?1:0,u+=f*f*(3*s^l),wc(f,i,s,l),f=f/2;return n+u}function Wn(t,e){return le(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return or(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var yc=127;function kc(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Sc=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return le(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const u=o.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+u.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function Se(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Cc(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:Se(r,8),rootDirectoryLength:Se(r,16),jsonMetadataOffset:Se(r,24),jsonMetadataLength:Se(r,32),leafDirectoryOffset:Se(r,40),leafDirectoryLength:Se(r,48),tileDataOffset:Se(r,56),tileDataLength:Se(r,64),numAddressedTiles:Se(r,72),numTileEntries:Se(r,80),numTileContents:Se(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function zn(t){const e={buf:new Uint8Array(t),pos:0},r=bt(e),n=[];let o=0;for(let s=0;s<r;s++){const l=bt(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=bt(e);for(let s=0;s<r;s++)n[s].length=bt(e);for(let s=0;s<r;s++){const l=bt(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function Lc(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var mt=class extends Error{};function Oc(t,e,r,n){return le(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Lc(o.data)<3)return[yield Hn.getHeader(t)];const l=o.data.slice(0,yc);let u=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),u=void 0);const i=Cc(l,u);if(r){const f=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),a=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=zn(yield e(f,i.internalCompression));return[i,[a,c.length,c]]}return[i,void 0]})}function Tc(t,e,r,n,o){return le(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new mt(s.etag);const l=yield e(s.data,o.internalCompression),u=zn(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Ac=class{constructor(t=100,e=!0,r=Wn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return le(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{Oc(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return le(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,u)=>{Tc(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return le(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,u)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new mt(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return le(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Jr=class{constructor(t,e,r){typeof t=="string"?this.source=new Sc(t):this.source=t,r?this.decompress=r:this.decompress=Wn,e?this.cache=e:this.cache=new Ac}getHeader(){return le(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return le(this,null,function*(){const o=vc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Hn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,u=s.rootDirectoryLength;for(let i=0;i<=3;i++){const f=yield this.cache.getDirectory(this.source,l,u,s),a=kc(f,o);if(a)if(a.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+a.offset,a.length,n);if(s.etag&&s.etag!==c.etag)throw new mt(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+a.offset,u=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return le(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof mt)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return le(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new mt(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return le(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof mt)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Dc(t){return xt(()=>{let e=new gc;dr.addProtocol("pmtiles",e.tile)}),$n(()=>{dr.removeProtocol("pmtiles")}),[]}class Ec extends V{constructor(e){super(),q(this,e,Dc,null,K,{})}}function Qr(t,e,r){const n=t.slice();return n[13]=e[r],n}function Pc(t){let e,r;return e=new xu({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function en(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let u={schemes:t[1]};return t[2]!==void 0&&(u.schemesToBeShown=t[2]),t[3]!==void 0&&(u.filterText=t[3]),e=new Ei({props:u}),U.push(()=>z(e,"schemesToBeShown",s)),U.push(()=>z(e,"filterText",l)),{c(){_(e.$$.fragment)},m(i,f){w(e,i,f),o=!0},p(i,f){const a={};f&2&&(a.schemes=i[1]),!r&&f&4&&(r=!0,a.schemesToBeShown=i[2],G(()=>r=!1)),!n&&f&8&&(n=!0,a.filterText=i[3],G(()=>n=!1)),e.$set(a)},i(i){o||(d(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function tn(t){let e,r;return e=new Wu({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function rn(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&tn(t);return{c(){o&&o.c(),r=Bt()},m(s,l){o&&o.m(s,l),m(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&d(o,1)):(o=tn(s),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(fe(),g(o,1,1,()=>{o=null}),ue())},i(s){n||(d(o),n=!0)},o(s){g(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function Mc(t){let e,r,n,o,s,l,u,i,f,a,c=sr()=="Private (development)",p,$,v,k,S,L,E,F;s=new io({props:{boundaryGeojson:t[4]}}),u=new _o({}),f=new Yn({});let C=c&&Pc(t);$=new ao({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),k=new cn({props:{errorMessage:t[0]}});let A=t[1].size>0&&en(t),x=Ge(t[1].values()),I=[];for(let M=0;M<x.length;M+=1)I[M]=rn(Qr(t,x,M));const P=M=>g(I[M],1,1,()=>{I[M]=null});return{c(){e=D("div"),r=D("div"),n=D("h1"),n.textContent="Browse schemes",o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),a=O(),C&&C.c(),p=O(),_($.$$.fragment),v=O(),_(k.$$.fragment),S=O(),A&&A.c(),L=O(),E=D("ul");for(let M=0;M<I.length;M+=1)I[M].c();Be(r,"display","flex"),Be(r,"justify-content","space-between"),R(e,"slot","sidebar"),R(e,"class","govuk-prose")},m(M,N){m(M,e,N),T(e,r),T(r,n),T(r,o),w(s,r,null),T(e,l),w(u,e,null),T(e,i),w(f,e,null),T(e,a),C&&C.m(e,null),T(e,p),w($,e,null),T(e,v),w(k,e,null),T(e,S),A&&A.m(e,null),T(e,L),T(e,E);for(let j=0;j<I.length;j+=1)I[j]&&I[j].m(E,null);F=!0},p(M,N){const j={};N&16&&(j.boundaryGeojson=M[4]),s.$set(j),c&&C.p(M,N);const ee={};if(N&1&&(ee.errorMessage=M[0]),k.$set(ee),M[1].size>0?A?(A.p(M,N),N&2&&d(A,1)):(A=en(M),A.c(),d(A,1),A.m(e,L)):A&&(fe(),g(A,1,1,()=>{A=null}),ue()),N&38){x=Ge(M[1].values());let H;for(H=0;H<x.length;H+=1){const pe=Qr(M,x,H);I[H]?(I[H].p(pe,N),d(I[H],1)):(I[H]=rn(pe),I[H].c(),d(I[H],1),I[H].m(E,null))}for(fe(),H=x.length;H<I.length;H+=1)P(H);ue()}},i(M){if(!F){d(s.$$.fragment,M),d(u.$$.fragment,M),d(f.$$.fragment,M),d(C),d($.$$.fragment,M),d(k.$$.fragment,M),d(A);for(let N=0;N<x.length;N+=1)d(I[N]);F=!0}},o(M){g(s.$$.fragment,M),g(u.$$.fragment,M),g(f.$$.fragment,M),g(C),g($.$$.fragment,M),g(k.$$.fragment,M),g(A),I=I.filter(Boolean);for(let N=0;N<I.length;N+=1)g(I[N]);F=!1},d(M){M&&h(e),b(s),b(u),b(f),C&&C.d(),b($),b(k),A&&A.d(),Pt(I,M)}}}function Nc(t){let e,r,n,o,s,l,u,i,f,a,c;return e=new lo({props:{colorInterventions:mn("v1")}}),n=new J({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new J({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),u=new J({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),a=new Iu({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),f=D("div"),_(a.$$.fragment),R(f,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(u,p,$),m(p,i,$),m(p,f,$),w(a,f,null),c=!0},p:Q,i(p){c||(d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(l),h(i),h(f)),b(e,p),b(n,p),b(s,p),b(u,p),b(a)}}}function Ic(t){let e,r,n,o,s;return r=new Ec({}),o=new no({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Nc]},$$scope:{ctx:t}}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),_(o.$$.fragment),R(e,"slot","main")},m(l,u){m(l,e,u),w(r,e,null),T(e,n),w(o,e,null),s=!0},p(l,u){const i={};u&65536&&(i.$$scope={dirty:u,ctx:l}),o.$set(i)},i(l){s||(d(r.$$.fragment,l),d(o.$$.fragment,l),s=!0)},o(l){g(r.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&h(e),b(r),b(o)}}}function Fc(t){let e,r;return e=new ro({props:{$$slots:{main:[Ic],sidebar:[Mc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function xc(t,e,r){let n;X(t,ht,S=>r(4,n=S));let o=new Set(zu);xt(()=>{Jn()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",u="",i=new Map,f=new Set,a="";$n(()=>{ht.set(un())});function c(S){try{let L=JSON.parse(S);r(1,i=wi(L)),ht.set(L),r(0,u="")}catch(L){r(0,u=`The file you loaded is broken: ${L}`)}}function p(S){let L=S.properties;var E='<div style="max-width: 30vw;">';return E+=`<h2>${$(L.name)} (${L.intervention_type})</h2>`,E+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(E+=`<p>Length: ${Qn(L.length_meters)}</p>`),L.description&&(E+=`<p>${$(L.description)}</p>`),E+="</div>",E}function $(S){return a?S.replace(new RegExp(a,"gi"),L=>`<mark>${L}</mark>`):S}function v(S){f=S,r(2,f)}function k(S){a=S,r(3,a)}return[u,i,f,a,n,o,l,c,p,v,k]}class Bc extends V{constructor(e){super(),q(this,e,xc,Fc,K,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Bc({target:document.getElementById("app")});
