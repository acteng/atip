import{S as U,i as H,s as W,M as Zn,b as R,c as q,e as M,d as A,g as _,ax as Xn,h as j,j as m,k as E,m as w,w as xt,l as K,t as d,n as g,p as h,q as b,aJ as ln,aK as an,aL as fn,aM as un,u as v,f as lr,x as J,an as Yn,N as X,C as re,ap as cn,T as dt,r as jt,F as pn,a as Yt,v as dr,I as Te,aR as x,az as Ge,ao as xe,aA as Nt,y as ae,o as fe,aS as le,Q as Ke,G as ue,Y as ge,aT as qe,aU as oe,P as ar,a2 as Rt,R as $n,aV as fr,aW as Jn,_ as mn,Z as gt,E as hn,aX as gr,D as Qn,aY as _r,a5 as dn,aQ as wr,L as eo,z as to,aG as ro}from"./index-8a931a8e.js";import{e as It,C as Be,b as Ct,d as te,a as no,S as oo,B as so,L as io,M as lo}from"./StreetViewController-b319f81a.js";import{L as ao,d as br,c as gn,C as _e,Z as fo,I as uo}from"./schemas-02c7b9b0.js";import{I as Q}from"./InteractiveLayer-f17793d1.js";import{F as co}from"./FileInput-779cd7c1.js";const po="/atip/bluesky_v2/assets/help-d011708a.svg";function $o(t){let e,r;const n=t[1].default,o=ln(n,t,t[4],null);return{c(){e=M("div"),o&&o.c(),j(e,"class","govuk-prose")},m(s,l){m(s,e,l),o&&o.m(e,null),r=!0},p(s,l){o&&o.p&&(!r||l&16)&&an(o,n,s,s[4],r?un(n,s[4],l,null):fn(s[4]),null)},i(s){r||(d(o,s),r=!0)},o(s){g(o,s),r=!1},d(s){s&&h(e),o&&o.d(s)}}}function mo(t){let e,r,n,o,s,l,f,i,a;function u(p){t[3](p)}let c={title:"Help",$$slots:{default:[$o]},$$scope:{ctx:t}};return t[0]!==void 0&&(c.open=t[0]),s=new Zn({props:c}),R.push(()=>q(s,"open",u)),{c(){e=M("button"),r=M("img"),o=A(),_(s.$$.fragment),Xn(r.src,n=po)||j(r,"src",n),j(r,"title","Help"),j(r,"alt","Help"),j(e,"class","svelte-7d9d1l")},m(p,$){m(p,e,$),E(e,r),m(p,o,$),w(s,p,$),f=!0,i||(a=xt(e,"click",t[2]),i=!0)},p(p,[$]){const S={};$&16&&(S.$$scope={dirty:$,ctx:p}),!l&&$&1&&(l=!0,S.open=p[0],K(()=>l=!1)),s.$set(S)},i(p){f||(d(s.$$.fragment,p),f=!0)},o(p){g(s.$$.fragment,p),f=!1},d(p){p&&(h(e),h(o)),b(s,p),i=!1,a()}}}function ho(t,e,r){let{$$slots:n={},$$scope:o}=e,s=!1;const l=()=>r(0,s=!0);function f(i){s=i,r(0,s)}return t.$$set=i=>{"$$scope"in i&&r(4,o=i.$$scope)},[s,n,l,f,o]}class ne extends U{constructor(e){super(),H(this,e,ho,mo,W,{})}}function go(t){let e;return{c(){e=M("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _o(t){let e,r,n,o,s=t[0]=="Private (development)"&&go();return{c(){s&&s.c(),e=A(),r=M("p"),r.textContent="Note the ATF scheme data has not been validated.",n=A(),o=M("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,f){s&&s.m(l,f),m(l,e,f),m(l,r,f),m(l,n,f),m(l,o,f)},p:J,d(l){l&&(h(e),h(r),h(n),h(o)),s&&s.d(l)}}}function wo(t){let e,r,n,o,s,l;return s=new ne({props:{$$slots:{default:[_o]},$$scope:{ctx:t}}}),{c(){e=M("p"),r=v("App version: "),n=v(t[0]),o=A(),_(s.$$.fragment)},m(f,i){m(f,e,i),E(e,r),E(e,n),E(e,o),w(s,e,null),l=!0},p(f,[i]){const a={};i&2&&(a.$$scope={dirty:i,ctx:f}),s.$set(a)},i(f){l||(d(s.$$.fragment,f),l=!0)},o(f){g(s.$$.fragment,f),l=!1},d(f){f&&h(e),b(s)}}}function bo(t){return[lr()]}class vo extends U{constructor(e){super(),H(this,e,bo,wo,W,{})}}const yo={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var me=Uint8Array,ot=Uint16Array,_n=Uint32Array,wn=new me([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bn=new me([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ko=new me([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vn=function(t,e){for(var r=new ot(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new _n(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},yn=vn(wn,2),kn=yn[0],So=yn[1];kn[28]=258,So[258]=28;var To=vn(bn,0),Co=To[0],Jt=new ot(32768);for(var Y=0;Y<32768;++Y){var Ue=(Y&43690)>>>1|(Y&21845)<<1;Ue=(Ue&52428)>>>2|(Ue&13107)<<2,Ue=(Ue&61680)>>>4|(Ue&3855)<<4,Jt[Y]=((Ue&65280)>>>8|(Ue&255)<<8)>>>1}var yt=function(t,e,r){for(var n=t.length,o=0,s=new ot(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new ot(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new ot(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[Jt[c]>>>i]=a}else for(f=new ot(n),o=0;o<n;++o)t[o]&&(f[o]=Jt[l[t[o]-1]++]>>>15-t[o]);return f},At=new me(288);for(var Y=0;Y<144;++Y)At[Y]=8;for(var Y=144;Y<256;++Y)At[Y]=9;for(var Y=256;Y<280;++Y)At[Y]=7;for(var Y=280;Y<288;++Y)At[Y]=8;var Sn=new me(32);for(var Y=0;Y<32;++Y)Sn[Y]=5;var Ao=yt(At,9,1),Oo=yt(Sn,5,1),Ht=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},be=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Wt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Lo=function(t){return(t+7)/8|0},ur=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?ot:t.BYTES_PER_ELEMENT==4?_n:me)(r-e);return n.set(t.subarray(e,r)),n},Do=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ke=function(t,e,r){var n=new Error(e||Do[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ke),!r)throw n;return n},Eo=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new me(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new me(n*3));var l=function(ut){var ct=e.length;if(ut>ct){var wt=new me(Math.max(ct*2,ut));wt.set(e),e=wt}},f=r.f||0,i=r.p||0,a=r.b||0,u=r.l,c=r.d,p=r.m,$=r.n,S=n*8;do{if(!u){f=be(t,i,1);var y=be(t,i+1,3);if(i+=3,y)if(y==1)u=Ao,c=Oo,p=9,$=5;else if(y==2){var I=be(t,i,31)+257,k=be(t,i+10,15)+4,L=I+be(t,i+5,31)+1;i+=14;for(var F=new me(L),D=new me(19),O=0;O<k;++O)D[ko[O]]=be(t,i+O*3,7);i+=k*3;for(var N=Ht(D),B=(1<<N)-1,z=yt(D,N,1),O=0;O<L;){var ee=z[be(t,i,B)];i+=ee&15;var T=ee>>>4;if(T<16)F[O++]=T;else{var V=0,Ce=0;for(T==16?(Ce=3+be(t,i,3),i+=2,V=F[O-1]):T==17?(Ce=3+be(t,i,7),i+=3):T==18&&(Ce=11+be(t,i,127),i+=7);Ce--;)F[O++]=V}}var Ne=F.subarray(0,I),ce=F.subarray(I);p=Ht(Ne),$=Ht(ce),u=yt(Ne,p,1),c=yt(ce,$,1)}else ke(1);else{var T=Lo(i)+4,C=t[T-4]|t[T-3]<<8,P=T+C;if(P>n){s&&ke(0);break}o&&l(a+C),e.set(t.subarray(T,P),a),r.b=a+=C,r.p=i=P*8,r.f=f;continue}if(i>S){s&&ke(0);break}}o&&l(a+131072);for(var Dt=(1<<p)-1,pe=(1<<$)-1,_t=i;;_t=i){var V=u[Wt(t,i)&Dt],Re=V>>>4;if(i+=V&15,i>S){s&&ke(0);break}if(V||ke(2),Re<256)e[a++]=Re;else if(Re==256){_t=i,u=null;break}else{var lt=Re-254;if(Re>264){var O=Re-257,we=wn[O];lt=be(t,i,(1<<we)-1)+kn[O],i+=we}var at=c[Wt(t,i)&pe],Ie=at>>>4;at||ke(3),i+=at&15;var ce=Co[Ie];if(Ie>3){var we=bn[Ie];ce+=Wt(t,i)&(1<<we)-1,i+=we}if(i>S){s&&ke(0);break}o&&l(a+131072);for(var ft=a+lt;a<ft;a+=4)e[a]=e[a-ce],e[a+1]=e[a+1-ce],e[a+2]=e[a+2-ce],e[a+3]=e[a+3-ce];a=ft}}r.l=u,r.p=_t,r.b=a,r.f=f,u&&(f=1,r.m=p,r.d=c,r.n=$)}while(!f);return a==e.length?e:ur(e,0,a)},Po=new me(0),Pe=function(t,e){return t[e]|t[e+1]<<8},Se=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},zt=function(t,e){return Se(t,e)+Se(t,e+4)*4294967296};function Mo(t,e){return Eo(t,e)}var Qt=typeof TextDecoder<"u"&&new TextDecoder,No=0;try{Qt.decode(Po,{stream:!0}),No=1}catch{}var Io=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,ur(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function Tn(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Qt)return Qt.decode(t);var o=Io(t),s=o[0],l=o[1];return l.length&&ke(8),s}}var Fo=function(t,e){return e+30+Pe(t,e+26)+Pe(t,e+28)},Bo=function(t,e,r){var n=Pe(t,e+28),o=Tn(t.subarray(e+46,e+46+n),!(Pe(t,e+8)&2048)),s=e+46+n,l=Se(t,e+20),f=r&&l==4294967295?xo(t,s):[l,Se(t,e+24),Se(t,e+42)],i=f[0],a=f[1],u=f[2];return[Pe(t,e+10),i,a,o,s+Pe(t,e+30)+Pe(t,e+32),u]},xo=function(t,e){for(;Pe(t,e)!=1;e+=4+Pe(t,e+2));return[zt(t,e+12),zt(t,e+4),zt(t,e+20)]};function jo(t,e){for(var r={},n=t.length-22;Se(t,n)!=101010256;--n)(!n||t.length-n>65558)&&ke(13);var o=Pe(t,n+8);if(!o)return{};var s=Se(t,n+16),l=s==4294967295||o==65535;if(l){var f=Se(t,n-12);l=Se(t,f)==101075792,l&&(o=Se(t,f+32),s=Se(t,f+48))}for(var i=e&&e.filter,a=0;a<o;++a){var u=Bo(t,s,l),c=u[0],p=u[1],$=u[2],S=u[3],y=u[4],T=u[5],C=Fo(t,T);s=y,(!i||i({name:S,size:p,originalSize:$,compression:c}))&&(c?c==8?r[S]=Mo(t.subarray(C,C+p),new me($)):ke(14,"unknown compression type "+c):r[S]=ur(t,C,C+p))}return r}function Ro(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Vt):Vt(t)}function Vt(t){var e=new Uint8Array(t),r=jo(e);return Promise.resolve(Uo(r))}function Uo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=Tn(t[o])}return e}function Me(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&it(n)===e)return n;r++}}function Ot(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&it(o)===e&&r.push(o),n++}return r}function Ft(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&it(o)===e&&r(o,n):r(o,n),n++}}function Ho(t,e,r){var n=[];return Ft(t,e,function(o,s){n.push(r(o,s))}),n}var Wo=/.+\:/;function it(t){return t.tagName.replace(Wo,"")}function Cn(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+it(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=Cn(t.childNodes[n]),n++;return e+="</"+it(t)+">",e}function zo(t){var e=t.documentElement,r=Me(e,"sheetData"),n=[];return Ft(r,"row",function(o){Ft(o,"c",function(s){n.push(s)})}),n}function Vo(t,e){return Me(e,"v")}function Go(t,e){if(e.firstChild&&it(e.firstChild)==="is"&&e.firstChild.firstChild&&it(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function qo(t){var e=t.documentElement,r=Me(e,"dimension");if(r)return r.getAttribute("ref")}function Ko(t){var e=t.documentElement,r=Me(e,"cellStyleXfs");return r?Ot(r,"xf"):[]}function Zo(t){var e=t.documentElement,r=Me(e,"cellXfs");return r?Ot(r,"xf"):[]}function Xo(t){var e=t.documentElement,r=Me(e,"numFmts");return r?Ot(r,"numFmt"):[]}function Yo(t){var e=t.documentElement;return Ho(e,"si",function(r){var n=Me(r,"t");if(n)return n.textContent;var o="";return Ft(r,"r",function(s){o+=Me(s,"t").textContent}),o})}function Jo(t){var e=t.documentElement;return Me(e,"workbookPr")}function Qo(t){var e=t.documentElement;return Ot(e,"Relationship")}function es(t){var e=t.documentElement,r=Me(e,"sheets");return Ot(r,"sheet")}function ts(t,e){var r=e.createDocument(t),n={},o=Jo(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(f){f.getAttribute("name")&&n.sheets.push({id:f.getAttribute("sheetId"),name:f.getAttribute("name"),relationId:f.getAttribute("r:id")})};return es(r).forEach(s),n}function rs(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var f=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=Gt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=Gt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=Gt(f);break}};return Qo(r).forEach(o),n}function Gt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function vr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function yr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vr(Object(r),!0).forEach(function(n){ns(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ns(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function os(t,e){if(!t)return{};var r=e.createDocument(t),n=Ko(r).map(qt),o=Xo(r).map(ss).reduce(function(l,f){return l[f.id]=f,l},[]),s=function(f){return f.hasAttribute("xfId")?yr(yr({},n[f.xfId]),qt(f,o)):qt(f,o)};return Zo(r).map(s)}function ss(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function qt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function is(t,e){return t?Yo(e.createDocument(t)):[]}function An(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function ls(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=as(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function as(t,e){if(t){if(typeof t=="string")return kr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kr(t,e)}}function kr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fs(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(us.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&$s(o.numberFormat.template))return!0}}var us=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],cs=/^\[\$-414\]/,ps=/;@$/;function $s(t){t=t.toLowerCase(),t=t.replace(cs,""),t=t.replace(ps,"");for(var e=t.split(/\W+/),r=ls(e),n;!(n=r()).done;){var o=n.value;if(ms.indexOf(o)<0)return!1}return!0}var ms=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function hs(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,f=r.values,i=r.properties,a=r.options;switch(e||(e="n"),e){case"str":t=Kt(t,a);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Kt(t,a);break;case"s":var u=Number(t);if(isNaN(u))throw new Error('Invalid "shared" string index: '.concat(t));if(u>=f.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=f[u],t=Kt(t,a);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=ds(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,fs(t,s(),l,a)&&(t=An(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function ds(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Kt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var gs=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function _s(t){var e=function(a,u){return a-u},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],f=n[n.length-1];return[{row:o,column:l},{row:s,column:f}]}function ws(t){for(var e=0,r=0;r<t.length;)e*=26,e+=gs.indexOf(t[r]),r++;return e}function On(t){return t=t.split(/(\d+)/),[parseInt(t[1]),ws(t[0].trim())]}function bs(t,e,r,n,o,s,l){var f=On(t.getAttribute("r")),i=Vo(e,t),a=i&&i.textContent,u;return t.hasAttribute("t")&&(u=t.getAttribute("t")),{row:f[0],column:f[1],value:hs(a,u,{getInlineStringValue:function(){return Go(e,t)},getInlineStringXml:function(){return Cn(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function vs(t,e,r,n,o,s){var l=zo(t);return l.length===0?[]:l.map(function(f){return bs(f,t,e,r,n,o,s)})}function ys(t,e){return Cs(t)||Ts(t,e)||Ss(t,e)||ks()}function ks(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ss(t,e){if(t){if(typeof t=="string")return Sr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sr(t,e)}}function Sr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ts(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function Cs(t){if(Array.isArray(t))return t}function As(t){var e=qo(t);if(e)return e=e.split(":").map(On).map(function(r){var n=ys(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function Os(t,e,r,n,o,s){var l=e.createDocument(t),f=vs(l,e,r,n,o,s),i=As(l)||_s(f);return{cells:f,dimensions:i}}function Ls(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ds(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ds(t,e){if(t){if(typeof t=="string")return Tr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tr(t,e)}}function Tr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Es(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var f=!0,i=Ls(t[l]),a;!(a=i()).done;){var u=a.value;if(o(u)!==null){f=!1;break}}if(f)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function Ps(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ms(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ms(t,e){if(t){if(typeof t=="string")return Cr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(t,e)}}function Cr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ns(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,f=Ps(t),i;!(i=f()).done;){var a=i.value;if(n(a[s])!==null){l=!1;break}}if(l)for(var u=0;u<t.length;)t[u].splice(s,1),u++;else if(o)break;s--}return t}function Is(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ln(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fs(t,e){return js(t)||xs(t,e)||Ln(t,e)||Bs()}function Bs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ln(t,e){if(t){if(typeof t=="string")return Ar(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ar(t,e)}}function Ar(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function js(t){if(Array.isArray(t))return t}function Rs(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Fs(r,2);o[0];for(var s=o[1],l=s.column,f=s.row,i=new Array(f),a=0;a<f;){i[a]=new Array(l);for(var u=0;u<l;)i[a][u]=null,u++;a++}for(var c=Is(n),p;!(p=c()).done;){var $=p.value,S=$.row-1,y=$.column-1;y<l&&S<f&&(i[S][y]=$.value)}var T=e.rowMap;if(T)for(var C=0;C<i.length;)T[C]=C,C++;return i=Es(Ns(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:T}),e.transformData&&(i=e.transformData(i)),i}function Us(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Hs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hs(t,e){if(t){if(typeof t=="string")return Or(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Or(t,e)}}function Or(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Lr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Ws(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lr(Object(r),!0).forEach(function(n){zs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=Ws({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=rs(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?is(n(o.sharedStrings),e):[],l=o.styles?os(n(o.styles),e):{},f=ts(n("xl/workbook.xml"),e);if(r.getSheets)return f.sheets.map(function(c){var p=c.name;return{name:p}});var i=Gs(r.sheet,f.sheets);if(!i||!o.sheets[i])throw qs(r.sheet,f.sheets);var a=Os(n(o.sheets[i]),e,s,l,f,r),u=Rs(a,r);return r.properties?{data:u,properties:f}:u}function Gs(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Us(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function qs(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function er(t){"@babel/helpers - typeof";return er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(t)}function Dr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ks(t,e,r){return e&&Dr(t.prototype,e),r&&Dr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&St(t,e)}function Ys(t){var e=Dn();return function(){var n=Tt(t),o;if(e){var s=Tt(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Js(this,o)}}function Js(t,e){if(e&&(er(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qs(t)}function Qs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tr(t){var e=typeof Map=="function"?new Map:void 0;return tr=function(n){if(n===null||!ei(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Pt(n,arguments,Tt(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),St(o,n)},tr(t)}function Pt(t,e,r){return Dn()?Pt=Reflect.construct:Pt=function(o,s,l){var f=[null];f.push.apply(f,s);var i=Function.bind.apply(o,f),a=new i;return l&&St(a,l.prototype),a},Pt.apply(null,arguments)}function Dn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ei(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function St(t,e){return St=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},St(t,e)}function Tt(t){return Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Tt(t)}var he=function(t){Xs(r,t);var e=Ys(r);function r(n){var o;return Zs(this,r),o=e.call(this,"invalid"),o.reason=n,o}return Ks(r)}(tr(Error));function ti(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new he("not_a_number")}if(typeof t!="number")throw new he("not_a_number");if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return t}function ri(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return String(t)}throw new he("not_a_string")}function ni(t){if(typeof t=="boolean")return t;throw new he("not_a_boolean")}function oi(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new he("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");var n=An(t,r);if(isNaN(n.valueOf()))throw new he("out_of_bounds");return n}throw new he("not_a_date")}function si(t,e){return ai(t)||li(t,e)||En(t,e)||ii()}function ii(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function li(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function ai(t){if(Array.isArray(t))return t}function rr(t){"@babel/helpers - typeof";return rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(t)}function fi(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=En(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function En(t,e){if(t){if(typeof t=="string")return Er(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Er(t,e)}}function Er(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Pr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Mr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pr(Object(r),!0).forEach(function(n){ui(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ui(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Nr={isColumnOriented:!1};function ci(t,e,r){r?r=Mr(Mr({},Nr),r):r=Nr;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;hi(e),o&&(t=mi(t));for(var f=t[0],i=[],a=[],u=1;u<t.length;u++){var c=Pn(e,t[u],u,f,a,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=fi(a),$;!($=p()).done;){var S=$.value;S.row=s[S.row-1]+1}return{rows:i,errors:a}}function Pn(t,e,r,n,o,s){for(var l={},f=!0,i=function(){var p=u[a],$=t[p],S=rr($.type)==="object"&&!Array.isArray($.type),y=e[n.indexOf(p)];y===void 0&&(y=null);var T=void 0,C=void 0,P=void 0;if(S)T=Pn($.type,e,r,n,o,s);else if(y===null)T=null;else if(Array.isArray($.type)){var I=!1,k=$i(y).map(function(F){var D=Ir(F,$,s);return D.error&&(T=F,C=D.error,P=D.reason),D.value!==null&&(I=!0),D.value});C||(T=I?k:null)}else{var L=Ir(y,$,s);C=L.error,P=L.reason,T=C?y:L.value}!C&&T===null&&$.required&&(C="required"),C?(C={error:C,row:r+1,column:p,value:T},P&&(C.reason=P),$.type&&(C.type=$.type),o.push(C)):(f&&T!==null&&(f=!1),(T!==null||s.includeNullValues)&&(l[$.prop]=T))},a=0,u=Object.keys(t);a<u.length;a++)i();return f?null:l}function Ir(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=$t(t,e.parse):e.type?n=pi(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function $t(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function pi(t,e,r){switch(e){case String:return $t(t,ri);case Number:return $t(t,ti);case Date:return $t(t,function(n){return oi(n,{properties:r.properties})});case Boolean:return $t(t,ni);default:if(typeof e=="function")return $t(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Mn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=Mn(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function $i(t){for(var e=[],r=0;r<t.length;){var n=Mn(t,",",r),o=si(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var mi=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function hi(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function nr(t){"@babel/helpers - typeof";return nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(t)}function Nn(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;nr(s)==="object"&&(s=Object.keys(t[o])[0],l=Nn(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var di=["schema","map"];function Fr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Et(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fr(Object(r),!0).forEach(function(n){gi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _i(t,e){if(t==null)return{};var r=wi(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function wi(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function bi(t,e,r){var n=r.schema,o=r.map,s=_i(r,di);!n&&o&&(n=Nn(o));var l=Vs(t,e,Et(Et({},s),{},{properties:n||s.properties}));return n?ci(l.data,n,Et(Et({},s),{},{properties:l.properties})):l}function vi(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ro(t).then(function(r){return bi(r,yo,e)})}function yi(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function ki(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await vi(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=Yn(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const G={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Ut=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function Si(t){let e,r,n,o,s;function l(i){t[3](i)}let f={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(f.value=t[0]),e=new It({props:f}),R.push(()=>q(e,"value",l)),e.$on("change",t[2]),o=new ao({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};!r&&a&1&&(r=!0,u.value=i[0],K(()=>r=!1)),e.$set(u);const c={};a&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function Ti(t,e,r){let n;X(t,re,i=>r(4,n=i));let o="interventionType",s=br("v1");function l(){let i;o=="interventionType"?(i=gn("v1"),r(1,s=br("v1"))):(i=cn(["get","funding_programme"],{ATF2:G.atf2,ATF3:G.atf3,ATF4:G.atf4},"grey"),r(1,s=[["ATF2",G.atf2],["ATF3",G.atf3],["ATF4",G.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function f(i){o=i,r(0,o)}return[o,s,l,f]}class Ci extends U{constructor(e){super(),H(this,e,Ti,Si,W,{})}}function Ai(t){let e;return{c(){e=v("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Oi(t){let e,r,n,o,s,l;return n=new Yt({props:{$$slots:{default:[Ai]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=M("input"),r=A(),_(n.$$.fragment),j(e,"type","text"),j(e,"class","govuk-input govuk-input--width-10"),j(e,"id","filterText")},m(f,i){m(f,e,i),dr(e,t[0]),m(f,r,i),w(n,f,i),o=!0,s||(l=xt(e,"input",t[12]),s=!0)},p(f,i){i&1&&e.value!==f[0]&&dr(e,f[0]);const a={};i&131072&&(a.$$scope={dirty:i,ctx:f}),n.$set(a)},i(f){o||(d(n.$$.fragment,f),o=!0)},o(f){g(n.$$.fragment,f),o=!1},d(f){f&&(h(e),h(r)),b(n,f),s=!1,l()}}}function Li(t){let e,r,n,o,s,l,f,i,a,u;function c(y){t[10](y)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new It({props:p}),R.push(()=>q(e,"value",c));function $(y){t[11](y)}let S={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(S.value=t[3]),o=new It({props:S}),R.push(()=>q(o,"value",$)),f=new pn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[Oi]},$$scope:{ctx:t}}}),a=new Ci({}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment),l=A(),_(f.$$.fragment),i=A(),_(a.$$.fragment)},m(y,T){w(e,y,T),m(y,n,T),w(o,y,T),m(y,l,T),w(f,y,T),m(y,i,T),w(a,y,T),u=!0},p(y,T){const C={};T&32&&(C.choices=y[5]),!r&&T&4&&(r=!0,C.value=y[2],K(()=>r=!1)),e.$set(C);const P={};T&64&&(P.choices=y[6]),!s&&T&8&&(s=!0,P.value=y[3],K(()=>s=!1)),o.$set(P);const I={};T&131073&&(I.$$scope={dirty:T,ctx:y}),f.$set(I)},i(y){u||(d(e.$$.fragment,y),d(o.$$.fragment,y),d(f.$$.fragment,y),d(a.$$.fragment,y),u=!0)},o(y){g(e.$$.fragment,y),g(o.$$.fragment,y),g(f.$$.fragment,y),g(a.$$.fragment,y),u=!1},d(y){y&&(h(n),h(l),h(i)),b(e,y),b(o,y),b(f,y),b(a,y)}}}function Di(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,f,i=t[7].area.toLocaleString()+"",a,u,c=t[7].crossing.toLocaleString()+"",p,$,S=t[7].other.toLocaleString()+"",y,T;return{c(){e=v("Showing "),n=v(r),o=v(" schemes ("),l=v(s),f=v(`
    routes, `),a=v(i),u=v(` areas,
    `),p=v(c),$=v(" crossings, "),y=v(S),T=v(`
    other)`)},m(C,P){m(C,e,P),m(C,n,P),m(C,o,P),m(C,l,P),m(C,f,P),m(C,a,P),m(C,u,P),m(C,p,P),m(C,$,P),m(C,y,P),m(C,T,P)},p(C,P){P&2&&r!==(r=C[1].size.toLocaleString()+"")&&Te(n,r),P&128&&s!==(s=C[7].route.toLocaleString()+"")&&Te(l,s),P&128&&i!==(i=C[7].area.toLocaleString()+"")&&Te(a,i),P&128&&c!==(c=C[7].crossing.toLocaleString()+"")&&Te(p,c),P&128&&S!==(S=C[7].other.toLocaleString()+"")&&Te(y,S)},d(C){C&&(h(e),h(n),h(o),h(l),h(f),h(a),h(u),h(p),h($),h(y),h(T))}}}function Ei(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[Di]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),R.push(()=>q(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){w(e,l,f),n=!0},p(l,f){const i={};f&131202&&(i.$$scope={dirty:f,ctx:l}),!r&&f&16&&(r=!0,i.checked=l[4],K(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function Pi(t){let e,r,n,o;return e=new Be({props:{label:"Filters",$$slots:{default:[Li]},$$scope:{ctx:t}}}),n=new Ct({props:{small:!0,$$slots:{default:[Ei]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},p(s,[l]){const f={};l&131181&&(f.$$scope={dirty:l,ctx:s}),e.$set(f);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Mi(t,e,r){let n,o;X(t,dt,k=>r(15,n=k)),X(t,re,k=>r(9,o=k));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:f=""}=e,i=[],a="",u=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;jt(()=>{let k=new Set,L=new Set;for(let F of s.values())F.authority_or_region&&k.add(F.authority_or_region),F.funding_programme&&L.add(F.funding_programme);r(5,i=Array.from(k.entries())),i.sort(),r(6,u=Array.from(L.entries())),u.sort()});function S(k,L,F){let D=k.toLowerCase(),O=B=>{var z,ee;if(D&&!((z=B.properties.name)!=null&&z.toLowerCase().includes(D))&&!((ee=B.properties.description)!=null&&ee.toLowerCase().includes(D)))return!1;if(L||F){let V=s.get(B.properties.scheme_reference);if(L&&V.authority_or_region!=L||F&&V.funding_programme!=F)return!1}return!0};r(1,l=new Set(n.features.filter(O).map(B=>B.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let N=B=>{var z,ee;return!(!l.has(B.properties.scheme_reference)||D&&!((z=B.properties.name)!=null&&z.toLowerCase().includes(D))&&!((ee=B.properties.description)!=null&&ee.toLowerCase().includes(D)))};dt.update(B=>{for(let z of B.features)N(z)?(delete z.properties.hide_while_editing,r(7,p[z.properties.intervention_type]++,p)):z.properties.hide_while_editing=!0;return B}),r(7,p)}function y(k){a=k,r(2,a)}function T(k){c=k,r(3,c)}function C(){f=this.value,r(0,f)}const P=()=>r(0,f="");function I(k){$=k,r(4,$)}return t.$$set=k=>{"schemes"in k&&r(8,s=k.schemes),"schemesToBeShown"in k&&r(1,l=k.schemesToBeShown),"filterText"in k&&r(0,f=k.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let k of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(k)&&o.setLayoutProperty(k,"visibility",$?"visible":"none");t.$$.dirty&13&&S(f,a,c)},[f,l,a,c,$,i,u,p,s,o,y,T,C,P,I]}class Ni extends U{constructor(e){super(),H(this,e,Mi,Pi,W,{schemes:8,schemesToBeShown:1,filterText:0})}}function Ii(t){let e;return{c(){e=v(`Open Government License
  `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fi(t){let e,r,n,o,s;return n=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ii]},$$scope:{ctx:t}}}),{c(){e=M("p"),r=v("License: "),_(n.$$.fragment),o=v(`. Contains OS data © Crown copyright and database right
  2023.`)},m(l,f){m(l,e,f),E(e,r),w(n,e,null),E(e,o),s=!0},p(l,[f]){const i={};f&1&&(i.$$scope={dirty:f,ctx:l}),n.$set(i)},i(l){s||(d(n.$$.fragment,l),s=!0)},o(l){g(n.$$.fragment,l),s=!1},d(l){l&&h(e),b(n)}}}class je extends U{constructor(e){super(),H(this,e,null,Fi,W,{})}}function Br(t,e,r){const n=t.slice();return n[2]=e[r],n}function xr(t,e,r){const n=t.slice();return n[5]=e[r],n}function jr(t){let e,r;return{c(){e=M("span"),r=v(` 
    `),xe(e,"background",t[5]),xe(e,"width","100%"),xe(e,"border","1px solid black")},m(n,o){m(n,e,o),E(e,r)},p(n,o){o&1&&xe(e,"background",n[5])},d(n){n&&h(e)}}}function Rr(t){let e,r=t[2]+"",n;return{c(){e=M("span"),n=v(r)},m(o,s){m(o,e,s),E(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&Te(n,r)},d(o){o&&h(e)}}}function Bi(t){let e,r,n,o=Ge(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=jr(xr(t,o,i));let l=Ge(t[1]),f=[];for(let i=0;i<l.length;i+=1)f[i]=Rr(Br(t,l,i));return{c(){e=M("div");for(let i=0;i<s.length;i+=1)s[i].c();r=A(),n=M("div");for(let i=0;i<f.length;i+=1)f[i].c();xe(e,"display","flex"),xe(n,"display","flex"),xe(n,"justify-content","space-between")},m(i,a){m(i,e,a);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);m(i,r,a),m(i,n,a);for(let u=0;u<f.length;u+=1)f[u]&&f[u].m(n,null)},p(i,[a]){if(a&1){o=Ge(i[0]);let u;for(u=0;u<o.length;u+=1){const c=xr(i,o,u);s[u]?s[u].p(c,a):(s[u]=jr(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length}if(a&2){l=Ge(i[1]);let u;for(u=0;u<l.length;u+=1){const c=Br(i,l,u);f[u]?f[u].p(c,a):(f[u]=Rr(c),f[u].c(),f[u].m(n,null))}for(;u<f.length;u+=1)f[u].d(1);f.length=l.length}},i:J,o:J,d(i){i&&(h(e),h(r),h(n)),Nt(s,i),Nt(f,i)}}}function xi(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class Ze extends U{constructor(e){super(),H(this,e,xi,Bi,W,{colorScale:0,limits:1})}}function ji(t){let e;return{c(){e=v("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ri(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ui(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Hi(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Wi(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ri]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Ui]},$$scope:{ctx:t}}}),u=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Hi]},$$scope:{ctx:t}}}),{c(){e=M("p"),r=v("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),l=v("."),f=A(),i=M("p"),a=v("License: "),_(u.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,S){m($,e,S),E(e,r),w(n,e,null),E(e,o),w(s,e,null),E(e,l),m($,f,S),m($,i,S),E(i,a),w(u,i,null),E(i,c),p=!0},p($,S){const y={};S&65536&&(y.$$scope={dirty:S,ctx:$}),n.$set(y);const T={};S&65536&&(T.$$scope={dirty:S,ctx:$}),s.$set(T);const C={};S&65536&&(C.$$scope={dirty:S,ctx:$}),u.$set(C)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(u.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(f),h(i)),b(n),b(s),b(u)}}}function zi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Wi]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ur(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:J,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Vi(t){let e;return{c(){e=v("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gi(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function qi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ki(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zi(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,S;return s=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Gi]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[qi]},$$scope:{ctx:t}}}),p=new x({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ki]},$$scope:{ctx:t}}}),{c(){e=M("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=A(),n=M("p"),o=v("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),l=v(". Output area boundaries from "),_(f.$$.fragment),i=v("."),a=A(),u=M("p"),c=v("License: "),_(p.$$.fragment),$=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(y,T){m(y,e,T),m(y,r,T),m(y,n,T),E(n,o),w(s,n,null),E(n,l),w(f,n,null),E(n,i),m(y,a,T),m(y,u,T),E(u,c),w(p,u,null),E(u,$),S=!0},p(y,T){const C={};T&65536&&(C.$$scope={dirty:T,ctx:y}),s.$set(C);const P={};T&65536&&(P.$$scope={dirty:T,ctx:y}),f.$set(P);const I={};T&65536&&(I.$$scope={dirty:T,ctx:y}),p.$set(I)},i(y){S||(d(s.$$.fragment,y),d(f.$$.fragment,y),d(p.$$.fragment,y),S=!0)},o(y){g(s.$$.fragment,y),g(f.$$.fragment,y),g(p.$$.fragment,y),S=!1},d(y){y&&(h(e),h(r),h(n),h(a),h(u)),b(s),b(f),b(p)}}}function Xi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Zi]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Hr(t){let e,r;return e=new Ze({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:J,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Yi(t){let e;return{c(){e=v("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ji(t){let e;return{c(){e=v(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function el(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ji]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Qi]},$$scope:{ctx:t}}}),i=new je({}),{c(){e=M("p"),r=v("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),l=v("."),f=A(),_(i.$$.fragment)},m(u,c){m(u,e,c),E(e,r),w(n,e,null),E(e,o),w(s,e,null),E(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&65536&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&65536&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function tl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[el]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Wr(t){let e,r,n,o;return n=new Ze({props:{colorScale:t[4],limits:t[7]().map(nl)}}),{c(){e=M("p"),e.textContent="(people per square kilometres)",r=A(),_(n.$$.fragment)},m(s,l){m(s,e,l),m(s,r,l),w(n,s,l),o=!0},p:J,i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function rl(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,S;function y(O){t[9](O)}let T={id:"percent_households_with_car",$$slots:{right:[zi],default:[ji]},$$scope:{ctx:t}};t[0]!==void 0&&(T.checked=t[0]),e=new te({props:T}),R.push(()=>q(e,"checked",y)),e.$on("change",t[10]);let C=t[3]=="percent_households_with_car"&&Ur(t);function P(O){t[11](O)}let I={id:"average_cars_per_household",$$slots:{right:[Xi],default:[Vi]},$$scope:{ctx:t}};t[1]!==void 0&&(I.checked=t[1]),s=new te({props:I}),R.push(()=>q(s,"checked",P)),s.$on("change",t[12]);let k=t[3]=="average_cars_per_household"&&Hr(t);function L(O){t[13](O)}let F={id:"population_density",$$slots:{right:[tl],default:[Yi]},$$scope:{ctx:t}};t[2]!==void 0&&(F.checked=t[2]),a=new te({props:F}),R.push(()=>q(a,"checked",L)),a.$on("change",t[14]);let D=t[3]=="population_density"&&Wr(t);return $=new Q({props:{layer:Ae,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=A(),C&&C.c(),o=A(),_(s.$$.fragment),f=A(),k&&k.c(),i=A(),_(a.$$.fragment),c=A(),D&&D.c(),p=A(),_($.$$.fragment)},m(O,N){w(e,O,N),m(O,n,N),C&&C.m(O,N),m(O,o,N),w(s,O,N),m(O,f,N),k&&k.m(O,N),m(O,i,N),w(a,O,N),m(O,c,N),D&&D.m(O,N),m(O,p,N),w($,O,N),S=!0},p(O,[N]){const B={};N&65536&&(B.$$scope={dirty:N,ctx:O}),!r&&N&1&&(r=!0,B.checked=O[0],K(()=>r=!1)),e.$set(B),O[3]=="percent_households_with_car"?C?(C.p(O,N),N&8&&d(C,1)):(C=Ur(O),C.c(),d(C,1),C.m(o.parentNode,o)):C&&(ae(),g(C,1,1,()=>{C=null}),fe());const z={};N&65536&&(z.$$scope={dirty:N,ctx:O}),!l&&N&2&&(l=!0,z.checked=O[1],K(()=>l=!1)),s.$set(z),O[3]=="average_cars_per_household"?k?(k.p(O,N),N&8&&d(k,1)):(k=Hr(O),k.c(),d(k,1),k.m(i.parentNode,i)):k&&(ae(),g(k,1,1,()=>{k=null}),fe());const ee={};N&65536&&(ee.$$scope={dirty:N,ctx:O}),!u&&N&4&&(u=!0,ee.checked=O[2],K(()=>u=!1)),a.$set(ee),O[3]=="population_density"?D?(D.p(O,N),N&8&&d(D,1)):(D=Wr(O),D.c(),d(D,1),D.m(p.parentNode,p)):D&&(ae(),g(D,1,1,()=>{D=null}),fe());const V={};N&8&&(V.show=O[3]!=""),$.$set(V)},i(O){S||(d(e.$$.fragment,O),d(C),d(s.$$.fragment,O),d(k),d(a.$$.fragment,O),d(D),d($.$$.fragment,O),S=!0)},o(O){g(e.$$.fragment,O),g(C),g(s.$$.fragment,O),g(k),g(a.$$.fragment,O),g(D),g($.$$.fragment,O),S=!1},d(O){O&&(h(n),h(o),h(f),h(i),h(c),h(p)),b(e,O),C&&C.d(O),b(s,O),k&&k.d(O),b(a,O),D&&D.d(O),b($,O)}}}let Ae="census_output_areas";const nl=t=>t.toLocaleString();function ol(t,e,r){let n;X(t,re,I=>r(8,n=I));let o=`${Ae}-outline`,s=G.sequential_low_to_high,l=!1,f=!1,i=!1,a="";le(n,Ae,`${oe()}/v1/${Ae}.pmtiles`),Ke(n,{id:Ae,source:Ae,sourceLayer:Ae,color:"black",opacity:ue(.5,.7)}),ge(n,{id:o,source:Ae,sourceLayer:Ae,color:"black",width:.5});function u(I){let k=I.properties.OA21CD,L=I.properties[a];return a=="percent_households_with_car"?`<p>${L}% of households in ${k} have 1 or more cars</p>`:a=="average_cars_per_household"?`<p>Households in ${k} have an average of ${L} cars</p>`:`<p>There are ${L.toLocaleString()} people per square kilometre in ${k}</p>`}function c(I){let k=I.detail.properties.OA21CD;a=="percent_households_with_car"||a=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${k}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${k}`,"_blank")}function p(){return a=="percent_households_with_car"?[0,20,40,60,80,100]:a=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(I){l=I,r(0,l)}const S=()=>{r(1,f=!1),r(2,i=!1)};function y(I){f=I,r(1,f)}const T=()=>{r(0,l=!1),r(2,i=!1)};function C(I){i=I,r(2,i)}const P=()=>{r(0,l=!1),r(1,f=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,a="percent_households_with_car"):f?r(3,a="average_cars_per_household"):i?r(3,a="population_density"):r(3,a=""),a?(n.setPaintProperty(Ae,"fill-color",qe(["get",a],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,f,i,a,s,u,c,p,n,$,S,y,T,C,P]}class sl extends U{constructor(e){super(),H(this,e,ol,rl,W,{})}}function il(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ll(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function al(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[ll]},$$scope:{ctx:t}}}),l=new je({}),{c(){e=M("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of December 2022."),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function fl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[al]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ul(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:He,$$slots:{right:[fl],default:[il]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:He,tooltip:cl,show:t[0],clickable:!0}}),o.$on("click",pl),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let He="combined_authorities";function cl(t){return`<p>${t.properties.name}</p>`}function pl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function $l(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=G.combined_authorities,s=`${He}-outline`;ar(n,He,`${oe()}/v1/${He}.geojson`),Ke(n,{id:He,source:He,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:He,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class ml extends U{constructor(e){super(),H(this,e,$l,ul,W,{})}}function hl(t){let e;return{c(){e=v("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function dl(t){let e;return{c(){e=v(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function gl(t){let e;return{c(){e=v(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _l(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[dl]},$$scope:{ctx:t}}}),s=new x({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[gl]},$$scope:{ctx:t}}}),i=new je({}),{c(){e=M("p"),r=v("The 2019 English IMD scores come from "),_(n.$$.fragment),o=v(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),l=v("."),f=A(),_(i.$$.fragment)},m(u,c){m(u,e,c),E(e,r),w(n,e,null),E(e,o),w(s,e,null),E(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function wl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[_l]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function zr(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:J,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function bl(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:Oe,$$slots:{right:[wl],default:[hl]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>q(e,"checked",f));let a=t[0]&&zr(t);return s=new Q({props:{layer:Oe,tooltip:vl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),a&&a.c(),o=A(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],K(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=zr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(ae(),g(a,1,1,()=>{a=null}),fe());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Oe="imd";function vl(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function yl(t,e,r){let n;X(t,re,a=>r(2,n=a));let o=`${Oe}-outline`,s=G.sequential_low_to_high,l=[0,2,4,6,8,10];le(n,Oe,`${oe()}/v1/${Oe}.pmtiles`),Ke(n,{id:Oe,source:Oe,sourceLayer:Oe,color:qe(["-",10,["get","decile"]],l,s),opacity:ue(.5,.7)}),ge(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});let f=!1;function i(a){f=a,r(0,f)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",f?"visible":"none")},[f,s,n,i]}class kl extends U{constructor(e){super(),H(this,e,yl,bl,W,{})}}function Sl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Tl(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cl(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Tl]},$$scope:{ctx:t}}}),l=new je({}),{c(){e=M("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Al(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Cl]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ol(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:We,$$slots:{right:[Al],default:[Sl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:We,tooltip:Ll,show:t[0],clickable:!0}}),o.$on("click",Dl),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let We="local_authority_districts";function Ll(t){return`<p>${t.properties.name}</p>`}function Dl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function El(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=G.local_authority_districts,s=`${We}-outline`;ar(n,We,`${oe()}/v1/${We}.geojson`),Ke(n,{id:We,source:We,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:We,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Pl extends U{constructor(e){super(),H(this,e,El,Ol,W,{})}}function Ml(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Nl(t){let e;return{c(){e=v(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Il(t){let e;return{c(){e=v(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fl(t){let e;return{c(){e=v(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bl(t){let e;return{c(){e=v("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xl(t){let e;return{c(){e=v(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function jl(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,S,y,T,C,P,I,k,L,F;return n=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Nl]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Il]},$$scope:{ctx:t}}}),f=new x({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Fl]},$$scope:{ctx:t}}}),$=new x({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Bl]},$$scope:{ctx:t}}}),P=new x({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[xl]},$$scope:{ctx:t}}}),L=new je({}),{c(){e=M("p"),r=v("LPAs may be a "),_(n.$$.fragment),o=v(", "),_(s.$$.fragment),l=v("y, or "),_(f.$$.fragment),i=v("."),a=A(),u=M("p"),c=M("strong"),p=v(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),S=v(" to get more details."),y=A(),T=M("p"),C=v("Data from ONS Geography via "),_(P.$$.fragment),I=v(", as of November 2022."),k=A(),_(L.$$.fragment)},m(D,O){m(D,e,O),E(e,r),w(n,e,null),E(e,o),w(s,e,null),E(e,l),w(f,e,null),E(e,i),m(D,a,O),m(D,u,O),E(u,c),E(c,p),w($,c,null),E(c,S),m(D,y,O),m(D,T,O),E(T,C),w(P,T,null),E(T,I),m(D,k,O),w(L,D,O),F=!0},p(D,O){const N={};O&32&&(N.$$scope={dirty:O,ctx:D}),n.$set(N);const B={};O&32&&(B.$$scope={dirty:O,ctx:D}),s.$set(B);const z={};O&32&&(z.$$scope={dirty:O,ctx:D}),f.$set(z);const ee={};O&32&&(ee.$$scope={dirty:O,ctx:D}),$.$set(ee);const V={};O&32&&(V.$$scope={dirty:O,ctx:D}),P.$set(V)},i(D){F||(d(n.$$.fragment,D),d(s.$$.fragment,D),d(f.$$.fragment,D),d($.$$.fragment,D),d(P.$$.fragment,D),d(L.$$.fragment,D),F=!0)},o(D){g(n.$$.fragment,D),g(s.$$.fragment,D),g(f.$$.fragment,D),g($.$$.fragment,D),g(P.$$.fragment,D),g(L.$$.fragment,D),F=!1},d(D){D&&(h(e),h(a),h(u),h(y),h(T),h(k)),b(n),b(s),b(f),b($),b(P),b(L,D)}}}function Rl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[jl]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ul(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Le,$$slots:{right:[Rl],default:[Ml]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:Le,tooltip:Hl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Le="local_planning_authorities";function Hl(t){return`<p>${t.properties.name}</p>`}function Wl(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=G.local_planning_authorities,s=`${Le}-outline`;le(n,Le,`${oe()}/v1/${Le}.pmtiles`),Ke(n,{id:Le,source:Le,sourceLayer:Le,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Le,sourceLayer:Le,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class zl extends U{constructor(e){super(),H(this,e,Wl,Ul,W,{})}}function Vl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Gl(t){let e;return{c(){e=v(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ql(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Gl]},$$scope:{ctx:t}}}),l=new je({}),{c(){e=M("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Kl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ql]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Zl(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:De,$$slots:{right:[Kl],default:[Vl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:De,tooltip:Xl,show:t[0],clickable:!0}}),o.$on("click",Yl),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="parliamentary_constituencies";function Xl(t){return`<p>${t.properties.Name}</p>`}function Yl(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function Jl(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=G.parliamentary_constituencies,s=`${De}-outline`;le(n,De,`${oe()}/v1/${De}.pmtiles`),Ke(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:De,sourceLayer:De,color:o,width:5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Ql extends U{constructor(e){super(),H(this,e,Jl,Zl,W,{})}}function ea(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ta(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ra(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[ta]},$$scope:{ctx:t}}}),l=new je({}),{c(){e=M("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function na(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ra]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function oa(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ee,$$slots:{right:[na],default:[ea]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:Ee,tooltip:sa,show:t[0],clickable:!0}}),o.$on("click",ia),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="wards";function sa(t){return`<p>${t.properties.name}</p>`}function ia(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function la(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=G.wards,s=`${Ee}-outline`;le(n,Ee,`${oe()}/v1/${Ee}.pmtiles`),Ke(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class aa extends U{constructor(e){super(),H(this,e,la,oa,W,{})}}function fa(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ua(t){let e,r,n,o;return n=new x({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[fa]},$$scope:{ctx:t}}}),{c(){e=M("p"),r=v("License: "),_(n.$$.fragment)},m(s,l){m(s,e,l),E(e,r),w(n,e,null),o=!0},p(s,[l]){const f={};l&1&&(f.$$scope={dirty:l,ctx:s}),n.$set(f)},i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&h(e),b(n)}}}class Xe extends U{constructor(e){super(),H(this,e,null,ua,W,{})}}function ca(t){let e,r,n;return e=new _e({props:{color:G.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=v(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function pa(t){let e;return{c(){e=v(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $a(t){let e,r,n,o,s,l,f,i,a;return s=new x({props:{href:"https://gtfs.org",$$slots:{default:[pa]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=M("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=A(),n=M("p"),o=v("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),l=v(`, and doesn't include which routes are run or the
        frequency of service.`),f=A(),_(i.$$.fragment)},m(u,c){m(u,e,c),m(u,r,c),m(u,n,c),E(n,o),w(s,n,null),E(n,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&8&&(p.$$scope={dirty:c,ctx:u}),s.$set(p)},i(u){a||(d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(r),h(n),h(f)),b(s),b(i,u)}}}function ma(t){let e,r,n;return r=new ne({props:{$$slots:{default:[$a]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ha(t){let e,r,n,o,s;function l(i){t[1](i)}let f={id:Ye,$$slots:{right:[ma],default:[ca]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:Ye,tooltip:da,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&8&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ye="bus_routes";function da(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function ga(t,e,r){let n;X(t,re,l=>r(2,n=l)),le(n,Ye,`${oe()}/v1/${Ye}.pmtiles`),ge(n,{id:Ye,source:Ye,sourceLayer:Ye,color:["case",["boolean",["get","has_bus_lane"],!1],G.bus_route_with_lane,G.bus_route_without_lane],width:5,opacity:ue(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class _a extends U{constructor(e){super(),H(this,e,ga,ha,W,{})}}function Vr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function wa(t){let e;return{c(){e=v("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ba(t){let e,r,n,o,s,l,f,i;return f=new Xe({}),{c(){e=M("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=A(),n=M("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=A(),s=M("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=A(),_(f.$$.fragment)},m(a,u){m(a,e,u),m(a,r,u),m(a,n,u),m(a,o,u),m(a,s,u),m(a,l,u),w(f,a,u),i=!0},p:J,i(a){i||(d(f.$$.fragment,a),i=!0)},o(a){g(f.$$.fragment,a),i=!1},d(a){a&&(h(e),h(r),h(n),h(o),h(s),h(l)),b(f,a)}}}function va(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ba]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Gr(t){let e,r,n=Ge(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=qr(Vr(t,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=Rt()},m(l,f){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,f);m(l,e,f),r=!0},p(l,f){if(f&2){n=Ge(l[1]);let i;for(i=0;i<n.length;i+=1){const a=Vr(l,n,i);o[i]?(o[i].p(a,f),d(o[i],1)):(o[i]=qr(a),o[i].c(),d(o[i],1),o[i].m(e.parentNode,e))}for(ae(),i=n.length;i<o.length;i+=1)s(i);fe()}},i(l){if(!r){for(let f=0;f<n.length;f+=1)d(o[f]);r=!0}},o(l){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)g(o[f]);r=!1},d(l){l&&h(e),Nt(o,l)}}}function qr(t){let e,r,n,o=t[4]+"",s,l,f;return r=new _e({props:{color:t[5]}}),{c(){e=M("div"),_(r.$$.fragment),n=A(),s=v(o),l=A()},m(i,a){m(i,e,a),w(r,e,null),E(e,n),E(e,s),E(e,l),f=!0},p:J,i(i){f||(d(r.$$.fragment,i),f=!0)},o(i){g(r.$$.fragment,i),f=!1},d(i){i&&h(e),b(r)}}}function ya(t){let e,r,n,o,s,l;function f(u){t[2](u)}let i={id:Je,$$slots:{right:[va],default:[wa]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>q(e,"checked",f));let a=t[0]&&Gr(t);return s=new Q({props:{layer:Je,tooltip:ka,show:t[0],clickable:!0}}),s.$on("click",Sa),{c(){_(e.$$.fragment),n=A(),a&&a.c(),o=A(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],K(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=Gr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(ae(),g(a,1,1,()=>{a=null}),fe());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let Je="cycle_paths";function ka(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Sa(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Ta(t,e,r){let n;X(t,re,f=>r(3,n=f));let o=[["Separated tracks",G.cycle_paths.track],["Unprotected lanes",G.cycle_paths.lane],["Shared-use (segregated)",G.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",G.cycle_paths.shared_use_unsegregated]];le(n,Je,`${oe()}/v1/${Je}.pmtiles`),ge(n,{id:Je,source:Je,sourceLayer:Je,color:cn(["get","kind"],{track:G.cycle_paths.track,lane:G.cycle_paths.lane,shared_use_segregated:G.cycle_paths.shared_use_segregated,shared_use_unsegregated:G.cycle_paths.shared_use_unsegregated},"red"),width:Ut,opacity:ue(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Ca extends U{constructor(e){super(),H(this,e,Ta,ya,W,{})}}function Aa(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Oa(t){let e;return{c(){e=v(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function La(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Oa]},$$scope:{ctx:t}}}),l=new je({}),{c(){e=M("p"),r=v("Data from the "),_(n.$$.fragment),o=v(", as of September 2021."),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Da(t){let e,r,n;return r=new ne({props:{$$slots:{default:[La]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ea(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:Qe,$$slots:{right:[Da],default:[Aa]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:Qe,tooltip:Pa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Qe="mrn";function Pa(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Ma(t,e,r){let n;X(t,re,f=>r(3,n=f));let o=G.mrn;le(n,Qe,`${oe()}/v1/${Qe}.pmtiles`),ge(n,{id:Qe,source:Qe,sourceLayer:Qe,color:o,width:7,opacity:ue(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Na extends U{constructor(e){super(),H(this,e,Ma,Ea,W,{})}}function Ia(t){let e;return{c(){e=v("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fa(t){let e;return{c(){e=v("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ba(t){let e;return{c(){e=v("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xa(t){let e,r,n,o,s,l,f,i,a,u,c;return f=new x({props:{href:"https://www.pct.bike",$$slots:{default:[Fa]},$$scope:{ctx:t}}}),a=new x({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[Ba]},$$scope:{ctx:t}}}),{c(){e=M("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=A(),n=M("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=A(),s=M("p"),l=v("See "),_(f.$$.fragment),i=v(" and "),_(a.$$.fragment),u=v(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),E(s,l),w(f,s,null),E(s,i),w(a,s,null),E(s,u),c=!0},p(p,$){const S={};$&2048&&(S.$$scope={dirty:$,ctx:p}),f.$set(S);const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),a.$set(y)},i(p){c||(d(f.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(f.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(f),b(a)}}}function ja(t){let e,r,n;return r=new ne({props:{$$slots:{default:[xa]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kr(t){let e,r,n,o,s,l,f,i;e=new Ze({props:{colorScale:t[3],limits:t[4]}});function a($){t[8]($)}let u={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(u.value=t[0]),n=new $n({props:u}),R.push(()=>q(n,"value",a)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new It({props:p}),R.push(()=>q(l,"value",c)),l.$on("change",t[6]),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),s=A(),_(l.$$.fragment)},m($,S){w(e,$,S),m($,r,S),w(n,$,S),m($,s,S),w(l,$,S),i=!0},p($,S){const y={};!o&&S&1&&(o=!0,y.value=$[0],K(()=>o=!1)),n.$set(y);const T={};!f&&S&2&&(f=!0,T.value=$[1],K(()=>f=!1)),l.$set(T)},i($){i||(d(e.$$.fragment,$),d(n.$$.fragment,$),d(l.$$.fragment,$),i=!0)},o($){g(e.$$.fragment,$),g(n.$$.fragment,$),g(l.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(l,$)}}}function Ra(t){let e,r,n,o,s,l,f,i;function a(p){t[7](p)}let u={id:st,$$slots:{right:[ja],default:[Ia]},$$scope:{ctx:t}};t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),R.push(()=>q(e,"checked",a));let c=t[2]&&Kr(t);return s=new Q({props:{layer:st,tooltip:t[5],show:t[2]&&t[0]==st,clickable:!1}}),f=new Q({props:{layer:Mt,tooltip:t[5],show:t[2]&&t[0]==Mt,clickable:!1}}),{c(){_(e.$$.fragment),n=A(),c&&c.c(),o=A(),_(s.$$.fragment),l=A(),_(f.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(f,p,$),i=!0},p(p,[$]){const S={};$&2048&&(S.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,S.checked=p[2],K(()=>r=!1)),e.$set(S),p[2]?c?(c.p(p,$),$&4&&d(c,1)):(c=Kr(p),c.c(),d(c,1),c.m(o.parentNode,o)):c&&(ae(),g(c,1,1,()=>{c=null}),fe());const y={};$&5&&(y.show=p[2]&&p[0]==st),s.$set(y);const T={};$&5&&(T.show=p[2]&&p[0]==Mt),f.$set(T)},i(p){i||(d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(f.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(f.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(l)),b(e,p),c&&c.d(p),b(s,p),b(f,p)}}}let st="pct_commute",Mt="pct_school";function Ua(t,e,r){let n;X(t,re,S=>r(10,n=S));let o=G.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=st,f="baseline";for(let S of[st,Mt])le(n,S,`${oe()}/v1/${S}.pmtiles`),ge(n,{id:S,source:S,sourceLayer:S,color:qe(["get",f],s,o),width:Ut,opacity:ue(.5,1)});let i=!1;function a(S){let y=S.properties.baseline,T=S.properties.gov_target,C=S.properties.go_dutch,P=`<h2>Trip purpose: ${l==st?"commuting":"school"}</h2>`;if(P+=`<p>Baseline (2011): <b>${y.toLocaleString()}</b></p>`,y==0)P+=`<p>Government target (2025): <b>${T.toLocaleString()}</b></p>`,P+=`<p>Go Dutch: <b>${C.toLocaleString()}</b></p>`;else{let I=(T/y).toFixed(1),k=(C/y).toFixed(1);P+=`<p>Government target (2025): ${T.toLocaleString()} (<b>${I}x</b> of baseline)</p>`,P+=`<p>Go Dutch: ${C.toLocaleString()} (<b>${k}x</b> of baseline)</p>`}return P}function u(){n.setPaintProperty(l,"line-color",qe(["get",f],s,o))}function c(S){i=S,r(2,i)}function p(S){l=S,r(0,l)}function $(S){f=S,r(1,f)}return[l,f,i,o,s,a,u,c,p,$]}class Ha extends U{constructor(e){super(),H(this,e,Ua,Ra,W,{})}}function Wa(t){let e;return{c(){e=v("OS Speeds")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function za(t){let e;return{c(){e=v("Basemap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Va(t){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ga(t){let e,r,n,o,s,l,f,i,a,u,c,p;return n=new x({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[za]},$$scope:{ctx:t}}}),u=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Va]},$$scope:{ctx:t}}}),{c(){e=M("p"),r=v("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=v(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=A(),l=M("p"),l.textContent="Data valid as of 1 September, 2023",f=A(),i=M("p"),a=v(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),c=v(".")},m($,S){m($,e,S),E(e,r),w(n,e,null),E(e,o),m($,s,S),m($,l,S),m($,f,S),m($,i,S),E(i,a),w(u,i,null),E(i,c),p=!0},p($,S){const y={};S&256&&(y.$$scope={dirty:S,ctx:$}),n.$set(y);const T={};S&256&&(T.$$scope={dirty:S,ctx:$}),u.$set(T)},i($){p||(d(n.$$.fragment,$),d(u.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(s),h(l),h(f),h(i)),b(n),b(u)}}}function qa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ga]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Zr(t){let e,r,n,o,s;e=new Ze({props:{colorScale:t[2],limits:t[3]}});function l(i){t[6](i)}let f={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(f.value=t[0]),n=new $n({props:f}),R.push(()=>q(n,"value",l)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment)},m(i,a){w(e,i,a),m(i,r,a),w(n,i,a),s=!0},p(i,a){const u={};!o&&a&1&&(o=!0,u.value=i[0],K(()=>o=!1)),n.$set(u)},i(i){s||(d(e.$$.fragment,i),d(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(e,i),b(n,i)}}}function Ka(t){let e,r,n,o,s,l;function f(u){t[5](u)}let i={id:ze,$$slots:{right:[qa],default:[Wa]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),R.push(()=>q(e,"checked",f));let a=t[1]&&Zr(t);return s=new Q({props:{layer:ze,tooltip:Za,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),a&&a.c(),o=A(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&2&&(r=!0,p.checked=u[1],K(()=>r=!1)),e.$set(p),u[1]?a?(a.p(u,c),c&2&&d(a,1)):(a=Zr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(ae(),g(a,1,1,()=>{a=null}),fe());const $={};c&2&&($.show=u[1]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let ze="road_speeds";function Za(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function Xa(t,e,r){let n;X(t,re,c=>r(7,n=c));let o=G.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";le(n,ze,`${fr()}/v1/${ze}.pmtiles`),ge(n,{id:ze,source:ze,sourceLayer:ze,color:qe(["get",l],s,o),width:Ut,opacity:ue(.5,1)});let f=!1;function i(){n.setPaintProperty(ze,"line-color",qe(["get",l],s,o))}function a(c){f=c,r(1,f)}function u(c){l=c,r(0,l)}return[l,f,o,s,i,a,u]}class Ya extends U{constructor(e){super(),H(this,e,Xa,Ka,W,{})}}function Ja(t){let e;return{c(){e=v("OS Road widths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qa(t){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ef(t){let e,r,n,o,s,l,f,i,a;return f=new x({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Qa]},$$scope:{ctx:t}}}),{c(){e=M("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=A(),n=M("p"),n.textContent="Data valid as of 1 September, 2023",o=A(),s=M("p"),l=v(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(f.$$.fragment),i=v(".")},m(u,c){m(u,e,c),m(u,r,c),m(u,n,c),m(u,o,c),m(u,s,c),E(s,l),w(f,s,null),E(s,i),a=!0},p(u,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),f.$set(p)},i(u){a||(d(f.$$.fragment,u),a=!0)},o(u){g(f.$$.fragment,u),a=!1},d(u){u&&(h(e),h(r),h(n),h(o),h(s)),b(f)}}}function tf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ef]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Xr(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:J,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function rf(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:et,$$slots:{right:[tf],default:[Ja]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>q(e,"checked",f));let a=t[0]&&Xr(t);return s=new Q({props:{layer:et,tooltip:nf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),a&&a.c(),o=A(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],K(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=Xr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(ae(),g(a,1,1,()=>{a=null}),fe());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let et="road_widths";function nf(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function of(t,e,r){let n;X(t,re,i=>r(4,n=i));let o=G.sequential_low_to_high,s=[0,5,10,15,20,100];le(n,et,`${fr()}/v1/${et}.pmtiles`),ge(n,{id:et,source:et,sourceLayer:et,color:qe(["get","average"],s,o),width:Ut,opacity:ue(.5,1)});let l=!1;function f(i){l=i,r(0,l)}return[l,o,s,f]}class sf extends U{constructor(e){super(),H(this,e,of,rf,W,{})}}function lf(t){let e,r,n;return{c(){e=M("input"),j(e,"class","govuk-file-upload"),j(e,"id","load-criticals"),j(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=xt(e,"change",t[4]),r=!0)},p:J,d(o){o&&h(e),t[7](null),r=!1,n()}}}function Yr(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[ff]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function af(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new _e({props:{color:or}}),{c(){_(e.$$.fragment),r=v(`
        Show `),o=v(n),s=v(" issues")},m(f,i){w(e,f,i),m(f,r,i),m(f,o,i),m(f,s,i),l=!0},p(f,i){(!l||i&4)&&n!==(n=f[2].toLocaleString()+"")&&Te(o,n)},i(f){l||(d(e.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o),h(s)),b(e,f)}}}function ff(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[af]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),R.push(()=>q(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,f){w(e,l,f),n=!0},p(l,f){const i={};f&516&&(i.$$scope={dirty:f,ctx:l}),!r&&f&1&&(r=!0,i.checked=l[0],K(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function uf(t){let e,r,n,o,s,l;e=new pn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[lf]},$$scope:{ctx:t}}}),n=new hn({props:{errorMessage:t[3]}});let f=t[2]>0&&Yr(t);return{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),f&&f.c(),s=Rt()},m(i,a){w(e,i,a),m(i,r,a),w(n,i,a),m(i,o,a),f&&f.m(i,a),m(i,s,a),l=!0},p(i,a){const u={};a&514&&(u.$$scope={dirty:a,ctx:i}),e.$set(u);const c={};a&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?f?(f.p(i,a),a&4&&d(f,1)):(f=Yr(i),f.c(),d(f,1),f.m(s.parentNode,s)):f&&(ae(),g(f,1,1,()=>{f=null}),fe())},i(i){l||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(f),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(f),l=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),f&&f.d(i)}}}function cf(t){let e,r,n,o,s,l;return e=new Be({props:{label:"Critical Issues",$$slots:{default:[uf]},$$scope:{ctx:t}}}),n=new Q({props:{layer:se+"-points",tooltip:pf,show:t[0],clickable:!1}}),s=new Q({props:{layer:se+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[se+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),_(s.$$.fragment)},m(f,i){w(e,f,i),m(f,r,i),w(n,f,i),m(f,o,i),w(s,f,i),l=!0},p(f,[i]){const a={};i&527&&(a.$$scope={dirty:i,ctx:f}),e.$set(a);const u={};i&1&&(u.show=f[0]),n.$set(u);const c={};i&1&&(c.show=f[0]),s.$set(c)},i(f){l||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o)),b(e,f),b(n,f),b(s,f)}}}let se="criticals",or="red";function pf(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function $f(t,e,r){let n;X(t,re,p=>r(6,n=p));let o,s=!0,l=0,f="";Jn(n,se),n.addSource(se,{type:"geojson",data:mn(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),gt(n,{id:`${se}-clusters`,source:se,filter:["has","point_count"],color:or,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${se}-counts`,source:se,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),gt(n,{id:`${se}-points`,source:se,filter:["!",["has","point_count"]],color:or,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await ki(o.files[0]);n.getSource(se).setData($),r(2,l=$.features.length),r(3,f="")}catch($){r(3,f=`The file you loaded is broken: ${$}`)}}function a(p){n.getSource(se).getClusterExpansionZoom(p.detail.properties.cluster_id,($,S)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:S})})}function u(p){R[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${se}-counts`)&&n.setLayoutProperty(`${se}-counts`,"visibility",s?"visible":"none")},[s,o,l,f,i,a,n,u,c]}class mf extends U{constructor(e){super(),H(this,e,$f,cf,W,{})}}function hf(t){let e,r,n;return e=new _e({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=v(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function df(t){let e;return{c(){e=v("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function gf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[df]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=M("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function _f(t){let e,r,n;return r=new ne({props:{$$slots:{default:[gf]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function wf(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ve,$$slots:{right:[_f],default:[hf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:Ve,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",bf),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&64&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Ve="crossings";function bf(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function vf(t,e,r){let n;X(t,re,a=>r(4,n=a));let o=!1;function s(a){const u=a.properties.crossing;return`<p>${l.get(u)??`Crossing with unknown type (${u})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);le(n,Ve,`${oe()}/v1/${Ve}.pmtiles`);let f=G[Ve];gt(n,{id:Ve,source:Ve,sourceLayer:Ve,color:f,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(a){o=a,r(0,o)}return[o,s,f,i]}class yf extends U{constructor(e){super(),H(this,e,vf,wf,W,{})}}function kf(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Sf(t){let e;return{c(){e=v("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Tf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Sf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=M("p"),r=v("Cycle parking, according to "),_(n.$$.fragment),o=v(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Cf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Tf]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Af(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:tt,$$slots:{right:[Cf],default:[kf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:tt,tooltip:Of,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&16&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let tt="cycle_parking";function Of(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function Lf(t,e,r){let n;X(t,re,f=>r(3,n=f));let o=G.cycle_parking;le(n,tt,`${oe()}/v1/${tt}.pmtiles`),gt(n,{id:tt,source:tt,sourceLayer:tt,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Df extends U{constructor(e){super(),H(this,e,Lf,Af,W,{})}}function Ef(t){let e,r,n,o;return e=new _e({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=A(),n=v(t[1])},m(s,l){w(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&Te(n,s[1])},i(s){o||(d(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function Pf(t){let e;const r=t[6].default,n=ln(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&an(n,r,o,o[8],e?un(r,o[8],s,null):fn(o[8]),null)},i(o){e||(d(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Mf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Pf]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Nf(t){let e,r,n,o,s;function l(i){t[7](i)}let f={id:t[0],$$slots:{right:[Mf],default:[Ef]},$$scope:{ctx:t}};return t[2]!==void 0&&(f.checked=t[2]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&1&&(u.id=i[0]),a&258&&(u.$$scope={dirty:a,ctx:i}),!r&&a&4&&(r=!0,u.checked=i[2],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.layer=i[0]),a&4&&(c.show=i[2]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function If(t,e,r){let n;X(t,re,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:f}=e,{pluralNoun:i}=e,a=G[l];le(n,l,`${oe()}/v1/${l}.pmtiles`),Ke(n,{id:l,source:l,sourceLayer:l,color:a,opacity:ue(1,.7)});let u=!1;function c($){return`<p>${$.properties.name??`Unnamed ${f}`}</p>`}function p($){u=$,r(2,u)}return t.$$set=$=>{"name"in $&&r(0,l=$.name),"singularNoun"in $&&r(5,f=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[l,i,u,a,c,f,o,p,s]}class cr extends U{constructor(e){super(),H(this,e,If,Nf,W,{name:0,singularNoun:5,pluralNoun:1})}}function Ff(t){let e;return{c(){e=v("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[Ff]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=M("p"),r=v("This shows "),_(n.$$.fragment),o=v(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function xf(t){let e,r;return e=new cr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Bf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class jf extends U{constructor(e){super(),H(this,e,null,xf,W,{})}}function Rf(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:J,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Uf(t){let e;return{c(){e=v("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Hf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[Uf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=M("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Wf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Hf]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function zf(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:rt,$$slots:{right:[Wf],default:[Rf]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new te({props:f}),R.push(()=>q(e,"checked",l)),o=new Q({props:{layer:rt,tooltip:Vf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=A(),_(o.$$.fragment)},m(i,a){w(e,i,a),m(i,n,a),w(o,i,a),s=!0},p(i,[a]){const u={};a&32&&(u.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,u.checked=i[0],K(()=>r=!1)),e.$set(u);const c={};a&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const rt="railway_stations";function Vf(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function Gf(t,e,r){let n;X(t,re,i=>r(3,n=i));const o=`${oe()}/v1/${rt}.geojson`;let s=!1;ar(n,rt,o);let l=G[rt];gt(n,{id:rt,source:rt,color:l,radius:no/2});function f(i){s=i,r(0,s)}return[s,l,f]}class qf extends U{constructor(e){super(),H(this,e,Gf,zf,W,{})}}function Kf(t){let e;return{c(){e=v("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zf(t){let e,r,n,o,s,l,f;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Kf]},$$scope:{ctx:t}}}),l=new Xe({}),{c(){e=M("p"),r=v("This shows "),_(n.$$.fragment),o=v(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=A(),_(l.$$.fragment)},m(i,a){m(i,e,a),E(e,r),w(n,e,null),E(e,o),m(i,s,a),w(l,i,a),f=!0},p(i,a){const u={};a&1&&(u.$$scope={dirty:a,ctx:i}),n.$set(u)},i(i){f||(d(n.$$.fragment,i),d(l.$$.fragment,i),f=!0)},o(i){g(n.$$.fragment,i),g(l.$$.fragment,i),f=!1},d(i){i&&(h(e),h(s)),b(n),b(l,i)}}}function Xf(t){let e,r;return e=new cr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Zf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Yf extends U{constructor(e){super(),H(this,e,null,Xf,W,{})}}function Jf(t){let e;return{c(){e=v("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qf(t){let e;return{c(){e=v("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function eu(t){let e,r,n,o,s,l,f,i,a;return n=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[Jf]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Qf]},$$scope:{ctx:t}}}),i=new Xe({}),{c(){e=M("p"),r=v("This shows "),_(n.$$.fragment),o=v(" and "),_(s.$$.fragment),l=v(" data from OpenStreetMap (as of 9 August 2023)."),f=A(),_(i.$$.fragment)},m(u,c){m(u,e,c),E(e,r),w(n,e,null),E(e,o),w(s,e,null),E(e,l),m(u,f,c),w(i,u,c),a=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:u}),s.$set($)},i(u){a||(d(n.$$.fragment,u),d(s.$$.fragment,u),d(i.$$.fragment,u),a=!0)},o(u){g(n.$$.fragment,u),g(s.$$.fragment,u),g(i.$$.fragment,u),a=!1},d(u){u&&(h(e),h(f)),b(n),b(s),b(i,u)}}}function tu(t){let e,r;return e=new cr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[eu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class ru extends U{constructor(e){super(),H(this,e,null,tu,W,{})}}function nu(t){let e;return{c(){e=v("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ou(t){let e;return{c(){e=v(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function su(t){let e;return{c(){e=v("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function iu(t){let e,r,n,o,s,l,f,i,a,u,c;return n=new x({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[ou]},$$scope:{ctx:t}}}),s=new x({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[su]},$$scope:{ctx:t}}}),u=new je({}),{c(){e=M("p"),r=v("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=v(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),l=v(" for details and caveats about the measurements."),f=A(),i=M("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,a=A(),_(u.$$.fragment)},m(p,$){m(p,e,$),E(e,r),w(n,e,null),E(e,o),w(s,e,null),E(e,l),m(p,f,$),m(p,i,$),m(p,a,$),w(u,p,$),c=!0},p(p,$){const S={};$&64&&(S.$$scope={dirty:$,ctx:p}),n.$set(S);const y={};$&64&&(y.$$scope={dirty:$,ctx:p}),s.$set(y)},i(p){c||(d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(h(e),h(f),h(i),h(a)),b(n),b(s),b(u,p)}}}function lu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[iu]},$$scope:{ctx:t}}}),{c(){e=M("span"),_(r.$$.fragment),j(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Jr(t){let e,r;return e=new Ze({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:J,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function au(t){let e,r,n,o,s,l;function f(u){t[3](u)}let i={id:nt,$$slots:{right:[lu],default:[nu]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),R.push(()=>q(e,"checked",f));let a=t[0]&&Jr(t);return s=new Q({props:{layer:nt,tooltip:fu,show:t[0],clickable:!0}}),s.$on("click",uu),{c(){_(e.$$.fragment),n=A(),a&&a.c(),o=A(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),a&&a.m(u,c),m(u,o,c),w(s,u,c),l=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],K(()=>r=!1)),e.$set(p),u[0]?a?(a.p(u,c),c&1&&d(a,1)):(a=Jr(u),a.c(),d(a,1),a.m(o.parentNode,o)):a&&(ae(),g(a,1,1,()=>{a=null}),fe());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){l||(d(e.$$.fragment,u),d(a),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(a),g(s.$$.fragment,u),l=!1},d(u){u&&(h(n),h(o)),b(e,u),a&&a.d(u),b(s,u)}}}let nt="vehicle_counts";function fu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function uu(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function cu(t,e,r){let n;X(t,re,a=>r(4,n=a));let o=G.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];le(n,nt,`${oe()}/v1/${nt}.pmtiles`),gt(n,{id:nt,source:nt,sourceLayer:nt,color:qe(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let f=!1;function i(a){f=a,r(0,f)}return[f,o,l,i]}class pu extends U{constructor(e){super(),H(this,e,cu,au,W,{})}}function $u(t){let e,r,n,o,s,l,f,i;return e=new Yf({}),n=new jf({}),s=new ru({}),f=new qf({}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),_(s.$$.fragment),l=A(),_(f.$$.fragment)},m(a,u){w(e,a,u),m(a,r,u),w(n,a,u),m(a,o,u),w(s,a,u),m(a,l,u),w(f,a,u),i=!0},i(a){i||(d(e.$$.fragment,a),d(n.$$.fragment,a),d(s.$$.fragment,a),d(f.$$.fragment,a),i=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(s.$$.fragment,a),g(f.$$.fragment,a),i=!1},d(a){a&&(h(r),h(o),h(l)),b(e,a),b(n,a),b(s,a),b(f,a)}}}function mu(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[$u]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function hu(t){let e,r,n,o,s,l,f,i,a,u;return e=new Ca({}),n=new Na({}),s=new _a({}),f=new Df({}),a=new yf({}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),_(s.$$.fragment),l=A(),_(f.$$.fragment),i=A(),_(a.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(f,c,p),m(c,i,p),w(a,c,p),u=!0},i(c){u||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),d(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(f,c),b(a,c)}}}function du(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[hu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function gu(t){let e,r,n,o,s,l,f,i,a,u;return e=new Ql({}),n=new aa({}),s=new ml({}),f=new Pl({}),a=new zl({}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),_(s.$$.fragment),l=A(),_(f.$$.fragment),i=A(),_(a.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(f,c,p),m(c,i,p),w(a,c,p),u=!0},i(c){u||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),d(a.$$.fragment,c),u=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(a.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(f,c),b(a,c)}}}function _u(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[gu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function wu(t){let e,r,n,o;return e=new sl({}),n=new kl({}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function bu(t){let e,r,n,o;return e=new sf({}),n=new Ya({}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function vu(t){let e,r,n,o,s=lr()=="Private (development)",l,f;e=new pu({}),n=new Ha({});let i=s&&bu();return{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),i&&i.c(),l=Rt()},m(a,u){w(e,a,u),m(a,r,u),w(n,a,u),m(a,o,u),i&&i.m(a,u),m(a,l,u),f=!0},p:J,i(a){f||(d(e.$$.fragment,a),d(n.$$.fragment,a),d(i),f=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(i),f=!1},d(a){a&&(h(r),h(o),h(l)),b(e,a),b(n,a),i&&i.d(a)}}}function yu(t){let e,r,n,o,s,l,f,i,a,u,c,p,$,S,y,T,C;e=new mf({}),n=new Be({props:{label:"Trip generators",$$slots:{default:[mu]},$$scope:{ctx:t}}}),s=new Be({props:{label:"Existing infrastructure",$$slots:{default:[du]},$$scope:{ctx:t}}}),f=new Be({props:{label:"Boundaries",$$slots:{default:[_u]},$$scope:{ctx:t}}}),a=new Be({props:{label:"Census",$$slots:{default:[wu]},$$scope:{ctx:t}}}),c=new Be({props:{label:"Other",$$slots:{default:[vu]},$$scope:{ctx:t}}});function P(k){t[4](k)}let I={displayEnableButton:!0};return t[1]!==void 0&&(I.isInactive=t[1]),$=new oo({props:I}),t[3]($),R.push(()=>q($,"isInactive",P)),T=new so({props:{disabled:!t[1]}}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),_(s.$$.fragment),l=A(),_(f.$$.fragment),i=A(),_(a.$$.fragment),u=A(),_(c.$$.fragment),p=A(),_($.$$.fragment),y=A(),_(T.$$.fragment)},m(k,L){w(e,k,L),m(k,r,L),w(n,k,L),m(k,o,L),w(s,k,L),m(k,l,L),w(f,k,L),m(k,i,L),w(a,k,L),m(k,u,L),w(c,k,L),m(k,p,L),w($,k,L),m(k,y,L),w(T,k,L),C=!0},p(k,L){const F={};L&32&&(F.$$scope={dirty:L,ctx:k}),n.$set(F);const D={};L&32&&(D.$$scope={dirty:L,ctx:k}),s.$set(D);const O={};L&32&&(O.$$scope={dirty:L,ctx:k}),f.$set(O);const N={};L&32&&(N.$$scope={dirty:L,ctx:k}),a.$set(N);const B={};L&32&&(B.$$scope={dirty:L,ctx:k}),c.$set(B);const z={};!S&&L&2&&(S=!0,z.isInactive=k[1],K(()=>S=!1)),$.$set(z);const ee={};L&2&&(ee.disabled=!k[1]),T.$set(ee)},i(k){C||(d(e.$$.fragment,k),d(n.$$.fragment,k),d(s.$$.fragment,k),d(f.$$.fragment,k),d(a.$$.fragment,k),d(c.$$.fragment,k),d($.$$.fragment,k),d(T.$$.fragment,k),C=!0)},o(k){g(e.$$.fragment,k),g(n.$$.fragment,k),g(s.$$.fragment,k),g(f.$$.fragment,k),g(a.$$.fragment,k),g(c.$$.fragment,k),g($.$$.fragment,k),g(T.$$.fragment,k),C=!1},d(k){k&&(h(r),h(o),h(l),h(i),h(u),h(p),h(y)),b(e,k),b(n,k),b(s,k),b(f,k),b(a,k),b(c,k),t[3](null),b($,k),b(T,k)}}}function ku(t){let e,r,n,o;return e=new Be({props:{label:"Layers",open:!0,$$slots:{default:[yu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,l){w(e,s,l),r=!0,n||(o=xt(window,"keydown",t[2]),n=!0)},p(s,[l]){const f={};l&35&&(f.$$scope={dirty:l,ctx:s}),e.$set(f)},i(s){r||(d(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function Su(t,e,r){let n;X(t,gr,i=>r(1,n=i));let o;function s(i){!n&&i.key=="Escape"&&(o.disableStreetView(),i.preventDefault())}function l(i){R[i?"unshift":"push"](()=>{o=i,r(0,o)})}function f(i){n=i,gr.set(n)}return[o,n,s,l,f]}class Tu extends U{constructor(e){super(),H(this,e,Su,ku,W,{})}}function Cu(t,e,r){let{loadFile:n}=e;return jt(async()=>{let s=await(await fetch(`${fr()}/v1/random_schemes.geojson`)).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class Au extends U{constructor(e){super(),H(this,e,Cu,null,W,{loadFile:0})}}function Ou(t){let e;return{c(){e=v("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Lu(t){let e;return{c(){e=v("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Du(t){let e,r,n=t[0].authority_or_region+"",o,s,l,f,i=t[0].capital_scheme_id+"",a,u,c,p,$=t[0].funding_programme+"",S,y,T,C,P,I,k;return C=new Yt({props:{$$slots:{default:[Ou]},$$scope:{ctx:t}}}),C.$on("click",t[3]),I=new Yt({props:{disabled:t[1],title:t[2],$$slots:{default:[Lu]},$$scope:{ctx:t}}}),I.$on("click",t[4]),{c(){e=M("p"),r=v("Authority or region: "),o=v(n),s=A(),l=M("p"),f=v("Capital scheme ID: "),a=v(i),u=A(),c=M("p"),p=v("Funding programme: "),S=v($),y=A(),T=M("div"),_(C.$$.fragment),P=A(),_(I.$$.fragment),j(T,"class","govuk-button-group")},m(L,F){m(L,e,F),E(e,r),E(e,o),m(L,s,F),m(L,l,F),E(l,f),E(l,a),m(L,u,F),m(L,c,F),E(c,p),E(c,S),m(L,y,F),m(L,T,F),w(C,T,null),E(T,P),w(I,T,null),k=!0},p(L,F){(!k||F&1)&&n!==(n=L[0].authority_or_region+"")&&Te(o,n),(!k||F&1)&&i!==(i=L[0].capital_scheme_id+"")&&Te(a,i),(!k||F&1)&&$!==($=L[0].funding_programme+"")&&Te(S,$);const D={};F&256&&(D.$$scope={dirty:F,ctx:L}),C.$set(D);const O={};F&256&&(O.$$scope={dirty:F,ctx:L}),I.$set(O)},i(L){k||(d(C.$$.fragment,L),d(I.$$.fragment,L),k=!0)},o(L){g(C.$$.fragment,L),g(I.$$.fragment,L),k=!1},d(L){L&&(h(e),h(s),h(l),h(u),h(c),h(y),h(T)),b(C),b(I)}}}function Eu(t){let e,r;return e=new Be({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Du]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Pu(t,e,r){let n,o;X(t,dt,c=>r(6,n=c)),X(t,re,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,f=!l.has(s.authority_or_region),i=f?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function a(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(Qn(c),{padding:20,animate:!1})}function u(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,f,i,a,u,l]}class Mu extends U{constructor(e){super(),H(this,e,Pu,Eu,W,{scheme:0,authorityNames:5})}}const Nu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ie=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{f(r.next(i))}catch(a){o(a)}},l=i=>{try{f(r.throw(i))}catch(a){o(a)}},f=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);f((r=r.apply(t,e)).next())}),de=Uint8Array,mt=Uint16Array,Iu=Int32Array,In=new de([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Fn=new de([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Fu=new de([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Bn=function(t,e){for(var r=new mt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new Iu(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},xn=Bn(In,2),jn=xn.b,Bu=xn.r;jn[28]=258,Bu[258]=28;var xu=Bn(Fn,0),ju=xu.b,sr=new mt(32768);for(Z=0;Z<32768;++Z)Fe=(Z&43690)>>1|(Z&21845)<<1,Fe=(Fe&52428)>>2|(Fe&13107)<<2,Fe=(Fe&61680)>>4|(Fe&3855)<<4,sr[Z]=((Fe&65280)>>8|(Fe&255)<<8)>>1;var Fe,Z,kt=function(t,e,r){for(var n=t.length,o=0,s=new mt(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new mt(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new mt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var a=o<<4|t[o],u=e-t[o],c=l[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)f[sr[c]>>i]=a}else for(f=new mt(n),o=0;o<n;++o)t[o]&&(f[o]=sr[l[t[o]-1]++]>>15-t[o]);return f},Lt=new de(288);for(Z=0;Z<144;++Z)Lt[Z]=8;var Z;for(Z=144;Z<256;++Z)Lt[Z]=9;var Z;for(Z=256;Z<280;++Z)Lt[Z]=7;var Z;for(Z=280;Z<288;++Z)Lt[Z]=8;var Z,Rn=new de(32);for(Z=0;Z<32;++Z)Rn[Z]=5;var Z,Ru=kt(Lt,9,1),Uu=kt(Rn,5,1),Zt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Xt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Hu=function(t){return(t+7)/8|0},Wu=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new de(r-e);return n.set(t.subarray(e,r)),n},zu=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$e=function(t,e,r){var n=new Error(e||zu[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,$e),!r)throw n;return n},pr=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new de(0);var l=!r||e.i!=2,f=e.i;r||(r=new de(o*3));var i=function($r){var mr=r.length;if($r>mr){var hr=new de(Math.max(mr*2,$r));hr.set(r),r=hr}},a=e.f||0,u=e.p||0,c=e.b||0,p=e.l,$=e.d,S=e.m,y=e.n,T=o*8;do{if(!p){a=ve(t,u,1);var C=ve(t,u+1,3);if(u+=3,C)if(C==1)p=Ru,$=Uu,S=9,y=5;else if(C==2){var L=ve(t,u,31)+257,F=ve(t,u+10,15)+4,D=L+ve(t,u+5,31)+1;u+=14;for(var O=new de(D),N=new de(19),B=0;B<F;++B)N[Fu[B]]=ve(t,u+B*3,7);u+=F*3;for(var z=Zt(N),ee=(1<<z)-1,V=kt(N,z,1),B=0;B<D;){var Ce=V[ve(t,u,ee)];u+=Ce&15;var P=Ce>>4;if(P<16)O[B++]=P;else{var Ne=0,ce=0;for(P==16?(ce=3+ve(t,u,3),u+=2,Ne=O[B-1]):P==17?(ce=3+ve(t,u,7),u+=3):P==18&&(ce=11+ve(t,u,127),u+=7);ce--;)O[B++]=Ne}}var Dt=O.subarray(0,L),pe=O.subarray(L);S=Zt(Dt),y=Zt(pe),p=kt(Dt,S,1),$=kt(pe,y,1)}else $e(1);else{var P=Hu(u)+4,I=t[P-4]|t[P-3]<<8,k=P+I;if(k>o){f&&$e(0);break}l&&i(c+I),r.set(t.subarray(P,k),c),e.b=c+=I,e.p=u=k*8,e.f=a;continue}if(u>T){f&&$e(0);break}}l&&i(c+131072);for(var _t=(1<<S)-1,Re=(1<<y)-1,lt=u;;lt=u){var Ne=p[Xt(t,u)&_t],we=Ne>>4;if(u+=Ne&15,u>T){f&&$e(0);break}if(Ne||$e(2),we<256)r[c++]=we;else if(we==256){lt=u,p=null;break}else{var at=we-254;if(we>264){var B=we-257,Ie=In[B];at=ve(t,u,(1<<Ie)-1)+jn[B],u+=Ie}var ft=$[Xt(t,u)&Re],ut=ft>>4;ft||$e(3),u+=ft&15;var pe=ju[ut];if(ut>3){var Ie=Fn[ut];pe+=Xt(t,u)&(1<<Ie)-1,u+=Ie}if(u>T){f&&$e(0);break}l&&i(c+131072);var ct=c+at;if(c<pe){var wt=s-pe,Kn=Math.min(pe,ct);for(wt+c<0&&$e(3);c<Kn;++c)r[c]=n[wt+c]}for(;c<ct;c+=4)r[c]=r[c-pe],r[c+1]=r[c+1-pe],r[c+2]=r[c+2-pe],r[c+3]=r[c+3-pe];c=ct}}e.l=p,e.p=lt,e.b=c,e.f=a,p&&(a=1,e.m=S,e.d=$,e.n=y)}while(!a);return c==r.length?r:Wu(r,0,c)},Vu=new de(0),Gu=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&$e(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},qu=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Ku=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&$e(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&$e(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Zu(t,e){return pr(t,{i:2},e&&e.out,e&&e.dictionary)}function Xu(t,e){var r=Gu(t);return r+8>t.length&&$e(6,"invalid gzip data"),pr(t.subarray(r,-8),{i:2},e&&e.out||new de(qu(t)),e&&e.dictionary)}function Yu(t,e){return pr(t.subarray(Ku(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function ir(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Xu(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Zu(t,e):Yu(t,e)}var Ju=typeof TextDecoder<"u"&&new TextDecoder,Qu=0;try{Ju.decode(Vu,{stream:!0}),Qu=1}catch{}var Un=(t,e)=>t*Math.pow(2,e),bt=(t,e)=>Math.floor(t/Math.pow(2,e)),Bt=(t,e)=>Un(t.getUint16(e+1,!0),8)+t.getUint8(e),Hn=(t,e)=>Un(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),ec=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Bt(n,o+1);if(e!=s)return e-s;const l=Bt(n,o+4);return r!=l?r-l:0},tc=(t,e,r,n)=>{const o=Wn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Qr=(t,e,r,n)=>{const o=Wn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},Wn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,f=ec(e,r,n,t,l*17);if(f>0)o=l+1;else if(f<0)s=l-1;else return[Hn(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},rc=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,zn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Bt(t,e*17+1),y:Bt(t,e*17+4),offset:Hn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},en=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(zn(r,n));return nc(e)},nc=t=>{t.sort(rc);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=bt(o.offset,8)&255,r[n*17+9]=bt(o.offset,16)&255,r[n*17+10]=bt(o.offset,24)&255,r[n*17+11]=bt(o.offset,32)&255,r[n*17+12]=bt(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},oc=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=zn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),f=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:f}}return null};function sc(t){return ie(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let f=0;l.compression==="gzip"&&(f=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let a=0;"maxzoom"in l&&(a=+l.maxzoom);let u=0,c=0,p=0,$=-180,S=-85,y=180,T=85;if(l.bounds){const P=l.bounds.split(",");$=+P[0],S=+P[1],y=+P[2],T=+P[3]}if(l.center){const P=l.center.split(",");u=+P[0],c=+P[1],p=+P[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:f,tileType:1,minZoom:i,maxZoom:a,minLon:$,minLat:S,maxLon:y,maxLat:T,centerZoom:p,centerLon:u,centerLat:c,etag:e.etag}})}function ic(t,e,r,n,o,s,l){return ie(this,null,function*(){let f=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(f=en(f));const i=Qr(new DataView(f),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=ir(new Uint8Array(c))),{data:c}}const a=oc(new DataView(f),{z:n,x:o,y:s});if(a){const u=tc(new DataView(f),a.z,a.x,a.y);if(u){let c=yield r.getArrayBuffer(e,u.offset,u.length,t);t.specVersion===1&&(c=en(c));const p=Qr(new DataView(c),n,o,s);if(p){let S=(yield e.getBytes(p.offset,p.length,l)).data;const y=new DataView(S);return y.getUint8(0)==31&&y.getUint8(1)==139&&(S=ir(new Uint8Array(S))),{data:S}}}}})}var Vn={getHeader:sc,getZxy:ic},lc=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new tn(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new tn(o),this.tiles.set(o,s));const l=n[2],f=n[3],i=n[4],a=new AbortController,u=a.signal;let c=()=>{a.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+f,+i,u).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function pt(t,e){return(e>>>0)*4294967296+(t>>>0)}function ac(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return pt(t,n);throw new Error("Expected varint not more than 10 bytes")}function vt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,ac(r,t))}function fc(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var uc=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function cc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=uc[t],o=Math.pow(2,t);let s=0,l=0,f=0;const i=[e,r];let a=o/2;for(;a>0;)s=(i[0]&a)>0?1:0,l=(i[1]&a)>0?1:0,f+=a*a*(3*s^l),fc(a,i,s,l),a=a/2;return n+f}function Gn(t,e){return ie(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return ir(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var pc=127;function $c(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var mc=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ie(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const f=o.headers.get("Content-Range");if(!f||!f.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+f.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ye(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function hc(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ye(r,8),rootDirectoryLength:ye(r,16),jsonMetadataOffset:ye(r,24),jsonMetadataLength:ye(r,32),leafDirectoryOffset:ye(r,40),leafDirectoryLength:ye(r,48),tileDataOffset:ye(r,56),tileDataLength:ye(r,64),numAddressedTiles:ye(r,72),numTileEntries:ye(r,80),numTileContents:ye(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function qn(t){const e={buf:new Uint8Array(t),pos:0},r=vt(e),n=[];let o=0;for(let s=0;s<r;s++){const l=vt(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=vt(e);for(let s=0;s<r;s++)n[s].length=vt(e);for(let s=0;s<r;s++){const l=vt(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function dc(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ht=class extends Error{};function gc(t,e,r,n){return ie(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(dc(o.data)<3)return[yield Vn.getHeader(t)];const l=o.data.slice(0,pc);let f=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),f=void 0);const i=hc(l,f);if(r){const a=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),u=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=qn(yield e(a,i.internalCompression));return[i,[u,c.length,c]]}return[i,void 0]})}function _c(t,e,r,n,o){return ie(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new ht(s.etag);const l=yield e(s.data,o.internalCompression),f=qn(l);if(f.length===0)throw new Error("Empty directory is invalid");return f})}var wc=class{constructor(t=100,e=!0,r=Gn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ie(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{gc(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{_c(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new ht(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ie(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},tn=class{constructor(t,e,r){typeof t=="string"?this.source=new mc(t):this.source=t,r?this.decompress=r:this.decompress=Gn,e?this.cache=e:this.cache=new wc}getHeader(){return ie(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ie(this,null,function*(){const o=cc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Vn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,f=s.rootDirectoryLength;for(let i=0;i<=3;i++){const a=yield this.cache.getDirectory(this.source,l,f,s),u=$c(a,o);if(u)if(u.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+u.offset,u.length,n);if(s.etag&&s.etag!==c.etag)throw new ht(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+u.offset,f=u.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ie(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof ht)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ie(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new ht(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ie(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof ht)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function bc(t){return jt(()=>{let e=new lc;_r.addProtocol("pmtiles",e.tile)}),dn(()=>{_r.removeProtocol("pmtiles")}),[]}class vc extends U{constructor(e){super(),H(this,e,bc,null,W,{})}}function rn(t,e,r){const n=t.slice();return n[13]=e[r],n}function yc(t){let e,r;return e=new Au({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:J,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function nn(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let f={schemes:t[1]};return t[2]!==void 0&&(f.schemesToBeShown=t[2]),t[3]!==void 0&&(f.filterText=t[3]),e=new Ni({props:f}),R.push(()=>q(e,"schemesToBeShown",s)),R.push(()=>q(e,"filterText",l)),{c(){_(e.$$.fragment)},m(i,a){w(e,i,a),o=!0},p(i,a){const u={};a&2&&(u.schemes=i[1]),!r&&a&4&&(r=!0,u.schemesToBeShown=i[2],K(()=>r=!1)),!n&&a&8&&(n=!0,u.filterText=i[3],K(()=>n=!1)),e.$set(u)},i(i){o||(d(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function on(t){let e,r;return e=new Mu({props:{scheme:t[13],authorityNames:t[6]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function sn(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&on(t);return{c(){o&&o.c(),r=Rt()},m(s,l){o&&o.m(s,l),m(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&d(o,1)):(o=on(s),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(ae(),g(o,1,1,()=>{o=null}),fe())},i(s){n||(d(o),n=!0)},o(s){g(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function kc(t){let e,r,n,o,s,l,f,i,a,u,c=lr()=="Private (development)",p,$,S,y,T,C,P,I;s=new fo({props:{boundaryGeojson:t[5]}}),f=new vo({}),a=new eo({});let k=c&&yc(t);$=new co({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),y=new hn({props:{errorMessage:t[0]}});let L=t[1].size>0&&nn(t),F=Ge(t[1].values()),D=[];for(let N=0;N<F.length;N+=1)D[N]=sn(rn(t,F,N));const O=N=>g(D[N],1,1,()=>{D[N]=null});return{c(){e=M("div"),r=M("div"),n=M("h1"),n.textContent="Browse schemes",o=A(),_(s.$$.fragment),l=A(),_(f.$$.fragment),i=A(),_(a.$$.fragment),u=A(),k&&k.c(),p=A(),_($.$$.fragment),S=A(),_(y.$$.fragment),T=A(),L&&L.c(),C=A(),P=M("ul");for(let N=0;N<D.length;N+=1)D[N].c();xe(r,"display","flex"),xe(r,"justify-content","space-between"),j(e,"slot","sidebar"),j(e,"class","govuk-prose")},m(N,B){m(N,e,B),E(e,r),E(r,n),E(r,o),w(s,r,null),E(e,l),w(f,e,null),E(e,i),w(a,e,null),E(e,u),k&&k.m(e,null),E(e,p),w($,e,null),E(e,S),w(y,e,null),E(e,T),L&&L.m(e,null),E(e,C),E(e,P);for(let z=0;z<D.length;z+=1)D[z]&&D[z].m(P,null);I=!0},p(N,B){const z={};B&32&&(z.boundaryGeojson=N[5]),s.$set(z),c&&k.p(N,B);const ee={};if(B&1&&(ee.errorMessage=N[0]),y.$set(ee),N[1].size>0?L?(L.p(N,B),B&2&&d(L,1)):(L=nn(N),L.c(),d(L,1),L.m(e,C)):L&&(ae(),g(L,1,1,()=>{L=null}),fe()),B&70){F=Ge(N[1].values());let V;for(V=0;V<F.length;V+=1){const Ce=rn(N,F,V);D[V]?(D[V].p(Ce,B),d(D[V],1)):(D[V]=sn(Ce),D[V].c(),d(D[V],1),D[V].m(P,null))}for(ae(),V=F.length;V<D.length;V+=1)O(V);fe()}},i(N){if(!I){d(s.$$.fragment,N),d(f.$$.fragment,N),d(a.$$.fragment,N),d(k),d($.$$.fragment,N),d(y.$$.fragment,N),d(L);for(let B=0;B<F.length;B+=1)d(D[B]);I=!0}},o(N){g(s.$$.fragment,N),g(f.$$.fragment,N),g(a.$$.fragment,N),g(k),g($.$$.fragment,N),g(y.$$.fragment,N),g(L),D=D.filter(Boolean);for(let B=0;B<D.length;B+=1)g(D[B]);I=!1},d(N){N&&h(e),b(s),b(f),b(a),k&&k.d(),b($),b(y),L&&L.d(),Nt(D,N)}}}function Sc(t){let e,r,n,o,s,l,f,i,a,u,c;return e=new uo({props:{colorInterventions:gn("v1")}}),n=new Q({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new Q({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),f=new Q({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),u=new Tu({}),{c(){_(e.$$.fragment),r=A(),_(n.$$.fragment),o=A(),_(s.$$.fragment),l=A(),_(f.$$.fragment),i=A(),a=M("div"),_(u.$$.fragment),j(a,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(f,p,$),m(p,i,$),m(p,a,$),w(u,a,null),c=!0},p:J,i(p){c||(d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(f.$$.fragment,p),d(u.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(f.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(l),h(i),h(a)),b(e,p),b(n,p),b(s,p),b(f,p),b(u)}}}function Tc(t){let e,r,n,o,s;return r=new vc({}),o=new lo({props:{style:t[4],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Sc]},$$scope:{ctx:t}}}),{c(){e=M("div"),_(r.$$.fragment),n=A(),_(o.$$.fragment),j(e,"slot","main")},m(l,f){m(l,e,f),w(r,e,null),E(e,n),w(o,e,null),s=!0},p(l,f){const i={};f&16&&(i.style=l[4]),f&65536&&(i.$$scope={dirty:f,ctx:l}),o.$set(i)},i(l){s||(d(r.$$.fragment,l),d(o.$$.fragment,l),s=!0)},o(l){g(r.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&h(e),b(r),b(o)}}}function Cc(t){let e,r;return e=new io({props:{$$slots:{main:[Tc],sidebar:[kc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65599&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ac(t,e,r){let n,o;X(t,wr,T=>r(4,n=T)),X(t,dt,T=>r(5,o=T));let s=new Set(Nu);jt(()=>{to()});const l=new URLSearchParams(window.location.search);wr.set(l.get("style")||"dataviz");let f="",i=new Map,a=new Set,u="";dn(()=>{dt.set(mn())});function c(T){try{let C=JSON.parse(T);r(1,i=yi(C)),dt.set(C),r(0,f="")}catch(C){r(0,f=`The file you loaded is broken: ${C}`)}}function p(T){let C=T.properties;var P='<div style="max-width: 30vw;">';return P+=`<h2>${$(C.name)} (${C.intervention_type})</h2>`,P+=`<p>Scheme reference: ${C.scheme_reference}</p>`,C.length_meters&&(P+=`<p>Length: ${ro(C.length_meters)}</p>`),C.description&&(P+=`<p>${$(C.description)}</p>`),P+="</div>",P}function $(T){return u?T.replace(new RegExp(u,"gi"),C=>`<mark>${C}</mark>`):T}function S(T){a=T,r(2,a)}function y(T){u=T,r(3,u)}return[f,i,a,u,n,o,s,c,p,S,y]}class Oc extends U{constructor(e){super(),H(this,e,Ac,Cc,W,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Oc({target:document.getElementById("app")});
