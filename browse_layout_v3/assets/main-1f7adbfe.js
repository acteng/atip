import{S as ne,i as le,s as ae,F as Ae,c as w,m as k,t as g,a as d,d as A,v as Se,e as ce,b as v,f as S,g as y,h as L,j as K,l as $e,k as M,n as ye,r as Le,o as Me,p as B,q as c,u as Z,w as Ce,x as Y,L as Ee,y as Te,E as ge,D as Ie,R as Fe,z as x,A as ee,B as He,M as Ne,C as Oe,G as Be,H as te,I as Je,J as je,K as De,N as Ge,O as Pe,P as Re,Q as Ue,T as Ve,U as qe,V as ze,W as Ke,X as Qe}from"./index-12949150.js";import{A as We}from"./About-4dc186c6.js";import{P as Xe}from"./Popup-addc1aa5.js";function _e(a,e,n){const t=a.slice();return t[0]=e[n][0],t[3]=e[n][1],t}function de(a){let e,n;return{c(){e=S("div"),n=B(a[2]),y(e,"class","govuk-hint")},m(t,s){L(t,e,s),c(e,n)},p(t,s){s&4&&Z(n,t[2])},d(t){t&&M(e)}}}function he(a){let e,n,t;return{c(){e=S("option"),e.__value=n=a[0],K(e,e.__value),y(e,"label",t=a[3])},m(s,l){L(s,e,l)},p(s,l){l&2&&n!==(n=s[0])&&(e.__value=n,K(e,e.__value)),l&2&&t!==(t=s[3])&&y(e,"label",t)},d(s){s&&M(e)}}}function Ye(a){let e,n,t,s,l,r,u=a[2]&&de(a),p=ce(a[1]),f=[];for(let o=0;o<p.length;o+=1)f[o]=he(_e(a,p,o));return{c(){u&&u.c(),e=v(),n=S("input"),t=v(),s=S("datalist");for(let o=0;o<f.length;o+=1)f[o].c();y(n,"class","govuk-input govuk-input--width-20"),y(n,"id",a[4]),y(n,"list",`${a[4]}-list`),y(s,"id",`${a[4]}-list`)},m(o,h){u&&u.m(o,h),L(o,e,h),L(o,n,h),K(n,a[0]),L(o,t,h),L(o,s,h);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(s,null);l||(r=[$e(n,"input",a[6]),$e(n,"change",a[5])],l=!0)},p(o,h){if(o[2]?u?u.p(o,h):(u=de(o),u.c(),u.m(e.parentNode,e)):u&&(u.d(1),u=null),h&1&&n.value!==o[0]&&K(n,o[0]),h&2){p=ce(o[1]);let m;for(m=0;m<p.length;m+=1){const H=_e(o,p,m);f[m]?f[m].p(H,h):(f[m]=he(H),f[m].c(),f[m].m(s,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=p.length}},d(o){o&&(M(e),M(n),M(t),M(s)),u&&u.d(o),ye(f,o),l=!1,Le(r)}}}function Ze(a){let e,n;return e=new Ae({props:{label:a[3],id:a[4],$$slots:{default:[Ye]},$$scope:{ctx:a}}}),{c(){w(e.$$.fragment)},m(t,s){k(e,t,s),n=!0},p(t,[s]){const l={};s&8&&(l.label=t[3]),s&519&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function xe(a,e,n){let{label:t}=e,{value:s}=e,{options:l}=e,{hint:r=""}=e,u=Se();function p(o){Me.call(this,a,o)}function f(){s=this.value,n(0,s)}return a.$$set=o=>{"label"in o&&n(3,t=o.label),"value"in o&&n(0,s=o.value),"options"in o&&n(1,l=o.options),"hint"in o&&n(2,r=o.hint)},[s,l,r,t,u,p,f]}class et extends ne{constructor(e){super(),le(this,e,xe,Ze,ae,{label:3,value:0,options:1,hint:2})}}function tt(a){let e,n,t;return{c(){e=S("div"),e.innerHTML=`<img src="${Ce}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,n=v(),t=S("div"),y(e,"class","black-bar svelte-13flgp1"),y(t,"class","green-bar svelte-13flgp1")},m(s,l){L(s,e,l),L(s,n,l),L(s,t,l)},p:Y,i:Y,o:Y,d(s){s&&(M(e),M(n),M(t))}}}class nt extends ne{constructor(e){super(),le(this,e,null,tt,ae,{})}}function lt(a){let e;return{c(){e=B("About")},m(n,t){L(n,e,t)},d(n){n&&M(e)}}}function ve(a){let e,n,t;function s(r){a[10](r)}let l={label:"Select Transport Authority or Local Authority District",options:a[1].features.map(be)};return a[0]!==void 0&&(l.value=a[0]),e=new et({props:l}),x.push(()=>ee(e,"value",s)),{c(){w(e.$$.fragment)},m(r,u){k(e,r,u),t=!0},p(r,u){const p={};u&2&&(p.options=r[1].features.map(be)),!n&&u&1&&(n=!0,p.value=r[0],te(()=>n=!1)),e.$set(p)},i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){A(e,r)}}}function at(a){let e;return{c(){e=B("Start")},m(n,t){L(n,e,t)},d(n){n&&M(e)}}}function st(a){let e,n=a[17].name+"",t,s,l=a[17].level+"",r,u;return{c(){e=S("p"),t=B(n),s=B(" ("),r=B(l),u=B(")")},m(p,f){L(p,e,f),c(e,t),c(e,s),c(e,r),c(e,u)},p(p,f){f&131072&&n!==(n=p[17].name+"")&&Z(t,n),f&131072&&l!==(l=p[17].level+"")&&Z(r,l)},d(p){p&&M(e)}}}function ot(a){let e,n;return e=new Xe({props:{$$slots:{default:[st,({props:t})=>({17:t}),({props:t})=>t?131072:0]},$$scope:{ctx:a}}}),{c(){w(e.$$.fragment)},m(t,s){k(e,t,s),n=!0},p(t,s){const l={};s&393216&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function rt(a){let e,n,t,s;return e=new qe({props:{id:"boundaries",filter:["==",["get","level"],a[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":ze(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[ot]},$$scope:{ctx:a}}}),e.$on("click",a[7]),t=new Ke({props:{id:"boundaries-outline",filter:["==",["get","level"],a[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){w(e.$$.fragment),n=v(),w(t.$$.fragment)},m(l,r){k(e,l,r),L(l,n,r),k(t,l,r),s=!0},p(l,r){const u={};r&16&&(u.filter=["==",["get","level"],l[4]]),r&262144&&(u.$$scope={dirty:r,ctx:l}),e.$set(u);const p={};r&16&&(p.filter=["==",["get","level"],l[4]]),t.$set(p)},i(l){s||(g(e.$$.fragment,l),g(t.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(t.$$.fragment,l),s=!1},d(l){l&&M(n),A(e,l),A(t,l)}}}function it(a){let e,n;return e=new De({props:{data:a[1],generateId:!0,$$slots:{default:[rt]},$$scope:{ctx:a}}}),{c(){w(e.$$.fragment)},m(t,s){k(e,t,s),n=!0},p(t,s){const l={};s&2&&(l.data=t[1]),s&262160&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function ut(a){let e,n,t,s,l,r,u,p,f,o,h,m,H,D,E,R,U,V,T,$,N,C,G,I,J,j,se,q,P,O,Q,F,W,z;t=new nt({}),r=new Ee({}),o=new Te({props:{$$slots:{default:[lt]},$$scope:{ctx:a}}}),o.$on("click",a[9]),m=new ge({props:{errorMessage:a[3]}});let _=a[1].features.length>0&&ve(a);E=new Ie({props:{disabled:!a[5],$$slots:{default:[at]},$$scope:{ctx:a}}}),E.$on("click",a[8]);function we(i){a[11](i)}let oe={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};a[4]!==void 0&&(oe.value=a[4]),T=new Fe({props:oe}),x.push(()=>ee(T,"value",we)),I=new ge({props:{errorMessage:ft}}),j=new He({props:{label:"Or upload an ATIP GeoJSON file",onLoad:a[6]}}),O=new Ne({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[it]},$$scope:{ctx:a}}});function ke(i){a[12](i)}let re={};return a[2]!==void 0&&(re.open=a[2]),F=new We({props:re}),x.push(()=>ee(F,"open",ke)),{c(){e=S("div"),n=S("div"),w(t.$$.fragment),s=v(),l=S("div"),w(r.$$.fragment),u=v(),p=S("p"),p.textContent=`App version: ${Oe()}`,f=v(),w(o.$$.fragment),h=v(),w(m.$$.fragment),H=v(),_&&_.c(),D=v(),w(E.$$.fragment),R=v(),U=S("hr"),V=v(),w(T.$$.fragment),N=v(),C=S("hr"),G=v(),w(I.$$.fragment),J=v(),w(j.$$.fragment),se=v(),q=S("div"),P=S("div"),w(O.$$.fragment),Q=v(),w(F.$$.fragment),y(l,"class","left svelte-lyn11h"),y(n,"class","govuk-grid-column-one-half"),y(P,"id","map"),y(P,"class","svelte-lyn11h"),y(q,"class","govuk-grid-column-one-half"),y(e,"class","govuk-grid-row")},m(i,b){L(i,e,b),c(e,n),k(t,n,null),c(n,s),c(n,l),k(r,l,null),c(l,u),c(l,p),c(l,f),k(o,l,null),c(l,h),k(m,l,null),c(l,H),_&&_.m(l,null),c(l,D),k(E,l,null),c(l,R),c(l,U),c(l,V),k(T,l,null),c(l,N),c(l,C),c(l,G),k(I,l,null),c(l,J),k(j,l,null),c(e,se),c(e,q),c(q,P),k(O,P,null),L(i,Q,b),k(F,i,b),z=!0},p(i,[b]){const ie={};b&262144&&(ie.$$scope={dirty:b,ctx:i}),o.$set(ie);const ue={};b&8&&(ue.errorMessage=i[3]),m.$set(ue),i[1].features.length>0?_?(_.p(i,b),b&2&&g(_,1)):(_=ve(i),_.c(),g(_,1),_.m(l,D)):_&&(Ge(),d(_,1,1,()=>{_=null}),Be());const X={};b&32&&(X.disabled=!i[5]),b&262144&&(X.$$scope={dirty:b,ctx:i}),E.$set(X);const fe={};!$&&b&16&&($=!0,fe.value=i[4],te(()=>$=!1)),T.$set(fe);const pe={};b&262162&&(pe.$$scope={dirty:b,ctx:i}),O.$set(pe);const me={};!W&&b&4&&(W=!0,me.open=i[2],te(()=>W=!1)),F.$set(me)},i(i){z||(g(t.$$.fragment,i),g(r.$$.fragment,i),g(o.$$.fragment,i),g(m.$$.fragment,i),g(_),g(E.$$.fragment,i),g(T.$$.fragment,i),g(I.$$.fragment,i),g(j.$$.fragment,i),g(O.$$.fragment,i),g(F.$$.fragment,i),z=!0)},o(i){d(t.$$.fragment,i),d(r.$$.fragment,i),d(o.$$.fragment,i),d(m.$$.fragment,i),d(_),d(E.$$.fragment,i),d(T.$$.fragment,i),d(I.$$.fragment,i),d(j.$$.fragment,i),d(O.$$.fragment,i),d(F.$$.fragment,i),z=!1},d(i){i&&(M(e),M(Q)),A(t),A(r),A(o),A(m),_&&_.d(),A(E),A(T),A(I),A(j),A(O),A(F,i)}}}let ft="";const be=a=>[a.properties.full_name,`${a.properties.name} (${a.properties.level})`];function pt(a,e,n){let t,s;Je(a,Qe,$=>n(13,s=$));let l={type:"FeatureCollection",features:[]},r=!1,p=new URLSearchParams(window.location.search).get("error")||"",f,o=new Set,h="TA";je(async()=>{Pe(),n(1,l=await Re());for(let $ of l.features)o.add($.properties.full_name)});function m($,N){try{let C=JSON.parse(N),G=Ue(C.features,l);if(!G)throw new Error("Can't figure out the authority boundary that fully contains this scheme");C.authority=G;let I=C.authority,J=H(C);J!="v1"&&(I+=`_${J}`),Ve(I,JSON.stringify(C)),window.location.href=`scheme.html?authority=${C.authority}&schema=${J}`}catch(C){n(3,p=`Couldn't load scheme from a file: ${C}`)}}function H($){if($.features.length>0){let N=$.features[0].properties;for(let C of["pipeline"])if(N&&C in N)return C}return s}function D($){window.location.href=`scheme.html?authority=${$.detail.features[0].properties.full_name}&schema=${s}`}function E(){window.location.href=`scheme.html?authority=${f}&schema=${s}`}const R=()=>n(2,r=!r);function U($){f=$,n(0,f)}function V($){h=$,n(4,h)}function T($){r=$,n(2,r)}return a.$$.update=()=>{a.$$.dirty&1&&n(5,t=o.has(f))},[f,l,r,p,h,t,m,D,E,R,U,V,T]}class mt extends ne{constructor(e){super(),le(this,e,pt,ut,ae,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new mt({target:document.getElementById("app")});
