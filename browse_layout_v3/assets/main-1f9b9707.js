import{S as $e,i as me,s as ce,e as y,l as _e,a as d,b as I,c as C,n as X,d as E,L as he,f as ve,E as ie,D as be,R as we,g as Y,h as Z,F as Ae,M as ye,j as _,k as Se,m as i,o as h,t as $,p as m,q as ke,r as x,u as v,v as Le,w as Me,x as O,G as Ce,y as Ee,z as Te,A as Ie,B as He,C as Be,H as Fe,I as Je,J as Ne,K as Oe,N as ue}from"./index-980b667c.js";import{A as je,P as De}from"./Popup-00bc00d9.js";import{A as Ge}from"./About-32237c0d.js";function Pe(r){let e,a,n;return{c(){e=y("div"),e.innerHTML=`<img src="${_e}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,a=d(),n=y("div"),I(e,"class","black-bar svelte-13flgp1"),I(n,"class","green-bar svelte-13flgp1")},m(l,t){C(l,e,t),C(l,a,t),C(l,n,t)},p:X,i:X,o:X,d(l){l&&(E(e),E(a),E(n))}}}class Re extends $e{constructor(e){super(),me(this,e,null,Pe,ce,{})}}function qe(r){let e;return{c(){e=O("About")},m(a,n){C(a,e,n)},d(a){a&&E(e)}}}function fe(r){let e,a,n;function l(o){r[10](o)}let t={label:"Select Transport Authority or Local Authority District",options:r[1].features.map(pe)};return r[0]!==void 0&&(t.value=r[0]),e=new je({props:t}),Y.push(()=>Z(e,"value",l)),{c(){_(e.$$.fragment)},m(o,g){h(e,o,g),n=!0},p(o,g){const u={};g&2&&(u.options=o[1].features.map(pe)),!a&&g&1&&(a=!0,u.value=o[0],x(()=>a=!1)),e.$set(u)},i(o){n||($(e.$$.fragment,o),n=!0)},o(o){m(e.$$.fragment,o),n=!1},d(o){v(e,o)}}}function Ue(r){let e;return{c(){e=O("Start")},m(a,n){C(a,e,n)},d(a){a&&E(e)}}}function Ve(r){let e,a=r[17].name+"",n,l,t=r[17].level+"",o,g;return{c(){e=y("p"),n=O(a),l=O(" ("),o=O(t),g=O(")")},m(u,w){C(u,e,w),i(e,n),i(e,l),i(e,o),i(e,g)},p(u,w){w&131072&&a!==(a=u[17].name+"")&&ue(n,a),w&131072&&t!==(t=u[17].level+"")&&ue(o,t)},d(u){u&&E(e)}}}function ze(r){let e,a;return e=new De({props:{$$slots:{default:[Ve,({props:n})=>({17:n}),({props:n})=>n?131072:0]},$$scope:{ctx:r}}}),{c(){_(e.$$.fragment)},m(n,l){h(e,n,l),a=!0},p(n,l){const t={};l&393216&&(t.$$scope={dirty:l,ctx:n}),e.$set(t)},i(n){a||($(e.$$.fragment,n),a=!0)},o(n){m(e.$$.fragment,n),a=!1},d(n){v(e,n)}}}function Ke(r){let e,a,n,l;return e=new Fe({props:{id:"boundaries",filter:["==",["get","level"],r[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":Je(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[ze]},$$scope:{ctx:r}}}),e.$on("click",r[7]),n=new Ne({props:{id:"boundaries-outline",filter:["==",["get","level"],r[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){_(e.$$.fragment),a=d(),_(n.$$.fragment)},m(t,o){h(e,t,o),C(t,a,o),h(n,t,o),l=!0},p(t,o){const g={};o&16&&(g.filter=["==",["get","level"],t[4]]),o&262144&&(g.$$scope={dirty:o,ctx:t}),e.$set(g);const u={};o&16&&(u.filter=["==",["get","level"],t[4]]),n.$set(u)},i(t){l||($(e.$$.fragment,t),$(n.$$.fragment,t),l=!0)},o(t){m(e.$$.fragment,t),m(n.$$.fragment,t),l=!1},d(t){t&&E(a),v(e,t),v(n,t)}}}function Qe(r){let e,a;return e=new Ce({props:{data:r[1],generateId:!0,$$slots:{default:[Ke]},$$scope:{ctx:r}}}),{c(){_(e.$$.fragment)},m(n,l){h(e,n,l),a=!0},p(n,l){const t={};l&2&&(t.data=n[1]),l&262160&&(t.$$scope={dirty:l,ctx:n}),e.$set(t)},i(n){a||($(e.$$.fragment,n),a=!0)},o(n){m(e.$$.fragment,n),a=!1},d(n){v(e,n)}}}function We(r){let e,a,n,l,t,o,g,u,w,A,F,L,P,j,S,R,q,U,k,f,H,b,D,M,J,N,ee,V,G,B,K,T,Q,z;n=new Re({}),o=new he({}),A=new ve({props:{$$slots:{default:[qe]},$$scope:{ctx:r}}}),A.$on("click",r[9]),L=new ie({props:{errorMessage:r[3]}});let p=r[1].features.length>0&&fe(r);S=new be({props:{disabled:!r[5],$$slots:{default:[Ue]},$$scope:{ctx:r}}}),S.$on("click",r[8]);function ge(s){r[11](s)}let te={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};r[4]!==void 0&&(te.value=r[4]),k=new we({props:te}),Y.push(()=>Z(k,"value",ge)),M=new ie({props:{errorMessage:Xe}}),N=new Ae({props:{label:"Or upload an ATIP GeoJSON file",onLoad:r[6]}}),B=new ye({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Qe]},$$scope:{ctx:r}}});function de(s){r[12](s)}let ne={};return r[2]!==void 0&&(ne.open=r[2]),T=new Ge({props:ne}),Y.push(()=>Z(T,"open",de)),{c(){e=y("div"),a=y("div"),_(n.$$.fragment),l=d(),t=y("div"),_(o.$$.fragment),g=d(),u=y("p"),u.textContent=`App version: ${Se()}`,w=d(),_(A.$$.fragment),F=d(),_(L.$$.fragment),P=d(),p&&p.c(),j=d(),_(S.$$.fragment),R=d(),q=y("hr"),U=d(),_(k.$$.fragment),H=d(),b=y("hr"),D=d(),_(M.$$.fragment),J=d(),_(N.$$.fragment),ee=d(),V=y("div"),G=y("div"),_(B.$$.fragment),K=d(),_(T.$$.fragment),I(t,"class","left svelte-lyn11h"),I(a,"class","govuk-grid-column-one-half"),I(G,"id","map"),I(G,"class","svelte-lyn11h"),I(V,"class","govuk-grid-column-one-half"),I(e,"class","govuk-grid-row")},m(s,c){C(s,e,c),i(e,a),h(n,a,null),i(a,l),i(a,t),h(o,t,null),i(t,g),i(t,u),i(t,w),h(A,t,null),i(t,F),h(L,t,null),i(t,P),p&&p.m(t,null),i(t,j),h(S,t,null),i(t,R),i(t,q),i(t,U),h(k,t,null),i(t,H),i(t,b),i(t,D),h(M,t,null),i(t,J),h(N,t,null),i(e,ee),i(e,V),i(V,G),h(B,G,null),C(s,K,c),h(T,s,c),z=!0},p(s,[c]){const ae={};c&262144&&(ae.$$scope={dirty:c,ctx:s}),A.$set(ae);const re={};c&8&&(re.errorMessage=s[3]),L.$set(re),s[1].features.length>0?p?(p.p(s,c),c&2&&$(p,1)):(p=fe(s),p.c(),$(p,1),p.m(t,j)):p&&(Ee(),m(p,1,1,()=>{p=null}),ke());const W={};c&32&&(W.disabled=!s[5]),c&262144&&(W.$$scope={dirty:c,ctx:s}),S.$set(W);const se={};!f&&c&16&&(f=!0,se.value=s[4],x(()=>f=!1)),k.$set(se);const oe={};c&262162&&(oe.$$scope={dirty:c,ctx:s}),B.$set(oe);const le={};!Q&&c&4&&(Q=!0,le.open=s[2],x(()=>Q=!1)),T.$set(le)},i(s){z||($(n.$$.fragment,s),$(o.$$.fragment,s),$(A.$$.fragment,s),$(L.$$.fragment,s),$(p),$(S.$$.fragment,s),$(k.$$.fragment,s),$(M.$$.fragment,s),$(N.$$.fragment,s),$(B.$$.fragment,s),$(T.$$.fragment,s),z=!0)},o(s){m(n.$$.fragment,s),m(o.$$.fragment,s),m(A.$$.fragment,s),m(L.$$.fragment,s),m(p),m(S.$$.fragment,s),m(k.$$.fragment,s),m(M.$$.fragment,s),m(N.$$.fragment,s),m(B.$$.fragment,s),m(T.$$.fragment,s),z=!1},d(s){s&&(E(e),E(K)),v(n),v(o),v(A),v(L),p&&p.d(),v(S),v(k),v(M),v(N),v(B),v(T,s)}}}let Xe="";const pe=r=>[r.properties.full_name,`${r.properties.name} (${r.properties.level})`];function Ye(r,e,a){let n,l;Le(r,Oe,f=>a(13,l=f));let t={type:"FeatureCollection",features:[]},o=!1,u=new URLSearchParams(window.location.search).get("error")||"",w,A=new Set,F="TA";Me(async()=>{Te(),a(1,t=await Ie());for(let f of t.features)A.add(f.properties.full_name)});function L(f,H){try{let b=JSON.parse(H),D=He(b.features,t);if(!D)throw new Error("Can't figure out the authority boundary that fully contains this scheme");b.authority=D;let M=b.authority,J=P(b);J!="v1"&&(M+=`_${J}`),Be(M,JSON.stringify(b)),window.location.href=`scheme.html?authority=${b.authority}&schema=${J}`}catch(b){a(3,u=`Couldn't load scheme from a file: ${b}`)}}function P(f){if(f.features.length>0){let H=f.features[0].properties;for(let b of["pipeline"])if(H&&b in H)return b}return l}function j(f){window.location.href=`scheme.html?authority=${f.detail.features[0].properties.full_name}&schema=${l}`}function S(){window.location.href=`scheme.html?authority=${w}&schema=${l}`}const R=()=>a(2,o=!o);function q(f){w=f,a(0,w)}function U(f){F=f,a(4,F)}function k(f){o=f,a(2,o)}return r.$$.update=()=>{r.$$.dirty&1&&a(5,n=A.has(w))},[w,t,o,u,F,n,L,j,S,R,q,U,k]}class Ze extends $e{constructor(e){super(),me(this,e,Ye,We,ce,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new Ze({target:document.getElementById("app")});
