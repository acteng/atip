import{S as x,i as V,s as H,b as K,c as q,I as oe,g as b,f as S,m as k,j as g,o as W,t as w,y as be,l as v,n as ke,p as d,q as L,_ as J,C as se,aW as Be,a1 as Ce,G as pe,a7 as Te,V as we,e as M,X as ue,W as Ze,u as T,k as D,x as $e,U as re,h as F,a0 as yt,aV as j,a2 as Le,r as Ke,F as Zt,a as Pe,v as ot,w as Rt,H as Gt,L as Kt,M as qt,N as Wt,az as Jt,D as bt,aX as st,ag as kt,d as Xt,z as Yt,A as Qt,a9 as en,aP as tn,E as nn,ad as rn}from"./data_getter-3ebc0604.js";import{d as me,S as Ne,H as he,j as De,C as qe,h as on,i as it,g as Lt,L as sn,Z as ln,M as an,I as cn,b as un,B as fn}from"./Map-39b222ac.js";const R={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function lt(o,e,n){const t=o.slice();return t[13]=e[n],t}function at(o,e,n){const t=o.slice();return t[16]=e[n],t}function pn(o){let e;return{c(){e=T("Census Output Areas")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function $n(o){let e;return{c(){e=M("p"),e.textContent="TODO!"},m(n,t){g(n,e,t)},p:$e,d(n){n&&d(e)}}}function mn(o){let e,n,t;return n=new he({props:{$$slots:{default:[$n]},$$scope:{ctx:o}}}),{c(){e=M("span"),b(n.$$.fragment),F(e,"slot","right")},m(r,s){g(r,e,s),k(n,e,null),t=!0},p(r,s){const l={};s&524288&&(l.$$scope={dirty:s,ctx:r}),n.$set(l)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&d(e),L(n)}}}function ct(o){let e,n,t,r,s,l,f,i=we(o[3]),u=[];for(let m=0;m<i.length;m+=1)u[m]=ut(at(o,i,m));let c=we(o[2]),a=[];for(let m=0;m<c.length;m+=1)a[m]=ft(lt(o,c,m));function p(m){o[9](m)}let $={label:"OA color by",id:"colorBy",choices:[["percent_households_without_car","Percent of households without a car"],["average_cars_per_household","Average cars per household"],["pop_density","Population density (people per square kilometres)"]]};return o[1]!==void 0&&($.value=o[1]),s=new Ne({props:$}),K.push(()=>q(s,"value",p)),s.$on("change",o[6]),{c(){e=M("div");for(let m=0;m<u.length;m+=1)u[m].c();n=S(),t=M("div");for(let m=0;m<a.length;m+=1)a[m].c();r=S(),b(s.$$.fragment),ue(e,"display","flex"),ue(t,"display","flex"),ue(t,"justify-content","space-between")},m(m,_){g(m,e,_);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(e,null);g(m,n,_),g(m,t,_);for(let y=0;y<a.length;y+=1)a[y]&&a[y].m(t,null);g(m,r,_),k(s,m,_),f=!0},p(m,_){if(_&8){i=we(m[3]);let h;for(h=0;h<i.length;h+=1){const C=at(m,i,h);u[h]?u[h].p(C,_):(u[h]=ut(C),u[h].c(),u[h].m(e,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=i.length}if(_&4){c=we(m[2]);let h;for(h=0;h<c.length;h+=1){const C=lt(m,c,h);a[h]?a[h].p(C,_):(a[h]=ft(C),a[h].c(),a[h].m(t,null))}for(;h<a.length;h+=1)a[h].d(1);a.length=c.length}const y={};!l&&_&2&&(l=!0,y.value=m[1],W(()=>l=!1)),s.$set(y)},i(m){f||(w(s.$$.fragment,m),f=!0)},o(m){v(s.$$.fragment,m),f=!1},d(m){m&&(d(e),d(n),d(t),d(r)),Ze(u,m),Ze(a,m),L(s,m)}}}function ut(o){let e,n;return{c(){e=M("span"),n=T(` 
      `),ue(e,"background",o[16]),ue(e,"width","100%"),ue(e,"border","1px solid black")},m(t,r){g(t,e,r),D(e,n)},p:$e,d(t){t&&d(e)}}}function ft(o){let e,n=o[13]+"",t;return{c(){e=M("span"),t=T(n)},m(r,s){g(r,e,s),D(e,t)},p(r,s){s&4&&n!==(n=r[13]+"")&&re(t,n)},d(r){r&&d(e)}}}function hn(o){let e,n,t,r,s,l;function f(c){o[8](c)}let i={id:ee,$$slots:{right:[mn],default:[pn]},$$scope:{ctx:o}};o[0]!==void 0&&(i.checked=o[0]),e=new me({props:i}),K.push(()=>q(e,"checked",f));let u=o[0]&&ct(o);return s=new oe({props:{layer:ee,tooltip:o[4],show:o[0]}}),s.$on("click",o[5]),{c(){b(e.$$.fragment),t=S(),u&&u.c(),r=S(),b(s.$$.fragment)},m(c,a){k(e,c,a),g(c,t,a),u&&u.m(c,a),g(c,r,a),k(s,c,a),l=!0},p(c,[a]){const p={};a&524288&&(p.$$scope={dirty:a,ctx:c}),!n&&a&1&&(n=!0,p.checked=c[0],W(()=>n=!1)),e.$set(p),c[0]?u?(u.p(c,a),a&1&&w(u,1)):(u=ct(c),u.c(),w(u,1),u.m(r.parentNode,r)):u&&(be(),v(u,1,1,()=>{u=null}),ke());const $={};a&1&&($.show=c[0]),s.$set($)},i(c){l||(w(e.$$.fragment,c),w(u),w(s.$$.fragment,c),l=!0)},o(c){v(e.$$.fragment,c),v(u),v(s.$$.fragment,c),l=!1},d(c){c&&(d(t),d(r)),L(e,c),u&&u.d(c),L(s,c)}}}let ee="census_output_areas";function gn(o,e,n){let t;J(o,se,y=>n(7,t=y));let r=`${ee}-outline`,s="percent_households_without_car",l=R.sequential_low_to_high,f=a();Be(t,ee,`https://atip.uk/layers/v1/${ee}.pmtiles`),Ce(t,{id:ee,source:ee,sourceLayer:ee,color:p(),opacity:pe(.5,.9)}),Te(t,{id:r,source:ee,sourceLayer:ee,color:"black",width:.5});let i=!1;function u(y){let h=y.properties.OA21CD,C=y.properties[s];return s=="percent_households_without_car"?`<p>${C}% of households in ${h} don't have a car</p>`:s=="average_cars_per_household"?`<p>Households in ${h} have an average of ${C} cars</p>`:`<p>There are ${C} people per square kilometre in ${h}</p>`}function c(y){let h=y.detail.properties.OA21CD;s=="percent_households_without_car"||s=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${h}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${h}`,"_blank")}function a(){return s=="percent_households_without_car"?[0,20,40,60,80,100]:s=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[100,200,300,400,500,600]}function p(){let y=["step",["get",s]];for(let h=1;h<f.length;h++)y.push(l[h-1]),y.push(f[h]);return y.push("red"),console.log(y),y}function $(){n(2,f=a()),t.setPaintProperty(ee,"fill-color",p())}function m(y){i=y,n(0,i)}function _(y){s=y,n(1,s)}return o.$$.update=()=>{o.$$.dirty&129&&t.getLayer(r)&&t.setLayoutProperty(r,"visibility",i?"visible":"none")},[i,s,f,l,u,c,$,t,m,_]}class dn extends x{constructor(e){super(),V(this,e,gn,hn,H,{})}}function _n(o){let e,n,t;return e=new De({props:{color:o[1]}}),{c(){b(e.$$.fragment),n=T(`
  Combined authorities`)},m(r,s){k(e,r,s),g(r,n,s),t=!0},p:$e,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){v(e.$$.fragment,r),t=!1},d(r){r&&d(n),L(e,r)}}}function wn(o){let e;return{c(){e=T(`ONS Geography
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function vn(o){let e;return{c(){e=T(`Open Government License
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function yn(o){let e,n,t,r,s,l,f,i,u,c;return t=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[wn]},$$scope:{ctx:o}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[vn]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=T("Data from "),b(t.$$.fragment),r=T(", as of December 2022."),s=S(),l=M("p"),f=T("License: "),b(i.$$.fragment),u=T(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(a,p){g(a,e,p),D(e,n),k(t,e,null),D(e,r),g(a,s,p),g(a,l,p),D(l,f),k(i,l,null),D(l,u),c=!0},p(a,p){const $={};p&32&&($.$$scope={dirty:p,ctx:a}),t.$set($);const m={};p&32&&(m.$$scope={dirty:p,ctx:a}),i.$set(m)},i(a){c||(w(t.$$.fragment,a),w(i.$$.fragment,a),c=!0)},o(a){v(t.$$.fragment,a),v(i.$$.fragment,a),c=!1},d(a){a&&(d(e),d(s),d(l)),L(t),L(i)}}}function bn(o){let e,n,t;return n=new he({props:{$$slots:{default:[yn]},$$scope:{ctx:o}}}),{c(){e=M("span"),b(n.$$.fragment),F(e,"slot","right")},m(r,s){g(r,e,s),k(n,e,null),t=!0},p(r,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:r}),n.$set(l)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&d(e),L(n)}}}function kn(o){let e,n,t,r,s;function l(i){o[3](i)}let f={id:ae,$$slots:{right:[bn],default:[_n]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new me({props:f}),K.push(()=>q(e,"checked",l)),r=new oe({props:{layer:ae,tooltip:Ln,show:o[0]}}),r.$on("click",Cn),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment)},m(i,u){k(e,i,u),g(i,t,u),k(r,i,u),s=!0},p(i,[u]){const c={};u&32&&(c.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,c.checked=i[0],W(()=>n=!1)),e.$set(c);const a={};u&1&&(a.show=i[0]),r.$set(a)},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){v(e.$$.fragment,i),v(r.$$.fragment,i),s=!1},d(i){i&&d(t),L(e,i),L(r,i)}}}let ae="combined_authorities";function Ln(o){return`<p>${o.properties.name}</p>`}function Cn(o){window.open(`https://www.ons.gov.uk/visualisations/areas/${o.detail.properties.CAUTH22CD}`,"_blank")}function Tn(o,e,n){let t;J(o,se,i=>n(2,t=i));let r=R.combined_authorities,s=`${ae}-outline`;yt(t,ae,`https://atip.uk/layers/v1/${ae}.geojson`),Ce(t,{id:ae,source:ae,color:r,opacity:pe(.5,.1)}),Te(t,{id:s,source:ae,color:r,width:2.5});let l=!1;function f(i){l=i,n(0,l)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,r,t,f]}class Dn extends x{constructor(e){super(),V(this,e,Tn,kn,H,{})}}function Sn(o){let e=new Map;for(let[t,r]of Object.entries(o.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:r.authority_or_region,capital_scheme_id:r.capital_scheme_id,funding_programme:r.funding_programme});let n=1;for(let t of o.features){let r=e.get(t.properties.scheme_reference);r.num_features++,t.properties.funding_programme=r.funding_programme,t.id=n++}return e}function Un(o){let e;return{c(){e=T("Clear")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function An(o){let e,n,t,r,s,l;return t=new Pe({props:{$$slots:{default:[Un]},$$scope:{ctx:o}}}),t.$on("click",o[11]),{c(){e=M("input"),n=S(),b(t.$$.fragment),F(e,"type","text"),F(e,"class","govuk-input govuk-input--width-10"),F(e,"id","filterText")},m(f,i){g(f,e,i),ot(e,o[0]),g(f,n,i),k(t,f,i),r=!0,s||(l=Rt(e,"input",o[10]),s=!0)},p(f,i){i&1&&e.value!==f[0]&&ot(e,f[0]);const u={};i&16384&&(u.$$scope={dirty:i,ctx:f}),t.$set(u)},i(f){r||(w(t.$$.fragment,f),r=!0)},o(f){v(t.$$.fragment,f),r=!1},d(f){f&&(d(e),d(n)),L(t,f),s=!1,l()}}}function Mn(o){let e,n,t,r,s,l,f,i;function u($){o[8]($)}let c={label:"Authority or region",id:"filterAuthority",choices:o[4],emptyOption:!0};o[2]!==void 0&&(c.value=o[2]),e=new Ne({props:c}),K.push(()=>q(e,"value",u));function a($){o[9]($)}let p={label:"Funding programme",id:"filterFundingProgramme",choices:o[5],emptyOption:!0};return o[3]!==void 0&&(p.value=o[3]),r=new Ne({props:p}),K.push(()=>q(r,"value",a)),f=new Zt({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[An]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment),l=S(),b(f.$$.fragment)},m($,m){k(e,$,m),g($,t,m),k(r,$,m),g($,l,m),k(f,$,m),i=!0},p($,m){const _={};m&16&&(_.choices=$[4]),!n&&m&4&&(n=!0,_.value=$[2],W(()=>n=!1)),e.$set(_);const y={};m&32&&(y.choices=$[5]),!s&&m&8&&(s=!0,y.value=$[3],W(()=>s=!1)),r.$set(y);const h={};m&16385&&(h.$$scope={dirty:m,ctx:$}),f.$set(h)},i($){i||(w(e.$$.fragment,$),w(r.$$.fragment,$),w(f.$$.fragment,$),i=!0)},o($){v(e.$$.fragment,$),v(r.$$.fragment,$),v(f.$$.fragment,$),i=!1},d($){$&&(d(t),d(l)),L(e,$),L(r,$),L(f,$)}}}function Bn(o){let e,n,t,r,s=o[1].size+"",l,f,i=o[6].route+"",u,c,a=o[6].area+"",p,$,m=o[6].crossing+"",_,y,h=o[6].other+"",C,U,B;return e=new qe({props:{label:"Filters",$$slots:{default:[Mn]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment),n=S(),t=M("p"),r=T("Showing "),l=T(s),f=T(" schemes ("),u=T(i),c=T(" routes, "),p=T(a),$=T(` areas,
  `),_=T(m),y=T(" crossings, "),C=T(h),U=T(" other)")},m(A,E){k(e,A,E),g(A,n,E),g(A,t,E),D(t,r),D(t,l),D(t,f),D(t,u),D(t,c),D(t,p),D(t,$),D(t,_),D(t,y),D(t,C),D(t,U),B=!0},p(A,[E]){const P={};E&16445&&(P.$$scope={dirty:E,ctx:A}),e.$set(P),(!B||E&2)&&s!==(s=A[1].size+"")&&re(l,s),(!B||E&64)&&i!==(i=A[6].route+"")&&re(u,i),(!B||E&64)&&a!==(a=A[6].area+"")&&re(p,a),(!B||E&64)&&m!==(m=A[6].crossing+"")&&re(_,m),(!B||E&64)&&h!==(h=A[6].other+"")&&re(C,h)},i(A){B||(w(e.$$.fragment,A),B=!0)},o(A){v(e.$$.fragment,A),B=!1},d(A){A&&(d(n),d(t)),L(e,A)}}}function En(o,e,n){let t;J(o,Le,h=>n(12,t=h));let{schemes:r}=e,{schemesToBeShown:s=new Set}=e,{filterText:l=""}=e,f=[],i="",u=[],c="",a={area:0,route:0,crossing:0,other:0};Ke(()=>{let h=new Set,C=new Set;for(let U of r.values())U.authority_or_region&&h.add(U.authority_or_region),U.funding_programme&&C.add(U.funding_programme);n(4,f=Array.from(h.entries())),f.sort(),n(5,u=Array.from(C.entries())),u.sort()});function p(h,C,U){let B=h.toLowerCase(),A=P=>{var N,ie;if(B&&!((N=P.properties.name)!=null&&N.toLowerCase().includes(B))&&!((ie=P.properties.description)!=null&&ie.toLowerCase().includes(B)))return!1;if(C||U){let z=r.get(P.properties.scheme_reference);if(C&&z.authority_or_region!=C||U&&z.funding_programme!=U)return!1}return!0};n(1,s=new Set(t.features.filter(A).map(P=>P.properties.scheme_reference))),n(6,a={area:0,route:0,crossing:0,other:0});let E=P=>{var N,ie;return!(!s.has(P.properties.scheme_reference)||B&&!((N=P.properties.name)!=null&&N.toLowerCase().includes(B))&&!((ie=P.properties.description)!=null&&ie.toLowerCase().includes(B)))};Le.update(P=>{for(let N of P.features)E(N)?(delete N.properties.hide_while_editing,n(6,a[N.properties.intervention_type]++,a)):N.properties.hide_while_editing=!0;return P}),n(6,a)}function $(h){i=h,n(2,i)}function m(h){c=h,n(3,c)}function _(){l=this.value,n(0,l)}const y=()=>n(0,l="");return o.$$set=h=>{"schemes"in h&&n(7,r=h.schemes),"schemesToBeShown"in h&&n(1,s=h.schemesToBeShown),"filterText"in h&&n(0,l=h.filterText)},o.$$.update=()=>{o.$$.dirty&13&&p(l,i,c)},[l,s,i,c,f,u,a,r,$,m,_,y]}class On extends x{constructor(e){super(),V(this,e,En,Bn,H,{schemes:7,schemesToBeShown:1,filterText:0})}}function Pn(o){let e,n,t,r;return e=new De({props:{color:o[3]}}),{c(){b(e.$$.fragment),n=S(),t=T(o[1])},m(s,l){k(e,s,l),g(s,n,l),g(s,t,l),r=!0},p(s,l){(!r||l&2)&&re(t,s[1])},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){v(e.$$.fragment,s),r=!1},d(s){s&&(d(n),d(t)),L(e,s)}}}function Nn(o){let e;const n=o[6].default,t=Gt(n,o,o[8],null);return{c(){t&&t.c()},m(r,s){t&&t.m(r,s),e=!0},p(r,s){t&&t.p&&(!e||s&256)&&Kt(t,n,r,r[8],e?Wt(n,r[8],s,null):qt(r[8]),null)},i(r){e||(w(t,r),e=!0)},o(r){v(t,r),e=!1},d(r){t&&t.d(r)}}}function zn(o){let e,n,t;return n=new he({props:{$$slots:{default:[Nn]},$$scope:{ctx:o}}}),{c(){e=M("span"),b(n.$$.fragment),F(e,"slot","right")},m(r,s){g(r,e,s),k(n,e,null),t=!0},p(r,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:r}),n.$set(l)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&d(e),L(n)}}}function In(o){let e,n,t,r,s;function l(i){o[7](i)}let f={id:o[0],$$slots:{right:[zn],default:[Pn]},$$scope:{ctx:o}};return o[2]!==void 0&&(f.checked=o[2]),e=new me({props:f}),K.push(()=>q(e,"checked",l)),r=new oe({props:{layer:o[0],tooltip:o[4],show:o[2]}}),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment)},m(i,u){k(e,i,u),g(i,t,u),k(r,i,u),s=!0},p(i,[u]){const c={};u&1&&(c.id=i[0]),u&258&&(c.$$scope={dirty:u,ctx:i}),!n&&u&4&&(n=!0,c.checked=i[2],W(()=>n=!1)),e.$set(c);const a={};u&1&&(a.layer=i[0]),u&4&&(a.show=i[2]),r.$set(a)},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){v(e.$$.fragment,i),v(r.$$.fragment,i),s=!1},d(i){i&&d(t),L(e,i),L(r,i)}}}function Fn(o,e,n){let t;J(o,se,$=>n(9,t=$));let{$$slots:r={},$$scope:s}=e,{name:l}=e,{singularNoun:f}=e,{pluralNoun:i}=e,u=R[l];Be(t,l,`https://atip.uk/layers/v1/${l}.pmtiles`),Ce(t,{id:l,source:l,sourceLayer:l,color:u,opacity:pe(1,.7)});let c=!1;function a($){return`<p>${$.properties.name??`Unnamed ${f}`}</p>`}function p($){c=$,n(2,c)}return o.$$set=$=>{"name"in $&&n(0,l=$.name),"singularNoun"in $&&n(5,f=$.singularNoun),"pluralNoun"in $&&n(1,i=$.pluralNoun),"$$scope"in $&&n(8,s=$.$$scope)},[l,i,c,u,a,f,r,p,s]}class Ct extends x{constructor(e){super(),V(this,e,Fn,In,H,{name:0,singularNoun:5,pluralNoun:1})}}function jn(o){let e;return{c(){e=T("hospital")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function xn(o){let e;return{c(){e=T("Open Data Commons Open Database License")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Vn(o){let e,n,t,r,s,l,f,i,u;return t=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[jn]},$$scope:{ctx:o}}}),i=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[xn]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=T("This shows "),b(t.$$.fragment),r=T(` data from OpenStreetMap. It doesn't include outpatient clinics
    or individual doctor's offices.`),s=S(),l=M("p"),f=T("License: "),b(i.$$.fragment)},m(c,a){g(c,e,a),D(e,n),k(t,e,null),D(e,r),g(c,s,a),g(c,l,a),D(l,f),k(i,l,null),u=!0},p(c,a){const p={};a&1&&(p.$$scope={dirty:a,ctx:c}),t.$set(p);const $={};a&1&&($.$$scope={dirty:a,ctx:c}),i.$set($)},i(c){u||(w(t.$$.fragment,c),w(i.$$.fragment,c),u=!0)},o(c){v(t.$$.fragment,c),v(i.$$.fragment,c),u=!1},d(c){c&&(d(e),d(s),d(l)),L(t),L(i)}}}function Hn(o){let e,n;return e=new Ct({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Vn]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment)},m(t,r){k(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}class Zn extends x{constructor(e){super(),V(this,e,null,Hn,H,{})}}function Rn(o){let e,n,t,r,s;function l(i){o[3](i)}let f={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return o[0]!==void 0&&(f.value=o[0]),e=new Ne({props:f}),K.push(()=>q(e,"value",l)),e.$on("change",o[2]),r=new on({props:{rows:o[1]}}),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment)},m(i,u){k(e,i,u),g(i,t,u),k(r,i,u),s=!0},p(i,[u]){const c={};!n&&u&1&&(n=!0,c.value=i[0],W(()=>n=!1)),e.$set(c);const a={};u&2&&(a.rows=i[1]),r.$set(a)},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){v(e.$$.fragment,i),v(r.$$.fragment,i),s=!1},d(i){i&&d(t),L(e,i),L(r,i)}}}function Gn(o,e,n){let t;J(o,se,i=>n(4,t=i));let r="interventionType",s=it("v1");function l(){let i;r=="interventionType"?(i=Lt("v1"),n(1,s=it("v1"))):(i=Jt(["get","funding_programme"],{ATF2:R.atf2,ATF3:R.atf3,ATF4:R.atf4},"grey"),n(1,s=[["ATF2",R.atf2],["ATF3",R.atf3],["ATF4",R.atf4]])),t.setPaintProperty("interventions-points","circle-color",i),t.setPaintProperty("interventions-lines","line-color",i),t.setPaintProperty("interventions-polygons","fill-color",i),t.setPaintProperty("interventions-polygon-outlines","line-color",i)}function f(i){r=i,n(0,r)}return[r,s,l,f]}class Kn extends x{constructor(e){super(),V(this,e,Gn,Rn,H,{})}}function qn(o){let e,n,t;return e=new De({props:{color:o[1]}}),{c(){b(e.$$.fragment),n=T(`
  Local Authority Districts`)},m(r,s){k(e,r,s),g(r,n,s),t=!0},p:$e,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){v(e.$$.fragment,r),t=!1},d(r){r&&d(n),L(e,r)}}}function Wn(o){let e;return{c(){e=T(`ONS Geography
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Jn(o){let e;return{c(){e=T(`Open Government License
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Xn(o){let e,n,t,r,s,l,f,i,u,c;return t=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Wn]},$$scope:{ctx:o}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Jn]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=T("Data from "),b(t.$$.fragment),r=T(", as of May 2023."),s=S(),l=M("p"),f=T("License: "),b(i.$$.fragment),u=T(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(a,p){g(a,e,p),D(e,n),k(t,e,null),D(e,r),g(a,s,p),g(a,l,p),D(l,f),k(i,l,null),D(l,u),c=!0},p(a,p){const $={};p&32&&($.$$scope={dirty:p,ctx:a}),t.$set($);const m={};p&32&&(m.$$scope={dirty:p,ctx:a}),i.$set(m)},i(a){c||(w(t.$$.fragment,a),w(i.$$.fragment,a),c=!0)},o(a){v(t.$$.fragment,a),v(i.$$.fragment,a),c=!1},d(a){a&&(d(e),d(s),d(l)),L(t),L(i)}}}function Yn(o){let e,n,t;return n=new he({props:{$$slots:{default:[Xn]},$$scope:{ctx:o}}}),{c(){e=M("span"),b(n.$$.fragment),F(e,"slot","right")},m(r,s){g(r,e,s),k(n,e,null),t=!0},p(r,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:r}),n.$set(l)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&d(e),L(n)}}}function Qn(o){let e,n,t,r,s;function l(i){o[3](i)}let f={id:ce,$$slots:{right:[Yn],default:[qn]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new me({props:f}),K.push(()=>q(e,"checked",l)),r=new oe({props:{layer:ce,tooltip:er,show:o[0]}}),r.$on("click",tr),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment)},m(i,u){k(e,i,u),g(i,t,u),k(r,i,u),s=!0},p(i,[u]){const c={};u&32&&(c.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,c.checked=i[0],W(()=>n=!1)),e.$set(c);const a={};u&1&&(a.show=i[0]),r.$set(a)},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){v(e.$$.fragment,i),v(r.$$.fragment,i),s=!1},d(i){i&&d(t),L(e,i),L(r,i)}}}let ce="local_authority_districts";function er(o){return`<p>${o.properties.name}</p>`}function tr(o){window.open(`https://www.ons.gov.uk/visualisations/areas/${o.detail.properties.LAD23CD}`,"_blank")}function nr(o,e,n){let t;J(o,se,i=>n(2,t=i));let r=R.local_authority_districts,s=`${ce}-outline`;yt(t,ce,`https://atip.uk/layers/v1/${ce}.geojson`),Ce(t,{id:ce,source:ce,color:r,opacity:pe(.5,.1)}),Te(t,{id:s,source:ce,color:r,width:2.5});let l=!1;function f(i){l=i,n(0,l)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,r,t,f]}class rr extends x{constructor(e){super(),V(this,e,nr,Qn,H,{})}}function or(o){let e,n,t;return e=new De({props:{color:o[1]}}),{c(){b(e.$$.fragment),n=T(`
  MRN`)},m(r,s){k(e,r,s),g(r,n,s),t=!0},p:$e,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){v(e.$$.fragment,r),t=!1},d(r){r&&d(n),L(e,r)}}}function sr(o){let e;return{c(){e=T(`Major Road Network
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function ir(o){let e;return{c(){e=T("Open Government License")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function lr(o){let e,n,t,r,s,l,f,i,u;return t=new j({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[sr]},$$scope:{ctx:o}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ir]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=T("Data from the "),b(t.$$.fragment),r=T("."),s=S(),l=M("p"),f=T("License: "),b(i.$$.fragment)},m(c,a){g(c,e,a),D(e,n),k(t,e,null),D(e,r),g(c,s,a),g(c,l,a),D(l,f),k(i,l,null),u=!0},p(c,a){const p={};a&16&&(p.$$scope={dirty:a,ctx:c}),t.$set(p);const $={};a&16&&($.$$scope={dirty:a,ctx:c}),i.$set($)},i(c){u||(w(t.$$.fragment,c),w(i.$$.fragment,c),u=!0)},o(c){v(t.$$.fragment,c),v(i.$$.fragment,c),u=!1},d(c){c&&(d(e),d(s),d(l)),L(t),L(i)}}}function ar(o){let e,n,t;return n=new he({props:{$$slots:{default:[lr]},$$scope:{ctx:o}}}),{c(){e=M("span"),b(n.$$.fragment),F(e,"slot","right")},m(r,s){g(r,e,s),k(n,e,null),t=!0},p(r,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:r}),n.$set(l)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&d(e),L(n)}}}function cr(o){let e,n,t,r,s;function l(i){o[2](i)}let f={id:fe,$$slots:{right:[ar],default:[or]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new me({props:f}),K.push(()=>q(e,"checked",l)),r=new oe({props:{layer:fe,tooltip:ur,show:o[0]}}),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment)},m(i,u){k(e,i,u),g(i,t,u),k(r,i,u),s=!0},p(i,[u]){const c={};u&16&&(c.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,c.checked=i[0],W(()=>n=!1)),e.$set(c);const a={};u&1&&(a.show=i[0]),r.$set(a)},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){v(e.$$.fragment,i),v(r.$$.fragment,i),s=!1},d(i){i&&d(t),L(e,i),L(r,i)}}}let fe="mrn";function ur(o){return`<p>${o.properties.name??"Unknown MRN road"}</p>`}function fr(o,e,n){let t;J(o,se,f=>n(3,t=f));let r=R.mrn;Be(t,fe,`https://atip.uk/layers/v1/${fe}.pmtiles`),Te(t,{id:fe,source:fe,sourceLayer:fe,color:r,width:7,opacity:pe(.5,1)});let s=!1;function l(f){s=f,n(0,s)}return[s,r,l]}class pr extends x{constructor(e){super(),V(this,e,fr,cr,H,{})}}function $r(o){let e,n,t;return e=new De({props:{color:o[1]}}),{c(){b(e.$$.fragment),n=T(`
  Parliamentary constituencies`)},m(r,s){k(e,r,s),g(r,n,s),t=!0},p:$e,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){v(e.$$.fragment,r),t=!1},d(r){r&&d(n),L(e,r)}}}function mr(o){let e;return{c(){e=T(`Ordnance Survey Boundary-Line
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function hr(o){let e;return{c(){e=T("Open Government License")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function gr(o){let e,n,t,r,s,l,f,i,u;return t=new j({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[mr]},$$scope:{ctx:o}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[hr]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=T("Data from "),b(t.$$.fragment),r=T("."),s=S(),l=M("p"),f=T("License: "),b(i.$$.fragment)},m(c,a){g(c,e,a),D(e,n),k(t,e,null),D(e,r),g(c,s,a),g(c,l,a),D(l,f),k(i,l,null),u=!0},p(c,a){const p={};a&32&&(p.$$scope={dirty:a,ctx:c}),t.$set(p);const $={};a&32&&($.$$scope={dirty:a,ctx:c}),i.$set($)},i(c){u||(w(t.$$.fragment,c),w(i.$$.fragment,c),u=!0)},o(c){v(t.$$.fragment,c),v(i.$$.fragment,c),u=!1},d(c){c&&(d(e),d(s),d(l)),L(t),L(i)}}}function dr(o){let e,n,t;return n=new he({props:{$$slots:{default:[gr]},$$scope:{ctx:o}}}),{c(){e=M("span"),b(n.$$.fragment),F(e,"slot","right")},m(r,s){g(r,e,s),k(n,e,null),t=!0},p(r,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:r}),n.$set(l)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&d(e),L(n)}}}function _r(o){let e,n,t,r,s;function l(i){o[3](i)}let f={id:te,$$slots:{right:[dr],default:[$r]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new me({props:f}),K.push(()=>q(e,"checked",l)),r=new oe({props:{layer:te,tooltip:wr,show:o[0]}}),r.$on("click",vr),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment)},m(i,u){k(e,i,u),g(i,t,u),k(r,i,u),s=!0},p(i,[u]){const c={};u&32&&(c.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,c.checked=i[0],W(()=>n=!1)),e.$set(c);const a={};u&1&&(a.show=i[0]),r.$set(a)},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){v(e.$$.fragment,i),v(r.$$.fragment,i),s=!1},d(i){i&&d(t),L(e,i),L(r,i)}}}let te="parliamentary_constituencies";function wr(o){return`<p>${o.properties.Name}</p>`}function vr(o){let e=o.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function yr(o,e,n){let t;J(o,se,i=>n(2,t=i));let r=R.parliamentary_constituencies,s=`${te}-outline`;Be(t,te,`https://atip.uk/layers/v1/${te}.pmtiles`),Ce(t,{id:te,source:te,sourceLayer:te,color:r,opacity:pe(.5,.1)}),Te(t,{id:s,source:te,sourceLayer:te,color:r,width:5});let l=!1;function f(i){l=i,n(0,l)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,r,t,f]}class br extends x{constructor(e){super(),V(this,e,yr,_r,H,{})}}function kr(o){let e;return{c(){e=T("Show on map")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Lr(o){let e;return{c(){e=T("Edit scheme locally")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Cr(o){let e,n,t=o[0].authority_or_region+"",r,s,l,f,i=o[0].capital_scheme_id+"",u,c,a,p,$=o[0].funding_programme+"",m,_,y,h,C,U,B;return h=new Pe({props:{$$slots:{default:[kr]},$$scope:{ctx:o}}}),h.$on("click",o[3]),U=new Pe({props:{disabled:o[1],title:o[2],$$slots:{default:[Lr]},$$scope:{ctx:o}}}),U.$on("click",o[4]),{c(){e=M("p"),n=T("Authority or region: "),r=T(t),s=S(),l=M("p"),f=T("Capital scheme ID: "),u=T(i),c=S(),a=M("p"),p=T("Funding programme: "),m=T($),_=S(),y=M("div"),b(h.$$.fragment),C=S(),b(U.$$.fragment),F(y,"class","govuk-button-group")},m(A,E){g(A,e,E),D(e,n),D(e,r),g(A,s,E),g(A,l,E),D(l,f),D(l,u),g(A,c,E),g(A,a,E),D(a,p),D(a,m),g(A,_,E),g(A,y,E),k(h,y,null),D(y,C),k(U,y,null),B=!0},p(A,E){(!B||E&1)&&t!==(t=A[0].authority_or_region+"")&&re(r,t),(!B||E&1)&&i!==(i=A[0].capital_scheme_id+"")&&re(u,i),(!B||E&1)&&$!==($=A[0].funding_programme+"")&&re(m,$);const P={};E&256&&(P.$$scope={dirty:E,ctx:A}),h.$set(P);const N={};E&256&&(N.$$scope={dirty:E,ctx:A}),U.$set(N)},i(A){B||(w(h.$$.fragment,A),w(U.$$.fragment,A),B=!0)},o(A){v(h.$$.fragment,A),v(U.$$.fragment,A),B=!1},d(A){A&&(d(e),d(s),d(l),d(c),d(a),d(_),d(y)),L(h),L(U)}}}function Tr(o){let e,n;return e=new qe({props:{label:`${o[0].scheme_reference}: ${o[0].num_features} features`,$$slots:{default:[Cr]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment)},m(t,r){k(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),r&257&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Dr(o,e,n){let t,r;J(o,Le,a=>n(6,t=a)),J(o,se,a=>n(7,r=a));let{scheme:s}=e,{authorityNames:l}=e,f=!l.has(s.authority_or_region),i=f?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function u(){let a={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};r==null||r.fitBounds(bt(a),{padding:20,animate:!1})}function c(){let a={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(a)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return o.$$set=a=>{"scheme"in a&&n(0,s=a.scheme),"authorityNames"in a&&n(5,l=a.authorityNames)},[s,f,i,u,c,l]}class Sr extends x{constructor(e){super(),V(this,e,Dr,Tr,H,{scheme:0,authorityNames:5})}}function Ur(o){let e;return{c(){e=T("primary and secondary schools")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Ar(o){let e;return{c(){e=T("Open Data Commons Open Database License")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Mr(o){let e,n,t,r,s,l,f,i,u;return t=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Ur]},$$scope:{ctx:o}}}),i=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ar]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=T("This shows "),b(t.$$.fragment),r=T(` from OpenStreetMap. It doesn't include kindergartens, colleges,
    universities, or other training schools.`),s=S(),l=M("p"),f=T("License: "),b(i.$$.fragment)},m(c,a){g(c,e,a),D(e,n),k(t,e,null),D(e,r),g(c,s,a),g(c,l,a),D(l,f),k(i,l,null),u=!0},p(c,a){const p={};a&1&&(p.$$scope={dirty:a,ctx:c}),t.$set(p);const $={};a&1&&($.$$scope={dirty:a,ctx:c}),i.$set($)},i(c){u||(w(t.$$.fragment,c),w(i.$$.fragment,c),u=!0)},o(c){v(t.$$.fragment,c),v(i.$$.fragment,c),u=!1},d(c){c&&(d(e),d(s),d(l)),L(t),L(i)}}}function Br(o){let e,n;return e=new Ct({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Mr]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment)},m(t,r){k(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}class Er extends x{constructor(e){super(),V(this,e,null,Br,H,{})}}function Or(o){let e,n,t;return e=new De({props:{color:o[1]}}),{c(){b(e.$$.fragment),n=T(`
  Wards`)},m(r,s){k(e,r,s),g(r,n,s),t=!0},p:$e,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){v(e.$$.fragment,r),t=!1},d(r){r&&d(n),L(e,r)}}}function Pr(o){let e;return{c(){e=T(`ONS Geography
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function Nr(o){let e;return{c(){e=T(`Open Government License
        `)},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function zr(o){let e,n,t,r,s,l,f,i,u,c;return t=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[Pr]},$$scope:{ctx:o}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Nr]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=T("Data from "),b(t.$$.fragment),r=T(", as of May 2023."),s=S(),l=M("p"),f=T("License: "),b(i.$$.fragment),u=T(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(a,p){g(a,e,p),D(e,n),k(t,e,null),D(e,r),g(a,s,p),g(a,l,p),D(l,f),k(i,l,null),D(l,u),c=!0},p(a,p){const $={};p&32&&($.$$scope={dirty:p,ctx:a}),t.$set($);const m={};p&32&&(m.$$scope={dirty:p,ctx:a}),i.$set(m)},i(a){c||(w(t.$$.fragment,a),w(i.$$.fragment,a),c=!0)},o(a){v(t.$$.fragment,a),v(i.$$.fragment,a),c=!1},d(a){a&&(d(e),d(s),d(l)),L(t),L(i)}}}function Ir(o){let e,n,t;return n=new he({props:{$$slots:{default:[zr]},$$scope:{ctx:o}}}),{c(){e=M("span"),b(n.$$.fragment),F(e,"slot","right")},m(r,s){g(r,e,s),k(n,e,null),t=!0},p(r,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:r}),n.$set(l)},i(r){t||(w(n.$$.fragment,r),t=!0)},o(r){v(n.$$.fragment,r),t=!1},d(r){r&&d(e),L(n)}}}function Fr(o){let e,n,t,r,s;function l(i){o[3](i)}let f={id:ne,$$slots:{right:[Ir],default:[Or]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new me({props:f}),K.push(()=>q(e,"checked",l)),r=new oe({props:{layer:ne,tooltip:jr,show:o[0]}}),r.$on("click",xr),{c(){b(e.$$.fragment),t=S(),b(r.$$.fragment)},m(i,u){k(e,i,u),g(i,t,u),k(r,i,u),s=!0},p(i,[u]){const c={};u&32&&(c.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,c.checked=i[0],W(()=>n=!1)),e.$set(c);const a={};u&1&&(a.show=i[0]),r.$set(a)},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){v(e.$$.fragment,i),v(r.$$.fragment,i),s=!1},d(i){i&&d(t),L(e,i),L(r,i)}}}let ne="wards";function jr(o){return`<p>${o.properties.name}</p>`}function xr(o){let e=encodeURIComponent(o.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Vr(o,e,n){let t;J(o,se,i=>n(2,t=i));let r=R.wards,s=`${ne}-outline`;Be(t,ne,`https://atip.uk/layers/v1/${ne}.pmtiles`),Ce(t,{id:ne,source:ne,sourceLayer:ne,color:r,opacity:pe(.5,.1)}),Te(t,{id:s,source:ne,sourceLayer:ne,color:r,width:2.5});let l=!1;function f(i){l=i,n(0,l)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,r,t,f]}class Hr extends x{constructor(e){super(),V(this,e,Vr,Fr,H,{})}}var I=(o,e,n)=>new Promise((t,r)=>{var s=i=>{try{f(n.next(i))}catch(u){r(u)}},l=i=>{try{f(n.throw(i))}catch(u){r(u)}},f=i=>i.done?t(i.value):Promise.resolve(i.value).then(s,l);f((n=n.apply(o,e)).next())}),G=Uint8Array,ve=Uint16Array,Zr=Int32Array,Tt=new G([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Dt=new G([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rr=new G([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),St=function(o,e){for(var n=new ve(31),t=0;t<31;++t)n[t]=e+=1<<o[t-1];for(var r=new Zr(n[30]),t=1;t<30;++t)for(var s=n[t];s<n[t+1];++s)r[s]=s-n[t]<<5|t;return{b:n,r}},Ut=St(Tt,2),At=Ut.b,Gr=Ut.r;At[28]=258,Gr[258]=28;var Kr=St(Dt,0),qr=Kr.b,Re=new ve(32768);for(O=0;O<32768;++O)le=(O&43690)>>1|(O&21845)<<1,le=(le&52428)>>2|(le&13107)<<2,le=(le&61680)>>4|(le&3855)<<4,Re[O]=((le&65280)>>8|(le&255)<<8)>>1;var le,O,Me=function(o,e,n){for(var t=o.length,r=0,s=new ve(e);r<t;++r)o[r]&&++s[o[r]-1];var l=new ve(e);for(r=1;r<e;++r)l[r]=l[r-1]+s[r-1]<<1;var f;if(n){f=new ve(1<<e);var i=15-e;for(r=0;r<t;++r)if(o[r])for(var u=r<<4|o[r],c=e-o[r],a=l[o[r]-1]++<<c,p=a|(1<<c)-1;a<=p;++a)f[Re[a]>>i]=u}else for(f=new ve(t),r=0;r<t;++r)o[r]&&(f[r]=Re[l[o[r]-1]++]>>15-o[r]);return f},Ee=new G(288);for(O=0;O<144;++O)Ee[O]=8;var O;for(O=144;O<256;++O)Ee[O]=9;var O;for(O=256;O<280;++O)Ee[O]=7;var O;for(O=280;O<288;++O)Ee[O]=8;var O,Mt=new G(32);for(O=0;O<32;++O)Mt[O]=5;var O,Wr=Me(Ee,9,1),Jr=Me(Mt,5,1),Ve=function(o){for(var e=o[0],n=1;n<o.length;++n)o[n]>e&&(e=o[n]);return e},Y=function(o,e,n){var t=e/8|0;return(o[t]|o[t+1]<<8)>>(e&7)&n},He=function(o,e){var n=e/8|0;return(o[n]|o[n+1]<<8|o[n+2]<<16)>>(e&7)},Xr=function(o){return(o+7)/8|0},Yr=function(o,e,n){(e==null||e<0)&&(e=0),(n==null||n>o.length)&&(n=o.length);var t=new G(n-e);return t.set(o.subarray(e,n)),t},Qr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Z=function(o,e,n){var t=new Error(e||Qr[o]);if(t.code=o,Error.captureStackTrace&&Error.captureStackTrace(t,Z),!n)throw t;return t},We=function(o,e,n,t){var r=o.length,s=t?t.length:0;if(!r||e.f&&!e.l)return n||new G(0);var l=!n||e.i!=2,f=e.i;n||(n=new G(r*3));var i=function(tt){var nt=n.length;if(tt>nt){var rt=new G(Math.max(nt*2,tt));rt.set(n),n=rt}},u=e.f||0,c=e.p||0,a=e.b||0,p=e.l,$=e.d,m=e.m,_=e.n,y=r*8;do{if(!p){u=Y(o,c,1);var h=Y(o,c+1,3);if(c+=3,h)if(h==1)p=Wr,$=Jr,m=9,_=5;else if(h==2){var A=Y(o,c,31)+257,E=Y(o,c+10,15)+4,P=A+Y(o,c+5,31)+1;c+=14;for(var N=new G(P),ie=new G(19),z=0;z<E;++z)ie[Rr[z]]=Y(o,c+z*3,7);c+=E*3;for(var Je=Ve(ie),Ft=(1<<Je)-1,jt=Me(ie,Je,1),z=0;z<P;){var Xe=jt[Y(o,c,Ft)];c+=Xe&15;var C=Xe>>4;if(C<16)N[z++]=C;else{var ge=0,Oe=0;for(C==16?(Oe=3+Y(o,c,3),c+=2,ge=N[z-1]):C==17?(Oe=3+Y(o,c,7),c+=3):C==18&&(Oe=11+Y(o,c,127),c+=7);Oe--;)N[z++]=ge}}var Ye=N.subarray(0,A),X=N.subarray(A);m=Ve(Ye),_=Ve(X),p=Me(Ye,m,1),$=Me(X,_,1)}else Z(1);else{var C=Xr(c)+4,U=o[C-4]|o[C-3]<<8,B=C+U;if(B>r){f&&Z(0);break}l&&i(a+U),n.set(o.subarray(C,B),a),e.b=a+=U,e.p=c=B*8,e.f=u;continue}if(c>y){f&&Z(0);break}}l&&i(a+131072);for(var xt=(1<<m)-1,Vt=(1<<_)-1,Ie=c;;Ie=c){var ge=p[He(o,c)&xt],de=ge>>4;if(c+=ge&15,c>y){f&&Z(0);break}if(ge||Z(2),de<256)n[a++]=de;else if(de==256){Ie=c,p=null;break}else{var Qe=de-254;if(de>264){var z=de-257,Se=Tt[z];Qe=Y(o,c,(1<<Se)-1)+At[z],c+=Se}var Fe=$[He(o,c)&Vt],je=Fe>>4;Fe||Z(3),c+=Fe&15;var X=qr[je];if(je>3){var Se=Dt[je];X+=He(o,c)&(1<<Se)-1,c+=Se}if(c>y){f&&Z(0);break}l&&i(a+131072);var xe=a+Qe;if(a<X){var et=s-X,Ht=Math.min(X,xe);for(et+a<0&&Z(3);a<Ht;++a)n[a]=t[et+a]}for(;a<xe;a+=4)n[a]=n[a-X],n[a+1]=n[a+1-X],n[a+2]=n[a+2-X],n[a+3]=n[a+3-X];a=xe}}e.l=p,e.p=Ie,e.b=a,e.f=u,p&&(u=1,e.m=m,e.d=$,e.n=_)}while(!u);return a==n.length?n:Yr(n,0,a)},eo=new G(0),to=function(o){(o[0]!=31||o[1]!=139||o[2]!=8)&&Z(6,"invalid gzip data");var e=o[3],n=10;e&4&&(n+=(o[10]|o[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!o[n++]);return n+(e&2)},no=function(o){var e=o.length;return(o[e-4]|o[e-3]<<8|o[e-2]<<16|o[e-1]<<24)>>>0},ro=function(o,e){return((o[0]&15)!=8||o[0]>>4>7||(o[0]<<8|o[1])%31)&&Z(6,"invalid zlib data"),(o[1]>>5&1)==+!e&&Z(6,"invalid zlib data: "+(o[1]&32?"need":"unexpected")+" dictionary"),(o[1]>>3&4)+2};function oo(o,e){return We(o,{i:2},e&&e.out,e&&e.dictionary)}function so(o,e){var n=to(o);return n+8>o.length&&Z(6,"invalid gzip data"),We(o.subarray(n,-8),{i:2},e&&e.out||new G(no(o)),e&&e.dictionary)}function io(o,e){return We(o.subarray(ro(o,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Ge(o,e){return o[0]==31&&o[1]==139&&o[2]==8?so(o,e):(o[0]&15)!=8||o[0]>>4>7||(o[0]<<8|o[1])%31?oo(o,e):io(o,e)}var lo=typeof TextDecoder<"u"&&new TextDecoder,ao=0;try{lo.decode(eo,{stream:!0}),ao=1}catch{}var Bt=(o,e)=>o*Math.pow(2,e),Ue=(o,e)=>Math.floor(o/Math.pow(2,e)),ze=(o,e)=>Bt(o.getUint16(e+1,!0),8)+o.getUint8(e),Et=(o,e)=>Bt(o.getUint32(e+2,!0),16)+o.getUint16(e,!0),co=(o,e,n,t,r)=>{if(o!=t.getUint8(r))return o-t.getUint8(r);const s=ze(t,r+1);if(e!=s)return e-s;const l=ze(t,r+4);return n!=l?n-l:0},uo=(o,e,n,t)=>{const r=Ot(o,e|128,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!0}:null},pt=(o,e,n,t)=>{const r=Ot(o,e,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!1}:null},Ot=(o,e,n,t)=>{let r=0,s=o.byteLength/17-1;for(;r<=s;){const l=s+r>>1,f=co(e,n,t,o,l*17);if(f>0)r=l+1;else if(f<0)s=l-1;else return[Et(o,l*17+7),o.getUint32(l*17+13,!0)]}return null},fo=(o,e)=>o.is_dir&&!e.is_dir?1:!o.is_dir&&e.is_dir?-1:o.z!==e.z?o.z-e.z:o.x!==e.x?o.x-e.x:o.y-e.y,Pt=(o,e)=>{const n=o.getUint8(e*17);return{z:n&127,x:ze(o,e*17+1),y:ze(o,e*17+4),offset:Et(o,e*17+7),length:o.getUint32(e*17+13,!0),is_dir:n>>7===1}},$t=o=>{const e=[],n=new DataView(o);for(let t=0;t<n.byteLength/17;t++)e.push(Pt(n,t));return po(e)},po=o=>{o.sort(fo);const e=new ArrayBuffer(17*o.length),n=new Uint8Array(e);for(let t=0;t<o.length;t++){const r=o[t];let s=r.z;r.is_dir&&(s=s|128),n[t*17]=s,n[t*17+1]=r.x&255,n[t*17+2]=r.x>>8&255,n[t*17+3]=r.x>>16&255,n[t*17+4]=r.y&255,n[t*17+5]=r.y>>8&255,n[t*17+6]=r.y>>16&255,n[t*17+7]=r.offset&255,n[t*17+8]=Ue(r.offset,8)&255,n[t*17+9]=Ue(r.offset,16)&255,n[t*17+10]=Ue(r.offset,24)&255,n[t*17+11]=Ue(r.offset,32)&255,n[t*17+12]=Ue(r.offset,48)&255,n[t*17+13]=r.length&255,n[t*17+14]=r.length>>8&255,n[t*17+15]=r.length>>16&255,n[t*17+16]=r.length>>24&255}return e},$o=(o,e)=>{if(o.byteLength<17)return null;const n=o.byteLength/17,t=Pt(o,n-1);if(t.is_dir){const r=t.z,s=e.z-r,l=Math.trunc(e.x/(1<<s)),f=Math.trunc(e.y/(1<<s));return{z:r,x:l,y:f}}return null};function mo(o){return I(this,null,function*(){const e=yield o.getBytes(0,512e3),n=new DataView(e.data),t=n.getUint32(4,!0),r=n.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,t)));let f=0;l.compression==="gzip"&&(f=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let u=0;"maxzoom"in l&&(u=+l.maxzoom);let c=0,a=0,p=0,$=-180,m=-85,_=180,y=85;if(l.bounds){const C=l.bounds.split(",");$=+C[0],m=+C[1],_=+C[2],y=+C[3]}if(l.center){const C=l.center.split(",");c=+C[0],a=+C[1],p=+C[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:f,tileType:1,minZoom:i,maxZoom:u,minLon:$,minLat:m,maxLon:_,maxLat:y,centerZoom:p,centerLon:c,centerLat:a,etag:e.etag}})}function ho(o,e,n,t,r,s,l){return I(this,null,function*(){let f=yield n.getArrayBuffer(e,o.rootDirectoryOffset,o.rootDirectoryLength,o);o.specVersion===1&&(f=$t(f));const i=pt(new DataView(f),t,r,s);if(i){let a=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(a);return p.getUint8(0)==31&&p.getUint8(1)==139&&(a=Ge(new Uint8Array(a))),{data:a}}const u=$o(new DataView(f),{z:t,x:r,y:s});if(u){const c=uo(new DataView(f),u.z,u.x,u.y);if(c){let a=yield n.getArrayBuffer(e,c.offset,c.length,o);o.specVersion===1&&(a=$t(a));const p=pt(new DataView(a),t,r,s);if(p){let m=(yield e.getBytes(p.offset,p.length,l)).data;const _=new DataView(m);return _.getUint8(0)==31&&_.getUint8(1)==139&&(m=Ge(new Uint8Array(m))),{data:m}}}}})}var Nt={getHeader:mo,getZxy:ho},go=class{constructor(){this.tile=(o,e)=>{if(o.type=="json"){const n=o.url.substr(10);let t=this.tiles.get(n);return t||(t=new mt(n),this.tiles.set(n,t)),t.getHeader().then(r=>{const s={tiles:[o.url+"/{z}/{x}/{y}"],minzoom:r.minZoom,maxzoom:r.maxZoom,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat]};e(null,s,null,null)}).catch(r=>{e(r,null,null,null)}),{cancel:()=>{}}}else{const n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=o.url.match(n);if(!t)throw new Error("Invalid PMTiles protocol URL");const r=t[1];let s=this.tiles.get(r);s||(s=new mt(r),this.tiles.set(r,s));const l=t[2],f=t[3],i=t[4],u=new AbortController,c=u.signal;let a=()=>{u.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+f,+i,c).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:a}}},this.tiles=new Map}add(o){this.tiles.set(o.source.getKey(),o)}get(o){return this.tiles.get(o)}};function _e(o,e){return(e>>>0)*4294967296+(o>>>0)}function _o(o,e){const n=e.buf;let t,r;if(r=n[e.pos++],t=(r&112)>>4,r<128||(r=n[e.pos++],t|=(r&127)<<3,r<128)||(r=n[e.pos++],t|=(r&127)<<10,r<128)||(r=n[e.pos++],t|=(r&127)<<17,r<128)||(r=n[e.pos++],t|=(r&127)<<24,r<128)||(r=n[e.pos++],t|=(r&1)<<31,r<128))return _e(o,t);throw new Error("Expected varint not more than 10 bytes")}function Ae(o){const e=o.buf;let n,t;return t=e[o.pos++],n=t&127,t<128||(t=e[o.pos++],n|=(t&127)<<7,t<128)||(t=e[o.pos++],n|=(t&127)<<14,t<128)||(t=e[o.pos++],n|=(t&127)<<21,t<128)?n:(t=e[o.pos],n|=(t&15)<<28,_o(n,o))}function wo(o,e,n,t){if(t==0){n==1&&(e[0]=o-1-e[0],e[1]=o-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}var vo=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function yo(o,e,n){if(o>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,o)-1||n>Math.pow(2,o)-1)throw Error("tile x/y outside zoom level bounds");const t=vo[o],r=Math.pow(2,o);let s=0,l=0,f=0;const i=[e,n];let u=r/2;for(;u>0;)s=(i[0]&u)>0?1:0,l=(i[1]&u)>0?1:0,f+=u*u*(3*s^l),wo(u,i,s,l),u=u/2;return t+f}function zt(o,e){return I(this,null,function*(){if(e===1||e===0)return o;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Ge(new Uint8Array(o));{let t=new Response(o).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var bo=127;function ko(o,e){let n=0,t=o.length-1;for(;n<=t;){const r=t+n>>1,s=e-o[r].tileId;if(s>0)n=r+1;else if(s<0)t=r-1;else return o[r]}return t>=0&&(o[t].runLength===0||e-o[t].tileId<o[t].runLength)?o[t]:null}var Lo=class{constructor(o){this.url=o}getKey(){return this.url}getBytes(o,e,n){return I(this,null,function*(){let t;n||(t=new AbortController,n=t.signal);let r=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+o+"-"+(o+e-1)}});if(r.status===416&&o===0){const f=r.headers.get("Content-Range");if(!f||!f.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+f.substr(8);r=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(i-1)}})}if(r.status>=300)throw Error("Bad response code: "+r.status);const s=r.headers.get("Content-Length");if(r.status===200&&(!s||+s>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield r.arrayBuffer(),etag:r.headers.get("ETag")||void 0,cacheControl:r.headers.get("Cache-Control")||void 0,expires:r.headers.get("Expires")||void 0}})}};function Q(o,e){const n=o.getUint32(e+4,!0),t=o.getUint32(e+0,!0);return n*Math.pow(2,32)+t}function Co(o,e){const n=new DataView(o),t=n.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:Q(n,8),rootDirectoryLength:Q(n,16),jsonMetadataOffset:Q(n,24),jsonMetadataLength:Q(n,32),leafDirectoryOffset:Q(n,40),leafDirectoryLength:Q(n,48),tileDataOffset:Q(n,56),tileDataLength:Q(n,64),numAddressedTiles:Q(n,72),numTileEntries:Q(n,80),numTileContents:Q(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function It(o){const e={buf:new Uint8Array(o),pos:0},n=Ae(e),t=[];let r=0;for(let s=0;s<n;s++){const l=Ae(e);t.push({tileId:r+l,offset:0,length:0,runLength:1}),r+=l}for(let s=0;s<n;s++)t[s].runLength=Ae(e);for(let s=0;s<n;s++)t[s].length=Ae(e);for(let s=0;s<n;s++){const l=Ae(e);l===0&&s>0?t[s].offset=t[s-1].offset+t[s-1].length:t[s].offset=l-1}return t}function To(o){const e=new DataView(o);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ye=class extends Error{};function Do(o,e,n,t){return I(this,null,function*(){const r=yield o.getBytes(0,16384);if(new DataView(r.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(To(r.data)<3)return[yield Nt.getHeader(o)];const l=r.data.slice(0,bo);let f=r.etag;t&&r.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+o.getKey()),f=void 0);const i=Co(l,f);if(n){const u=r.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),c=o.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,a=It(yield e(u,i.internalCompression));return[i,[c,a.length,a]]}return[i,void 0]})}function So(o,e,n,t,r){return I(this,null,function*(){const s=yield o.getBytes(n,t);if(r.etag&&r.etag!==s.etag)throw new ye(s.etag);const l=yield e(s.data,r.internalCompression),f=It(l);if(f.length===0)throw new Error("Empty directory is invalid");return f})}var Uo=class{constructor(o=100,e=!0,n=zt){this.cache=new Map,this.maxCacheEntries=o,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(o,e){return I(this,null,function*(){const n=o.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const t=new Promise((r,s)=>{Do(o,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),r(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:t}),t})}getDirectory(o,e,n,t){return I(this,null,function*(){const r=o.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const s=new Promise((l,f)=>{So(o,this.decompress,e,n,t).then(i=>{l(i),this.prune()}).catch(i=>{f(i)})});return this.cache.set(r,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(o,e,n,t){return I(this,null,function*(){const r=o.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const s=new Promise((l,f)=>{o.getBytes(e,n).then(i=>{if(t.etag&&t.etag!==i.etag)throw new ye(i.etag);l(i.data),this.cache.has(r),this.prune()}).catch(i=>{f(i)})});return this.cache.set(r,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let o=1/0,e;this.cache.forEach((n,t)=>{n.lastUsed<o&&(o=n.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(o,e){return I(this,null,function*(){this.cache.delete(o.getKey()),yield this.getHeader(o,e)})}},mt=class{constructor(o,e,n){typeof o=="string"?this.source=new Lo(o):this.source=o,n?this.decompress=n:this.decompress=zt,e?this.cache=e:this.cache=new Uo}getHeader(){return I(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(o,e,n,t){return I(this,null,function*(){const r=yo(o,e,n),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Nt.getZxy(s,this.source,this.cache,o,e,n,t);if(o<s.minZoom||o>s.maxZoom)return;let l=s.rootDirectoryOffset,f=s.rootDirectoryLength;for(let i=0;i<=3;i++){const u=yield this.cache.getDirectory(this.source,l,f,s),c=ko(u,r);if(c)if(c.runLength>0){const a=yield this.source.getBytes(s.tileDataOffset+c.offset,c.length,t);if(s.etag&&s.etag!==a.etag)throw new ye(a.etag);return{data:yield this.decompress(a.data,s.tileCompression),cacheControl:a.cacheControl,expires:a.expires}}else l=s.leafDirectoryOffset+c.offset,f=c.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(o,e,n,t){return I(this,null,function*(){try{return yield this.getZxyAttempt(o,e,n,t)}catch(r){if(r instanceof ye)return this.cache.invalidate(this.source,r.message),yield this.getZxyAttempt(o,e,n,t);throw r}})}getMetadataAttempt(){return I(this,null,function*(){const o=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(o.jsonMetadataOffset,o.jsonMetadataLength);if(o.etag&&o.etag!==e.etag)throw new ye(e.etag);const n=yield this.decompress(e.data,o.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(n))})}getMetadata(){return I(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(o){if(o instanceof ye)return this.cache.invalidate(this.source,o.message),yield this.getMetadataAttempt();throw o}})}};function Ao(o){return Ke(()=>{let e=new go;st.addProtocol("pmtiles",e.tile)}),kt(()=>{st.removeProtocol("pmtiles")}),[]}class Mo extends x{constructor(e){super(),V(this,e,Ao,null,H,{})}}function ht(o,e,n){const t=o.slice();return t[15]=e[n],t}function Bo(o){let e;return{c(){e=T("Home")},m(n,t){g(n,e,t)},d(n){n&&d(e)}}}function gt(o){let e,n;return e=new nn({props:{errorMessage:o[1]}}),{c(){b(e.$$.fragment)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.errorMessage=t[1]),e.$set(s)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function dt(o){let e,n,t,r;function s(i){o[10](i)}function l(i){o[11](i)}let f={schemes:o[2]};return o[3]!==void 0&&(f.schemesToBeShown=o[3]),o[4]!==void 0&&(f.filterText=o[4]),e=new On({props:f}),K.push(()=>q(e,"schemesToBeShown",s)),K.push(()=>q(e,"filterText",l)),{c(){b(e.$$.fragment)},m(i,u){k(e,i,u),r=!0},p(i,u){const c={};u&4&&(c.schemes=i[2]),!n&&u&8&&(n=!0,c.schemesToBeShown=i[3],W(()=>n=!1)),!t&&u&16&&(t=!0,c.filterText=i[4],W(()=>t=!1)),e.$set(c)},i(i){r||(w(e.$$.fragment,i),r=!0)},o(i){v(e.$$.fragment,i),r=!1},d(i){L(e,i)}}}function _t(o){let e,n,t=we(o[2].values()),r=[];for(let l=0;l<t.length;l+=1)r[l]=vt(ht(o,t,l));const s=l=>v(r[l],1,1,()=>{r[l]=null});return{c(){e=M("ul");for(let l=0;l<r.length;l+=1)r[l].c()},m(l,f){g(l,e,f);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null);n=!0},p(l,f){if(f&13){t=we(l[2].values());let i;for(i=0;i<t.length;i+=1){const u=ht(l,t,i);r[i]?(r[i].p(u,f),w(r[i],1)):(r[i]=vt(u),r[i].c(),w(r[i],1),r[i].m(e,null))}for(be(),i=t.length;i<r.length;i+=1)s(i);ke()}},i(l){if(!n){for(let f=0;f<t.length;f+=1)w(r[f]);n=!0}},o(l){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)v(r[f]);n=!1},d(l){l&&d(e),Ze(r,l)}}}function wt(o){let e,n;return e=new Sr({props:{scheme:o[15],authorityNames:o[0]}}),{c(){b(e.$$.fragment)},m(t,r){k(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.scheme=t[15]),r&1&&(s.authorityNames=t[0]),e.$set(s)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function vt(o){let e=o[3].has(o[15].scheme_reference),n,t,r=e&&wt(o);return{c(){r&&r.c(),n=rn()},m(s,l){r&&r.m(s,l),g(s,n,l),t=!0},p(s,l){l&12&&(e=s[3].has(s[15].scheme_reference)),e?r?(r.p(s,l),l&12&&w(r,1)):(r=wt(s),r.c(),w(r,1),r.m(n.parentNode,n)):r&&(be(),v(r,1,1,()=>{r=null}),ke())},i(s){t||(w(r),t=!0)},o(s){v(r),t=!1},d(s){s&&d(n),r&&r.d(s)}}}function Eo(o){let e,n,t,r,s,l,f,i,u,c,a,p,$;n=new Pe({props:{$$slots:{default:[Bo]},$$scope:{ctx:o}}}),n.$on("click",o[9]),f=new ln({props:{boundaryGeojson:o[5]}});let m=o[1]&&gt(o);c=new Xt({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:o[7]}});let _=o[2].size>0&&dt(o),y=o[0]&&_t(o);return{c(){e=M("div"),b(n.$$.fragment),t=S(),r=M("div"),s=M("h1"),s.textContent="Browse schemes",l=S(),b(f.$$.fragment),i=S(),m&&m.c(),u=S(),b(c.$$.fragment),a=S(),_&&_.c(),p=S(),y&&y.c(),ue(r,"display","flex"),ue(r,"justify-content","space-between"),F(e,"slot","sidebar"),F(e,"class","govuk-prose")},m(h,C){g(h,e,C),k(n,e,null),D(e,t),D(e,r),D(r,s),D(r,l),k(f,r,null),D(e,i),m&&m.m(e,null),D(e,u),k(c,e,null),D(e,a),_&&_.m(e,null),D(e,p),y&&y.m(e,null),$=!0},p(h,C){const U={};C&262144&&(U.$$scope={dirty:C,ctx:h}),n.$set(U);const B={};C&32&&(B.boundaryGeojson=h[5]),f.$set(B),h[1]?m?(m.p(h,C),C&2&&w(m,1)):(m=gt(h),m.c(),w(m,1),m.m(e,u)):m&&(be(),v(m,1,1,()=>{m=null}),ke()),h[2].size>0?_?(_.p(h,C),C&4&&w(_,1)):(_=dt(h),_.c(),w(_,1),_.m(e,p)):_&&(be(),v(_,1,1,()=>{_=null}),ke()),h[0]?y?(y.p(h,C),C&1&&w(y,1)):(y=_t(h),y.c(),w(y,1),y.m(e,null)):y&&(be(),v(y,1,1,()=>{y=null}),ke())},i(h){$||(w(n.$$.fragment,h),w(f.$$.fragment,h),w(m),w(c.$$.fragment,h),w(_),w(y),$=!0)},o(h){v(n.$$.fragment,h),v(f.$$.fragment,h),v(m),v(c.$$.fragment,h),v(_),v(y),$=!1},d(h){h&&d(e),L(n),L(f),m&&m.d(),L(c),_&&_.d(),y&&y.d()}}}function Oo(o){let e,n,t,r,s,l,f,i,u,c,a,p,$,m;return e=new Er({}),t=new Zn({}),s=new pr({}),f=new br({}),u=new Hr({}),a=new Dn({}),$=new rr({}),{c(){b(e.$$.fragment),n=S(),b(t.$$.fragment),r=S(),b(s.$$.fragment),l=S(),b(f.$$.fragment),i=S(),b(u.$$.fragment),c=S(),b(a.$$.fragment),p=S(),b($.$$.fragment)},m(_,y){k(e,_,y),g(_,n,y),k(t,_,y),g(_,r,y),k(s,_,y),g(_,l,y),k(f,_,y),g(_,i,y),k(u,_,y),g(_,c,y),k(a,_,y),g(_,p,y),k($,_,y),m=!0},i(_){m||(w(e.$$.fragment,_),w(t.$$.fragment,_),w(s.$$.fragment,_),w(f.$$.fragment,_),w(u.$$.fragment,_),w(a.$$.fragment,_),w($.$$.fragment,_),m=!0)},o(_){v(e.$$.fragment,_),v(t.$$.fragment,_),v(s.$$.fragment,_),v(f.$$.fragment,_),v(u.$$.fragment,_),v(a.$$.fragment,_),v($.$$.fragment,_),m=!1},d(_){_&&(d(n),d(r),d(l),d(i),d(c),d(p)),L(e,_),L(t,_),L(s,_),L(f,_),L(u,_),L(a,_),L($,_)}}}function Po(o){let e,n,t,r,s,l,f,i,u,c;return e=new Kn({}),s=new un({props:{small:!0,$$slots:{default:[Oo]},$$scope:{ctx:o}}}),f=new dn({}),u=new fn({props:{style:o[6]}}),{c(){b(e.$$.fragment),n=S(),t=M("hr"),r=S(),b(s.$$.fragment),l=S(),b(f.$$.fragment),i=S(),b(u.$$.fragment)},m(a,p){k(e,a,p),g(a,n,p),g(a,t,p),g(a,r,p),k(s,a,p),g(a,l,p),k(f,a,p),g(a,i,p),k(u,a,p),c=!0},p(a,p){const $={};p&262144&&($.$$scope={dirty:p,ctx:a}),s.$set($)},i(a){c||(w(e.$$.fragment,a),w(s.$$.fragment,a),w(f.$$.fragment,a),w(u.$$.fragment,a),c=!0)},o(a){v(e.$$.fragment,a),v(s.$$.fragment,a),v(f.$$.fragment,a),v(u.$$.fragment,a),c=!1},d(a){a&&(d(n),d(t),d(r),d(l),d(i)),L(e,a),L(s,a),L(f,a),L(u,a)}}}function No(o){let e,n,t,r,s,l,f,i,u,c,a;return e=new cn({props:{colorInterventions:Lt("v1")}}),t=new oe({props:{layer:"interventions-points",tooltip:o[8]}}),s=new oe({props:{layer:"interventions-lines",tooltip:o[8]}}),f=new oe({props:{layer:"interventions-polygons",tooltip:o[8]}}),c=new qe({props:{label:"Layers",open:!0,$$slots:{default:[Po]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment),n=S(),b(t.$$.fragment),r=S(),b(s.$$.fragment),l=S(),b(f.$$.fragment),i=S(),u=M("div"),b(c.$$.fragment),F(u,"class","top-right svelte-nlvvhu")},m(p,$){k(e,p,$),g(p,n,$),k(t,p,$),g(p,r,$),k(s,p,$),g(p,l,$),k(f,p,$),g(p,i,$),g(p,u,$),k(c,u,null),a=!0},p(p,$){const m={};$&262144&&(m.$$scope={dirty:$,ctx:p}),c.$set(m)},i(p){a||(w(e.$$.fragment,p),w(t.$$.fragment,p),w(s.$$.fragment,p),w(f.$$.fragment,p),w(c.$$.fragment,p),a=!0)},o(p){v(e.$$.fragment,p),v(t.$$.fragment,p),v(s.$$.fragment,p),v(f.$$.fragment,p),v(c.$$.fragment,p),a=!1},d(p){p&&(d(n),d(r),d(l),d(i),d(u)),L(e,p),L(t,p),L(s,p),L(f,p),L(c)}}}function zo(o){let e,n,t,r,s;return n=new Mo({}),r=new an({props:{style:o[6],$$slots:{default:[No]},$$scope:{ctx:o}}}),{c(){e=M("div"),b(n.$$.fragment),t=S(),b(r.$$.fragment),F(e,"slot","main")},m(l,f){g(l,e,f),k(n,e,null),D(e,t),k(r,e,null),s=!0},p(l,f){const i={};f&262144&&(i.$$scope={dirty:f,ctx:l}),r.$set(i)},i(l){s||(w(n.$$.fragment,l),w(r.$$.fragment,l),s=!0)},o(l){v(n.$$.fragment,l),v(r.$$.fragment,l),s=!1},d(l){l&&d(e),L(n),L(r)}}}function Io(o){let e,n;return e=new sn({props:{$$slots:{main:[zo],sidebar:[Eo]},$$scope:{ctx:o}}}),{c(){b(e.$$.fragment)},m(t,r){k(e,t,r),n=!0},p(t,[r]){const s={};r&262207&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Fo(o,e,n){let t,r;J(o,se,C=>n(12,t=C)),J(o,Le,C=>n(5,r=C));let s=null;Ke(async()=>{Yt();let C=await Qt();n(0,s=new Set(C.features.map(U=>U.properties.name)))});let f=new URLSearchParams(window.location.search).get("style")||"dataviz",i="",u=new Map,c=new Set,a="";kt(()=>{Le.set(en())});function p(C){try{let U=JSON.parse(C);n(2,u=Sn(U)),Le.set(U),n(1,i=""),t==null||t.fitBounds(bt(U),{padding:20,animate:!1})}catch(U){n(1,i=`Couldn't load schemes from a file: ${U}`)}}function $(C){let U=C.properties;var B='<div style="max-width: 30vw;">';return B+=`<h2>${m(U.name)} (${U.intervention_type})</h2>`,B+=`<p>Scheme reference: ${U.scheme_reference}</p>`,U.length_meters&&(B+=`<p>Length: ${tn(U.length_meters)}</p>`),U.description&&(B+=`<p>${m(U.description)}</p>`),B+="</div>",B}function m(C){return a?C.replace(new RegExp(a,"gi"),U=>`<mark>${U}</mark>`):C}const _=()=>window.open("index.html");function y(C){c=C,n(3,c)}function h(C){a=C,n(4,a)}return[s,i,u,c,a,r,f,p,$,_,y,h]}class jo extends x{constructor(e){super(),V(this,e,Fo,Io,H,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new jo({target:document.getElementById("app")});
