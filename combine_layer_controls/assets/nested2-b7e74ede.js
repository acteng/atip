import{S as q,i as J,s as G,g as L,f as A,e as j,u as z,m as U,j as M,k,x as R,t as b,l as S,p as E,q as D,W as ne,$ as re,r as Le,b as he,c as me,F as vt,o as ge,a as pe,h as x,v as Ne,w as yt,X as Ue,aV as wt,_ as bt,P as We,B as Qe,aW as Ve,ad as Xe,d as St,O as Ie,R as je,y as ue,n as ce,Q as Tt,z as Lt,a6 as Ut,aN as Dt,E as kt,aa as Mt}from"./stores-bdfe9da4.js";import{C as De,S as Ze,d as Et,M as Ye,e as Bt,L as Ct,Z as zt,f as At,I as Ot,B as Pt,b as Nt}from"./Map-da99883b.js";function Vt(t){let e=new Map;for(let[r,n]of Object.entries(t.schemes))e.set(r,{scheme_reference:r,num_features:0,authority_or_region:n.authority_or_region,capital_scheme_id:n.capital_scheme_id,funding_programme:n.funding_programme});for(let r of t.features)e.get(r.properties.scheme_reference).num_features++,delete r.properties.id,delete r.properties.authority_or_region,delete r.properties.capital_scheme_id,delete r.properties.funding_programme,delete r.properties.valid,delete r.properties.centroid_lon,delete r.properties.centroid_lat;return e}function It(t){let e;return{c(){e=z("Clear")},m(r,n){M(r,e,n)},d(r){r&&E(e)}}}function jt(t){let e,r,n,s,o,i;return n=new pe({props:{$$slots:{default:[It]},$$scope:{ctx:t}}}),n.$on("click",t[11]),{c(){e=j("input"),r=A(),L(n.$$.fragment),x(e,"type","text"),x(e,"class","govuk-input govuk-input--width-10"),x(e,"id","filterText")},m(l,a){M(l,e,a),Ne(e,t[1]),M(l,r,a),U(n,l,a),s=!0,o||(i=yt(e,"input",t[10]),o=!0)},p(l,a){a&2&&e.value!==l[1]&&Ne(e,l[1]);const u={};a&16384&&(u.$$scope={dirty:a,ctx:l}),n.$set(u)},i(l){s||(b(n.$$.fragment,l),s=!0)},o(l){S(n.$$.fragment,l),s=!1},d(l){l&&(E(e),E(r)),D(n,l),o=!1,i()}}}function Zt(t){let e,r,n,s,o,i,l,a;function u(m){t[8](m)}let f={label:"Authority or region",id:"filterAuthority",choices:t[4],emptyOption:!0};t[2]!==void 0&&(f.value=t[2]),e=new Ze({props:f}),he.push(()=>me(e,"value",u));function c(m){t[9](m)}let d={label:"Funding programme",id:"filterFundingProgramme",choices:t[5],emptyOption:!0};return t[3]!==void 0&&(d.value=t[3]),s=new Ze({props:d}),he.push(()=>me(s,"value",c)),l=new vt({props:{label:"Any field",id:"filterText",$$slots:{default:[jt]},$$scope:{ctx:t}}}),{c(){L(e.$$.fragment),n=A(),L(s.$$.fragment),i=A(),L(l.$$.fragment)},m(m,p){U(e,m,p),M(m,n,p),U(s,m,p),M(m,i,p),U(l,m,p),a=!0},p(m,p){const _={};p&16&&(_.choices=m[4]),!r&&p&4&&(r=!0,_.value=m[2],ge(()=>r=!1)),e.$set(_);const w={};p&32&&(w.choices=m[5]),!o&&p&8&&(o=!0,w.value=m[3],ge(()=>o=!1)),s.$set(w);const y={};p&16386&&(y.$$scope={dirty:p,ctx:m}),l.$set(y)},i(m){a||(b(e.$$.fragment,m),b(s.$$.fragment,m),b(l.$$.fragment,m),a=!0)},o(m){S(e.$$.fragment,m),S(s.$$.fragment,m),S(l.$$.fragment,m),a=!1},d(m){m&&(E(n),E(i)),D(e,m),D(s,m),D(l,m)}}}function Ht(t){let e,r,n,s,o=t[0].size+"",i,l,a=t[6].route+"",u,f,c=t[6].area+"",d,m,p=t[6].crossing+"",_,w,y=t[6].other+"",$,B,g;return e=new De({props:{label:"Filters",$$slots:{default:[Zt]},$$scope:{ctx:t}}}),{c(){L(e.$$.fragment),r=A(),n=j("p"),s=z("Showing "),i=z(o),l=z(" schemes ("),u=z(a),f=z(" routes, "),d=z(c),m=z(` areas,
  `),_=z(p),w=z(" crossings, "),$=z(y),B=z(" other)")},m(h,v){U(e,h,v),M(h,r,v),M(h,n,v),k(n,s),k(n,i),k(n,l),k(n,u),k(n,f),k(n,d),k(n,m),k(n,_),k(n,w),k(n,$),k(n,B),g=!0},p(h,[v]){const O={};v&16446&&(O.$$scope={dirty:v,ctx:h}),e.$set(O),(!g||v&1)&&o!==(o=h[0].size+"")&&R(i,o),(!g||v&64)&&a!==(a=h[6].route+"")&&R(u,a),(!g||v&64)&&c!==(c=h[6].area+"")&&R(d,c),(!g||v&64)&&p!==(p=h[6].crossing+"")&&R(_,p),(!g||v&64)&&y!==(y=h[6].other+"")&&R($,y)},i(h){g||(b(e.$$.fragment,h),g=!0)},o(h){S(e.$$.fragment,h),g=!1},d(h){h&&(E(r),E(n)),D(e,h)}}}function Ft(t,e,r){let n;ne(t,re,y=>r(12,n=y));let{schemes:s}=e,{schemesToBeShown:o=new Set}=e,i="",l=[],a="",u=[],f="",c={area:0,route:0,crossing:0,other:0};Le(()=>{let y=new Set,$=new Set;for(let B of s.values())B.authority_or_region&&y.add(B.authority_or_region),B.funding_programme&&$.add(B.funding_programme);r(4,l=Array.from(y.entries())),l.sort(),r(5,u=Array.from($.entries())),u.sort()});function d(y,$,B){let g=y.toLowerCase(),h=v=>{if(g&&!JSON.stringify(v.properties).toLowerCase().includes(g))return!1;if($||B){let O=s.get(v.properties.scheme_reference);if($&&O.authority_or_region!=$||B&&O.funding_programme!=B)return!1}return!0};r(0,o=new Set(n.features.filter(h).map(v=>v.properties.scheme_reference))),r(6,c={area:0,route:0,crossing:0,other:0}),re.update(v=>{for(let O of v.features)o.has(O.properties.scheme_reference)?(delete O.properties.hide_while_editing,r(6,c[O.properties.intervention_type]++,c)):O.properties.hide_while_editing=!0;return v}),r(6,c)}function m(y){a=y,r(2,a)}function p(y){f=y,r(3,f)}function _(){i=this.value,r(1,i)}const w=()=>r(1,i="");return t.$$set=y=>{"schemes"in y&&r(7,s=y.schemes),"schemesToBeShown"in y&&r(0,o=y.schemesToBeShown)},t.$$.update=()=>{t.$$.dirty&14&&d(i,a,f)},[o,i,a,f,l,u,c,s,m,p,_,w]}class Kt extends q{constructor(e){super(),J(this,e,Ft,Ht,G,{schemes:7,schemesToBeShown:0})}}function Rt(t){let e,r,n,s;return e=new Bt({props:{color:t[2]}}),{c(){L(e.$$.fragment),r=A(),n=z(t[1])},m(o,i){U(e,o,i),M(o,r,i),M(o,n,i),s=!0},p(o,i){const l={};i&4&&(l.color=o[2]),e.$set(l),(!s||i&2)&&R(n,o[1])},i(o){s||(b(e.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),s=!1},d(o){o&&(E(r),E(n)),D(e,o)}}}function xt(t){let e,r,n,s,o;function i(a){t[8](a)}let l={id:t[0],hint:t[3],$$slots:{default:[Rt]},$$scope:{ctx:t}};return t[4]!==void 0&&(l.checked=t[4]),e=new Et({props:l}),he.push(()=>me(e,"checked",i)),s=new Ye({props:{layers:[t[0]],contents:t[5]}}),{c(){L(e.$$.fragment),n=A(),L(s.$$.fragment)},m(a,u){U(e,a,u),M(a,n,u),U(s,a,u),o=!0},p(a,[u]){const f={};u&1&&(f.id=a[0]),u&8&&(f.hint=a[3]),u&518&&(f.$$scope={dirty:u,ctx:a}),!r&&u&16&&(r=!0,f.checked=a[4],ge(()=>r=!1)),e.$set(f);const c={};u&1&&(c.layers=[a[0]]),s.$set(c)},i(a){o||(b(e.$$.fragment,a),b(s.$$.fragment,a),o=!0)},o(a){S(e.$$.fragment,a),S(s.$$.fragment,a),o=!1},d(a){a&&E(n),D(e,a),D(s,a)}}}function qt(t,e,r){let n;ne(t,Ue,d=>r(7,n=d));let{name:s}=e,{singularNoun:o}=e,{pluralNoun:i}=e,{color:l}=e,{hint:a}=e;wt(n,s,`https://atip.uk/layers/v1/${s}.pmtiles`),bt(n,{id:s,source:s,sourceLayer:s,color:l,opacity:.8});let u=!0;function f(d){return`<div class="govuk-prose"><p>${d.name??`Unnamed ${o}`}</p></div>`}function c(d){u=d,r(4,u)}return t.$$set=d=>{"name"in d&&r(0,s=d.name),"singularNoun"in d&&r(6,o=d.singularNoun),"pluralNoun"in d&&r(1,i=d.pluralNoun),"color"in d&&r(2,l=d.color),"hint"in d&&r(3,a=d.hint)},t.$$.update=()=>{t.$$.dirty&145&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",u?"visible":"none")},[s,i,l,a,u,f,o,n,c]}class et extends q{constructor(e){super(),J(this,e,qt,xt,G,{name:0,singularNoun:6,pluralNoun:1,color:2,hint:3})}}function Jt(t){let e,r;return e=new et({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",color:"blue",hint:"Hospital data from OpenStreetMap. Doesn't include outpatient clinics or individual doctor's offices."}}),{c(){L(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p:We,i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}class Gt extends q{constructor(e){super(),J(this,e,null,Jt,G,{})}}function Wt(t){let e;return{c(){e=z("Show on map")},m(r,n){M(r,e,n)},d(r){r&&E(e)}}}function Qt(t){let e;return{c(){e=z("Edit scheme")},m(r,n){M(r,e,n)},d(r){r&&E(e)}}}function Xt(t){let e,r,n=t[0].authority_or_region+"",s,o,i,l,a=t[0].capital_scheme_id+"",u,f,c,d,m=t[0].funding_programme+"",p,_,w,y,$,B,g;return y=new pe({props:{$$slots:{default:[Wt]},$$scope:{ctx:t}}}),y.$on("click",t[1]),B=new pe({props:{$$slots:{default:[Qt]},$$scope:{ctx:t}}}),B.$on("click",t[2]),{c(){e=j("p"),r=z("Authority or region: "),s=z(n),o=A(),i=j("p"),l=z("Capital scheme ID: "),u=z(a),f=A(),c=j("p"),d=z("Funding programme: "),p=z(m),_=A(),w=j("div"),L(y.$$.fragment),$=A(),L(B.$$.fragment),x(w,"class","govuk-button-group")},m(h,v){M(h,e,v),k(e,r),k(e,s),M(h,o,v),M(h,i,v),k(i,l),k(i,u),M(h,f,v),M(h,c,v),k(c,d),k(c,p),M(h,_,v),M(h,w,v),U(y,w,null),k(w,$),U(B,w,null),g=!0},p(h,v){(!g||v&1)&&n!==(n=h[0].authority_or_region+"")&&R(s,n),(!g||v&1)&&a!==(a=h[0].capital_scheme_id+"")&&R(u,a),(!g||v&1)&&m!==(m=h[0].funding_programme+"")&&R(p,m);const O={};v&32&&(O.$$scope={dirty:v,ctx:h}),y.$set(O);const C={};v&32&&(C.$$scope={dirty:v,ctx:h}),B.$set(C)},i(h){g||(b(y.$$.fragment,h),b(B.$$.fragment,h),g=!0)},o(h){S(y.$$.fragment,h),S(B.$$.fragment,h),g=!1},d(h){h&&(E(e),E(o),E(i),E(f),E(c),E(_),E(w)),D(y),D(B)}}}function Yt(t){let e,r;return e=new De({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Xt]},$$scope:{ctx:t}}}),{c(){L(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,[s]){const o={};s&1&&(o.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),s&33&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}function er(t,e,r){let n,s;ne(t,re,a=>r(3,n=a)),ne(t,Ue,a=>r(4,s=a));let{scheme:o}=e;function i(){let a={type:"FeatureCollection",features:n.features.filter(u=>u.properties.scheme_reference==o.scheme_reference)};s==null||s.fitBounds(Qe(a),{padding:20,animate:!1})}function l(){let a={type:"FeatureCollection",features:n.features.filter(f=>f.properties.scheme_reference==o.scheme_reference)},u=o.authority_or_region;window.localStorage.setItem(u,JSON.stringify(a)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return t.$$set=a=>{"scheme"in a&&r(0,o=a.scheme)},[o,i,l]}class tr extends q{constructor(e){super(),J(this,e,er,Yt,G,{scheme:0})}}function rr(t){let e,r;return e=new et({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",color:"red",hint:"Primary and secondary schools, from OpenStreetMap."}}),{c(){L(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p:We,i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}class nr extends q{constructor(e){super(),J(this,e,null,rr,G,{})}}var P=(t,e,r)=>new Promise((n,s)=>{var o=a=>{try{l(r.next(a))}catch(u){s(u)}},i=a=>{try{l(r.throw(a))}catch(u){s(u)}},l=a=>a.done?n(a.value):Promise.resolve(a.value).then(o,i);l((r=r.apply(t,e)).next())}),V=Uint8Array,ee=Uint16Array,sr=Int32Array,tt=new V([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rt=new V([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),or=new V([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nt=function(t,e){for(var r=new ee(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new sr(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)s[o]=o-r[n]<<5|n;return{b:r,r:s}},st=nt(tt,2),ot=st.b,ir=st.r;ot[28]=258,ir[258]=28;var ar=nt(rt,0),lr=ar.b,Se=new ee(32768);for(T=0;T<32768;++T)K=(T&43690)>>1|(T&21845)<<1,K=(K&52428)>>2|(K&13107)<<2,K=(K&61680)>>4|(K&3855)<<4,Se[T]=((K&65280)>>8|(K&255)<<8)>>1;var K,T,ae=function(t,e,r){for(var n=t.length,s=0,o=new ee(e);s<n;++s)t[s]&&++o[t[s]-1];var i=new ee(e);for(s=1;s<e;++s)i[s]=i[s-1]+o[s-1]<<1;var l;if(r){l=new ee(1<<e);var a=15-e;for(s=0;s<n;++s)if(t[s])for(var u=s<<4|t[s],f=e-t[s],c=i[t[s]-1]++<<f,d=c|(1<<f)-1;c<=d;++c)l[Se[c]>>a]=u}else for(l=new ee(n),s=0;s<n;++s)t[s]&&(l[s]=Se[i[t[s]-1]++]>>15-t[s]);return l},le=new V(288);for(T=0;T<144;++T)le[T]=8;var T;for(T=144;T<256;++T)le[T]=9;var T;for(T=256;T<280;++T)le[T]=7;var T;for(T=280;T<288;++T)le[T]=8;var T,it=new V(32);for(T=0;T<32;++T)it[T]=5;var T,fr=ae(le,9,1),ur=ae(it,5,1),we=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},H=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},be=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},cr=function(t){return(t+7)/8|0},hr=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new V(r-e);return n.set(t.subarray(e,r)),n},mr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],N=function(t,e,r){var n=new Error(e||mr[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,N),!r)throw n;return n},ke=function(t,e,r,n){var s=t.length,o=n?n.length:0;if(!s||e.f&&!e.l)return r||new V(0);var i=!r||e.i!=2,l=e.i;r||(r=new V(s*3));var a=function(Ae){var Oe=r.length;if(Ae>Oe){var Pe=new V(Math.max(Oe*2,Ae));Pe.set(r),r=Pe}},u=e.f||0,f=e.p||0,c=e.b||0,d=e.l,m=e.d,p=e.m,_=e.n,w=s*8;do{if(!d){u=H(t,f,1);var y=H(t,f+1,3);if(f+=3,y)if(y==1)d=fr,m=ur,p=9,_=5;else if(y==2){var h=H(t,f,31)+257,v=H(t,f+10,15)+4,O=h+H(t,f+5,31)+1;f+=14;for(var C=new V(O),W=new V(19),I=0;I<v;++I)W[or[I]]=H(t,f+I*3,7);f+=v*3;for(var Me=we(W),gt=(1<<Me)-1,pt=ae(W,Me,1),I=0;I<O;){var Ee=pt[H(t,f,gt)];f+=Ee&15;var $=Ee>>4;if($<16)C[I++]=$;else{var Q=0,fe=0;for($==16?(fe=3+H(t,f,3),f+=2,Q=C[I-1]):$==17?(fe=3+H(t,f,7),f+=3):$==18&&(fe=11+H(t,f,127),f+=7);fe--;)C[I++]=Q}}var Be=C.subarray(0,h),Z=C.subarray(h);p=we(Be),_=we(Z),d=ae(Be,p,1),m=ae(Z,_,1)}else N(1);else{var $=cr(f)+4,B=t[$-4]|t[$-3]<<8,g=$+B;if(g>s){l&&N(0);break}i&&a(c+B),r.set(t.subarray($,g),c),e.b=c+=B,e.p=f=g*8,e.f=u;continue}if(f>w){l&&N(0);break}}i&&a(c+131072);for(var dt=(1<<p)-1,_t=(1<<_)-1,_e=f;;_e=f){var Q=d[be(t,f)&dt],X=Q>>4;if(f+=Q&15,f>w){l&&N(0);break}if(Q||N(2),X<256)r[c++]=X;else if(X==256){_e=f,d=null;break}else{var Ce=X-254;if(X>264){var I=X-257,se=tt[I];Ce=H(t,f,(1<<se)-1)+ot[I],f+=se}var $e=m[be(t,f)&_t],ve=$e>>4;$e||N(3),f+=$e&15;var Z=lr[ve];if(ve>3){var se=rt[ve];Z+=be(t,f)&(1<<se)-1,f+=se}if(f>w){l&&N(0);break}i&&a(c+131072);var ye=c+Ce;if(c<Z){var ze=o-Z,$t=Math.min(Z,ye);for(ze+c<0&&N(3);c<$t;++c)r[c]=n[ze+c]}for(;c<ye;c+=4)r[c]=r[c-Z],r[c+1]=r[c+1-Z],r[c+2]=r[c+2-Z],r[c+3]=r[c+3-Z];c=ye}}e.l=d,e.p=_e,e.b=c,e.f=u,d&&(u=1,e.m=p,e.d=m,e.n=_)}while(!u);return c==r.length?r:hr(r,0,c)},gr=new V(0),pr=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&N(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},dr=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},_r=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&N(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&N(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function $r(t,e){return ke(t,{i:2},e&&e.out,e&&e.dictionary)}function vr(t,e){var r=pr(t);return r+8>t.length&&N(6,"invalid gzip data"),ke(t.subarray(r,-8),{i:2},e&&e.out||new V(dr(t)),e&&e.dictionary)}function yr(t,e){return ke(t.subarray(_r(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Te(t,e){return t[0]==31&&t[1]==139&&t[2]==8?vr(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?$r(t,e):yr(t,e)}var wr=typeof TextDecoder<"u"&&new TextDecoder,br=0;try{wr.decode(gr,{stream:!0}),br=1}catch{}var at=(t,e)=>t*Math.pow(2,e),oe=(t,e)=>Math.floor(t/Math.pow(2,e)),de=(t,e)=>at(t.getUint16(e+1,!0),8)+t.getUint8(e),lt=(t,e)=>at(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),Sr=(t,e,r,n,s)=>{if(t!=n.getUint8(s))return t-n.getUint8(s);const o=de(n,s+1);if(e!=o)return e-o;const i=de(n,s+4);return r!=i?r-i:0},Tr=(t,e,r,n)=>{const s=ft(t,e|128,r,n);return s?{z:e,x:r,y:n,offset:s[0],length:s[1],is_dir:!0}:null},He=(t,e,r,n)=>{const s=ft(t,e,r,n);return s?{z:e,x:r,y:n,offset:s[0],length:s[1],is_dir:!1}:null},ft=(t,e,r,n)=>{let s=0,o=t.byteLength/17-1;for(;s<=o;){const i=o+s>>1,l=Sr(e,r,n,t,i*17);if(l>0)s=i+1;else if(l<0)o=i-1;else return[lt(t,i*17+7),t.getUint32(i*17+13,!0)]}return null},Lr=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,ut=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:de(t,e*17+1),y:de(t,e*17+4),offset:lt(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Fe=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(ut(r,n));return Ur(e)},Ur=t=>{t.sort(Lr);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const s=t[n];let o=s.z;s.is_dir&&(o=o|128),r[n*17]=o,r[n*17+1]=s.x&255,r[n*17+2]=s.x>>8&255,r[n*17+3]=s.x>>16&255,r[n*17+4]=s.y&255,r[n*17+5]=s.y>>8&255,r[n*17+6]=s.y>>16&255,r[n*17+7]=s.offset&255,r[n*17+8]=oe(s.offset,8)&255,r[n*17+9]=oe(s.offset,16)&255,r[n*17+10]=oe(s.offset,24)&255,r[n*17+11]=oe(s.offset,32)&255,r[n*17+12]=oe(s.offset,48)&255,r[n*17+13]=s.length&255,r[n*17+14]=s.length>>8&255,r[n*17+15]=s.length>>16&255,r[n*17+16]=s.length>>24&255}return e},Dr=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=ut(t,r-1);if(n.is_dir){const s=n.z,o=e.z-s,i=Math.trunc(e.x/(1<<o)),l=Math.trunc(e.y/(1<<o));return{z:s,x:i,y:l}}return null};function kr(t){return P(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),s=r.getUint16(8,!0),o=new TextDecoder("utf-8"),i=JSON.parse(o.decode(new DataView(e.data,10,n)));let l=0;i.compression==="gzip"&&(l=2);let a=0;"minzoom"in i&&(a=+i.minzoom);let u=0;"maxzoom"in i&&(u=+i.maxzoom);let f=0,c=0,d=0,m=-180,p=-85,_=180,w=85;if(i.bounds){const $=i.bounds.split(",");m=+$[0],p=+$[1],_=+$[2],w=+$[3]}if(i.center){const $=i.center.split(",");f=+$[0],c=+$[1],d=+$[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:l,tileType:1,minZoom:a,maxZoom:u,minLon:m,minLat:p,maxLon:_,maxLat:w,centerZoom:d,centerLon:f,centerLat:c,etag:e.etag}})}function Mr(t,e,r,n,s,o,i){return P(this,null,function*(){let l=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(l=Fe(l));const a=He(new DataView(l),n,s,o);if(a){let c=(yield e.getBytes(a.offset,a.length,i)).data;const d=new DataView(c);return d.getUint8(0)==31&&d.getUint8(1)==139&&(c=Te(new Uint8Array(c))),{data:c}}const u=Dr(new DataView(l),{z:n,x:s,y:o});if(u){const f=Tr(new DataView(l),u.z,u.x,u.y);if(f){let c=yield r.getArrayBuffer(e,f.offset,f.length,t);t.specVersion===1&&(c=Fe(c));const d=He(new DataView(c),n,s,o);if(d){let p=(yield e.getBytes(d.offset,d.length,i)).data;const _=new DataView(p);return _.getUint8(0)==31&&_.getUint8(1)==139&&(p=Te(new Uint8Array(p))),{data:p}}}}})}var ct={getHeader:kr,getZxy:Mr},Er=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Ke(r),this.tiles.set(r,n)),n.getHeader().then(s=>{const o={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:s.minZoom,maxzoom:s.maxZoom,bounds:[s.minLon,s.minLat,s.maxLon,s.maxLat]};e(null,o,null,null)}).catch(s=>{e(s,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const s=n[1];let o=this.tiles.get(s);o||(o=new Ke(s),this.tiles.set(s,o));const i=n[2],l=n[3],a=n[4],u=new AbortController,f=u.signal;let c=()=>{u.abort()};return o.getHeader().then(d=>{o.getZxy(+i,+l,+a,f).then(m=>{m?e(null,new Uint8Array(m.data),m.cacheControl,m.expires):d.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(m=>{m.name!=="AbortError"&&e(m,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function Y(t,e){return(e>>>0)*4294967296+(t>>>0)}function Br(t,e){const r=e.buf;let n,s;if(s=r[e.pos++],n=(s&112)>>4,s<128||(s=r[e.pos++],n|=(s&127)<<3,s<128)||(s=r[e.pos++],n|=(s&127)<<10,s<128)||(s=r[e.pos++],n|=(s&127)<<17,s<128)||(s=r[e.pos++],n|=(s&127)<<24,s<128)||(s=r[e.pos++],n|=(s&1)<<31,s<128))return Y(t,n);throw new Error("Expected varint not more than 10 bytes")}function ie(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,Br(r,t))}function Cr(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}var zr=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Ar(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=zr[t],s=Math.pow(2,t);let o=0,i=0,l=0;const a=[e,r];let u=s/2;for(;u>0;)o=(a[0]&u)>0?1:0,i=(a[1]&u)>0?1:0,l+=u*u*(3*o^i),Cr(u,a,o,i),u=u/2;return n+l}function ht(t,e){return P(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Te(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Or=127;function Pr(t,e){let r=0,n=t.length-1;for(;r<=n;){const s=n+r>>1,o=e-t[s].tileId;if(o>0)r=s+1;else if(o<0)n=s-1;else return t[s]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Nr=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return P(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let s=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(s.status===416&&t===0){const l=s.headers.get("Content-Range");if(!l||!l.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const a=+l.substr(8);s=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(a-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const o=s.headers.get("Content-Length");if(s.status===200&&(!o||+o>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function F(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Vr(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:F(r,8),rootDirectoryLength:F(r,16),jsonMetadataOffset:F(r,24),jsonMetadataLength:F(r,32),leafDirectoryOffset:F(r,40),leafDirectoryLength:F(r,48),tileDataOffset:F(r,56),tileDataLength:F(r,64),numAddressedTiles:F(r,72),numTileEntries:F(r,80),numTileContents:F(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function mt(t){const e={buf:new Uint8Array(t),pos:0},r=ie(e),n=[];let s=0;for(let o=0;o<r;o++){const i=ie(e);n.push({tileId:s+i,offset:0,length:0,runLength:1}),s+=i}for(let o=0;o<r;o++)n[o].runLength=ie(e);for(let o=0;o<r;o++)n[o].length=ie(e);for(let o=0;o<r;o++){const i=ie(e);i===0&&o>0?n[o].offset=n[o-1].offset+n[o-1].length:n[o].offset=i-1}return n}function Ir(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var te=class extends Error{};function jr(t,e,r,n){return P(this,null,function*(){const s=yield t.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Ir(s.data)<3)return[yield ct.getHeader(t)];const i=s.data.slice(0,Or);let l=s.etag;n&&s.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),l=void 0);const a=Vr(i,l);if(r){const u=s.data.slice(a.rootDirectoryOffset,a.rootDirectoryOffset+a.rootDirectoryLength),f=t.getKey()+"|"+(a.etag||"")+"|"+a.rootDirectoryOffset+"|"+a.rootDirectoryLength,c=mt(yield e(u,a.internalCompression));return[a,[f,c.length,c]]}return[a,void 0]})}function Zr(t,e,r,n,s){return P(this,null,function*(){const o=yield t.getBytes(r,n);if(s.etag&&s.etag!==o.etag)throw new te(o.etag);const i=yield e(o.data,s.internalCompression),l=mt(i);if(l.length===0)throw new Error("Empty directory is invalid");return l})}var Hr=class{constructor(t=100,e=!0,r=ht){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return P(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((s,o)=>{jr(t,this.decompress,this.prefetch,e).then(i=>{i[1]&&this.cache.set(i[1][0],{lastUsed:this.counter++,data:Promise.resolve(i[1][2])}),s(i[0]),this.prune()}).catch(i=>{o(i)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return P(this,null,function*(){const s=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((i,l)=>{Zr(t,this.decompress,e,r,n).then(a=>{i(a),this.prune()}).catch(a=>{l(a)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(t,e,r,n){return P(this,null,function*(){const s=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((i,l)=>{t.getBytes(e,r).then(a=>{if(n.etag&&n.etag!==a.etag)throw new te(a.etag);i(a.data),this.cache.has(s),this.prune()}).catch(a=>{l(a)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return P(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Ke=class{constructor(t,e,r){typeof t=="string"?this.source=new Nr(t):this.source=t,r?this.decompress=r:this.decompress=ht,e?this.cache=e:this.cache=new Hr}getHeader(){return P(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return P(this,null,function*(){const s=Ar(t,e,r),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return ct.getZxy(o,this.source,this.cache,t,e,r,n);if(t<o.minZoom||t>o.maxZoom)return;let i=o.rootDirectoryOffset,l=o.rootDirectoryLength;for(let a=0;a<=3;a++){const u=yield this.cache.getDirectory(this.source,i,l,o),f=Pr(u,s);if(f)if(f.runLength>0){const c=yield this.source.getBytes(o.tileDataOffset+f.offset,f.length,n);if(o.etag&&o.etag!==c.etag)throw new te(c.etag);return{data:yield this.decompress(c.data,o.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else i=o.leafDirectoryOffset+f.offset,l=f.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return P(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(s){if(s instanceof te)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(t,e,r,n);throw s}})}getMetadataAttempt(){return P(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new te(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return P(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof te)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Fr(t){return Le(()=>{let e=new Er;Ve.addProtocol("pmtiles",e.tile)}),Xe(()=>{Ve.removeProtocol("pmtiles")}),[]}class Kr extends q{constructor(e){super(),J(this,e,Fr,null,G,{})}}function Re(t,e,r){const n=t.slice();return n[11]=e[r],n}function Rr(t){let e;return{c(){e=z("Home")},m(r,n){M(r,e,n)},d(r){r&&E(e)}}}function xe(t){let e,r;return e=new kt({props:{errorMessage:t[0]}}),{c(){L(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,s){const o={};s&1&&(o.errorMessage=n[0]),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}function qe(t){let e,r,n;function s(i){t[8](i)}let o={schemes:t[1]};return t[2]!==void 0&&(o.schemesToBeShown=t[2]),e=new Kt({props:o}),he.push(()=>me(e,"schemesToBeShown",s)),{c(){L(e.$$.fragment)},m(i,l){U(e,i,l),n=!0},p(i,l){const a={};l&2&&(a.schemes=i[1]),!r&&l&4&&(r=!0,a.schemesToBeShown=i[2],ge(()=>r=!1)),e.$set(a)},i(i){n||(b(e.$$.fragment,i),n=!0)},o(i){S(e.$$.fragment,i),n=!1},d(i){D(e,i)}}}function Je(t){let e,r;return e=new tr({props:{scheme:t[11]}}),{c(){L(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,s){const o={};s&2&&(o.scheme=n[11]),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}function Ge(t){let e=t[2].has(t[11].scheme_reference),r,n,s=e&&Je(t);return{c(){s&&s.c(),r=Mt()},m(o,i){s&&s.m(o,i),M(o,r,i),n=!0},p(o,i){i&6&&(e=o[2].has(o[11].scheme_reference)),e?s?(s.p(o,i),i&6&&b(s,1)):(s=Je(o),s.c(),b(s,1),s.m(r.parentNode,r)):s&&(ue(),S(s,1,1,()=>{s=null}),ce())},i(o){n||(b(s),n=!0)},o(o){S(s),n=!1},d(o){o&&E(r),s&&s.d(o)}}}function xr(t){let e,r,n,s,o,i,l,a,u,f,c,d,m,p;r=new pe({props:{$$slots:{default:[Rr]},$$scope:{ctx:t}}}),r.$on("click",t[7]),l=new zt({props:{boundaryGeojson:t[3]}});let _=t[0]&&xe(t);f=new St({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:t[5]}});let w=t[1].size>0&&qe(t),y=Ie(t[1].values()),$=[];for(let g=0;g<y.length;g+=1)$[g]=Ge(Re(t,y,g));const B=g=>S($[g],1,1,()=>{$[g]=null});return{c(){e=j("div"),L(r.$$.fragment),n=A(),s=j("div"),o=j("h1"),o.textContent="Browse schemes",i=A(),L(l.$$.fragment),a=A(),_&&_.c(),u=A(),L(f.$$.fragment),c=A(),w&&w.c(),d=A(),m=j("ul");for(let g=0;g<$.length;g+=1)$[g].c();je(s,"display","flex"),je(s,"justify-content","space-between"),x(e,"slot","sidebar"),x(e,"class","govuk-prose")},m(g,h){M(g,e,h),U(r,e,null),k(e,n),k(e,s),k(s,o),k(s,i),U(l,s,null),k(e,a),_&&_.m(e,null),k(e,u),U(f,e,null),k(e,c),w&&w.m(e,null),k(e,d),k(e,m);for(let v=0;v<$.length;v+=1)$[v]&&$[v].m(m,null);p=!0},p(g,h){const v={};h&16384&&(v.$$scope={dirty:h,ctx:g}),r.$set(v);const O={};if(h&8&&(O.boundaryGeojson=g[3]),l.$set(O),g[0]?_?(_.p(g,h),h&1&&b(_,1)):(_=xe(g),_.c(),b(_,1),_.m(e,u)):_&&(ue(),S(_,1,1,()=>{_=null}),ce()),g[1].size>0?w?(w.p(g,h),h&2&&b(w,1)):(w=qe(g),w.c(),b(w,1),w.m(e,d)):w&&(ue(),S(w,1,1,()=>{w=null}),ce()),h&6){y=Ie(g[1].values());let C;for(C=0;C<y.length;C+=1){const W=Re(g,y,C);$[C]?($[C].p(W,h),b($[C],1)):($[C]=Ge(W),$[C].c(),b($[C],1),$[C].m(m,null))}for(ue(),C=y.length;C<$.length;C+=1)B(C);ce()}},i(g){if(!p){b(r.$$.fragment,g),b(l.$$.fragment,g),b(_),b(f.$$.fragment,g),b(w);for(let h=0;h<y.length;h+=1)b($[h]);p=!0}},o(g){S(r.$$.fragment,g),S(l.$$.fragment,g),S(_),S(f.$$.fragment,g),S(w),$=$.filter(Boolean);for(let h=0;h<$.length;h+=1)S($[h]);p=!1},d(g){g&&E(e),D(r),D(l),_&&_.d(),D(f),w&&w.d(),Tt($,g)}}}function qr(t){let e,r,n,s;return e=new nr({}),n=new Gt({}),{c(){L(e.$$.fragment),r=A(),L(n.$$.fragment)},m(o,i){U(e,o,i),M(o,r,i),U(n,o,i),s=!0},i(o){s||(b(e.$$.fragment,o),b(n.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),S(n.$$.fragment,o),s=!1},d(o){o&&E(r),D(e,o),D(n,o)}}}function Jr(t){let e,r,n,s;return e=new Pt({props:{style:t[4]}}),n=new Nt({props:{small:!0,$$slots:{default:[qr]},$$scope:{ctx:t}}}),{c(){L(e.$$.fragment),r=A(),L(n.$$.fragment)},m(o,i){U(e,o,i),M(o,r,i),U(n,o,i),s=!0},p(o,i){const l={};i&16384&&(l.$$scope={dirty:i,ctx:o}),n.$set(l)},i(o){s||(b(e.$$.fragment,o),b(n.$$.fragment,o),s=!0)},o(o){S(e.$$.fragment,o),S(n.$$.fragment,o),s=!1},d(o){o&&E(r),D(e,o),D(n,o)}}}function Gr(t){let e,r,n,s,o,i,l;return e=new Ot({props:{schema:Xr}}),n=new Ye({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:t[6]}}),i=new De({props:{label:"Layers",open:!0,$$slots:{default:[Jr]},$$scope:{ctx:t}}}),{c(){L(e.$$.fragment),r=A(),L(n.$$.fragment),s=A(),o=j("div"),L(i.$$.fragment),x(o,"class","top-right svelte-nlvvhu")},m(a,u){U(e,a,u),M(a,r,u),U(n,a,u),M(a,s,u),M(a,o,u),U(i,o,null),l=!0},p(a,u){const f={};u&16384&&(f.$$scope={dirty:u,ctx:a}),i.$set(f)},i(a){l||(b(e.$$.fragment,a),b(n.$$.fragment,a),b(i.$$.fragment,a),l=!0)},o(a){S(e.$$.fragment,a),S(n.$$.fragment,a),S(i.$$.fragment,a),l=!1},d(a){a&&(E(r),E(s),E(o)),D(e,a),D(n,a),D(i)}}}function Wr(t){let e,r,n,s,o;return r=new Kr({}),s=new At({props:{style:t[4],$$slots:{default:[Gr]},$$scope:{ctx:t}}}),{c(){e=j("div"),L(r.$$.fragment),n=A(),L(s.$$.fragment),x(e,"slot","main")},m(i,l){M(i,e,l),U(r,e,null),k(e,n),U(s,e,null),o=!0},p(i,l){const a={};l&16384&&(a.$$scope={dirty:l,ctx:i}),s.$set(a)},i(i){o||(b(r.$$.fragment,i),b(s.$$.fragment,i),o=!0)},o(i){S(r.$$.fragment,i),S(s.$$.fragment,i),o=!1},d(i){i&&E(e),D(r),D(s)}}}function Qr(t){let e,r;return e=new Ct({props:{$$slots:{main:[Wr],sidebar:[xr]},$$scope:{ctx:t}}}),{c(){L(e.$$.fragment)},m(n,s){U(e,n,s),r=!0},p(n,[s]){const o={};s&16399&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){r||(b(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){D(e,n)}}}const Xr="v1";function Yr(t,e,r){let n,s;ne(t,Ue,p=>r(9,n=p)),ne(t,re,p=>r(3,s=p)),Le(()=>{Lt()});let i=new URLSearchParams(window.location.search).get("style")||"streets",l="",a=new Map,u=new Set;Xe(()=>{re.set(Ut())});function f(p){try{let _=JSON.parse(p);r(1,a=Vt(_)),re.set(_),r(0,l=""),n==null||n.fitBounds(Qe(_),{padding:20,animate:!1})}catch(_){r(0,l=`Couldn't load schemes from a file: ${_}`)}}function c(p){var _='<div class="govuk-prose" style="max-width: 30vw;">';return _+=`<h2>${p.name} (${p.intervention_type})</h2>`,_+=`<p>Scheme reference: ${p.scheme_reference}</p>`,p.length_meters&&(_+=`<p>Length: ${Dt(p.length_meters)}</p>`),p.description&&(_+=`<p>${p.description}</p>`),_}const d=()=>window.open("index.html");function m(p){u=p,r(2,u)}return[l,a,u,s,i,f,c,d,m]}class en extends q{constructor(e){super(),J(this,e,Yr,Qr,G,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new en({target:document.getElementById("app")});
