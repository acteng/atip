import{S as k,i as F,s as M,a1 as T,h as w,w as I,o as E,e as L,d as q,r as R,g,j as v,E as A,F as O,f as P,m as j,t as z,l as B,p as G,v as N,b as W,L as H,A as J,aR as K,D as Q,z as U,q as V,a4 as X}from"./layer_helper_utils-ac09d4f6.js";function D(a){let e,n,t,i;return{c(){e=L("div"),n=L("span"),n.textContent="Error:",t=q(),i=R(a[0]),g(n,"class","govuk-visually-hidden"),g(e,"class","govuk-error-message")},m(s,r){w(s,e,r),v(e,n),v(e,t),v(e,i)},p(s,r){r&1&&A(i,s[0])},d(s){s&&E(e)}}}function Y(a){let e,n=a[0]&&D(a);return{c(){n&&n.c(),e=T()},m(t,i){n&&n.m(t,i),w(t,e,i)},p(t,[i]){t[0]?n?n.p(t,i):(n=D(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:I,o:I,d(t){t&&E(e),n&&n.d(t)}}}function Z(a,e,n){let{errorMessage:t}=e;return a.$$set=i=>{"errorMessage"in i&&n(0,t=i.errorMessage)},[t]}class ie extends k{constructor(e){super(),F(this,e,Z,Y,M,{errorMessage:0})}}function x(a){let e,n,t;return{c(){e=L("input"),e.disabled=a[2],g(e,"class","govuk-file-upload"),g(e,"id",a[1]),g(e,"type","file")},m(i,s){w(i,e,s),a[6](e),n||(t=N(e,"change",a[4]),n=!0)},p(i,s){s&4&&(e.disabled=i[2]),s&2&&g(e,"id",i[1])},d(i){i&&E(e),a[6](null),n=!1,t()}}}function $(a){let e,n;return e=new O({props:{label:a[0],id:a[1],$$slots:{default:[x]},$$scope:{ctx:a}}}),{c(){P(e.$$.fragment)},m(t,i){j(e,t,i),n=!0},p(t,[i]){const s={};i&1&&(s.label=t[0]),i&2&&(s.id=t[1]),i&142&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){n||(z(e.$$.fragment,t),n=!0)},o(t){B(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function ee(a,e,n){let{label:t}=e,{id:i}=e,{loadFile:s}=e,{disabled:r=!1}=e,u;function d(o){let f=new FileReader;f.onload=b=>{s(b.target.result)};let m=u.files;f.readAsText(m[0])}function h(o){W[o?"unshift":"push"](()=>{u=o,n(3,u)})}return a.$$set=o=>{"label"in o&&n(0,t=o.label),"id"in o&&n(1,i=o.id),"loadFile"in o&&n(5,s=o.loadFile),"disabled"in o&&n(2,r=o.disabled)},[t,i,r,u,d,s,h]}class ae extends k{constructor(e){super(),F(this,e,ee,$,M,{label:0,id:1,loadFile:5,disabled:2})}}function te(a,e,n){let t,i;H(a,J,l=>n(6,t=l)),H(a,K,l=>n(7,i=l));const s=Q();let{layer:r}=e,{clickable:u}=e,{tooltip:d=null}=e,{show:h=!0}=e,{ignoreHigherLayers:o=[]}=e,{hoveredFeature:f=null}=e,m=new U.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});V(()=>{t.on("mousemove",r,b),t.on("mouseleave",r,y),u&&t.on("click",r,C)}),X(()=>{t.off("mousemove",r,b),t.off("mouseleave",r,y),u&&t.off("click",r,C),_(),m.remove()});function b(l){if(!i)return;let c=l.features??[];if(c.length!=0){if(c[0].id||console.log(`Features in the ${r} layer don't have IDs; InteractiveLayer won't work`),p(l)){y();return}if((f==null?void 0:f.id)!=c[0].id){if(_(),n(0,f=c[0]),t.setFeatureState(f,{hover:!0}),d){let S=`<div class="govuk-prose">${d(f)}</div>`;m.setLngLat(l.lngLat).setHTML(S).addTo(t)}u&&(t.getCanvas().style.cursor="pointer")}else d&&m.setLngLat(l.lngLat)}}function y(){i&&(_(),n(0,f=null),m.remove(),u&&(t.getCanvas().style.cursor="inherit"))}function _(){f&&t.setFeatureState(f,{hover:!1})}function C(l){if(!i)return;let c=l.features??[];if(c.length>0){if(p(l))return;s("click",c[0])}}function p(l){for(let c of t.queryRenderedFeatures(l.point)){if(c.layer.id==r)return!1;if(!o.includes(c.layer.id))return!0}return!1}return a.$$set=l=>{"layer"in l&&n(1,r=l.layer),"clickable"in l&&n(2,u=l.clickable),"tooltip"in l&&n(3,d=l.tooltip),"show"in l&&n(4,h=l.show),"ignoreHigherLayers"in l&&n(5,o=l.ignoreHigherLayers),"hoveredFeature"in l&&n(0,f=l.hoveredFeature)},a.$$.update=()=>{a.$$.dirty&82&&t.getLayer(r)&&t.setLayoutProperty(r,"visibility",h?"visible":"none")},[f,r,u,d,h,o,t]}class le extends k{constructor(e){super(),F(this,e,te,null,M,{layer:1,clickable:2,tooltip:3,show:4,ignoreHigherLayers:5,hoveredFeature:0})}}export{ie as E,ae as F,le as I};
