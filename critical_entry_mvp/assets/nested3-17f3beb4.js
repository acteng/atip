import{S as E,i as V,s as z,b as T,c as F,f as h,m as k,k as L,t as _,l as g,p as y,W as te,A as ne,F as q,d as D,h as $,o as b,e as B,g as I,u as R,v as W,r as re,au as oe,q as se,ac as ae,z as le,j as J,x as ue,n as fe,y as ce,w as G}from"./layer_helper_utils-3f0de19d.js";import{b as N,L as pe,M as me,S as de}from"./StreetViewController-15a6515c.js";import{D as _e}from"./DefaultButton-21ef27d8.js";import{T as ge}from"./TextArea-bdb3eb80.js";function $e(i){let e,s,r;function n(l){i[3](l)}let t={label:"Basemap",id:"basemap",choices:[["streets","Streets"],["hybrid","Satellite"],["dataviz","Dataviz"]],disabled:i[0]};return i[1]!==void 0&&(t.value=i[1]),e=new N({props:t}),T.push(()=>F(e,"value",n)),e.$on("change",i[2]),{c(){h(e.$$.fragment)},m(l,u){k(e,l,u),r=!0},p(l,[u]){const a={};u&1&&(a.disabled=l[0]),!s&&u&2&&(s=!0,a.value=l[1],L(()=>s=!1)),e.$set(a)},i(l){r||(_(e.$$.fragment,l),r=!0)},o(l){g(e.$$.fragment,l),r=!1},d(l){y(e,l)}}}function be(i,e,s){let r;te(i,ne,a=>s(4,r=a));let{disabled:n}=e,t="dataviz";function l(){r.setStyle(`https://api.maptiler.com/maps/${t}/style.json?key=MZEJTanw3WpxRvt7qDfo`)}function u(a){t=a,s(1,t)}return i.$$set=a=>{"disabled"in a&&s(0,n=a.disabled)},[n,t,l,u]}class ve extends E{constructor(e){super(),V(this,e,be,$e,z,{disabled:0})}}function we(i){let e,s,r;return{c(){e=B("input"),I(e,"type","text"),I(e,"class","govuk-input govuk-input--width-10"),I(e,"id","inspector")},m(n,t){$(n,e,t),R(e,i[0]),s||(r=W(e,"input",i[10]),s=!0)},p(n,t){t&1&&e.value!==n[0]&&R(e,n[0])},d(n){n&&b(e),s=!1,r()}}}function he(i){let e,s,r;return{c(){e=B("input"),I(e,"type","text"),I(e,"class","govuk-input govuk-input--width-10"),I(e,"id","scheme_reference")},m(n,t){$(n,e,t),R(e,i[1]),s||(r=W(e,"input",i[11]),s=!0)},p(n,t){t&2&&e.value!==n[1]&&R(e,n[1])},d(n){n&&b(e),s=!1,r()}}}function ke(i){let e,s,r;return{c(){e=B("input"),I(e,"type","text"),I(e,"class","govuk-input govuk-input--width-10"),I(e,"id","location_description")},m(n,t){$(n,e,t),R(e,i[4]),s||(r=W(e,"input",i[14]),s=!0)},p(n,t){t&16&&e.value!==n[4]&&R(e,n[4])},d(n){n&&b(e),s=!1,r()}}}function ye(i){let e;return{c(){e=re("Export")},m(s,r){$(s,e,r)},d(s){s&&b(e)}}}function Ce(i){let e,s,r,n,t,l,u,a,m,f,d,P,C,c,v,w,A;e=new q({props:{label:"Inspector name",id:"inspector",$$slots:{default:[we]},$$scope:{ctx:i}}}),r=new q({props:{label:"Scheme reference",id:"scheme_reference",$$slots:{default:[he]},$$scope:{ctx:i}}});function M(o){i[12](o)}let S={label:"Current design stage",id:"current_design_stage",choices:i[6],emptyOption:!0};i[2]!==void 0&&(S.value=i[2]),t=new N({props:S}),T.push(()=>F(t,"value",M));function O(o){i[13](o)}let j={label:"Critical issue type",id:"critical_issue_type",choices:i[7],emptyOption:!0};i[3]!==void 0&&(j.value=i[3]),a=new N({props:j}),T.push(()=>F(a,"value",O)),d=new q({props:{label:"Describe this location",id:"location_description",$$slots:{default:[ke]},$$scope:{ctx:i}}});function ie(o){i[15](o)}let H={label:"Comments or notes"};return i[5]!==void 0&&(H.value=i[5]),C=new ge({props:H}),T.push(()=>F(C,"value",ie)),w=new _e({props:{$$slots:{default:[ye]},$$scope:{ctx:i}}}),w.$on("click",i[8]),{c(){h(e.$$.fragment),s=D(),h(r.$$.fragment),n=D(),h(t.$$.fragment),u=D(),h(a.$$.fragment),f=D(),h(d.$$.fragment),P=D(),h(C.$$.fragment),v=D(),h(w.$$.fragment)},m(o,p){k(e,o,p),$(o,s,p),k(r,o,p),$(o,n,p),k(t,o,p),$(o,u,p),k(a,o,p),$(o,f,p),k(d,o,p),$(o,P,p),k(C,o,p),$(o,v,p),k(w,o,p),A=!0},p(o,[p]){const K={};p&65537&&(K.$$scope={dirty:p,ctx:o}),e.$set(K);const U={};p&65538&&(U.$$scope={dirty:p,ctx:o}),r.$set(U);const Q={};!l&&p&4&&(l=!0,Q.value=o[2],L(()=>l=!1)),t.$set(Q);const Z={};!m&&p&8&&(m=!0,Z.value=o[3],L(()=>m=!1)),a.$set(Z);const X={};p&65552&&(X.$$scope={dirty:p,ctx:o}),d.$set(X);const Y={};!c&&p&32&&(c=!0,Y.value=o[5],L(()=>c=!1)),C.$set(Y);const x={};p&65536&&(x.$$scope={dirty:p,ctx:o}),w.$set(x)},i(o){A||(_(e.$$.fragment,o),_(r.$$.fragment,o),_(t.$$.fragment,o),_(a.$$.fragment,o),_(d.$$.fragment,o),_(C.$$.fragment,o),_(w.$$.fragment,o),A=!0)},o(o){g(e.$$.fragment,o),g(r.$$.fragment,o),g(t.$$.fragment,o),g(a.$$.fragment,o),g(d.$$.fragment,o),g(C.$$.fragment,o),g(w.$$.fragment,o),A=!1},d(o){o&&(b(s),b(n),b(u),b(f),b(P),b(v)),y(e,o),y(r,o),y(t,o),y(a,o),y(d,o),y(C,o),y(w,o)}}}function ee(i){return i.map(e=>[e,e])}function Se(i){let e=25569,r=24*(60*60*1e3);return i.getTime()/r+e}function Ie(i,e,s){let{pt:r}=e,n=window.localStorage.getItem("inspector")??"",t=window.localStorage.getItem("scheme_reference")??"",l="",u="",a="",m="",f=ee(["Baseline","Feasibility Design","Preliminary Design","Outline Design","Detailed Design","Inspection"]),d=ee(["1 - Conflict at Side Roads","2 - Conflict at Major Junctions / Roundabouts","3 - Collision Alongside or from Behind","4 - Trip Hazard","5 - Kerbside Activity","6A - Risk of Crossing Conflict (Busy Roads)","6B - Risk of Crossing Conflict (Quieter Roads)","7A - Standard of Crossing Facility (Busy Roads)","7B - Standard of Crossing Facility (Junction)","8 - Traffic Speed (>37mph)","9A - Traffic Volume (>10,000vpd)","9B - Traffic Volume (>5% HGVs)","10 - Crossing Speed","11A - Footway Width (Absolute Minimum <1m)","11B - Footway Width (at Pinchpoints)","11C - Footway Width - Poor Pedestrian Comfort","12 - Tram - Insufficient width next to Tram Track","13 - Tram/Rail - Poor Crossing Angle","14 - Major Cycle Surface Defect","15 - Major Pedestrian Surface Defect","16 - Inappropriate Shared Use","17 - Barriers, Steps and/or Dismount signs","18 - Route isn't direct, logical or intuitive to all users","19 - Inappropriate Surface Materials","20 - Inappropriate Lighting","21 - Routes must join other facilities as a network"]);function P(){let S=0,O=Se(new Date),j=[S,n,O,t,l,u,oe(r.toArray().reverse()).join(","),a,m];navigator.clipboard.writeText(j.join("	")),window.alert("Go to a new row at the bottom of Form Input, and press Control+V to paste")}function C(){n=this.value,s(0,n)}function c(){t=this.value,s(1,t)}function v(S){l=S,s(2,l)}function w(S){u=S,s(3,u)}function A(){a=this.value,s(4,a)}function M(S){m=S,s(5,m)}return i.$$set=S=>{"pt"in S&&s(9,r=S.pt)},i.$$.update=()=>{i.$$.dirty&1&&window.localStorage.setItem("inspector",n),i.$$.dirty&2&&window.localStorage.setItem("scheme_reference",t)},[n,t,l,u,a,m,f,d,P,r,C,c,v,w,A,M]}class Pe extends E{constructor(e){super(),V(this,e,Ie,Ce,z,{pt:9})}}function Ae(i,e,s){let r;te(i,ne,a=>s(3,r=a));let{enableAdding:n}=e,t=null,{markerPosition:l=null}=e;se(()=>{r.on("click",u),r.getCanvas().style.cursor="crosshair"}),ae(()=>{t&&t.remove(),r.off("click",u)});function u(a){t||!n||(r.getCanvas().style.cursor="inherit",t=new le.Marker({draggable:!0}).setLngLat(a.lngLat).addTo(r),s(0,l=t.getLngLat()),t.on("dragstart",()=>{r.getCanvas().style.cursor="grabbing"}),t.on("dragend",()=>{r.getCanvas().style.cursor="inherit",s(0,l=t.getLngLat())}))}return i.$$set=a=>{"enableAdding"in a&&s(1,n=a.enableAdding),"markerPosition"in a&&s(0,l=a.markerPosition)},[l,n]}class De extends E{constructor(e){super(),V(this,e,Ae,null,z,{enableAdding:1,markerPosition:0})}}function Be(i){let e;return{c(){e=B("p"),e.textContent="Click the map to add a critical"},m(s,r){$(s,e,r)},p:G,i:G,o:G,d(s){s&&b(e)}}}function Te(i){let e,s;return e=new Pe({props:{pt:i[0]}}),{c(){h(e.$$.fragment)},m(r,n){k(e,r,n),s=!0},p(r,n){const t={};n&1&&(t.pt=r[0]),e.$set(t)},i(r){s||(_(e.$$.fragment,r),s=!0)},o(r){g(e.$$.fragment,r),s=!1},d(r){y(e,r)}}}function Me(i){let e,s,r,n,t,l;const u=[Te,Be],a=[];function m(f,d){return f[0]?0:1}return n=m(i),t=a[n]=u[n](i),{c(){e=B("div"),s=B("h1"),s.textContent="Critical issue entry",r=D(),t.c(),I(e,"slot","sidebar"),I(e,"class","govuk-prose")},m(f,d){$(f,e,d),J(e,s),J(e,r),a[n].m(e,null),l=!0},p(f,d){let P=n;n=m(f),n===P?a[n].p(f,d):(ue(),g(a[P],1,1,()=>{a[P]=null}),fe(),t=a[n],t?t.p(f,d):(t=a[n]=u[n](f),t.c()),_(t,1),t.m(e,null))},i(f){l||(_(t),l=!0)},o(f){g(t),l=!1},d(f){f&&b(e),a[n].d()}}}function Fe(i){let e,s,r,n,t,l,u,a,m;function f(c){i[4](c)}let d={enableAdding:i[1]};i[0]!==void 0&&(d.markerPosition=i[0]),e=new De({props:d}),T.push(()=>F(e,"markerPosition",f)),t=new ve({props:{disabled:!i[1]}});function P(c){i[6](c)}let C={displayEnableButton:!0};return i[1]!==void 0&&(C.isInactive=i[1]),u=new de({props:C}),i[5](u),T.push(()=>F(u,"isInactive",P)),{c(){h(e.$$.fragment),r=D(),n=B("div"),h(t.$$.fragment),l=D(),h(u.$$.fragment),I(n,"class","top-right svelte-nlvvhu")},m(c,v){k(e,c,v),$(c,r,v),$(c,n,v),k(t,n,null),J(n,l),k(u,n,null),m=!0},p(c,v){const w={};v&2&&(w.enableAdding=c[1]),!s&&v&1&&(s=!0,w.markerPosition=c[0],L(()=>s=!1)),e.$set(w);const A={};v&2&&(A.disabled=!c[1]),t.$set(A);const M={};!a&&v&2&&(a=!0,M.isInactive=c[1],L(()=>a=!1)),u.$set(M)},i(c){m||(_(e.$$.fragment,c),_(t.$$.fragment,c),_(u.$$.fragment,c),m=!0)},o(c){g(e.$$.fragment,c),g(t.$$.fragment,c),g(u.$$.fragment,c),m=!1},d(c){c&&(b(r),b(n)),y(e,c),y(t),i[5](null),y(u)}}}function Le(i){let e,s,r;return s=new me({props:{style:"dataviz",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Fe]},$$scope:{ctx:i}}}),{c(){e=B("div"),h(s.$$.fragment),I(e,"slot","main")},m(n,t){$(n,e,t),k(s,e,null),r=!0},p(n,t){const l={};t&135&&(l.$$scope={dirty:t,ctx:n}),s.$set(l)},i(n){r||(_(s.$$.fragment,n),r=!0)},o(n){g(s.$$.fragment,n),r=!1},d(n){n&&b(e),y(s)}}}function Re(i){let e,s,r,n;return e=new pe({props:{$$slots:{main:[Le],sidebar:[Me]},$$scope:{ctx:i}}}),{c(){h(e.$$.fragment)},m(t,l){k(e,t,l),s=!0,r||(n=W(window,"keydown",i[3]),r=!0)},p(t,[l]){const u={};l&135&&(u.$$scope={dirty:l,ctx:t}),e.$set(u)},i(t){s||(_(e.$$.fragment,t),s=!0)},o(t){g(e.$$.fragment,t),s=!1},d(t){y(e,t),r=!1,n()}}}function je(i,e,s){se(()=>{ce()});let r=null,n=!0,t;function l(f){!n&&f.key=="Escape"&&(t.disableStreetView(),f.preventDefault())}function u(f){r=f,s(0,r)}function a(f){T[f?"unshift":"push"](()=>{t=f,s(2,t)})}function m(f){n=f,s(1,n)}return[r,n,t,l,u,a,m]}class Ee extends E{constructor(e){super(),V(this,e,je,Re,z,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Ee({target:document.getElementById("app")});
