import{an as Pn,S as z,i as V,s as G,b as W,c as Z,f as _,d as E,m as w,h as m,k as q,t as g,l as d,o as h,p as v,N as X,A as te,ao as Zr,T as ut,q as Yt,F as qr,a as jt,e as P,g as H,u as lr,v as Jt,r as b,G as be,aP as he,Y as xe,C as Se,w as Q,aO as B,j as D,H as We,J as Fe,I as Lt,x as ye,n as ke,Q as ze,aQ as Qt,P as er,aR as xn,_ as Xr,Z as ft,E as Yr,a2 as tr,aH as In,aI as Nn,aJ as Mn,aK as Fn,aS as ur,B as Bn,aT as fr,a5 as Jr,y as jn,aE as Un}from"./MapLibreMap.svelte_svelte_type_style_lang-55473420.js";import{e as Ut,C as Me,b as wt,d as ee,a as Rn,S as Hn,L as Wn,M as zn}from"./StreetViewController-a36cc5b7.js";import{L as Vn,d as cr,c as Qr,C as pe,H as ne,B as Gn,Z as Kn,I as Zn}from"./schemas-9b25b4c2.js";import{I as J,F as qn}from"./InteractiveLayer-0b2b204d.js";const Xn={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var ue=Uint8Array,Je=Uint16Array,en=Uint32Array,tn=new ue([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rn=new ue([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Yn=new ue([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nn=function(t,e){for(var r=new Je(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new en(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},on=nn(tn,2),sn=on[0],Jn=on[1];sn[28]=258,Jn[258]=28;var Qn=nn(rn,0),eo=Qn[0],Rt=new Je(32768);for(var K=0;K<32768;++K){var je=(K&43690)>>>1|(K&21845)<<1;je=(je&52428)>>>2|(je&13107)<<2,je=(je&61680)>>>4|(je&3855)<<4,Rt[K]=((je&65280)>>>8|(je&255)<<8)>>>1}var ht=function(t,e,r){for(var n=t.length,o=0,s=new Je(e);o<n;++o)t[o]&&++s[t[o]-1];var a=new Je(e);for(o=0;o<e;++o)a[o]=a[o-1]+s[o-1]<<1;var u;if(r){u=new Je(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],l=e-t[o],c=a[t[o]-1]++<<l,p=c|(1<<l)-1;c<=p;++c)u[Rt[c]>>>i]=f}else for(u=new Je(n),o=0;o<n;++o)t[o]&&(u[o]=Rt[a[t[o]-1]++]>>>15-t[o]);return u},vt=new ue(288);for(var K=0;K<144;++K)vt[K]=8;for(var K=144;K<256;++K)vt[K]=9;for(var K=256;K<280;++K)vt[K]=7;for(var K=280;K<288;++K)vt[K]=8;var an=new ue(32);for(var K=0;K<32;++K)an[K]=5;var to=ht(vt,9,1),ro=ht(an,5,1),Dt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ge=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Et=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},no=function(t){return(t+7)/8|0},rr=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?Je:t.BYTES_PER_ELEMENT==4?en:ue)(r-e);return n.set(t.subarray(e,r)),n},oo=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],we=function(t,e,r){var n=new Error(e||oo[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,we),!r)throw n;return n},so=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new ue(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new ue(n*3));var a=function(nt){var ot=e.length;if(nt>ot){var pt=new ue(Math.max(ot*2,nt));pt.set(e),e=pt}},u=r.f||0,i=r.p||0,f=r.b||0,l=r.l,c=r.d,p=r.m,$=r.n,S=n*8;do{if(!l){u=ge(t,i,1);var C=ge(t,i+1,3);if(i+=3,C)if(C==1)l=to,c=ro,p=9,$=5;else if(C==2){var M=ge(t,i,31)+257,y=ge(t,i+10,15)+4,A=M+ge(t,i+5,31)+1;i+=14;for(var N=new ue(A),I=new ue(19),T=0;T<y;++T)I[Yn[T]]=ge(t,i+T*3,7);i+=y*3;for(var F=Dt(I),x=(1<<F)-1,j=ht(I,F,1),T=0;T<A;){var Y=j[ge(t,i,x)];i+=Y&15;var k=Y>>>4;if(k<16)N[T++]=k;else{var re=0,Ce=0;for(k==16?(Ce=3+ge(t,i,3),i+=2,re=N[T-1]):k==17?(Ce=3+ge(t,i,7),i+=3):k==18&&(Ce=11+ge(t,i,127),i+=7);Ce--;)N[T++]=re}}var $e=N.subarray(0,M),oe=N.subarray(M);p=Dt($e),$=Dt(oe),l=ht($e,p,1),c=ht(oe,$,1)}else we(1);else{var k=no(i)+4,O=t[k-4]|t[k-3]<<8,L=k+O;if(L>n){s&&we(0);break}o&&a(f+O),e.set(t.subarray(k,L),f),r.b=f+=O,r.p=i=L*8,r.f=u;continue}if(i>S){s&&we(0);break}}o&&a(f+131072);for(var Ve=(1<<p)-1,ae=(1<<$)-1,ct=i;;ct=i){var re=l[Et(t,i)&Ve],Be=re>>>4;if(i+=re&15,i>S){s&&we(0);break}if(re||we(2),Be<256)e[f++]=Be;else if(Be==256){ct=i,l=null;break}else{var et=Be-254;if(Be>264){var T=Be-257,me=tn[T];et=ge(t,i,(1<<me)-1)+sn[T],i+=me}var tt=c[Et(t,i)&ae],Ie=tt>>>4;tt||we(3),i+=tt&15;var oe=eo[Ie];if(Ie>3){var me=rn[Ie];oe+=Et(t,i)&(1<<me)-1,i+=me}if(i>S){s&&we(0);break}o&&a(f+131072);for(var rt=f+et;f<rt;f+=4)e[f]=e[f-oe],e[f+1]=e[f+1-oe],e[f+2]=e[f+2-oe],e[f+3]=e[f+3-oe];f=rt}}r.l=l,r.p=ct,r.b=f,r.f=u,l&&(u=1,r.m=p,r.d=c,r.n=$)}while(!u);return f==e.length?e:rr(e,0,f)},io=new ue(0),Ee=function(t,e){return t[e]|t[e+1]<<8},ve=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Pt=function(t,e){return ve(t,e)+ve(t,e+4)*4294967296};function ao(t,e){return so(t,e)}var Ht=typeof TextDecoder<"u"&&new TextDecoder,lo=0;try{Ht.decode(io,{stream:!0}),lo=1}catch{}var uo=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,rr(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function ln(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Ht)return Ht.decode(t);var o=uo(t),s=o[0],a=o[1];return a.length&&we(8),s}}var fo=function(t,e){return e+30+Ee(t,e+26)+Ee(t,e+28)},co=function(t,e,r){var n=Ee(t,e+28),o=ln(t.subarray(e+46,e+46+n),!(Ee(t,e+8)&2048)),s=e+46+n,a=ve(t,e+20),u=r&&a==4294967295?po(t,s):[a,ve(t,e+24),ve(t,e+42)],i=u[0],f=u[1],l=u[2];return[Ee(t,e+10),i,f,o,s+Ee(t,e+30)+Ee(t,e+32),l]},po=function(t,e){for(;Ee(t,e)!=1;e+=4+Ee(t,e+2));return[Pt(t,e+12),Pt(t,e+4),Pt(t,e+20)]};function $o(t,e){for(var r={},n=t.length-22;ve(t,n)!=101010256;--n)(!n||t.length-n>65558)&&we(13);var o=Ee(t,n+8);if(!o)return{};var s=ve(t,n+16),a=s==4294967295||o==65535;if(a){var u=ve(t,n-12);a=ve(t,u)==101075792,a&&(o=ve(t,u+32),s=ve(t,u+48))}for(var i=e&&e.filter,f=0;f<o;++f){var l=co(t,s,a),c=l[0],p=l[1],$=l[2],S=l[3],C=l[4],k=l[5],O=fo(t,k);s=C,(!i||i({name:S,size:p,originalSize:$,compression:c}))&&(c?c==8?r[S]=ao(t.subarray(O,O+p),new ue($)):we(14,"unknown compression type "+c):r[S]=rr(t,O,O+p))}return r}function mo(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(xt):xt(t)}function xt(t){var e=new Uint8Array(t),r=$o(e);return Promise.resolve(ho(r))}function ho(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=ln(t[o])}return e}function Pe(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&Qe(n)===e)return n;r++}}function bt(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&Qe(o)===e&&r.push(o),n++}return r}function Tt(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&Qe(o)===e&&r(o,n):r(o,n),n++}}function go(t,e,r){var n=[];return Tt(t,e,function(o,s){n.push(r(o,s))}),n}var _o=/.+\:/;function Qe(t){return t.tagName.replace(_o,"")}function un(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+Qe(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=un(t.childNodes[n]),n++;return e+="</"+Qe(t)+">",e}function wo(t){var e=t.documentElement,r=Pe(e,"sheetData"),n=[];return Tt(r,"row",function(o){Tt(o,"c",function(s){n.push(s)})}),n}function vo(t,e){return Pe(e,"v")}function bo(t,e){if(e.firstChild&&Qe(e.firstChild)==="is"&&e.firstChild.firstChild&&Qe(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function yo(t){var e=t.documentElement,r=Pe(e,"dimension");if(r)return r.getAttribute("ref")}function ko(t){var e=t.documentElement,r=Pe(e,"cellStyleXfs");return r?bt(r,"xf"):[]}function So(t){var e=t.documentElement,r=Pe(e,"cellXfs");return r?bt(r,"xf"):[]}function Co(t){var e=t.documentElement,r=Pe(e,"numFmts");return r?bt(r,"numFmt"):[]}function Oo(t){var e=t.documentElement;return go(e,"si",function(r){var n=Pe(r,"t");if(n)return n.textContent;var o="";return Tt(r,"r",function(s){o+=Pe(s,"t").textContent}),o})}function Lo(t){var e=t.documentElement;return Pe(e,"workbookPr")}function To(t){var e=t.documentElement;return bt(e,"Relationship")}function Ao(t){var e=t.documentElement,r=Pe(e,"sheets");return bt(r,"sheet")}function Do(t,e){var r=e.createDocument(t),n={},o=Lo(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(u){u.getAttribute("name")&&n.sheets.push({id:u.getAttribute("sheetId"),name:u.getAttribute("name"),relationId:u.getAttribute("r:id")})};return Ao(r).forEach(s),n}function Eo(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(a){var u=a.getAttribute("Target"),i=a.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=It(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=It(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[a.getAttribute("Id")]=It(u);break}};return To(r).forEach(o),n}function It(t){return t[0]==="/"?t.slice(1):"xl/"+t}function pr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function $r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pr(Object(r),!0).forEach(function(n){Po(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Po(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xo(t,e){if(!t)return{};var r=e.createDocument(t),n=ko(r).map(Nt),o=Co(r).map(Io).reduce(function(a,u){return a[u.id]=u,a},[]),s=function(u){return u.hasAttribute("xfId")?$r($r({},n[u.xfId]),Nt(u,o)):Nt(u,o)};return So(r).map(s)}function Io(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function Nt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function No(t,e){return t?Oo(e.createDocument(t)):[]}function fn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function Mo(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Fo(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fo(t,e){if(t){if(typeof t=="string")return mr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mr(t,e)}}function mr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bo(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(jo.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&Ho(o.numberFormat.template))return!0}}var jo=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],Uo=/^\[\$-414\]/,Ro=/;@$/;function Ho(t){t=t.toLowerCase(),t=t.replace(Uo,""),t=t.replace(Ro,"");for(var e=t.split(/\W+/),r=Mo(e),n;!(n=r()).done;){var o=n.value;if(Wo.indexOf(o)<0)return!1}return!0}var Wo=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function zo(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,a=r.styles,u=r.values,i=r.properties,f=r.options;switch(e||(e="n"),e){case"str":t=Mt(t,f);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Mt(t,f);break;case"s":var l=Number(t);if(isNaN(l))throw new Error('Invalid "shared" string index: '.concat(t));if(l>=u.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=u[l],t=Mt(t,f);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=Vo(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,Bo(t,s(),a,f)&&(t=fn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function Vo(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Mt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var Go=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Ko(t){var e=function(f,l){return f-l},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],a=n[0],u=n[n.length-1];return[{row:o,column:a},{row:s,column:u}]}function Zo(t){for(var e=0,r=0;r<t.length;)e*=26,e+=Go.indexOf(t[r]),r++;return e}function cn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),Zo(t[0].trim())]}function qo(t,e,r,n,o,s,a){var u=cn(t.getAttribute("r")),i=vo(e,t),f=i&&i.textContent,l;return t.hasAttribute("t")&&(l=t.getAttribute("t")),{row:u[0],column:u[1],value:zo(f,l,{getInlineStringValue:function(){return bo(e,t)},getInlineStringXml:function(){return un(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:a})}}function Xo(t,e,r,n,o,s){var a=wo(t);return a.length===0?[]:a.map(function(u){return qo(u,t,e,r,n,o,s)})}function Yo(t,e){return ts(t)||es(t,e)||Qo(t,e)||Jo()}function Jo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qo(t,e){if(t){if(typeof t=="string")return hr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hr(t,e)}}function hr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function es(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,u;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function ts(t){if(Array.isArray(t))return t}function rs(t){var e=yo(t);if(e)return e=e.split(":").map(cn).map(function(r){var n=Yo(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function ns(t,e,r,n,o,s){var a=e.createDocument(t),u=Xo(a,e,r,n,o,s),i=rs(a)||Ko(u);return{cells:u,dimensions:i}}function os(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ss(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ss(t,e){if(t){if(typeof t=="string")return gr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gr(t,e)}}function gr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function is(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,a=t.length-1;a>=0;){for(var u=!0,i=os(t[a]),f;!(f=i()).done;){var l=f.value;if(o(l)!==null){u=!1;break}}if(u)t.splice(a,1),r&&r.splice(a,1);else if(s)break;a--}return t}function as(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ls(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ls(t,e){if(t){if(typeof t=="string")return dr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dr(t,e)}}function dr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function us(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var a=!0,u=as(t),i;!(i=u()).done;){var f=i.value;if(n(f[s])!==null){a=!1;break}}if(a)for(var l=0;l<t.length;)t[l].splice(s,1),l++;else if(o)break;s--}return t}function fs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=pn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cs(t,e){return ms(t)||$s(t,e)||pn(t,e)||ps()}function ps(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pn(t,e){if(t){if(typeof t=="string")return _r(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _r(t,e)}}function _r(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $s(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,u;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function ms(t){if(Array.isArray(t))return t}function hs(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=cs(r,2);o[0];for(var s=o[1],a=s.column,u=s.row,i=new Array(u),f=0;f<u;){i[f]=new Array(a);for(var l=0;l<a;)i[f][l]=null,l++;f++}for(var c=fs(n),p;!(p=c()).done;){var $=p.value,S=$.row-1,C=$.column-1;C<a&&S<u&&(i[S][C]=$.value)}var k=e.rowMap;if(k)for(var O=0;O<i.length;)k[O]=O,O++;return i=is(us(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:k}),e.transformData&&(i=e.transformData(i)),i}function gs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ds(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ds(t,e){if(t){if(typeof t=="string")return wr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(t,e)}}function wr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function _s(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vr(Object(r),!0).forEach(function(n){ws(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ws(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=_s({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=Eo(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?No(n(o.sharedStrings),e):[],a=o.styles?xo(n(o.styles),e):{},u=Do(n("xl/workbook.xml"),e);if(r.getSheets)return u.sheets.map(function(c){var p=c.name;return{name:p}});var i=bs(r.sheet,u.sheets);if(!i||!o.sheets[i])throw ys(r.sheet,u.sheets);var f=ns(n(o.sheets[i]),e,s,a,u,r),l=hs(f,r);return r.properties?{data:l,properties:u}:l}function bs(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=gs(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function ys(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function Wt(t){"@babel/helpers - typeof";return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(t)}function br(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ks(t,e,r){return e&&br(t.prototype,e),r&&br(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ss(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dt(t,e)}function Os(t){var e=$n();return function(){var n=_t(t),o;if(e){var s=_t(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Ls(this,o)}}function Ls(t,e){if(e&&(Wt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ts(t)}function Ts(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zt(t){var e=typeof Map=="function"?new Map:void 0;return zt=function(n){if(n===null||!As(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Ot(n,arguments,_t(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),dt(o,n)},zt(t)}function Ot(t,e,r){return $n()?Ot=Reflect.construct:Ot=function(o,s,a){var u=[null];u.push.apply(u,s);var i=Function.bind.apply(o,u),f=new i;return a&&dt(f,a.prototype),f},Ot.apply(null,arguments)}function $n(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function As(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function dt(t,e){return dt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},dt(t,e)}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},_t(t)}var fe=function(t){Cs(r,t);var e=Os(r);function r(n){var o;return Ss(this,r),o=e.call(this,"invalid"),o.reason=n,o}return ks(r)}(zt(Error));function Ds(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new fe("not_a_number")}if(typeof t!="number")throw new fe("not_a_number");if(isNaN(t))throw new fe("invalid_number");if(!isFinite(t))throw new fe("out_of_bounds");return t}function Es(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new fe("invalid_number");if(!isFinite(t))throw new fe("out_of_bounds");return String(t)}throw new fe("not_a_string")}function Ps(t){if(typeof t=="boolean")return t;throw new fe("not_a_boolean")}function xs(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new fe("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new fe("invalid_number");if(!isFinite(t))throw new fe("out_of_bounds");var n=fn(t,r);if(isNaN(n.valueOf()))throw new fe("out_of_bounds");return n}throw new fe("not_a_date")}function Is(t,e){return Fs(t)||Ms(t,e)||mn(t,e)||Ns()}function Ns(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ms(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,u;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function Fs(t){if(Array.isArray(t))return t}function Vt(t){"@babel/helpers - typeof";return Vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vt(t)}function Bs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=mn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mn(t,e){if(t){if(typeof t=="string")return yr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(t,e)}}function yr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kr(Object(r),!0).forEach(function(n){js(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function js(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Cr={isColumnOriented:!1};function Us(t,e,r){r?r=Sr(Sr({},Cr),r):r=Cr;var n=r,o=n.isColumnOriented,s=n.rowMap,a=n.ignoreEmptyRows;zs(e),o&&(t=Ws(t));for(var u=t[0],i=[],f=[],l=1;l<t.length;l++){var c=hn(e,t[l],l,u,f,r);(c!==null||a===!1)&&i.push(c)}if(s)for(var p=Bs(f),$;!($=p()).done;){var S=$.value;S.row=s[S.row-1]+1}return{rows:i,errors:f}}function hn(t,e,r,n,o,s){for(var a={},u=!0,i=function(){var p=l[f],$=t[p],S=Vt($.type)==="object"&&!Array.isArray($.type),C=e[n.indexOf(p)];C===void 0&&(C=null);var k=void 0,O=void 0,L=void 0;if(S)k=hn($.type,e,r,n,o,s);else if(C===null)k=null;else if(Array.isArray($.type)){var M=!1,y=Hs(C).map(function(N){var I=Or(N,$,s);return I.error&&(k=N,O=I.error,L=I.reason),I.value!==null&&(M=!0),I.value});O||(k=M?y:null)}else{var A=Or(C,$,s);O=A.error,L=A.reason,k=O?C:A.value}!O&&k===null&&$.required&&(O="required"),O?(O={error:O,row:r+1,column:p,value:k},L&&(O.reason=L),$.type&&(O.type=$.type),o.push(O)):(u&&k!==null&&(u=!1),(k!==null||s.includeNullValues)&&(a[$.prop]=k))},f=0,l=Object.keys(t);f<l.length;f++)i();return u?null:a}function Or(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=it(t,e.parse):e.type?n=Rs(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function it(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function Rs(t,e,r){switch(e){case String:return it(t,Es);case Number:return it(t,Ds);case Date:return it(t,function(n){return xs(n,{properties:r.properties})});case Boolean:return it(t,Ps);default:if(typeof e=="function")return it(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function gn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var a=gn(t,'"',r+n+1);o+=a[0],n+=1+a[1]+1}else o+=s,n++}return[o,n]}function Hs(t){for(var e=[],r=0;r<t.length;){var n=gn(t,",",r),o=Is(n,2),s=o[0],a=o[1];r+=a+1,e.push(s.trim())}return e}var Ws=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function zs(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function Gt(t){"@babel/helpers - typeof";return Gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(t)}function dn(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],a=void 0;Gt(s)==="object"&&(s=Object.keys(t[o])[0],a=dn(t[o][s])),e[o]={prop:s},a&&(e[o].type=a)}return e}var Vs=["schema","map"];function Lr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function St(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lr(Object(r),!0).forEach(function(n){Gs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Gs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ks(t,e){if(t==null)return{};var r=Zs(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Zs(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function qs(t,e,r){var n=r.schema,o=r.map,s=Ks(r,Vs);!n&&o&&(n=dn(o));var a=vs(t,e,St(St({},s),{},{properties:n||s.properties}));return n?Us(a.data,n,St(St({},s),{},{properties:a.properties})):a}function Xs(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return mo(t).then(function(r){return qs(r,Xn,e)})}function Ys(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function Js(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await Xs(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=Pn(o.lat_lon.split(",").map(parseFloat).reverse()),a=o;a.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:a,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const R={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function Qs(t){let e,r,n,o,s;function a(i){t[3](i)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(u.value=t[0]),e=new Ut({props:u}),W.push(()=>Z(e,"value",a)),e.$on("change",t[2]),o=new Vn({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};!r&&f&1&&(r=!0,l.value=i[0],q(()=>r=!1)),e.$set(l);const c={};f&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}function ei(t,e,r){let n;X(t,te,i=>r(4,n=i));let o="interventionType",s=cr("v1");function a(){let i;o=="interventionType"?(i=Qr("v1"),r(1,s=cr("v1"))):(i=Zr(["get","funding_programme"],{ATF2:R.atf2,ATF3:R.atf3,ATF4:R.atf4},"grey"),r(1,s=[["ATF2",R.atf2],["ATF3",R.atf3],["ATF4",R.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function u(i){o=i,r(0,o)}return[o,s,a,u]}class ti extends z{constructor(e){super(),V(this,e,ei,Qs,G,{})}}function ri(t){let e;return{c(){e=b("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ni(t){let e,r,n,o,s,a;return n=new jt({props:{$$slots:{default:[ri]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=P("input"),r=E(),_(n.$$.fragment),H(e,"type","text"),H(e,"class","govuk-input govuk-input--width-10"),H(e,"id","filterText")},m(u,i){m(u,e,i),lr(e,t[0]),m(u,r,i),w(n,u,i),o=!0,s||(a=Jt(e,"input",t[12]),s=!0)},p(u,i){i&1&&e.value!==u[0]&&lr(e,u[0]);const f={};i&131072&&(f.$$scope={dirty:i,ctx:u}),n.$set(f)},i(u){o||(g(n.$$.fragment,u),o=!0)},o(u){d(n.$$.fragment,u),o=!1},d(u){u&&(h(e),h(r)),v(n,u),s=!1,a()}}}function oi(t){let e,r,n,o,s,a,u,i,f,l;function c(C){t[10](C)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Ut({props:p}),W.push(()=>Z(e,"value",c));function $(C){t[11](C)}let S={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(S.value=t[3]),o=new Ut({props:S}),W.push(()=>Z(o,"value",$)),u=new qr({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[ni]},$$scope:{ctx:t}}}),f=new ti({}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment),a=E(),_(u.$$.fragment),i=E(),_(f.$$.fragment)},m(C,k){w(e,C,k),m(C,n,k),w(o,C,k),m(C,a,k),w(u,C,k),m(C,i,k),w(f,C,k),l=!0},p(C,k){const O={};k&32&&(O.choices=C[5]),!r&&k&4&&(r=!0,O.value=C[2],q(()=>r=!1)),e.$set(O);const L={};k&64&&(L.choices=C[6]),!s&&k&8&&(s=!0,L.value=C[3],q(()=>s=!1)),o.$set(L);const M={};k&131073&&(M.$$scope={dirty:k,ctx:C}),u.$set(M)},i(C){l||(g(e.$$.fragment,C),g(o.$$.fragment,C),g(u.$$.fragment,C),g(f.$$.fragment,C),l=!0)},o(C){d(e.$$.fragment,C),d(o.$$.fragment,C),d(u.$$.fragment,C),d(f.$$.fragment,C),l=!1},d(C){C&&(h(n),h(a),h(i)),v(e,C),v(o,C),v(u,C),v(f,C)}}}function si(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",a,u,i=t[7].area.toLocaleString()+"",f,l,c=t[7].crossing.toLocaleString()+"",p,$,S=t[7].other.toLocaleString()+"",C,k;return{c(){e=b("Showing "),n=b(r),o=b(" schemes ("),a=b(s),u=b(`
    routes, `),f=b(i),l=b(` areas,
    `),p=b(c),$=b(" crossings, "),C=b(S),k=b(`
    other)`)},m(O,L){m(O,e,L),m(O,n,L),m(O,o,L),m(O,a,L),m(O,u,L),m(O,f,L),m(O,l,L),m(O,p,L),m(O,$,L),m(O,C,L),m(O,k,L)},p(O,L){L&2&&r!==(r=O[1].size.toLocaleString()+"")&&be(n,r),L&128&&s!==(s=O[7].route.toLocaleString()+"")&&be(a,s),L&128&&i!==(i=O[7].area.toLocaleString()+"")&&be(f,i),L&128&&c!==(c=O[7].crossing.toLocaleString()+"")&&be(p,c),L&128&&S!==(S=O[7].other.toLocaleString()+"")&&be(C,S)},d(O){O&&(h(e),h(n),h(o),h(a),h(u),h(f),h(l),h(p),h($),h(C),h(k))}}}function ii(t){let e,r,n;function o(a){t[14](a)}let s={id:"show-schemes",$$slots:{default:[si]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new ee({props:s}),W.push(()=>Z(e,"checked",o)),{c(){_(e.$$.fragment)},m(a,u){w(e,a,u),n=!0},p(a,u){const i={};u&131202&&(i.$$scope={dirty:u,ctx:a}),!r&&u&16&&(r=!0,i.checked=a[4],q(()=>r=!1)),e.$set(i)},i(a){n||(g(e.$$.fragment,a),n=!0)},o(a){d(e.$$.fragment,a),n=!1},d(a){v(e,a)}}}function ai(t){let e,r,n,o;return e=new Me({props:{label:"Filters",$$slots:{default:[oi]},$$scope:{ctx:t}}}),n=new wt({props:{small:!0,$$slots:{default:[ii]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},p(s,[a]){const u={};a&131181&&(u.$$scope={dirty:a,ctx:s}),e.$set(u);const i={};a&131218&&(i.$$scope={dirty:a,ctx:s}),n.$set(i)},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),v(e,s),v(n,s)}}}function li(t,e,r){let n,o;X(t,ut,y=>r(15,n=y)),X(t,te,y=>r(9,o=y));let{schemes:s}=e,{schemesToBeShown:a=new Set}=e,{filterText:u=""}=e,i=[],f="",l=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;Yt(()=>{let y=new Set,A=new Set;for(let N of s.values())N.authority_or_region&&y.add(N.authority_or_region),N.funding_programme&&A.add(N.funding_programme);r(5,i=Array.from(y.entries())),i.sort(),r(6,l=Array.from(A.entries())),l.sort()});function S(y,A,N){let I=y.toLowerCase(),T=x=>{var j,Y;if(I&&!((j=x.properties.name)!=null&&j.toLowerCase().includes(I))&&!((Y=x.properties.description)!=null&&Y.toLowerCase().includes(I)))return!1;if(A||N){let re=s.get(x.properties.scheme_reference);if(A&&re.authority_or_region!=A||N&&re.funding_programme!=N)return!1}return!0};r(1,a=new Set(n.features.filter(T).map(x=>x.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let F=x=>{var j,Y;return!(!a.has(x.properties.scheme_reference)||I&&!((j=x.properties.name)!=null&&j.toLowerCase().includes(I))&&!((Y=x.properties.description)!=null&&Y.toLowerCase().includes(I)))};ut.update(x=>{for(let j of x.features)F(j)?(delete j.properties.hide_while_editing,r(7,p[j.properties.intervention_type]++,p)):j.properties.hide_while_editing=!0;return x}),r(7,p)}function C(y){f=y,r(2,f)}function k(y){c=y,r(3,c)}function O(){u=this.value,r(0,u)}const L=()=>r(0,u="");function M(y){$=y,r(4,$)}return t.$$set=y=>{"schemes"in y&&r(8,s=y.schemes),"schemesToBeShown"in y&&r(1,a=y.schemesToBeShown),"filterText"in y&&r(0,u=y.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let y of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(y)&&o.setLayoutProperty(y,"visibility",$?"visible":"none");t.$$.dirty&13&&S(u,f,c)},[u,a,f,c,$,i,l,p,s,o,C,k,O,L,M]}class ui extends z{constructor(e){super(),V(this,e,li,ai,G,{schemes:8,schemesToBeShown:1,filterText:0})}}function fi(t){let e,r,n;return e=new pe({props:{color:R.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=b(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function ci(t){let e;return{c(){e=b(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pi(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $i(t){let e,r,n,o,s,a,u,i,f,l,c;return s=new B({props:{href:"https://gtfs.org",$$slots:{default:[ci]},$$scope:{ctx:t}}}),l=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[pi]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=E(),n=P("p"),o=b("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),a=b(`, and doesn't include which routes are run or the
        frequency of service.`),u=E(),i=P("p"),f=b("License: "),_(l.$$.fragment)},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),D(n,o),w(s,n,null),D(n,a),m(p,u,$),m(p,i,$),D(i,f),w(l,i,null),c=!0},p(p,$){const S={};$&8&&(S.$$scope={dirty:$,ctx:p}),s.$set(S);const C={};$&8&&(C.$$scope={dirty:$,ctx:p}),l.$set(C)},i(p){c||(g(s.$$.fragment,p),g(l.$$.fragment,p),c=!0)},o(p){d(s.$$.fragment,p),d(l.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(u),h(i)),v(s),v(l)}}}function mi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[$i]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&8&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function hi(t){let e,r,n,o,s;function a(i){t[1](i)}let u={id:Ge,$$slots:{right:[mi],default:[fi]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:Ge,tooltip:gi,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&8&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ge="bus_routes";function gi(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function di(t,e,r){let n;X(t,te,a=>r(2,n=a)),he(n,Ge,`https://atip.uk/layers/v1/${Ge}.pmtiles`),xe(n,{id:Ge,source:Ge,sourceLayer:Ge,color:["case",["boolean",["get","has_bus_lane"],!1],R.bus_route_with_lane,R.bus_route_without_lane],width:5,opacity:Se(.5,1)});let o=!1;function s(a){o=a,r(0,o)}return[o,s]}class _i extends z{constructor(e){super(),V(this,e,di,hi,G,{})}}function Tr(t,e,r){const n=t.slice();return n[2]=e[r],n}function Ar(t,e,r){const n=t.slice();return n[5]=e[r],n}function Dr(t){let e,r;return{c(){e=P("span"),r=b(` 
    `),Fe(e,"background",t[5]),Fe(e,"width","100%"),Fe(e,"border","1px solid black")},m(n,o){m(n,e,o),D(e,r)},p(n,o){o&1&&Fe(e,"background",n[5])},d(n){n&&h(e)}}}function Er(t){let e,r=t[2]+"",n;return{c(){e=P("span"),n=b(r)},m(o,s){m(o,e,s),D(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&be(n,r)},d(o){o&&h(e)}}}function wi(t){let e,r,n,o=We(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Dr(Ar(t,o,i));let a=We(t[1]),u=[];for(let i=0;i<a.length;i+=1)u[i]=Er(Tr(t,a,i));return{c(){e=P("div");for(let i=0;i<s.length;i+=1)s[i].c();r=E(),n=P("div");for(let i=0;i<u.length;i+=1)u[i].c();Fe(e,"display","flex"),Fe(n,"display","flex"),Fe(n,"justify-content","space-between")},m(i,f){m(i,e,f);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);m(i,r,f),m(i,n,f);for(let l=0;l<u.length;l+=1)u[l]&&u[l].m(n,null)},p(i,[f]){if(f&1){o=We(i[0]);let l;for(l=0;l<o.length;l+=1){const c=Ar(i,o,l);s[l]?s[l].p(c,f):(s[l]=Dr(c),s[l].c(),s[l].m(e,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=o.length}if(f&2){a=We(i[1]);let l;for(l=0;l<a.length;l+=1){const c=Tr(i,a,l);u[l]?u[l].p(c,f):(u[l]=Er(c),u[l].c(),u[l].m(n,null))}for(;l<u.length;l+=1)u[l].d(1);u.length=a.length}},i:Q,o:Q,d(i){i&&(h(e),h(r),h(n)),Lt(s,i),Lt(u,i)}}}function vi(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class yt extends z{constructor(e){super(),V(this,e,vi,wi,G,{colorScale:0,limits:1})}}function bi(t){let e;return{c(){e=b("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yi(t){let e;return{c(){e=b(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ki(t){let e;return{c(){e=b(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Si(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ci(t){let e,r,n,o,s,a,u,i,f,l,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[yi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[ki]},$$scope:{ctx:t}}}),l=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Si]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=b(". Output area boundaries from "),_(s.$$.fragment),a=b("."),u=E(),i=P("p"),f=b("License: "),_(l.$$.fragment),c=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,S){m($,e,S),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,a),m($,u,S),m($,i,S),D(i,f),w(l,i,null),D(i,c),p=!0},p($,S){const C={};S&65536&&(C.$$scope={dirty:S,ctx:$}),n.$set(C);const k={};S&65536&&(k.$$scope={dirty:S,ctx:$}),s.$set(k);const O={};S&65536&&(O.$$scope={dirty:S,ctx:$}),l.$set(O)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(l.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(l.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),v(n),v(s),v(l)}}}function Oi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ci]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Pr(t){let e,r;return e=new yt({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Li(t){let e;return{c(){e=b("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ti(t){let e;return{c(){e=b(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ai(t){let e;return{c(){e=b(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Di(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ei(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,S;return s=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ti]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Ai]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Di]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=E(),n=P("p"),o=b("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),a=b(". Output area boundaries from "),_(u.$$.fragment),i=b("."),f=E(),l=P("p"),c=b("License: "),_(p.$$.fragment),$=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(C,k){m(C,e,k),m(C,r,k),m(C,n,k),D(n,o),w(s,n,null),D(n,a),w(u,n,null),D(n,i),m(C,f,k),m(C,l,k),D(l,c),w(p,l,null),D(l,$),S=!0},p(C,k){const O={};k&65536&&(O.$$scope={dirty:k,ctx:C}),s.$set(O);const L={};k&65536&&(L.$$scope={dirty:k,ctx:C}),u.$set(L);const M={};k&65536&&(M.$$scope={dirty:k,ctx:C}),p.$set(M)},i(C){S||(g(s.$$.fragment,C),g(u.$$.fragment,C),g(p.$$.fragment,C),S=!0)},o(C){d(s.$$.fragment,C),d(u.$$.fragment,C),d(p.$$.fragment,C),S=!1},d(C){C&&(h(e),h(r),h(n),h(f),h(l)),v(s),v(u),v(p)}}}function Pi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ei]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function xr(t){let e,r;return e=new yt({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function xi(t){let e;return{c(){e=b("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ii(t){let e;return{c(){e=b(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ni(t){let e;return{c(){e=b(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Mi(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fi(t){let e,r,n,o,s,a,u,i,f,l,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ii]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Ni]},$$scope:{ctx:t}}}),l=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Mi]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=b(". Output area boundaries from "),_(s.$$.fragment),a=b("."),u=E(),i=P("p"),f=b("License: "),_(l.$$.fragment),c=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,S){m($,e,S),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,a),m($,u,S),m($,i,S),D(i,f),w(l,i,null),D(i,c),p=!0},p($,S){const C={};S&65536&&(C.$$scope={dirty:S,ctx:$}),n.$set(C);const k={};S&65536&&(k.$$scope={dirty:S,ctx:$}),s.$set(k);const O={};S&65536&&(O.$$scope={dirty:S,ctx:$}),l.$set(O)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(l.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(l.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),v(n),v(s),v(l)}}}function Bi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Fi]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Ir(t){let e,r,n,o;return n=new yt({props:{colorScale:t[4],limits:t[7]().map(Ui)}}),{c(){e=P("p"),e.textContent="(people per square kilometres)",r=E(),_(n.$$.fragment)},m(s,a){m(s,e,a),m(s,r,a),w(n,s,a),o=!0},p:Q,i(s){o||(g(n.$$.fragment,s),o=!0)},o(s){d(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),v(n,s)}}}function ji(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,S;function C(T){t[9](T)}let k={id:"percent_households_with_car",$$slots:{right:[Oi],default:[bi]},$$scope:{ctx:t}};t[0]!==void 0&&(k.checked=t[0]),e=new ee({props:k}),W.push(()=>Z(e,"checked",C)),e.$on("change",t[10]);let O=t[3]=="percent_households_with_car"&&Pr(t);function L(T){t[11](T)}let M={id:"average_cars_per_household",$$slots:{right:[Pi],default:[Li]},$$scope:{ctx:t}};t[1]!==void 0&&(M.checked=t[1]),s=new ee({props:M}),W.push(()=>Z(s,"checked",L)),s.$on("change",t[12]);let y=t[3]=="average_cars_per_household"&&xr(t);function A(T){t[13](T)}let N={id:"population_density",$$slots:{right:[Bi],default:[xi]},$$scope:{ctx:t}};t[2]!==void 0&&(N.checked=t[2]),f=new ee({props:N}),W.push(()=>Z(f,"checked",A)),f.$on("change",t[14]);let I=t[3]=="population_density"&&Ir(t);return $=new J({props:{layer:Oe,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=E(),O&&O.c(),o=E(),_(s.$$.fragment),u=E(),y&&y.c(),i=E(),_(f.$$.fragment),c=E(),I&&I.c(),p=E(),_($.$$.fragment)},m(T,F){w(e,T,F),m(T,n,F),O&&O.m(T,F),m(T,o,F),w(s,T,F),m(T,u,F),y&&y.m(T,F),m(T,i,F),w(f,T,F),m(T,c,F),I&&I.m(T,F),m(T,p,F),w($,T,F),S=!0},p(T,[F]){const x={};F&65536&&(x.$$scope={dirty:F,ctx:T}),!r&&F&1&&(r=!0,x.checked=T[0],q(()=>r=!1)),e.$set(x),T[3]=="percent_households_with_car"?O?(O.p(T,F),F&8&&g(O,1)):(O=Pr(T),O.c(),g(O,1),O.m(o.parentNode,o)):O&&(ye(),d(O,1,1,()=>{O=null}),ke());const j={};F&65536&&(j.$$scope={dirty:F,ctx:T}),!a&&F&2&&(a=!0,j.checked=T[1],q(()=>a=!1)),s.$set(j),T[3]=="average_cars_per_household"?y?(y.p(T,F),F&8&&g(y,1)):(y=xr(T),y.c(),g(y,1),y.m(i.parentNode,i)):y&&(ye(),d(y,1,1,()=>{y=null}),ke());const Y={};F&65536&&(Y.$$scope={dirty:F,ctx:T}),!l&&F&4&&(l=!0,Y.checked=T[2],q(()=>l=!1)),f.$set(Y),T[3]=="population_density"?I?(I.p(T,F),F&8&&g(I,1)):(I=Ir(T),I.c(),g(I,1),I.m(p.parentNode,p)):I&&(ye(),d(I,1,1,()=>{I=null}),ke());const re={};F&8&&(re.show=T[3]!=""),$.$set(re)},i(T){S||(g(e.$$.fragment,T),g(O),g(s.$$.fragment,T),g(y),g(f.$$.fragment,T),g(I),g($.$$.fragment,T),S=!0)},o(T){d(e.$$.fragment,T),d(O),d(s.$$.fragment,T),d(y),d(f.$$.fragment,T),d(I),d($.$$.fragment,T),S=!1},d(T){T&&(h(n),h(o),h(u),h(i),h(c),h(p)),v(e,T),O&&O.d(T),v(s,T),y&&y.d(T),v(f,T),I&&I.d(T),v($,T)}}}let Oe="census_output_areas";const Ui=t=>t.toLocaleString();function Ri(t,e,r){let n;X(t,te,M=>r(8,n=M));let o=`${Oe}-outline`,s=R.sequential_low_to_high,a=!1,u=!1,i=!1,f="";he(n,Oe,`https://atip.uk/layers/v1/${Oe}.pmtiles`),ze(n,{id:Oe,source:Oe,sourceLayer:Oe,color:"black",opacity:Se(.5,.7)}),xe(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});function l(M){let y=M.properties.OA21CD,A=M.properties[f];return f=="percent_households_with_car"?`<p>${A}% of households in ${y} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${y} have an average of ${A} cars</p>`:`<p>There are ${A.toLocaleString()} people per square kilometre in ${y}</p>`}function c(M){let y=M.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${y}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${y}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(M){a=M,r(0,a)}const S=()=>{r(1,u=!1),r(2,i=!1)};function C(M){u=M,r(1,u)}const k=()=>{r(0,a=!1),r(2,i=!1)};function O(M){i=M,r(2,i)}const L=()=>{r(0,a=!1),r(1,u=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(a?r(3,f="percent_households_with_car"):u?r(3,f="average_cars_per_household"):i?r(3,f="population_density"):r(3,f=""),f?(n.setPaintProperty(Oe,"fill-color",Qt(["get",f],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[a,u,i,f,s,l,c,p,n,$,S,C,k,O,L]}class Hi extends z{constructor(e){super(),V(this,e,Ri,ji,G,{})}}function Wi(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function zi(t){let e;return{c(){e=b(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vi(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gi(t){let e,r,n,o,s,a,u,i,f,l;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[zi]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Vi]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Data from "),_(n.$$.fragment),o=b(", as of December 2022."),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),D(e,r),w(n,e,null),D(e,o),m(c,s,p),m(c,a,p),D(a,u),w(i,a,null),D(a,f),l=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const S={};p&32&&(S.$$scope={dirty:p,ctx:c}),i.$set(S)},i(c){l||(g(n.$$.fragment,c),g(i.$$.fragment,c),l=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),l=!1},d(c){c&&(h(e),h(s),h(a)),v(n),v(i)}}}function Ki(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Gi]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Zi(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Ue,$$slots:{right:[Ki],default:[Wi]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:Ue,tooltip:qi,show:t[0],clickable:!0}}),o.$on("click",Xi),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ue="combined_authorities";function qi(t){return`<p>${t.properties.name}</p>`}function Xi(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function Yi(t,e,r){let n;X(t,te,i=>r(2,n=i));let o=R.combined_authorities,s=`${Ue}-outline`;er(n,Ue,`https://atip.uk/layers/v1/${Ue}.geojson`),ze(n,{id:Ue,source:Ue,color:o,opacity:Se(.5,0)}),xe(n,{id:s,source:Ue,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class Ji extends z{constructor(e){super(),V(this,e,Yi,Zi,G,{})}}function Qi(t){let e,r,n;return{c(){e=P("input"),H(e,"class","govuk-file-upload"),H(e,"id","load-criticals"),H(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=Jt(e,"change",t[4]),r=!0)},p:Q,d(o){o&&h(e),t[7](null),r=!1,n()}}}function Nr(t){let e,r;return e=new wt({props:{small:!0,$$slots:{default:[ta]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function ea(t){let e,r,n=t[2].toLocaleString()+"",o,s,a;return e=new pe({props:{color:Kt}}),{c(){_(e.$$.fragment),r=b(`
        Show `),o=b(n),s=b(" issues")},m(u,i){w(e,u,i),m(u,r,i),m(u,o,i),m(u,s,i),a=!0},p(u,i){(!a||i&4)&&n!==(n=u[2].toLocaleString()+"")&&be(o,n)},i(u){a||(g(e.$$.fragment,u),a=!0)},o(u){d(e.$$.fragment,u),a=!1},d(u){u&&(h(r),h(o),h(s)),v(e,u)}}}function ta(t){let e,r,n;function o(a){t[8](a)}let s={id:"show-criticals",$$slots:{default:[ea]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new ee({props:s}),W.push(()=>Z(e,"checked",o)),{c(){_(e.$$.fragment)},m(a,u){w(e,a,u),n=!0},p(a,u){const i={};u&516&&(i.$$scope={dirty:u,ctx:a}),!r&&u&1&&(r=!0,i.checked=a[0],q(()=>r=!1)),e.$set(i)},i(a){n||(g(e.$$.fragment,a),n=!0)},o(a){d(e.$$.fragment,a),n=!1},d(a){v(e,a)}}}function ra(t){let e,r,n,o,s,a;e=new qr({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[Qi]},$$scope:{ctx:t}}}),n=new Yr({props:{errorMessage:t[3]}});let u=t[2]>0&&Nr(t);return{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment),o=E(),u&&u.c(),s=tr()},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),m(i,o,f),u&&u.m(i,f),m(i,s,f),a=!0},p(i,f){const l={};f&514&&(l.$$scope={dirty:f,ctx:i}),e.$set(l);const c={};f&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?u?(u.p(i,f),f&4&&g(u,1)):(u=Nr(i),u.c(),g(u,1),u.m(s.parentNode,s)):u&&(ye(),d(u,1,1,()=>{u=null}),ke())},i(i){a||(g(e.$$.fragment,i),g(n.$$.fragment,i),g(u),a=!0)},o(i){d(e.$$.fragment,i),d(n.$$.fragment,i),d(u),a=!1},d(i){i&&(h(r),h(o),h(s)),v(e,i),v(n,i),u&&u.d(i)}}}function na(t){let e,r,n,o,s,a;return e=new Me({props:{label:"Critical Issues",$$slots:{default:[ra]},$$scope:{ctx:t}}}),n=new J({props:{layer:se+"-points",tooltip:oa,show:t[0],clickable:!1}}),s=new J({props:{layer:se+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[se+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment),o=E(),_(s.$$.fragment)},m(u,i){w(e,u,i),m(u,r,i),w(n,u,i),m(u,o,i),w(s,u,i),a=!0},p(u,[i]){const f={};i&527&&(f.$$scope={dirty:i,ctx:u}),e.$set(f);const l={};i&1&&(l.show=u[0]),n.$set(l);const c={};i&1&&(c.show=u[0]),s.$set(c)},i(u){a||(g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),a=!0)},o(u){d(e.$$.fragment,u),d(n.$$.fragment,u),d(s.$$.fragment,u),a=!1},d(u){u&&(h(r),h(o)),v(e,u),v(n,u),v(s,u)}}}let se="criticals",Kt="red";function oa(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function sa(t,e,r){let n;X(t,te,p=>r(6,n=p));let o,s=!0,a=0,u="";xn(n,se),n.addSource(se,{type:"geojson",data:Xr(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),ft(n,{id:`${se}-clusters`,source:se,filter:["has","point_count"],color:Kt,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${se}-counts`,source:se,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),ft(n,{id:`${se}-points`,source:se,filter:["!",["has","point_count"]],color:Kt,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await Js(o.files[0]);n.getSource(se).setData($),r(2,a=$.features.length),r(3,u="")}catch($){r(3,u=`The file you loaded is broken: ${$}`)}}function f(p){n.getSource(se).getClusterExpansionZoom(p.detail.properties.cluster_id,($,S)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:S})})}function l(p){W[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${se}-counts`)&&n.setLayoutProperty(`${se}-counts`,"visibility",s?"visible":"none")},[s,o,a,u,i,f,n,l,c]}class ia extends z{constructor(e){super(),V(this,e,sa,na,G,{})}}function aa(t){let e,r,n;return e=new pe({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=b(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function la(t){let e;return{c(){e=b("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ua(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fa(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[la]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ua]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("This shows "),_(n.$$.fragment),o=b(" data from OpenStreetMap (as of 9 August 2023)."),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),D(e,r),w(n,e,null),D(e,o),m(l,s,c),m(l,a,c),D(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(g(n.$$.fragment,l),g(i.$$.fragment,l),f=!0)},o(l){d(n.$$.fragment,l),d(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),v(n),v(i)}}}function ca(t){let e,r,n;return r=new ne({props:{$$slots:{default:[fa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function pa(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Re,$$slots:{right:[ca],default:[aa]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:Re,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",$a),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&64&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}const Re="crossings";function $a(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function ma(t,e,r){let n;X(t,te,f=>r(4,n=f));let o=!1;function s(f){const l=f.properties.crossing;return`<p>${a.get(l)??`Crossing with unknown type (${l}).`} Click for details.</p>`}const a=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross."],["traffic_signals","Signalised crossing."],["marked","Crossing with no traffic signals."],["uncontrolled","Crossing with no traffic signals."],["unmarked","Crossing with no markings or signals."],["zebra","Zebra crossing."],["island","Crossing with an island."],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it."]]);he(n,Re,`https://atip.uk/layers/v1/${Re}.pmtiles`);let u=R[Re];ft(n,{id:Re,source:Re,sourceLayer:Re,color:u,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(f){o=f,r(0,o)}return[o,s,u,i]}class ha extends z{constructor(e){super(),V(this,e,ma,pa,G,{})}}function ga(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function da(t){let e;return{c(){e=b("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _a(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wa(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[da]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[_a]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Cycle parking, according to "),_(n.$$.fragment),o=b(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),D(e,r),w(n,e,null),D(e,o),m(l,s,c),m(l,a,c),D(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(g(n.$$.fragment,l),g(i.$$.fragment,l),f=!0)},o(l){d(n.$$.fragment,l),d(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),v(n),v(i)}}}function va(t){let e,r,n;return r=new ne({props:{$$slots:{default:[wa]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function ba(t){let e,r,n,o,s;function a(i){t[2](i)}let u={id:Ke,$$slots:{right:[va],default:[ga]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:Ke,tooltip:ya,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&16&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ke="cycle_parking";function ya(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function ka(t,e,r){let n;X(t,te,u=>r(3,n=u));let o=R.cycle_parking;he(n,Ke,`https://atip.uk/layers/v1/${Ke}.pmtiles`),ft(n,{id:Ke,source:Ke,sourceLayer:Ke,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function a(u){s=u,r(0,s)}return[s,o,a]}class Sa extends z{constructor(e){super(),V(this,e,ka,ba,G,{})}}function Mr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function Ca(t){let e;return{c(){e=b("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Oa(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function La(t){let e,r,n,o,s,a,u,i,f,l;return f=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Oa]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=E(),n=P("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=E(),s=P("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,a=E(),u=P("p"),i=b("License: "),_(f.$$.fragment)},m(c,p){m(c,e,p),m(c,r,p),m(c,n,p),m(c,o,p),m(c,s,p),m(c,a,p),m(c,u,p),D(u,i),w(f,u,null),l=!0},p(c,p){const $={};p&256&&($.$$scope={dirty:p,ctx:c}),f.$set($)},i(c){l||(g(f.$$.fragment,c),l=!0)},o(c){d(f.$$.fragment,c),l=!1},d(c){c&&(h(e),h(r),h(n),h(o),h(s),h(a),h(u)),v(f)}}}function Ta(t){let e,r,n;return r=new ne({props:{$$slots:{default:[La]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Fr(t){let e,r,n=We(t[1]),o=[];for(let a=0;a<n.length;a+=1)o[a]=Br(Mr(t,n,a));const s=a=>d(o[a],1,1,()=>{o[a]=null});return{c(){for(let a=0;a<o.length;a+=1)o[a].c();e=tr()},m(a,u){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(a,u);m(a,e,u),r=!0},p(a,u){if(u&2){n=We(a[1]);let i;for(i=0;i<n.length;i+=1){const f=Mr(a,n,i);o[i]?(o[i].p(f,u),g(o[i],1)):(o[i]=Br(f),o[i].c(),g(o[i],1),o[i].m(e.parentNode,e))}for(ye(),i=n.length;i<o.length;i+=1)s(i);ke()}},i(a){if(!r){for(let u=0;u<n.length;u+=1)g(o[u]);r=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)d(o[u]);r=!1},d(a){a&&h(e),Lt(o,a)}}}function Br(t){let e,r,n,o=t[4]+"",s,a,u;return r=new pe({props:{color:t[5]}}),{c(){e=P("div"),_(r.$$.fragment),n=E(),s=b(o),a=E()},m(i,f){m(i,e,f),w(r,e,null),D(e,n),D(e,s),D(e,a),u=!0},p:Q,i(i){u||(g(r.$$.fragment,i),u=!0)},o(i){d(r.$$.fragment,i),u=!1},d(i){i&&h(e),v(r)}}}function Aa(t){let e,r,n,o,s,a;function u(l){t[2](l)}let i={id:Ze,$$slots:{right:[Ta],default:[Ca]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new ee({props:i}),W.push(()=>Z(e,"checked",u));let f=t[0]&&Fr(t);return s=new J({props:{layer:Ze,tooltip:Da,show:t[0],clickable:!0}}),s.$on("click",Ea),{c(){_(e.$$.fragment),n=E(),f&&f.c(),o=E(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:l}),!r&&c&1&&(r=!0,p.checked=l[0],q(()=>r=!1)),e.$set(p),l[0]?f?(f.p(l,c),c&1&&g(f,1)):(f=Fr(l),f.c(),g(f,1),f.m(o.parentNode,o)):f&&(ye(),d(f,1,1,()=>{f=null}),ke());const $={};c&1&&($.show=l[0]),s.$set($)},i(l){a||(g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!0)},o(l){d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),v(e,l),f&&f.d(l),v(s,l)}}}let Ze="cycle_paths";function Da(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Ea(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Pa(t,e,r){let n;X(t,te,u=>r(3,n=u));let o=[["Separated tracks",R.cycle_paths.track],["Unprotected lanes",R.cycle_paths.lane],["Shared-use (segregated)",R.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",R.cycle_paths.shared_use_unsegregated]];he(n,Ze,`https://atip.uk/layers/v1/${Ze}.pmtiles`),xe(n,{id:Ze,source:Ze,sourceLayer:Ze,color:Zr(["get","kind"],{track:R.cycle_paths.track,lane:R.cycle_paths.lane,shared_use_segregated:R.cycle_paths.shared_use_segregated,shared_use_unsegregated:R.cycle_paths.shared_use_unsegregated},"red"),width:["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20],opacity:Se(.5,1)});let s=!1;function a(u){s=u,r(0,s)}return[s,o,a]}class xa extends z{constructor(e){super(),V(this,e,Pa,Aa,G,{})}}function Ia(t){let e,r,n,o;return e=new pe({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=E(),n=b(t[1])},m(s,a){w(e,s,a),m(s,r,a),m(s,n,a),o=!0},p(s,a){(!o||a&2)&&be(n,s[1])},i(s){o||(g(e.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),v(e,s)}}}function Na(t){let e;const r=t[6].default,n=In(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&Nn(n,r,o,o[8],e?Fn(r,o[8],s,null):Mn(o[8]),null)},i(o){e||(g(n,o),e=!0)},o(o){d(n,o),e=!1},d(o){n&&n.d(o)}}}function Ma(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Na]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Fa(t){let e,r,n,o,s;function a(i){t[7](i)}let u={id:t[0],$$slots:{right:[Ma],default:[Ia]},$$scope:{ctx:t}};return t[2]!==void 0&&(u.checked=t[2]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&1&&(l.id=i[0]),f&258&&(l.$$scope={dirty:f,ctx:i}),!r&&f&4&&(r=!0,l.checked=i[2],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.layer=i[0]),f&4&&(c.show=i[2]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}function Ba(t,e,r){let n;X(t,te,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:a}=e,{singularNoun:u}=e,{pluralNoun:i}=e,f=R[a];he(n,a,`https://atip.uk/layers/v1/${a}.pmtiles`),ze(n,{id:a,source:a,sourceLayer:a,color:f,opacity:Se(1,.7)});let l=!1;function c($){return`<p>${$.properties.name??`Unnamed ${u}`}</p>`}function p($){l=$,r(2,l)}return t.$$set=$=>{"name"in $&&r(0,a=$.name),"singularNoun"in $&&r(5,u=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[a,i,l,f,c,u,o,p,s]}class nr extends z{constructor(e){super(),V(this,e,Ba,Fa,G,{name:0,singularNoun:5,pluralNoun:1})}}function ja(t){let e;return{c(){e=b("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ua(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ra(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[ja]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ua]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("This shows "),_(n.$$.fragment),o=b(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),D(e,r),w(n,e,null),D(e,o),m(l,s,c),m(l,a,c),D(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(g(n.$$.fragment,l),g(i.$$.fragment,l),f=!0)},o(l){d(n.$$.fragment,l),d(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),v(n),v(i)}}}function Ha(t){let e,r;return e=new nr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Ra]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}class Wa extends z{constructor(e){super(),V(this,e,null,Ha,G,{})}}function za(t){let e;return{c(){e=b("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Va(t){let e;return{c(){e=b(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ga(t){let e;return{c(){e=b(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ka(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Za(t){let e,r,n,o,s,a,u,i,f,l,c,p;return n=new B({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Va]},$$scope:{ctx:t}}}),s=new B({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Ga]},$$scope:{ctx:t}}}),l=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ka]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("The 2019 English IMD scores come from "),_(n.$$.fragment),o=b(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),a=b("."),u=E(),i=P("p"),f=b("License: "),_(l.$$.fragment),c=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,S){m($,e,S),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,a),m($,u,S),m($,i,S),D(i,f),w(l,i,null),D(i,c),p=!0},p($,S){const C={};S&64&&(C.$$scope={dirty:S,ctx:$}),n.$set(C);const k={};S&64&&(k.$$scope={dirty:S,ctx:$}),s.$set(k);const O={};S&64&&(O.$$scope={dirty:S,ctx:$}),l.$set(O)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(l.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(l.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),v(n),v(s),v(l)}}}function qa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Za]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function jr(t){let e,r;return e=new yt({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Xa(t){let e,r,n,o,s,a;function u(l){t[3](l)}let i={id:Le,$$slots:{right:[qa],default:[za]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new ee({props:i}),W.push(()=>Z(e,"checked",u));let f=t[0]&&jr(t);return s=new J({props:{layer:Le,tooltip:Ya,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=E(),f&&f.c(),o=E(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:l}),!r&&c&1&&(r=!0,p.checked=l[0],q(()=>r=!1)),e.$set(p),l[0]?f?(f.p(l,c),c&1&&g(f,1)):(f=jr(l),f.c(),g(f,1),f.m(o.parentNode,o)):f&&(ye(),d(f,1,1,()=>{f=null}),ke());const $={};c&1&&($.show=l[0]),s.$set($)},i(l){a||(g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!0)},o(l){d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),v(e,l),f&&f.d(l),v(s,l)}}}let Le="imd";function Ya(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function Ja(t,e,r){let n;X(t,te,f=>r(2,n=f));let o=`${Le}-outline`,s=R.sequential_low_to_high,a=[0,2,4,6,8,10];he(n,Le,`https://atip.uk/layers/v1/${Le}.pmtiles`),ze(n,{id:Le,source:Le,sourceLayer:Le,color:Qt(["-",10,["get","decile"]],a,s),opacity:Se(.5,.7)}),xe(n,{id:o,source:Le,sourceLayer:Le,color:"black",width:.5});let u=!1;function i(f){u=f,r(0,u)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",u?"visible":"none")},[u,s,n,i]}class Qa extends z{constructor(e){super(),V(this,e,Ja,Xa,G,{})}}function el(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function tl(t){let e;return{c(){e=b(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rl(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nl(t){let e,r,n,o,s,a,u,i,f,l;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[tl]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[rl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Data from "),_(n.$$.fragment),o=b(", as of May 2023."),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),D(e,r),w(n,e,null),D(e,o),m(c,s,p),m(c,a,p),D(a,u),w(i,a,null),D(a,f),l=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const S={};p&32&&(S.$$scope={dirty:p,ctx:c}),i.$set(S)},i(c){l||(g(n.$$.fragment,c),g(i.$$.fragment,c),l=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),l=!1},d(c){c&&(h(e),h(s),h(a)),v(n),v(i)}}}function ol(t){let e,r,n;return r=new ne({props:{$$slots:{default:[nl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function sl(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:He,$$slots:{right:[ol],default:[el]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:He,tooltip:il,show:t[0],clickable:!0}}),o.$on("click",al),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let He="local_authority_districts";function il(t){return`<p>${t.properties.name}</p>`}function al(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function ll(t,e,r){let n;X(t,te,i=>r(2,n=i));let o=R.local_authority_districts,s=`${He}-outline`;er(n,He,`https://atip.uk/layers/v1/${He}.geojson`),ze(n,{id:He,source:He,color:o,opacity:Se(.5,0)}),xe(n,{id:s,source:He,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class ul extends z{constructor(e){super(),V(this,e,ll,sl,G,{})}}function fl(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function cl(t){let e;return{c(){e=b(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pl(t){let e;return{c(){e=b(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $l(t){let e;return{c(){e=b(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ml(t){let e;return{c(){e=b("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function hl(t){let e;return{c(){e=b(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function gl(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function dl(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,S,C,k,O,L,M,y,A,N,I,T,F;return n=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[cl]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[pl]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[$l]},$$scope:{ctx:t}}}),$=new B({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[ml]},$$scope:{ctx:t}}}),L=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[hl]},$$scope:{ctx:t}}}),I=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[gl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("LPAs may be a "),_(n.$$.fragment),o=b(", "),_(s.$$.fragment),a=b("y, or "),_(u.$$.fragment),i=b("."),f=E(),l=P("p"),c=P("strong"),p=b(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),S=b(" to get more details."),C=E(),k=P("p"),O=b("Data from ONS Geography via "),_(L.$$.fragment),M=b(", as of November 2022."),y=E(),A=P("p"),N=b("License: "),_(I.$$.fragment),T=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(x,j){m(x,e,j),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,a),w(u,e,null),D(e,i),m(x,f,j),m(x,l,j),D(l,c),D(c,p),w($,c,null),D(c,S),m(x,C,j),m(x,k,j),D(k,O),w(L,k,null),D(k,M),m(x,y,j),m(x,A,j),D(A,N),w(I,A,null),D(A,T),F=!0},p(x,j){const Y={};j&32&&(Y.$$scope={dirty:j,ctx:x}),n.$set(Y);const re={};j&32&&(re.$$scope={dirty:j,ctx:x}),s.$set(re);const Ce={};j&32&&(Ce.$$scope={dirty:j,ctx:x}),u.$set(Ce);const $e={};j&32&&($e.$$scope={dirty:j,ctx:x}),$.$set($e);const oe={};j&32&&(oe.$$scope={dirty:j,ctx:x}),L.$set(oe);const Ve={};j&32&&(Ve.$$scope={dirty:j,ctx:x}),I.$set(Ve)},i(x){F||(g(n.$$.fragment,x),g(s.$$.fragment,x),g(u.$$.fragment,x),g($.$$.fragment,x),g(L.$$.fragment,x),g(I.$$.fragment,x),F=!0)},o(x){d(n.$$.fragment,x),d(s.$$.fragment,x),d(u.$$.fragment,x),d($.$$.fragment,x),d(L.$$.fragment,x),d(I.$$.fragment,x),F=!1},d(x){x&&(h(e),h(f),h(l),h(C),h(k),h(y),h(A)),v(n),v(s),v(u),v($),v(L),v(I)}}}function _l(t){let e,r,n;return r=new ne({props:{$$slots:{default:[dl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function wl(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Te,$$slots:{right:[_l],default:[fl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:Te,tooltip:vl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Te="local_planning_authorities";function vl(t){return`<p>${t.properties.name}</p>`}function bl(t,e,r){let n;X(t,te,i=>r(2,n=i));let o=R.local_planning_authorities,s=`${Te}-outline`;he(n,Te,`https://atip.uk/layers/v1/${Te}.pmtiles`),ze(n,{id:Te,source:Te,sourceLayer:Te,color:o,opacity:Se(.5,0)}),xe(n,{id:s,source:Te,sourceLayer:Te,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class yl extends z{constructor(e){super(),V(this,e,bl,wl,G,{})}}function kl(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function Sl(t){let e;return{c(){e=b(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cl(t){let e;return{c(){e=b("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ol(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Sl]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Cl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Data from the "),_(n.$$.fragment),o=b(", as of September 2021."),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),D(e,r),w(n,e,null),D(e,o),m(l,s,c),m(l,a,c),D(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(g(n.$$.fragment,l),g(i.$$.fragment,l),f=!0)},o(l){d(n.$$.fragment,l),d(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),v(n),v(i)}}}function Ll(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ol]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Tl(t){let e,r,n,o,s;function a(i){t[2](i)}let u={id:qe,$$slots:{right:[Ll],default:[kl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:qe,tooltip:Al,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&16&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let qe="mrn";function Al(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Dl(t,e,r){let n;X(t,te,u=>r(3,n=u));let o=R.mrn;he(n,qe,`https://atip.uk/layers/v1/${qe}.pmtiles`),xe(n,{id:qe,source:qe,sourceLayer:qe,color:o,width:7,opacity:Se(.5,1)});let s=!1;function a(u){s=u,r(0,s)}return[s,o,a]}class El extends z{constructor(e){super(),V(this,e,Dl,Tl,G,{})}}function Pl(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function xl(t){let e;return{c(){e=b(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Il(t){let e;return{c(){e=b("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Nl(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[xl]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Il]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Data from "),_(n.$$.fragment),o=b(", as of May 2023."),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),D(e,r),w(n,e,null),D(e,o),m(l,s,c),m(l,a,c),D(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(g(n.$$.fragment,l),g(i.$$.fragment,l),f=!0)},o(l){d(n.$$.fragment,l),d(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),v(n),v(i)}}}function Ml(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Nl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Fl(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Ae,$$slots:{right:[Ml],default:[Pl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:Ae,tooltip:Bl,show:t[0],clickable:!0}}),o.$on("click",jl),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ae="parliamentary_constituencies";function Bl(t){return`<p>${t.properties.Name}</p>`}function jl(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function Ul(t,e,r){let n;X(t,te,i=>r(2,n=i));let o=R.parliamentary_constituencies,s=`${Ae}-outline`;he(n,Ae,`https://atip.uk/layers/v1/${Ae}.pmtiles`),ze(n,{id:Ae,source:Ae,sourceLayer:Ae,color:o,opacity:Se(.5,0)}),xe(n,{id:s,source:Ae,sourceLayer:Ae,color:o,width:5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class Rl extends z{constructor(e){super(),V(this,e,Ul,Fl,G,{})}}function Hl(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function Wl(t){let e;return{c(){e=b("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zl(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vl(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[Wl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[zl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("This shows "),_(n.$$.fragment),o=b(" data from OpenStreetMap (as of 9 August 2023)."),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),D(e,r),w(n,e,null),D(e,o),m(l,s,c),m(l,a,c),D(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(g(n.$$.fragment,l),g(i.$$.fragment,l),f=!0)},o(l){d(n.$$.fragment,l),d(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),v(n),v(i)}}}function Gl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Vl]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Kl(t){let e,r,n,o,s;function a(i){t[2](i)}let u={id:Xe,$$slots:{right:[Gl],default:[Hl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:Xe,tooltip:Zl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}const Xe="railway_stations";function Zl(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function ql(t,e,r){let n;X(t,te,i=>r(3,n=i));const o=`https://atip.uk/layers/v1/${Xe}.geojson`;let s=!1;er(n,Xe,o);let a=R[Xe];ft(n,{id:Xe,source:Xe,color:a,radius:Rn/2});function u(i){s=i,r(0,s)}return[s,a,u]}class Xl extends z{constructor(e){super(),V(this,e,ql,Kl,G,{})}}function Yl(t){let e;return{c(){e=b("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Jl(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ql(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Yl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Jl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("This shows "),_(n.$$.fragment),o=b(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),D(e,r),w(n,e,null),D(e,o),m(l,s,c),m(l,a,c),D(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(g(n.$$.fragment,l),g(i.$$.fragment,l),f=!0)},o(l){d(n.$$.fragment,l),d(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),v(n),v(i)}}}function eu(t){let e,r;return e=new nr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Ql]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}class tu extends z{constructor(e){super(),V(this,e,null,eu,G,{})}}function ru(t){let e;return{c(){e=b("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nu(t){let e;return{c(){e=b("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ou(t){let e;return{c(){e=b("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function su(t){let e,r,n,o,s,a,u,i,f,l,c;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[ru]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[nu]},$$scope:{ctx:t}}}),l=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ou]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("This shows "),_(n.$$.fragment),o=b(" and "),_(s.$$.fragment),a=b(" data from OpenStreetMap (as of 9 August 2023)."),u=E(),i=P("p"),f=b("License: "),_(l.$$.fragment)},m(p,$){m(p,e,$),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,a),m(p,u,$),m(p,i,$),D(i,f),w(l,i,null),c=!0},p(p,$){const S={};$&1&&(S.$$scope={dirty:$,ctx:p}),n.$set(S);const C={};$&1&&(C.$$scope={dirty:$,ctx:p}),s.$set(C);const k={};$&1&&(k.$$scope={dirty:$,ctx:p}),l.$set(k)},i(p){c||(g(n.$$.fragment,p),g(s.$$.fragment,p),g(l.$$.fragment,p),c=!0)},o(p){d(n.$$.fragment,p),d(s.$$.fragment,p),d(l.$$.fragment,p),c=!1},d(p){p&&(h(e),h(u),h(i)),v(n),v(s),v(l)}}}function iu(t){let e,r;return e=new nr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[su]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}class au extends z{constructor(e){super(),V(this,e,null,iu,G,{})}}function lu(t){let e;return{c(){e=b("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function uu(t){let e;return{c(){e=b(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fu(t){let e;return{c(){e=b("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function cu(t){let e;return{c(){e=b("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pu(t){let e,r,n,o,s,a,u,i,f,l,c,p,$;return n=new B({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[uu]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[fu]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[cu]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=b(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),a=b(" for details and caveats about the measurements."),u=E(),i=P("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=E(),l=P("p"),c=b("License: "),_(p.$$.fragment)},m(S,C){m(S,e,C),D(e,r),w(n,e,null),D(e,o),w(s,e,null),D(e,a),m(S,u,C),m(S,i,C),m(S,f,C),m(S,l,C),D(l,c),w(p,l,null),$=!0},p(S,C){const k={};C&64&&(k.$$scope={dirty:C,ctx:S}),n.$set(k);const O={};C&64&&(O.$$scope={dirty:C,ctx:S}),s.$set(O);const L={};C&64&&(L.$$scope={dirty:C,ctx:S}),p.$set(L)},i(S){$||(g(n.$$.fragment,S),g(s.$$.fragment,S),g(p.$$.fragment,S),$=!0)},o(S){d(n.$$.fragment,S),d(s.$$.fragment,S),d(p.$$.fragment,S),$=!1},d(S){S&&(h(e),h(u),h(i),h(f),h(l)),v(n),v(s),v(p)}}}function $u(t){let e,r,n;return r=new ne({props:{$$slots:{default:[pu]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Ur(t){let e,r;return e=new yt({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function mu(t){let e,r,n,o,s,a;function u(l){t[3](l)}let i={id:Ye,$$slots:{right:[$u],default:[lu]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new ee({props:i}),W.push(()=>Z(e,"checked",u));let f=t[0]&&Ur(t);return s=new J({props:{layer:Ye,tooltip:hu,show:t[0],clickable:!0}}),s.$on("click",gu),{c(){_(e.$$.fragment),n=E(),f&&f.c(),o=E(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:l}),!r&&c&1&&(r=!0,p.checked=l[0],q(()=>r=!1)),e.$set(p),l[0]?f?(f.p(l,c),c&1&&g(f,1)):(f=Ur(l),f.c(),g(f,1),f.m(o.parentNode,o)):f&&(ye(),d(f,1,1,()=>{f=null}),ke());const $={};c&1&&($.show=l[0]),s.$set($)},i(l){a||(g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!0)},o(l){d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),v(e,l),f&&f.d(l),v(s,l)}}}let Ye="vehicle_counts";function hu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function gu(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function du(t,e,r){let n;X(t,te,f=>r(4,n=f));let o=R.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],a=["","40k","80k","120k","160k",""];he(n,Ye,`https://atip.uk/layers/v1/${Ye}.pmtiles`),ft(n,{id:Ye,source:Ye,sourceLayer:Ye,color:Qt(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let u=!1;function i(f){u=f,r(0,u)}return[u,o,a,i]}class _u extends z{constructor(e){super(),V(this,e,du,mu,G,{})}}function wu(t){let e,r,n;return e=new pe({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=b(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function vu(t){let e;return{c(){e=b(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function bu(t){let e;return{c(){e=b(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yu(t){let e,r,n,o,s,a,u,i,f,l;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[vu]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[bu]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=b("Data from "),_(n.$$.fragment),o=b(", as of May 2023."),s=E(),a=P("p"),u=b("License: "),_(i.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),D(e,r),w(n,e,null),D(e,o),m(c,s,p),m(c,a,p),D(a,u),w(i,a,null),D(a,f),l=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const S={};p&32&&(S.$$scope={dirty:p,ctx:c}),i.$set(S)},i(c){l||(g(n.$$.fragment,c),g(i.$$.fragment,c),l=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),l=!1},d(c){c&&(h(e),h(s),h(a)),v(n),v(i)}}}function ku(t){let e,r,n;return r=new ne({props:{$$slots:{default:[yu]},$$scope:{ctx:t}}}),{c(){e=P("span"),_(r.$$.fragment),H(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Su(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:De,$$slots:{right:[ku],default:[wu]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new ee({props:u}),W.push(()=>Z(e,"checked",a)),o=new J({props:{layer:De,tooltip:Cu,show:t[0],clickable:!0}}),o.$on("click",Ou),{c(){_(e.$$.fragment),n=E(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],q(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let De="wards";function Cu(t){return`<p>${t.properties.name}</p>`}function Ou(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Lu(t,e,r){let n;X(t,te,i=>r(2,n=i));let o=R.wards,s=`${De}-outline`;he(n,De,`https://atip.uk/layers/v1/${De}.pmtiles`),ze(n,{id:De,source:De,sourceLayer:De,color:o,opacity:Se(.5,0)}),xe(n,{id:s,source:De,sourceLayer:De,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class Tu extends z{constructor(e){super(),V(this,e,Lu,Su,G,{})}}function Au(t){let e,r,n,o,s,a,u,i;return e=new tu({}),n=new Wa({}),s=new au({}),u=new Xl({}),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment),o=E(),_(s.$$.fragment),a=E(),_(u.$$.fragment)},m(f,l){w(e,f,l),m(f,r,l),w(n,f,l),m(f,o,l),w(s,f,l),m(f,a,l),w(u,f,l),i=!0},i(f){i||(g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),g(u.$$.fragment,f),i=!0)},o(f){d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),d(u.$$.fragment,f),i=!1},d(f){f&&(h(r),h(o),h(a)),v(e,f),v(n,f),v(s,f),v(u,f)}}}function Du(t){let e,r;return e=new wt({props:{small:!0,$$slots:{default:[Au]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Eu(t){let e,r,n,o,s,a,u,i,f,l;return e=new xa({}),n=new El({}),s=new _i({}),u=new Sa({}),f=new ha({}),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment),o=E(),_(s.$$.fragment),a=E(),_(u.$$.fragment),i=E(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,a,p),w(u,c,p),m(c,i,p),w(f,c,p),l=!0},i(c){l||(g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),l=!0)},o(c){d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),l=!1},d(c){c&&(h(r),h(o),h(a),h(i)),v(e,c),v(n,c),v(s,c),v(u,c),v(f,c)}}}function Pu(t){let e,r;return e=new wt({props:{small:!0,$$slots:{default:[Eu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function xu(t){let e,r,n,o,s,a,u,i,f,l;return e=new Rl({}),n=new Tu({}),s=new Ji({}),u=new ul({}),f=new yl({}),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment),o=E(),_(s.$$.fragment),a=E(),_(u.$$.fragment),i=E(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,a,p),w(u,c,p),m(c,i,p),w(f,c,p),l=!0},i(c){l||(g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),l=!0)},o(c){d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),l=!1},d(c){c&&(h(r),h(o),h(a),h(i)),v(e,c),v(n,c),v(s,c),v(u,c),v(f,c)}}}function Iu(t){let e,r;return e=new wt({props:{small:!0,$$slots:{default:[xu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Nu(t){let e,r,n,o;return e=new Hi({}),n=new Qa({}),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),v(e,s),v(n,s)}}}function Mu(t){let e,r;return e=new _u({}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Fu(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,S,C,k,O;e=new ia({}),n=new Me({props:{label:"Trip generators",$$slots:{default:[Du]},$$scope:{ctx:t}}}),s=new Me({props:{label:"Existing infrastructure",$$slots:{default:[Pu]},$$scope:{ctx:t}}}),u=new Me({props:{label:"Boundaries",$$slots:{default:[Iu]},$$scope:{ctx:t}}}),f=new Me({props:{label:"Census",$$slots:{default:[Nu]},$$scope:{ctx:t}}}),c=new Me({props:{label:"Other",$$slots:{default:[Mu]},$$scope:{ctx:t}}});function L(y){t[5](y)}let M={displayEnableButton:!0};return t[2]!==void 0&&(M.isInactive=t[2]),$=new Hn({props:M}),t[4]($),W.push(()=>Z($,"isInactive",L)),k=new Gn({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment),o=E(),_(s.$$.fragment),a=E(),_(u.$$.fragment),i=E(),_(f.$$.fragment),l=E(),_(c.$$.fragment),p=E(),_($.$$.fragment),C=E(),_(k.$$.fragment)},m(y,A){w(e,y,A),m(y,r,A),w(n,y,A),m(y,o,A),w(s,y,A),m(y,a,A),w(u,y,A),m(y,i,A),w(f,y,A),m(y,l,A),w(c,y,A),m(y,p,A),w($,y,A),m(y,C,A),w(k,y,A),O=!0},p(y,A){const N={};A&64&&(N.$$scope={dirty:A,ctx:y}),n.$set(N);const I={};A&64&&(I.$$scope={dirty:A,ctx:y}),s.$set(I);const T={};A&64&&(T.$$scope={dirty:A,ctx:y}),u.$set(T);const F={};A&64&&(F.$$scope={dirty:A,ctx:y}),f.$set(F);const x={};A&64&&(x.$$scope={dirty:A,ctx:y}),c.$set(x);const j={};!S&&A&4&&(S=!0,j.isInactive=y[2],q(()=>S=!1)),$.$set(j);const Y={};A&1&&(Y.style=y[0]),k.$set(Y)},i(y){O||(g(e.$$.fragment,y),g(n.$$.fragment,y),g(s.$$.fragment,y),g(u.$$.fragment,y),g(f.$$.fragment,y),g(c.$$.fragment,y),g($.$$.fragment,y),g(k.$$.fragment,y),O=!0)},o(y){d(e.$$.fragment,y),d(n.$$.fragment,y),d(s.$$.fragment,y),d(u.$$.fragment,y),d(f.$$.fragment,y),d(c.$$.fragment,y),d($.$$.fragment,y),d(k.$$.fragment,y),O=!1},d(y){y&&(h(r),h(o),h(a),h(i),h(l),h(p),h(C)),v(e,y),v(n,y),v(s,y),v(u,y),v(f,y),v(c,y),t[4](null),v($,y),v(k,y)}}}function Bu(t){let e,r,n,o;return e=new Me({props:{label:"Layers",open:!0,$$slots:{default:[Fu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,a){w(e,s,a),r=!0,n||(o=Jt(window,"keydown",t[3]),n=!0)},p(s,[a]){const u={};a&71&&(u.$$scope={dirty:a,ctx:s}),e.$set(u)},i(s){r||(g(e.$$.fragment,s),r=!0)},o(s){d(e.$$.fragment,s),r=!1},d(s){v(e,s),n=!1,o()}}}function ju(t,e,r){let n;X(t,ur,f=>r(2,n=f));let{style:o}=e,s;function a(f){!n&&f.key=="Escape"&&(s.disableStreetView(),f.preventDefault())}function u(f){W[f?"unshift":"push"](()=>{s=f,r(1,s)})}function i(f){n=f,ur.set(n)}return t.$$set=f=>{"style"in f&&r(0,o=f.style)},[o,s,n,a,u,i]}class Uu extends z{constructor(e){super(),V(this,e,ju,Bu,G,{style:0})}}/*! js-cookie v3.0.5 | MIT */function Ct(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var Ru={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Zt(t,e){function r(o,s,a){if(!(typeof document>"u")){a=Ct({},e,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var u="";for(var i in a)a[i]&&(u+="; "+i,a[i]!==!0&&(u+="="+a[i].split(";")[0]));return document.cookie=o+"="+t.write(s,o)+u}}function n(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var s=document.cookie?document.cookie.split("; "):[],a={},u=0;u<s.length;u++){var i=s[u].split("="),f=i.slice(1).join("=");try{var l=decodeURIComponent(i[0]);if(a[l]=t.read(f,l),o===l)break}catch{}}return o?a[o]:a}}return Object.create({set:r,get:n,remove:function(o,s){r(o,"",Ct({},s,{expires:-1}))},withAttributes:function(o){return Zt(this.converter,Ct({},this.attributes,o))},withConverter:function(o){return Zt(Ct({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}Zt(Ru,{path:"/"});function Hu(t){let e;return{c(){e=b("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Wu(t){let e;return{c(){e=b("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zu(t){let e,r,n=t[0].authority_or_region+"",o,s,a,u,i=t[0].capital_scheme_id+"",f,l,c,p,$=t[0].funding_programme+"",S,C,k,O,L,M,y;return O=new jt({props:{$$slots:{default:[Hu]},$$scope:{ctx:t}}}),O.$on("click",t[3]),M=new jt({props:{disabled:t[1],title:t[2],$$slots:{default:[Wu]},$$scope:{ctx:t}}}),M.$on("click",t[4]),{c(){e=P("p"),r=b("Authority or region: "),o=b(n),s=E(),a=P("p"),u=b("Capital scheme ID: "),f=b(i),l=E(),c=P("p"),p=b("Funding programme: "),S=b($),C=E(),k=P("div"),_(O.$$.fragment),L=E(),_(M.$$.fragment),H(k,"class","govuk-button-group")},m(A,N){m(A,e,N),D(e,r),D(e,o),m(A,s,N),m(A,a,N),D(a,u),D(a,f),m(A,l,N),m(A,c,N),D(c,p),D(c,S),m(A,C,N),m(A,k,N),w(O,k,null),D(k,L),w(M,k,null),y=!0},p(A,N){(!y||N&1)&&n!==(n=A[0].authority_or_region+"")&&be(o,n),(!y||N&1)&&i!==(i=A[0].capital_scheme_id+"")&&be(f,i),(!y||N&1)&&$!==($=A[0].funding_programme+"")&&be(S,$);const I={};N&256&&(I.$$scope={dirty:N,ctx:A}),O.$set(I);const T={};N&256&&(T.$$scope={dirty:N,ctx:A}),M.$set(T)},i(A){y||(g(O.$$.fragment,A),g(M.$$.fragment,A),y=!0)},o(A){d(O.$$.fragment,A),d(M.$$.fragment,A),y=!1},d(A){A&&(h(e),h(s),h(a),h(l),h(c),h(C),h(k)),v(O),v(M)}}}function Vu(t){let e,r;return e=new Me({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[zu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Gu(t,e,r){let n,o;X(t,ut,c=>r(6,n=c)),X(t,te,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:a}=e,u=!a.has(s.authority_or_region),i=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(Bn(c),{padding:20,animate:!1})}function l(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,a=c.authorityNames)},[s,u,i,f,l,a]}class Ku extends z{constructor(e){super(),V(this,e,Gu,Vu,G,{scheme:0,authorityNames:5})}}const Zu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ie=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{u(r.next(i))}catch(f){o(f)}},a=i=>{try{u(r.throw(i))}catch(f){o(f)}},u=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,a);u((r=r.apply(t,e)).next())}),ce=Uint8Array,at=Uint16Array,qu=Int32Array,_n=new ce([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),wn=new ce([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Xu=new ce([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vn=function(t,e){for(var r=new at(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new qu(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},bn=vn(_n,2),yn=bn.b,Yu=bn.r;yn[28]=258,Yu[258]=28;var Ju=vn(wn,0),Qu=Ju.b,qt=new at(32768);for(U=0;U<32768;++U)Ne=(U&43690)>>1|(U&21845)<<1,Ne=(Ne&52428)>>2|(Ne&13107)<<2,Ne=(Ne&61680)>>4|(Ne&3855)<<4,qt[U]=((Ne&65280)>>8|(Ne&255)<<8)>>1;var Ne,U,gt=function(t,e,r){for(var n=t.length,o=0,s=new at(e);o<n;++o)t[o]&&++s[t[o]-1];var a=new at(e);for(o=1;o<e;++o)a[o]=a[o-1]+s[o-1]<<1;var u;if(r){u=new at(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],l=e-t[o],c=a[t[o]-1]++<<l,p=c|(1<<l)-1;c<=p;++c)u[qt[c]>>i]=f}else for(u=new at(n),o=0;o<n;++o)t[o]&&(u[o]=qt[a[t[o]-1]++]>>15-t[o]);return u},kt=new ce(288);for(U=0;U<144;++U)kt[U]=8;var U;for(U=144;U<256;++U)kt[U]=9;var U;for(U=256;U<280;++U)kt[U]=7;var U;for(U=280;U<288;++U)kt[U]=8;var U,kn=new ce(32);for(U=0;U<32;++U)kn[U]=5;var U,ef=gt(kt,9,1),tf=gt(kn,5,1),Ft=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},de=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Bt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},rf=function(t){return(t+7)/8|0},nf=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new ce(r-e);return n.set(t.subarray(e,r)),n},of=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],le=function(t,e,r){var n=new Error(e||of[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,le),!r)throw n;return n},or=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new ce(0);var a=!r||e.i!=2,u=e.i;r||(r=new ce(o*3));var i=function(sr){var ir=r.length;if(sr>ir){var ar=new ce(Math.max(ir*2,sr));ar.set(r),r=ar}},f=e.f||0,l=e.p||0,c=e.b||0,p=e.l,$=e.d,S=e.m,C=e.n,k=o*8;do{if(!p){f=de(t,l,1);var O=de(t,l+1,3);if(l+=3,O)if(O==1)p=ef,$=tf,S=9,C=5;else if(O==2){var A=de(t,l,31)+257,N=de(t,l+10,15)+4,I=A+de(t,l+5,31)+1;l+=14;for(var T=new ce(I),F=new ce(19),x=0;x<N;++x)F[Xu[x]]=de(t,l+x*3,7);l+=N*3;for(var j=Ft(F),Y=(1<<j)-1,re=gt(F,j,1),x=0;x<I;){var Ce=re[de(t,l,Y)];l+=Ce&15;var L=Ce>>4;if(L<16)T[x++]=L;else{var $e=0,oe=0;for(L==16?(oe=3+de(t,l,3),l+=2,$e=T[x-1]):L==17?(oe=3+de(t,l,7),l+=3):L==18&&(oe=11+de(t,l,127),l+=7);oe--;)T[x++]=$e}}var Ve=T.subarray(0,A),ae=T.subarray(A);S=Ft(Ve),C=Ft(ae),p=gt(Ve,S,1),$=gt(ae,C,1)}else le(1);else{var L=rf(l)+4,M=t[L-4]|t[L-3]<<8,y=L+M;if(y>o){u&&le(0);break}a&&i(c+M),r.set(t.subarray(L,y),c),e.b=c+=M,e.p=l=y*8,e.f=f;continue}if(l>k){u&&le(0);break}}a&&i(c+131072);for(var ct=(1<<S)-1,Be=(1<<C)-1,et=l;;et=l){var $e=p[Bt(t,l)&ct],me=$e>>4;if(l+=$e&15,l>k){u&&le(0);break}if($e||le(2),me<256)r[c++]=me;else if(me==256){et=l,p=null;break}else{var tt=me-254;if(me>264){var x=me-257,Ie=_n[x];tt=de(t,l,(1<<Ie)-1)+yn[x],l+=Ie}var rt=$[Bt(t,l)&Be],nt=rt>>4;rt||le(3),l+=rt&15;var ae=Qu[nt];if(nt>3){var Ie=wn[nt];ae+=Bt(t,l)&(1<<Ie)-1,l+=Ie}if(l>k){u&&le(0);break}a&&i(c+131072);var ot=c+tt;if(c<ae){var pt=s-ae,En=Math.min(ae,ot);for(pt+c<0&&le(3);c<En;++c)r[c]=n[pt+c]}for(;c<ot;c+=4)r[c]=r[c-ae],r[c+1]=r[c+1-ae],r[c+2]=r[c+2-ae],r[c+3]=r[c+3-ae];c=ot}}e.l=p,e.p=et,e.b=c,e.f=f,p&&(f=1,e.m=S,e.d=$,e.n=C)}while(!f);return c==r.length?r:nf(r,0,c)},sf=new ce(0),af=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&le(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},lf=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},uf=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&le(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&le(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function ff(t,e){return or(t,{i:2},e&&e.out,e&&e.dictionary)}function cf(t,e){var r=af(t);return r+8>t.length&&le(6,"invalid gzip data"),or(t.subarray(r,-8),{i:2},e&&e.out||new ce(lf(t)),e&&e.dictionary)}function pf(t,e){return or(t.subarray(uf(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Xt(t,e){return t[0]==31&&t[1]==139&&t[2]==8?cf(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?ff(t,e):pf(t,e)}var $f=typeof TextDecoder<"u"&&new TextDecoder,mf=0;try{$f.decode(sf,{stream:!0}),mf=1}catch{}var Sn=(t,e)=>t*Math.pow(2,e),$t=(t,e)=>Math.floor(t/Math.pow(2,e)),At=(t,e)=>Sn(t.getUint16(e+1,!0),8)+t.getUint8(e),Cn=(t,e)=>Sn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),hf=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=At(n,o+1);if(e!=s)return e-s;const a=At(n,o+4);return r!=a?r-a:0},gf=(t,e,r,n)=>{const o=On(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Rr=(t,e,r,n)=>{const o=On(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},On=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const a=s+o>>1,u=hf(e,r,n,t,a*17);if(u>0)o=a+1;else if(u<0)s=a-1;else return[Cn(t,a*17+7),t.getUint32(a*17+13,!0)]}return null},df=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,Ln=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:At(t,e*17+1),y:At(t,e*17+4),offset:Cn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Hr=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(Ln(r,n));return _f(e)},_f=t=>{t.sort(df);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=$t(o.offset,8)&255,r[n*17+9]=$t(o.offset,16)&255,r[n*17+10]=$t(o.offset,24)&255,r[n*17+11]=$t(o.offset,32)&255,r[n*17+12]=$t(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},wf=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=Ln(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,a=Math.trunc(e.x/(1<<s)),u=Math.trunc(e.y/(1<<s));return{z:o,x:a,y:u}}return null};function vf(t){return ie(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),a=JSON.parse(s.decode(new DataView(e.data,10,n)));let u=0;a.compression==="gzip"&&(u=2);let i=0;"minzoom"in a&&(i=+a.minzoom);let f=0;"maxzoom"in a&&(f=+a.maxzoom);let l=0,c=0,p=0,$=-180,S=-85,C=180,k=85;if(a.bounds){const L=a.bounds.split(",");$=+L[0],S=+L[1],C=+L[2],k=+L[3]}if(a.center){const L=a.center.split(",");l=+L[0],c=+L[1],p=+L[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:i,maxZoom:f,minLon:$,minLat:S,maxLon:C,maxLat:k,centerZoom:p,centerLon:l,centerLat:c,etag:e.etag}})}function bf(t,e,r,n,o,s,a){return ie(this,null,function*(){let u=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(u=Hr(u));const i=Rr(new DataView(u),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,a)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=Xt(new Uint8Array(c))),{data:c}}const f=wf(new DataView(u),{z:n,x:o,y:s});if(f){const l=gf(new DataView(u),f.z,f.x,f.y);if(l){let c=yield r.getArrayBuffer(e,l.offset,l.length,t);t.specVersion===1&&(c=Hr(c));const p=Rr(new DataView(c),n,o,s);if(p){let S=(yield e.getBytes(p.offset,p.length,a)).data;const C=new DataView(S);return C.getUint8(0)==31&&C.getUint8(1)==139&&(S=Xt(new Uint8Array(S))),{data:S}}}}})}var Tn={getHeader:vf,getZxy:bf},yf=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Wr(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new Wr(o),this.tiles.set(o,s));const a=n[2],u=n[3],i=n[4],f=new AbortController,l=f.signal;let c=()=>{f.abort()};return s.getHeader().then(p=>{s.getZxy(+a,+u,+i,l).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function st(t,e){return(e>>>0)*4294967296+(t>>>0)}function kf(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return st(t,n);throw new Error("Expected varint not more than 10 bytes")}function mt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,kf(r,t))}function Sf(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var Cf=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Of(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=Cf[t],o=Math.pow(2,t);let s=0,a=0,u=0;const i=[e,r];let f=o/2;for(;f>0;)s=(i[0]&f)>0?1:0,a=(i[1]&f)>0?1:0,u+=f*f*(3*s^a),Sf(f,i,s,a),f=f/2;return n+u}function An(t,e){return ie(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Xt(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Lf=127;function Tf(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Af=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ie(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const u=o.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+u.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function _e(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Df(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:_e(r,8),rootDirectoryLength:_e(r,16),jsonMetadataOffset:_e(r,24),jsonMetadataLength:_e(r,32),leafDirectoryOffset:_e(r,40),leafDirectoryLength:_e(r,48),tileDataOffset:_e(r,56),tileDataLength:_e(r,64),numAddressedTiles:_e(r,72),numTileEntries:_e(r,80),numTileContents:_e(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function Dn(t){const e={buf:new Uint8Array(t),pos:0},r=mt(e),n=[];let o=0;for(let s=0;s<r;s++){const a=mt(e);n.push({tileId:o+a,offset:0,length:0,runLength:1}),o+=a}for(let s=0;s<r;s++)n[s].runLength=mt(e);for(let s=0;s<r;s++)n[s].length=mt(e);for(let s=0;s<r;s++){const a=mt(e);a===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=a-1}return n}function Ef(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var lt=class extends Error{};function Pf(t,e,r,n){return ie(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Ef(o.data)<3)return[yield Tn.getHeader(t)];const a=o.data.slice(0,Lf);let u=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),u=void 0);const i=Df(a,u);if(r){const f=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),l=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=Dn(yield e(f,i.internalCompression));return[i,[l,c.length,c]]}return[i,void 0]})}function xf(t,e,r,n,o){return ie(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new lt(s.etag);const a=yield e(s.data,o.internalCompression),u=Dn(a);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var If=class{constructor(t=100,e=!0,r=An){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ie(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{Pf(t,this.decompress,this.prefetch,e).then(a=>{a[1]&&this.cache.set(a[1][0],{lastUsed:this.counter++,data:Promise.resolve(a[1][2])}),o(a[0]),this.prune()}).catch(a=>{s(a)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((a,u)=>{xf(t,this.decompress,e,r,n).then(i=>{a(i),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((a,u)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new lt(i.etag);a(i.data),this.cache.has(o),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ie(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Wr=class{constructor(t,e,r){typeof t=="string"?this.source=new Af(t):this.source=t,r?this.decompress=r:this.decompress=An,e?this.cache=e:this.cache=new If}getHeader(){return ie(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ie(this,null,function*(){const o=Of(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Tn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let a=s.rootDirectoryOffset,u=s.rootDirectoryLength;for(let i=0;i<=3;i++){const f=yield this.cache.getDirectory(this.source,a,u,s),l=Tf(f,o);if(l)if(l.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+l.offset,l.length,n);if(s.etag&&s.etag!==c.etag)throw new lt(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else a=s.leafDirectoryOffset+l.offset,u=l.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ie(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof lt)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ie(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new lt(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ie(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof lt)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Nf(t){return Yt(()=>{let e=new yf;fr.addProtocol("pmtiles",e.tile)}),Jr(()=>{fr.removeProtocol("pmtiles")}),[]}class Mf extends z{constructor(e){super(),V(this,e,Nf,null,G,{})}}function zr(t,e,r){const n=t.slice();return n[13]=e[r],n}function Vr(t){let e,r,n,o;function s(i){t[9](i)}function a(i){t[10](i)}let u={schemes:t[1]};return t[2]!==void 0&&(u.schemesToBeShown=t[2]),t[3]!==void 0&&(u.filterText=t[3]),e=new ui({props:u}),W.push(()=>Z(e,"schemesToBeShown",s)),W.push(()=>Z(e,"filterText",a)),{c(){_(e.$$.fragment)},m(i,f){w(e,i,f),o=!0},p(i,f){const l={};f&2&&(l.schemes=i[1]),!r&&f&4&&(r=!0,l.schemesToBeShown=i[2],q(()=>r=!1)),!n&&f&8&&(n=!0,l.filterText=i[3],q(()=>n=!1)),e.$set(l)},i(i){o||(g(e.$$.fragment,i),o=!0)},o(i){d(e.$$.fragment,i),o=!1},d(i){v(e,i)}}}function Gr(t){let e,r;return e=new Ku({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Kr(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&Gr(t);return{c(){o&&o.c(),r=tr()},m(s,a){o&&o.m(s,a),m(s,r,a),n=!0},p(s,a){a&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,a),a&6&&g(o,1)):(o=Gr(s),o.c(),g(o,1),o.m(r.parentNode,r)):o&&(ye(),d(o,1,1,()=>{o=null}),ke())},i(s){n||(g(o),n=!0)},o(s){d(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function Ff(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,S;s=new Kn({props:{boundaryGeojson:t[4]}});let C=!1;i=new qn({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),l=new Yr({props:{errorMessage:t[0]}});let k=t[1].size>0&&Vr(t),O=We(t[1].values()),L=[];for(let y=0;y<O.length;y+=1)L[y]=Kr(zr(t,O,y));const M=y=>d(L[y],1,1,()=>{L[y]=null});return{c(){e=P("div"),r=P("div"),n=P("h1"),n.textContent="Browse schemes",o=E(),_(s.$$.fragment),a=E(),u=E(),_(i.$$.fragment),f=E(),_(l.$$.fragment),c=E(),k&&k.c(),p=E(),$=P("ul");for(let y=0;y<L.length;y+=1)L[y].c();Fe(r,"display","flex"),Fe(r,"justify-content","space-between"),H(e,"slot","sidebar"),H(e,"class","govuk-prose")},m(y,A){m(y,e,A),D(e,r),D(r,n),D(r,o),w(s,r,null),D(e,a),D(e,u),w(i,e,null),D(e,f),w(l,e,null),D(e,c),k&&k.m(e,null),D(e,p),D(e,$);for(let N=0;N<L.length;N+=1)L[N]&&L[N].m($,null);S=!0},p(y,A){const N={};A&16&&(N.boundaryGeojson=y[4]),s.$set(N);const I={};if(A&1&&(I.errorMessage=y[0]),l.$set(I),y[1].size>0?k?(k.p(y,A),A&2&&g(k,1)):(k=Vr(y),k.c(),g(k,1),k.m(e,p)):k&&(ye(),d(k,1,1,()=>{k=null}),ke()),A&38){O=We(y[1].values());let T;for(T=0;T<O.length;T+=1){const F=zr(y,O,T);L[T]?(L[T].p(F,A),g(L[T],1)):(L[T]=Kr(F),L[T].c(),g(L[T],1),L[T].m($,null))}for(ye(),T=O.length;T<L.length;T+=1)M(T);ke()}},i(y){if(!S){g(s.$$.fragment,y),g(C),g(i.$$.fragment,y),g(l.$$.fragment,y),g(k);for(let A=0;A<O.length;A+=1)g(L[A]);S=!0}},o(y){d(s.$$.fragment,y),d(C),d(i.$$.fragment,y),d(l.$$.fragment,y),d(k),L=L.filter(Boolean);for(let A=0;A<L.length;A+=1)d(L[A]);S=!1},d(y){y&&h(e),v(s),v(i),v(l),k&&k.d(),Lt(L,y)}}}function Bf(t){let e,r,n,o,s,a,u,i,f,l,c;return e=new Zn({props:{colorInterventions:Qr("v1")}}),n=new J({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new J({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),u=new J({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),l=new Uu({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=E(),_(n.$$.fragment),o=E(),_(s.$$.fragment),a=E(),_(u.$$.fragment),i=E(),f=P("div"),_(l.$$.fragment),H(f,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,a,$),w(u,p,$),m(p,i,$),m(p,f,$),w(l,f,null),c=!0},p:Q,i(p){c||(g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),g(l.$$.fragment,p),c=!0)},o(p){d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),d(l.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(a),h(i),h(f)),v(e,p),v(n,p),v(s,p),v(u,p),v(l)}}}function jf(t){let e,r,n,o,s;return r=new Mf({}),o=new zn({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Bf]},$$scope:{ctx:t}}}),{c(){e=P("div"),_(r.$$.fragment),n=E(),_(o.$$.fragment),H(e,"slot","main")},m(a,u){m(a,e,u),w(r,e,null),D(e,n),w(o,e,null),s=!0},p(a,u){const i={};u&65536&&(i.$$scope={dirty:u,ctx:a}),o.$set(i)},i(a){s||(g(r.$$.fragment,a),g(o.$$.fragment,a),s=!0)},o(a){d(r.$$.fragment,a),d(o.$$.fragment,a),s=!1},d(a){a&&h(e),v(r),v(o)}}}function Uf(t){let e,r;return e=new Wn({props:{$$slots:{main:[jf],sidebar:[Ff]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Rf(t,e,r){let n;X(t,ut,k=>r(4,n=k));let o=new Set(Zu);Yt(()=>{jn()});let a=new URLSearchParams(window.location.search).get("style")||"dataviz",u="",i=new Map,f=new Set,l="";Jr(()=>{ut.set(Xr())});function c(k){try{let O=JSON.parse(k);r(1,i=Ys(O)),ut.set(O),r(0,u="")}catch(O){r(0,u=`The file you loaded is broken: ${O}`)}}function p(k){let O=k.properties;var L='<div style="max-width: 30vw;">';return L+=`<h2>${$(O.name)} (${O.intervention_type})</h2>`,L+=`<p>Scheme reference: ${O.scheme_reference}</p>`,O.length_meters&&(L+=`<p>Length: ${Un(O.length_meters)}</p>`),O.description&&(L+=`<p>${$(O.description)}</p>`),L+="</div>",L}function $(k){return l?k.replace(new RegExp(l,"gi"),O=>`<mark>${O}</mark>`):k}function S(k){f=k,r(2,f)}function C(k){l=k,r(3,l)}return[u,i,f,l,n,o,a,c,p,S,C]}class Hf extends z{constructor(e){super(),V(this,e,Rf,Uf,G,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Hf({target:document.getElementById("app")});
