import{S as w,i as F,s as M,W as g,B as C,aW as x,Q as E,A as I,r as R,ac as S}from"./layer_helper_utils-3069aba6.js";function q(r,i,o){let t,f;g(r,C,e=>o(5,t=e)),g(r,x,e=>o(6,f=e));const b=E();let{layer:n}=i,{clickable:s}=i,{tooltip:u=null}=i,{show:y=!0}=i,{hoveredFeature:l=null}=i,h=new I.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});R(()=>{t.on("mousemove",n,d),t.on("mouseleave",n,v),s&&t.on("click",n,L)}),S(()=>{t.off("mousemove",n,d),t.off("mouseleave",n,v),s&&t.off("click",n,L),m(),h.remove()});function d(e){if(!f)return;let a=e.features??[];if(a.length==0)return;a[0].id||console.log(`Features in the ${n} layer don't have IDs; InteractiveLayer won't work`);let c=t.queryRenderedFeatures(e.point);if(c.length>0&&c[0].layer.id!=n){v();return}if((l==null?void 0:l.id)!=a[0].id){if(m(),o(0,l=a[0]),t.setFeatureState(l,{hover:!0}),u){let k=`<div class="govuk-prose">${u(l)}</div>`;h.setLngLat(e.lngLat).setHTML(k).addTo(t)}s&&(t.getCanvas().style.cursor="pointer")}else u&&h.setLngLat(e.lngLat)}function v(){f&&(m(),o(0,l=null),h.remove(),s&&(t.getCanvas().style.cursor="inherit"))}function m(){l&&t.setFeatureState(l,{hover:!1})}function L(e){if(!f)return;let a=e.features??[];if(a.length>0){let c=t.queryRenderedFeatures(e.point);if(c.length>0&&c[0].layer.id!=n)return;b("click",a[0])}}return r.$$set=e=>{"layer"in e&&o(1,n=e.layer),"clickable"in e&&o(2,s=e.clickable),"tooltip"in e&&o(3,u=e.tooltip),"show"in e&&o(4,y=e.show),"hoveredFeature"in e&&o(0,l=e.hoveredFeature)},r.$$.update=()=>{r.$$.dirty&50&&t.getLayer(n)&&t.setLayoutProperty(n,"visibility",y?"visible":"none")},[l,n,s,u,y,t]}class W extends w{constructor(i){super(),F(this,i,q,null,M,{layer:1,clickable:2,tooltip:3,show:4,hoveredFeature:0})}}export{W as I};
