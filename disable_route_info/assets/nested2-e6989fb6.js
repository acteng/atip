import{S as z,i as G,s as V,P as hn,b as j,c as K,e as B,f as N,g as _,aE as gn,h as I,j as m,k as S,m as w,w as lt,o as q,t as g,l as d,p as h,q as k,G as at,J as it,K as ct,L as ft,W as Z,B as X,aw as Kt,u as v,T as ae,_ as We,r as ut,F as dn,a as nt,v as yt,aU as fe,a3 as _e,D as ue,x as J,aT as U,aG as Ce,av as be,aH as qe,y as ie,n as ce,Z as Te,aV as $t,Y as pt,a4 as mt,a9 as qt,aW as Lt,C as Zt,aX as St,ac as Yt,d as _n,z as wn,a5 as kn,aN as bn,E as vn}from"./layer_helper_utils-3069aba6.js";import{j as rt,h as yn,i as Ct,g as Jt,C as Se,d as Q,k as $e,a as Ln,S as Sn,B as Cn,b as ht,L as Tn,Z as Dn,M as Nn,I as An}from"./StreetViewController-161ec918.js";import{I as Y}from"./InteractiveLayer-cbf333a3.js";const Bn="/atip/disable_route_info/assets/help-d011708a.svg";function On(s){let e,n;const t=s[1].default,r=at(t,s,s[4],null);return{c(){e=B("div"),r&&r.c(),I(e,"class","govuk-prose")},m(o,i){m(o,e,i),r&&r.m(e,null),n=!0},p(o,i){r&&r.p&&(!n||i&16)&&it(r,t,o,o[4],n?ft(t,o[4],i,null):ct(o[4]),null)},i(o){n||(g(r,o),n=!0)},o(o){d(r,o),n=!1},d(o){o&&h(e),r&&r.d(o)}}}function Mn(s){let e,n,t,r,o,i,u,l,c;function a($){s[3]($)}let f={title:"Help",$$slots:{default:[On]},$$scope:{ctx:s}};return s[0]!==void 0&&(f.open=s[0]),o=new hn({props:f}),j.push(()=>K(o,"open",a)),{c(){e=B("button"),n=B("img"),r=N(),_(o.$$.fragment),gn(n.src,t=Bn)||I(n,"src",t),I(n,"title","Help"),I(n,"alt","Help"),I(e,"class","svelte-7d9d1l")},m($,p){m($,e,p),S(e,n),m($,r,p),w(o,$,p),u=!0,l||(c=lt(e,"click",s[2]),l=!0)},p($,[p]){const b={};p&16&&(b.$$scope={dirty:p,ctx:$}),!i&&p&1&&(i=!0,b.open=$[0],q(()=>i=!1)),o.$set(b)},i($){u||(g(o.$$.fragment,$),u=!0)},o($){d(o.$$.fragment,$),u=!1},d($){$&&(h(e),h(r)),k(o,$),l=!1,c()}}}function En(s,e,n){let{$$slots:t={},$$scope:r}=e,o=!1;const i=()=>n(0,o=!0);function u(l){o=l,n(0,o)}return s.$$set=l=>{"$$scope"in l&&n(4,r=l.$$scope)},[o,t,i,u,r]}class ee extends z{constructor(e){super(),G(this,e,En,Mn,V,{})}}const Pn=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];function Hn(s){let e=new Map;for(let[t,r]of Object.entries(s.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:r.authority_or_region,capital_scheme_id:r.capital_scheme_id,funding_programme:r.funding_programme});let n=1;for(let t of s.features){let r=e.get(t.properties.scheme_reference);r.num_features++,t.properties.funding_programme=r.funding_programme,t.id=n++}return e}const F={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function Un(s){let e,n,t,r,o;function i(l){s[3](l)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return s[0]!==void 0&&(u.value=s[0]),e=new rt({props:u}),j.push(()=>K(e,"value",i)),e.$on("change",s[2]),r=new yn({props:{rows:s[1]}}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};!n&&c&1&&(n=!0,a.value=l[0],q(()=>n=!1)),e.$set(a);const f={};c&2&&(f.rows=l[1]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function xn(s,e,n){let t;Z(s,X,l=>n(4,t=l));let r="interventionType",o=Ct("v1");function i(){let l;r=="interventionType"?(l=Jt("v1"),n(1,o=Ct("v1"))):(l=Kt(["get","funding_programme"],{ATF2:F.atf2,ATF3:F.atf3,ATF4:F.atf4},"grey"),n(1,o=[["ATF2",F.atf2],["ATF3",F.atf3],["ATF4",F.atf4]])),t.setPaintProperty("interventions-points","circle-color",l),t.setPaintProperty("interventions-lines","line-color",l),t.setPaintProperty("interventions-polygons","fill-color",l),t.setPaintProperty("interventions-polygon-outlines","line-color",l)}function u(l){r=l,n(0,r)}return[r,o,i,u]}class Wn extends z{constructor(e){super(),G(this,e,xn,Un,V,{})}}function Fn(s){let e;return{c(){e=v("Clear")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function In(s){let e,n,t,r,o,i;return t=new nt({props:{$$slots:{default:[Fn]},$$scope:{ctx:s}}}),t.$on("click",s[11]),{c(){e=B("input"),n=N(),_(t.$$.fragment),I(e,"type","text"),I(e,"class","govuk-input govuk-input--width-10"),I(e,"id","filterText")},m(u,l){m(u,e,l),yt(e,s[0]),m(u,n,l),w(t,u,l),r=!0,o||(i=lt(e,"input",s[10]),o=!0)},p(u,l){l&1&&e.value!==u[0]&&yt(e,u[0]);const c={};l&16384&&(c.$$scope={dirty:l,ctx:u}),t.$set(c)},i(u){r||(g(t.$$.fragment,u),r=!0)},o(u){d(t.$$.fragment,u),r=!1},d(u){u&&(h(e),h(n)),k(t,u),o=!1,i()}}}function Rn(s){let e,n,t,r,o,i,u,l,c,a;function f(L){s[8](L)}let $={label:"Authority or region",id:"filterAuthority",choices:s[4],emptyOption:!0};s[2]!==void 0&&($.value=s[2]),e=new rt({props:$}),j.push(()=>K(e,"value",f));function p(L){s[9](L)}let b={label:"Funding programme",id:"filterFundingProgramme",choices:s[5],emptyOption:!0};return s[3]!==void 0&&(b.value=s[3]),r=new rt({props:b}),j.push(()=>K(r,"value",p)),u=new dn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[In]},$$scope:{ctx:s}}}),c=new Wn({}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment),i=N(),_(u.$$.fragment),l=N(),_(c.$$.fragment)},m(L,C){w(e,L,C),m(L,t,C),w(r,L,C),m(L,i,C),w(u,L,C),m(L,l,C),w(c,L,C),a=!0},p(L,C){const D={};C&16&&(D.choices=L[4]),!n&&C&4&&(n=!0,D.value=L[2],q(()=>n=!1)),e.$set(D);const y={};C&32&&(y.choices=L[5]),!o&&C&8&&(o=!0,y.value=L[3],q(()=>o=!1)),r.$set(y);const T={};C&16385&&(T.$$scope={dirty:C,ctx:L}),u.$set(T)},i(L){a||(g(e.$$.fragment,L),g(r.$$.fragment,L),g(u.$$.fragment,L),g(c.$$.fragment,L),a=!0)},o(L){d(e.$$.fragment,L),d(r.$$.fragment,L),d(u.$$.fragment,L),d(c.$$.fragment,L),a=!1},d(L){L&&(h(t),h(i),h(l)),k(e,L),k(r,L),k(u,L),k(c,L)}}}function zn(s){let e,n,t,r,o=s[1].size+"",i,u,l=s[6].route+"",c,a,f=s[6].area+"",$,p,b=s[6].crossing+"",L,C,D=s[6].other+"",y,T,M;return e=new Se({props:{label:"Filters",$$slots:{default:[Rn]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment),n=N(),t=B("p"),r=v("Showing "),i=v(o),u=v(" schemes ("),c=v(l),a=v(" routes, "),$=v(f),p=v(` areas,
  `),L=v(b),C=v(" crossings, "),y=v(D),T=v(" other)")},m(O,x){w(e,O,x),m(O,n,x),m(O,t,x),S(t,r),S(t,i),S(t,u),S(t,c),S(t,a),S(t,$),S(t,p),S(t,L),S(t,C),S(t,y),S(t,T),M=!0},p(O,[x]){const P={};x&16445&&(P.$$scope={dirty:x,ctx:O}),e.$set(P),(!M||x&2)&&o!==(o=O[1].size+"")&&ae(i,o),(!M||x&64)&&l!==(l=O[6].route+"")&&ae(c,l),(!M||x&64)&&f!==(f=O[6].area+"")&&ae($,f),(!M||x&64)&&b!==(b=O[6].crossing+"")&&ae(L,b),(!M||x&64)&&D!==(D=O[6].other+"")&&ae(y,D)},i(O){M||(g(e.$$.fragment,O),M=!0)},o(O){d(e.$$.fragment,O),M=!1},d(O){O&&(h(n),h(t)),k(e,O)}}}function Gn(s,e,n){let t;Z(s,We,D=>n(12,t=D));let{schemes:r}=e,{schemesToBeShown:o=new Set}=e,{filterText:i=""}=e,u=[],l="",c=[],a="",f={area:0,route:0,crossing:0,other:0};ut(()=>{let D=new Set,y=new Set;for(let T of r.values())T.authority_or_region&&D.add(T.authority_or_region),T.funding_programme&&y.add(T.funding_programme);n(4,u=Array.from(D.entries())),u.sort(),n(5,c=Array.from(y.entries())),c.sort()});function $(D,y,T){let M=D.toLowerCase(),O=P=>{var A,H;if(M&&!((A=P.properties.name)!=null&&A.toLowerCase().includes(M))&&!((H=P.properties.description)!=null&&H.toLowerCase().includes(M)))return!1;if(y||T){let E=r.get(P.properties.scheme_reference);if(y&&E.authority_or_region!=y||T&&E.funding_programme!=T)return!1}return!0};n(1,o=new Set(t.features.filter(O).map(P=>P.properties.scheme_reference))),n(6,f={area:0,route:0,crossing:0,other:0});let x=P=>{var A,H;return!(!o.has(P.properties.scheme_reference)||M&&!((A=P.properties.name)!=null&&A.toLowerCase().includes(M))&&!((H=P.properties.description)!=null&&H.toLowerCase().includes(M)))};We.update(P=>{for(let A of P.features)x(A)?(delete A.properties.hide_while_editing,n(6,f[A.properties.intervention_type]++,f)):A.properties.hide_while_editing=!0;return P}),n(6,f)}function p(D){l=D,n(2,l)}function b(D){a=D,n(3,a)}function L(){i=this.value,n(0,i)}const C=()=>n(0,i="");return s.$$set=D=>{"schemes"in D&&n(7,r=D.schemes),"schemesToBeShown"in D&&n(1,o=D.schemesToBeShown),"filterText"in D&&n(0,i=D.filterText)},s.$$.update=()=>{s.$$.dirty&13&&$(i,l,a)},[i,o,l,a,u,c,f,r,p,b,L,C]}class Vn extends z{constructor(e){super(),G(this,e,Gn,zn,V,{schemes:7,schemesToBeShown:1,filterText:0})}}function jn(s){let e,n,t;return e=new $e({props:{color:F.bus_route_with_lane}}),{c(){_(e.$$.fragment),n=v(`
  Bus routes`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Kn(s){let e;return{c(){e=v(`GTFS
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function qn(s){let e;return{c(){e=v("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Zn(s){let e,n,t,r,o,i,u,l,c,a,f;return o=new U({props:{href:"https://gtfs.org",$$slots:{default:[Kn]},$$scope:{ctx:s}}}),a=new U({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[qn]},$$scope:{ctx:s}}}),{c(){e=B("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,n=N(),t=B("p"),r=v("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(o.$$.fragment),i=v(`, and doesn't include which routes are run or the
        frequency of service.`),u=N(),l=B("p"),c=v("License: "),_(a.$$.fragment)},m($,p){m($,e,p),m($,n,p),m($,t,p),S(t,r),w(o,t,null),S(t,i),m($,u,p),m($,l,p),S(l,c),w(a,l,null),f=!0},p($,p){const b={};p&8&&(b.$$scope={dirty:p,ctx:$}),o.$set(b);const L={};p&8&&(L.$$scope={dirty:p,ctx:$}),a.$set(L)},i($){f||(g(o.$$.fragment,$),g(a.$$.fragment,$),f=!0)},o($){d(o.$$.fragment,$),d(a.$$.fragment,$),f=!1},d($){$&&(h(e),h(n),h(t),h(u),h(l)),k(o),k(a)}}}function Yn(s){let e,n,t;return n=new ee({props:{$$slots:{default:[Zn]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&8&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Jn(s){let e,n,t,r,o;function i(l){s[1](l)}let u={id:Ae,$$slots:{right:[Yn],default:[jn]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:Ae,tooltip:Xn,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&8&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Ae="bus_routes";function Xn(s){return s.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Qn(s,e,n){let t;Z(s,X,i=>n(2,t=i)),fe(t,Ae,`https://atip.uk/layers/v1/${Ae}.pmtiles`),_e(t,{id:Ae,source:Ae,sourceLayer:Ae,color:["case",["boolean",["get","has_bus_lane"],!1],F.bus_route_with_lane,F.bus_route_without_lane],width:5,opacity:ue(.5,1)});let r=!1;function o(i){r=i,n(0,r)}return[r,o]}class er extends z{constructor(e){super(),G(this,e,Qn,Jn,V,{})}}function Tt(s,e,n){const t=s.slice();return t[2]=e[n],t}function Dt(s,e,n){const t=s.slice();return t[5]=e[n],t}function Nt(s){let e,n;return{c(){e=B("span"),n=v(` 
    `),be(e,"background",s[5]),be(e,"width","100%"),be(e,"border","1px solid black")},m(t,r){m(t,e,r),S(e,n)},p(t,r){r&1&&be(e,"background",t[5])},d(t){t&&h(e)}}}function At(s){let e,n=s[2]+"",t;return{c(){e=B("span"),t=v(n)},m(r,o){m(r,e,o),S(e,t)},p(r,o){o&2&&n!==(n=r[2]+"")&&ae(t,n)},d(r){r&&h(e)}}}function tr(s){let e,n,t,r=Ce(s[0]),o=[];for(let l=0;l<r.length;l+=1)o[l]=Nt(Dt(s,r,l));let i=Ce(s[1]),u=[];for(let l=0;l<i.length;l+=1)u[l]=At(Tt(s,i,l));return{c(){e=B("div");for(let l=0;l<o.length;l+=1)o[l].c();n=N(),t=B("div");for(let l=0;l<u.length;l+=1)u[l].c();be(e,"display","flex"),be(t,"display","flex"),be(t,"justify-content","space-between")},m(l,c){m(l,e,c);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);m(l,n,c),m(l,t,c);for(let a=0;a<u.length;a+=1)u[a]&&u[a].m(t,null)},p(l,[c]){if(c&1){r=Ce(l[0]);let a;for(a=0;a<r.length;a+=1){const f=Dt(l,r,a);o[a]?o[a].p(f,c):(o[a]=Nt(f),o[a].c(),o[a].m(e,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}if(c&2){i=Ce(l[1]);let a;for(a=0;a<i.length;a+=1){const f=Tt(l,i,a);u[a]?u[a].p(f,c):(u[a]=At(f),u[a].c(),u[a].m(t,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=i.length}},i:J,o:J,d(l){l&&(h(e),h(n),h(t)),qe(o,l),qe(u,l)}}}function nr(s,e,n){let{colorScale:t}=e,{limits:r}=e;return s.$$set=o=>{"colorScale"in o&&n(0,t=o.colorScale),"limits"in o&&n(1,r=o.limits)},[t,r]}class je extends z{constructor(e){super(),G(this,e,nr,tr,V,{colorScale:0,limits:1})}}function rr(s){let e;return{c(){e=v("Percent of households with a car")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function sr(s){let e;return{c(){e=v(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function or(s){let e;return{c(){e=v(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function lr(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ar(s){let e,n,t,r,o,i,u,l,c,a,f,$;return t=new U({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[sr]},$$scope:{ctx:s}}}),o=new U({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[or]},$$scope:{ctx:s}}}),a=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[lr]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Car/van availability data is from the 2021 census, via "),_(t.$$.fragment),r=v(". Output area boundaries from "),_(o.$$.fragment),i=v("."),u=N(),l=B("p"),c=v("License: "),_(a.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,b){m(p,e,b),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,u,b),m(p,l,b),S(l,c),w(a,l,null),S(l,f),$=!0},p(p,b){const L={};b&65536&&(L.$$scope={dirty:b,ctx:p}),t.$set(L);const C={};b&65536&&(C.$$scope={dirty:b,ctx:p}),o.$set(C);const D={};b&65536&&(D.$$scope={dirty:b,ctx:p}),a.$set(D)},i(p){$||(g(t.$$.fragment,p),g(o.$$.fragment,p),g(a.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(o.$$.fragment,p),d(a.$$.fragment,p),$=!1},d(p){p&&(h(e),h(u),h(l)),k(t),k(o),k(a)}}}function ir(s){let e,n,t;return n=new ee({props:{$$slots:{default:[ar]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&65536&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Bt(s){let e,n;return e=new je({props:{colorScale:s[4],limits:s[7]()}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:J,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function cr(s){let e;return{c(){e=v("Average cars per household")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function fr(s){let e;return{c(){e=v(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ur(s){let e;return{c(){e=v(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function $r(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function pr(s){let e,n,t,r,o,i,u,l,c,a,f,$,p,b;return o=new U({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[fr]},$$scope:{ctx:s}}}),u=new U({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[ur]},$$scope:{ctx:s}}}),$=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[$r]},$$scope:{ctx:s}}}),{c(){e=B("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,n=N(),t=B("p"),r=v("Car/van availability data is from the 2021 census, via "),_(o.$$.fragment),i=v(". Output area boundaries from "),_(u.$$.fragment),l=v("."),c=N(),a=B("p"),f=v("License: "),_($.$$.fragment),p=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(L,C){m(L,e,C),m(L,n,C),m(L,t,C),S(t,r),w(o,t,null),S(t,i),w(u,t,null),S(t,l),m(L,c,C),m(L,a,C),S(a,f),w($,a,null),S(a,p),b=!0},p(L,C){const D={};C&65536&&(D.$$scope={dirty:C,ctx:L}),o.$set(D);const y={};C&65536&&(y.$$scope={dirty:C,ctx:L}),u.$set(y);const T={};C&65536&&(T.$$scope={dirty:C,ctx:L}),$.$set(T)},i(L){b||(g(o.$$.fragment,L),g(u.$$.fragment,L),g($.$$.fragment,L),b=!0)},o(L){d(o.$$.fragment,L),d(u.$$.fragment,L),d($.$$.fragment,L),b=!1},d(L){L&&(h(e),h(n),h(t),h(c),h(a)),k(o),k(u),k($)}}}function mr(s){let e,n,t;return n=new ee({props:{$$slots:{default:[pr]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&65536&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ot(s){let e,n;return e=new je({props:{colorScale:s[4],limits:s[7]()}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:J,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function hr(s){let e;return{c(){e=v("Population density")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function gr(s){let e;return{c(){e=v(`NOMIS TS006
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function dr(s){let e;return{c(){e=v(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function _r(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function wr(s){let e,n,t,r,o,i,u,l,c,a,f,$;return t=new U({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[gr]},$$scope:{ctx:s}}}),o=new U({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[dr]},$$scope:{ctx:s}}}),a=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[_r]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Population density data is from the 2021 census, via "),_(t.$$.fragment),r=v(". Output area boundaries from "),_(o.$$.fragment),i=v("."),u=N(),l=B("p"),c=v("License: "),_(a.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,b){m(p,e,b),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,u,b),m(p,l,b),S(l,c),w(a,l,null),S(l,f),$=!0},p(p,b){const L={};b&65536&&(L.$$scope={dirty:b,ctx:p}),t.$set(L);const C={};b&65536&&(C.$$scope={dirty:b,ctx:p}),o.$set(C);const D={};b&65536&&(D.$$scope={dirty:b,ctx:p}),a.$set(D)},i(p){$||(g(t.$$.fragment,p),g(o.$$.fragment,p),g(a.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(o.$$.fragment,p),d(a.$$.fragment,p),$=!1},d(p){p&&(h(e),h(u),h(l)),k(t),k(o),k(a)}}}function kr(s){let e,n,t;return n=new ee({props:{$$slots:{default:[wr]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&65536&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Mt(s){let e,n,t,r;return t=new je({props:{colorScale:s[4],limits:s[7]().map(vr)}}),{c(){e=B("p"),e.textContent="(people per square kilometres)",n=N(),_(t.$$.fragment)},m(o,i){m(o,e,i),m(o,n,i),w(t,o,i),r=!0},p:J,i(o){r||(g(t.$$.fragment,o),r=!0)},o(o){d(t.$$.fragment,o),r=!1},d(o){o&&(h(e),h(n)),k(t,o)}}}function br(s){let e,n,t,r,o,i,u,l,c,a,f,$,p,b;function L(A){s[9](A)}let C={id:"percent_households_with_car",$$slots:{right:[ir],default:[rr]},$$scope:{ctx:s}};s[0]!==void 0&&(C.checked=s[0]),e=new Q({props:C}),j.push(()=>K(e,"checked",L)),e.$on("change",s[10]);let D=s[3]=="percent_households_with_car"&&Bt(s);function y(A){s[11](A)}let T={id:"average_cars_per_household",$$slots:{right:[mr],default:[cr]},$$scope:{ctx:s}};s[1]!==void 0&&(T.checked=s[1]),o=new Q({props:T}),j.push(()=>K(o,"checked",y)),o.$on("change",s[12]);let M=s[3]=="average_cars_per_household"&&Ot(s);function O(A){s[13](A)}let x={id:"population_density",$$slots:{right:[kr],default:[hr]},$$scope:{ctx:s}};s[2]!==void 0&&(x.checked=s[2]),c=new Q({props:x}),j.push(()=>K(c,"checked",O)),c.$on("change",s[14]);let P=s[3]=="population_density"&&Mt(s);return p=new Y({props:{layer:pe,tooltip:s[5],show:s[3]!="",clickable:!0}}),p.$on("click",s[6]),{c(){_(e.$$.fragment),t=N(),D&&D.c(),r=N(),_(o.$$.fragment),u=N(),M&&M.c(),l=N(),_(c.$$.fragment),f=N(),P&&P.c(),$=N(),_(p.$$.fragment)},m(A,H){w(e,A,H),m(A,t,H),D&&D.m(A,H),m(A,r,H),w(o,A,H),m(A,u,H),M&&M.m(A,H),m(A,l,H),w(c,A,H),m(A,f,H),P&&P.m(A,H),m(A,$,H),w(p,A,H),b=!0},p(A,[H]){const E={};H&65536&&(E.$$scope={dirty:H,ctx:A}),!n&&H&1&&(n=!0,E.checked=A[0],q(()=>n=!1)),e.$set(E),A[3]=="percent_households_with_car"?D?(D.p(A,H),H&8&&g(D,1)):(D=Bt(A),D.c(),g(D,1),D.m(r.parentNode,r)):D&&(ie(),d(D,1,1,()=>{D=null}),ce());const R={};H&65536&&(R.$$scope={dirty:H,ctx:A}),!i&&H&2&&(i=!0,R.checked=A[1],q(()=>i=!1)),o.$set(R),A[3]=="average_cars_per_household"?M?(M.p(A,H),H&8&&g(M,1)):(M=Ot(A),M.c(),g(M,1),M.m(l.parentNode,l)):M&&(ie(),d(M,1,1,()=>{M=null}),ce());const ve={};H&65536&&(ve.$$scope={dirty:H,ctx:A}),!a&&H&4&&(a=!0,ve.checked=A[2],q(()=>a=!1)),c.$set(ve),A[3]=="population_density"?P?(P.p(A,H),H&8&&g(P,1)):(P=Mt(A),P.c(),g(P,1),P.m($.parentNode,$)):P&&(ie(),d(P,1,1,()=>{P=null}),ce());const De={};H&8&&(De.show=A[3]!=""),p.$set(De)},i(A){b||(g(e.$$.fragment,A),g(D),g(o.$$.fragment,A),g(M),g(c.$$.fragment,A),g(P),g(p.$$.fragment,A),b=!0)},o(A){d(e.$$.fragment,A),d(D),d(o.$$.fragment,A),d(M),d(c.$$.fragment,A),d(P),d(p.$$.fragment,A),b=!1},d(A){A&&(h(t),h(r),h(u),h(l),h(f),h($)),k(e,A),D&&D.d(A),k(o,A),M&&M.d(A),k(c,A),P&&P.d(A),k(p,A)}}}let pe="census_output_areas";const vr=s=>s.toLocaleString();function yr(s,e,n){let t;Z(s,X,T=>n(8,t=T));let r=`${pe}-outline`,o=F.sequential_low_to_high,i=!1,u=!1,l=!1,c="";fe(t,pe,`https://atip.uk/layers/v1/${pe}.pmtiles`),Te(t,{id:pe,source:pe,sourceLayer:pe,color:"black",opacity:ue(.5,.7)}),_e(t,{id:r,source:pe,sourceLayer:pe,color:"black",width:.5});function a(T){let M=T.properties.OA21CD,O=T.properties[c];return c=="percent_households_with_car"?`<p>${O}% of households in ${M} have 1 or more cars</p>`:c=="average_cars_per_household"?`<p>Households in ${M} have an average of ${O} cars</p>`:`<p>There are ${O.toLocaleString()} people per square kilometre in ${M}</p>`}function f(T){let M=T.detail.properties.OA21CD;c=="percent_households_with_car"||c=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${M}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${M}`,"_blank")}function $(){return c=="percent_households_with_car"?[0,20,40,60,80,100]:c=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function p(T){i=T,n(0,i)}const b=()=>{n(1,u=!1),n(2,l=!1)};function L(T){u=T,n(1,u)}const C=()=>{n(0,i=!1),n(2,l=!1)};function D(T){l=T,n(2,l)}const y=()=>{n(0,i=!1),n(1,u=!1)};return s.$$.update=()=>{s.$$.dirty&271&&(i?n(3,c="percent_households_with_car"):u?n(3,c="average_cars_per_household"):l?n(3,c="population_density"):n(3,c=""),c?(t.setPaintProperty(pe,"fill-color",$t(["get",c],$(),o)),t.setLayoutProperty(r,"visibility","visible")):t.setLayoutProperty(r,"visibility","none"))},[i,u,l,c,o,a,f,$,t,p,b,L,C,D,y]}class Lr extends z{constructor(e){super(),G(this,e,yr,br,V,{})}}function Sr(s){let e,n,t;return e=new $e({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=v(`
  Combined authorities`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Cr(s){let e;return{c(){e=v(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Tr(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Dr(s){let e,n,t,r,o,i,u,l,c,a;return t=new U({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Cr]},$$scope:{ctx:s}}}),l=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Tr]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Data from "),_(t.$$.fragment),r=v(", as of December 2022."),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,u),w(l,i,null),S(i,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const b={};$&32&&(b.$$scope={dirty:$,ctx:f}),l.$set(b)},i(f){a||(g(t.$$.fragment,f),g(l.$$.fragment,f),a=!0)},o(f){d(t.$$.fragment,f),d(l.$$.fragment,f),a=!1},d(f){f&&(h(e),h(o),h(i)),k(t),k(l)}}}function Nr(s){let e,n,t;return n=new ee({props:{$$slots:{default:[Dr]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ar(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:ye,$$slots:{right:[Nr],default:[Sr]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:ye,tooltip:Br,show:s[0],clickable:!0}}),r.$on("click",Or),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let ye="combined_authorities";function Br(s){return`<p>${s.properties.name}</p>`}function Or(s){window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.CAUTH22CD}`,"_blank")}function Mr(s,e,n){let t;Z(s,X,l=>n(2,t=l));let r=F.combined_authorities,o=`${ye}-outline`;pt(t,ye,`https://atip.uk/layers/v1/${ye}.geojson`),Te(t,{id:ye,source:ye,color:r,opacity:ue(.5,.1)}),_e(t,{id:o,source:ye,color:r,width:2.5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Er extends z{constructor(e){super(),G(this,e,Mr,Ar,V,{})}}function Pr(s){let e,n,t;return e=new $e({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=v(`
  Cycle parking`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Hr(s){let e;return{c(){e=v("OpenStreetMap")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ur(s){let e;return{c(){e=v("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function xr(s){let e,n,t,r,o,i,u,l,c;return t=new U({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Hr]},$$scope:{ctx:s}}}),l=new U({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ur]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Cycle parking, according to "),_(t.$$.fragment),r=v(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&16&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&16&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(g(t.$$.fragment,a),g(l.$$.fragment,a),c=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),c=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function Wr(s){let e,n,t;return n=new ee({props:{$$slots:{default:[xr]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&16&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Fr(s){let e,n,t,r,o;function i(l){s[2](l)}let u={id:Be,$$slots:{right:[Wr],default:[Pr]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:Be,tooltip:Ir,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&16&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Be="cycle_parking";function Ir(s){return`<p>Capacity: ${s.properties.capacity??"unknown"}</p>`}function Rr(s,e,n){let t;Z(s,X,u=>n(3,t=u));let r=F.cycle_parking;fe(t,Be,`https://atip.uk/layers/v1/${Be}.pmtiles`),mt(t,{id:Be,source:Be,sourceLayer:Be,color:r,radius:5});let o=!1;function i(u){o=u,n(0,o)}return[o,r,i]}class zr extends z{constructor(e){super(),G(this,e,Rr,Fr,V,{})}}function Et(s,e,n){const t=s.slice();return t[4]=e[n][0],t[5]=e[n][1],t}function Gr(s){let e;return{c(){e=v("Cycle paths")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Vr(s){let e;return{c(){e=v("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function jr(s){let e,n,t,r,o,i,u,l,c,a;return c=new U({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Vr]},$$scope:{ctx:s}}}),{c(){e=B("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,n=N(),t=B("ul"),t.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,r=N(),o=B("p"),o.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,i=N(),u=B("p"),l=v("License: "),_(c.$$.fragment)},m(f,$){m(f,e,$),m(f,n,$),m(f,t,$),m(f,r,$),m(f,o,$),m(f,i,$),m(f,u,$),S(u,l),w(c,u,null),a=!0},p(f,$){const p={};$&256&&(p.$$scope={dirty:$,ctx:f}),c.$set(p)},i(f){a||(g(c.$$.fragment,f),a=!0)},o(f){d(c.$$.fragment,f),a=!1},d(f){f&&(h(e),h(n),h(t),h(r),h(o),h(i),h(u)),k(c)}}}function Kr(s){let e,n,t;return n=new ee({props:{$$slots:{default:[jr]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&256&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Pt(s){let e,n,t=Ce(s[1]),r=[];for(let i=0;i<t.length;i+=1)r[i]=Ht(Et(s,t,i));const o=i=>d(r[i],1,1,()=>{r[i]=null});return{c(){for(let i=0;i<r.length;i+=1)r[i].c();e=qt()},m(i,u){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,u);m(i,e,u),n=!0},p(i,u){if(u&2){t=Ce(i[1]);let l;for(l=0;l<t.length;l+=1){const c=Et(i,t,l);r[l]?(r[l].p(c,u),g(r[l],1)):(r[l]=Ht(c),r[l].c(),g(r[l],1),r[l].m(e.parentNode,e))}for(ie(),l=t.length;l<r.length;l+=1)o(l);ce()}},i(i){if(!n){for(let u=0;u<t.length;u+=1)g(r[u]);n=!0}},o(i){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)d(r[u]);n=!1},d(i){i&&h(e),qe(r,i)}}}function Ht(s){let e,n,t,r=s[4]+"",o,i,u;return n=new $e({props:{color:s[5]}}),{c(){e=B("div"),_(n.$$.fragment),t=N(),o=v(r),i=N()},m(l,c){m(l,e,c),w(n,e,null),S(e,t),S(e,o),S(e,i),u=!0},p:J,i(l){u||(g(n.$$.fragment,l),u=!0)},o(l){d(n.$$.fragment,l),u=!1},d(l){l&&h(e),k(n)}}}function qr(s){let e,n,t,r,o,i;function u(a){s[2](a)}let l={id:Oe,$$slots:{right:[Kr],default:[Gr]},$$scope:{ctx:s}};s[0]!==void 0&&(l.checked=s[0]),e=new Q({props:l}),j.push(()=>K(e,"checked",u));let c=s[0]&&Pt(s);return o=new Y({props:{layer:Oe,tooltip:Zr,show:s[0],clickable:!0}}),o.$on("click",Yr),{c(){_(e.$$.fragment),t=N(),c&&c.c(),r=N(),_(o.$$.fragment)},m(a,f){w(e,a,f),m(a,t,f),c&&c.m(a,f),m(a,r,f),w(o,a,f),i=!0},p(a,[f]){const $={};f&256&&($.$$scope={dirty:f,ctx:a}),!n&&f&1&&(n=!0,$.checked=a[0],q(()=>n=!1)),e.$set($),a[0]?c?(c.p(a,f),f&1&&g(c,1)):(c=Pt(a),c.c(),g(c,1),c.m(r.parentNode,r)):c&&(ie(),d(c,1,1,()=>{c=null}),ce());const p={};f&1&&(p.show=a[0]),o.$set(p)},i(a){i||(g(e.$$.fragment,a),g(c),g(o.$$.fragment,a),i=!0)},o(a){d(e.$$.fragment,a),d(c),d(o.$$.fragment,a),i=!1},d(a){a&&(h(t),h(r)),k(e,a),c&&c.d(a),k(o,a)}}}let Oe="cycle_paths";function Zr(s){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[s.properties.kind],n={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[s.properties.direction],t=s.properties.width=="unknown"?"unknown":`${s.properties.width} meters`,r=`<h2>${e}</h2>`;return r+=`<p>Direction: <b>${n} ${s.properties.direction}</b></p>`,r+=`<p>Width: <b>${t}</b></p>`,r}function Yr(s){window.open(`http://openstreetmap.org/way/${s.detail.properties.osm_id}`,"_blank")}function Jr(s,e,n){let t;Z(s,X,u=>n(3,t=u));let r=[["Separated tracks",F.cycle_paths.track],["Unprotected lanes",F.cycle_paths.lane],["Shared-use (segregated)",F.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",F.cycle_paths.shared_use_unsegregated]];fe(t,Oe,`https://atip.uk/layers/v1/${Oe}.pmtiles`),_e(t,{id:Oe,source:Oe,sourceLayer:Oe,color:Kt(["get","kind"],{track:F.cycle_paths.track,lane:F.cycle_paths.lane,shared_use_segregated:F.cycle_paths.shared_use_segregated,shared_use_unsegregated:F.cycle_paths.shared_use_unsegregated},"red"),width:["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20],opacity:ue(.5,1)});let o=!1;function i(u){o=u,n(0,o)}return[o,r,i]}class Xr extends z{constructor(e){super(),G(this,e,Jr,qr,V,{})}}function Qr(s){let e,n,t,r;return e=new $e({props:{color:s[3]}}),{c(){_(e.$$.fragment),n=N(),t=v(s[1])},m(o,i){w(e,o,i),m(o,n,i),m(o,t,i),r=!0},p(o,i){(!r||i&2)&&ae(t,o[1])},i(o){r||(g(e.$$.fragment,o),r=!0)},o(o){d(e.$$.fragment,o),r=!1},d(o){o&&(h(n),h(t)),k(e,o)}}}function es(s){let e;const n=s[6].default,t=at(n,s,s[8],null);return{c(){t&&t.c()},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&256)&&it(t,n,r,r[8],e?ft(n,r[8],o,null):ct(r[8]),null)},i(r){e||(g(t,r),e=!0)},o(r){d(t,r),e=!1},d(r){t&&t.d(r)}}}function ts(s){let e,n,t;return n=new ee({props:{$$slots:{default:[es]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&256&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function ns(s){let e,n,t,r,o;function i(l){s[7](l)}let u={id:s[0],$$slots:{right:[ts],default:[Qr]},$$scope:{ctx:s}};return s[2]!==void 0&&(u.checked=s[2]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:s[0],tooltip:s[4],show:s[2],clickable:!1}}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&1&&(a.id=l[0]),c&258&&(a.$$scope={dirty:c,ctx:l}),!n&&c&4&&(n=!0,a.checked=l[2],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.layer=l[0]),c&4&&(f.show=l[2]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function rs(s,e,n){let t;Z(s,X,p=>n(9,t=p));let{$$slots:r={},$$scope:o}=e,{name:i}=e,{singularNoun:u}=e,{pluralNoun:l}=e,c=F[i];fe(t,i,`https://atip.uk/layers/v1/${i}.pmtiles`),Te(t,{id:i,source:i,sourceLayer:i,color:c,opacity:ue(1,.7)});let a=!1;function f(p){return`<p>${p.properties.name??`Unnamed ${u}`}</p>`}function $(p){a=p,n(2,a)}return s.$$set=p=>{"name"in p&&n(0,i=p.name),"singularNoun"in p&&n(5,u=p.singularNoun),"pluralNoun"in p&&n(1,l=p.pluralNoun),"$$scope"in p&&n(8,o=p.$$scope)},[i,l,a,c,f,u,r,$,o]}class gt extends z{constructor(e){super(),G(this,e,rs,ns,V,{name:0,singularNoun:5,pluralNoun:1})}}function ss(s){let e;return{c(){e=v("hospital")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function os(s){let e;return{c(){e=v("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ls(s){let e,n,t,r,o,i,u,l,c;return t=new U({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[ss]},$$scope:{ctx:s}}}),l=new U({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[os]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("This shows "),_(t.$$.fragment),r=v(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(g(t.$$.fragment,a),g(l.$$.fragment,a),c=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),c=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function as(s){let e,n;return e=new gt({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[ls]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class is extends z{constructor(e){super(),G(this,e,null,as,V,{})}}function cs(s){let e;return{c(){e=v("Indices of Multiple Deprivation")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function fs(s){let e;return{c(){e=v(`DLUCH GIS
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function us(s){let e;return{c(){e=v(`here
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function $s(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ps(s){let e,n,t,r,o,i,u,l,c,a,f,$;return t=new U({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[fs]},$$scope:{ctx:s}}}),o=new U({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[us]},$$scope:{ctx:s}}}),a=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[$s]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("The 2019 English IMD scores come from "),_(t.$$.fragment),r=v(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(o.$$.fragment),i=v("."),u=N(),l=B("p"),c=v("License: "),_(a.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,b){m(p,e,b),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,u,b),m(p,l,b),S(l,c),w(a,l,null),S(l,f),$=!0},p(p,b){const L={};b&64&&(L.$$scope={dirty:b,ctx:p}),t.$set(L);const C={};b&64&&(C.$$scope={dirty:b,ctx:p}),o.$set(C);const D={};b&64&&(D.$$scope={dirty:b,ctx:p}),a.$set(D)},i(p){$||(g(t.$$.fragment,p),g(o.$$.fragment,p),g(a.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(o.$$.fragment,p),d(a.$$.fragment,p),$=!1},d(p){p&&(h(e),h(u),h(l)),k(t),k(o),k(a)}}}function ms(s){let e,n,t;return n=new ee({props:{$$slots:{default:[ps]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&64&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ut(s){let e,n;return e=new je({props:{colorScale:s[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:J,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function hs(s){let e,n,t,r,o,i;function u(a){s[3](a)}let l={id:me,$$slots:{right:[ms],default:[cs]},$$scope:{ctx:s}};s[0]!==void 0&&(l.checked=s[0]),e=new Q({props:l}),j.push(()=>K(e,"checked",u));let c=s[0]&&Ut(s);return o=new Y({props:{layer:me,tooltip:gs,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=N(),c&&c.c(),r=N(),_(o.$$.fragment)},m(a,f){w(e,a,f),m(a,t,f),c&&c.m(a,f),m(a,r,f),w(o,a,f),i=!0},p(a,[f]){const $={};f&64&&($.$$scope={dirty:f,ctx:a}),!n&&f&1&&(n=!0,$.checked=a[0],q(()=>n=!1)),e.$set($),a[0]?c?(c.p(a,f),f&1&&g(c,1)):(c=Ut(a),c.c(),g(c,1),c.m(r.parentNode,r)):c&&(ie(),d(c,1,1,()=>{c=null}),ce());const p={};f&1&&(p.show=a[0]),o.$set(p)},i(a){i||(g(e.$$.fragment,a),g(c),g(o.$$.fragment,a),i=!0)},o(a){d(e.$$.fragment,a),d(c),d(o.$$.fragment,a),i=!1},d(a){a&&(h(t),h(r)),k(e,a),c&&c.d(a),k(o,a)}}}let me="imd";function gs(s){return`<p>${s.properties.LSOA11CD} has an IMD score of <b>${s.properties.score}</b></p><p>Rank: <b>${s.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function ds(s,e,n){let t;Z(s,X,c=>n(2,t=c));let r=`${me}-outline`,o=F.sequential_low_to_high,i=[0,2,4,6,8,10];fe(t,me,`https://atip.uk/layers/v1/${me}.pmtiles`),Te(t,{id:me,source:me,sourceLayer:me,color:$t(["-",10,["get","decile"]],i,o),opacity:ue(.5,.7)}),_e(t,{id:r,source:me,sourceLayer:me,color:"black",width:.5});let u=!1;function l(c){u=c,n(0,u)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(r)&&t.setLayoutProperty(r,"visibility",u?"visible":"none")},[u,o,t,l]}class _s extends z{constructor(e){super(),G(this,e,ds,hs,V,{})}}function ws(s){let e,n,t;return e=new $e({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=v(`
  Local Authority Districts`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function ks(s){let e;return{c(){e=v(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function bs(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function vs(s){let e,n,t,r,o,i,u,l,c,a;return t=new U({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[ks]},$$scope:{ctx:s}}}),l=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[bs]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Data from "),_(t.$$.fragment),r=v(", as of May 2023."),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,u),w(l,i,null),S(i,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const b={};$&32&&(b.$$scope={dirty:$,ctx:f}),l.$set(b)},i(f){a||(g(t.$$.fragment,f),g(l.$$.fragment,f),a=!0)},o(f){d(t.$$.fragment,f),d(l.$$.fragment,f),a=!1},d(f){f&&(h(e),h(o),h(i)),k(t),k(l)}}}function ys(s){let e,n,t;return n=new ee({props:{$$slots:{default:[vs]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ls(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:Le,$$slots:{right:[ys],default:[ws]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:Le,tooltip:Ss,show:s[0],clickable:!0}}),r.$on("click",Cs),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Le="local_authority_districts";function Ss(s){return`<p>${s.properties.name}</p>`}function Cs(s){window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.LAD23CD}`,"_blank")}function Ts(s,e,n){let t;Z(s,X,l=>n(2,t=l));let r=F.local_authority_districts,o=`${Le}-outline`;pt(t,Le,`https://atip.uk/layers/v1/${Le}.geojson`),Te(t,{id:Le,source:Le,color:r,opacity:ue(.5,.1)}),_e(t,{id:o,source:Le,color:r,width:2.5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Ds extends z{constructor(e){super(),G(this,e,Ts,Ls,V,{})}}function Ns(s){let e,n,t;return e=new $e({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=v(`
  Local Planning Authorities`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function As(s){let e;return{c(){e=v(`local authority
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Bs(s){let e;return{c(){e=v(`national park authorit
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Os(s){let e;return{c(){e=v(`development corporation
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ms(s){let e;return{c(){e=v("this map")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Es(s){let e;return{c(){e=v(`planning.data.gov.uk
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ps(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Hs(s){let e,n,t,r,o,i,u,l,c,a,f,$,p,b,L,C,D,y,T,M,O,x,P,A,H;return t=new U({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[As]},$$scope:{ctx:s}}}),o=new U({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Bs]},$$scope:{ctx:s}}}),u=new U({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Os]},$$scope:{ctx:s}}}),p=new U({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Ms]},$$scope:{ctx:s}}}),y=new U({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Es]},$$scope:{ctx:s}}}),P=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ps]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("LPAs may be a "),_(t.$$.fragment),r=v(", "),_(o.$$.fragment),i=v("y, or "),_(u.$$.fragment),l=v("."),c=N(),a=B("p"),f=B("strong"),$=v(`Note there are overlapping LPAs near Northhamptonshire, shown in a
          darker shade. Only one authority name is shown when hovering. Use `),_(p.$$.fragment),b=v(" to get more details."),L=N(),C=B("p"),D=v("Data from ONS Geography via "),_(y.$$.fragment),T=v(", as of November 2022."),M=N(),O=B("p"),x=v("License: "),_(P.$$.fragment),A=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(E,R){m(E,e,R),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),w(u,e,null),S(e,l),m(E,c,R),m(E,a,R),S(a,f),S(f,$),w(p,f,null),S(f,b),m(E,L,R),m(E,C,R),S(C,D),w(y,C,null),S(C,T),m(E,M,R),m(E,O,R),S(O,x),w(P,O,null),S(O,A),H=!0},p(E,R){const ve={};R&32&&(ve.$$scope={dirty:R,ctx:E}),t.$set(ve);const De={};R&32&&(De.$$scope={dirty:R,ctx:E}),o.$set(De);const Fe={};R&32&&(Fe.$$scope={dirty:R,ctx:E}),u.$set(Fe);const we={};R&32&&(we.$$scope={dirty:R,ctx:E}),p.$set(we);const Ne={};R&32&&(Ne.$$scope={dirty:R,ctx:E}),y.$set(Ne);const Ie={};R&32&&(Ie.$$scope={dirty:R,ctx:E}),P.$set(Ie)},i(E){H||(g(t.$$.fragment,E),g(o.$$.fragment,E),g(u.$$.fragment,E),g(p.$$.fragment,E),g(y.$$.fragment,E),g(P.$$.fragment,E),H=!0)},o(E){d(t.$$.fragment,E),d(o.$$.fragment,E),d(u.$$.fragment,E),d(p.$$.fragment,E),d(y.$$.fragment,E),d(P.$$.fragment,E),H=!1},d(E){E&&(h(e),h(c),h(a),h(L),h(C),h(M),h(O)),k(t),k(o),k(u),k(p),k(y),k(P)}}}function Us(s){let e,n,t;return n=new ee({props:{$$slots:{default:[Hs]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function xs(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:he,$$slots:{right:[Us],default:[Ns]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:he,tooltip:Ws,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let he="local_planning_authorities";function Ws(s){return`<p>${s.properties.name}</p>`}function Fs(s,e,n){let t;Z(s,X,l=>n(2,t=l));let r=F.local_planning_authorities,o=`${he}-outline`;fe(t,he,`https://atip.uk/layers/v1/${he}.pmtiles`),Te(t,{id:he,source:he,sourceLayer:he,color:r,opacity:ue(.5,.1)}),_e(t,{id:o,source:he,sourceLayer:he,color:r,width:2.5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Is extends z{constructor(e){super(),G(this,e,Fs,xs,V,{})}}function Rs(s){let e,n,t;return e=new $e({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=v(`
  Major Road Network`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function zs(s){let e;return{c(){e=v(`Major Road Network
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Gs(s){let e;return{c(){e=v("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Vs(s){let e,n,t,r,o,i,u,l,c;return t=new U({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[zs]},$$scope:{ctx:s}}}),l=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Gs]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Data from the "),_(t.$$.fragment),r=v(", as of September 2021."),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&16&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&16&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(g(t.$$.fragment,a),g(l.$$.fragment,a),c=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),c=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function js(s){let e,n,t;return n=new ee({props:{$$slots:{default:[Vs]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&16&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ks(s){let e,n,t,r,o;function i(l){s[2](l)}let u={id:Me,$$slots:{right:[js],default:[Rs]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:Me,tooltip:qs,show:s[0],clickable:!1}}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&16&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Me="mrn";function qs(s){return`<p>${s.properties.name??"Unknown MRN road"}</p>`}function Zs(s,e,n){let t;Z(s,X,u=>n(3,t=u));let r=F.mrn;fe(t,Me,`https://atip.uk/layers/v1/${Me}.pmtiles`),_e(t,{id:Me,source:Me,sourceLayer:Me,color:r,width:7,opacity:ue(.5,1)});let o=!1;function i(u){o=u,n(0,o)}return[o,r,i]}class Ys extends z{constructor(e){super(),G(this,e,Zs,Ks,V,{})}}function Js(s){let e,n,t;return e=new $e({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=v(`
  Parliamentary constituencies`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Xs(s){let e;return{c(){e=v(`Ordnance Survey Boundary-Line
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Qs(s){let e;return{c(){e=v("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function eo(s){let e,n,t,r,o,i,u,l,c;return t=new U({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Xs]},$$scope:{ctx:s}}}),l=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Qs]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Data from "),_(t.$$.fragment),r=v(", as of May 2023."),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&32&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&32&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(g(t.$$.fragment,a),g(l.$$.fragment,a),c=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),c=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function to(s){let e,n,t;return n=new ee({props:{$$slots:{default:[eo]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function no(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:ge,$$slots:{right:[to],default:[Js]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:ge,tooltip:ro,show:s[0],clickable:!0}}),r.$on("click",so),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let ge="parliamentary_constituencies";function ro(s){return`<p>${s.properties.Name}</p>`}function so(s){let e=s.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function oo(s,e,n){let t;Z(s,X,l=>n(2,t=l));let r=F.parliamentary_constituencies,o=`${ge}-outline`;fe(t,ge,`https://atip.uk/layers/v1/${ge}.pmtiles`),Te(t,{id:ge,source:ge,sourceLayer:ge,color:r,opacity:ue(.5,.1)}),_e(t,{id:o,source:ge,sourceLayer:ge,color:r,width:5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class lo extends z{constructor(e){super(),G(this,e,oo,no,V,{})}}function ao(s){let e,n,t,r;return e=new $e({props:{color:s[3]}}),{c(){_(e.$$.fragment),n=N(),t=v(s[1])},m(o,i){w(e,o,i),m(o,n,i),m(o,t,i),r=!0},p(o,i){(!r||i&2)&&ae(t,o[1])},i(o){r||(g(e.$$.fragment,o),r=!0)},o(o){d(e.$$.fragment,o),r=!1},d(o){o&&(h(n),h(t)),k(e,o)}}}function io(s){let e;const n=s[7].default,t=at(n,s,s[9],null);return{c(){t&&t.c()},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&512)&&it(t,n,r,r[9],e?ft(n,r[9],o,null):ct(r[9]),null)},i(r){e||(g(t,r),e=!0)},o(r){d(t,r),e=!1},d(r){t&&t.d(r)}}}function co(s){let e,n,t;return n=new ee({props:{$$slots:{default:[io]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&512&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function fo(s){let e,n,t,r,o;function i(l){s[8](l)}let u={id:s[0],$$slots:{right:[co],default:[ao]},$$scope:{ctx:s}};return s[2]!==void 0&&(u.checked=s[2]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:s[0],tooltip:s[4],show:s[2],clickable:!1}}),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&1&&(a.id=l[0]),c&514&&(a.$$scope={dirty:c,ctx:l}),!n&&c&4&&(n=!0,a.checked=l[2],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.layer=l[0]),c&4&&(f.show=l[2]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function uo(s,e,n){let t;Z(s,X,b=>n(10,t=b));let{$$slots:r={},$$scope:o}=e,{name:i}=e,{singularNoun:u}=e,{pluralNoun:l}=e,{circleRadius:c}=e,a=F[i];pt(t,i,`https://atip.uk/layers/v1/${i}.geojson`),mt(t,{id:i,source:i,color:a,radius:c/2});let f=!1;function $(b){return`<p>${b.properties.name??`Unnamed ${u}`}</p>`}function p(b){f=b,n(2,f)}return s.$$set=b=>{"name"in b&&n(0,i=b.name),"singularNoun"in b&&n(5,u=b.singularNoun),"pluralNoun"in b&&n(1,l=b.pluralNoun),"circleRadius"in b&&n(6,c=b.circleRadius),"$$scope"in b&&n(9,o=b.$$scope)},[i,l,f,a,$,u,c,r,p,o]}class $o extends z{constructor(e){super(),G(this,e,uo,fo,V,{name:0,singularNoun:5,pluralNoun:1,circleRadius:6})}}function po(s){let e;return{c(){e=v("railway station")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function mo(s){let e;return{c(){e=v("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ho(s){let e,n,t,r,o,i,u,l,c;return t=new U({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[po]},$$scope:{ctx:s}}}),l=new U({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[mo]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("This shows "),_(t.$$.fragment),r=v(" data from OpenStreetMap (as of 9 August 2023)."),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(g(t.$$.fragment,a),g(l.$$.fragment,a),c=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),c=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function go(s){let e,n;return e=new $o({props:{name:_o,singularNoun:"railway station",pluralNoun:"Railway stations",circleRadius:Ln,$$slots:{default:[ho]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}const _o="railway_stations";class wo extends z{constructor(e){super(),G(this,e,null,go,V,{})}}function ko(s){let e;return{c(){e=v("primary and secondary schools")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function bo(s){let e;return{c(){e=v("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function vo(s){let e,n,t,r,o,i,u,l,c;return t=new U({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[ko]},$$scope:{ctx:s}}}),l=new U({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[bo]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("This shows "),_(t.$$.fragment),r=v(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(g(t.$$.fragment,a),g(l.$$.fragment,a),c=!0)},o(a){d(t.$$.fragment,a),d(l.$$.fragment,a),c=!1},d(a){a&&(h(e),h(o),h(i)),k(t),k(l)}}}function yo(s){let e,n;return e=new gt({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[vo]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class Lo extends z{constructor(e){super(),G(this,e,null,yo,V,{})}}function So(s){let e;return{c(){e=v("sports pitches")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Co(s){let e;return{c(){e=v("sports centres")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function To(s){let e;return{c(){e=v("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Do(s){let e,n,t,r,o,i,u,l,c,a,f;return t=new U({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[So]},$$scope:{ctx:s}}}),o=new U({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Co]},$$scope:{ctx:s}}}),a=new U({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[To]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("This shows "),_(t.$$.fragment),r=v(" and "),_(o.$$.fragment),i=v(" data from OpenStreetMap (as of 9 August 2023)."),u=N(),l=B("p"),c=v("License: "),_(a.$$.fragment)},m($,p){m($,e,p),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m($,u,p),m($,l,p),S(l,c),w(a,l,null),f=!0},p($,p){const b={};p&1&&(b.$$scope={dirty:p,ctx:$}),t.$set(b);const L={};p&1&&(L.$$scope={dirty:p,ctx:$}),o.$set(L);const C={};p&1&&(C.$$scope={dirty:p,ctx:$}),a.$set(C)},i($){f||(g(t.$$.fragment,$),g(o.$$.fragment,$),g(a.$$.fragment,$),f=!0)},o($){d(t.$$.fragment,$),d(o.$$.fragment,$),d(a.$$.fragment,$),f=!1},d($){$&&(h(e),h(u),h(l)),k(t),k(o),k(a)}}}function No(s){let e,n;return e=new gt({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Do]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class Ao extends z{constructor(e){super(),G(this,e,null,No,V,{})}}function Bo(s){let e;return{c(){e=v("Vehicle counts")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Oo(s){let e;return{c(){e=v(`DfT road statistics
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Mo(s){let e;return{c(){e=v("methodology")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Eo(s){let e;return{c(){e=v("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Po(s){let e,n,t,r,o,i,u,l,c,a,f,$,p;return t=new U({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[Oo]},$$scope:{ctx:s}}}),o=new U({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[Mo]},$$scope:{ctx:s}}}),$=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Eo]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("2022 AADF (annual average daily flow) data from "),_(t.$$.fragment),r=v(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(o.$$.fragment),i=v(" for details and caveats about the measurements."),u=N(),l=B("p"),l.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,c=N(),a=B("p"),f=v("License: "),_($.$$.fragment)},m(b,L){m(b,e,L),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(b,u,L),m(b,l,L),m(b,c,L),m(b,a,L),S(a,f),w($,a,null),p=!0},p(b,L){const C={};L&64&&(C.$$scope={dirty:L,ctx:b}),t.$set(C);const D={};L&64&&(D.$$scope={dirty:L,ctx:b}),o.$set(D);const y={};L&64&&(y.$$scope={dirty:L,ctx:b}),$.$set(y)},i(b){p||(g(t.$$.fragment,b),g(o.$$.fragment,b),g($.$$.fragment,b),p=!0)},o(b){d(t.$$.fragment,b),d(o.$$.fragment,b),d($.$$.fragment,b),p=!1},d(b){b&&(h(e),h(u),h(l),h(c),h(a)),k(t),k(o),k($)}}}function Ho(s){let e,n,t;return n=new ee({props:{$$slots:{default:[Po]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&64&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function xt(s){let e,n;return e=new je({props:{colorScale:s[1],limits:s[2]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:J,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Uo(s){let e,n,t,r,o,i;function u(a){s[3](a)}let l={id:Ee,$$slots:{right:[Ho],default:[Bo]},$$scope:{ctx:s}};s[0]!==void 0&&(l.checked=s[0]),e=new Q({props:l}),j.push(()=>K(e,"checked",u));let c=s[0]&&xt(s);return o=new Y({props:{layer:Ee,tooltip:xo,show:s[0],clickable:!0}}),o.$on("click",Wo),{c(){_(e.$$.fragment),t=N(),c&&c.c(),r=N(),_(o.$$.fragment)},m(a,f){w(e,a,f),m(a,t,f),c&&c.m(a,f),m(a,r,f),w(o,a,f),i=!0},p(a,[f]){const $={};f&64&&($.$$scope={dirty:f,ctx:a}),!n&&f&1&&(n=!0,$.checked=a[0],q(()=>n=!1)),e.$set($),a[0]?c?(c.p(a,f),f&1&&g(c,1)):(c=xt(a),c.c(),g(c,1),c.m(r.parentNode,r)):c&&(ie(),d(c,1,1,()=>{c=null}),ce());const p={};f&1&&(p.show=a[0]),o.$set(p)},i(a){i||(g(e.$$.fragment,a),g(c),g(o.$$.fragment,a),i=!0)},o(a){d(e.$$.fragment,a),d(c),d(o.$$.fragment,a),i=!1},d(a){a&&(h(t),h(r)),k(e,a),c&&c.d(a),k(o,a)}}}let Ee="vehicle_counts";function xo(s){let e=`<h2>${s.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${s.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${s.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${s.properties.method}</b></p>`,e}function Wo(s){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${s.detail.properties.count_point}`,"_blank")}function Fo(s,e,n){let t;Z(s,X,c=>n(4,t=c));let r=F.sequential_low_to_high,o=[0,4e4,8e4,12e4,16e4,205e3],i=["","40k","80k","120k","160k",""];fe(t,Ee,`https://atip.uk/layers/v1/${Ee}.pmtiles`),mt(t,{id:Ee,source:Ee,sourceLayer:Ee,color:$t(["get","motor_vehicles_2022"],o,r),opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});let u=!1;function l(c){u=c,n(0,u)}return[u,r,i,l]}class Io extends z{constructor(e){super(),G(this,e,Fo,Uo,V,{})}}function Ro(s){let e,n,t;return e=new $e({props:{color:s[1]}}),{c(){_(e.$$.fragment),n=v(`
  Wards`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:J,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function zo(s){let e;return{c(){e=v(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Go(s){let e;return{c(){e=v(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Vo(s){let e,n,t,r,o,i,u,l,c,a;return t=new U({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[zo]},$$scope:{ctx:s}}}),l=new U({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Go]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=v("Data from "),_(t.$$.fragment),r=v(", as of May 2023."),o=N(),i=B("p"),u=v("License: "),_(l.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,u),w(l,i,null),S(i,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const b={};$&32&&(b.$$scope={dirty:$,ctx:f}),l.$set(b)},i(f){a||(g(t.$$.fragment,f),g(l.$$.fragment,f),a=!0)},o(f){d(t.$$.fragment,f),d(l.$$.fragment,f),a=!1},d(f){f&&(h(e),h(o),h(i)),k(t),k(l)}}}function jo(s){let e,n,t;return n=new ee({props:{$$slots:{default:[Vo]},$$scope:{ctx:s}}}),{c(){e=B("span"),_(n.$$.fragment),I(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Ko(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:de,$$slots:{right:[jo],default:[Ro]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new Q({props:u}),j.push(()=>K(e,"checked",i)),r=new Y({props:{layer:de,tooltip:qo,show:s[0],clickable:!0}}),r.$on("click",Zo),{c(){_(e.$$.fragment),t=N(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(g(e.$$.fragment,l),g(r.$$.fragment,l),o=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),o=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let de="wards";function qo(s){return`<p>${s.properties.name}</p>`}function Zo(s){let e=encodeURIComponent(s.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Yo(s,e,n){let t;Z(s,X,l=>n(2,t=l));let r=F.wards,o=`${de}-outline`;fe(t,de,`https://atip.uk/layers/v1/${de}.pmtiles`),Te(t,{id:de,source:de,sourceLayer:de,color:r,opacity:ue(.5,.1)}),_e(t,{id:o,source:de,sourceLayer:de,color:r,width:2.5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Jo extends z{constructor(e){super(),G(this,e,Yo,Ko,V,{})}}function Xo(s){let e,n,t,r,o,i,u,l;return e=new Lo({}),t=new is({}),o=new Ao({}),u=new wo({}),{c(){_(e.$$.fragment),n=N(),_(t.$$.fragment),r=N(),_(o.$$.fragment),i=N(),_(u.$$.fragment)},m(c,a){w(e,c,a),m(c,n,a),w(t,c,a),m(c,r,a),w(o,c,a),m(c,i,a),w(u,c,a),l=!0},i(c){l||(g(e.$$.fragment,c),g(t.$$.fragment,c),g(o.$$.fragment,c),g(u.$$.fragment,c),l=!0)},o(c){d(e.$$.fragment,c),d(t.$$.fragment,c),d(o.$$.fragment,c),d(u.$$.fragment,c),l=!1},d(c){c&&(h(n),h(r),h(i)),k(e,c),k(t,c),k(o,c),k(u,c)}}}function Qo(s){let e,n;return e=new ht({props:{small:!0,$$slots:{default:[Xo]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&64&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function el(s){let e,n,t,r,o,i,u,l;return e=new Xr({}),t=new Ys({}),o=new er({}),u=new zr({}),{c(){_(e.$$.fragment),n=N(),_(t.$$.fragment),r=N(),_(o.$$.fragment),i=N(),_(u.$$.fragment)},m(c,a){w(e,c,a),m(c,n,a),w(t,c,a),m(c,r,a),w(o,c,a),m(c,i,a),w(u,c,a),l=!0},i(c){l||(g(e.$$.fragment,c),g(t.$$.fragment,c),g(o.$$.fragment,c),g(u.$$.fragment,c),l=!0)},o(c){d(e.$$.fragment,c),d(t.$$.fragment,c),d(o.$$.fragment,c),d(u.$$.fragment,c),l=!1},d(c){c&&(h(n),h(r),h(i)),k(e,c),k(t,c),k(o,c),k(u,c)}}}function tl(s){let e,n;return e=new ht({props:{small:!0,$$slots:{default:[el]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&64&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function nl(s){let e,n,t,r,o,i,u,l,c,a;return e=new lo({}),t=new Jo({}),o=new Er({}),u=new Ds({}),c=new Is({}),{c(){_(e.$$.fragment),n=N(),_(t.$$.fragment),r=N(),_(o.$$.fragment),i=N(),_(u.$$.fragment),l=N(),_(c.$$.fragment)},m(f,$){w(e,f,$),m(f,n,$),w(t,f,$),m(f,r,$),w(o,f,$),m(f,i,$),w(u,f,$),m(f,l,$),w(c,f,$),a=!0},i(f){a||(g(e.$$.fragment,f),g(t.$$.fragment,f),g(o.$$.fragment,f),g(u.$$.fragment,f),g(c.$$.fragment,f),a=!0)},o(f){d(e.$$.fragment,f),d(t.$$.fragment,f),d(o.$$.fragment,f),d(u.$$.fragment,f),d(c.$$.fragment,f),a=!1},d(f){f&&(h(n),h(r),h(i),h(l)),k(e,f),k(t,f),k(o,f),k(u,f),k(c,f)}}}function rl(s){let e,n;return e=new ht({props:{small:!0,$$slots:{default:[nl]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&64&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function sl(s){let e,n,t,r;return e=new Lr({}),t=new _s({}),{c(){_(e.$$.fragment),n=N(),_(t.$$.fragment)},m(o,i){w(e,o,i),m(o,n,i),w(t,o,i),r=!0},i(o){r||(g(e.$$.fragment,o),g(t.$$.fragment,o),r=!0)},o(o){d(e.$$.fragment,o),d(t.$$.fragment,o),r=!1},d(o){o&&h(n),k(e,o),k(t,o)}}}function ol(s){let e,n;return e=new Io({}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function ll(s){let e,n,t,r,o,i,u,l,c,a,f,$,p,b,L;e=new Se({props:{label:"Trip generators",$$slots:{default:[Qo]},$$scope:{ctx:s}}}),t=new Se({props:{label:"Existing infrastructure",$$slots:{default:[tl]},$$scope:{ctx:s}}}),o=new Se({props:{label:"Boundaries",$$slots:{default:[rl]},$$scope:{ctx:s}}}),u=new Se({props:{label:"Census",$$slots:{default:[sl]},$$scope:{ctx:s}}}),c=new Se({props:{label:"Other",$$slots:{default:[ol]},$$scope:{ctx:s}}});function C(y){s[5](y)}let D={displayEnableButton:!0};return s[2]!==void 0&&(D.isInactive=s[2]),f=new Sn({props:D}),s[4](f),j.push(()=>K(f,"isInactive",C)),b=new Cn({props:{style:s[0]}}),{c(){_(e.$$.fragment),n=N(),_(t.$$.fragment),r=N(),_(o.$$.fragment),i=N(),_(u.$$.fragment),l=N(),_(c.$$.fragment),a=N(),_(f.$$.fragment),p=N(),_(b.$$.fragment)},m(y,T){w(e,y,T),m(y,n,T),w(t,y,T),m(y,r,T),w(o,y,T),m(y,i,T),w(u,y,T),m(y,l,T),w(c,y,T),m(y,a,T),w(f,y,T),m(y,p,T),w(b,y,T),L=!0},p(y,T){const M={};T&64&&(M.$$scope={dirty:T,ctx:y}),e.$set(M);const O={};T&64&&(O.$$scope={dirty:T,ctx:y}),t.$set(O);const x={};T&64&&(x.$$scope={dirty:T,ctx:y}),o.$set(x);const P={};T&64&&(P.$$scope={dirty:T,ctx:y}),u.$set(P);const A={};T&64&&(A.$$scope={dirty:T,ctx:y}),c.$set(A);const H={};!$&&T&4&&($=!0,H.isInactive=y[2],q(()=>$=!1)),f.$set(H);const E={};T&1&&(E.style=y[0]),b.$set(E)},i(y){L||(g(e.$$.fragment,y),g(t.$$.fragment,y),g(o.$$.fragment,y),g(u.$$.fragment,y),g(c.$$.fragment,y),g(f.$$.fragment,y),g(b.$$.fragment,y),L=!0)},o(y){d(e.$$.fragment,y),d(t.$$.fragment,y),d(o.$$.fragment,y),d(u.$$.fragment,y),d(c.$$.fragment,y),d(f.$$.fragment,y),d(b.$$.fragment,y),L=!1},d(y){y&&(h(n),h(r),h(i),h(l),h(a),h(p)),k(e,y),k(t,y),k(o,y),k(u,y),k(c,y),s[4](null),k(f,y),k(b,y)}}}function al(s){let e,n,t,r;return e=new Se({props:{label:"Layers",open:!0,$$slots:{default:[ll]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(o,i){w(e,o,i),n=!0,t||(r=lt(window,"keydown",s[3]),t=!0)},p(o,[i]){const u={};i&71&&(u.$$scope={dirty:i,ctx:o}),e.$set(u)},i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){k(e,o),t=!1,r()}}}function il(s,e,n){let t;Z(s,Lt,c=>n(2,t=c));let{style:r}=e,o;function i(c){!t&&c.key=="Escape"&&(o.disableStreetView(),c.preventDefault())}function u(c){j[c?"unshift":"push"](()=>{o=c,n(1,o)})}function l(c){t=c,Lt.set(t)}return s.$$set=c=>{"style"in c&&n(0,r=c.style)},[r,o,t,i,u,l]}class cl extends z{constructor(e){super(),G(this,e,il,al,V,{style:0})}}function fl(s){let e;return{c(){e=v("Show on map")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ul(s){let e;return{c(){e=v("Edit scheme locally")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function $l(s){let e,n,t=s[0].authority_or_region+"",r,o,i,u,l=s[0].capital_scheme_id+"",c,a,f,$,p=s[0].funding_programme+"",b,L,C,D,y,T,M;return D=new nt({props:{$$slots:{default:[fl]},$$scope:{ctx:s}}}),D.$on("click",s[3]),T=new nt({props:{disabled:s[1],title:s[2],$$slots:{default:[ul]},$$scope:{ctx:s}}}),T.$on("click",s[4]),{c(){e=B("p"),n=v("Authority or region: "),r=v(t),o=N(),i=B("p"),u=v("Capital scheme ID: "),c=v(l),a=N(),f=B("p"),$=v("Funding programme: "),b=v(p),L=N(),C=B("div"),_(D.$$.fragment),y=N(),_(T.$$.fragment),I(C,"class","govuk-button-group")},m(O,x){m(O,e,x),S(e,n),S(e,r),m(O,o,x),m(O,i,x),S(i,u),S(i,c),m(O,a,x),m(O,f,x),S(f,$),S(f,b),m(O,L,x),m(O,C,x),w(D,C,null),S(C,y),w(T,C,null),M=!0},p(O,x){(!M||x&1)&&t!==(t=O[0].authority_or_region+"")&&ae(r,t),(!M||x&1)&&l!==(l=O[0].capital_scheme_id+"")&&ae(c,l),(!M||x&1)&&p!==(p=O[0].funding_programme+"")&&ae(b,p);const P={};x&256&&(P.$$scope={dirty:x,ctx:O}),D.$set(P);const A={};x&256&&(A.$$scope={dirty:x,ctx:O}),T.$set(A)},i(O){M||(g(D.$$.fragment,O),g(T.$$.fragment,O),M=!0)},o(O){d(D.$$.fragment,O),d(T.$$.fragment,O),M=!1},d(O){O&&(h(e),h(o),h(i),h(a),h(f),h(L),h(C)),k(D),k(T)}}}function pl(s){let e,n;return e=new Se({props:{label:`${s[0].scheme_reference}: ${s[0].num_features} features`,$$slots:{default:[$l]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),r&257&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function ml(s,e,n){let t,r;Z(s,We,f=>n(6,t=f)),Z(s,X,f=>n(7,r=f));let{scheme:o}=e,{authorityNames:i}=e,u=!i.has(o.authority_or_region),l=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function c(){let f={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==o.scheme_reference)};r==null||r.fitBounds(Zt(f),{padding:20,animate:!1})}function a(){let f={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==o.scheme_reference)},$=o.authority_or_region;window.localStorage.setItem($,JSON.stringify(f)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return s.$$set=f=>{"scheme"in f&&n(0,o=f.scheme),"authorityNames"in f&&n(5,i=f.authorityNames)},[o,u,l,c,a,i]}class hl extends z{constructor(e){super(),G(this,e,ml,pl,V,{scheme:0,authorityNames:5})}}var te=(s,e,n)=>new Promise((t,r)=>{var o=l=>{try{u(n.next(l))}catch(c){r(c)}},i=l=>{try{u(n.throw(l))}catch(c){r(c)}},u=l=>l.done?t(l.value):Promise.resolve(l.value).then(o,i);u((n=n.apply(s,e)).next())}),re=Uint8Array,Ue=Uint16Array,gl=Int32Array,Xt=new re([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Qt=new re([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),dl=new re([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),en=function(s,e){for(var n=new Ue(31),t=0;t<31;++t)n[t]=e+=1<<s[t-1];for(var r=new gl(n[30]),t=1;t<30;++t)for(var o=n[t];o<n[t+1];++o)r[o]=o-n[t]<<5|t;return{b:n,r}},tn=en(Xt,2),nn=tn.b,_l=tn.r;nn[28]=258,_l[258]=28;var wl=en(Qt,0),kl=wl.b,st=new Ue(32768);for(W=0;W<32768;++W)ke=(W&43690)>>1|(W&21845)<<1,ke=(ke&52428)>>2|(ke&13107)<<2,ke=(ke&61680)>>4|(ke&3855)<<4,st[W]=((ke&65280)>>8|(ke&255)<<8)>>1;var ke,W,Ve=function(s,e,n){for(var t=s.length,r=0,o=new Ue(e);r<t;++r)s[r]&&++o[s[r]-1];var i=new Ue(e);for(r=1;r<e;++r)i[r]=i[r-1]+o[r-1]<<1;var u;if(n){u=new Ue(1<<e);var l=15-e;for(r=0;r<t;++r)if(s[r])for(var c=r<<4|s[r],a=e-s[r],f=i[s[r]-1]++<<a,$=f|(1<<a)-1;f<=$;++f)u[st[f]>>l]=c}else for(u=new Ue(t),r=0;r<t;++r)s[r]&&(u[r]=st[i[s[r]-1]++]>>15-s[r]);return u},Ke=new re(288);for(W=0;W<144;++W)Ke[W]=8;var W;for(W=144;W<256;++W)Ke[W]=9;var W;for(W=256;W<280;++W)Ke[W]=7;var W;for(W=280;W<288;++W)Ke[W]=8;var W,rn=new re(32);for(W=0;W<32;++W)rn[W]=5;var W,bl=Ve(Ke,9,1),vl=Ve(rn,5,1),et=function(s){for(var e=s[0],n=1;n<s.length;++n)s[n]>e&&(e=s[n]);return e},oe=function(s,e,n){var t=e/8|0;return(s[t]|s[t+1]<<8)>>(e&7)&n},tt=function(s,e){var n=e/8|0;return(s[n]|s[n+1]<<8|s[n+2]<<16)>>(e&7)},yl=function(s){return(s+7)/8|0},Ll=function(s,e,n){(e==null||e<0)&&(e=0),(n==null||n>s.length)&&(n=s.length);var t=new re(n-e);return t.set(s.subarray(e,n)),t},Sl=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ne=function(s,e,n){var t=new Error(e||Sl[s]);if(t.code=s,Error.captureStackTrace&&Error.captureStackTrace(t,ne),!n)throw t;return t},dt=function(s,e,n,t){var r=s.length,o=t?t.length:0;if(!r||e.f&&!e.l)return n||new re(0);var i=!n||e.i!=2,u=e.i;n||(n=new re(r*3));var l=function(kt){var bt=n.length;if(kt>bt){var vt=new re(Math.max(bt*2,kt));vt.set(n),n=vt}},c=e.f||0,a=e.p||0,f=e.b||0,$=e.l,p=e.d,b=e.m,L=e.n,C=r*8;do{if(!$){c=oe(s,a,1);var D=oe(s,a+1,3);if(a+=3,D)if(D==1)$=bl,p=vl,b=9,L=5;else if(D==2){var O=oe(s,a,31)+257,x=oe(s,a+10,15)+4,P=O+oe(s,a+5,31)+1;a+=14;for(var A=new re(P),H=new re(19),E=0;E<x;++E)H[dl[E]]=oe(s,a+E*3,7);a+=x*3;for(var R=et(H),ve=(1<<R)-1,De=Ve(H,R,1),E=0;E<P;){var Fe=De[oe(s,a,ve)];a+=Fe&15;var y=Fe>>4;if(y<16)A[E++]=y;else{var we=0,Ne=0;for(y==16?(Ne=3+oe(s,a,3),a+=2,we=A[E-1]):y==17?(Ne=3+oe(s,a,7),a+=3):y==18&&(Ne=11+oe(s,a,127),a+=7);Ne--;)A[E++]=we}}var Ie=A.subarray(0,O),se=A.subarray(O);b=et(Ie),L=et(se),$=Ve(Ie,b,1),p=Ve(se,L,1)}else ne(1);else{var y=yl(a)+4,T=s[y-4]|s[y-3]<<8,M=y+T;if(M>r){u&&ne(0);break}i&&l(f+T),n.set(s.subarray(y,M),f),e.b=f+=T,e.p=a=M*8,e.f=c;continue}if(a>C){u&&ne(0);break}}i&&l(f+131072);for(var $n=(1<<b)-1,pn=(1<<L)-1,Ye=a;;Ye=a){var we=$[tt(s,a)&$n],Pe=we>>4;if(a+=we&15,a>C){u&&ne(0);break}if(we||ne(2),Pe<256)n[f++]=Pe;else if(Pe==256){Ye=a,$=null;break}else{var _t=Pe-254;if(Pe>264){var E=Pe-257,Re=Xt[E];_t=oe(s,a,(1<<Re)-1)+nn[E],a+=Re}var Je=p[tt(s,a)&pn],Xe=Je>>4;Je||ne(3),a+=Je&15;var se=kl[Xe];if(Xe>3){var Re=Qt[Xe];se+=tt(s,a)&(1<<Re)-1,a+=Re}if(a>C){u&&ne(0);break}i&&l(f+131072);var Qe=f+_t;if(f<se){var wt=o-se,mn=Math.min(se,Qe);for(wt+f<0&&ne(3);f<mn;++f)n[f]=t[wt+f]}for(;f<Qe;f+=4)n[f]=n[f-se],n[f+1]=n[f+1-se],n[f+2]=n[f+2-se],n[f+3]=n[f+3-se];f=Qe}}e.l=$,e.p=Ye,e.b=f,e.f=c,$&&(c=1,e.m=b,e.d=p,e.n=L)}while(!c);return f==n.length?n:Ll(n,0,f)},Cl=new re(0),Tl=function(s){(s[0]!=31||s[1]!=139||s[2]!=8)&&ne(6,"invalid gzip data");var e=s[3],n=10;e&4&&(n+=(s[10]|s[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!s[n++]);return n+(e&2)},Dl=function(s){var e=s.length;return(s[e-4]|s[e-3]<<8|s[e-2]<<16|s[e-1]<<24)>>>0},Nl=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&ne(6,"invalid zlib data"),(s[1]>>5&1)==+!e&&ne(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function Al(s,e){return dt(s,{i:2},e&&e.out,e&&e.dictionary)}function Bl(s,e){var n=Tl(s);return n+8>s.length&&ne(6,"invalid gzip data"),dt(s.subarray(n,-8),{i:2},e&&e.out||new re(Dl(s)),e&&e.dictionary)}function Ol(s,e){return dt(s.subarray(Nl(s,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function ot(s,e){return s[0]==31&&s[1]==139&&s[2]==8?Bl(s,e):(s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31?Al(s,e):Ol(s,e)}var Ml=typeof TextDecoder<"u"&&new TextDecoder,El=0;try{Ml.decode(Cl,{stream:!0}),El=1}catch{}var sn=(s,e)=>s*Math.pow(2,e),ze=(s,e)=>Math.floor(s/Math.pow(2,e)),Ze=(s,e)=>sn(s.getUint16(e+1,!0),8)+s.getUint8(e),on=(s,e)=>sn(s.getUint32(e+2,!0),16)+s.getUint16(e,!0),Pl=(s,e,n,t,r)=>{if(s!=t.getUint8(r))return s-t.getUint8(r);const o=Ze(t,r+1);if(e!=o)return e-o;const i=Ze(t,r+4);return n!=i?n-i:0},Hl=(s,e,n,t)=>{const r=ln(s,e|128,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!0}:null},Wt=(s,e,n,t)=>{const r=ln(s,e,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!1}:null},ln=(s,e,n,t)=>{let r=0,o=s.byteLength/17-1;for(;r<=o;){const i=o+r>>1,u=Pl(e,n,t,s,i*17);if(u>0)r=i+1;else if(u<0)o=i-1;else return[on(s,i*17+7),s.getUint32(i*17+13,!0)]}return null},Ul=(s,e)=>s.is_dir&&!e.is_dir?1:!s.is_dir&&e.is_dir?-1:s.z!==e.z?s.z-e.z:s.x!==e.x?s.x-e.x:s.y-e.y,an=(s,e)=>{const n=s.getUint8(e*17);return{z:n&127,x:Ze(s,e*17+1),y:Ze(s,e*17+4),offset:on(s,e*17+7),length:s.getUint32(e*17+13,!0),is_dir:n>>7===1}},Ft=s=>{const e=[],n=new DataView(s);for(let t=0;t<n.byteLength/17;t++)e.push(an(n,t));return xl(e)},xl=s=>{s.sort(Ul);const e=new ArrayBuffer(17*s.length),n=new Uint8Array(e);for(let t=0;t<s.length;t++){const r=s[t];let o=r.z;r.is_dir&&(o=o|128),n[t*17]=o,n[t*17+1]=r.x&255,n[t*17+2]=r.x>>8&255,n[t*17+3]=r.x>>16&255,n[t*17+4]=r.y&255,n[t*17+5]=r.y>>8&255,n[t*17+6]=r.y>>16&255,n[t*17+7]=r.offset&255,n[t*17+8]=ze(r.offset,8)&255,n[t*17+9]=ze(r.offset,16)&255,n[t*17+10]=ze(r.offset,24)&255,n[t*17+11]=ze(r.offset,32)&255,n[t*17+12]=ze(r.offset,48)&255,n[t*17+13]=r.length&255,n[t*17+14]=r.length>>8&255,n[t*17+15]=r.length>>16&255,n[t*17+16]=r.length>>24&255}return e},Wl=(s,e)=>{if(s.byteLength<17)return null;const n=s.byteLength/17,t=an(s,n-1);if(t.is_dir){const r=t.z,o=e.z-r,i=Math.trunc(e.x/(1<<o)),u=Math.trunc(e.y/(1<<o));return{z:r,x:i,y:u}}return null};function Fl(s){return te(this,null,function*(){const e=yield s.getBytes(0,512e3),n=new DataView(e.data),t=n.getUint32(4,!0),r=n.getUint16(8,!0),o=new TextDecoder("utf-8"),i=JSON.parse(o.decode(new DataView(e.data,10,t)));let u=0;i.compression==="gzip"&&(u=2);let l=0;"minzoom"in i&&(l=+i.minzoom);let c=0;"maxzoom"in i&&(c=+i.maxzoom);let a=0,f=0,$=0,p=-180,b=-85,L=180,C=85;if(i.bounds){const y=i.bounds.split(",");p=+y[0],b=+y[1],L=+y[2],C=+y[3]}if(i.center){const y=i.center.split(",");a=+y[0],f=+y[1],$=+y[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:l,maxZoom:c,minLon:p,minLat:b,maxLon:L,maxLat:C,centerZoom:$,centerLon:a,centerLat:f,etag:e.etag}})}function Il(s,e,n,t,r,o,i){return te(this,null,function*(){let u=yield n.getArrayBuffer(e,s.rootDirectoryOffset,s.rootDirectoryLength,s);s.specVersion===1&&(u=Ft(u));const l=Wt(new DataView(u),t,r,o);if(l){let f=(yield e.getBytes(l.offset,l.length,i)).data;const $=new DataView(f);return $.getUint8(0)==31&&$.getUint8(1)==139&&(f=ot(new Uint8Array(f))),{data:f}}const c=Wl(new DataView(u),{z:t,x:r,y:o});if(c){const a=Hl(new DataView(u),c.z,c.x,c.y);if(a){let f=yield n.getArrayBuffer(e,a.offset,a.length,s);s.specVersion===1&&(f=Ft(f));const $=Wt(new DataView(f),t,r,o);if($){let b=(yield e.getBytes($.offset,$.length,i)).data;const L=new DataView(b);return L.getUint8(0)==31&&L.getUint8(1)==139&&(b=ot(new Uint8Array(b))),{data:b}}}}})}var cn={getHeader:Fl,getZxy:Il},Rl=class{constructor(){this.tile=(s,e)=>{if(s.type=="json"){const n=s.url.substr(10);let t=this.tiles.get(n);return t||(t=new It(n),this.tiles.set(n,t)),t.getHeader().then(r=>{const o={tiles:[s.url+"/{z}/{x}/{y}"],minzoom:r.minZoom,maxzoom:r.maxZoom,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat]};e(null,o,null,null)}).catch(r=>{e(r,null,null,null)}),{cancel:()=>{}}}else{const n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=s.url.match(n);if(!t)throw new Error("Invalid PMTiles protocol URL");const r=t[1];let o=this.tiles.get(r);o||(o=new It(r),this.tiles.set(r,o));const i=t[2],u=t[3],l=t[4],c=new AbortController,a=c.signal;let f=()=>{c.abort()};return o.getHeader().then($=>{o.getZxy(+i,+u,+l,a).then(p=>{p?e(null,new Uint8Array(p.data),p.cacheControl,p.expires):$.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(p=>{p.name!=="AbortError"&&e(p,null,null,null)})}),{cancel:f}}},this.tiles=new Map}add(s){this.tiles.set(s.source.getKey(),s)}get(s){return this.tiles.get(s)}};function He(s,e){return(e>>>0)*4294967296+(s>>>0)}function zl(s,e){const n=e.buf;let t,r;if(r=n[e.pos++],t=(r&112)>>4,r<128||(r=n[e.pos++],t|=(r&127)<<3,r<128)||(r=n[e.pos++],t|=(r&127)<<10,r<128)||(r=n[e.pos++],t|=(r&127)<<17,r<128)||(r=n[e.pos++],t|=(r&127)<<24,r<128)||(r=n[e.pos++],t|=(r&1)<<31,r<128))return He(s,t);throw new Error("Expected varint not more than 10 bytes")}function Ge(s){const e=s.buf;let n,t;return t=e[s.pos++],n=t&127,t<128||(t=e[s.pos++],n|=(t&127)<<7,t<128)||(t=e[s.pos++],n|=(t&127)<<14,t<128)||(t=e[s.pos++],n|=(t&127)<<21,t<128)?n:(t=e[s.pos],n|=(t&15)<<28,zl(n,s))}function Gl(s,e,n,t){if(t==0){n==1&&(e[0]=s-1-e[0],e[1]=s-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}var Vl=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function jl(s,e,n){if(s>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,s)-1||n>Math.pow(2,s)-1)throw Error("tile x/y outside zoom level bounds");const t=Vl[s],r=Math.pow(2,s);let o=0,i=0,u=0;const l=[e,n];let c=r/2;for(;c>0;)o=(l[0]&c)>0?1:0,i=(l[1]&c)>0?1:0,u+=c*c*(3*o^i),Gl(c,l,o,i),c=c/2;return t+u}function fn(s,e){return te(this,null,function*(){if(e===1||e===0)return s;if(e===2){if(typeof globalThis.DecompressionStream>"u")return ot(new Uint8Array(s));{let t=new Response(s).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var Kl=127;function ql(s,e){let n=0,t=s.length-1;for(;n<=t;){const r=t+n>>1,o=e-s[r].tileId;if(o>0)n=r+1;else if(o<0)t=r-1;else return s[r]}return t>=0&&(s[t].runLength===0||e-s[t].tileId<s[t].runLength)?s[t]:null}var Zl=class{constructor(s){this.url=s}getKey(){return this.url}getBytes(s,e,n){return te(this,null,function*(){let t;n||(t=new AbortController,n=t.signal);let r=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+s+"-"+(s+e-1)}});if(r.status===416&&s===0){const u=r.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const l=+u.substr(8);r=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(l-1)}})}if(r.status>=300)throw Error("Bad response code: "+r.status);const o=r.headers.get("Content-Length");if(r.status===200&&(!o||+o>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield r.arrayBuffer(),etag:r.headers.get("ETag")||void 0,cacheControl:r.headers.get("Cache-Control")||void 0,expires:r.headers.get("Expires")||void 0}})}};function le(s,e){const n=s.getUint32(e+4,!0),t=s.getUint32(e+0,!0);return n*Math.pow(2,32)+t}function Yl(s,e){const n=new DataView(s),t=n.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:le(n,8),rootDirectoryLength:le(n,16),jsonMetadataOffset:le(n,24),jsonMetadataLength:le(n,32),leafDirectoryOffset:le(n,40),leafDirectoryLength:le(n,48),tileDataOffset:le(n,56),tileDataLength:le(n,64),numAddressedTiles:le(n,72),numTileEntries:le(n,80),numTileContents:le(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function un(s){const e={buf:new Uint8Array(s),pos:0},n=Ge(e),t=[];let r=0;for(let o=0;o<n;o++){const i=Ge(e);t.push({tileId:r+i,offset:0,length:0,runLength:1}),r+=i}for(let o=0;o<n;o++)t[o].runLength=Ge(e);for(let o=0;o<n;o++)t[o].length=Ge(e);for(let o=0;o<n;o++){const i=Ge(e);i===0&&o>0?t[o].offset=t[o-1].offset+t[o-1].length:t[o].offset=i-1}return t}function Jl(s){const e=new DataView(s);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var xe=class extends Error{};function Xl(s,e,n,t){return te(this,null,function*(){const r=yield s.getBytes(0,16384);if(new DataView(r.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Jl(r.data)<3)return[yield cn.getHeader(s)];const i=r.data.slice(0,Kl);let u=r.etag;t&&r.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+s.getKey()),u=void 0);const l=Yl(i,u);if(n){const c=r.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),a=s.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,f=un(yield e(c,l.internalCompression));return[l,[a,f.length,f]]}return[l,void 0]})}function Ql(s,e,n,t,r){return te(this,null,function*(){const o=yield s.getBytes(n,t);if(r.etag&&r.etag!==o.etag)throw new xe(o.etag);const i=yield e(o.data,r.internalCompression),u=un(i);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var ea=class{constructor(s=100,e=!0,n=fn){this.cache=new Map,this.maxCacheEntries=s,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(s,e){return te(this,null,function*(){const n=s.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const t=new Promise((r,o)=>{Xl(s,this.decompress,this.prefetch,e).then(i=>{i[1]&&this.cache.set(i[1][0],{lastUsed:this.counter++,data:Promise.resolve(i[1][2])}),r(i[0]),this.prune()}).catch(i=>{o(i)})});return this.cache.set(n,{lastUsed:this.counter++,data:t}),t})}getDirectory(s,e,n,t){return te(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const o=new Promise((i,u)=>{Ql(s,this.decompress,e,n,t).then(l=>{i(l),this.prune()}).catch(l=>{u(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(s,e,n,t){return te(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const o=new Promise((i,u)=>{s.getBytes(e,n).then(l=>{if(t.etag&&t.etag!==l.etag)throw new xe(l.etag);i(l.data),this.cache.has(r),this.prune()}).catch(l=>{u(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let s=1/0,e;this.cache.forEach((n,t)=>{n.lastUsed<s&&(s=n.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(s,e){return te(this,null,function*(){this.cache.delete(s.getKey()),yield this.getHeader(s,e)})}},It=class{constructor(s,e,n){typeof s=="string"?this.source=new Zl(s):this.source=s,n?this.decompress=n:this.decompress=fn,e?this.cache=e:this.cache=new ea}getHeader(){return te(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(s,e,n,t){return te(this,null,function*(){const r=jl(s,e,n),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return cn.getZxy(o,this.source,this.cache,s,e,n,t);if(s<o.minZoom||s>o.maxZoom)return;let i=o.rootDirectoryOffset,u=o.rootDirectoryLength;for(let l=0;l<=3;l++){const c=yield this.cache.getDirectory(this.source,i,u,o),a=ql(c,r);if(a)if(a.runLength>0){const f=yield this.source.getBytes(o.tileDataOffset+a.offset,a.length,t);if(o.etag&&o.etag!==f.etag)throw new xe(f.etag);return{data:yield this.decompress(f.data,o.tileCompression),cacheControl:f.cacheControl,expires:f.expires}}else i=o.leafDirectoryOffset+a.offset,u=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(s,e,n,t){return te(this,null,function*(){try{return yield this.getZxyAttempt(s,e,n,t)}catch(r){if(r instanceof xe)return this.cache.invalidate(this.source,r.message),yield this.getZxyAttempt(s,e,n,t);throw r}})}getMetadataAttempt(){return te(this,null,function*(){const s=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(s.jsonMetadataOffset,s.jsonMetadataLength);if(s.etag&&s.etag!==e.etag)throw new xe(e.etag);const n=yield this.decompress(e.data,s.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(n))})}getMetadata(){return te(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(s){if(s instanceof xe)return this.cache.invalidate(this.source,s.message),yield this.getMetadataAttempt();throw s}})}};function ta(s){return ut(()=>{let e=new Rl;St.addProtocol("pmtiles",e.tile)}),Yt(()=>{St.removeProtocol("pmtiles")}),[]}class na extends z{constructor(e){super(),G(this,e,ta,null,V,{})}}function Rt(s,e,n){const t=s.slice();return t[14]=e[n],t}function zt(s){let e,n;return e=new vn({props:{errorMessage:s[0]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&1&&(o.errorMessage=t[0]),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Gt(s){let e,n,t,r;function o(l){s[9](l)}function i(l){s[10](l)}let u={schemes:s[1]};return s[2]!==void 0&&(u.schemesToBeShown=s[2]),s[3]!==void 0&&(u.filterText=s[3]),e=new Vn({props:u}),j.push(()=>K(e,"schemesToBeShown",o)),j.push(()=>K(e,"filterText",i)),{c(){_(e.$$.fragment)},m(l,c){w(e,l,c),r=!0},p(l,c){const a={};c&2&&(a.schemes=l[1]),!n&&c&4&&(n=!0,a.schemesToBeShown=l[2],q(()=>n=!1)),!t&&c&8&&(t=!0,a.filterText=l[3],q(()=>t=!1)),e.$set(a)},i(l){r||(g(e.$$.fragment,l),r=!0)},o(l){d(e.$$.fragment,l),r=!1},d(l){k(e,l)}}}function Vt(s){let e,n;return e=new hl({props:{scheme:s[14],authorityNames:s[5]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&2&&(o.scheme=t[14]),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function jt(s){let e=s[2].has(s[14].scheme_reference),n,t,r=e&&Vt(s);return{c(){r&&r.c(),n=qt()},m(o,i){r&&r.m(o,i),m(o,n,i),t=!0},p(o,i){i&6&&(e=o[2].has(o[14].scheme_reference)),e?r?(r.p(o,i),i&6&&g(r,1)):(r=Vt(o),r.c(),g(r,1),r.m(n.parentNode,n)):r&&(ie(),d(r,1,1,()=>{r=null}),ce())},i(o){t||(g(r),t=!0)},o(o){d(r),t=!1},d(o){o&&h(n),r&&r.d(o)}}}function ra(s){let e,n,t,r,o,i,u,l,c,a,f,$;o=new Dn({props:{boundaryGeojson:s[4]}});let p=s[0]&&zt(s);l=new _n({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:s[7]}});let b=s[1].size>0&&Gt(s),L=Ce(s[1].values()),C=[];for(let y=0;y<L.length;y+=1)C[y]=jt(Rt(s,L,y));const D=y=>d(C[y],1,1,()=>{C[y]=null});return{c(){e=B("div"),n=B("div"),t=B("h1"),t.textContent="Browse schemes",r=N(),_(o.$$.fragment),i=N(),p&&p.c(),u=N(),_(l.$$.fragment),c=N(),b&&b.c(),a=N(),f=B("ul");for(let y=0;y<C.length;y+=1)C[y].c();be(n,"display","flex"),be(n,"justify-content","space-between"),I(e,"slot","sidebar"),I(e,"class","govuk-prose")},m(y,T){m(y,e,T),S(e,n),S(n,t),S(n,r),w(o,n,null),S(e,i),p&&p.m(e,null),S(e,u),w(l,e,null),S(e,c),b&&b.m(e,null),S(e,a),S(e,f);for(let M=0;M<C.length;M+=1)C[M]&&C[M].m(f,null);$=!0},p(y,T){const M={};if(T&16&&(M.boundaryGeojson=y[4]),o.$set(M),y[0]?p?(p.p(y,T),T&1&&g(p,1)):(p=zt(y),p.c(),g(p,1),p.m(e,u)):p&&(ie(),d(p,1,1,()=>{p=null}),ce()),y[1].size>0?b?(b.p(y,T),T&2&&g(b,1)):(b=Gt(y),b.c(),g(b,1),b.m(e,a)):b&&(ie(),d(b,1,1,()=>{b=null}),ce()),T&38){L=Ce(y[1].values());let O;for(O=0;O<L.length;O+=1){const x=Rt(y,L,O);C[O]?(C[O].p(x,T),g(C[O],1)):(C[O]=jt(x),C[O].c(),g(C[O],1),C[O].m(f,null))}for(ie(),O=L.length;O<C.length;O+=1)D(O);ce()}},i(y){if(!$){g(o.$$.fragment,y),g(p),g(l.$$.fragment,y),g(b);for(let T=0;T<L.length;T+=1)g(C[T]);$=!0}},o(y){d(o.$$.fragment,y),d(p),d(l.$$.fragment,y),d(b),C=C.filter(Boolean);for(let T=0;T<C.length;T+=1)d(C[T]);$=!1},d(y){y&&h(e),k(o),p&&p.d(),k(l),b&&b.d(),qe(C,y)}}}function sa(s){let e,n,t,r,o,i,u,l,c,a,f;return e=new An({props:{colorInterventions:Jt("v1")}}),t=new Y({props:{layer:"interventions-points",tooltip:s[8],clickable:!1}}),o=new Y({props:{layer:"interventions-lines",tooltip:s[8],clickable:!1}}),u=new Y({props:{layer:"interventions-polygons",tooltip:s[8],clickable:!1}}),a=new cl({props:{style:s[6]}}),{c(){_(e.$$.fragment),n=N(),_(t.$$.fragment),r=N(),_(o.$$.fragment),i=N(),_(u.$$.fragment),l=N(),c=B("div"),_(a.$$.fragment),I(c,"class","top-right svelte-u44ed2")},m($,p){w(e,$,p),m($,n,p),w(t,$,p),m($,r,p),w(o,$,p),m($,i,p),w(u,$,p),m($,l,p),m($,c,p),w(a,c,null),f=!0},p:J,i($){f||(g(e.$$.fragment,$),g(t.$$.fragment,$),g(o.$$.fragment,$),g(u.$$.fragment,$),g(a.$$.fragment,$),f=!0)},o($){d(e.$$.fragment,$),d(t.$$.fragment,$),d(o.$$.fragment,$),d(u.$$.fragment,$),d(a.$$.fragment,$),f=!1},d($){$&&(h(n),h(r),h(i),h(l),h(c)),k(e,$),k(t,$),k(o,$),k(u,$),k(a)}}}function oa(s){let e,n,t,r,o;return n=new na({}),r=new Nn({props:{style:s[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[sa]},$$scope:{ctx:s}}}),{c(){e=B("div"),_(n.$$.fragment),t=N(),_(r.$$.fragment),I(e,"slot","main")},m(i,u){m(i,e,u),w(n,e,null),S(e,t),w(r,e,null),o=!0},p(i,u){const l={};u&131072&&(l.$$scope={dirty:u,ctx:i}),r.$set(l)},i(i){o||(g(n.$$.fragment,i),g(r.$$.fragment,i),o=!0)},o(i){d(n.$$.fragment,i),d(r.$$.fragment,i),o=!1},d(i){i&&h(e),k(n),k(r)}}}function la(s){let e,n;return e=new Tn({props:{$$slots:{main:[oa],sidebar:[ra]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&131103&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function aa(s,e,n){let t,r;Z(s,X,D=>n(11,t=D)),Z(s,We,D=>n(4,r=D));let o=new Set(Pn);ut(()=>{wn()});let u=new URLSearchParams(window.location.search).get("style")||"dataviz",l="",c=new Map,a=new Set,f="";Yt(()=>{We.set(kn())});function $(D){try{let y=JSON.parse(D);n(1,c=Hn(y)),We.set(y),n(0,l=""),t==null||t.fitBounds(Zt(y),{padding:20,animate:!1})}catch(y){n(0,l=`Couldn't load schemes from a file: ${y}`)}}function p(D){let y=D.properties;var T='<div style="max-width: 30vw;">';return T+=`<h2>${b(y.name)} (${y.intervention_type})</h2>`,T+=`<p>Scheme reference: ${y.scheme_reference}</p>`,y.length_meters&&(T+=`<p>Length: ${bn(y.length_meters)}</p>`),y.description&&(T+=`<p>${b(y.description)}</p>`),T+="</div>",T}function b(D){return f?D.replace(new RegExp(f,"gi"),y=>`<mark>${y}</mark>`):D}function L(D){a=D,n(2,a)}function C(D){f=D,n(3,f)}return[l,c,a,f,r,o,u,$,p,L,C]}class ia extends z{constructor(e){super(),G(this,e,aa,la,V,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new ia({target:document.getElementById("app")});
