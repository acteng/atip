var Ds=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Rn=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var gt=(n,e,t)=>(Ds(n,e,"access private method"),t);import{S as ke,i as Te,s as Ce,x as ve,y as ct,f as Y,z as $t,g as A,h as I,B as ht,C as Re,p as x,D as Fe,E as ot,t as ge,F as Be,G as Hn,H as le,e as R,I as Ze,J as T,l as Q,r as pt,K as Il,L as fn,c as q,n as j,M as rt,o as V,N as it,O as Us,d as de,m as he,q as pe,P as js,Q as Si,R as dn,T as _t,U as bt,V as vt,W as yt,X as Bs,Y as Dr,Z as Cn,_ as Ur,$ as He,b as ze,a0 as Ml,a1 as vo,a2 as Gs,j as Tn,a3 as zs,a as st,k as at,a4 as Sr,a5 as Vs,a6 as ri,a7 as ki,a8 as yo,w as Ti,a9 as wo,aa as qs,ab as Js,ac as Eo,ad as Ys,ae as Fn,af as Ws,A as Hs,u as Zs}from"./authorities-5c9306e4.js";function So(n){let e,t;return{c(){e=ct("title"),t=ge(n[1])},m(r,o){A(r,e,o),I(e,t)},p(r,o){o&2&&Be(t,r[1])},d(r){r&&x(e)}}}function Xs(n){let e,t,r=n[1]&&So(n),o=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],l={};for(let s=0;s<o.length;s+=1)l=ve(l,o[s]);return{c(){e=ct("svg"),r&&r.c(),t=ct("path"),Y(t,"d","M22 16L12 26 10.6 24.6 19.2 16 10.6 7.4 12 6z"),$t(e,l)},m(s,u){A(s,e,u),r&&r.m(e,null),I(e,t)},p(s,[u]){s[1]?r?r.p(s,u):(r=So(s),r.c(),r.m(e,t)):r&&(r.d(1),r=null),$t(e,l=ht(o,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},u&1&&{width:s[0]},u&1&&{height:s[0]},u&4&&s[2],u&8&&s[3]]))},i:Re,o:Re,d(s){s&&x(e),r&&r.d()}}}function Ks(n,e,t){let r,o;const l=["size","title"];let s=Fe(e,l),{size:u=16}=e,{title:f=void 0}=e;return n.$$set=c=>{t(5,e=ve(ve({},e),ot(c))),t(3,s=Fe(e,l)),"size"in c&&t(0,u=c.size),"title"in c&&t(1,f=c.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||f),t(2,o={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=ot(e),[u,f,o,s,r]}class Qs extends ke{constructor(e){super(),Te(this,e,Ks,Xs,Ce,{size:0,title:1})}}const Ci=Qs;function ko(n,e,t){const r=n.slice();return r[2]=e[t].width,r}function $s(n){let e,t,r,o,l=[n[4],{style:t="width: "+n[2]+";"+n[4].style}],s={};for(let u=0;u<l.length;u+=1)s=ve(s,l[u]);return{c(){e=R("p"),Ze(e,s),T(e,"bx--skeleton__text",!0),T(e,"bx--skeleton__heading",n[0])},m(u,f){A(u,e,f),r||(o=[Q(e,"click",n[12]),Q(e,"mouseover",n[13]),Q(e,"mouseenter",n[14]),Q(e,"mouseleave",n[15])],r=!0)},p(u,f){Ze(e,s=ht(l,[f&16&&u[4],f&20&&t!==(t="width: "+u[2]+";"+u[4].style)&&{style:t}])),T(e,"bx--skeleton__text",!0),T(e,"bx--skeleton__heading",u[0])},d(u){u&&x(e),r=!1,pt(o)}}}function ea(n){let e,t,r,o=n[3],l=[];for(let f=0;f<o.length;f+=1)l[f]=To(ko(n,o,f));let s=[n[4]],u={};for(let f=0;f<s.length;f+=1)u=ve(u,s[f]);return{c(){e=R("div");for(let f=0;f<l.length;f+=1)l[f].c();Ze(e,u)},m(f,c){A(f,e,c);for(let p=0;p<l.length;p+=1)l[p].m(e,null);t||(r=[Q(e,"click",n[8]),Q(e,"mouseover",n[9]),Q(e,"mouseenter",n[10]),Q(e,"mouseleave",n[11])],t=!0)},p(f,c){if(c&9){o=f[3];let p;for(p=0;p<o.length;p+=1){const v=ko(f,o,p);l[p]?l[p].p(v,c):(l[p]=To(v),l[p].c(),l[p].m(e,null))}for(;p<l.length;p+=1)l[p].d(1);l.length=o.length}Ze(e,u=ht(s,[c&16&&f[4]]))},d(f){f&&x(e),Il(l,f),t=!1,pt(r)}}}function To(n){let e;return{c(){e=R("p"),fn(e,"width",n[2]),T(e,"bx--skeleton__text",!0),T(e,"bx--skeleton__heading",n[0])},m(t,r){A(t,e,r)},p(t,r){r&8&&fn(e,"width",t[2]),r&1&&T(e,"bx--skeleton__heading",t[0])},d(t){t&&x(e)}}}function ta(n){let e;function t(l,s){return l[1]?ea:$s}let r=t(n),o=r(n);return{c(){o.c(),e=Hn()},m(l,s){o.m(l,s),A(l,e,s)},p(l,[s]){r===(r=t(l))&&o?o.p(l,s):(o.d(1),o=r(l),o&&(o.c(),o.m(e.parentNode,e)))},i:Re,o:Re,d(l){o.d(l),l&&x(e)}}}function na(n,e,t){let r,o,l;const s=["lines","heading","paragraph","width"];let u=Fe(e,s),{lines:f=3}=e,{heading:c=!1}=e,{paragraph:p=!1}=e,{width:v="100%"}=e;const m=[.973,.153,.567];function h(N){le.call(this,n,N)}function g(N){le.call(this,n,N)}function b(N){le.call(this,n,N)}function C(N){le.call(this,n,N)}function B(N){le.call(this,n,N)}function M(N){le.call(this,n,N)}function k(N){le.call(this,n,N)}function P(N){le.call(this,n,N)}return n.$$set=N=>{e=ve(ve({},e),ot(N)),t(4,u=Fe(e,s)),"lines"in N&&t(5,f=N.lines),"heading"in N&&t(0,c=N.heading),"paragraph"in N&&t(1,p=N.paragraph),"width"in N&&t(2,v=N.width)},n.$$.update=()=>{if(n.$$.dirty&4&&t(7,o=parseInt(v,10)),n.$$.dirty&4&&t(6,l=v.includes("px")),n.$$.dirty&238&&p)for(let N=0;N<f;N++){const D=l?o-75:0,me=l?o:75,G=Math.floor(m[N%3]*(me-D+1))+D+"px";t(3,r=[...r,{width:l?G:`calc(${v} - ${G})`}])}},t(3,r=[]),[c,p,v,r,u,f,l,o,h,g,b,C,B,M,k,P]}class ra extends ke{constructor(e){super(),Te(this,e,na,ta,Ce,{lines:5,heading:0,paragraph:1,width:2})}}const jn=ra;function Co(n,e,t){const r=n.slice();return r[9]=e[t],r}function Oo(n){let e,t,r,o,l,s,u,f,c,p,v,m,h;return r=new Ci({props:{class:"bx--accordion__arrow"}}),l=new jn({props:{class:"bx--accordion__title"}}),f=new jn({props:{width:"90%"}}),p=new jn({props:{width:"80%"}}),m=new jn({props:{width:"95%"}}),{c(){e=R("li"),t=R("span"),de(r.$$.fragment),o=q(),de(l.$$.fragment),s=q(),u=R("div"),de(f.$$.fragment),c=q(),de(p.$$.fragment),v=q(),de(m.$$.fragment),T(t,"bx--accordion__heading",!0),T(u,"bx--accordion__content",!0),T(e,"bx--accordion__item",!0),T(e,"bx--accordion__item--active",!0)},m(g,b){A(g,e,b),I(e,t),he(r,t,null),I(t,o),he(l,t,null),I(e,s),I(e,u),he(f,u,null),I(u,c),he(p,u,null),I(u,v),he(m,u,null),h=!0},i(g){h||(j(r.$$.fragment,g),j(l.$$.fragment,g),j(f.$$.fragment,g),j(p.$$.fragment,g),j(m.$$.fragment,g),h=!0)},o(g){V(r.$$.fragment,g),V(l.$$.fragment,g),V(f.$$.fragment,g),V(p.$$.fragment,g),V(m.$$.fragment,g),h=!1},d(g){g&&x(e),pe(r),pe(l),pe(f),pe(p),pe(m)}}}function Io(n,e){let t,r,o,l,s,u,f;return o=new Ci({props:{class:"bx--accordion__arrow"}}),s=new jn({props:{class:"bx--accordion__title"}}),{key:n,first:null,c(){t=R("li"),r=R("span"),de(o.$$.fragment),l=q(),de(s.$$.fragment),u=q(),T(r,"bx--accordion__heading",!0),T(t,"bx--accordion__item",!0),this.first=t},m(c,p){A(c,t,p),I(t,r),he(o,r,null),I(r,l),he(s,r,null),I(t,u),f=!0},p(c,p){},i(c){f||(j(o.$$.fragment,c),j(s.$$.fragment,c),f=!0)},o(c){V(o.$$.fragment,c),V(s.$$.fragment,c),f=!1},d(c){c&&x(t),pe(o),pe(s)}}}function ia(n){let e,t,r=[],o=new Map,l,s,u,f=n[3]&&Oo(),c=Array.from({length:n[3]?n[0]-1:n[0]},Mo);const p=h=>h[9];for(let h=0;h<c.length;h+=1){let g=Co(n,c,h),b=p(g);o.set(b,r[h]=Io(b))}let v=[n[4]],m={};for(let h=0;h<v.length;h+=1)m=ve(m,v[h]);return{c(){e=R("ul"),f&&f.c(),t=q();for(let h=0;h<r.length;h+=1)r[h].c();Ze(e,m),T(e,"bx--skeleton",!0),T(e,"bx--accordion",!0),T(e,"bx--accordion--start",n[1]==="start"),T(e,"bx--accordion--end",n[1]==="end"),T(e,"bx--accordion--sm",n[2]==="sm"),T(e,"bx--accordion--xl",n[2]==="xl")},m(h,g){A(h,e,g),f&&f.m(e,null),I(e,t);for(let b=0;b<r.length;b+=1)r[b].m(e,null);l=!0,s||(u=[Q(e,"click",n[5]),Q(e,"mouseover",n[6]),Q(e,"mouseenter",n[7]),Q(e,"mouseleave",n[8])],s=!0)},p(h,[g]){h[3]?f?g&8&&j(f,1):(f=Oo(),f.c(),j(f,1),f.m(e,t)):f&&(rt(),V(f,1,1,()=>{f=null}),it()),g&9&&(c=Array.from({length:h[3]?h[0]-1:h[0]},Mo),rt(),r=Us(r,g,p,1,h,c,o,e,js,Io,null,Co),it()),Ze(e,m=ht(v,[g&16&&h[4]])),T(e,"bx--skeleton",!0),T(e,"bx--accordion",!0),T(e,"bx--accordion--start",h[1]==="start"),T(e,"bx--accordion--end",h[1]==="end"),T(e,"bx--accordion--sm",h[2]==="sm"),T(e,"bx--accordion--xl",h[2]==="xl")},i(h){if(!l){j(f);for(let g=0;g<c.length;g+=1)j(r[g]);l=!0}},o(h){V(f);for(let g=0;g<r.length;g+=1)V(r[g]);l=!1},d(h){h&&x(e),f&&f.d();for(let g=0;g<r.length;g+=1)r[g].d();s=!1,pt(u)}}}const Mo=(n,e)=>e;function oa(n,e,t){const r=["count","align","size","open"];let o=Fe(e,r),{count:l=4}=e,{align:s="end"}=e,{size:u=void 0}=e,{open:f=!0}=e;function c(h){le.call(this,n,h)}function p(h){le.call(this,n,h)}function v(h){le.call(this,n,h)}function m(h){le.call(this,n,h)}return n.$$set=h=>{e=ve(ve({},e),ot(h)),t(4,o=Fe(e,r)),"count"in h&&t(0,l=h.count),"align"in h&&t(1,s=h.align),"size"in h&&t(2,u=h.size),"open"in h&&t(3,f=h.open)},[l,s,u,f,o,c,p,v,m]}class la extends ke{constructor(e){super(),Te(this,e,oa,ia,Ce,{count:0,align:1,size:2,open:3})}}const sa=la;function aa(n){let e,t,r,o;const l=n[6].default,s=_t(l,n,n[5],null);let u=[n[3]],f={};for(let c=0;c<u.length;c+=1)f=ve(f,u[c]);return{c(){e=R("ul"),s&&s.c(),Ze(e,f),T(e,"bx--accordion",!0),T(e,"bx--accordion--start",n[0]==="start"),T(e,"bx--accordion--end",n[0]==="end"),T(e,"bx--accordion--sm",n[1]==="sm"),T(e,"bx--accordion--xl",n[1]==="xl")},m(c,p){A(c,e,p),s&&s.m(e,null),t=!0,r||(o=[Q(e,"click",n[7]),Q(e,"mouseover",n[8]),Q(e,"mouseenter",n[9]),Q(e,"mouseleave",n[10])],r=!0)},p(c,p){s&&s.p&&(!t||p&32)&&bt(s,l,c,c[5],t?yt(l,c[5],p,null):vt(c[5]),null),Ze(e,f=ht(u,[p&8&&c[3]])),T(e,"bx--accordion",!0),T(e,"bx--accordion--start",c[0]==="start"),T(e,"bx--accordion--end",c[0]==="end"),T(e,"bx--accordion--sm",c[1]==="sm"),T(e,"bx--accordion--xl",c[1]==="xl")},i(c){t||(j(s,c),t=!0)},o(c){V(s,c),t=!1},d(c){c&&x(e),s&&s.d(c),r=!1,pt(o)}}}function ua(n){let e,t;const r=[n[3],{align:n[0]},{size:n[1]}];let o={};for(let l=0;l<r.length;l+=1)o=ve(o,r[l]);return e=new sa({props:o}),e.$on("click",n[11]),e.$on("mouseover",n[12]),e.$on("mouseenter",n[13]),e.$on("mouseleave",n[14]),{c(){de(e.$$.fragment)},m(l,s){he(e,l,s),t=!0},p(l,s){const u=s&11?ht(r,[s&8&&Bs(l[3]),s&1&&{align:l[0]},s&2&&{size:l[1]}]):{};e.$set(u)},i(l){t||(j(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){pe(e,l)}}}function fa(n){let e,t,r,o;const l=[ua,aa],s=[];function u(f,c){return f[2]?0:1}return e=u(n),t=s[e]=l[e](n),{c(){t.c(),r=Hn()},m(f,c){s[e].m(f,c),A(f,r,c),o=!0},p(f,[c]){let p=e;e=u(f),e===p?s[e].p(f,c):(rt(),V(s[p],1,1,()=>{s[p]=null}),it(),t=s[e],t?t.p(f,c):(t=s[e]=l[e](f),t.c()),j(t,1),t.m(r.parentNode,r))},i(f){o||(j(t),o=!0)},o(f){V(t),o=!1},d(f){s[e].d(f),f&&x(r)}}}function ca(n,e,t){const r=["align","size","disabled","skeleton"];let o=Fe(e,r),{$$slots:l={},$$scope:s}=e,{align:u="end"}=e,{size:f=void 0}=e,{disabled:c=!1}=e,{skeleton:p=!1}=e;const v=dn(c);Si("Accordion",{disableItems:v});function m(P){le.call(this,n,P)}function h(P){le.call(this,n,P)}function g(P){le.call(this,n,P)}function b(P){le.call(this,n,P)}function C(P){le.call(this,n,P)}function B(P){le.call(this,n,P)}function M(P){le.call(this,n,P)}function k(P){le.call(this,n,P)}return n.$$set=P=>{e=ve(ve({},e),ot(P)),t(3,o=Fe(e,r)),"align"in P&&t(0,u=P.align),"size"in P&&t(1,f=P.size),"disabled"in P&&t(4,c=P.disabled),"skeleton"in P&&t(2,p=P.skeleton),"$$scope"in P&&t(5,s=P.$$scope)},n.$$.update=()=>{n.$$.dirty&16&&v.set(c)},[u,f,p,o,c,s,l,m,h,g,b,C,B,M,k]}class da extends ke{constructor(e){super(),Te(this,e,ca,fa,Ce,{align:0,size:1,disabled:4,skeleton:2})}}const ha=da,pa=n=>({}),Lo=n=>({});function ga(n){let e;return{c(){e=ge(n[2])},m(t,r){A(t,e,r)},p(t,r){r&4&&Be(e,t[2])},d(t){t&&x(e)}}}function ma(n){let e,t,r,o,l,s,u,f,c,p;r=new Ci({props:{class:"bx--accordion__arrow","aria-label":n[3]}});const v=n[7].title,m=_t(v,n,n[6],Lo),h=m||ga(n),g=n[7].default,b=_t(g,n,n[6],null);let C=[n[5]],B={};for(let M=0;M<C.length;M+=1)B=ve(B,C[M]);return{c(){e=R("li"),t=R("button"),de(r.$$.fragment),o=q(),l=R("div"),h&&h.c(),s=q(),u=R("div"),b&&b.c(),T(l,"bx--accordion__title",!0),Y(t,"type","button"),Y(t,"title",n[3]),Y(t,"aria-expanded",n[0]),t.disabled=n[1],T(t,"bx--accordion__heading",!0),T(u,"bx--accordion__content",!0),Ze(e,B),T(e,"bx--accordion__item",!0),T(e,"bx--accordion__item--active",n[0]),T(e,"bx--accordion__item--disabled",n[1]),T(e,"bx--accordion__item--expanding",n[4]==="expanding"),T(e,"bx--accordion__item--collapsing",n[4]==="collapsing")},m(M,k){A(M,e,k),I(e,t),he(r,t,null),I(t,o),I(t,l),h&&h.m(l,null),I(e,s),I(e,u),b&&b.m(u,null),f=!0,c||(p=[Q(t,"click",n[9]),Q(t,"click",n[14]),Q(t,"mouseover",n[10]),Q(t,"mouseenter",n[11]),Q(t,"mouseleave",n[12]),Q(t,"keydown",n[13]),Q(t,"keydown",n[15]),Q(e,"animationend",n[8]),Q(e,"animationend",n[16])],c=!0)},p(M,[k]){const P={};k&8&&(P["aria-label"]=M[3]),r.$set(P),m?m.p&&(!f||k&64)&&bt(m,v,M,M[6],f?yt(v,M[6],k,pa):vt(M[6]),Lo):h&&h.p&&(!f||k&4)&&h.p(M,f?k:-1),(!f||k&8)&&Y(t,"title",M[3]),(!f||k&1)&&Y(t,"aria-expanded",M[0]),(!f||k&2)&&(t.disabled=M[1]),b&&b.p&&(!f||k&64)&&bt(b,g,M,M[6],f?yt(g,M[6],k,null):vt(M[6]),null),Ze(e,B=ht(C,[k&32&&M[5]])),T(e,"bx--accordion__item",!0),T(e,"bx--accordion__item--active",M[0]),T(e,"bx--accordion__item--disabled",M[1]),T(e,"bx--accordion__item--expanding",M[4]==="expanding"),T(e,"bx--accordion__item--collapsing",M[4]==="collapsing")},i(M){f||(j(r.$$.fragment,M),j(h,M),j(b,M),f=!0)},o(M){V(r.$$.fragment,M),V(h,M),V(b,M),f=!1},d(M){M&&x(e),pe(r),h&&h.d(M),b&&b.d(M),c=!1,pt(p)}}}function _a(n,e,t){const r=["title","open","disabled","iconDescription"];let o=Fe(e,r),{$$slots:l={},$$scope:s}=e,{title:u="title"}=e,{open:f=!1}=e,{disabled:c=!1}=e,{iconDescription:p="Expand/Collapse"}=e,v=c;const h=Dr("Accordion").disableItems.subscribe(G=>{!G&&v||t(1,c=G)});let g;Cn(()=>()=>{h()});function b(G){le.call(this,n,G)}function C(G){le.call(this,n,G)}function B(G){le.call(this,n,G)}function M(G){le.call(this,n,G)}function k(G){le.call(this,n,G)}function P(G){le.call(this,n,G)}const N=()=>{t(0,f=!f),t(4,g=f?"expanding":"collapsing")},D=({key:G})=>{f&&G==="Escape"&&t(0,f=!1)},me=()=>{t(4,g=void 0)};return n.$$set=G=>{e=ve(ve({},e),ot(G)),t(5,o=Fe(e,r)),"title"in G&&t(2,u=G.title),"open"in G&&t(0,f=G.open),"disabled"in G&&t(1,c=G.disabled),"iconDescription"in G&&t(3,p=G.iconDescription),"$$scope"in G&&t(6,s=G.$$scope)},[f,c,u,p,g,o,s,l,b,C,B,M,k,P,N,D,me]}class ba extends ke{constructor(e){super(),Te(this,e,_a,ma,Ce,{title:2,open:0,disabled:1,iconDescription:3})}}const va=ba;function Po(n){let e,t;return{c(){e=ct("title"),t=ge(n[1])},m(r,o){A(r,e,o),I(e,t)},p(r,o){o&2&&Be(t,r[1])},d(r){r&&x(e)}}}function ya(n){let e,t,r,o=n[1]&&Po(n),l=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],s={};for(let u=0;u<l.length;u+=1)s=ve(s,l[u]);return{c(){e=ct("svg"),o&&o.c(),t=ct("path"),r=ct("path"),Y(t,"d","M16,2C8.3,2,2,8.3,2,16s6.3,14,14,14s14-6.3,14-14C30,8.3,23.7,2,16,2z M14.9,8h2.2v11h-2.2V8z M16,25	c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22c0.8,0,1.5,0.7,1.5,1.5S16.8,25,16,25z"),Y(r,"fill","none"),Y(r,"d","M17.5,23.5c0,0.8-0.7,1.5-1.5,1.5c-0.8,0-1.5-0.7-1.5-1.5S15.2,22,16,22	C16.8,22,17.5,22.7,17.5,23.5z M17.1,8h-2.2v11h2.2V8z"),Y(r,"data-icon-path","inner-path"),Y(r,"opacity","0"),$t(e,s)},m(u,f){A(u,e,f),o&&o.m(e,null),I(e,t),I(e,r)},p(u,[f]){u[1]?o?o.p(u,f):(o=Po(u),o.c(),o.m(e,t)):o&&(o.d(1),o=null),$t(e,s=ht(l,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},f&1&&{width:u[0]},f&1&&{height:u[0]},f&4&&u[2],f&8&&u[3]]))},i:Re,o:Re,d(u){u&&x(e),o&&o.d()}}}function wa(n,e,t){let r,o;const l=["size","title"];let s=Fe(e,l),{size:u=16}=e,{title:f=void 0}=e;return n.$$set=c=>{t(5,e=ve(ve({},e),ot(c))),t(3,s=Fe(e,l)),"size"in c&&t(0,u=c.size),"title"in c&&t(1,f=c.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||f),t(2,o={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=ot(e),[u,f,o,s,r]}class Ea extends ke{constructor(e){super(),Te(this,e,wa,ya,Ce,{size:0,title:1})}}const Ll=Ea;function Ao(n){let e,t;return{c(){e=ct("title"),t=ge(n[1])},m(r,o){A(r,e,o),I(e,t)},p(r,o){o&2&&Be(t,r[1])},d(r){r&&x(e)}}}function Sa(n){let e,t,r,o,l=n[1]&&Ao(n),s=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],u={};for(let f=0;f<s.length;f+=1)u=ve(u,s[f]);return{c(){e=ct("svg"),l&&l.c(),t=ct("path"),r=ct("path"),o=ct("path"),Y(t,"fill","none"),Y(t,"d","M16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Zm-1.125-5h2.25V12h-2.25Z"),Y(t,"data-icon-path","inner-path"),Y(r,"d","M16.002,6.1714h-.004L4.6487,27.9966,4.6506,28H27.3494l.0019-.0034ZM14.875,12h2.25v9h-2.25ZM16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Z"),Y(o,"d","M29,30H3a1,1,0,0,1-.8872-1.4614l13-25a1,1,0,0,1,1.7744,0l13,25A1,1,0,0,1,29,30ZM4.6507,28H27.3493l.002-.0033L16.002,6.1714h-.004L4.6487,27.9967Z"),$t(e,u)},m(f,c){A(f,e,c),l&&l.m(e,null),I(e,t),I(e,r),I(e,o)},p(f,[c]){f[1]?l?l.p(f,c):(l=Ao(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),$t(e,u=ht(s,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},c&1&&{width:f[0]},c&1&&{height:f[0]},c&4&&f[2],c&8&&f[3]]))},i:Re,o:Re,d(f){f&&x(e),l&&l.d()}}}function ka(n,e,t){let r,o;const l=["size","title"];let s=Fe(e,l),{size:u=16}=e,{title:f=void 0}=e;return n.$$set=c=>{t(5,e=ve(ve({},e),ot(c))),t(3,s=Fe(e,l)),"size"in c&&t(0,u=c.size),"title"in c&&t(1,f=c.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||f),t(2,o={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=ot(e),[u,f,o,s,r]}class Ta extends ke{constructor(e){super(),Te(this,e,ka,Sa,Ce,{size:0,title:1})}}const Ca=Ta,Oa=n=>({}),xo=n=>({});function No(n){let e,t;const r=n[16].labelText,o=_t(r,n,n[15],xo),l=o||Ia(n);return{c(){e=R("span"),l&&l.c(),T(e,"bx--visually-hidden",n[7])},m(s,u){A(s,e,u),l&&l.m(e,null),t=!0},p(s,u){o?o.p&&(!t||u&32768)&&bt(o,r,s,s[15],t?yt(r,s[15],u,Oa):vt(s[15]),xo):l&&l.p&&(!t||u&64)&&l.p(s,t?u:-1),(!t||u&128)&&T(e,"bx--visually-hidden",s[7])},i(s){t||(j(l,s),t=!0)},o(s){V(l,s),t=!1},d(s){s&&x(e),l&&l.d(s)}}}function Ia(n){let e;return{c(){e=ge(n[6])},m(t,r){A(t,e,r)},p(t,r){r&64&&Be(e,t[6])},d(t){t&&x(e)}}}function Ma(n){let e,t,r,o,l,s,u,f,c,p=(n[6]||n[13].labelText)&&No(n),v=[n[12]],m={};for(let h=0;h<v.length;h+=1)m=ve(m,v[h]);return{c(){e=R("div"),t=R("input"),r=q(),o=R("label"),l=R("span"),s=q(),p&&p.c(),Y(t,"type","radio"),Y(t,"id",n[8]),Y(t,"name",n[9]),t.checked=n[0],t.disabled=n[3],t.required=n[4],t.value=n[2],T(t,"bx--radio-button",!0),T(l,"bx--radio-button__appearance",!0),Y(o,"for",n[8]),T(o,"bx--radio-button__label",!0),Ze(e,m),T(e,"bx--radio-button-wrapper",!0),T(e,"bx--radio-button-wrapper--label-left",n[5]==="left")},m(h,g){A(h,e,g),I(e,t),n[18](t),I(e,r),I(e,o),I(o,l),I(o,s),p&&p.m(o,null),u=!0,f||(c=[Q(t,"change",n[17]),Q(t,"change",n[19])],f=!0)},p(h,[g]){(!u||g&256)&&Y(t,"id",h[8]),(!u||g&512)&&Y(t,"name",h[9]),(!u||g&1)&&(t.checked=h[0]),(!u||g&8)&&(t.disabled=h[3]),(!u||g&16)&&(t.required=h[4]),(!u||g&4)&&(t.value=h[2]),h[6]||h[13].labelText?p?(p.p(h,g),g&8256&&j(p,1)):(p=No(h),p.c(),j(p,1),p.m(o,null)):p&&(rt(),V(p,1,1,()=>{p=null}),it()),(!u||g&256)&&Y(o,"for",h[8]),Ze(e,m=ht(v,[g&4096&&h[12]])),T(e,"bx--radio-button-wrapper",!0),T(e,"bx--radio-button-wrapper--label-left",h[5]==="left")},i(h){u||(j(p),u=!0)},o(h){V(p),u=!1},d(h){h&&x(e),n[18](null),p&&p.d(),f=!1,pt(c)}}}function La(n,e,t){const r=["value","checked","disabled","required","labelPosition","labelText","hideLabel","id","name","ref"];let o=Fe(e,r),l,{$$slots:s={},$$scope:u}=e;const f=Ur(s);let{value:c=""}=e,{checked:p=!1}=e,{disabled:v=!1}=e,{required:m=!1}=e,{labelPosition:h="right"}=e,{labelText:g=""}=e,{hideLabel:b=!1}=e,{id:C="ccs-"+Math.random().toString(36)}=e,{name:B=""}=e,{ref:M=null}=e;const k=Dr("RadioButtonGroup"),P=k?k.selectedValue:dn(p?c:void 0);He(n,P,G=>t(14,l=G)),k&&k.add({id:C,checked:p,disabled:v,value:c});function N(G){le.call(this,n,G)}function D(G){ze[G?"unshift":"push"](()=>{M=G,t(1,M)})}const me=()=>{k&&k.update(c)};return n.$$set=G=>{e=ve(ve({},e),ot(G)),t(12,o=Fe(e,r)),"value"in G&&t(2,c=G.value),"checked"in G&&t(0,p=G.checked),"disabled"in G&&t(3,v=G.disabled),"required"in G&&t(4,m=G.required),"labelPosition"in G&&t(5,h=G.labelPosition),"labelText"in G&&t(6,g=G.labelText),"hideLabel"in G&&t(7,b=G.hideLabel),"id"in G&&t(8,C=G.id),"name"in G&&t(9,B=G.name),"ref"in G&&t(1,M=G.ref),"$$scope"in G&&t(15,u=G.$$scope)},n.$$.update=()=>{n.$$.dirty&16388&&t(0,p=l===c)},[p,M,c,v,m,h,g,b,C,B,k,P,o,f,l,u,s,N,D,me]}class Pa extends ke{constructor(e){super(),Te(this,e,La,Ma,Ce,{value:2,checked:0,disabled:3,required:4,labelPosition:5,labelText:6,hideLabel:7,id:8,name:9,ref:1})}}const kr=Pa;function Ro(n){let e,t;return{c(){e=ct("title"),t=ge(n[1])},m(r,o){A(r,e,o),I(e,t)},p(r,o){o&2&&Be(t,r[1])},d(r){r&&x(e)}}}function Aa(n){let e,t,r=n[1]&&Ro(n),o=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},{width:n[0]},{height:n[0]},n[2],n[3]],l={};for(let s=0;s<o.length;s+=1)l=ve(l,o[s]);return{c(){e=ct("svg"),r&&r.c(),t=ct("path"),Y(t,"d","M30 28.6L3.4 2 2 3.4l10.1 10.1L4 21.6V28h6.4l8.1-8.1L28.6 30 30 28.6zM9.6 26H6v-3.6l7.5-7.5 3.6 3.6L9.6 26zM29.4 6.2L29.4 6.2l-3.6-3.6c-.8-.8-2-.8-2.8 0l0 0 0 0-8 8 1.4 1.4L20 8.4l3.6 3.6L20 15.6l1.4 1.4 8-8C30.2 8.2 30.2 7 29.4 6.2L29.4 6.2zM25 10.6L21.4 7l3-3L28 7.6 25 10.6z"),$t(e,l)},m(s,u){A(s,e,u),r&&r.m(e,null),I(e,t)},p(s,[u]){s[1]?r?r.p(s,u):(r=Ro(s),r.c(),r.m(e,t)):r&&(r.d(1),r=null),$t(e,l=ht(o,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 32 32"},{fill:"currentColor"},{preserveAspectRatio:"xMidYMid meet"},u&1&&{width:s[0]},u&1&&{height:s[0]},u&4&&s[2],u&8&&s[3]]))},i:Re,o:Re,d(s){s&&x(e),r&&r.d()}}}function xa(n,e,t){let r,o;const l=["size","title"];let s=Fe(e,l),{size:u=16}=e,{title:f=void 0}=e;return n.$$set=c=>{t(5,e=ve(ve({},e),ot(c))),t(3,s=Fe(e,l)),"size"in c&&t(0,u=c.size),"title"in c&&t(1,f=c.title)},n.$$.update=()=>{t(4,r=e["aria-label"]||e["aria-labelledby"]||f),t(2,o={"aria-hidden":r?void 0:!0,role:r?"img":void 0,focusable:Number(e.tabindex)===0?!0:void 0})},e=ot(e),[u,f,o,s,r]}class Na extends ke{constructor(e){super(),Te(this,e,xa,Aa,Ce,{size:0,title:1})}}const Ra=Na;function Fa(n){let e,t,r,o;const l=n[5].default,s=_t(l,n,n[4],null);let u=[n[3]],f={};for(let c=0;c<u.length;c+=1)f=ve(f,u[c]);return{c(){e=R("ol"),s&&s.c(),Ze(e,f),T(e,"bx--list--ordered",!n[1]),T(e,"bx--list--ordered--native",n[1]),T(e,"bx--list--nested",n[0]),T(e,"bx--list--expressive",n[2])},m(c,p){A(c,e,p),s&&s.m(e,null),t=!0,r||(o=[Q(e,"click",n[6]),Q(e,"mouseover",n[7]),Q(e,"mouseenter",n[8]),Q(e,"mouseleave",n[9])],r=!0)},p(c,[p]){s&&s.p&&(!t||p&16)&&bt(s,l,c,c[4],t?yt(l,c[4],p,null):vt(c[4]),null),Ze(e,f=ht(u,[p&8&&c[3]])),T(e,"bx--list--ordered",!c[1]),T(e,"bx--list--ordered--native",c[1]),T(e,"bx--list--nested",c[0]),T(e,"bx--list--expressive",c[2])},i(c){t||(j(s,c),t=!0)},o(c){V(s,c),t=!1},d(c){c&&x(e),s&&s.d(c),r=!1,pt(o)}}}function Da(n,e,t){const r=["nested","native","expressive"];let o=Fe(e,r),{$$slots:l={},$$scope:s}=e,{nested:u=!1}=e,{native:f=!1}=e,{expressive:c=!1}=e;function p(g){le.call(this,n,g)}function v(g){le.call(this,n,g)}function m(g){le.call(this,n,g)}function h(g){le.call(this,n,g)}return n.$$set=g=>{e=ve(ve({},e),ot(g)),t(3,o=Fe(e,r)),"nested"in g&&t(0,u=g.nested),"native"in g&&t(1,f=g.native),"expressive"in g&&t(2,c=g.expressive),"$$scope"in g&&t(4,s=g.$$scope)},[u,f,c,o,s,l,p,v,m,h]}class Ua extends ke{constructor(e){super(),Te(this,e,Da,Fa,Ce,{nested:0,native:1,expressive:2})}}const ja=Ua,Ba=n=>({}),Fo=n=>({});function Do(n){let e,t;const r=n[11].legendText,o=_t(r,n,n[10],Fo),l=o||Ga(n);return{c(){e=R("legend"),l&&l.c(),T(e,"bx--label",!0),T(e,"bx--visually-hidden",n[2])},m(s,u){A(s,e,u),l&&l.m(e,null),t=!0},p(s,u){o?o.p&&(!t||u&1024)&&bt(o,r,s,s[10],t?yt(r,s[10],u,Ba):vt(s[10]),Fo):l&&l.p&&(!t||u&2)&&l.p(s,t?u:-1),(!t||u&4)&&T(e,"bx--visually-hidden",s[2])},i(s){t||(j(l,s),t=!0)},o(s){V(l,s),t=!1},d(s){s&&x(e),l&&l.d(s)}}}function Ga(n){let e;return{c(){e=ge(n[1])},m(t,r){A(t,e,r)},p(t,r){r&2&&Be(e,t[1])},d(t){t&&x(e)}}}function za(n){let e,t,r,o,l,s,u=(n[1]||n[8].legendText)&&Do(n);const f=n[11].default,c=_t(f,n,n[10],null);let p=[{id:n[5]},n[7]],v={};for(let m=0;m<p.length;m+=1)v=ve(v,p[m]);return{c(){e=R("div"),t=R("fieldset"),u&&u.c(),r=q(),c&&c.c(),t.disabled=n[0],T(t,"bx--radio-button-group",!0),T(t,"bx--radio-button-group--vertical",n[4]==="vertical"),T(t,"bx--radio-button-group--label-left",n[3]==="left"),T(t,"bx--radio-button-group--label-right",n[3]==="right"),Ze(e,v),T(e,"bx--form-item",!0)},m(m,h){A(m,e,h),I(e,t),u&&u.m(t,null),I(t,r),c&&c.m(t,null),o=!0,l||(s=[Q(e,"click",n[12]),Q(e,"mouseover",n[13]),Q(e,"mouseenter",n[14]),Q(e,"mouseleave",n[15])],l=!0)},p(m,[h]){m[1]||m[8].legendText?u?(u.p(m,h),h&258&&j(u,1)):(u=Do(m),u.c(),j(u,1),u.m(t,r)):u&&(rt(),V(u,1,1,()=>{u=null}),it()),c&&c.p&&(!o||h&1024)&&bt(c,f,m,m[10],o?yt(f,m[10],h,null):vt(m[10]),null),(!o||h&1)&&(t.disabled=m[0]),(!o||h&16)&&T(t,"bx--radio-button-group--vertical",m[4]==="vertical"),(!o||h&8)&&T(t,"bx--radio-button-group--label-left",m[3]==="left"),(!o||h&8)&&T(t,"bx--radio-button-group--label-right",m[3]==="right"),Ze(e,v=ht(p,[(!o||h&32)&&{id:m[5]},h&128&&m[7]])),T(e,"bx--form-item",!0)},i(m){o||(j(u),j(c,m),o=!0)},o(m){V(u),V(c,m),o=!1},d(m){m&&x(e),u&&u.d(),c&&c.d(m),l=!1,pt(s)}}}function Va(n,e,t){const r=["selected","disabled","legendText","hideLegend","labelPosition","orientation","id"];let o=Fe(e,r),l,{$$slots:s={},$$scope:u}=e;const f=Ur(s);let{selected:c=void 0}=e,{disabled:p=!1}=e,{legendText:v=""}=e,{hideLegend:m=!1}=e,{labelPosition:h="right"}=e,{orientation:g="horizontal"}=e,{id:b=void 0}=e;const C=Ml(),B=dn(c);He(n,B,D=>t(16,l=D)),Si("RadioButtonGroup",{selectedValue:B,add:({checked:D,value:me})=>{D&&B.set(me)},update:D=>{t(9,c=D)}}),Cn(()=>{vo(B,l=c,l)}),Gs(()=>{vo(B,l=c,l)}),B.subscribe(D=>{t(9,c=D),C("change",D)});function M(D){le.call(this,n,D)}function k(D){le.call(this,n,D)}function P(D){le.call(this,n,D)}function N(D){le.call(this,n,D)}return n.$$set=D=>{e=ve(ve({},e),ot(D)),t(7,o=Fe(e,r)),"selected"in D&&t(9,c=D.selected),"disabled"in D&&t(0,p=D.disabled),"legendText"in D&&t(1,v=D.legendText),"hideLegend"in D&&t(2,m=D.hideLegend),"labelPosition"in D&&t(3,h=D.labelPosition),"orientation"in D&&t(4,g=D.orientation),"id"in D&&t(5,b=D.id),"$$scope"in D&&t(10,u=D.$$scope)},[p,v,m,h,g,b,B,o,f,c,u,s,M,k,P,N]}class qa extends ke{constructor(e){super(),Te(this,e,Va,za,Ce,{selected:9,disabled:0,legendText:1,hideLegend:2,labelPosition:3,orientation:4,id:5})}}const Ja=qa,Ya=n=>({}),Uo=n=>({});function jo(n){let e,t,r,o;const l=n[20].labelText,s=_t(l,n,n[19],Uo),u=s||Wa(n);let f=n[5]&&Bo(n);return{c(){e=R("div"),t=R("label"),u&&u.c(),r=q(),f&&f.c(),Y(t,"for",n[14]),T(t,"bx--label",!0),T(t,"bx--visually-hidden",n[11]),T(t,"bx--label--disabled",n[7]),T(e,"bx--text-area__label-wrapper",!0)},m(c,p){A(c,e,p),I(e,t),u&&u.m(t,null),I(e,r),f&&f.m(e,null),o=!0},p(c,p){s?s.p&&(!o||p[0]&524288)&&bt(s,l,c,c[19],o?yt(l,c[19],p,Ya):vt(c[19]),Uo):u&&u.p&&(!o||p[0]&1024)&&u.p(c,o?p:[-1,-1]),(!o||p[0]&16384)&&Y(t,"for",c[14]),(!o||p[0]&2048)&&T(t,"bx--visually-hidden",c[11]),(!o||p[0]&128)&&T(t,"bx--label--disabled",c[7]),c[5]?f?f.p(c,p):(f=Bo(c),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(c){o||(j(u,c),o=!0)},o(c){V(u,c),o=!1},d(c){c&&x(e),u&&u.d(c),f&&f.d()}}}function Wa(n){let e;return{c(){e=ge(n[10])},m(t,r){A(t,e,r)},p(t,r){r[0]&1024&&Be(e,t[10])},d(t){t&&x(e)}}}function Bo(n){let e,t=n[0].length+"",r,o,l;return{c(){e=R("div"),r=ge(t),o=ge("/"),l=ge(n[5]),T(e,"bx--label",!0),T(e,"bx--label--disabled",n[7])},m(s,u){A(s,e,u),I(e,r),I(e,o),I(e,l)},p(s,u){u[0]&1&&t!==(t=s[0].length+"")&&Be(r,t),u[0]&32&&Be(l,s[5]),u[0]&128&&T(e,"bx--label--disabled",s[7])},d(s){s&&x(e)}}}function Go(n){let e,t;return e=new Ll({props:{class:"bx--text-area__invalid-icon"}}),{c(){de(e.$$.fragment)},m(r,o){he(e,r,o),t=!0},i(r){t||(j(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){pe(e,r)}}}function zo(n){let e,t;return{c(){e=R("div"),t=ge(n[9]),T(e,"bx--form__helper-text",!0),T(e,"bx--form__helper-text--disabled",n[7])},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&512&&Be(t,r[9]),o[0]&128&&T(e,"bx--form__helper-text--disabled",r[7])},d(r){r&&x(e)}}}function Vo(n){let e,t;return{c(){e=R("div"),t=ge(n[13]),Y(e,"id",n[16]),T(e,"bx--form-requirement",!0)},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&8192&&Be(t,r[13]),o[0]&65536&&Y(e,"id",r[16])},d(r){r&&x(e)}}}function Ha(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g,b=(n[10]||n[17].labelText)&&!n[11]&&jo(n),C=n[12]&&Go(),B=[{"aria-invalid":s=n[12]||void 0},{"aria-describedby":u=n[12]?n[16]:void 0},{disabled:n[7]},{id:n[14]},{name:n[15]},{cols:n[3]},{rows:n[4]},{placeholder:n[2]},{readOnly:n[8]},{maxlength:f=n[5]??void 0},n[18]],M={};for(let N=0;N<B.length;N+=1)M=ve(M,B[N]);let k=!n[12]&&n[9]&&zo(n),P=n[12]&&Vo(n);return{c(){e=R("div"),b&&b.c(),t=q(),r=R("div"),C&&C.c(),o=q(),l=R("textarea"),p=q(),k&&k.c(),v=q(),P&&P.c(),Ze(l,M),T(l,"bx--text-area",!0),T(l,"bx--text-area--light",n[6]),T(l,"bx--text-area--invalid",n[12]),Y(r,"data-invalid",c=n[12]||void 0),T(r,"bx--text-area__wrapper",!0),T(e,"bx--form-item",!0)},m(N,D){A(N,e,D),b&&b.m(e,null),I(e,t),I(e,r),C&&C.m(r,null),I(r,o),I(r,l),l.autofocus&&l.focus(),n[32](l),Tn(l,n[0]),I(e,p),k&&k.m(e,null),I(e,v),P&&P.m(e,null),m=!0,h||(g=[Q(l,"input",n[33]),Q(l,"change",n[25]),Q(l,"input",n[26]),Q(l,"keydown",n[27]),Q(l,"keyup",n[28]),Q(l,"focus",n[29]),Q(l,"blur",n[30]),Q(l,"paste",n[31]),Q(e,"click",n[21]),Q(e,"mouseover",n[22]),Q(e,"mouseenter",n[23]),Q(e,"mouseleave",n[24])],h=!0)},p(N,D){(N[10]||N[17].labelText)&&!N[11]?b?(b.p(N,D),D[0]&134144&&j(b,1)):(b=jo(N),b.c(),j(b,1),b.m(e,t)):b&&(rt(),V(b,1,1,()=>{b=null}),it()),N[12]?C?D[0]&4096&&j(C,1):(C=Go(),C.c(),j(C,1),C.m(r,o)):C&&(rt(),V(C,1,1,()=>{C=null}),it()),Ze(l,M=ht(B,[(!m||D[0]&4096&&s!==(s=N[12]||void 0))&&{"aria-invalid":s},(!m||D[0]&69632&&u!==(u=N[12]?N[16]:void 0))&&{"aria-describedby":u},(!m||D[0]&128)&&{disabled:N[7]},(!m||D[0]&16384)&&{id:N[14]},(!m||D[0]&32768)&&{name:N[15]},(!m||D[0]&8)&&{cols:N[3]},(!m||D[0]&16)&&{rows:N[4]},(!m||D[0]&4)&&{placeholder:N[2]},(!m||D[0]&256)&&{readOnly:N[8]},(!m||D[0]&32&&f!==(f=N[5]??void 0))&&{maxlength:f},D[0]&262144&&N[18]])),D[0]&1&&Tn(l,N[0]),T(l,"bx--text-area",!0),T(l,"bx--text-area--light",N[6]),T(l,"bx--text-area--invalid",N[12]),(!m||D[0]&4096&&c!==(c=N[12]||void 0))&&Y(r,"data-invalid",c),!N[12]&&N[9]?k?k.p(N,D):(k=zo(N),k.c(),k.m(e,v)):k&&(k.d(1),k=null),N[12]?P?P.p(N,D):(P=Vo(N),P.c(),P.m(e,null)):P&&(P.d(1),P=null)},i(N){m||(j(b),j(C),m=!0)},o(N){V(b),V(C),m=!1},d(N){N&&x(e),b&&b.d(),C&&C.d(),n[32](null),k&&k.d(),P&&P.d(),h=!1,pt(g)}}}function Za(n,e,t){let r;const o=["value","placeholder","cols","rows","maxCount","light","disabled","readonly","helperText","labelText","hideLabel","invalid","invalidText","id","name","ref"];let l=Fe(e,o),{$$slots:s={},$$scope:u}=e;const f=Ur(s);let{value:c=""}=e,{placeholder:p=""}=e,{cols:v=50}=e,{rows:m=4}=e,{maxCount:h=void 0}=e,{light:g=!1}=e,{disabled:b=!1}=e,{readonly:C=!1}=e,{helperText:B=""}=e,{labelText:M=""}=e,{hideLabel:k=!1}=e,{invalid:P=!1}=e,{invalidText:N=""}=e,{id:D="ccs-"+Math.random().toString(36)}=e,{name:me=void 0}=e,{ref:G=null}=e;function se(O){le.call(this,n,O)}function ae(O){le.call(this,n,O)}function U(O){le.call(this,n,O)}function ee(O){le.call(this,n,O)}function te(O){le.call(this,n,O)}function ue(O){le.call(this,n,O)}function K(O){le.call(this,n,O)}function oe(O){le.call(this,n,O)}function Le(O){le.call(this,n,O)}function Me(O){le.call(this,n,O)}function Oe(O){le.call(this,n,O)}function Ie(O){ze[O?"unshift":"push"](()=>{G=O,t(1,G)})}function we(){c=this.value,t(0,c)}return n.$$set=O=>{e=ve(ve({},e),ot(O)),t(18,l=Fe(e,o)),"value"in O&&t(0,c=O.value),"placeholder"in O&&t(2,p=O.placeholder),"cols"in O&&t(3,v=O.cols),"rows"in O&&t(4,m=O.rows),"maxCount"in O&&t(5,h=O.maxCount),"light"in O&&t(6,g=O.light),"disabled"in O&&t(7,b=O.disabled),"readonly"in O&&t(8,C=O.readonly),"helperText"in O&&t(9,B=O.helperText),"labelText"in O&&t(10,M=O.labelText),"hideLabel"in O&&t(11,k=O.hideLabel),"invalid"in O&&t(12,P=O.invalid),"invalidText"in O&&t(13,N=O.invalidText),"id"in O&&t(14,D=O.id),"name"in O&&t(15,me=O.name),"ref"in O&&t(1,G=O.ref),"$$scope"in O&&t(19,u=O.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&16384&&t(16,r=`error-${D}`)},[c,G,p,v,m,h,g,b,C,B,M,k,P,N,D,me,r,f,l,u,s,se,ae,U,ee,te,ue,K,oe,Le,Me,Oe,Ie,we]}class Xa extends ke{constructor(e){super(),Te(this,e,Za,Ha,Ce,{value:0,placeholder:2,cols:3,rows:4,maxCount:5,light:6,disabled:7,readonly:8,helperText:9,labelText:10,hideLabel:11,invalid:12,invalidText:13,id:14,name:15,ref:1},null,[-1,-1])}}const Ka=Xa,Qa=n=>({}),qo=n=>({}),$a=n=>({}),Jo=n=>({});function Yo(n){let e,t,r,o=n[9]&&Wo(n),l=!n[20]&&n[6]&&Ho(n);return{c(){e=R("div"),o&&o.c(),t=q(),l&&l.c(),T(e,"bx--text-input__label-helper-wrapper",!0)},m(s,u){A(s,e,u),o&&o.m(e,null),I(e,t),l&&l.m(e,null),r=!0},p(s,u){s[9]?o?(o.p(s,u),u[0]&512&&j(o,1)):(o=Wo(s),o.c(),j(o,1),o.m(e,t)):o&&(rt(),V(o,1,1,()=>{o=null}),it()),!s[20]&&s[6]?l?l.p(s,u):(l=Ho(s),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i(s){r||(j(o),r=!0)},o(s){V(o),r=!1},d(s){s&&x(e),o&&o.d(),l&&l.d()}}}function Wo(n){let e,t;const r=n[26].labelText,o=_t(r,n,n[25],Jo),l=o||eu(n);return{c(){e=R("label"),l&&l.c(),Y(e,"for",n[7]),T(e,"bx--label",!0),T(e,"bx--visually-hidden",n[10]),T(e,"bx--label--disabled",n[5]),T(e,"bx--label--inline",n[16]),T(e,"bx--label--inline--sm",n[2]==="sm"),T(e,"bx--label--inline--xl",n[2]==="xl")},m(s,u){A(s,e,u),l&&l.m(e,null),t=!0},p(s,u){o?o.p&&(!t||u[0]&33554432)&&bt(o,r,s,s[25],t?yt(r,s[25],u,$a):vt(s[25]),Jo):l&&l.p&&(!t||u[0]&512)&&l.p(s,t?u:[-1,-1]),(!t||u[0]&128)&&Y(e,"for",s[7]),(!t||u[0]&1024)&&T(e,"bx--visually-hidden",s[10]),(!t||u[0]&32)&&T(e,"bx--label--disabled",s[5]),(!t||u[0]&65536)&&T(e,"bx--label--inline",s[16]),(!t||u[0]&4)&&T(e,"bx--label--inline--sm",s[2]==="sm"),(!t||u[0]&4)&&T(e,"bx--label--inline--xl",s[2]==="xl")},i(s){t||(j(l,s),t=!0)},o(s){V(l,s),t=!1},d(s){s&&x(e),l&&l.d(s)}}}function eu(n){let e;return{c(){e=ge(n[9])},m(t,r){A(t,e,r)},p(t,r){r[0]&512&&Be(e,t[9])},d(t){t&&x(e)}}}function Ho(n){let e,t;return{c(){e=R("div"),t=ge(n[6]),T(e,"bx--form__helper-text",!0),T(e,"bx--form__helper-text--disabled",n[5]),T(e,"bx--form__helper-text--inline",n[16])},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&64&&Be(t,r[6]),o[0]&32&&T(e,"bx--form__helper-text--disabled",r[5]),o[0]&65536&&T(e,"bx--form__helper-text--inline",r[16])},d(r){r&&x(e)}}}function Zo(n){let e,t;const r=n[26].labelText,o=_t(r,n,n[25],qo),l=o||tu(n);return{c(){e=R("label"),l&&l.c(),Y(e,"for",n[7]),T(e,"bx--label",!0),T(e,"bx--visually-hidden",n[10]),T(e,"bx--label--disabled",n[5]),T(e,"bx--label--inline",n[16]),T(e,"bx--label--inline-sm",n[16]&&n[2]==="sm"),T(e,"bx--label--inline-xl",n[16]&&n[2]==="xl")},m(s,u){A(s,e,u),l&&l.m(e,null),t=!0},p(s,u){o?o.p&&(!t||u[0]&33554432)&&bt(o,r,s,s[25],t?yt(r,s[25],u,Qa):vt(s[25]),qo):l&&l.p&&(!t||u[0]&512)&&l.p(s,t?u:[-1,-1]),(!t||u[0]&128)&&Y(e,"for",s[7]),(!t||u[0]&1024)&&T(e,"bx--visually-hidden",s[10]),(!t||u[0]&32)&&T(e,"bx--label--disabled",s[5]),(!t||u[0]&65536)&&T(e,"bx--label--inline",s[16]),(!t||u[0]&65540)&&T(e,"bx--label--inline-sm",s[16]&&s[2]==="sm"),(!t||u[0]&65540)&&T(e,"bx--label--inline-xl",s[16]&&s[2]==="xl")},i(s){t||(j(l,s),t=!0)},o(s){V(l,s),t=!1},d(s){s&&x(e),l&&l.d(s)}}}function tu(n){let e;return{c(){e=ge(n[9])},m(t,r){A(t,e,r)},p(t,r){r[0]&512&&Be(e,t[9])},d(t){t&&x(e)}}}function Xo(n){let e,t;return e=new Ll({props:{class:"bx--text-input__invalid-icon"}}),{c(){de(e.$$.fragment)},m(r,o){he(e,r,o),t=!0},i(r){t||(j(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){pe(e,r)}}}function Ko(n){let e,t;return e=new Ca({props:{class:`bx--text-input__invalid-icon
            bx--text-input__invalid-icon--warning`}}),{c(){de(e.$$.fragment)},m(r,o){he(e,r,o),t=!0},i(r){t||(j(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){pe(e,r)}}}function Qo(n){let e,t;return e=new Ra({props:{class:"bx--text-input__readonly-icon"}}),{c(){de(e.$$.fragment)},m(r,o){he(e,r,o),t=!0},i(r){t||(j(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){pe(e,r)}}}function $o(n){let e;return{c(){e=R("hr"),T(e,"bx--text-input__divider",!0)},m(t,r){A(t,e,r)},d(t){t&&x(e)}}}function el(n){let e,t;return{c(){e=R("div"),t=ge(n[12]),Y(e,"id",n[19]),T(e,"bx--form-requirement",!0)},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&4096&&Be(t,r[12]),o[0]&524288&&Y(e,"id",r[19])},d(r){r&&x(e)}}}function tl(n){let e,t;return{c(){e=R("div"),t=ge(n[14]),Y(e,"id",n[18]),T(e,"bx--form-requirement",!0)},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&16384&&Be(t,r[14]),o[0]&262144&&Y(e,"id",r[18])},d(r){r&&x(e)}}}function nl(n){let e,t;return{c(){e=R("div"),t=ge(n[6]),T(e,"bx--form__helper-text",!0),T(e,"bx--form__helper-text--disabled",n[5]),T(e,"bx--form__helper-text--inline",n[16])},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&64&&Be(t,r[6]),o[0]&32&&T(e,"bx--form__helper-text--disabled",r[5]),o[0]&65536&&T(e,"bx--form__helper-text--inline",r[16])},d(r){r&&x(e)}}}function rl(n){let e,t;return{c(){e=R("div"),t=ge(n[12]),Y(e,"id",n[19]),T(e,"bx--form-requirement",!0)},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&4096&&Be(t,r[12]),o[0]&524288&&Y(e,"id",r[19])},d(r){r&&x(e)}}}function il(n){let e,t;return{c(){e=R("div"),t=ge(n[14]),Y(e,"id",n[18]),T(e,"bx--form-requirement",!0)},m(r,o){A(r,e,o),I(e,t)},p(r,o){o[0]&16384&&Be(t,r[14]),o[0]&262144&&Y(e,"id",r[18])},d(r){r&&x(e)}}}function nu(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g,b,C,B,M,k,P,N,D,me,G,se=n[16]&&Yo(n),ae=!n[16]&&(n[9]||n[24].labelText)&&Zo(n),U=n[11]&&Xo(),ee=!n[11]&&n[13]&&Ko(),te=n[17]&&Qo(),ue=[{"data-invalid":p=n[11]||void 0},{"aria-invalid":v=n[11]||void 0},{"data-warn":m=n[13]||void 0},{"aria-describedby":h=n[11]?n[19]:n[13]?n[18]:void 0},{disabled:n[5]},{id:n[7]},{name:n[8]},{placeholder:n[3]},{required:n[15]},{readOnly:n[17]},n[23]],K={};for(let O=0;O<ue.length;O+=1)K=ve(K,ue[O]);let oe=n[20]&&$o(),Le=n[20]&&!n[16]&&n[11]&&el(n),Me=n[20]&&!n[16]&&n[13]&&tl(n),Oe=!n[11]&&!n[13]&&!n[20]&&!n[16]&&n[6]&&nl(n),Ie=!n[20]&&n[11]&&rl(n),we=!n[20]&&!n[11]&&n[13]&&il(n);return{c(){e=R("div"),se&&se.c(),t=q(),ae&&ae.c(),r=q(),o=R("div"),l=R("div"),U&&U.c(),s=q(),ee&&ee.c(),u=q(),te&&te.c(),f=q(),c=R("input"),g=q(),oe&&oe.c(),b=q(),Le&&Le.c(),C=q(),Me&&Me.c(),k=q(),Oe&&Oe.c(),P=q(),Ie&&Ie.c(),N=q(),we&&we.c(),Ze(c,K),T(c,"bx--text-input",!0),T(c,"bx--text-input--light",n[4]),T(c,"bx--text-input--invalid",n[11]),T(c,"bx--text-input--warn",n[13]),T(c,"bx--text-input--sm",n[2]==="sm"),T(c,"bx--text-input--xl",n[2]==="xl"),Y(l,"data-invalid",B=n[11]||void 0),Y(l,"data-warn",M=n[13]||void 0),T(l,"bx--text-input__field-wrapper",!0),T(l,"bx--text-input__field-wrapper--warning",!n[11]&&n[13]),T(o,"bx--text-input__field-outer-wrapper",!0),T(o,"bx--text-input__field-outer-wrapper--inline",n[16]),T(e,"bx--form-item",!0),T(e,"bx--text-input-wrapper",!0),T(e,"bx--text-input-wrapper--inline",n[16]),T(e,"bx--text-input-wrapper--light",n[4]),T(e,"bx--text-input-wrapper--readonly",n[17])},m(O,ne){A(O,e,ne),se&&se.m(e,null),I(e,t),ae&&ae.m(e,null),I(e,r),I(e,o),I(o,l),U&&U.m(l,null),I(l,s),ee&&ee.m(l,null),I(l,u),te&&te.m(l,null),I(l,f),I(l,c),c.autofocus&&c.focus(),n[36](c),Tn(c,n[0]),I(l,g),oe&&oe.m(l,null),I(l,b),Le&&Le.m(l,null),I(l,C),Me&&Me.m(l,null),I(o,k),Oe&&Oe.m(o,null),I(o,P),Ie&&Ie.m(o,null),I(o,N),we&&we.m(o,null),D=!0,me||(G=[Q(c,"input",n[37]),Q(c,"change",n[22]),Q(c,"input",n[21]),Q(c,"keydown",n[31]),Q(c,"keyup",n[32]),Q(c,"focus",n[33]),Q(c,"blur",n[34]),Q(c,"paste",n[35]),Q(e,"click",n[27]),Q(e,"mouseover",n[28]),Q(e,"mouseenter",n[29]),Q(e,"mouseleave",n[30])],me=!0)},p(O,ne){O[16]?se?(se.p(O,ne),ne[0]&65536&&j(se,1)):(se=Yo(O),se.c(),j(se,1),se.m(e,t)):se&&(rt(),V(se,1,1,()=>{se=null}),it()),!O[16]&&(O[9]||O[24].labelText)?ae?(ae.p(O,ne),ne[0]&16843264&&j(ae,1)):(ae=Zo(O),ae.c(),j(ae,1),ae.m(e,r)):ae&&(rt(),V(ae,1,1,()=>{ae=null}),it()),O[11]?U?ne[0]&2048&&j(U,1):(U=Xo(),U.c(),j(U,1),U.m(l,s)):U&&(rt(),V(U,1,1,()=>{U=null}),it()),!O[11]&&O[13]?ee?ne[0]&10240&&j(ee,1):(ee=Ko(),ee.c(),j(ee,1),ee.m(l,u)):ee&&(rt(),V(ee,1,1,()=>{ee=null}),it()),O[17]?te?ne[0]&131072&&j(te,1):(te=Qo(),te.c(),j(te,1),te.m(l,f)):te&&(rt(),V(te,1,1,()=>{te=null}),it()),Ze(c,K=ht(ue,[(!D||ne[0]&2048&&p!==(p=O[11]||void 0))&&{"data-invalid":p},(!D||ne[0]&2048&&v!==(v=O[11]||void 0))&&{"aria-invalid":v},(!D||ne[0]&8192&&m!==(m=O[13]||void 0))&&{"data-warn":m},(!D||ne[0]&796672&&h!==(h=O[11]?O[19]:O[13]?O[18]:void 0))&&{"aria-describedby":h},(!D||ne[0]&32)&&{disabled:O[5]},(!D||ne[0]&128)&&{id:O[7]},(!D||ne[0]&256)&&{name:O[8]},(!D||ne[0]&8)&&{placeholder:O[3]},(!D||ne[0]&32768)&&{required:O[15]},(!D||ne[0]&131072)&&{readOnly:O[17]},ne[0]&8388608&&O[23]])),ne[0]&1&&c.value!==O[0]&&Tn(c,O[0]),T(c,"bx--text-input",!0),T(c,"bx--text-input--light",O[4]),T(c,"bx--text-input--invalid",O[11]),T(c,"bx--text-input--warn",O[13]),T(c,"bx--text-input--sm",O[2]==="sm"),T(c,"bx--text-input--xl",O[2]==="xl"),O[20]?oe||(oe=$o(),oe.c(),oe.m(l,b)):oe&&(oe.d(1),oe=null),O[20]&&!O[16]&&O[11]?Le?Le.p(O,ne):(Le=el(O),Le.c(),Le.m(l,C)):Le&&(Le.d(1),Le=null),O[20]&&!O[16]&&O[13]?Me?Me.p(O,ne):(Me=tl(O),Me.c(),Me.m(l,null)):Me&&(Me.d(1),Me=null),(!D||ne[0]&2048&&B!==(B=O[11]||void 0))&&Y(l,"data-invalid",B),(!D||ne[0]&8192&&M!==(M=O[13]||void 0))&&Y(l,"data-warn",M),(!D||ne[0]&10240)&&T(l,"bx--text-input__field-wrapper--warning",!O[11]&&O[13]),!O[11]&&!O[13]&&!O[20]&&!O[16]&&O[6]?Oe?Oe.p(O,ne):(Oe=nl(O),Oe.c(),Oe.m(o,P)):Oe&&(Oe.d(1),Oe=null),!O[20]&&O[11]?Ie?Ie.p(O,ne):(Ie=rl(O),Ie.c(),Ie.m(o,N)):Ie&&(Ie.d(1),Ie=null),!O[20]&&!O[11]&&O[13]?we?we.p(O,ne):(we=il(O),we.c(),we.m(o,null)):we&&(we.d(1),we=null),(!D||ne[0]&65536)&&T(o,"bx--text-input__field-outer-wrapper--inline",O[16]),(!D||ne[0]&65536)&&T(e,"bx--text-input-wrapper--inline",O[16]),(!D||ne[0]&16)&&T(e,"bx--text-input-wrapper--light",O[4]),(!D||ne[0]&131072)&&T(e,"bx--text-input-wrapper--readonly",O[17])},i(O){D||(j(se),j(ae),j(U),j(ee),j(te),D=!0)},o(O){V(se),V(ae),V(U),V(ee),V(te),D=!1},d(O){O&&x(e),se&&se.d(),ae&&ae.d(),U&&U.d(),ee&&ee.d(),te&&te.d(),n[36](null),oe&&oe.d(),Le&&Le.d(),Me&&Me.d(),Oe&&Oe.d(),Ie&&Ie.d(),we&&we.d(),me=!1,pt(G)}}}function ru(n,e,t){let r,o,l;const s=["size","value","placeholder","light","disabled","helperText","id","name","labelText","hideLabel","invalid","invalidText","warn","warnText","ref","required","inline","readonly"];let u=Fe(e,s),{$$slots:f={},$$scope:c}=e;const p=Ur(f);let{size:v=void 0}=e,{value:m=""}=e,{placeholder:h=""}=e,{light:g=!1}=e,{disabled:b=!1}=e,{helperText:C=""}=e,{id:B="ccs-"+Math.random().toString(36)}=e,{name:M=void 0}=e,{labelText:k=""}=e,{hideLabel:P=!1}=e,{invalid:N=!1}=e,{invalidText:D=""}=e,{warn:me=!1}=e,{warnText:G=""}=e,{ref:se=null}=e,{required:ae=!1}=e,{inline:U=!1}=e,{readonly:ee=!1}=e;const te=Dr("Form"),ue=Ml();function K($){return u.type!=="number"?$:$!=""?Number($):null}const oe=$=>{t(0,m=K($.target.value)),ue("input",m)},Le=$=>{ue("change",K($.target.value))};function Me($){le.call(this,n,$)}function Oe($){le.call(this,n,$)}function Ie($){le.call(this,n,$)}function we($){le.call(this,n,$)}function O($){le.call(this,n,$)}function ne($){le.call(this,n,$)}function lt($){le.call(this,n,$)}function hn($){le.call(this,n,$)}function zt($){le.call(this,n,$)}function Xe($){ze[$?"unshift":"push"](()=>{se=$,t(1,se)})}function be(){m=this.value,t(0,m)}return n.$$set=$=>{e=ve(ve({},e),ot($)),t(23,u=Fe(e,s)),"size"in $&&t(2,v=$.size),"value"in $&&t(0,m=$.value),"placeholder"in $&&t(3,h=$.placeholder),"light"in $&&t(4,g=$.light),"disabled"in $&&t(5,b=$.disabled),"helperText"in $&&t(6,C=$.helperText),"id"in $&&t(7,B=$.id),"name"in $&&t(8,M=$.name),"labelText"in $&&t(9,k=$.labelText),"hideLabel"in $&&t(10,P=$.hideLabel),"invalid"in $&&t(11,N=$.invalid),"invalidText"in $&&t(12,D=$.invalidText),"warn"in $&&t(13,me=$.warn),"warnText"in $&&t(14,G=$.warnText),"ref"in $&&t(1,se=$.ref),"required"in $&&t(15,ae=$.required),"inline"in $&&t(16,U=$.inline),"readonly"in $&&t(17,ee=$.readonly),"$$scope"in $&&t(25,c=$.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&128&&t(19,o=`error-${B}`),n.$$.dirty[0]&128&&t(18,l=`warn-${B}`)},t(20,r=!!te&&te.isFluid),[m,se,v,h,g,b,C,B,M,k,P,N,D,me,G,ae,U,ee,l,o,r,oe,Le,u,p,c,f,Me,Oe,Ie,we,O,ne,lt,hn,zt,Xe,be]}class iu extends ke{constructor(e){super(),Te(this,e,ru,nu,Ce,{size:2,value:0,placeholder:3,light:4,disabled:5,helperText:6,id:7,name:8,labelText:9,hideLabel:10,invalid:11,invalidText:12,warn:13,warnText:14,ref:1,required:15,inline:16,readonly:17},null,[-1,-1])}}const ou=iu;function lu(n){let e;return{c(){e=ge(`Click one of the draw icons to the top right of the map (the icons allow
      you to draw points, lines, polygons or routes)`)},m(t,r){A(t,e,r)},d(t){t&&x(e)}}}function su(n){let e;return{c(){e=ge(`Draw the intervention on the map, clicking the original point or 'Finish
      snapping' for the Polygon and Route tools respectively`)},m(t,r){A(t,e,r)},d(t){t&&x(e)}}}function au(n){let e;return{c(){e=ge("Fill in the details that appear (Intervention type, name, description)")},m(t,r){A(t,e,r)},d(t){t&&x(e)}}}function uu(n){let e;return{c(){e=ge(`Click the "Save" button or "Delete" button to save or remove the
      intervention`)},m(t,r){A(t,e,r)},d(t){t&&x(e)}}}function fu(n){let e,t,r,o,l,s,u,f;return e=new Sr({props:{$$slots:{default:[lu]},$$scope:{ctx:n}}}),r=new Sr({props:{$$slots:{default:[su]},$$scope:{ctx:n}}}),l=new Sr({props:{$$slots:{default:[au]},$$scope:{ctx:n}}}),u=new Sr({props:{$$slots:{default:[uu]},$$scope:{ctx:n}}}),{c(){de(e.$$.fragment),t=q(),de(r.$$.fragment),o=q(),de(l.$$.fragment),s=q(),de(u.$$.fragment)},m(c,p){he(e,c,p),A(c,t,p),he(r,c,p),A(c,o,p),he(l,c,p),A(c,s,p),he(u,c,p),f=!0},p(c,p){const v={};p&4&&(v.$$scope={dirty:p,ctx:c}),e.$set(v);const m={};p&4&&(m.$$scope={dirty:p,ctx:c}),r.$set(m);const h={};p&4&&(h.$$scope={dirty:p,ctx:c}),l.$set(h);const g={};p&4&&(g.$$scope={dirty:p,ctx:c}),u.$set(g)},i(c){f||(j(e.$$.fragment,c),j(r.$$.fragment,c),j(l.$$.fragment,c),j(u.$$.fragment,c),f=!0)},o(c){V(e.$$.fragment,c),V(r.$$.fragment,c),V(l.$$.fragment,c),V(u.$$.fragment,c),f=!1},d(c){pe(e,c),c&&x(t),pe(r,c),c&&x(o),pe(l,c),c&&x(s),pe(u,c)}}}function cu(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g,b,C,B,M,k,P,N,D,me,G,se,ae;return l=new ja({props:{$$slots:{default:[fu]},$$scope:{ctx:n}}}),{c(){e=R("p"),e.textContent="For each intervention:",t=q(),r=R("br"),o=q(),de(l.$$.fragment),s=q(),u=R("br"),f=q(),c=R("p"),c.textContent=`Repeat the steps above for each substantial infrastructure intervention in
    the scheme.`,p=q(),v=R("br"),m=q(),h=R("p"),h.textContent=`To make further edits to attribute data, or to delete an intervention, click
    on its name in the left hand panel or its geometry in the map.`,g=q(),b=R("br"),C=q(),B=R("p"),B.textContent=`Click the "Export to GeoJSON" button to download the dataset representing
    the scheme, which can be made up of one or more intervention, as a GeoJSON
    file. After saving the file, you can delete the interventions, change the
    scheme name, and start a new set of interventions representing a new scheme.`,M=q(),k=R("br"),P=q(),N=R("p"),N.textContent=`To load a GeoJSON file that you have already saved from the tool, click the
    "Load from GeoJSON" button and select the file.`,D=q(),me=R("br"),G=q(),se=R("p"),se.innerHTML=`Note: the <strong>Route tool</strong> works by calculating routes between
    start and end points using the existing transport network according to
    OpenStreetMap. Use it by clicking on the location where you would like the
    route to start and then clicking on the location where you would like the
    route to end on the map. The route will be calculated and drawn on the map.
    After you click &quot;Finish snapping&quot; you can edit the route by dragging
    individual points. This can be useful for representing links that are not
    part of the existing transport network, such as a new bridge or path.
    However,
    <strong>you cannot add or remove points</strong> with the Route tool. If the
    planned route intervention you would like to sketch as part of a scheme contains
    one or more new links (for example containing new bridges or paths between cul-de-sacs),
    you may want to use the Line tool instead.`},m(U,ee){A(U,e,ee),A(U,t,ee),A(U,r,ee),A(U,o,ee),he(l,U,ee),A(U,s,ee),A(U,u,ee),A(U,f,ee),A(U,c,ee),A(U,p,ee),A(U,v,ee),A(U,m,ee),A(U,h,ee),A(U,g,ee),A(U,b,ee),A(U,C,ee),A(U,B,ee),A(U,M,ee),A(U,k,ee),A(U,P,ee),A(U,N,ee),A(U,D,ee),A(U,me,ee),A(U,G,ee),A(U,se,ee),ae=!0},p(U,ee){const te={};ee&4&&(te.$$scope={dirty:ee,ctx:U}),l.$set(te)},i(U){ae||(j(l.$$.fragment,U),ae=!0)},o(U){V(l.$$.fragment,U),ae=!1},d(U){U&&x(e),U&&x(t),U&&x(r),U&&x(o),pe(l,U),U&&x(s),U&&x(u),U&&x(f),U&&x(c),U&&x(p),U&&x(v),U&&x(m),U&&x(h),U&&x(g),U&&x(b),U&&x(C),U&&x(B),U&&x(M),U&&x(k),U&&x(P),U&&x(N),U&&x(D),U&&x(me),U&&x(G),U&&x(se)}}}function du(n){let e,t,r;function o(s){n[1](s)}let l={passiveModal:!0,modalHeading:"Instructions",$$slots:{default:[cu]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.open=n[0]),e=new zs({props:l}),ze.push(()=>st(e,"open",o,n[0])),{c(){de(e.$$.fragment)},m(s,u){he(e,s,u),r=!0},p(s,[u]){const f={};u&4&&(f.$$scope={dirty:u,ctx:s}),!t&&u&1&&(t=!0,f.open=s[0],at(()=>t=!1)),e.$set(f)},i(s){r||(j(e.$$.fragment,s),r=!0)},o(s){V(e.$$.fragment,s),r=!1},d(s){pe(e,s)}}}function hu(n,e,t){let{open:r}=e;function o(l){r=l,t(0,r)}return n.$$set=l=>{"open"in l&&t(0,r=l.open)},[r,o]}class pu extends ke{constructor(e){super(),Te(this,e,hu,du,Ce,{open:0})}}const Mt=dn(null),je=dn(ai()),Gt=dn(null),si=dn(null);function ai(){return{type:"FeatureCollection",features:[]}}const Oi=Vs(je,n=>{let e=n.features.find(t=>t.properties.editing);return e?e.id:null});function Ar(n){je.update(e=>{for(let t of e.features)t.id==n?t.properties.editing=!0:delete t.properties.editing;return e}),Gt.set(n)}function Pl(n){let e=new Set;for(let r of n.features)e.add(r.id);let t=e.size;for(;e.has(t);)t++;return t}function ol(n){let e;const t=n[4].default,r=_t(t,n,n[3],null);return{c(){r&&r.c()},m(o,l){r&&r.m(o,l),e=!0},p(o,l){r&&r.p&&(!e||l&8)&&bt(r,t,o,o[3],e?yt(t,o[3],l,null):vt(o[3]),null)},i(o){e||(j(r,o),e=!0)},o(o){V(r,o),e=!1},d(o){r&&r.d(o)}}}function gu(n){let e,t,r=n[1]&&ol(n);return{c(){e=R("div"),r&&r.c(),Y(e,"class","map svelte-12dpf1u")},m(o,l){A(o,e,l),r&&r.m(e,null),n[5](e),t=!0},p(o,[l]){o[1]?r?(r.p(o,l),l&2&&j(r,1)):(r=ol(o),r.c(),j(r,1),r.m(e,null)):r&&(rt(),V(r,1,1,()=>{r=null}),it())},i(o){t||(j(r),t=!0)},o(o){V(r),t=!1},d(o){o&&x(e),r&&r.d(),n[5](null)}}}function mu(n,e,t){let{$$slots:r={},$$scope:o}=e,{style:l}=e,s,u,f=!1;Si("setCamera",!window.location.hash),Cn(()=>{s=new ri.Map({container:u,style:`https://api.maptiler.com/maps/${l}/style.json?key=MZEJTanw3WpxRvt7qDfo`,hash:!0}),s.addControl(new ri.ScaleControl),s.addControl(new ri.NavigationControl({visualizePitch:!0}),"bottom-right"),s.on("load",()=>{t(1,f=!0),Mt.set(s)}),new ResizeObserver(()=>{s.resize()}).observe(u)}),ki(()=>{s.remove()});function c(p){ze[p?"unshift":"push"](()=>{u=p,t(0,u)})}return n.$$set=p=>{"style"in p&&t(2,l=p.style),"$$scope"in p&&t(3,o=p.$$scope)},[u,f,l,o,r,c]}class _u extends ke{constructor(e){super(),Te(this,e,mu,gu,Ce,{style:2})}}const bu=n=>({}),ll=n=>({}),vu=n=>({}),sl=n=>({}),yu=n=>({}),al=n=>({});function wu(n){let e,t,r,o,l,s,u,f,c,p,v,m;const h=n[3].nav,g=_t(h,n,n[2],al),b=n[3].sidebar,C=_t(b,n,n[2],sl),B=n[3].main,M=_t(B,n,n[2],ll);return{c(){e=R("aside"),t=R("div"),r=R("nav"),g&&g.c(),o=q(),C&&C.c(),l=q(),s=R("div"),s.textContent="",f=q(),c=R("main"),M&&M.c(),Y(r,"class","svelte-19nerxn"),Y(t,"class","sidebar-content content-container svelte-19nerxn"),Y(s,"class","sidebar-toggle rounded-rect svelte-19nerxn"),Y(e,"class",u=yo(n[0]?"":"collapsed")+" svelte-19nerxn"),Y(c,"class","svelte-19nerxn")},m(k,P){A(k,e,P),I(e,t),I(t,r),g&&g.m(r,null),I(t,o),C&&C.m(t,null),I(e,l),I(e,s),A(k,f,P),A(k,c,P),M&&M.m(c,null),p=!0,v||(m=Q(s,"click",n[1]),v=!0)},p(k,[P]){g&&g.p&&(!p||P&4)&&bt(g,h,k,k[2],p?yt(h,k[2],P,yu):vt(k[2]),al),C&&C.p&&(!p||P&4)&&bt(C,b,k,k[2],p?yt(b,k[2],P,vu):vt(k[2]),sl),(!p||P&1&&u!==(u=yo(k[0]?"":"collapsed")+" svelte-19nerxn"))&&Y(e,"class",u),M&&M.p&&(!p||P&4)&&bt(M,B,k,k[2],p?yt(B,k[2],P,bu):vt(k[2]),ll)},i(k){p||(j(g,k),j(C,k),j(M,k),p=!0)},o(k){V(g,k),V(C,k),V(M,k),p=!1},d(k){k&&x(e),g&&g.d(k),C&&C.d(k),k&&x(f),k&&x(c),M&&M.d(k),v=!1,m()}}}function Eu(n,e,t){let{$$slots:r={},$$scope:o}=e,l=!0;function s(){t(0,l=!l)}return n.$$set=u=>{"$$scope"in u&&t(2,o=u.$$scope)},[l,s,o,r]}class Su extends ke{constructor(e){super(),Te(this,e,Eu,wu,Ce,{})}}var mt=63710088e-1,ku={centimeters:mt*100,centimetres:mt*100,degrees:mt/111325,feet:mt*3.28084,inches:mt*39.37,kilometers:mt/1e3,kilometres:mt/1e3,meters:mt,metres:mt,miles:mt/1609.344,millimeters:mt*1e3,millimetres:mt*1e3,nauticalmiles:mt/1852,radians:1,yards:mt*1.0936};function Vn(n,e,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=n,r}function Tu(n,e,t){t===void 0&&(t={});for(var r=0,o=n;r<o.length;r++){var l=o[r];if(l.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<l[l.length-1].length;s++)if(l[l.length-1][s]!==l[0][s])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:n};return Vn(u,e,t)}function Cu(n,e,t){if(t===void 0&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:n};return Vn(r,e,t)}function Ou(n,e,t){t===void 0&&(t={});var r={type:"MultiPolygon",coordinates:n};return Vn(r,e,t)}function Iu(n,e){e===void 0&&(e="kilometers");var t=ku[e];if(!t)throw new Error(e+" units is invalid");return n*t}function Tr(n){var e=n%360;return e*Math.PI/180}/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Mu(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,o,l,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(c){return function(p){return f([c,p])}}function f(c){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(l=c[0]&2?o.return:c[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,c[1])).done)return l;switch(o=0,l&&(c=[c[0]&2,l.value]),c[0]){case 0:case 1:l=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,o=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!l||c[1]>l[0]&&c[1]<l[3])){t.label=c[1];break}if(c[0]===6&&t.label<l[1]){t.label=l[1],l=c;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(c);break}l[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(p){c=[6,p],o=0}finally{r=l=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var en=function(){function n(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return n}();function Lu(n,e){return n>e?1:n<e?-1:0}function Xt(n,e,t){for(var r=new en(null,null),o=r,l=r;;){var s=t(n,e.key);if(s<0){if(e.left===null)break;if(t(n,e.left.key)<0){var u=e.left;if(e.left=u.right,u.right=e,e=u,e.left===null)break}l.left=e,l=e,e=e.left}else if(s>0){if(e.right===null)break;if(t(n,e.right.key)>0){var u=e.right;if(e.right=u.left,u.left=e,e=u,e.right===null)break}o.right=e,o=e,e=e.right}else break}return o.right=e.left,l.left=e.right,e.left=r.right,e.right=r.left,e}function ii(n,e,t,r){var o=new en(n,e);if(t===null)return o.left=o.right=null,o;t=Xt(n,t,r);var l=r(n,t.key);return l<0?(o.left=t.left,o.right=t,t.left=null):l>=0&&(o.right=t.right,o.left=t,t.right=null),o}function ul(n,e,t){var r=null,o=null;if(e){e=Xt(n,e,t);var l=t(e.key,n);l===0?(r=e.left,o=e.right):l<0?(o=e.right,e.right=null,r=e):(r=e.left,e.left=null,o=e)}return{left:r,right:o}}function Pu(n,e,t){return e===null?n:(n===null||(e=Xt(n.key,e,t),e.left=n),e)}function ui(n,e,t,r,o){if(n){r(""+e+(t?" ":" ")+o(n)+`
`);var l=e+(t?"    ":"   ");n.left&&ui(n.left,l,!1,r,o),n.right&&ui(n.right,l,!0,r,o)}}var Ii=function(){function n(e){e===void 0&&(e=Lu),this._root=null,this._size=0,this._comparator=e}return n.prototype.insert=function(e,t){return this._size++,this._root=ii(e,t,this._root,this._comparator)},n.prototype.add=function(e,t){var r=new en(e,t);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var o=this._comparator,l=Xt(e,this._root,o),s=o(e,l.key);return s===0?this._root=l:(s<0?(r.left=l.left,r.right=l,l.left=null):s>0&&(r.right=l.right,r.left=l,l.right=null),this._size++,this._root=r),this._root},n.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},n.prototype._remove=function(e,t,r){var o;if(t===null)return null;t=Xt(e,t,r);var l=r(e,t.key);return l===0?(t.left===null?o=t.right:(o=Xt(e,t.left,r),o.right=t.right),this._size--,o):t},n.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Xt(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},n.prototype.findStatic=function(e){for(var t=this._root,r=this._comparator;t;){var o=r(e,t.key);if(o===0)return t;o<0?t=t.left:t=t.right}return null},n.prototype.find=function(e){return this._root&&(this._root=Xt(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},n.prototype.contains=function(e){for(var t=this._root,r=this._comparator;t;){var o=r(e,t.key);if(o===0)return!0;o<0?t=t.left:t=t.right}return!1},n.prototype.forEach=function(e,t){for(var r=this._root,o=[],l=!1;!l;)r!==null?(o.push(r),r=r.left):o.length!==0?(r=o.pop(),e.call(t,r),r=r.right):l=!0;return this},n.prototype.range=function(e,t,r,o){for(var l=[],s=this._comparator,u=this._root,f;l.length!==0||u;)if(u)l.push(u),u=u.left;else{if(u=l.pop(),f=s(u.key,t),f>0)break;if(s(u.key,e)>=0&&r.call(o,u))return this;u=u.right}return this},n.prototype.keys=function(){var e=[];return this.forEach(function(t){var r=t.key;return e.push(r)}),e},n.prototype.values=function(){var e=[];return this.forEach(function(t){var r=t.data;return e.push(r)}),e},n.prototype.min=function(){return this._root?this.minNode(this._root).key:null},n.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},n.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},n.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},n.prototype.at=function(e){for(var t=this._root,r=!1,o=0,l=[];!r;)if(t)l.push(t),t=t.left;else if(l.length>0){if(t=l.pop(),o===e)return t;o++,t=t.right}else r=!0;return null},n.prototype.next=function(e){var t=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var o=this._comparator;t;){var l=o(e.key,t.key);if(l===0)break;l<0?(r=t,t=t.left):t=t.right}return r},n.prototype.prev=function(e){var t=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var o=this._comparator;t;){var l=o(e.key,t.key);if(l===0)break;l<0?t=t.left:(r=t,t=t.right)}return r},n.prototype.clear=function(){return this._root=null,this._size=0,this},n.prototype.toList=function(){return xu(this._root)},n.prototype.load=function(e,t,r){t===void 0&&(t=[]),r===void 0&&(r=!1);var o=e.length,l=this._comparator;if(r&&di(e,t,0,o-1,l),this._root===null)this._root=fi(e,t,0,o),this._size=o;else{var s=Nu(this.toList(),Au(e,t),l);o=this._size+o,this._root=ci({head:s},0,o)}return this},n.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var t=[];return ui(this._root,"",!0,function(r){return t.push(r)},e),t.join("")},n.prototype.update=function(e,t,r){var o=this._comparator,l=ul(e,this._root,o),s=l.left,u=l.right;o(e,t)<0?u=ii(t,r,u,o):s=ii(t,r,s,o),this._root=Pu(s,u,o)},n.prototype.split=function(e){return ul(e,this._root,this._comparator)},n.prototype[Symbol.iterator]=function(){var e;return Mu(this,function(t){switch(t.label){case 0:e=this.minNode(),t.label=1;case 1:return e?[4,e]:[3,3];case 2:return t.sent(),e=this.next(e),[3,1];case 3:return[2]}})},n}();function fi(n,e,t,r){var o=r-t;if(o>0){var l=t+Math.floor(o/2),s=n[l],u=e[l],f=new en(s,u);return f.left=fi(n,e,t,l),f.right=fi(n,e,l+1,r),f}return null}function Au(n,e){for(var t=new en(null,null),r=t,o=0;o<n.length;o++)r=r.next=new en(n[o],e[o]);return r.next=null,t.next}function xu(n){for(var e=n,t=[],r=!1,o=new en(null,null),l=o;!r;)e?(t.push(e),e=e.left):t.length>0?(e=l=l.next=t.pop(),e=e.right):r=!0;return l.next=null,o.next}function ci(n,e,t){var r=t-e;if(r>0){var o=e+Math.floor(r/2),l=ci(n,e,o),s=n.head;return s.left=l,n.head=n.head.next,s.right=ci(n,o+1,t),s}return null}function Nu(n,e,t){for(var r=new en(null,null),o=r,l=n,s=e;l!==null&&s!==null;)t(l.key,s.key)<0?(o.next=l,l=l.next):(o.next=s,s=s.next),o=o.next;return l!==null?o.next=l:s!==null&&(o.next=s),r.next}function di(n,e,t,r,o){if(!(t>=r)){for(var l=n[t+r>>1],s=t-1,u=r+1;;){do s++;while(o(n[s],l)<0);do u--;while(o(n[u],l)>0);if(s>=u)break;var f=n[s];n[s]=n[u],n[u]=f,f=e[s],e[s]=e[u],e[u]=f}di(n,e,t,u,o),di(n,e,u+1,r,o)}}function kt(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function fl(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function dt(n,e,t){return e&&fl(n.prototype,e),t&&fl(n,t),n}var Dn=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},hi=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,o=e.ur.x<t.ur.x?e.ur.x:t.ur.x,l=e.ll.y<t.ll.y?t.ll.y:e.ll.y,s=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:r,y:l},ur:{x:o,y:s}}},Kt=Number.EPSILON;Kt===void 0&&(Kt=Math.pow(2,-52));var Ru=Kt*Kt,pi=function(e,t){if(-Kt<e&&e<Kt&&-Kt<t&&t<Kt)return 0;var r=e-t;return r*r<Ru*e*t?0:e<t?-1:1},Fu=function(){function n(){kt(this,n),this.reset()}return dt(n,[{key:"reset",value:function(){this.xRounder=new cl,this.yRounder=new cl}},{key:"round",value:function(t,r){return{x:this.xRounder.round(t),y:this.yRounder.round(r)}}}]),n}(),cl=function(){function n(){kt(this,n),this.tree=new Ii,this.round(0)}return dt(n,[{key:"round",value:function(t){var r=this.tree.add(t),o=this.tree.prev(r);if(o!==null&&pi(r.key,o.key)===0)return this.tree.remove(t),o.key;var l=this.tree.next(r);return l!==null&&pi(r.key,l.key)===0?(this.tree.remove(t),l.key):t}}]),n}(),qn=new Fu,Bn=function(e,t){return e.x*t.y-e.y*t.x},Al=function(e,t){return e.x*t.x+e.y*t.y},dl=function(e,t,r){var o={x:t.x-e.x,y:t.y-e.y},l={x:r.x-e.x,y:r.y-e.y},s=Bn(o,l);return pi(s,0)},xr=function(e){return Math.sqrt(Al(e,e))},Du=function(e,t,r){var o={x:t.x-e.x,y:t.y-e.y},l={x:r.x-e.x,y:r.y-e.y};return Bn(l,o)/xr(l)/xr(o)},Uu=function(e,t,r){var o={x:t.x-e.x,y:t.y-e.y},l={x:r.x-e.x,y:r.y-e.y};return Al(l,o)/xr(l)/xr(o)},hl=function(e,t,r){return t.y===0?null:{x:e.x+t.x/t.y*(r-e.y),y:r}},pl=function(e,t,r){return t.x===0?null:{x:r,y:e.y+t.y/t.x*(r-e.x)}},ju=function(e,t,r,o){if(t.x===0)return pl(r,o,e.x);if(o.x===0)return pl(e,t,r.x);if(t.y===0)return hl(r,o,e.y);if(o.y===0)return hl(e,t,r.y);var l=Bn(t,o);if(l==0)return null;var s={x:r.x-e.x,y:r.y-e.y},u=Bn(s,t)/l,f=Bn(s,o)/l,c=e.x+f*t.x,p=r.x+u*o.x,v=e.y+f*t.y,m=r.y+u*o.y,h=(c+p)/2,g=(v+m)/2;return{x:h,y:g}},xt=function(){dt(n,null,[{key:"compare",value:function(t,r){var o=n.comparePoints(t.point,r.point);return o!==0?o:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:Nr.compare(t.segment,r.segment))}},{key:"comparePoints",value:function(t,r){return t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0}}]);function n(e,t){kt(this,n),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}return dt(n,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var r=t.point.events,o=0,l=r.length;o<l;o++){var s=r[o];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,r=0;r<t;r++){var o=this.point.events[r];if(o.segment.consumedBy===void 0)for(var l=r+1;l<t;l++){var s=this.point.events[l];s.consumedBy===void 0&&o.otherSE.point.events===s.otherSE.point.events&&o.segment.consume(s.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],r=0,o=this.point.events.length;r<o;r++){var l=this.point.events[r];l!==this&&!l.segment.ringOut&&l.segment.isInResult()&&t.push(l)}return t}},{key:"getLeftmostComparator",value:function(t){var r=this,o=new Map,l=function(u){var f=u.otherSE;o.set(u,{sine:Du(r.point,t.point,f.point),cosine:Uu(r.point,t.point,f.point)})};return function(s,u){o.has(s)||l(s),o.has(u)||l(u);var f=o.get(s),c=f.sine,p=f.cosine,v=o.get(u),m=v.sine,h=v.cosine;return c>=0&&m>=0?p<h?1:p>h?-1:0:c<0&&m<0?p<h?-1:p>h?1:0:m<c?-1:m>c?1:0}}}]),n}(),Bu=0,Nr=function(){dt(n,null,[{key:"compare",value:function(t,r){var o=t.leftSE.point.x,l=r.leftSE.point.x,s=t.rightSE.point.x,u=r.rightSE.point.x;if(u<o)return 1;if(s<l)return-1;var f=t.leftSE.point.y,c=r.leftSE.point.y,p=t.rightSE.point.y,v=r.rightSE.point.y;if(o<l){if(c<f&&c<p)return 1;if(c>f&&c>p)return-1;var m=t.comparePoint(r.leftSE.point);if(m<0)return 1;if(m>0)return-1;var h=r.comparePoint(t.rightSE.point);return h!==0?h:-1}if(o>l){if(f<c&&f<v)return-1;if(f>c&&f>v)return 1;var g=r.comparePoint(t.leftSE.point);if(g!==0)return g;var b=t.comparePoint(r.rightSE.point);return b<0?1:b>0?-1:1}if(f<c)return-1;if(f>c)return 1;if(s<u){var C=r.comparePoint(t.rightSE.point);if(C!==0)return C}if(s>u){var B=t.comparePoint(r.rightSE.point);if(B<0)return 1;if(B>0)return-1}if(s!==u){var M=p-f,k=s-o,P=v-c,N=u-l;if(M>k&&P<N)return 1;if(M<k&&P>N)return-1}return s>u?1:s<u||p<v?-1:p>v?1:t.id<r.id?-1:t.id>r.id?1:0}}]);function n(e,t,r,o){kt(this,n),this.id=++Bu,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=r,this.windings=o}return dt(n,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<r?t:r},ur:{x:this.rightSE.point.x,y:t>r?t:r}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var r=this.leftSE.point,o=this.rightSE.point,l=this.vector();if(r.x===o.x)return t.x===r.x?0:t.x<r.x?1:-1;var s=(t.y-r.y)/l.y,u=r.x+s*l.x;if(t.x===u)return 0;var f=(t.x-r.x)/l.x,c=r.y+f*l.y;return t.y===c?0:t.y<c?-1:1}},{key:"getIntersection",value:function(t){var r=this.bbox(),o=t.bbox(),l=hi(r,o);if(l===null)return null;var s=this.leftSE.point,u=this.rightSE.point,f=t.leftSE.point,c=t.rightSE.point,p=Dn(r,f)&&this.comparePoint(f)===0,v=Dn(o,s)&&t.comparePoint(s)===0,m=Dn(r,c)&&this.comparePoint(c)===0,h=Dn(o,u)&&t.comparePoint(u)===0;if(v&&p)return h&&!m?u:!h&&m?c:null;if(v)return m&&s.x===c.x&&s.y===c.y?null:s;if(p)return h&&u.x===f.x&&u.y===f.y?null:f;if(h&&m)return null;if(h)return u;if(m)return c;var g=ju(s,this.vector(),f,t.vector());return g===null||!Dn(l,g)?null:qn.round(g.x,g.y)}},{key:"split",value:function(t){var r=[],o=t.events!==void 0,l=new xt(t,!0),s=new xt(t,!1),u=this.rightSE;this.replaceRightSE(s),r.push(s),r.push(l);var f=new n(l,u,this.rings.slice(),this.windings.slice());return xt.comparePoints(f.leftSE.point,f.rightSE.point)>0&&f.swapEvents(),xt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(l.checkForConsuming(),s.checkForConsuming()),r}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var r=0,o=this.windings.length;r<o;r++)this.windings[r]*=-1}},{key:"consume",value:function(t){for(var r=this,o=t;r.consumedBy;)r=r.consumedBy;for(;o.consumedBy;)o=o.consumedBy;var l=n.compare(r,o);if(l!==0){if(l>0){var s=r;r=o,o=s}if(r.prev===o){var u=r;r=o,o=u}for(var f=0,c=o.rings.length;f<c;f++){var p=o.rings[f],v=o.windings[f],m=r.rings.indexOf(p);m===-1?(r.rings.push(p),r.windings.push(v)):r.windings[m]+=v}o.rings=null,o.windings=null,o.consumedBy=r,o.leftSE.consumedBy=r.leftSE,o.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var r=this._afterState.rings,o=this._afterState.windings,l=this._afterState.multiPolys,s=0,u=this.rings.length;s<u;s++){var f=this.rings[s],c=this.windings[s],p=r.indexOf(f);p===-1?(r.push(f),o.push(c)):o[p]+=c}for(var v=[],m=[],h=0,g=r.length;h<g;h++)if(o[h]!==0){var b=r[h],C=b.poly;if(m.indexOf(C)===-1)if(b.isExterior)v.push(C);else{m.indexOf(C)===-1&&m.push(C);var B=v.indexOf(b.poly);B!==-1&&v.splice(B,1)}}for(var M=0,k=v.length;M<k;M++){var P=v[M].multiPoly;l.indexOf(P)===-1&&l.push(P)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var t=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(Ot.type){case"union":{var o=t.length===0,l=r.length===0;this._isInResult=o!==l;break}case"intersection":{var s,u;t.length<r.length?(s=t.length,u=r.length):(s=r.length,u=t.length),this._isInResult=u===Ot.numMultiPolys&&s<u;break}case"xor":{var f=Math.abs(t.length-r.length);this._isInResult=f%2===1;break}case"difference":{var c=function(v){return v.length===1&&v[0].isSubject};this._isInResult=c(t)!==c(r);break}default:throw new Error("Unrecognized operation type found ".concat(Ot.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,r,o){var l,s,u,f=xt.comparePoints(t,r);if(f<0)l=t,s=r,u=1;else if(f>0)l=r,s=t,u=-1;else throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));var c=new xt(l,!0),p=new xt(s,!1);return new n(c,p,[o],[u])}}]),n}(),gl=function(){function n(e,t,r){if(kt(this,n),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=qn.round(e[0][0],e[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var l=o,s=1,u=e.length;s<u;s++){if(typeof e[s][0]!="number"||typeof e[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var f=qn.round(e[s][0],e[s][1]);f.x===l.x&&f.y===l.y||(this.segments.push(Nr.fromRing(l,f,this)),f.x<this.bbox.ll.x&&(this.bbox.ll.x=f.x),f.y<this.bbox.ll.y&&(this.bbox.ll.y=f.y),f.x>this.bbox.ur.x&&(this.bbox.ur.x=f.x),f.y>this.bbox.ur.y&&(this.bbox.ur.y=f.y),l=f)}(o.x!==l.x||o.y!==l.y)&&this.segments.push(Nr.fromRing(l,o,this))}return dt(n,[{key:"getSweepEvents",value:function(){for(var t=[],r=0,o=this.segments.length;r<o;r++){var l=this.segments[r];t.push(l.leftSE),t.push(l.rightSE)}return t}}]),n}(),Gu=function(){function n(e,t){if(kt(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new gl(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,o=e.length;r<o;r++){var l=new gl(e[r],this,!1);l.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=l.bbox.ll.x),l.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=l.bbox.ll.y),l.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=l.bbox.ur.x),l.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=l.bbox.ur.y),this.interiorRings.push(l)}this.multiPoly=t}return dt(n,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),r=0,o=this.interiorRings.length;r<o;r++)for(var l=this.interiorRings[r].getSweepEvents(),s=0,u=l.length;s<u;s++)t.push(l[s]);return t}}]),n}(),ml=function(){function n(e,t){if(kt(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,o=e.length;r<o;r++){var l=new Gu(e[r],this);l.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=l.bbox.ll.x),l.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=l.bbox.ll.y),l.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=l.bbox.ur.x),l.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=l.bbox.ur.y),this.polys.push(l)}this.isSubject=t}return dt(n,[{key:"getSweepEvents",value:function(){for(var t=[],r=0,o=this.polys.length;r<o;r++)for(var l=this.polys[r].getSweepEvents(),s=0,u=l.length;s<u;s++)t.push(l[s]);return t}}]),n}(),zu=function(){dt(n,null,[{key:"factory",value:function(t){for(var r=[],o=0,l=t.length;o<l;o++){var s=t[o];if(!(!s.isInResult()||s.ringOut)){for(var u=null,f=s.leftSE,c=s.rightSE,p=[f],v=f.point,m=[];u=f,f=c,p.push(f),f.point!==v;)for(;;){var h=f.getAvailableLinkedEvents();if(h.length===0){var g=p[0].point,b=p[p.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(g.x,",")+" ".concat(g.y,"]. Last matching segment found ends at")+" [".concat(b.x,", ").concat(b.y,"]."))}if(h.length===1){c=h[0].otherSE;break}for(var C=null,B=0,M=m.length;B<M;B++)if(m[B].point===f.point){C=B;break}if(C!==null){var k=m.splice(C)[0],P=p.splice(k.index);P.unshift(P[0].otherSE),r.push(new n(P.reverse()));continue}m.push({index:p.length,point:f.point});var N=f.getLeftmostComparator(u);c=h.sort(N)[0].otherSE;break}r.push(new n(p))}}return r}}]);function n(e){kt(this,n),this.events=e;for(var t=0,r=e.length;t<r;t++)e[t].segment.ringOut=this;this.poly=null}return dt(n,[{key:"getGeom",value:function(){for(var t=this.events[0].point,r=[t],o=1,l=this.events.length-1;o<l;o++){var s=this.events[o].point,u=this.events[o+1].point;dl(s,t,u)!==0&&(r.push(s),t=s)}if(r.length===1)return null;var f=r[0],c=r[1];dl(f,t,c)===0&&r.shift(),r.push(r[0]);for(var p=this.isExteriorRing()?1:-1,v=this.isExteriorRing()?0:r.length-1,m=this.isExteriorRing()?r.length:-1,h=[],g=v;g!=m;g+=p)h.push([r[g].x,r[g].y]);return h}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],r=1,o=this.events.length;r<o;r++){var l=this.events[r];xt.compare(t,l)>0&&(t=l)}for(var s=t.segment.prevInResult(),u=s?s.prevInResult():null;;){if(!s)return null;if(!u)return s.ringOut;if(u.ringOut!==s.ringOut)return u.ringOut.enclosingRing()!==s.ringOut?s.ringOut:s.ringOut.enclosingRing();s=u.prevInResult(),u=s?s.prevInResult():null}}}]),n}(),_l=function(){function n(e){kt(this,n),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return dt(n,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(var r=0,o=this.interiorRings.length;r<o;r++){var l=this.interiorRings[r].getGeom();l!==null&&t.push(l)}return t}}]),n}(),Vu=function(){function n(e){kt(this,n),this.rings=e,this.polys=this._composePolys(e)}return dt(n,[{key:"getGeom",value:function(){for(var t=[],r=0,o=this.polys.length;r<o;r++){var l=this.polys[r].getGeom();l!==null&&t.push(l)}return t}},{key:"_composePolys",value:function(t){for(var r=[],o=0,l=t.length;o<l;o++){var s=t[o];if(!s.poly)if(s.isExteriorRing())r.push(new _l(s));else{var u=s.enclosingRing();u.poly||r.push(new _l(u)),u.poly.addInterior(s)}}return r}}]),n}(),qu=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nr.compare;kt(this,n),this.queue=e,this.tree=new Ii(t),this.segments=[]}return dt(n,[{key:"process",value:function(t){var r=t.segment,o=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(r),o;var l=t.isLeft?this.tree.insert(r):this.tree.find(r);if(!l)throw new Error("Unable to find segment #".concat(r.id," ")+"[".concat(r.leftSE.point.x,", ").concat(r.leftSE.point.y,"] -> ")+"[".concat(r.rightSE.point.x,", ").concat(r.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var s=l,u=l,f=void 0,c=void 0;f===void 0;)s=this.tree.prev(s),s===null?f=null:s.key.consumedBy===void 0&&(f=s.key);for(;c===void 0;)u=this.tree.next(u),u===null?c=null:u.key.consumedBy===void 0&&(c=u.key);if(t.isLeft){var p=null;if(f){var v=f.getIntersection(r);if(v!==null&&(r.isAnEndpoint(v)||(p=v),!f.isAnEndpoint(v)))for(var m=this._splitSafely(f,v),h=0,g=m.length;h<g;h++)o.push(m[h])}var b=null;if(c){var C=c.getIntersection(r);if(C!==null&&(r.isAnEndpoint(C)||(b=C),!c.isAnEndpoint(C)))for(var B=this._splitSafely(c,C),M=0,k=B.length;M<k;M++)o.push(B[M])}if(p!==null||b!==null){var P=null;if(p===null)P=b;else if(b===null)P=p;else{var N=xt.comparePoints(p,b);P=N<=0?p:b}this.queue.remove(r.rightSE),o.push(r.rightSE);for(var D=r.split(P),me=0,G=D.length;me<G;me++)o.push(D[me])}o.length>0?(this.tree.remove(r),o.push(t)):(this.segments.push(r),r.prev=f)}else{if(f&&c){var se=f.getIntersection(c);if(se!==null){if(!f.isAnEndpoint(se))for(var ae=this._splitSafely(f,se),U=0,ee=ae.length;U<ee;U++)o.push(ae[U]);if(!c.isAnEndpoint(se))for(var te=this._splitSafely(c,se),ue=0,K=te.length;ue<K;ue++)o.push(te[ue])}}this.tree.remove(r)}return o}},{key:"_splitSafely",value:function(t,r){this.tree.remove(t);var o=t.rightSE;this.queue.remove(o);var l=t.split(r);return l.push(o),t.consumedBy===void 0&&this.tree.insert(t),l}}]),n}(),bl=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ju=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Yu=function(){function n(){kt(this,n)}return dt(n,[{key:"run",value:function(t,r,o){Ot.type=t,qn.reset();for(var l=[new ml(r,!0)],s=0,u=o.length;s<u;s++)l.push(new ml(o[s],!1));if(Ot.numMultiPolys=l.length,Ot.type==="difference")for(var f=l[0],c=1;c<l.length;)hi(l[c].bbox,f.bbox)!==null?c++:l.splice(c,1);if(Ot.type==="intersection"){for(var p=0,v=l.length;p<v;p++)for(var m=l[p],h=p+1,g=l.length;h<g;h++)if(hi(m.bbox,l[h].bbox)===null)return[]}for(var b=new Ii(xt.compare),C=0,B=l.length;C<B;C++)for(var M=l[C].getSweepEvents(),k=0,P=M.length;k<P;k++)if(b.insert(M[k]),b.size>bl)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var N=new qu(b),D=b.size,me=b.pop();me;){var G=me.key;if(b.size===D){var se=G.segment;throw new Error("Unable to pop() ".concat(G.isLeft?"left":"right"," SweepEvent ")+"[".concat(G.point.x,", ").concat(G.point.y,"] from segment #").concat(se.id," ")+"[".concat(se.leftSE.point.x,", ").concat(se.leftSE.point.y,"] -> ")+"[".concat(se.rightSE.point.x,", ").concat(se.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(b.size>bl)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(N.segments.length>Ju)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var ae=N.process(G),U=0,ee=ae.length;U<ee;U++){var te=ae[U];te.consumedBy===void 0&&b.insert(te)}D=b.size,me=b.pop()}qn.reset();var ue=zu.factory(N.segments),K=new Vu(ue);return K.getGeom()}}]),n}(),Ot=new Yu,Wu=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Ot.run("union",e,r)},Hu=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Ot.run("intersection",e,r)},Zu=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Ot.run("xor",e,r)},Xu=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Ot.run("difference",e,r)},Or={union:Wu,intersection:Hu,xor:Zu,difference:Xu};function Ku(n,e){var t=$u(e),r=null;return n.type==="FeatureCollection"?r=Qu(n):r=xl(Or.union(n.geometry.coordinates)),r.geometry.coordinates.forEach(function(o){t.geometry.coordinates.push(o[0])}),t}function Qu(n){var e=n.features.length===2?Or.union(n.features[0].geometry.coordinates,n.features[1].geometry.coordinates):Or.union.apply(Or,n.features.map(function(t){return t.geometry.coordinates}));return xl(e)}function xl(n){return Ou(n)}function $u(n){var e=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]],t=n&&n.geometry.coordinates||e;return Tu(t)}const ef={"line-cap":"round","line-join":"round"},Nl=["==","$type","Polygon"],Rl=["==","$type","LineString"],Fl=["==","$type","Point"];function gi(n,e,t=1){return{type:"line",layout:ef,paint:{"line-color":n,"line-width":e,"line-opacity":t}}}function Dl(n,e){return{type:"fill",paint:{"fill-color":n,"fill-opacity":e}}}function Ul(n,e,t=1){return{type:"circle",paint:{"circle-radius":e,"circle-color":n,"circle-opacity":t}}}function Mi(n,e,t){if(n.getSource(e)){let r=[];for(let o of n.getStyle().layers)o.source==e&&r.push(o.id);for(let o of r)n.removeLayer(o);n.removeSource(e)}n.addSource(e,t)}function cn(n,e,t=null){n.getLayer(e.id)&&n.removeLayer(e.id),t&&!n.getLayer(t)&&(t=null),n.addLayer(e,t)}function tf(n,e,t){let r;He(n,Mt,s=>t(1,r=s));let{boundaryGeojson:o}=e;return Dr("setCamera")&&r.fitBounds(Ti(o),{padding:20,animate:!1}),Mi(r,"boundary",{type:"geojson",data:Ku(o)}),cn(r,{id:"boundary",source:"boundary",...Dl("black",.5)}),n.$$set=s=>{"boundaryGeojson"in s&&t(0,o=s.boundaryGeojson)},[o]}class nf extends ke{constructor(e){super(),Te(this,e,tf,null,Ce,{boundaryGeojson:0})}}function rf(n){let e,t,r,o,l,s,u,f;return e=new kr({props:{labelText:"Area",value:"area"}}),r=new kr({props:{labelText:"Route",value:"route"}}),l=new kr({props:{labelText:"Crossing",value:"crossing"}}),u=new kr({props:{labelText:"Other",value:"other"}}),{c(){de(e.$$.fragment),t=q(),de(r.$$.fragment),o=q(),de(l.$$.fragment),s=q(),de(u.$$.fragment)},m(c,p){he(e,c,p),A(c,t,p),he(r,c,p),A(c,o,p),he(l,c,p),A(c,s,p),he(u,c,p),f=!0},p:Re,i(c){f||(j(e.$$.fragment,c),j(r.$$.fragment,c),j(l.$$.fragment,c),j(u.$$.fragment,c),f=!0)},o(c){V(e.$$.fragment,c),V(r.$$.fragment,c),V(l.$$.fragment,c),V(u.$$.fragment,c),f=!1},d(c){pe(e,c),c&&x(t),pe(r,c),c&&x(o),pe(l,c),c&&x(s),pe(u,c)}}}function vl(n){let e,t,r=yl(n[3])+"",o,l,s;return{c(){e=R("p"),t=ge("Length: "),o=ge(r),l=q(),s=R("br")},m(u,f){A(u,e,f),I(e,t),I(e,o),A(u,l,f),A(u,s,f)},p(u,f){f&8&&r!==(r=yl(u[3])+"")&&Be(o,r)},d(u){u&&x(e),u&&x(l),u&&x(s)}}}function of(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g,b,C,B,M,k,P,N,D,me;function G(K){n[7](K)}let se={labelText:"Name"};n[0]!==void 0&&(se.value=n[0]),e=new ou({props:se}),ze.push(()=>st(e,"value",G,n[0]));function ae(K){n[8](K)}let U={$$slots:{default:[rf]},$$scope:{ctx:n}};n[1]!==void 0&&(U.selected=n[1]),s=new Ja({props:U}),ze.push(()=>st(s,"selected",ae,n[1]));function ee(K){n[9](K)}let te={labelText:"Description"};n[2]!==void 0&&(te.value=n[2]),v=new Ka({props:te}),ze.push(()=>st(v,"value",ee,n[2]));let ue=n[3]&&vl(n);return{c(){de(e.$$.fragment),r=q(),o=R("br"),l=q(),de(s.$$.fragment),f=q(),c=R("br"),p=q(),de(v.$$.fragment),h=q(),g=R("br"),b=q(),ue&&ue.c(),C=q(),B=R("div"),M=R("button"),M.textContent="Delete",k=q(),P=R("button"),P.textContent="Save",Y(M,"type","button"),Y(P,"type","button"),fn(P,"float","right")},m(K,oe){he(e,K,oe),A(K,r,oe),A(K,o,oe),A(K,l,oe),he(s,K,oe),A(K,f,oe),A(K,c,oe),A(K,p,oe),he(v,K,oe),A(K,h,oe),A(K,g,oe),A(K,b,oe),ue&&ue.m(K,oe),A(K,C,oe),A(K,B,oe),I(B,M),I(B,k),I(B,P),n[11](B),N=!0,D||(me=[Q(M,"click",n[5]),Q(P,"click",n[10])],D=!0)},p(K,[oe]){const Le={};!t&&oe&1&&(t=!0,Le.value=K[0],at(()=>t=!1)),e.$set(Le);const Me={};oe&4096&&(Me.$$scope={dirty:oe,ctx:K}),!u&&oe&2&&(u=!0,Me.selected=K[1],at(()=>u=!1)),s.$set(Me);const Oe={};!m&&oe&4&&(m=!0,Oe.value=K[2],at(()=>m=!1)),v.$set(Oe),K[3]?ue?ue.p(K,oe):(ue=vl(K),ue.c(),ue.m(C.parentNode,C)):ue&&(ue.d(1),ue=null)},i(K){N||(j(e.$$.fragment,K),j(s.$$.fragment,K),j(v.$$.fragment,K),N=!0)},o(K){V(e.$$.fragment,K),V(s.$$.fragment,K),V(v.$$.fragment,K),N=!1},d(K){pe(e,K),K&&x(r),K&&x(o),K&&x(l),pe(s,K),K&&x(f),K&&x(c),K&&x(p),pe(v,K),K&&x(h),K&&x(g),K&&x(b),ue&&ue.d(K),K&&x(C),K&&x(B),n[11](null),D=!1,pt(me)}}}function yl(n){return n<1e3?Math.round(n)+" m":(n/1e3).toFixed(1)+"km"}function lf(n,e,t){let{id:r}=e,{name:o}=e,{intervention_type:l}=e,{description:s}=e,{length_meters:u}=e,f;Oi.subscribe(b=>{r==b&&setTimeout(()=>f==null?void 0:f.scrollIntoView({behavior:"smooth"}),1)});function c(){je.update(b=>(b.features=b.features.filter(C=>C.id!=r),b)),Ar(null)}function p(b){o=b,t(0,o)}function v(b){l=b,t(1,l)}function m(b){s=b,t(2,s)}const h=()=>Ar(null);function g(b){ze[b?"unshift":"push"](()=>{f=b,t(4,f)})}return n.$$set=b=>{"id"in b&&t(6,r=b.id),"name"in b&&t(0,o=b.name),"intervention_type"in b&&t(1,l=b.intervention_type),"description"in b&&t(2,s=b.description),"length_meters"in b&&t(3,u=b.length_meters)},[o,l,s,u,f,c,r,p,v,m,h,g]}class sf extends ke{constructor(e){super(),Te(this,e,lf,of,Ce,{id:6,name:0,intervention_type:1,description:2,length_meters:3})}}function wl(n,e,t){const r=n.slice();return r[10]=e[t],r[11]=e,r[12]=t,r}function af(n){let e,t,r,o,l,s;function u(v){n[5](v,n[10])}function f(v){n[6](v,n[10])}function c(v){n[7](v,n[10])}let p={id:n[10].id,length_meters:n[10].properties.length_meters};return n[10].properties.name!==void 0&&(p.name=n[10].properties.name),n[10].properties.intervention_type!==void 0&&(p.intervention_type=n[10].properties.intervention_type),n[10].properties.description!==void 0&&(p.description=n[10].properties.description),e=new sf({props:p}),ze.push(()=>st(e,"name",u,n[10].properties.name)),ze.push(()=>st(e,"intervention_type",f,n[10].properties.intervention_type)),ze.push(()=>st(e,"description",c,n[10].properties.description)),{c(){de(e.$$.fragment),l=q()},m(v,m){he(e,v,m),A(v,l,m),s=!0},p(v,m){n=v;const h={};m&1&&(h.id=n[10].id),m&1&&(h.length_meters=n[10].properties.length_meters),!t&&m&1&&(t=!0,h.name=n[10].properties.name,at(()=>t=!1)),!r&&m&1&&(r=!0,h.intervention_type=n[10].properties.intervention_type,at(()=>r=!1)),!o&&m&1&&(o=!0,h.description=n[10].properties.description,at(()=>o=!1)),e.$set(h)},i(v){s||(j(e.$$.fragment,v),s=!0)},o(v){V(e.$$.fragment,v),s=!1},d(v){pe(e,v),v&&x(l)}}}function uf(n){let e=n[12]+1+"",t,r,o=Rr(n[10])+"",l;return{c(){t=ge(e),r=ge(") "),l=ge(o)},m(s,u){A(s,t,u),A(s,r,u),A(s,l,u)},p(s,u){u&1&&o!==(o=Rr(s[10])+"")&&Be(l,o)},d(s){s&&x(t),s&&x(r),s&&x(l)}}}function ff(n){let e,t=n[12]+1+"",r,o,l=Rr(n[10])+"",s;return{c(){e=R("strong"),r=ge(t),o=ge(") "),s=ge(l)},m(u,f){A(u,e,f),I(e,r),I(e,o),I(e,s)},p(u,f){f&1&&l!==(l=Rr(u[10])+"")&&Be(s,l)},d(u){u&&x(e)}}}function cf(n){let e;function t(l,s){return l[10].id==l[1]?ff:uf}let r=t(n),o=r(n);return{c(){o.c(),e=q()},m(l,s){o.m(l,s),A(l,e,s)},p(l,s){r===(r=t(l))&&o?o.p(l,s):(o.d(1),o=r(l),o&&(o.c(),o.m(e.parentNode,e)))},d(l){o.d(l),l&&x(e)}}}function El(n){let e,t,r;function o(s){n[8](s,n[10])}let l={$$slots:{title:[cf],default:[af]},$$scope:{ctx:n}};return n[10].properties.editing!==void 0&&(l.open=n[10].properties.editing),e=new va({props:l}),ze.push(()=>st(e,"open",o,n[10].properties.editing)),e.$on("click",function(){wo(n[3](n[10].id))&&n[3](n[10].id).apply(this,arguments)}),e.$on("mouseenter",function(){wo(n[2](n[10].id))&&n[2](n[10].id).apply(this,arguments)}),e.$on("mouseleave",n[2](null)),{c(){de(e.$$.fragment)},m(s,u){he(e,s,u),r=!0},p(s,u){n=s;const f={};u&8195&&(f.$$scope={dirty:u,ctx:n}),!t&&u&1&&(t=!0,f.open=n[10].properties.editing,at(()=>t=!1)),e.$set(f)},i(s){r||(j(e.$$.fragment,s),r=!0)},o(s){V(e.$$.fragment,s),r=!1},d(s){pe(e,s)}}}function df(n){let e,t,r=n[0].features,o=[];for(let s=0;s<r.length;s+=1)o[s]=El(wl(n,r,s));const l=s=>V(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=Hn()},m(s,u){for(let f=0;f<o.length;f+=1)o[f].m(s,u);A(s,e,u),t=!0},p(s,u){if(u&15){r=s[0].features;let f;for(f=0;f<r.length;f+=1){const c=wl(s,r,f);o[f]?(o[f].p(c,u),j(o[f],1)):(o[f]=El(c),o[f].c(),j(o[f],1),o[f].m(e.parentNode,e))}for(rt(),f=r.length;f<o.length;f+=1)l(f);it()}},i(s){if(!t){for(let u=0;u<r.length;u+=1)j(o[u]);t=!0}},o(s){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)V(o[u]);t=!1},d(s){Il(o,s),s&&x(e)}}}function hf(n){let e,t,r,o;return e=new ha({props:{$$slots:{default:[df]},$$scope:{ctx:n}}}),{c(){de(e.$$.fragment)},m(l,s){he(e,l,s),t=!0,r||(o=Q(window,"keydown",n[4]),r=!0)},p(l,[s]){const u={};s&8195&&(u.$$scope={dirty:s,ctx:l}),e.$set(u)},i(l){t||(j(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){pe(e,l),r=!1,o()}}}function Rr(n){if(n.properties.name)return n.properties.name;var e=n.properties.intervention_type;return e=="other"&&(n.geometry.type=="Point"?e="point":n.geometry.type=="LineString"?e="line":e="polygon"),`Untitled ${e}`}function pf(n,e,t){let r,o,l;He(n,Oi,h=>t(9,r=h)),He(n,je,h=>t(0,o=h)),He(n,Gt,h=>t(1,l=h));function s(h){r==null&&Gt.set(h)}function u(h){si.set(null),si.set(h);for(let g of o.features)if(g.properties.editing&&g.id!=h){delete g.properties.editing;return}}function f(h){const g=r;if(h.key=="Delete"){const b=h.originalTarget.tagName;if(b!="CANVAS"&&b!="BODY")return;h.preventDefault(),je.update(C=>(C.features=C.features.filter(B=>B.id!=g),C))}}function c(h,g){n.$$.not_equal(g.properties.name,h)&&(g.properties.name=h,je.set(o))}function p(h,g){n.$$.not_equal(g.properties.intervention_type,h)&&(g.properties.intervention_type=h,je.set(o))}function v(h,g){n.$$.not_equal(g.properties.description,h)&&(g.properties.description=h,je.set(o))}function m(h,g){n.$$.not_equal(g.properties.editing,h)&&(g.properties.editing=h,je.set(o))}return[o,l,s,u,f,c,p,v,m]}class gf extends ke{constructor(e){super(),Te(this,e,pf,hf,Ce,{})}}function Sl(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function mf(n,e,t){t===void 0&&(t={});var r=Sl(n),o=Sl(e),l=Tr(o[1]-r[1]),s=Tr(o[0]-r[0]),u=Tr(r[1]),f=Tr(o[1]),c=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(u)*Math.cos(f);return Iu(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),t.units)}function jl(n,e,t){if(n!==null)for(var r,o,l,s,u,f,c,p=0,v=0,m,h=n.type,g=h==="FeatureCollection",b=h==="Feature",C=g?n.features.length:1,B=0;B<C;B++){c=g?n.features[B].geometry:b?n.geometry:n,m=c?c.type==="GeometryCollection":!1,u=m?c.geometries.length:1;for(var M=0;M<u;M++){var k=0,P=0;if(s=m?c.geometries[M]:c,s!==null){f=s.coordinates;var N=s.type;switch(p=t&&(N==="Polygon"||N==="MultiPolygon")?1:0,N){case null:break;case"Point":if(e(f,v,B,k,P)===!1)return!1;v++,k++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(e(f[r],v,B,k,P)===!1)return!1;v++,N==="MultiPoint"&&k++}N==="LineString"&&k++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(o=0;o<f[r].length-p;o++){if(e(f[r][o],v,B,k,P)===!1)return!1;v++}N==="MultiLineString"&&k++,N==="Polygon"&&P++}N==="Polygon"&&k++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(P=0,o=0;o<f[r].length;o++){for(l=0;l<f[r][o].length-p;l++){if(e(f[r][o][l],v,B,k,P)===!1)return!1;v++}P++}k++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(jl(s.geometries[r],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function _f(n,e){var t,r,o,l,s,u,f,c,p,v,m=0,h=n.type==="FeatureCollection",g=n.type==="Feature",b=h?n.features.length:1;for(t=0;t<b;t++){for(u=h?n.features[t].geometry:g?n.geometry:n,c=h?n.features[t].properties:g?n.properties:{},p=h?n.features[t].bbox:g?n.bbox:void 0,v=h?n.features[t].id:g?n.id:void 0,f=u?u.type==="GeometryCollection":!1,s=f?u.geometries.length:1,o=0;o<s;o++){if(l=f?u.geometries[o]:u,l===null){if(e(null,m,c,p,v)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(l,m,c,p,v)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<l.geometries.length;r++)if(e(l.geometries[r],m,c,p,v)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}m++}}function bf(n,e){_f(n,function(t,r,o,l,s){var u=t===null?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return e(Vn(t,o,{bbox:l,id:s}),r,0)===!1?!1:void 0}var f;switch(u){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var c=0;c<t.coordinates.length;c++){var p=t.coordinates[c],v={type:f,coordinates:p};if(e(Vn(v,o),r,c)===!1)return!1}})}function vf(n,e){bf(n,function(t,r,o){var l=0;if(t.geometry){var s=t.geometry.type;if(!(s==="Point"||s==="MultiPoint")){var u,f=0,c=0,p=0;if(jl(t,function(v,m,h,g,b){if(u===void 0||r>f||g>c||b>p){u=v,f=r,c=g,p=b,l=0;return}var C=Cu([u,v],t.properties);if(e(C,r,o,b,l)===!1)return!1;l++,u=v})===!1)return!1}}})}function yf(n,e,t){var r=t,o=!1;return vf(n,function(l,s,u,f,c){o===!1&&t===void 0?r=l:r=e(r,l,s,u,f,c),o=!0}),r}function wf(n,e){return e===void 0&&(e={}),yf(n,function(t,r){var o=r.geometry.coordinates;return t+mf(o[0],o[1],e)},0)}function Ef(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g,b,C,B,M,k,P=n[0].features.length+"",N,D,me,G,se,ae,U,ee;return{c(){e=R("div"),t=R("label"),r=ge(`Scheme name:
    `),o=R("input"),l=q(),s=R("br"),u=q(),f=R("div"),c=R("label"),p=R("input"),v=q(),m=R("button"),m.textContent="Load from GeoJSON",h=q(),g=R("button"),g.textContent="Export to GeoJSON",b=q(),C=R("br"),B=q(),M=R("div"),k=R("span"),N=ge(P),D=ge(" interventions"),me=q(),G=R("button"),se=ge("Clear all"),Y(o,"type","text"),Y(p,"type","file"),Y(p,"id","load_geojson"),Y(p,"class","svelte-lhyd1e"),Y(m,"type","button"),Y(m,"onclick","document.getElementById('load_geojson').click();"),Y(g,"type","button"),Y(g,"class","align-right svelte-lhyd1e"),Y(G,"type","button"),Y(G,"class","align-right svelte-lhyd1e"),G.disabled=ae=n[0].features.length==0},m(te,ue){A(te,e,ue),I(e,t),I(t,r),I(t,o),Tn(o,n[0].scheme_name),A(te,l,ue),A(te,s,ue),A(te,u,ue),A(te,f,ue),I(f,c),I(c,p),I(c,v),I(c,m),I(f,h),I(f,g),A(te,b,ue),A(te,C,ue),A(te,B,ue),A(te,M,ue),I(M,k),I(k,N),I(k,D),I(M,me),I(M,G),I(G,se),U||(ee=[Q(o,"input",n[5]),Q(p,"change",n[3]),Q(g,"click",n[2]),Q(G,"click",n[1])],U=!0)},p(te,[ue]){ue&1&&o.value!==te[0].scheme_name&&Tn(o,te[0].scheme_name),ue&1&&P!==(P=te[0].features.length+"")&&Be(N,P),ue&1&&ae!==(ae=te[0].features.length==0)&&(G.disabled=ae)},i:Re,o:Re,d(te){te&&x(e),te&&x(l),te&&x(s),te&&x(u),te&&x(f),te&&x(b),te&&x(C),te&&x(B),te&&x(M),U=!1,pt(ee)}}}function Sf(n,e){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8, "+encodeURIComponent(e)),t.setAttribute("download",n),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function kf(n,e,t){let r;He(n,je,m=>t(0,r=m));let{authorityName:o}=e,l=window.localStorage.getItem(o);if(l)try{je.set(p(JSON.parse(l)))}catch(m){console.log(`Failed to load from local storage: ${m}`)}je.subscribe(()=>window.localStorage.setItem(o,JSON.stringify(u())));function s(){confirm("Do you want to clear the current scheme? (You should save it first!)")&&je.update(m=>(delete m.scheme_name,m.features=[],m))}function u(){const m=JSON.parse(JSON.stringify(r));for(let h of m.features)delete h.properties.editing,delete h.properties.hide_while_editing;return m}function f(){let m=u();var h=o;m.authority=o,m.origin="atip-v1",m.scheme_name&&(h+="_"+m.scheme_name),h+=".txt",Sf(h,JSON.stringify(m,null,"  "))}function c(m){const h=new FileReader;h.onload=g=>{try{je.set(p(JSON.parse(g.target.result)))}catch(b){window.alert(`Couldn't load scheme from a file: ${b}`)}},h.readAsText(m.target.files[0])}function p(m){let h=0;for(let g of m.features)g.geometry.type=="LineString"&&!g.properties.length_meters&&(g.properties.length_meters=wf(g.geometry,{units:"kilometers"})*1e3),Number.isInteger(g.id)||(g.id=h),h++;return m}function v(){r.scheme_name=this.value,je.set(r)}return n.$$set=m=>{"authorityName"in m&&t(4,o=m.authorityName)},[r,s,f,c,o,v]}class Tf extends ke{constructor(e){super(),Te(this,e,kf,Ef,Ce,{authorityName:4})}}const Cf="/atip/draw_v3/assets/zoom_out_map-b2e1091a.svg";function Of(n){let e,t,r,o,l;return{c(){e=R("button"),t=R("img"),qs(t.src,r=Cf)||Y(t,"src",r),Y(t,"alt","Zoom to show entire boundary"),Y(e,"type","button"),Y(e,"title","Zoom to show entire boundary"),Y(e,"class","svelte-qzjsqo")},m(s,u){A(s,e,u),I(e,t),o||(l=Q(e,"click",n[0]),o=!0)},p:Re,i:Re,o:Re,d(s){s&&x(e),o=!1,l()}}}function If(n,e,t){let r;He(n,Mt,s=>t(2,r=s));let{boundaryGeojson:o}=e;function l(){r.fitBounds(Ti(o),{padding:20,animate:!0,duration:500})}return n.$$set=s=>{"boundaryGeojson"in s&&t(1,o=s.boundaryGeojson)},[l,o]}class Mf extends ke{constructor(e){super(),Te(this,e,If,Of,Ce,{boundaryGeojson:1})}}function Lf(n){let e,t,r,o,l,s,u;return{c(){e=R("div"),t=ge(`Basemap:
  `),r=R("select"),o=R("option"),o.textContent="Streets",l=R("option"),l.textContent="Satellite",o.__value="streets",o.value=o.__value,l.__value="hybrid",l.value=l.__value,n[0]===void 0&&Js(()=>n[2].call(r)),Y(e,"class","svelte-1tbnm6i")},m(f,c){A(f,e,c),I(e,t),I(e,r),I(r,o),I(r,l),Eo(r,n[0]),s||(u=[Q(r,"change",n[2]),Q(r,"change",n[1])],s=!0)},p(f,[c]){c&1&&Eo(r,f[0])},i:Re,o:Re,d(f){f&&x(e),s=!1,pt(u)}}}function Pf(n,e,t){let{style:r}=e;function o(){let s=new URLSearchParams(window.location.search);s.set("style",r);let u=`${window.location.pathname}?${s.toString()}${window.location.hash}`;window.location.href=u}function l(){r=Ys(this),t(0,r)}return n.$$set=s=>{"style"in s&&t(0,r=s.style)},[r,o,l]}class Af extends ke{constructor(e){super(),Te(this,e,Pf,Lf,Ce,{style:0})}}const It={area:"#e41a1c",route:"#377eb8",crossing:"#4daf4a",other:"#984ea3",hovering:"black"},Bl=10,mi=10;function xf(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g,b,C,B,M,k;return{c(){e=R("div"),t=R("h1"),t.textContent="Interventions",r=q(),o=R("ul"),l=R("li"),s=R("span"),u=ge("Areas"),f=q(),c=R("li"),p=R("span"),v=ge("Routes"),m=q(),h=R("li"),g=R("span"),b=ge("Crossings"),C=q(),B=R("li"),M=R("span"),k=ge("Other"),Y(t,"class","svelte-p551i1"),Y(s,"class","svelte-p551i1"),fn(s,"background",It.area),Y(p,"class","svelte-p551i1"),fn(p,"background",It.route),Y(g,"class","svelte-p551i1"),fn(g,"background",It.crossing),Y(M,"class","svelte-p551i1"),fn(M,"background",It.other),Y(e,"class","svelte-p551i1")},m(P,N){A(P,e,N),I(e,t),I(e,r),I(e,o),I(o,l),I(l,s),I(l,u),I(o,f),I(o,c),I(c,p),I(c,v),I(o,m),I(o,h),I(h,g),I(h,b),I(o,C),I(o,B),I(B,M),I(B,k)},p:Re,i:Re,o:Re,d(P){P&&x(e)}}}class Nf extends ke{constructor(e){super(),Te(this,e,null,xf,Ce,{})}}let Un="interventions";function Rf(n,e,t){let r,o;He(n,Mt,u=>t(0,r=u)),He(n,je,u=>t(1,o=u)),Mi(r,Un,{type:"geojson",data:o});const l=["match",["get","intervention_type"],"area",It.area,"route",It.route,"crossing",It.crossing,"other",It.other,"white"],s=["!=","hide_while_editing",!0];return cn(r,{id:"interventions-points",source:Un,filter:["all",Fl,s],...Ul(l,Bl)}),cn(r,{id:"interventions-lines",source:Un,filter:["all",Rl,s],...gi(l,mi)}),cn(r,{id:"interventions-polygons",source:Un,filter:["all",Nl,s],...Dl(l,.5)},"hover-polygons"),n.$$.update=()=>{n.$$.dirty&3&&r.getSource(Un).setData(o)},[r,o]}class Ff extends ke{constructor(e){super(),Te(this,e,Rf,null,Ce,{})}}let Sn="hover";function Df(n,e,t){let r,o;return He(n,Mt,l=>t(0,r=l)),He(n,je,l=>t(1,o=l)),Mi(r,Sn,{type:"geojson",data:ai()}),cn(r,{id:"hover-polygons",source:Sn,filter:Nl,...gi(It.hovering,.5*mi,1)}),cn(r,{id:"hover-lines",source:Sn,filter:Rl,...gi(It.hovering,1.5*mi,1)},"interventions-lines"),cn(r,{id:"hover-points",source:Sn,filter:Fl,...Ul(It.hovering,1.5*Bl,1)},"interventions-points"),Gt.subscribe(l=>{l!=null?r.getSource(Sn).setData(o.features.find(s=>s.id==l)):r.getSource(Sn).setData(ai())}),[]}class Uf extends ke{constructor(e){super(),Te(this,e,Df,null,Ce,{})}}function jf(n,e,t){let r,o;return He(n,Mt,l=>t(0,r=l)),He(n,je,l=>t(1,o=l)),si.subscribe(l=>{if(l){let s=o.features.find(u=>u.id==l);s.geometry.type=="Point"?r.flyTo({center:s.geometry.coordinates}):r.fitBounds(Ti(s),{padding:200,animate:!0,duration:500})}}),[]}class Bf extends ke{constructor(e){super(),Te(this,e,jf,null,Ce,{})}}var _i={},Gf={get exports(){return _i},set exports(n){_i=n}};(function(n,e){(function(t,r){n.exports=r()})(Fn,function(){var t=function(i,a){var d={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},_={on:function(w,E,z){if(d[w]===void 0)throw new Error("Invalid event type: "+w);d[w].push({selector:E,fn:z})},render:function(w){a.store.featureChanged(w)}},y=function(w,E){for(var z=d[w],J=z.length;J--;){var X=z[J];if(X.selector(E)){X.fn.call(_,E)||a.store.render(),a.ui.updateMapClasses();break}}};return i.start.call(_),{render:i.render,stop:function(){i.stop&&i.stop()},trash:function(){i.trash&&(i.trash(),a.store.render())},combineFeatures:function(){i.combineFeatures&&i.combineFeatures()},uncombineFeatures:function(){i.uncombineFeatures&&i.uncombineFeatures()},drag:function(w){y("drag",w)},click:function(w){y("click",w)},mousemove:function(w){y("mousemove",w)},mousedown:function(w){y("mousedown",w)},mouseup:function(w){y("mouseup",w)},mouseout:function(w){y("mouseout",w)},keydown:function(w){y("keydown",w)},keyup:function(w){y("keyup",w)},touchstart:function(w){y("touchstart",w)},touchmove:function(w){y("touchmove",w)},touchend:function(w){y("touchend",w)},tap:function(w){y("tap",w)}}};function r(i){if(i.__esModule)return i;var a=i.default;if(typeof a=="function"){var d=function _(){if(this instanceof _){var y=[null];y.push.apply(y,arguments);var w=Function.bind.apply(a,y);return new w}return a.apply(this,arguments)};d.prototype=a.prototype}else d={};return Object.defineProperty(d,"__esModule",{value:!0}),Object.keys(i).forEach(function(_){var y=Object.getOwnPropertyDescriptor(i,_);Object.defineProperty(d,_,y.get?y:{enumerable:!0,get:function(){return i[_]}})}),d}var o={},l={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},s=l;function u(i){var a=0;if(i&&i.length>0){a+=Math.abs(f(i[0]));for(var d=1;d<i.length;d++)a-=Math.abs(f(i[d]))}return a}function f(i){var a,d,_,y,w,E,z=0,J=i.length;if(J>2){for(E=0;E<J;E++)E===J-2?(_=J-2,y=J-1,w=0):E===J-1?(_=J-1,y=0,w=1):(_=E,y=E+1,w=E+2),a=i[_],d=i[y],z+=(c(i[w][0])-c(a[0]))*Math.sin(c(d[1]));z=z*s.RADIUS*s.RADIUS/2}return z}function c(i){return i*Math.PI/180}o.geometry=function i(a){var d,_=0;switch(a.type){case"Polygon":return u(a.coordinates);case"MultiPolygon":for(d=0;d<a.coordinates.length;d++)_+=u(a.coordinates[d]);return _;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(d=0;d<a.geometries.length;d++)_+=i(a.geometries[d]);return _}},o.ring=f;var p={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},v={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},m={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},h={POLYGON:"polygon",LINE:"line_string",POINT:"point"},g={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},b={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},C={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},B={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},M={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},k={ACTIVE:"true",INACTIVE:"false"},P=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],N=-85,D=Object.freeze({__proto__:null,classes:p,sources:v,cursors:m,types:h,geojsonTypes:g,modes:b,events:C,updateActions:B,meta:M,activeStates:k,interactions:P,LAT_MIN:-90,LAT_RENDERED_MIN:N,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),me={Point:0,LineString:1,MultiLineString:1,Polygon:2};function G(i,a){var d=me[i.geometry.type]-me[a.geometry.type];return d===0&&i.geometry.type===g.POLYGON?i.area-a.area:d}function se(i){return i.map(function(a){return a.geometry.type===g.POLYGON&&(a.area=o.geometry({type:g.FEATURE,property:{},geometry:a.geometry})),a}).sort(G).map(function(a){return delete a.area,a})}function ae(i,a){return a===void 0&&(a=0),[[i.point.x-a,i.point.y-a],[i.point.x+a,i.point.y+a]]}function U(i){if(this._items={},this._nums={},this._length=i?i.length:0,i)for(var a=0,d=i.length;a<d;a++)this.add(i[a]),i[a]!==void 0&&(typeof i[a]=="string"?this._items[i[a]]=a:this._nums[i[a]]=a)}U.prototype.add=function(i){return this.has(i)||(this._length++,typeof i=="string"?this._items[i]=this._length:this._nums[i]=this._length),this},U.prototype.delete=function(i){return this.has(i)===!1||(this._length--,delete this._items[i],delete this._nums[i]),this},U.prototype.has=function(i){return(typeof i=="string"||typeof i=="number")&&(this._items[i]!==void 0||this._nums[i]!==void 0)},U.prototype.values=function(){var i=this,a=[];return Object.keys(this._items).forEach(function(d){a.push({k:d,v:i._items[d]})}),Object.keys(this._nums).forEach(function(d){a.push({k:JSON.parse(d),v:i._nums[d]})}),a.sort(function(d,_){return d.v-_.v}).map(function(d){return d.k})},U.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ee=[M.FEATURE,M.MIDPOINT,M.VERTEX],te={click:function(i,a,d){return ue(i,a,d,d.options.clickBuffer)},touch:function(i,a,d){return ue(i,a,d,d.options.touchBuffer)}};function ue(i,a,d,_){if(d.map===null)return[];var y=i?ae(i,_):a,w={};d.options.styles&&(w.layers=d.options.styles.map(function(X){return X.id}));var E=d.map.queryRenderedFeatures(y,w).filter(function(X){return ee.indexOf(X.properties.meta)!==-1}),z=new U,J=[];return E.forEach(function(X){var Z=X.properties.id;z.has(Z)||(z.add(Z),J.push(X))}),se(J)}function K(i,a){var d=te.click(i,null,a),_={mouse:m.NONE};return d[0]&&(_.mouse=d[0].properties.active===k.ACTIVE?m.MOVE:m.POINTER,_.feature=d[0].properties.meta),a.events.currentModeName().indexOf("draw")!==-1&&(_.mouse=m.ADD),a.ui.queueMapClasses(_),a.ui.updateMapClasses(),d[0]}function oe(i,a){var d=i.x-a.x,_=i.y-a.y;return Math.sqrt(d*d+_*_)}function Le(i,a,d){d===void 0&&(d={});var _=d.fineTolerance!=null?d.fineTolerance:4,y=d.grossTolerance!=null?d.grossTolerance:12,w=d.interval!=null?d.interval:500;i.point=i.point||a.point,i.time=i.time||a.time;var E=oe(i.point,a.point);return E<_||E<y&&a.time-i.time<w}function Me(i,a,d){d===void 0&&(d={});var _=d.tolerance!=null?d.tolerance:25,y=d.interval!=null?d.interval:250;return i.point=i.point||a.point,i.time=i.time||a.time,oe(i.point,a.point)<_&&a.time-i.time<y}var Oe={},Ie={get exports(){return Oe},set exports(i){Oe=i}}.exports=function(i,a){if(a||(a=16),i===void 0&&(i=128),i<=0)return"0";for(var d=Math.log(Math.pow(2,i))/Math.log(a),_=2;d===1/0;_*=2)d=Math.log(Math.pow(2,i/_))/Math.log(a)*_;var y=d-Math.floor(d),w="";for(_=0;_<Math.floor(d);_++)w=Math.floor(Math.random()*a).toString(a)+w;if(y){var E=Math.pow(a,y);w=Math.floor(Math.random()*E).toString(a)+w}var z=parseInt(w,a);return z!==1/0&&z>=Math.pow(2,i)?Ie(i,a):w};Ie.rack=function(i,a,d){var _=function(w){var E=0;do{if(E++>10){if(!d)throw new Error("too many ID collisions, use more bits");i+=d}var z=Ie(i,a)}while(Object.hasOwnProperty.call(y,z));return y[z]=w,z},y=_.hats={};return _.get=function(w){return _.hats[w]},_.set=function(w,E){return _.hats[w]=E,_},_.bits=i||128,_.base=a||16,_};var we=function(i,a){this.ctx=i,this.properties=a.properties||{},this.coordinates=a.geometry.coordinates,this.id=a.id||Oe(),this.type=a.geometry.type};we.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},we.prototype.incomingCoords=function(i){this.setCoordinates(i)},we.prototype.setCoordinates=function(i){this.coordinates=i,this.changed()},we.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},we.prototype.setProperty=function(i,a){this.properties[i]=a},we.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:g.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},we.prototype.internal=function(i){var a={id:this.id,meta:M.FEATURE,"meta:type":this.type,active:k.INACTIVE,mode:i};if(this.ctx.options.userProperties)for(var d in this.properties)a["user_"+d]=this.properties[d];return{type:g.FEATURE,properties:a,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var O=function(i,a){we.call(this,i,a)};(O.prototype=Object.create(we.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},O.prototype.updateCoordinate=function(i,a,d){this.coordinates=arguments.length===3?[a,d]:[i,a],this.changed()},O.prototype.getCoordinate=function(){return this.getCoordinates()};var ne=function(i,a){we.call(this,i,a)};(ne.prototype=Object.create(we.prototype)).isValid=function(){return this.coordinates.length>1},ne.prototype.addCoordinate=function(i,a,d){this.changed();var _=parseInt(i,10);this.coordinates.splice(_,0,[a,d])},ne.prototype.getCoordinate=function(i){var a=parseInt(i,10);return JSON.parse(JSON.stringify(this.coordinates[a]))},ne.prototype.removeCoordinate=function(i){this.changed(),this.coordinates.splice(parseInt(i,10),1)},ne.prototype.updateCoordinate=function(i,a,d){var _=parseInt(i,10);this.coordinates[_]=[a,d],this.changed()};var lt=function(i,a){we.call(this,i,a),this.coordinates=this.coordinates.map(function(d){return d.slice(0,-1)})};(lt.prototype=Object.create(we.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(i){return i.length>2})},lt.prototype.incomingCoords=function(i){this.coordinates=i.map(function(a){return a.slice(0,-1)}),this.changed()},lt.prototype.setCoordinates=function(i){this.coordinates=i,this.changed()},lt.prototype.addCoordinate=function(i,a,d){this.changed();var _=i.split(".").map(function(y){return parseInt(y,10)});this.coordinates[_[0]].splice(_[1],0,[a,d])},lt.prototype.removeCoordinate=function(i){this.changed();var a=i.split(".").map(function(_){return parseInt(_,10)}),d=this.coordinates[a[0]];d&&(d.splice(a[1],1),d.length<3&&this.coordinates.splice(a[0],1))},lt.prototype.getCoordinate=function(i){var a=i.split(".").map(function(_){return parseInt(_,10)}),d=this.coordinates[a[0]];return JSON.parse(JSON.stringify(d[a[1]]))},lt.prototype.getCoordinates=function(){return this.coordinates.map(function(i){return i.concat([i[0]])})},lt.prototype.updateCoordinate=function(i,a,d){this.changed();var _=i.split("."),y=parseInt(_[0],10),w=parseInt(_[1],10);this.coordinates[y]===void 0&&(this.coordinates[y]=[]),this.coordinates[y][w]=[a,d]};var hn={MultiPoint:O,MultiLineString:ne,MultiPolygon:lt},zt=function(i,a,d,_,y){var w=d.split("."),E=parseInt(w[0],10),z=w[1]?w.slice(1).join("."):null;return i[E][a](z,_,y)},Xe=function(i,a){if(we.call(this,i,a),delete this.coordinates,this.model=hn[a.geometry.type],this.model===void 0)throw new TypeError(a.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(a.geometry.coordinates)};function be(i){this.map=i.map,this.drawConfig=JSON.parse(JSON.stringify(i.options||{})),this._ctx=i}(Xe.prototype=Object.create(we.prototype))._coordinatesToFeatures=function(i){var a=this,d=this.model.bind(this);return i.map(function(_){return new d(a.ctx,{id:Oe(),type:g.FEATURE,properties:{},geometry:{coordinates:_,type:a.type.replace("Multi","")}})})},Xe.prototype.isValid=function(){return this.features.every(function(i){return i.isValid()})},Xe.prototype.setCoordinates=function(i){this.features=this._coordinatesToFeatures(i),this.changed()},Xe.prototype.getCoordinate=function(i){return zt(this.features,"getCoordinate",i)},Xe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(i){return i.type===g.POLYGON?i.getCoordinates():i.coordinates})))},Xe.prototype.updateCoordinate=function(i,a,d){zt(this.features,"updateCoordinate",i,a,d),this.changed()},Xe.prototype.addCoordinate=function(i,a,d){zt(this.features,"addCoordinate",i,a,d),this.changed()},Xe.prototype.removeCoordinate=function(i){zt(this.features,"removeCoordinate",i),this.changed()},Xe.prototype.getFeatures=function(){return this.features},be.prototype.setSelected=function(i){return this._ctx.store.setSelected(i)},be.prototype.setSelectedCoordinates=function(i){var a=this;this._ctx.store.setSelectedCoordinates(i),i.reduce(function(d,_){return d[_.feature_id]===void 0&&(d[_.feature_id]=!0,a._ctx.store.get(_.feature_id).changed()),d},{})},be.prototype.getSelected=function(){return this._ctx.store.getSelected()},be.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},be.prototype.isSelected=function(i){return this._ctx.store.isSelected(i)},be.prototype.getFeature=function(i){return this._ctx.store.get(i)},be.prototype.select=function(i){return this._ctx.store.select(i)},be.prototype.deselect=function(i){return this._ctx.store.deselect(i)},be.prototype.deleteFeature=function(i,a){return a===void 0&&(a={}),this._ctx.store.delete(i,a)},be.prototype.addFeature=function(i){return this._ctx.store.add(i)},be.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},be.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},be.prototype.setActionableState=function(i){i===void 0&&(i={});var a={trash:i.trash||!1,combineFeatures:i.combineFeatures||!1,uncombineFeatures:i.uncombineFeatures||!1};return this._ctx.events.actionable(a)},be.prototype.changeMode=function(i,a,d){return a===void 0&&(a={}),d===void 0&&(d={}),this._ctx.events.changeMode(i,a,d)},be.prototype.updateUIClasses=function(i){return this._ctx.ui.queueMapClasses(i)},be.prototype.activateUIButton=function(i){return this._ctx.ui.setActiveButton(i)},be.prototype.featuresAt=function(i,a,d){if(d===void 0&&(d="click"),d!=="click"&&d!=="touch")throw new Error("invalid buffer type");return te[d](i,a,this._ctx)},be.prototype.newFeature=function(i){var a=i.geometry.type;return a===g.POINT?new O(this._ctx,i):a===g.LINE_STRING?new ne(this._ctx,i):a===g.POLYGON?new lt(this._ctx,i):new Xe(this._ctx,i)},be.prototype.isInstanceOf=function(i,a){if(i===g.POINT)return a instanceof O;if(i===g.LINE_STRING)return a instanceof ne;if(i===g.POLYGON)return a instanceof lt;if(i==="MultiFeature")return a instanceof Xe;throw new Error("Unknown feature class: "+i)},be.prototype.doRender=function(i){return this._ctx.store.featureChanged(i)},be.prototype.onSetup=function(){},be.prototype.onDrag=function(){},be.prototype.onClick=function(){},be.prototype.onMouseMove=function(){},be.prototype.onMouseDown=function(){},be.prototype.onMouseUp=function(){},be.prototype.onMouseOut=function(){},be.prototype.onKeyUp=function(){},be.prototype.onKeyDown=function(){},be.prototype.onTouchStart=function(){},be.prototype.onTouchMove=function(){},be.prototype.onTouchEnd=function(){},be.prototype.onTap=function(){},be.prototype.onStop=function(){},be.prototype.onTrash=function(){},be.prototype.onCombineFeature=function(){},be.prototype.onUncombineFeature=function(){},be.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var $={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},jr=Object.keys($);function pn(i){var a=Object.keys(i);return function(d,_){_===void 0&&(_={});var y={},w=a.reduce(function(E,z){return E[z]=i[z],E},new be(d));return{start:function(){var E=this;y=w.onSetup(_),jr.forEach(function(z){var J,X=$[z],Z=function(){return!1};i[X]&&(Z=function(){return!0}),E.on(z,Z,(J=X,function(W){return w[J](y,W)}))})},stop:function(){w.onStop(y)},trash:function(){w.onTrash(y)},combineFeatures:function(){w.onCombineFeatures(y)},uncombineFeatures:function(){w.onUncombineFeatures(y)},render:function(E,z){w.toDisplayFeatures(y,E,z)}}}}function fe(i){return[].concat(i).filter(function(a){return a!==void 0})}function qe(){var i=this;if(!(i.ctx.map&&i.ctx.map.getSource(v.HOT)!==void 0))return J();var a=i.ctx.events.currentModeName();i.ctx.ui.queueMapClasses({mode:a});var d=[],_=[];i.isDirty?_=i.getAllIds():(d=i.getChangedIds().filter(function(X){return i.get(X)!==void 0}),_=i.sources.hot.filter(function(X){return X.properties.id&&d.indexOf(X.properties.id)===-1&&i.get(X.properties.id)!==void 0}).map(function(X){return X.properties.id})),i.sources.hot=[];var y=i.sources.cold.length;i.sources.cold=i.isDirty?[]:i.sources.cold.filter(function(X){var Z=X.properties.id||X.properties.parent;return d.indexOf(Z)===-1});var w=y!==i.sources.cold.length||_.length>0;function E(X,Z){var W=i.get(X).internal(a);i.ctx.events.currentModeRender(W,function(ce){i.sources[Z].push(ce)})}if(d.forEach(function(X){return E(X,"hot")}),_.forEach(function(X){return E(X,"cold")}),w&&i.ctx.map.getSource(v.COLD).setData({type:g.FEATURE_COLLECTION,features:i.sources.cold}),i.ctx.map.getSource(v.HOT).setData({type:g.FEATURE_COLLECTION,features:i.sources.hot}),i._emitSelectionChange&&(i.ctx.map.fire(C.SELECTION_CHANGE,{features:i.getSelected().map(function(X){return X.toGeoJSON()}),points:i.getSelectedCoordinates().map(function(X){return{type:g.FEATURE,properties:{},geometry:{type:g.POINT,coordinates:X.coordinates}}})}),i._emitSelectionChange=!1),i._deletedFeaturesToEmit.length){var z=i._deletedFeaturesToEmit.map(function(X){return X.toGeoJSON()});i._deletedFeaturesToEmit=[],i.ctx.map.fire(C.DELETE,{features:z})}function J(){i.isDirty=!1,i.clearChangedIds()}J(),i.ctx.map.fire(C.RENDER,{})}function Pe(i){var a,d=this;this._features={},this._featureIds=new U,this._selectedFeatureIds=new U,this._selectedCoordinates=[],this._changedFeatureIds=new U,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=i,this.sources={hot:[],cold:[]},this.render=function(){a||(a=requestAnimationFrame(function(){a=null,qe.call(d)}))},this.isDirty=!1}function gn(i,a){var d=i._selectedCoordinates.filter(function(_){return i._selectedFeatureIds.has(_.feature_id)});i._selectedCoordinates.length===d.length||a.silent||(i._emitSelectionChange=!0),i._selectedCoordinates=d}Pe.prototype.createRenderBatch=function(){var i=this,a=this.render,d=0;return this.render=function(){d++},function(){i.render=a,d>0&&i.render()}},Pe.prototype.setDirty=function(){return this.isDirty=!0,this},Pe.prototype.featureChanged=function(i){return this._changedFeatureIds.add(i),this},Pe.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Pe.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Pe.prototype.getAllIds=function(){return this._featureIds.values()},Pe.prototype.add=function(i){return this.featureChanged(i.id),this._features[i.id]=i,this._featureIds.add(i.id),this},Pe.prototype.delete=function(i,a){var d=this;return a===void 0&&(a={}),fe(i).forEach(function(_){d._featureIds.has(_)&&(d._featureIds.delete(_),d._selectedFeatureIds.delete(_),a.silent||d._deletedFeaturesToEmit.indexOf(d._features[_])===-1&&d._deletedFeaturesToEmit.push(d._features[_]),delete d._features[_],d.isDirty=!0)}),gn(this,a),this},Pe.prototype.get=function(i){return this._features[i]},Pe.prototype.getAll=function(){var i=this;return Object.keys(this._features).map(function(a){return i._features[a]})},Pe.prototype.select=function(i,a){var d=this;return a===void 0&&(a={}),fe(i).forEach(function(_){d._selectedFeatureIds.has(_)||(d._selectedFeatureIds.add(_),d._changedFeatureIds.add(_),a.silent||(d._emitSelectionChange=!0))}),this},Pe.prototype.deselect=function(i,a){var d=this;return a===void 0&&(a={}),fe(i).forEach(function(_){d._selectedFeatureIds.has(_)&&(d._selectedFeatureIds.delete(_),d._changedFeatureIds.add(_),a.silent||(d._emitSelectionChange=!0))}),gn(this,a),this},Pe.prototype.clearSelected=function(i){return i===void 0&&(i={}),this.deselect(this._selectedFeatureIds.values(),{silent:i.silent}),this},Pe.prototype.setSelected=function(i,a){var d=this;return a===void 0&&(a={}),i=fe(i),this.deselect(this._selectedFeatureIds.values().filter(function(_){return i.indexOf(_)===-1}),{silent:a.silent}),this.select(i.filter(function(_){return!d._selectedFeatureIds.has(_)}),{silent:a.silent}),this},Pe.prototype.setSelectedCoordinates=function(i){return this._selectedCoordinates=i,this._emitSelectionChange=!0,this},Pe.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Pe.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Pe.prototype.getSelected=function(){var i=this;return this._selectedFeatureIds.values().map(function(a){return i.get(a)})},Pe.prototype.getSelectedCoordinates=function(){var i=this;return this._selectedCoordinates.map(function(a){return{coordinates:i.get(a.feature_id).getCoordinate(a.coord_path)}})},Pe.prototype.isSelected=function(i){return this._selectedFeatureIds.has(i)},Pe.prototype.setFeatureProperty=function(i,a,d){this.get(i).setProperty(a,d),this.featureChanged(i)},Pe.prototype.storeMapConfig=function(){var i=this;P.forEach(function(a){i.ctx.map[a]&&(i._mapInitialConfig[a]=i.ctx.map[a].isEnabled())})},Pe.prototype.restoreMapConfig=function(){var i=this;Object.keys(this._mapInitialConfig).forEach(function(a){i._mapInitialConfig[a]?i.ctx.map[a].enable():i.ctx.map[a].disable()})},Pe.prototype.getInitialConfigValue=function(i){return this._mapInitialConfig[i]===void 0||this._mapInitialConfig[i]};var wt=function(){for(var i=arguments,a={},d=0;d<arguments.length;d++){var _=i[d];for(var y in _)Vt.call(_,y)&&(a[y]=_[y])}return a},Vt=Object.prototype.hasOwnProperty,Vl=["mode","feature","mouse"];function ql(i){var a=null,d=null,_={onRemove:function(){return i.map.off("load",_.connect),clearInterval(d),_.removeLayers(),i.store.restoreMapConfig(),i.ui.removeButtons(),i.events.removeEventListeners(),i.ui.clearMapClasses(),i.map=null,i.container=null,i.store=null,a&&a.parentNode&&a.parentNode.removeChild(a),a=null,this},connect:function(){i.map.off("load",_.connect),clearInterval(d),_.addLayers(),i.store.storeMapConfig(),i.events.addEventListeners()},onAdd:function(y){var w=y.fire;return y.fire=function(E,z){var J=arguments;return w.length===1&&arguments.length!==1&&(J=[wt({},{type:E},z)]),w.apply(y,J)},i.map=y,i.events=function(E){var z=Object.keys(E.options.modes).reduce(function(F,re){return F[re]=pn(E.options.modes[re]),F},{}),J={},X={},Z={},W=null,ce=null;Z.drag=function(F,re){re({point:F.point,time:new Date().getTime()})?(E.ui.queueMapClasses({mouse:m.DRAG}),ce.drag(F)):F.originalEvent.stopPropagation()},Z.mousedrag=function(F){Z.drag(F,function(re){return!Le(J,re)})},Z.touchdrag=function(F){Z.drag(F,function(re){return!Me(X,re)})},Z.mousemove=function(F){if((F.originalEvent.buttons!==void 0?F.originalEvent.buttons:F.originalEvent.which)===1)return Z.mousedrag(F);var re=K(F,E);F.featureTarget=re,ce.mousemove(F)},Z.mousedown=function(F){J={time:new Date().getTime(),point:F.point};var re=K(F,E);F.featureTarget=re,ce.mousedown(F)},Z.mouseup=function(F){var re=K(F,E);F.featureTarget=re,Le(J,{point:F.point,time:new Date().getTime()})?ce.click(F):ce.mouseup(F)},Z.mouseout=function(F){ce.mouseout(F)},Z.touchstart=function(F){if(F.originalEvent.preventDefault(),E.options.touchEnabled){X={time:new Date().getTime(),point:F.point};var re=te.touch(F,null,E)[0];F.featureTarget=re,ce.touchstart(F)}},Z.touchmove=function(F){if(F.originalEvent.preventDefault(),E.options.touchEnabled)return ce.touchmove(F),Z.touchdrag(F)},Z.touchend=function(F){if(F.originalEvent.preventDefault(),E.options.touchEnabled){var re=te.touch(F,null,E)[0];F.featureTarget=re,Me(X,{time:new Date().getTime(),point:F.point})?ce.tap(F):ce.touchend(F)}};var Ge=function(F){return!(F===8||F===46||F>=48&&F<=57)};function _e(F,re,Ae){Ae===void 0&&(Ae={}),ce.stop();var et=z[F];if(et===void 0)throw new Error(F+" is not valid");W=F;var Ye=et(E,re);ce=t(Ye,E),Ae.silent||E.map.fire(C.MODE_CHANGE,{mode:F}),E.store.setDirty(),E.store.render()}Z.keydown=function(F){(F.srcElement||F.target).classList[0]==="mapboxgl-canvas"&&(F.keyCode!==8&&F.keyCode!==46||!E.options.controls.trash?Ge(F.keyCode)?ce.keydown(F):F.keyCode===49&&E.options.controls.point?_e(b.DRAW_POINT):F.keyCode===50&&E.options.controls.line_string?_e(b.DRAW_LINE_STRING):F.keyCode===51&&E.options.controls.polygon&&_e(b.DRAW_POLYGON):(F.preventDefault(),ce.trash()))},Z.keyup=function(F){Ge(F.keyCode)&&ce.keyup(F)},Z.zoomend=function(){E.store.changeZoom()},Z.data=function(F){if(F.dataType==="style"){var re=E.setup,Ae=E.map,et=E.options,Ye=E.store;et.styles.some(function(Yr){return Ae.getLayer(Yr.id)})||(re.addLayers(),Ye.setDirty(),Ye.render())}};var Je={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){W=E.options.defaultMode,ce=t(z[W](E),E)},changeMode:_e,actionable:function(F){var re=!1;Object.keys(F).forEach(function(Ae){if(Je[Ae]===void 0)throw new Error("Invalid action type");Je[Ae]!==F[Ae]&&(re=!0),Je[Ae]=F[Ae]}),re&&E.map.fire(C.ACTIONABLE,{actions:Je})},currentModeName:function(){return W},currentModeRender:function(F,re){return ce.render(F,re)},fire:function(F,re){Z[F]&&Z[F](re)},addEventListeners:function(){E.map.on("mousemove",Z.mousemove),E.map.on("mousedown",Z.mousedown),E.map.on("mouseup",Z.mouseup),E.map.on("data",Z.data),E.map.on("touchmove",Z.touchmove),E.map.on("touchstart",Z.touchstart),E.map.on("touchend",Z.touchend),E.container.addEventListener("mouseout",Z.mouseout),E.options.keybindings&&(E.container.addEventListener("keydown",Z.keydown),E.container.addEventListener("keyup",Z.keyup))},removeEventListeners:function(){E.map.off("mousemove",Z.mousemove),E.map.off("mousedown",Z.mousedown),E.map.off("mouseup",Z.mouseup),E.map.off("data",Z.data),E.map.off("touchmove",Z.touchmove),E.map.off("touchstart",Z.touchstart),E.map.off("touchend",Z.touchend),E.container.removeEventListener("mouseout",Z.mouseout),E.options.keybindings&&(E.container.removeEventListener("keydown",Z.keydown),E.container.removeEventListener("keyup",Z.keyup))},trash:function(F){ce.trash(F)},combineFeatures:function(){ce.combineFeatures()},uncombineFeatures:function(){ce.uncombineFeatures()},getMode:function(){return W}}}(i),i.ui=function(E){var z={},J=null,X={mode:null,feature:null,mouse:null},Z={mode:null,feature:null,mouse:null};function W(F){Z=wt(Z,F)}function ce(){var F,re;if(E.container){var Ae=[],et=[];Vl.forEach(function(Ye){Z[Ye]!==X[Ye]&&(Ae.push(Ye+"-"+X[Ye]),Z[Ye]!==null&&et.push(Ye+"-"+Z[Ye]))}),Ae.length>0&&(F=E.container.classList).remove.apply(F,Ae),et.length>0&&(re=E.container.classList).add.apply(re,et),X=wt(X,Z)}}function Ge(F,re){re===void 0&&(re={});var Ae=document.createElement("button");return Ae.className=p.CONTROL_BUTTON+" "+re.className,Ae.setAttribute("title",re.title),re.container.appendChild(Ae),Ae.addEventListener("click",function(et){if(et.preventDefault(),et.stopPropagation(),et.target===J)return _e(),void re.onDeactivate();Je(F),re.onActivate()},!0),Ae}function _e(){J&&(J.classList.remove(p.ACTIVE_BUTTON),J=null)}function Je(F){_e();var re=z[F];re&&re&&F!=="trash"&&(re.classList.add(p.ACTIVE_BUTTON),J=re)}return{setActiveButton:Je,queueMapClasses:W,updateMapClasses:ce,clearMapClasses:function(){W({mode:null,feature:null,mouse:null}),ce()},addButtons:function(){var F=E.options.controls,re=document.createElement("div");return re.className=p.CONTROL_GROUP+" "+p.CONTROL_BASE,F&&(F[h.LINE]&&(z[h.LINE]=Ge(h.LINE,{container:re,className:p.CONTROL_BUTTON_LINE,title:"LineString tool "+(E.options.keybindings?"(l)":""),onActivate:function(){return E.events.changeMode(b.DRAW_LINE_STRING)},onDeactivate:function(){return E.events.trash()}})),F[h.POLYGON]&&(z[h.POLYGON]=Ge(h.POLYGON,{container:re,className:p.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(E.options.keybindings?"(p)":""),onActivate:function(){return E.events.changeMode(b.DRAW_POLYGON)},onDeactivate:function(){return E.events.trash()}})),F[h.POINT]&&(z[h.POINT]=Ge(h.POINT,{container:re,className:p.CONTROL_BUTTON_POINT,title:"Marker tool "+(E.options.keybindings?"(m)":""),onActivate:function(){return E.events.changeMode(b.DRAW_POINT)},onDeactivate:function(){return E.events.trash()}})),F.trash&&(z.trash=Ge("trash",{container:re,className:p.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){E.events.trash()}})),F.combine_features&&(z.combine_features=Ge("combineFeatures",{container:re,className:p.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){E.events.combineFeatures()}})),F.uncombine_features&&(z.uncombine_features=Ge("uncombineFeatures",{container:re,className:p.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){E.events.uncombineFeatures()}}))),re},removeButtons:function(){Object.keys(z).forEach(function(F){var re=z[F];re.parentNode&&re.parentNode.removeChild(re),delete z[F]})}}}(i),i.container=y.getContainer(),i.store=new Pe(i),a=i.ui.addButtons(),i.options.boxSelect&&(y.boxZoom.disable(),y.dragPan.disable(),y.dragPan.enable()),y.loaded()?_.connect():(y.on("load",_.connect),d=setInterval(function(){y.loaded()&&_.connect()},16)),i.events.start(),a},addLayers:function(){i.map.addSource(v.COLD,{data:{type:g.FEATURE_COLLECTION,features:[]},type:"geojson"}),i.map.addSource(v.HOT,{data:{type:g.FEATURE_COLLECTION,features:[]},type:"geojson"}),i.options.styles.forEach(function(y){i.map.addLayer(y)}),i.store.setDirty(!0),i.store.render()},removeLayers:function(){i.options.styles.forEach(function(y){i.map.getLayer(y.id)&&i.map.removeLayer(y.id)}),i.map.getSource(v.COLD)&&i.map.removeSource(v.COLD),i.map.getSource(v.HOT)&&i.map.removeSource(v.HOT)}};return i.setup=_,_}var Li=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Zn(i){return function(a){var d=a.featureTarget;return!!d&&!!d.properties&&d.properties.meta===i}}function Pi(i){return!!i.originalEvent&&!!i.originalEvent.shiftKey&&i.originalEvent.button===0}function tn(i){return!!i.featureTarget&&!!i.featureTarget.properties&&i.featureTarget.properties.active===k.ACTIVE&&i.featureTarget.properties.meta===M.FEATURE}function Br(i){return!!i.featureTarget&&!!i.featureTarget.properties&&i.featureTarget.properties.active===k.INACTIVE&&i.featureTarget.properties.meta===M.FEATURE}function Xn(i){return i.featureTarget===void 0}function Ai(i){return!!i.featureTarget&&!!i.featureTarget.properties&&i.featureTarget.properties.meta===M.FEATURE}function On(i){var a=i.featureTarget;return!!a&&!!a.properties&&a.properties.meta===M.VERTEX}function Kn(i){return!!i.originalEvent&&i.originalEvent.shiftKey===!0}function Qn(i){return i.keyCode===27}function $n(i){return i.keyCode===13}var Jl=Object.freeze({__proto__:null,isOfMetaType:Zn,isShiftMousedown:Pi,isActiveFeature:tn,isInactiveFeature:Br,noTarget:Xn,isFeature:Ai,isVertex:On,isShiftDown:Kn,isEscapeKey:Qn,isEnterKey:$n,isTrue:function(){return!0}}),Yl=mn;function mn(i,a){this.x=i,this.y=a}function Gr(i,a){var d=a.getBoundingClientRect();return new Yl(i.clientX-d.left-(a.clientLeft||0),i.clientY-d.top-(a.clientTop||0))}function _n(i,a,d,_){return{type:g.FEATURE,properties:{meta:M.VERTEX,parent:i,coord_path:d,active:_?k.ACTIVE:k.INACTIVE},geometry:{type:g.POINT,coordinates:a}}}function xi(i,a,d){var _=a.geometry.coordinates,y=d.geometry.coordinates;if(_[1]>85||_[1]<N||y[1]>85||y[1]<N)return null;var w={lng:(_[0]+y[0])/2,lat:(_[1]+y[1])/2};return{type:g.FEATURE,properties:{meta:M.MIDPOINT,parent:i,lng:w.lng,lat:w.lat,coord_path:d.properties.coord_path},geometry:{type:g.POINT,coordinates:[w.lng,w.lat]}}}function er(i,a,d){a===void 0&&(a={}),d===void 0&&(d=null);var _,y=i.geometry,w=y.type,E=y.coordinates,z=i.properties&&i.properties.id,J=[];function X(W,ce){var Ge="",_e=null;W.forEach(function(Je,F){var re=ce!=null?ce+"."+F:String(F),Ae=_n(z,Je,re,Z(re));if(a.midpoints&&_e){var et=xi(z,_e,Ae);et&&J.push(et)}_e=Ae;var Ye=JSON.stringify(Je);Ge!==Ye&&J.push(Ae),F===0&&(Ge=Ye)})}function Z(W){return!!a.selectedPaths&&a.selectedPaths.indexOf(W)!==-1}return w===g.POINT?J.push(_n(z,E,d,Z(d))):w===g.POLYGON?E.forEach(function(W,ce){X(W,d!==null?d+"."+ce:String(ce))}):w===g.LINE_STRING?X(E,d):w.indexOf(g.MULTI_PREFIX)===0&&(_=w.replace(g.MULTI_PREFIX,""),E.forEach(function(W,ce){var Ge={type:g.FEATURE,properties:i.properties,geometry:{type:_,coordinates:W}};J=J.concat(er(Ge,a,ce))})),J}mn.prototype={clone:function(){return new mn(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,a){return this.clone()._rotateAround(i,a)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var a=i.x-this.x,d=i.y-this.y;return a*a+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,a){return Math.atan2(this.x*a-this.y*i,this.x*i+this.y*a)},_matMult:function(i){var a=i[0]*this.x+i[1]*this.y,d=i[2]*this.x+i[3]*this.y;return this.x=a,this.y=d,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var a=Math.cos(i),d=Math.sin(i),_=a*this.x-d*this.y,y=d*this.x+a*this.y;return this.x=_,this.y=y,this},_rotateAround:function(i,a){var d=Math.cos(i),_=Math.sin(i),y=a.x+d*(this.x-a.x)-_*(this.y-a.y),w=a.y+_*(this.x-a.x)+d*(this.y-a.y);return this.x=y,this.y=w,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},mn.convert=function(i){return i instanceof mn?i:Array.isArray(i)?new mn(i[0],i[1]):i};var Tt={enable:function(i){setTimeout(function(){i.map&&i.map.doubleClickZoom&&i._ctx&&i._ctx.store&&i._ctx.store.getInitialConfigValue&&i._ctx.store.getInitialConfigValue("doubleClickZoom")&&i.map.doubleClickZoom.enable()},0)},disable:function(i){setTimeout(function(){i.map&&i.map.doubleClickZoom&&i.map.doubleClickZoom.disable()},0)}},In={},Wl={get exports(){return In},set exports(i){In=i}},Ni=function(i){if(!i||!i.type)return null;var a=Hl[i.type];if(!a)return null;if(a==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:i}]};if(a==="feature")return{type:"FeatureCollection",features:[i]};if(a==="featurecollection")return i},Hl={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Zl=Object.freeze({__proto__:null,default:function i(a){switch(a&&a.type||null){case"FeatureCollection":return a.features=a.features.reduce(function(d,_){return d.concat(i(_))},[]),a;case"Feature":return a.geometry?i(a.geometry).map(function(d){var _={type:"Feature",properties:JSON.parse(JSON.stringify(a.properties)),geometry:d};return a.id!==void 0&&(_.id=a.id),_}):[a];case"MultiPoint":return a.coordinates.map(function(d){return{type:"Point",coordinates:d}});case"MultiPolygon":return a.coordinates.map(function(d){return{type:"Polygon",coordinates:d}});case"MultiLineString":return a.coordinates.map(function(d){return{type:"LineString",coordinates:d}});case"GeometryCollection":return a.geometries.map(i).reduce(function(d,_){return d.concat(_)},[]);case"Point":case"Polygon":case"LineString":return[a]}}}),Xl=Ni,tr=r(Zl),Kl=function(i){return function a(d){return Array.isArray(d)&&d.length&&typeof d[0]=="number"?[d]:d.reduce(function(_,y){return Array.isArray(y)&&Array.isArray(y[0])?_.concat(a(y)):(_.push(y),_)},[])}(i)};tr instanceof Function||(tr=tr.default);var zr={},Ql={get exports(){return zr},set exports(i){zr=i}}.exports=function(i){return new Et(i)};function Et(i){this.value=i}function Ri(i,a,d){var _=[],y=[],w=!0;return function E(z){var J=d?Fi(z):z,X={},Z=!0,W={node:J,node_:z,path:[].concat(_),parent:y[y.length-1],parents:y,key:_.slice(-1)[0],isRoot:_.length===0,level:_.length,circular:null,update:function(_e,Je){W.isRoot||(W.parent.node[W.key]=_e),W.node=_e,Je&&(Z=!1)},delete:function(_e){delete W.parent.node[W.key],_e&&(Z=!1)},remove:function(_e){Di(W.parent.node)?W.parent.node.splice(W.key,1):delete W.parent.node[W.key],_e&&(Z=!1)},keys:null,before:function(_e){X.before=_e},after:function(_e){X.after=_e},pre:function(_e){X.pre=_e},post:function(_e){X.post=_e},stop:function(){w=!1},block:function(){Z=!1}};if(!w)return W;function ce(){if(typeof W.node=="object"&&W.node!==null){W.keys&&W.node_===W.node||(W.keys=nr(W.node)),W.isLeaf=W.keys.length==0;for(var _e=0;_e<y.length;_e++)if(y[_e].node_===z){W.circular=y[_e];break}}else W.isLeaf=!0,W.keys=null;W.notLeaf=!W.isLeaf,W.notRoot=!W.isRoot}ce();var Ge=a.call(W,W.node);return Ge!==void 0&&W.update&&W.update(Ge),X.before&&X.before.call(W,W.node),Z&&(typeof W.node!="object"||W.node===null||W.circular||(y.push(W),ce(),rr(W.keys,function(_e,Je){_.push(_e),X.pre&&X.pre.call(W,W.node[_e],_e);var F=E(W.node[_e]);d&&ir.call(W.node,_e)&&(W.node[_e]=F.node),F.isLast=Je==W.keys.length-1,F.isFirst=Je==0,X.post&&X.post.call(W,F),_.pop()}),y.pop()),X.after&&X.after.call(W,W.node)),W}(i).node}function Fi(i){if(typeof i=="object"&&i!==null){var a;if(Di(i))a=[];else if(bn(i)==="[object Date]")a=new Date(i.getTime?i.getTime():i);else if(function(y){return bn(y)==="[object RegExp]"}(i))a=new RegExp(i);else if(function(y){return bn(y)==="[object Error]"}(i))a={message:i.message};else if(function(y){return bn(y)==="[object Boolean]"}(i))a=new Boolean(i);else if(function(y){return bn(y)==="[object Number]"}(i))a=new Number(i);else if(function(y){return bn(y)==="[object String]"}(i))a=new String(i);else if(Object.create&&Object.getPrototypeOf)a=Object.create(Object.getPrototypeOf(i));else if(i.constructor===Object)a={};else{var d=i.constructor&&i.constructor.prototype||i.__proto__||{},_=function(){};_.prototype=d,a=new _}return rr(nr(i),function(y){a[y]=i[y]}),a}return i}Et.prototype.get=function(i){for(var a=this.value,d=0;d<i.length;d++){var _=i[d];if(!a||!ir.call(a,_)){a=void 0;break}a=a[_]}return a},Et.prototype.has=function(i){for(var a=this.value,d=0;d<i.length;d++){var _=i[d];if(!a||!ir.call(a,_))return!1;a=a[_]}return!0},Et.prototype.set=function(i,a){for(var d=this.value,_=0;_<i.length-1;_++){var y=i[_];ir.call(d,y)||(d[y]={}),d=d[y]}return d[i[_]]=a,a},Et.prototype.map=function(i){return Ri(this.value,i,!0)},Et.prototype.forEach=function(i){return this.value=Ri(this.value,i,!1),this.value},Et.prototype.reduce=function(i,a){var d=arguments.length===1,_=d?this.value:a;return this.forEach(function(y){this.isRoot&&d||(_=i.call(this,_,y))}),_},Et.prototype.paths=function(){var i=[];return this.forEach(function(a){i.push(this.path)}),i},Et.prototype.nodes=function(){var i=[];return this.forEach(function(a){i.push(this.node)}),i},Et.prototype.clone=function(){var i=[],a=[];return function d(_){for(var y=0;y<i.length;y++)if(i[y]===_)return a[y];if(typeof _=="object"&&_!==null){var w=Fi(_);return i.push(_),a.push(w),rr(nr(_),function(E){w[E]=d(_[E])}),i.pop(),a.pop(),w}return _}(this.value)};var nr=Object.keys||function(i){var a=[];for(var d in i)a.push(d);return a};function bn(i){return Object.prototype.toString.call(i)}var Di=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"},rr=function(i,a){if(i.forEach)return i.forEach(a);for(var d=0;d<i.length;d++)a(i[d],d,i)};rr(nr(Et.prototype),function(i){Ql[i]=function(a){var d=[].slice.call(arguments,1),_=new Et(a);return _[i].apply(_,d)}});var ir=Object.hasOwnProperty||function(i,a){return a in i},$l=ut;function ut(i){if(!(this instanceof ut))return new ut(i);this._bbox=i||[1/0,1/0,-1/0,-1/0],this._valid=!!i}ut.prototype.include=function(i){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],i[0]),this._bbox[1]=Math.min(this._bbox[1],i[1]),this._bbox[2]=Math.max(this._bbox[2],i[0]),this._bbox[3]=Math.max(this._bbox[3],i[1]),this},ut.prototype.equals=function(i){var a;return a=i instanceof ut?i.bbox():i,this._bbox[0]==a[0]&&this._bbox[1]==a[1]&&this._bbox[2]==a[2]&&this._bbox[3]==a[3]},ut.prototype.center=function(i){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},ut.prototype.union=function(i){var a;return this._valid=!0,a=i instanceof ut?i.bbox():i,this._bbox[0]=Math.min(this._bbox[0],a[0]),this._bbox[1]=Math.min(this._bbox[1],a[1]),this._bbox[2]=Math.max(this._bbox[2],a[2]),this._bbox[3]=Math.max(this._bbox[3],a[3]),this},ut.prototype.bbox=function(){return this._valid?this._bbox:null},ut.prototype.contains=function(i){if(!i)return this._fastContains();if(!this._valid)return null;var a=i[0],d=i[1];return this._bbox[0]<=a&&this._bbox[1]<=d&&this._bbox[2]>=a&&this._bbox[3]>=d},ut.prototype.intersect=function(i){return this._valid?(a=i instanceof ut?i.bbox():i,!(this._bbox[0]>a[2]||this._bbox[2]<a[0]||this._bbox[3]<a[1]||this._bbox[1]>a[3])):null;var a},ut.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var i="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",i)},ut.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var es=function(i){if(!i)return[];var a=tr(Xl(i)),d=[];return a.features.forEach(function(_){_.geometry&&(d=d.concat(Kl(_.geometry.coordinates)))}),d},ts=zr,ns=$l,Ui={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},rs=Object.keys(Ui);function Vr(i){for(var a=ns(),d=es(i),_=0;_<d.length;_++)a.include(d[_]);return a}Wl.exports=function(i){return Vr(i).bbox()},In.polygon=function(i){return Vr(i).polygon()},In.bboxify=function(i){return ts(i).map(function(a){a&&rs.some(function(d){return!!a[d]&&Ui[d].indexOf(a.type)!==-1})&&(a.bbox=Vr(a).bbox(),this.update(a))})};var or=-90;function qr(i,a){var d=or,_=90,y=or,w=90,E=270,z=-270;i.forEach(function(X){var Z=In(X),W=Z[1],ce=Z[3],Ge=Z[0],_e=Z[2];W>d&&(d=W),ce<_&&(_=ce),ce>y&&(y=ce),W<w&&(w=W),Ge<E&&(E=Ge),_e>z&&(z=_e)});var J=a;return d+J.lat>85&&(J.lat=85-d),y+J.lat>90&&(J.lat=90-y),_+J.lat<-85&&(J.lat=-85-_),w+J.lat<or&&(J.lat=or-w),E+J.lng<=-270&&(J.lng+=360*Math.ceil(Math.abs(J.lng)/360)),z+J.lng>=270&&(J.lng-=360*Math.ceil(Math.abs(J.lng)/360)),J}function Jr(i,a){var d=qr(i.map(function(_){return _.toGeoJSON()}),a);i.forEach(function(_){var y,w=_.getCoordinates(),E=function(J){var X={lng:J[0]+d.lng,lat:J[1]+d.lat};return[X.lng,X.lat]},z=function(J){return J.map(function(X){return E(X)})};_.type===g.POINT?y=E(w):_.type===g.LINE_STRING||_.type===g.MULTI_POINT?y=w.map(E):_.type===g.POLYGON||_.type===g.MULTI_LINE_STRING?y=w.map(z):_.type===g.MULTI_POLYGON&&(y=w.map(function(J){return J.map(function(X){return z(X)})})),_.incomingCoords(y)})}var Ke={onSetup:function(i){var a=this,d={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:i.featureIds||[]};return this.setSelected(d.initiallySelectedFeatureIds.filter(function(_){return a.getFeature(_)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),d},fireUpdate:function(){this.map.fire(C.UPDATE,{action:B.MOVE,features:this.getSelected().map(function(i){return i.toGeoJSON()})})},fireActionable:function(){var i=this,a=this.getSelected(),d=a.filter(function(z){return i.isInstanceOf("MultiFeature",z)}),_=!1;if(a.length>1){_=!0;var y=a[0].type.replace("Multi","");a.forEach(function(z){z.type.replace("Multi","")!==y&&(_=!1)})}var w=d.length>0,E=a.length>0;this.setActionableState({combineFeatures:_,uncombineFeatures:w,trash:E})},getUniqueIds:function(i){return i.length?i.map(function(a){return a.properties.id}).filter(function(a){return a!==void 0}).reduce(function(a,d){return a.add(d),a},new U).values():[]},stopExtendedInteractions:function(i){i.boxSelectElement&&(i.boxSelectElement.parentNode&&i.boxSelectElement.parentNode.removeChild(i.boxSelectElement),i.boxSelectElement=null),this.map.dragPan.enable(),i.boxSelecting=!1,i.canBoxSelect=!1,i.dragMoving=!1,i.canDragMove=!1},onStop:function(){Tt.enable(this)},onMouseMove:function(i){return this.stopExtendedInteractions(i),!0},onMouseOut:function(i){return!i.dragMoving||this.fireUpdate()}};Ke.onTap=Ke.onClick=function(i,a){return Xn(a)?this.clickAnywhere(i,a):Zn(M.VERTEX)(a)?this.clickOnVertex(i,a):Ai(a)?this.clickOnFeature(i,a):void 0},Ke.clickAnywhere=function(i){var a=this,d=this.getSelectedIds();d.length&&(this.clearSelectedFeatures(),d.forEach(function(_){return a.doRender(_)})),Tt.enable(this),this.stopExtendedInteractions(i)},Ke.clickOnVertex=function(i,a){this.changeMode(b.DIRECT_SELECT,{featureId:a.featureTarget.properties.parent,coordPath:a.featureTarget.properties.coord_path,startPos:a.lngLat}),this.updateUIClasses({mouse:m.MOVE})},Ke.startOnActiveFeature=function(i,a){this.stopExtendedInteractions(i),this.map.dragPan.disable(),this.doRender(a.featureTarget.properties.id),i.canDragMove=!0,i.dragMoveLocation=a.lngLat},Ke.clickOnFeature=function(i,a){var d=this;Tt.disable(this),this.stopExtendedInteractions(i);var _=Kn(a),y=this.getSelectedIds(),w=a.featureTarget.properties.id,E=this.isSelected(w);if(!_&&E&&this.getFeature(w).type!==g.POINT)return this.changeMode(b.DIRECT_SELECT,{featureId:w});E&&_?(this.deselect(w),this.updateUIClasses({mouse:m.POINTER}),y.length===1&&Tt.enable(this)):!E&&_?(this.select(w),this.updateUIClasses({mouse:m.MOVE})):E||_||(y.forEach(function(z){return d.doRender(z)}),this.setSelected(w),this.updateUIClasses({mouse:m.MOVE})),this.doRender(w)},Ke.onMouseDown=function(i,a){return tn(a)?this.startOnActiveFeature(i,a):this.drawConfig.boxSelect&&Pi(a)?this.startBoxSelect(i,a):void 0},Ke.startBoxSelect=function(i,a){this.stopExtendedInteractions(i),this.map.dragPan.disable(),i.boxSelectStartLocation=Gr(a.originalEvent,this.map.getContainer()),i.canBoxSelect=!0},Ke.onTouchStart=function(i,a){if(tn(a))return this.startOnActiveFeature(i,a)},Ke.onDrag=function(i,a){return i.canDragMove?this.dragMove(i,a):this.drawConfig.boxSelect&&i.canBoxSelect?this.whileBoxSelect(i,a):void 0},Ke.whileBoxSelect=function(i,a){i.boxSelecting=!0,this.updateUIClasses({mouse:m.ADD}),i.boxSelectElement||(i.boxSelectElement=document.createElement("div"),i.boxSelectElement.classList.add(p.BOX_SELECT),this.map.getContainer().appendChild(i.boxSelectElement));var d=Gr(a.originalEvent,this.map.getContainer()),_=Math.min(i.boxSelectStartLocation.x,d.x),y=Math.max(i.boxSelectStartLocation.x,d.x),w=Math.min(i.boxSelectStartLocation.y,d.y),E=Math.max(i.boxSelectStartLocation.y,d.y),z="translate("+_+"px, "+w+"px)";i.boxSelectElement.style.transform=z,i.boxSelectElement.style.WebkitTransform=z,i.boxSelectElement.style.width=y-_+"px",i.boxSelectElement.style.height=E-w+"px"},Ke.dragMove=function(i,a){i.dragMoving=!0,a.originalEvent.stopPropagation();var d={lng:a.lngLat.lng-i.dragMoveLocation.lng,lat:a.lngLat.lat-i.dragMoveLocation.lat};Jr(this.getSelected(),d),i.dragMoveLocation=a.lngLat},Ke.onTouchEnd=Ke.onMouseUp=function(i,a){var d=this;if(i.dragMoving)this.fireUpdate();else if(i.boxSelecting){var _=[i.boxSelectStartLocation,Gr(a.originalEvent,this.map.getContainer())],y=this.featuresAt(null,_,"click"),w=this.getUniqueIds(y).filter(function(E){return!d.isSelected(E)});w.length&&(this.select(w),w.forEach(function(E){return d.doRender(E)}),this.updateUIClasses({mouse:m.MOVE}))}this.stopExtendedInteractions(i)},Ke.toDisplayFeatures=function(i,a,d){a.properties.active=this.isSelected(a.properties.id)?k.ACTIVE:k.INACTIVE,d(a),this.fireActionable(),a.properties.active===k.ACTIVE&&a.geometry.type!==g.POINT&&er(a).forEach(d)},Ke.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Ke.onCombineFeatures=function(){var i=this.getSelected();if(!(i.length===0||i.length<2)){for(var a=[],d=[],_=i[0].type.replace("Multi",""),y=0;y<i.length;y++){var w=i[y];if(w.type.replace("Multi","")!==_)return;w.type.includes("Multi")?w.getCoordinates().forEach(function(z){a.push(z)}):a.push(w.getCoordinates()),d.push(w.toGeoJSON())}if(d.length>1){var E=this.newFeature({type:g.FEATURE,properties:d[0].properties,geometry:{type:"Multi"+_,coordinates:a}});this.addFeature(E),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([E.id]),this.map.fire(C.COMBINE_FEATURES,{createdFeatures:[E.toGeoJSON()],deletedFeatures:d})}this.fireActionable()}},Ke.onUncombineFeatures=function(){var i=this,a=this.getSelected();if(a.length!==0){for(var d=[],_=[],y=function(E){var z=a[E];i.isInstanceOf("MultiFeature",z)&&(z.getFeatures().forEach(function(J){i.addFeature(J),J.properties=z.properties,d.push(J.toGeoJSON()),i.select([J.id])}),i.deleteFeature(z.id,{silent:!0}),_.push(z.toGeoJSON()))},w=0;w<a.length;w++)y(w);d.length>1&&this.map.fire(C.UNCOMBINE_FEATURES,{createdFeatures:d,deletedFeatures:_}),this.fireActionable()}};var ji=Zn(M.VERTEX),is=Zn(M.MIDPOINT),qt={fireUpdate:function(){this.map.fire(C.UPDATE,{action:B.CHANGE_COORDINATES,features:this.getSelected().map(function(i){return i.toGeoJSON()})})},fireActionable:function(i){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:i.selectedCoordPaths.length>0})},startDragging:function(i,a){this.map.dragPan.disable(),i.canDragMove=!0,i.dragMoveLocation=a.lngLat},stopDragging:function(i){this.map.dragPan.enable(),i.dragMoving=!1,i.canDragMove=!1,i.dragMoveLocation=null},onVertex:function(i,a){this.startDragging(i,a);var d=a.featureTarget.properties,_=i.selectedCoordPaths.indexOf(d.coord_path);Kn(a)||_!==-1?Kn(a)&&_===-1&&i.selectedCoordPaths.push(d.coord_path):i.selectedCoordPaths=[d.coord_path];var y=this.pathsToCoordinates(i.featureId,i.selectedCoordPaths);this.setSelectedCoordinates(y)},onMidpoint:function(i,a){this.startDragging(i,a);var d=a.featureTarget.properties;i.feature.addCoordinate(d.coord_path,d.lng,d.lat),this.fireUpdate(),i.selectedCoordPaths=[d.coord_path]},pathsToCoordinates:function(i,a){return a.map(function(d){return{feature_id:i,coord_path:d}})},onFeature:function(i,a){i.selectedCoordPaths.length===0?this.startDragging(i,a):this.stopDragging(i)},dragFeature:function(i,a,d){Jr(this.getSelected(),d),i.dragMoveLocation=a.lngLat},dragVertex:function(i,a,d){for(var _=i.selectedCoordPaths.map(function(z){return i.feature.getCoordinate(z)}),y=qr(_.map(function(z){return{type:g.FEATURE,properties:{},geometry:{type:g.POINT,coordinates:z}}}),d),w=0;w<_.length;w++){var E=_[w];i.feature.updateCoordinate(i.selectedCoordPaths[w],E[0]+y.lng,E[1]+y.lat)}},clickNoTarget:function(){this.changeMode(b.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(b.SIMPLE_SELECT)},clickActiveFeature:function(i){i.selectedCoordPaths=[],this.clearSelectedCoordinates(),i.feature.changed()},onSetup:function(i){var a=i.featureId,d=this.getFeature(a);if(!d)throw new Error("You must provide a featureId to enter direct_select mode");if(d.type===g.POINT)throw new TypeError("direct_select mode doesn't handle point features");var _={featureId:a,feature:d,dragMoveLocation:i.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:i.coordPath?[i.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(a,_.selectedCoordPaths)),this.setSelected(a),Tt.disable(this),this.setActionableState({trash:!0}),_},onStop:function(){Tt.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(i,a,d){i.featureId===a.properties.id?(a.properties.active=k.ACTIVE,d(a),er(a,{map:this.map,midpoints:!0,selectedPaths:i.selectedCoordPaths}).forEach(d)):(a.properties.active=k.INACTIVE,d(a)),this.fireActionable(i)},onTrash:function(i){i.selectedCoordPaths.sort(function(a,d){return d.localeCompare(a,"en",{numeric:!0})}).forEach(function(a){return i.feature.removeCoordinate(a)}),this.fireUpdate(),i.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(i),i.feature.isValid()===!1&&(this.deleteFeature([i.featureId]),this.changeMode(b.SIMPLE_SELECT,{}))},onMouseMove:function(i,a){var d=tn(a),_=ji(a),y=i.selectedCoordPaths.length===0;return d&&y||_&&!y?this.updateUIClasses({mouse:m.MOVE}):this.updateUIClasses({mouse:m.NONE}),this.stopDragging(i),!0},onMouseOut:function(i){return i.dragMoving&&this.fireUpdate(),!0}};qt.onTouchStart=qt.onMouseDown=function(i,a){return ji(a)?this.onVertex(i,a):tn(a)?this.onFeature(i,a):is(a)?this.onMidpoint(i,a):void 0},qt.onDrag=function(i,a){if(i.canDragMove===!0){i.dragMoving=!0,a.originalEvent.stopPropagation();var d={lng:a.lngLat.lng-i.dragMoveLocation.lng,lat:a.lngLat.lat-i.dragMoveLocation.lat};i.selectedCoordPaths.length>0?this.dragVertex(i,a,d):this.dragFeature(i,a,d),i.dragMoveLocation=a.lngLat}},qt.onClick=function(i,a){return Xn(a)?this.clickNoTarget(i,a):tn(a)?this.clickActiveFeature(i,a):Br(a)?this.clickInactive(i,a):void this.stopDragging(i)},qt.onTap=function(i,a){return Xn(a)?this.clickNoTarget(i,a):tn(a)?this.clickActiveFeature(i,a):Br(a)?this.clickInactive(i,a):void 0},qt.onTouchEnd=qt.onMouseUp=function(i){i.dragMoving&&this.fireUpdate(),this.stopDragging(i)};var Lt={};function lr(i,a){return!!i.lngLat&&i.lngLat.lng===a[0]&&i.lngLat.lat===a[1]}Lt.onSetup=function(){var i=this.newFeature({type:g.FEATURE,properties:{},geometry:{type:g.POINT,coordinates:[]}});return this.addFeature(i),this.clearSelectedFeatures(),this.updateUIClasses({mouse:m.ADD}),this.activateUIButton(h.POINT),this.setActionableState({trash:!0}),{point:i}},Lt.stopDrawingAndRemove=function(i){this.deleteFeature([i.point.id],{silent:!0}),this.changeMode(b.SIMPLE_SELECT)},Lt.onTap=Lt.onClick=function(i,a){this.updateUIClasses({mouse:m.MOVE}),i.point.updateCoordinate("",a.lngLat.lng,a.lngLat.lat),this.map.fire(C.CREATE,{features:[i.point.toGeoJSON()]}),this.changeMode(b.SIMPLE_SELECT,{featureIds:[i.point.id]})},Lt.onStop=function(i){this.activateUIButton(),i.point.getCoordinate().length||this.deleteFeature([i.point.id],{silent:!0})},Lt.toDisplayFeatures=function(i,a,d){var _=a.properties.id===i.point.id;if(a.properties.active=_?k.ACTIVE:k.INACTIVE,!_)return d(a)},Lt.onTrash=Lt.stopDrawingAndRemove,Lt.onKeyUp=function(i,a){if(Qn(a)||$n(a))return this.stopDrawingAndRemove(i,a)};var nn={onSetup:function(){var i=this.newFeature({type:g.FEATURE,properties:{},geometry:{type:g.POLYGON,coordinates:[[]]}});return this.addFeature(i),this.clearSelectedFeatures(),Tt.disable(this),this.updateUIClasses({mouse:m.ADD}),this.activateUIButton(h.POLYGON),this.setActionableState({trash:!0}),{polygon:i,currentVertexPosition:0}},clickAnywhere:function(i,a){if(i.currentVertexPosition>0&&lr(a,i.polygon.coordinates[0][i.currentVertexPosition-1]))return this.changeMode(b.SIMPLE_SELECT,{featureIds:[i.polygon.id]});this.updateUIClasses({mouse:m.ADD}),i.polygon.updateCoordinate("0."+i.currentVertexPosition,a.lngLat.lng,a.lngLat.lat),i.currentVertexPosition++,i.polygon.updateCoordinate("0."+i.currentVertexPosition,a.lngLat.lng,a.lngLat.lat)},clickOnVertex:function(i){return this.changeMode(b.SIMPLE_SELECT,{featureIds:[i.polygon.id]})},onMouseMove:function(i,a){i.polygon.updateCoordinate("0."+i.currentVertexPosition,a.lngLat.lng,a.lngLat.lat),On(a)&&this.updateUIClasses({mouse:m.POINTER})}};nn.onTap=nn.onClick=function(i,a){return On(a)?this.clickOnVertex(i,a):this.clickAnywhere(i,a)},nn.onKeyUp=function(i,a){Qn(a)?(this.deleteFeature([i.polygon.id],{silent:!0}),this.changeMode(b.SIMPLE_SELECT)):$n(a)&&this.changeMode(b.SIMPLE_SELECT,{featureIds:[i.polygon.id]})},nn.onStop=function(i){this.updateUIClasses({mouse:m.NONE}),Tt.enable(this),this.activateUIButton(),this.getFeature(i.polygon.id)!==void 0&&(i.polygon.removeCoordinate("0."+i.currentVertexPosition),i.polygon.isValid()?this.map.fire(C.CREATE,{features:[i.polygon.toGeoJSON()]}):(this.deleteFeature([i.polygon.id],{silent:!0}),this.changeMode(b.SIMPLE_SELECT,{},{silent:!0})))},nn.toDisplayFeatures=function(i,a,d){var _=a.properties.id===i.polygon.id;if(a.properties.active=_?k.ACTIVE:k.INACTIVE,!_)return d(a);if(a.geometry.coordinates.length!==0){var y=a.geometry.coordinates[0].length;if(!(y<3)){if(a.properties.meta=M.FEATURE,d(_n(i.polygon.id,a.geometry.coordinates[0][0],"0.0",!1)),y>3){var w=a.geometry.coordinates[0].length-3;d(_n(i.polygon.id,a.geometry.coordinates[0][w],"0."+w,!1))}if(y<=4){var E=[[a.geometry.coordinates[0][0][0],a.geometry.coordinates[0][0][1]],[a.geometry.coordinates[0][1][0],a.geometry.coordinates[0][1][1]]];if(d({type:g.FEATURE,properties:a.properties,geometry:{coordinates:E,type:g.LINE_STRING}}),y===3)return}return d(a)}}},nn.onTrash=function(i){this.deleteFeature([i.polygon.id],{silent:!0}),this.changeMode(b.SIMPLE_SELECT)};var rn={onSetup:function(i){var a,d,_=(i=i||{}).featureId,y="forward";if(_){if(!(a=this.getFeature(_)))throw new Error("Could not find a feature with the provided featureId");var w=i.from;if(w&&w.type==="Feature"&&w.geometry&&w.geometry.type==="Point"&&(w=w.geometry),w&&w.type==="Point"&&w.coordinates&&w.coordinates.length===2&&(w=w.coordinates),!w||!Array.isArray(w))throw new Error("Please use the `from` property to indicate which point to continue the line from");var E=a.coordinates.length-1;if(a.coordinates[E][0]===w[0]&&a.coordinates[E][1]===w[1])d=E+1,a.addCoordinate.apply(a,[d].concat(a.coordinates[E]));else{if(a.coordinates[0][0]!==w[0]||a.coordinates[0][1]!==w[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");y="backwards",d=0,a.addCoordinate.apply(a,[d].concat(a.coordinates[0]))}}else a=this.newFeature({type:g.FEATURE,properties:{},geometry:{type:g.LINE_STRING,coordinates:[]}}),d=0,this.addFeature(a);return this.clearSelectedFeatures(),Tt.disable(this),this.updateUIClasses({mouse:m.ADD}),this.activateUIButton(h.LINE),this.setActionableState({trash:!0}),{line:a,currentVertexPosition:d,direction:y}},clickAnywhere:function(i,a){if(i.currentVertexPosition>0&&lr(a,i.line.coordinates[i.currentVertexPosition-1])||i.direction==="backwards"&&lr(a,i.line.coordinates[i.currentVertexPosition+1]))return this.changeMode(b.SIMPLE_SELECT,{featureIds:[i.line.id]});this.updateUIClasses({mouse:m.ADD}),i.line.updateCoordinate(i.currentVertexPosition,a.lngLat.lng,a.lngLat.lat),i.direction==="forward"?(i.currentVertexPosition++,i.line.updateCoordinate(i.currentVertexPosition,a.lngLat.lng,a.lngLat.lat)):i.line.addCoordinate(0,a.lngLat.lng,a.lngLat.lat)},clickOnVertex:function(i){return this.changeMode(b.SIMPLE_SELECT,{featureIds:[i.line.id]})},onMouseMove:function(i,a){i.line.updateCoordinate(i.currentVertexPosition,a.lngLat.lng,a.lngLat.lat),On(a)&&this.updateUIClasses({mouse:m.POINTER})}};rn.onTap=rn.onClick=function(i,a){if(On(a))return this.clickOnVertex(i,a);this.clickAnywhere(i,a)},rn.onKeyUp=function(i,a){$n(a)?this.changeMode(b.SIMPLE_SELECT,{featureIds:[i.line.id]}):Qn(a)&&(this.deleteFeature([i.line.id],{silent:!0}),this.changeMode(b.SIMPLE_SELECT))},rn.onStop=function(i){Tt.enable(this),this.activateUIButton(),this.getFeature(i.line.id)!==void 0&&(i.line.removeCoordinate(""+i.currentVertexPosition),i.line.isValid()?this.map.fire(C.CREATE,{features:[i.line.toGeoJSON()]}):(this.deleteFeature([i.line.id],{silent:!0}),this.changeMode(b.SIMPLE_SELECT,{},{silent:!0})))},rn.onTrash=function(i){this.deleteFeature([i.line.id],{silent:!0}),this.changeMode(b.SIMPLE_SELECT)},rn.toDisplayFeatures=function(i,a,d){var _=a.properties.id===i.line.id;if(a.properties.active=_?k.ACTIVE:k.INACTIVE,!_)return d(a);a.geometry.coordinates.length<2||(a.properties.meta=M.FEATURE,d(_n(i.line.id,a.geometry.coordinates[i.direction==="forward"?a.geometry.coordinates.length-2:1],""+(i.direction==="forward"?a.geometry.coordinates.length-2:1),!1)),d(a))};var Bi={simple_select:Ke,direct_select:qt,draw_point:Lt,draw_polygon:nn,draw_line_string:rn},os={defaultMode:b.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Li,modes:Bi,controls:{},userProperties:!1},ls={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},ss={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Gi(i,a){return i.map(function(d){return d.source?d:wt(d,{id:d.id+"."+a,source:a==="hot"?v.HOT:v.COLD})})}var sr={};(function(i,a){var d="__lodash_hash_undefined__",_=9007199254740991,y="[object Arguments]",w="[object Array]",E="[object Boolean]",z="[object Date]",J="[object Error]",X="[object Function]",Z="[object Map]",W="[object Number]",ce="[object Object]",Ge="[object Promise]",_e="[object RegExp]",Je="[object Set]",F="[object String]",re="[object Symbol]",Ae="[object WeakMap]",et="[object ArrayBuffer]",Ye="[object DataView]",Yr=/^\[object .+?Constructor\]$/,ds=/^(?:0|[1-9]\d*)$/,De={};De["[object Float32Array]"]=De["[object Float64Array]"]=De["[object Int8Array]"]=De["[object Int16Array]"]=De["[object Int32Array]"]=De["[object Uint8Array]"]=De["[object Uint8ClampedArray]"]=De["[object Uint16Array]"]=De["[object Uint32Array]"]=!0,De[y]=De[w]=De[et]=De[E]=De[Ye]=De[z]=De[J]=De[X]=De[Z]=De[W]=De[ce]=De[_e]=De[Je]=De[F]=De[Ae]=!1;var Vi=typeof Fn=="object"&&Fn&&Fn.Object===Object&&Fn,hs=typeof self=="object"&&self&&self.Object===Object&&self,Rt=Vi||hs||Function("return this")(),qi=a&&!a.nodeType&&a,Ji=qi&&i&&!i.nodeType&&i,Yi=Ji&&Ji.exports===qi,Wr=Yi&&Vi.process,Wi=function(){try{return Wr&&Wr.binding&&Wr.binding("util")}catch{}}(),Hi=Wi&&Wi.isTypedArray;function ps(S,L){for(var H=-1,ie=S==null?0:S.length;++H<ie;)if(L(S[H],H,S))return!0;return!1}function gs(S){var L=-1,H=Array(S.size);return S.forEach(function(ie,Ue){H[++L]=[Ue,ie]}),H}function ms(S){var L=-1,H=Array(S.size);return S.forEach(function(ie){H[++L]=ie}),H}var Zi,Xi,Ki,_s=Array.prototype,bs=Function.prototype,ur=Object.prototype,Hr=Rt["__core-js_shared__"],Qi=bs.toString,Pt=ur.hasOwnProperty,$i=(Zi=/[^.]+$/.exec(Hr&&Hr.keys&&Hr.keys.IE_PROTO||""))?"Symbol(src)_1."+Zi:"",eo=ur.toString,vs=RegExp("^"+Qi.call(Pt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),to=Yi?Rt.Buffer:void 0,fr=Rt.Symbol,no=Rt.Uint8Array,ro=ur.propertyIsEnumerable,ys=_s.splice,on=fr?fr.toStringTag:void 0,io=Object.getOwnPropertySymbols,ws=to?to.isBuffer:void 0,Es=(Xi=Object.keys,Ki=Object,function(S){return Xi(Ki(S))}),Zr=vn(Rt,"DataView"),Mn=vn(Rt,"Map"),Xr=vn(Rt,"Promise"),Kr=vn(Rt,"Set"),Qr=vn(Rt,"WeakMap"),Ln=vn(Object,"create"),Ss=an(Zr),ks=an(Mn),Ts=an(Xr),Cs=an(Kr),Os=an(Qr),oo=fr?fr.prototype:void 0,$r=oo?oo.valueOf:void 0;function ln(S){var L=-1,H=S==null?0:S.length;for(this.clear();++L<H;){var ie=S[L];this.set(ie[0],ie[1])}}function Ft(S){var L=-1,H=S==null?0:S.length;for(this.clear();++L<H;){var ie=S[L];this.set(ie[0],ie[1])}}function sn(S){var L=-1,H=S==null?0:S.length;for(this.clear();++L<H;){var ie=S[L];this.set(ie[0],ie[1])}}function cr(S){var L=-1,H=S==null?0:S.length;for(this.__data__=new sn;++L<H;)this.add(S[L])}function Jt(S){var L=this.__data__=new Ft(S);this.size=L.size}function Is(S,L){var H=pr(S),ie=!H&&xs(S),Ue=!H&&!ie&&ei(S),Ee=!H&&!ie&&!Ue&&go(S),Ve=H||ie||Ue||Ee,We=Ve?function($e,At){for(var Dt=-1,ft=Array($e);++Dt<$e;)ft[Dt]=At(Dt);return ft}(S.length,String):[],Ct=We.length;for(var Qe in S)!L&&!Pt.call(S,Qe)||Ve&&(Qe=="length"||Ue&&(Qe=="offset"||Qe=="parent")||Ee&&(Qe=="buffer"||Qe=="byteLength"||Qe=="byteOffset")||As(Qe,Ct))||We.push(Qe);return We}function dr(S,L){for(var H=S.length;H--;)if(fo(S[H][0],L))return H;return-1}function Pn(S){return S==null?S===void 0?"[object Undefined]":"[object Null]":on&&on in Object(S)?function(L){var H=Pt.call(L,on),ie=L[on];try{L[on]=void 0;var Ue=!0}catch{}var Ee=eo.call(L);return Ue&&(H?L[on]=ie:delete L[on]),Ee}(S):function(L){return eo.call(L)}(S)}function lo(S){return An(S)&&Pn(S)==y}function so(S,L,H,ie,Ue){return S===L||(S==null||L==null||!An(S)&&!An(L)?S!=S&&L!=L:function(Ee,Ve,We,Ct,Qe,$e){var At=pr(Ee),Dt=pr(Ve),ft=At?w:Yt(Ee),Ut=Dt?w:Yt(Ve),yn=(ft=ft==y?ce:ft)==ce,gr=(Ut=Ut==y?ce:Ut)==ce,wn=ft==Ut;if(wn&&ei(Ee)){if(!ei(Ve))return!1;At=!0,yn=!1}if(wn&&!yn)return $e||($e=new Jt),At||go(Ee)?ao(Ee,Ve,We,Ct,Qe,$e):function(Ne,xe,mr,Wt,ti,St,jt){switch(mr){case Ye:if(Ne.byteLength!=xe.byteLength||Ne.byteOffset!=xe.byteOffset)return!1;Ne=Ne.buffer,xe=xe.buffer;case et:return!(Ne.byteLength!=xe.byteLength||!St(new no(Ne),new no(xe)));case E:case z:case W:return fo(+Ne,+xe);case J:return Ne.name==xe.name&&Ne.message==xe.message;case _e:case F:return Ne==xe+"";case Z:var Ht=gs;case Je:var Nn=1&Wt;if(Ht||(Ht=ms),Ne.size!=xe.size&&!Nn)return!1;var _r=jt.get(Ne);if(_r)return _r==xe;Wt|=2,jt.set(Ne,xe);var En=ao(Ht(Ne),Ht(xe),Wt,ti,St,jt);return jt.delete(Ne),En;case re:if($r)return $r.call(Ne)==$r.call(xe)}return!1}(Ee,Ve,ft,We,Ct,Qe,$e);if(!(1&We)){var xn=yn&&Pt.call(Ee,"__wrapped__"),mo=gr&&Pt.call(Ve,"__wrapped__");if(xn||mo){var Rs=xn?Ee.value():Ee,Fs=mo?Ve.value():Ve;return $e||($e=new Jt),Qe(Rs,Fs,We,Ct,$e)}}return wn?($e||($e=new Jt),function(Ne,xe,mr,Wt,ti,St){var jt=1&mr,Ht=uo(Ne),Nn=Ht.length,_r=uo(xe).length;if(Nn!=_r&&!jt)return!1;for(var En=Nn;En--;){var un=Ht[En];if(!(jt?un in xe:Pt.call(xe,un)))return!1}var _o=St.get(Ne);if(_o&&St.get(xe))return _o==xe;var br=!0;St.set(Ne,xe),St.set(xe,Ne);for(var ni=jt;++En<Nn;){var vr=Ne[un=Ht[En]],yr=xe[un];if(Wt)var bo=jt?Wt(yr,vr,un,xe,Ne,St):Wt(vr,yr,un,Ne,xe,St);if(!(bo===void 0?vr===yr||ti(vr,yr,mr,Wt,St):bo)){br=!1;break}ni||(ni=un=="constructor")}if(br&&!ni){var wr=Ne.constructor,Er=xe.constructor;wr==Er||!("constructor"in Ne)||!("constructor"in xe)||typeof wr=="function"&&wr instanceof wr&&typeof Er=="function"&&Er instanceof Er||(br=!1)}return St.delete(Ne),St.delete(xe),br}(Ee,Ve,We,Ct,Qe,$e)):!1}(S,L,H,ie,so,Ue))}function Ms(S){return!(!po(S)||function(L){return!!$i&&$i in L}(S))&&(co(S)?vs:Yr).test(an(S))}function Ls(S){if(H=(L=S)&&L.constructor,ie=typeof H=="function"&&H.prototype||ur,L!==ie)return Es(S);var L,H,ie,Ue=[];for(var Ee in Object(S))Pt.call(S,Ee)&&Ee!="constructor"&&Ue.push(Ee);return Ue}function ao(S,L,H,ie,Ue,Ee){var Ve=1&H,We=S.length,Ct=L.length;if(We!=Ct&&!(Ve&&Ct>We))return!1;var Qe=Ee.get(S);if(Qe&&Ee.get(L))return Qe==L;var $e=-1,At=!0,Dt=2&H?new cr:void 0;for(Ee.set(S,L),Ee.set(L,S);++$e<We;){var ft=S[$e],Ut=L[$e];if(ie)var yn=Ve?ie(Ut,ft,$e,L,S,Ee):ie(ft,Ut,$e,S,L,Ee);if(yn!==void 0){if(yn)continue;At=!1;break}if(Dt){if(!ps(L,function(gr,wn){if(xn=wn,!Dt.has(xn)&&(ft===gr||Ue(ft,gr,H,ie,Ee)))return Dt.push(wn);var xn})){At=!1;break}}else if(ft!==Ut&&!Ue(ft,Ut,H,ie,Ee)){At=!1;break}}return Ee.delete(S),Ee.delete(L),At}function uo(S){return function(L,H,ie){var Ue=H(L);return pr(L)?Ue:function(Ee,Ve){for(var We=-1,Ct=Ve.length,Qe=Ee.length;++We<Ct;)Ee[Qe+We]=Ve[We];return Ee}(Ue,ie(L))}(S,Ns,Ps)}function hr(S,L){var H,ie,Ue=S.__data__;return((ie=typeof(H=L))=="string"||ie=="number"||ie=="symbol"||ie=="boolean"?H!=="__proto__":H===null)?Ue[typeof L=="string"?"string":"hash"]:Ue.map}function vn(S,L){var H=function(ie,Ue){return ie==null?void 0:ie[Ue]}(S,L);return Ms(H)?H:void 0}ln.prototype.clear=function(){this.__data__=Ln?Ln(null):{},this.size=0},ln.prototype.delete=function(S){var L=this.has(S)&&delete this.__data__[S];return this.size-=L?1:0,L},ln.prototype.get=function(S){var L=this.__data__;if(Ln){var H=L[S];return H===d?void 0:H}return Pt.call(L,S)?L[S]:void 0},ln.prototype.has=function(S){var L=this.__data__;return Ln?L[S]!==void 0:Pt.call(L,S)},ln.prototype.set=function(S,L){var H=this.__data__;return this.size+=this.has(S)?0:1,H[S]=Ln&&L===void 0?d:L,this},Ft.prototype.clear=function(){this.__data__=[],this.size=0},Ft.prototype.delete=function(S){var L=this.__data__,H=dr(L,S);return!(H<0)&&(H==L.length-1?L.pop():ys.call(L,H,1),--this.size,!0)},Ft.prototype.get=function(S){var L=this.__data__,H=dr(L,S);return H<0?void 0:L[H][1]},Ft.prototype.has=function(S){return dr(this.__data__,S)>-1},Ft.prototype.set=function(S,L){var H=this.__data__,ie=dr(H,S);return ie<0?(++this.size,H.push([S,L])):H[ie][1]=L,this},sn.prototype.clear=function(){this.size=0,this.__data__={hash:new ln,map:new(Mn||Ft),string:new ln}},sn.prototype.delete=function(S){var L=hr(this,S).delete(S);return this.size-=L?1:0,L},sn.prototype.get=function(S){return hr(this,S).get(S)},sn.prototype.has=function(S){return hr(this,S).has(S)},sn.prototype.set=function(S,L){var H=hr(this,S),ie=H.size;return H.set(S,L),this.size+=H.size==ie?0:1,this},cr.prototype.add=cr.prototype.push=function(S){return this.__data__.set(S,d),this},cr.prototype.has=function(S){return this.__data__.has(S)},Jt.prototype.clear=function(){this.__data__=new Ft,this.size=0},Jt.prototype.delete=function(S){var L=this.__data__,H=L.delete(S);return this.size=L.size,H},Jt.prototype.get=function(S){return this.__data__.get(S)},Jt.prototype.has=function(S){return this.__data__.has(S)},Jt.prototype.set=function(S,L){var H=this.__data__;if(H instanceof Ft){var ie=H.__data__;if(!Mn||ie.length<199)return ie.push([S,L]),this.size=++H.size,this;H=this.__data__=new sn(ie)}return H.set(S,L),this.size=H.size,this};var Ps=io?function(S){return S==null?[]:(S=Object(S),function(L,H){for(var ie=-1,Ue=L==null?0:L.length,Ee=0,Ve=[];++ie<Ue;){var We=L[ie];H(We,ie,L)&&(Ve[Ee++]=We)}return Ve}(io(S),function(L){return ro.call(S,L)}))}:function(){return[]},Yt=Pn;function As(S,L){return!!(L=L??_)&&(typeof S=="number"||ds.test(S))&&S>-1&&S%1==0&&S<L}function an(S){if(S!=null){try{return Qi.call(S)}catch{}try{return S+""}catch{}}return""}function fo(S,L){return S===L||S!=S&&L!=L}(Zr&&Yt(new Zr(new ArrayBuffer(1)))!=Ye||Mn&&Yt(new Mn)!=Z||Xr&&Yt(Xr.resolve())!=Ge||Kr&&Yt(new Kr)!=Je||Qr&&Yt(new Qr)!=Ae)&&(Yt=function(S){var L=Pn(S),H=L==ce?S.constructor:void 0,ie=H?an(H):"";if(ie)switch(ie){case Ss:return Ye;case ks:return Z;case Ts:return Ge;case Cs:return Je;case Os:return Ae}return L});var xs=lo(function(){return arguments}())?lo:function(S){return An(S)&&Pt.call(S,"callee")&&!ro.call(S,"callee")},pr=Array.isArray,ei=ws||function(){return!1};function co(S){if(!po(S))return!1;var L=Pn(S);return L==X||L=="[object GeneratorFunction]"||L=="[object AsyncFunction]"||L=="[object Proxy]"}function ho(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=_}function po(S){var L=typeof S;return S!=null&&(L=="object"||L=="function")}function An(S){return S!=null&&typeof S=="object"}var go=Hi?function(S){return function(L){return S(L)}}(Hi):function(S){return An(S)&&ho(S.length)&&!!De[Pn(S)]};function Ns(S){return(L=S)!=null&&ho(L.length)&&!co(L)?Is(S):Ls(S);var L}i.exports=function(S,L){return so(S,L)}})({get exports(){return sr},set exports(i){sr=i}},sr);var as=sr;function zi(i,a){return i.length===a.length&&JSON.stringify(i.map(function(d){return d}).sort())===JSON.stringify(a.map(function(d){return d}).sort())}var us={Polygon:lt,LineString:ne,Point:O,MultiPolygon:Xe,MultiLineString:Xe,MultiPoint:Xe},fs=Object.freeze({__proto__:null,CommonSelectors:Jl,constrainFeatureMovement:qr,createMidPoint:xi,createSupplementaryPoints:er,createVertex:_n,doubleClickZoom:Tt,euclideanDistance:oe,featuresAt:te,getFeatureAtAndSetCursors:K,isClick:Le,isEventAtCoordinates:lr,isTap:Me,mapEventToBoundingBox:ae,ModeHandler:t,moveFeatures:Jr,sortFeatures:se,stringSetsAreEqual:zi,StringSet:U,theme:Li,toDenseArray:fe}),cs=function(i,a){var d={options:i=function(y){y===void 0&&(y={});var w=wt(y);return y.controls||(w.controls={}),y.displayControlsDefault===!1?w.controls=wt(ss,y.controls):w.controls=wt(ls,y.controls),(w=wt(os,w)).styles=Gi(w.styles,"cold").concat(Gi(w.styles,"hot")),w}(i)};a=function(y,w){return w.modes=b,w.getFeatureIdsAt=function(E){return te.click({point:E},null,y).map(function(z){return z.properties.id})},w.getSelectedIds=function(){return y.store.getSelectedIds()},w.getSelected=function(){return{type:g.FEATURE_COLLECTION,features:y.store.getSelectedIds().map(function(E){return y.store.get(E)}).map(function(E){return E.toGeoJSON()})}},w.getSelectedPoints=function(){return{type:g.FEATURE_COLLECTION,features:y.store.getSelectedCoordinates().map(function(E){return{type:g.FEATURE,properties:{},geometry:{type:g.POINT,coordinates:E.coordinates}}})}},w.set=function(E){if(E.type===void 0||E.type!==g.FEATURE_COLLECTION||!Array.isArray(E.features))throw new Error("Invalid FeatureCollection");var z=y.store.createRenderBatch(),J=y.store.getAllIds().slice(),X=w.add(E),Z=new U(X);return(J=J.filter(function(W){return!Z.has(W)})).length&&w.delete(J),z(),X},w.add=function(E){var z=JSON.parse(JSON.stringify(Ni(E))).features.map(function(J){if(J.id=J.id||Oe(),J.geometry===null)throw new Error("Invalid geometry: null");if(y.store.get(J.id)===void 0||y.store.get(J.id).type!==J.geometry.type){var X=us[J.geometry.type];if(X===void 0)throw new Error("Invalid geometry type: "+J.geometry.type+".");var Z=new X(y,J);y.store.add(Z)}else{var W=y.store.get(J.id);W.properties=J.properties,as(W.getCoordinates(),J.geometry.coordinates)||W.incomingCoords(J.geometry.coordinates)}return J.id});return y.store.render(),z},w.get=function(E){var z=y.store.get(E);if(z)return z.toGeoJSON()},w.getAll=function(){return{type:g.FEATURE_COLLECTION,features:y.store.getAll().map(function(E){return E.toGeoJSON()})}},w.delete=function(E){return y.store.delete(E,{silent:!0}),w.getMode()!==b.DIRECT_SELECT||y.store.getSelectedIds().length?y.store.render():y.events.changeMode(b.SIMPLE_SELECT,void 0,{silent:!0}),w},w.deleteAll=function(){return y.store.delete(y.store.getAllIds(),{silent:!0}),w.getMode()===b.DIRECT_SELECT?y.events.changeMode(b.SIMPLE_SELECT,void 0,{silent:!0}):y.store.render(),w},w.changeMode=function(E,z){return z===void 0&&(z={}),E===b.SIMPLE_SELECT&&w.getMode()===b.SIMPLE_SELECT?(zi(z.featureIds||[],y.store.getSelectedIds())||(y.store.setSelected(z.featureIds,{silent:!0}),y.store.render()),w):(E===b.DIRECT_SELECT&&w.getMode()===b.DIRECT_SELECT&&z.featureId===y.store.getSelectedIds()[0]||y.events.changeMode(E,z,{silent:!0}),w)},w.getMode=function(){return y.events.getMode()},w.trash=function(){return y.events.trash({silent:!0}),w},w.combineFeatures=function(){return y.events.combineFeatures({silent:!0}),w},w.uncombineFeatures=function(){return y.events.uncombineFeatures({silent:!0}),w},w.setFeatureProperty=function(E,z,J){return y.store.setFeatureProperty(E,z,J),w},w}(d,a),d.api=a;var _=ql(d);return a.onAdd=_.onAdd,a.onRemove=_.onRemove,a.types=h,a.options=i,a};function ar(i){cs(i,this)}return ar.modes=Bi,ar.constants=D,ar.lib=fs,ar})})(Gf);const kl=Ws(_i);function zf(n,e,t){let r,o;He(n,Mt,u=>t(2,r=u)),He(n,Oi,u=>t(3,o=u));let{mode:l}=e,{drawControls:s}=e;return r.on("mousemove",u=>{if(l=="select"&&o==null){let c=r.queryRenderedFeatures(u.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var f=null;c.length>0&&(f=c[0].id),Gt.set(f)}}),r.on("mouseout",()=>{l=="select"&&o==null&&Gt.set(null)}),r.on("click",u=>{if(l=="select"){let f=r.queryRenderedFeatures(u.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});f.length>0?Ar(f[0].id):Ar(null)}}),n.$$set=u=>{"mode"in u&&t(0,l=u.mode),"drawControls"in u&&t(1,s=u.drawControls)},n.$$.update=()=>{n.$$.dirty&3&&l=="select"&&s.changeMode("static")},[l,s]}class Vf extends ke{constructor(e){super(),Te(this,e,zf,null,Ce,{mode:0,drawControls:1})}}function qf(n,e,t){let r;He(n,Mt,p=>t(5,r=p));let{mode:o}=e,{routeSnapper:l}=e,{snapTool:s}=e,{drawControls:u}=e,f=null;r.on("mousemove",p=>{if(o=="edit"&&f==null){let m=r.queryRenderedFeatures(p.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});var v=null;m.length>0&&(v=m[0].id),Gt.set(v)}}),r.on("mouseout",()=>{o=="edit"&&f==null&&Gt.set(null)}),r.on("click",p=>{if(o=="edit"&&f==null){let v=r.queryRenderedFeatures(p.point,{layers:["interventions-points","interventions-lines","interventions-polygons"]});v.length>0&&c(v[0].id)}}),s.addEventListener("new-route",p=>{if(o=="edit"){const v=p.detail;je.update(m=>{let h=m.features.find(g=>g.id==f);return h.properties.length_meters=v.properties.length_meters,h.properties.waypoints=v.properties.waypoints,delete h.properties.hide_while_editing,h.geometry=v.geometry,m}),f=null,t(0,o="select")}}),r.on("draw.update",p=>{if(o=="edit"){const v=p.features[0];je.update(m=>{let h=m.features.find(g=>g.id==f);return h.geometry=v.geometry,m})}}),r.on("draw.selectionchange",p=>{o=="edit"&&p.features.length==0&&(u.changeMode("static"),je.update(v=>{let m=v.features.find(h=>h.id==f);return delete m.properties.hide_while_editing,v}),f=null,t(0,o="select"))});function c(p){Gt.set(null);let v;je.update(m=>(v=m.features.find(h=>h.id==p),v.properties.hide_while_editing=!0,m)),f=p,v.geometry.type=="LineString"?(v.properties.waypoints||(v.properties.waypoints=[{lon:v.geometry.coordinates[0][0],lat:v.geometry.coordinates[0][1],snapped:!0},{lon:v.geometry.coordinates[v.geometry.coordinates.length-1][0],lat:v.geometry.coordinates[v.geometry.coordinates.length-1][1],snapped:!0}]),l.editExisting(v)):v.geometry.type=="Polygon"?(u.add(v),u.changeMode("direct_select",{featureId:f})):v.geometry.type=="Point"&&(u.add(v),u.changeMode("simple_select"))}return n.$$set=p=>{"mode"in p&&t(0,o=p.mode),"routeSnapper"in p&&t(1,l=p.routeSnapper),"snapTool"in p&&t(2,s=p.snapTool),"drawControls"in p&&t(3,u=p.drawControls)},n.$$.update=()=>{n.$$.dirty&9&&o=="edit"&&u.changeMode("static")},[o,l,s,u]}class Jf extends ke{constructor(e){super(),Te(this,e,qf,null,Ce,{mode:0,routeSnapper:1,snapTool:2,drawControls:3})}}let ye;const Gl=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Gl.decode();let Ir=new Uint8Array;function Gn(){return Ir.byteLength===0&&(Ir=new Uint8Array(ye.memory.buffer)),Ir}function kn(n,e){return Gl.decode(Gn().subarray(n,n+e))}const Bt=new Array(32).fill(void 0);Bt.push(void 0,null,!0,!1);let zn=Bt.length;function tt(n){zn===Bt.length&&Bt.push(Bt.length+1);const e=zn;return zn=Bt[e],Bt[e]=n,e}function Se(n){return Bt[n]}function Yf(n){n<36||(Bt[n]=zn,zn=n)}function bi(n){const e=Se(n);return Yf(n),e}function oi(n){return n==null}let Mr=new Float64Array;function Wf(){return Mr.byteLength===0&&(Mr=new Float64Array(ye.memory.buffer)),Mr}let Lr=new Int32Array;function nt(){return Lr.byteLength===0&&(Lr=new Int32Array(ye.memory.buffer)),Lr}let Qt=0;const Pr=new TextEncoder("utf-8"),Hf=typeof Pr.encodeInto=="function"?function(n,e){return Pr.encodeInto(n,e)}:function(n,e){const t=Pr.encode(n);return e.set(t),{read:n.length,written:t.length}};function Cr(n,e,t){if(t===void 0){const u=Pr.encode(n),f=e(u.length);return Gn().subarray(f,f+u.length).set(u),Qt=u.length,f}let r=n.length,o=e(r);const l=Gn();let s=0;for(;s<r;s++){const u=n.charCodeAt(s);if(u>127)break;l[o+s]=u}if(s!==r){s!==0&&(n=n.slice(s)),o=t(o,r,r=s+n.length*3);const u=Gn().subarray(o+s,o+r),f=Hf(n,u);s+=f.written}return Qt=s,o}function vi(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let l="[";o>0&&(l+=vi(n[0]));for(let s=1;s<o;s++)l+=", "+vi(n[s]);return l+="]",l}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function Zf(n,e){const t=e(n.length*1);return Gn().set(n,t/1),Qt=n.length,t}function li(n,e){try{return n.apply(this,e)}catch(t){ye.__wbindgen_exn_store(tt(t))}}class Fr{static __wrap(e){const t=Object.create(Fr.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();ye.__wbg_jsroutesnapper_free(e)}constructor(e){try{const l=ye.__wbindgen_add_to_stack_pointer(-16),s=Zf(e,ye.__wbindgen_malloc),u=Qt;ye.jsroutesnapper_new(l,s,u);var t=nt()[l/4+0],r=nt()[l/4+1],o=nt()[l/4+2];if(o)throw bi(r);return Fr.__wrap(t)}finally{ye.__wbindgen_add_to_stack_pointer(16)}}setConfig(e){ye.jsroutesnapper_setConfig(this.ptr,tt(e))}toFinalFeature(){try{const r=ye.__wbindgen_add_to_stack_pointer(-16);ye.jsroutesnapper_toFinalFeature(r,this.ptr);var e=nt()[r/4+0],t=nt()[r/4+1];let o;return e!==0&&(o=kn(e,t).slice(),ye.__wbindgen_free(e,t*1)),o}finally{ye.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){try{const r=ye.__wbindgen_add_to_stack_pointer(-16);ye.jsroutesnapper_renderGeojson(r,this.ptr);var e=nt()[r/4+0],t=nt()[r/4+1];return kn(e,t)}finally{ye.__wbindgen_add_to_stack_pointer(16),ye.__wbindgen_free(e,t)}}setSnapMode(e){ye.jsroutesnapper_setSnapMode(this.ptr,e)}onMouseMove(e,t,r){return ye.jsroutesnapper_onMouseMove(this.ptr,e,t,r)!==0}onClick(){ye.jsroutesnapper_onClick(this.ptr)}onDragStart(){return ye.jsroutesnapper_onDragStart(this.ptr)!==0}onMouseUp(){return ye.jsroutesnapper_onMouseUp(this.ptr)!==0}clearState(){ye.jsroutesnapper_clearState(this.ptr)}editExisting(e){try{const o=ye.__wbindgen_add_to_stack_pointer(-16);ye.jsroutesnapper_editExisting(o,this.ptr,tt(e));var t=nt()[o/4+0],r=nt()[o/4+1];if(r)throw bi(t)}finally{ye.__wbindgen_add_to_stack_pointer(16)}}}async function Xf(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function Kf(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const r=kn(e,t);return tt(r)},n.wbg.__wbindgen_object_drop_ref=function(e){bi(e)},n.wbg.__wbindgen_boolean_get=function(e){const t=Se(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_error_new=function(e,t){const r=new Error(kn(e,t));return tt(r)},n.wbg.__wbindgen_is_object=function(e){const t=Se(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return Se(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return Se(e)in Se(t)},n.wbg.__wbindgen_number_get=function(e,t){const r=Se(t),o=typeof r=="number"?r:void 0;Wf()[e/8+1]=oi(o)?0:o,nt()[e/4+0]=!oi(o)},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return Se(e)==Se(t)},n.wbg.__wbindgen_string_get=function(e,t){const r=Se(t),o=typeof r=="string"?r:void 0;var l=oi(o)?0:Cr(o,ye.__wbindgen_malloc,ye.__wbindgen_realloc),s=Qt;nt()[e/4+1]=s,nt()[e/4+0]=l},n.wbg.__wbg_String_91fba7ded13ba54c=function(e,t){const r=String(Se(t)),o=Cr(r,ye.__wbindgen_malloc,ye.__wbindgen_realloc),l=Qt;nt()[e/4+1]=l,nt()[e/4+0]=o},n.wbg.__wbindgen_object_clone_ref=function(e){const t=Se(e);return tt(t)},n.wbg.__wbg_getwithrefkey_15c62c2b8546208d=function(e,t){const r=Se(e)[Se(t)];return tt(r)},n.wbg.__wbg_log_4b5638ad60bdc54a=function(e){console.log(Se(e))},n.wbg.__wbg_get_57245cc7d7c7619d=function(e,t){const r=Se(e)[t>>>0];return tt(r)},n.wbg.__wbg_length_6e3bbe7c8bd4dbd8=function(e){return Se(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof Se(e)=="function"},n.wbg.__wbg_next_579e583d33566a86=function(e){const t=Se(e).next;return tt(t)},n.wbg.__wbg_next_aaef7c8aa5e212ac=function(){return li(function(e){const t=Se(e).next();return tt(t)},arguments)},n.wbg.__wbg_done_1b73b0672e15f234=function(e){return Se(e).done},n.wbg.__wbg_value_1ccc36bc03462d71=function(e){const t=Se(e).value;return tt(t)},n.wbg.__wbg_iterator_6f9d4f28845f426c=function(){return tt(Symbol.iterator)},n.wbg.__wbg_get_765201544a2b6869=function(){return li(function(e,t){const r=Reflect.get(Se(e),Se(t));return tt(r)},arguments)},n.wbg.__wbg_call_97ae9d8645dc388b=function(){return li(function(e,t){const r=Se(e).call(Se(t));return tt(r)},arguments)},n.wbg.__wbg_isArray_27c46c67f498e15d=function(e){return Array.isArray(Se(e))},n.wbg.__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b=function(e){let t;try{t=Se(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_buffer_3f3d764d4747d564=function(e){const t=Se(e).buffer;return tt(t)},n.wbg.__wbg_new_8c3f0052272a457a=function(e){const t=new Uint8Array(Se(e));return tt(t)},n.wbg.__wbg_set_83db9690f9353e79=function(e,t,r){Se(e).set(Se(t),r>>>0)},n.wbg.__wbg_length_9e1ae1900cb0fbd5=function(e){return Se(e).length},n.wbg.__wbg_instanceof_Uint8Array_971eeda69eb75003=function(e){let t;try{t=Se(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return tt(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const r=Se(t).stack,o=Cr(r,ye.__wbindgen_malloc,ye.__wbindgen_realloc),l=Qt;nt()[e/4+1]=l,nt()[e/4+0]=o},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){try{console.error(kn(e,t))}finally{ye.__wbindgen_free(e,t)}},n.wbg.__wbindgen_debug_string=function(e,t){const r=vi(Se(t)),o=Cr(r,ye.__wbindgen_malloc,ye.__wbindgen_realloc),l=Qt;nt()[e/4+1]=l,nt()[e/4+0]=o},n.wbg.__wbindgen_throw=function(e,t){throw new Error(kn(e,t))},n.wbg.__wbindgen_memory=function(){const e=ye.memory;return tt(e)},n}function Qf(n,e){return ye=n.exports,zl.__wbindgen_wasm_module=e,Mr=new Float64Array,Lr=new Int32Array,Ir=new Uint8Array,ye}async function zl(n){typeof n>"u"&&(n="/atip/draw_v3/assets/route_snapper_bg.wasm");const e=Kf();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await Xf(await n,e);return Qf(t,r)}var Jn,yi,Yn,wi,Wn,Ei,Nt,Zt;class $f{constructor(e,t,r){Rn(this,Jn);Rn(this,Yn);Rn(this,Wn);Rn(this,Nt);this.controlDiv=r,this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new Fr(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),console.log("JsRouteSnapper ready, waiting for idle event"),this.active=!1,this.map.once("idle",()=>{console.log("JsRouteSnapper now usable"),this.map.addSource("route-snapper",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"route-points",type:"circle",source:"route-snapper",paint:{"circle-radius":["match",["get","type"],"unimportant",10/2,10],"circle-color":["match",["get","type"],"hovered","green","important","red","black"]},filter:["in","$type","Point"]}),this.map.addLayer({id:"route-lines",type:"line",source:"route-snapper",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"black","line-width":2.5},filter:["in","$type","LineString"]}),this.map.on("mousemove",s=>{if(!this.active)return;const u={x:s.point.x-30,y:s.point.y},f=this.map.unproject(s.point).distanceTo(this.map.unproject(u));this.inner.onMouseMove(s.lngLat.lng,s.lngLat.lat,f)&&gt(this,Nt,Zt).call(this)}),this.map.on("click",()=>{this.active&&(this.inner.onClick(),gt(this,Nt,Zt).call(this))}),this.map.on("dragstart",s=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()}),this.map.on("mouseup",s=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()}),document.addEventListener("keypress",s=>{this.active&&s.key=="Enter"&&(s.preventDefault(),gt(this,Wn,Ei).call(this))}),document.addEventListener("keydown",s=>{this.active&&s.key=="Shift"&&(s.preventDefault(),this.inner.setSnapMode(!1),gt(this,Nt,Zt).call(this))}),document.addEventListener("keyup",s=>{this.active&&s.key=="Shift"&&(s.preventDefault(),this.inner.setSnapMode(!0),gt(this,Nt,Zt).call(this))}),gt(this,Jn,yi).call(this)})}isActive(){return this.active}tearDown(){this.map.removeLayer("route-points"),this.map.removeLayer("route-lines"),this.map.removeSource("route-snapper")}editExisting(e){gt(this,Yn,wi).call(this),this.inner.editExisting(e.properties.waypoints),gt(this,Nt,Zt).call(this)}}Jn=new WeakSet,yi=function(){this.active=!1,this.inner.clearState(),gt(this,Nt,Zt).call(this),this.controlDiv.innerHTML="";let e=document.createElement("button");e.innerText="Route tool",e.type="button",e.onclick=()=>{gt(this,Yn,wi).call(this)},this.controlDiv.appendChild(e)},Yn=new WeakSet,wi=function(){this.active=!0,this.controlDiv.dispatchEvent(new CustomEvent("activate")),this.controlDiv.innerHTML="";let e=document.createElement("button");e.type="button",e.innerText="Finish route",e.onclick=()=>{gt(this,Wn,Ei).call(this)},this.controlDiv.appendChild(e);let t=document.createElement("input");t.type="checkbox",t.id="avoidDoublingBack",t.onclick=()=>{this.inner.setConfig({avoid_doubling_back:t.checked}),gt(this,Nt,Zt).call(this)};let r=document.createElement("label");r.innerText="Avoid doubling back",r.for=t.id;let o=document.createElement("div");o.appendChild(t),o.appendChild(r),this.controlDiv.append(o);const l=document.createElement("ul");l.innerHTML="<li><b>Click</b> green points on the transport network</br>to create snapped routes</li><li>Hold <b>Shift</b> to draw a point anywhere</li><li><b>Click and drag</b> any point to move it</li><li><b>Click</b> a red waypoint to delete it</li><li>Press <b>Enter</b> to finish route</li>",this.controlDiv.appendChild(l)},Wn=new WeakSet,Ei=function(){const e=this.inner.toFinalFeature();e?this.controlDiv.dispatchEvent(new CustomEvent("new-route",{detail:JSON.parse(e)})):this.controlDiv.dispatchEvent(new CustomEvent("no-new-route")),gt(this,Jn,yi).call(this)},Nt=new WeakSet,Zt=function(){this.map.getSource("route-snapper").setData(JSON.parse(this.inner.renderGeojson()))};async function ec(n,e){const t=await fetch(n),r=t.body.getReader(),o=t.headers.get("Content-Length");let l=0,s=[];for(;;){const{done:c,value:p}=await r.read();if(c)break;s.push(p),l+=p.length;const v=100*l/o;e.style=`background: linear-gradient(to right, red ${v}%, transparent 0);`}let u=new Uint8Array(l),f=0;for(let c of s)u.set(c,f),f+=c.length;return u}function tc(n){let e,t;return{c(){e=R("div"),t=R("div"),t.textContent="Route tool loading..."},m(r,o){A(r,e,o),I(e,t),n[6](t),n[7](e)},p:Re,i:Re,o:Re,d(r){r&&x(e),n[6](null),n[7](null)}}}function nc(n,e,t){let r;He(n,Mt,m=>t(8,r=m));let{mode:o}=e,{url:l}=e,{drawControls:s}=e,{snapTool:u}=e,f,{routeSnapper:c}=e;Cn(async()=>{await zl(),console.log(`Grabbing ${l}`);try{const m=await ec(l,f);t(3,c=new $f(r,m,u))}catch(m){console.log(`Route tool broke: ${m}`),t(0,u.innerHTML="Failed to load",u)}u.addEventListener("activate",()=>{o=="select"&&t(2,o="route")}),u.addEventListener("no-new-route",()=>{o=="route"&&t(2,o="select")}),u.addEventListener("new-route",m=>{if(o=="route"){const h=m.detail;je.update(g=>(h.id=Pl(g),h.properties.intervention_type="route",g.features.push(h),g)),t(2,o="select")}})}),ki(()=>{c==null||c.tearDown()});function p(m){ze[m?"unshift":"push"](()=>{f=m,t(1,f)})}function v(m){ze[m?"unshift":"push"](()=>{u=m,t(0,u)})}return n.$$set=m=>{"mode"in m&&t(2,o=m.mode),"url"in m&&t(4,l=m.url),"drawControls"in m&&t(5,s=m.drawControls),"snapTool"in m&&t(0,u=m.snapTool),"routeSnapper"in m&&t(3,c=m.routeSnapper)},n.$$.update=()=>{n.$$.dirty&36&&o=="route"&&s.changeMode("static")},[u,f,o,c,l,s,p,v]}class rc extends ke{constructor(e){super(),Te(this,e,nc,tc,Ce,{mode:2,url:4,drawControls:5,snapTool:0,routeSnapper:3})}}function ic(n){let e;return{c(){e=R("p"),e.innerHTML="Click the map to add a vertex. Click the last vertex or press <strong>Enter</strong> to finish."},m(t,r){A(t,e,r)},d(t){t&&x(e)}}}function oc(n){let e;return{c(){e=R("p"),e.textContent="Click the map to draw a new point"},m(t,r){A(t,e,r)},d(t){t&&x(e)}}}function lc(n){let e;function t(l,s){if(l[0]=="point"&&l[1]==l[0])return oc;if(l[0]=="polygon"&&l[1]==l[0])return ic}let r=t(n),o=r&&r(n);return{c(){o&&o.c(),e=Hn()},m(l,s){o&&o.m(l,s),A(l,e,s)},p(l,[s]){r!==(r=t(l))&&(o&&o.d(1),o=r&&r(l),o&&(o.c(),o.m(e.parentNode,e)))},i:Re,o:Re,d(l){o&&o.d(l),l&&x(e)}}}function sc(n,e,t){let r;He(n,Mt,u=>t(3,r=u));let{mode:o}=e,{type:l}=e,{drawControls:s}=e;return r.on("draw.create",u=>{if(o==l){const f=u.features[0];je.update(c=>(f.properties.intervention_type=l=="point"?"other":"area",f.id=Pl(c),c.features.push(f),c)),s.deleteAll(),t(0,o="select")}}),n.$$set=u=>{"mode"in u&&t(0,o=u.mode),"type"in u&&t(1,l=u.type),"drawControls"in u&&t(2,s=u.drawControls)},n.$$.update=()=>{n.$$.dirty&7&&o==l&&s.changeMode(`draw_${l}`)},[o,l,s]}class Tl extends ke{constructor(e){super(),Te(this,e,sc,lc,Ce,{mode:0,type:1,drawControls:2})}}function Cl(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g,b,C,B,M,k,P,N,D,me,G,se,ae,U,ee,te,ue,K,oe,Le,Me,Oe,Ie,we,O;u=new Vf({props:{mode:n[4],drawControls:n[3]}});let ne=n[1]&&n[2]&&Ol(n);function lt(fe){n[10](fe)}let hn={drawControls:n[3],type:"point"};n[4]!==void 0&&(hn.mode=n[4]),P=new Tl({props:hn}),ze.push(()=>st(P,"mode",lt,n[4]));function zt(fe){n[11](fe)}let Xe={drawControls:n[3],type:"polygon"};n[4]!==void 0&&(Xe.mode=n[4]),ee=new Tl({props:Xe}),ze.push(()=>st(ee,"mode",zt,n[4]));function be(fe){n[12](fe)}function $(fe){n[13](fe)}function jr(fe){n[14](fe)}let pn={url:n[0],drawControls:n[3]};return n[4]!==void 0&&(pn.mode=n[4]),n[1]!==void 0&&(pn.routeSnapper=n[1]),n[2]!==void 0&&(pn.snapTool=n[2]),oe=new rc({props:pn}),ze.push(()=>st(oe,"mode",be,n[4])),ze.push(()=>st(oe,"routeSnapper",$,n[1])),ze.push(()=>st(oe,"snapTool",jr,n[2])),{c(){e=R("div"),t=R("div"),r=R("button"),o=ge("Select"),s=q(),de(u.$$.fragment),f=q(),c=R("div"),p=R("button"),v=ge("Edit"),h=q(),ne&&ne.c(),g=q(),b=R("div"),C=R("button"),B=ge("New point"),k=q(),de(P.$$.fragment),D=q(),me=R("div"),G=R("button"),se=ge("New polygon"),U=q(),de(ee.$$.fragment),ue=q(),K=R("div"),de(oe.$$.fragment),Y(r,"type","button"),r.disabled=l=n[4]=="select",Y(r,"class","svelte-51rdg3"),Y(p,"type","button"),p.disabled=m=n[4]=="edit",Y(p,"class","svelte-51rdg3"),Y(C,"type","button"),C.disabled=M=n[4]=="point",Y(C,"class","svelte-51rdg3"),Y(G,"type","button"),G.disabled=ae=n[4]=="polygon",Y(G,"class","svelte-51rdg3"),Y(e,"class","toolbox svelte-51rdg3")},m(fe,qe){A(fe,e,qe),I(e,t),I(t,r),I(r,o),I(t,s),he(u,t,null),I(e,f),I(e,c),I(c,p),I(p,v),I(c,h),ne&&ne.m(c,null),I(e,g),I(e,b),I(b,C),I(C,B),I(b,k),he(P,b,null),I(e,D),I(e,me),I(me,G),I(G,se),I(me,U),he(ee,me,null),I(e,ue),I(e,K),he(oe,K,null),Ie=!0,we||(O=[Q(r,"click",n[5]),Q(p,"click",n[6]),Q(C,"click",n[7]),Q(G,"click",n[8])],we=!0)},p(fe,qe){(!Ie||qe&16&&l!==(l=fe[4]=="select"))&&(r.disabled=l);const Pe={};qe&16&&(Pe.mode=fe[4]),qe&8&&(Pe.drawControls=fe[3]),u.$set(Pe),(!Ie||qe&16&&m!==(m=fe[4]=="edit"))&&(p.disabled=m),fe[1]&&fe[2]?ne?(ne.p(fe,qe),qe&6&&j(ne,1)):(ne=Ol(fe),ne.c(),j(ne,1),ne.m(c,null)):ne&&(rt(),V(ne,1,1,()=>{ne=null}),it()),(!Ie||qe&16&&M!==(M=fe[4]=="point"))&&(C.disabled=M);const gn={};qe&8&&(gn.drawControls=fe[3]),!N&&qe&16&&(N=!0,gn.mode=fe[4],at(()=>N=!1)),P.$set(gn),(!Ie||qe&16&&ae!==(ae=fe[4]=="polygon"))&&(G.disabled=ae);const wt={};qe&8&&(wt.drawControls=fe[3]),!te&&qe&16&&(te=!0,wt.mode=fe[4],at(()=>te=!1)),ee.$set(wt);const Vt={};qe&1&&(Vt.url=fe[0]),qe&8&&(Vt.drawControls=fe[3]),!Le&&qe&16&&(Le=!0,Vt.mode=fe[4],at(()=>Le=!1)),!Me&&qe&2&&(Me=!0,Vt.routeSnapper=fe[1],at(()=>Me=!1)),!Oe&&qe&4&&(Oe=!0,Vt.snapTool=fe[2],at(()=>Oe=!1)),oe.$set(Vt)},i(fe){Ie||(j(u.$$.fragment,fe),j(ne),j(P.$$.fragment,fe),j(ee.$$.fragment,fe),j(oe.$$.fragment,fe),Ie=!0)},o(fe){V(u.$$.fragment,fe),V(ne),V(P.$$.fragment,fe),V(ee.$$.fragment,fe),V(oe.$$.fragment,fe),Ie=!1},d(fe){fe&&x(e),pe(u),ne&&ne.d(),pe(P),pe(ee),pe(oe),we=!1,pt(O)}}}function Ol(n){let e,t,r;function o(s){n[9](s)}let l={routeSnapper:n[1],snapTool:n[2],drawControls:n[3]};return n[4]!==void 0&&(l.mode=n[4]),e=new Jf({props:l}),ze.push(()=>st(e,"mode",o,n[4])),{c(){de(e.$$.fragment)},m(s,u){he(e,s,u),r=!0},p(s,u){const f={};u&2&&(f.routeSnapper=s[1]),u&4&&(f.snapTool=s[2]),u&8&&(f.drawControls=s[3]),!t&&u&16&&(t=!0,f.mode=s[4],at(()=>t=!1)),e.$set(f)},i(s){r||(j(e.$$.fragment,s),r=!0)},o(s){V(e.$$.fragment,s),r=!1},d(s){pe(e,s)}}}function ac(n){let e,t,r=n[3]&&Cl(n);return{c(){r&&r.c(),e=Hn()},m(o,l){r&&r.m(o,l),A(o,e,l),t=!0},p(o,[l]){o[3]?r?(r.p(o,l),l&8&&j(r,1)):(r=Cl(o),r.c(),j(r,1),r.m(e.parentNode,e)):r&&(rt(),V(r,1,1,()=>{r=null}),it())},i(o){t||(j(r),t=!0)},o(o){V(r),t=!1},d(o){r&&r.d(o),o&&x(e)}}}function uc(n,e,t){let r;He(n,Mt,k=>t(15,r=k));let{routeUrl:o}=e,l,s,u,f="select";Cn(()=>{let k={};k.onSetup=function(){return this.setActionableState(),{}},k.toDisplayFeatures=function(N,D,me){me(D)},t(3,u=new kl({displayControlsDefault:!1,controls:{point:!0,polygon:!0},modes:Object.assign({static:k},kl.modes)})),r.addControl(u),u.changeMode("static");let P=document.getElementsByClassName("mapboxgl-ctrl-group mapboxgl-ctrl");for(;P.length>0;)P[0].remove()}),ki(()=>{u&&(r.removeControl(u),t(3,u=null))});function c(){t(4,f="select")}function p(){t(4,f="edit")}function v(){t(4,f="point")}function m(){t(4,f="polygon")}function h(k){f=k,t(4,f)}function g(k){f=k,t(4,f)}function b(k){f=k,t(4,f)}function C(k){f=k,t(4,f)}function B(k){l=k,t(1,l)}function M(k){s=k,t(2,s)}return n.$$set=k=>{"routeUrl"in k&&t(0,o=k.routeUrl)},[o,l,s,u,f,c,p,v,m,h,g,b,C,B,M]}class fc extends ke{constructor(e){super(),Te(this,e,uc,ac,Ce,{routeUrl:0})}}function cc(n){let e,t,r,o,l,s,u,f;return{c(){e=R("div"),t=R("button"),t.textContent="Home",r=q(),o=R("button"),o.textContent="About",l=q(),s=R("button"),s.textContent="Instructions",Y(t,"type","button"),Y(t,"onclick","window.open('index.html');"),Y(o,"type","button"),Y(s,"type","button"),Y(e,"slot","nav")},m(c,p){A(c,e,p),I(e,t),I(e,r),I(e,o),I(e,l),I(e,s),u||(f=[Q(o,"click",n[6]),Q(s,"click",n[7])],u=!0)},p:Re,d(c){c&&x(e),u=!1,pt(f)}}}function dc(n){let e,t,r,o,l,s,u,f,c,p,v,m;return l=new Mf({props:{boundaryGeojson:n[3]}}),u=new Tf({props:{authorityName:n[4]}}),v=new gf({}),{c(){e=R("div"),t=R("h1"),r=ge(n[4]),o=q(),de(l.$$.fragment),s=q(),de(u.$$.fragment),f=q(),c=R("br"),p=q(),de(v.$$.fragment),Y(e,"slot","sidebar")},m(h,g){A(h,e,g),I(e,t),I(t,r),I(t,o),he(l,t,null),I(e,s),he(u,e,null),I(e,f),I(e,c),I(e,p),he(v,e,null),m=!0},p(h,g){const b={};g&8&&(b.boundaryGeojson=h[3]),l.$set(b)},i(h){m||(j(l.$$.fragment,h),j(u.$$.fragment,h),j(v.$$.fragment,h),m=!0)},o(h){V(l.$$.fragment,h),V(u.$$.fragment,h),V(v.$$.fragment,h),m=!1},d(h){h&&x(e),pe(l),pe(u),pe(v)}}}function hc(n){let e,t,r,o,l,s,u,f,c,p,v,m,h,g;return e=new nf({props:{boundaryGeojson:n[3]}}),r=new Ff({}),l=new Uf({}),u=new Bf({}),c=new fc({props:{routeUrl:n[2]}}),v=new Af({props:{style:n[5]}}),h=new Nf({}),{c(){de(e.$$.fragment),t=q(),de(r.$$.fragment),o=q(),de(l.$$.fragment),s=q(),de(u.$$.fragment),f=q(),de(c.$$.fragment),p=q(),de(v.$$.fragment),m=q(),de(h.$$.fragment)},m(b,C){he(e,b,C),A(b,t,C),he(r,b,C),A(b,o,C),he(l,b,C),A(b,s,C),he(u,b,C),A(b,f,C),he(c,b,C),A(b,p,C),he(v,b,C),A(b,m,C),he(h,b,C),g=!0},p(b,C){const B={};C&8&&(B.boundaryGeojson=b[3]),e.$set(B);const M={};C&4&&(M.routeUrl=b[2]),c.$set(M)},i(b){g||(j(e.$$.fragment,b),j(r.$$.fragment,b),j(l.$$.fragment,b),j(u.$$.fragment,b),j(c.$$.fragment,b),j(v.$$.fragment,b),j(h.$$.fragment,b),g=!0)},o(b){V(e.$$.fragment,b),V(r.$$.fragment,b),V(l.$$.fragment,b),V(u.$$.fragment,b),V(c.$$.fragment,b),V(v.$$.fragment,b),V(h.$$.fragment,b),g=!1},d(b){pe(e,b),b&&x(t),pe(r,b),b&&x(o),pe(l,b),b&&x(s),pe(u,b),b&&x(f),pe(c,b),b&&x(p),pe(v,b),b&&x(m),pe(h,b)}}}function pc(n){let e,t,r;return t=new _u({props:{style:n[5],$$slots:{default:[hc]},$$scope:{ctx:n}}}),{c(){e=R("div"),de(t.$$.fragment),Y(e,"slot","main")},m(o,l){A(o,e,l),he(t,e,null),r=!0},p(o,l){const s={};l&8204&&(s.$$scope={dirty:l,ctx:o}),t.$set(s)},i(o){r||(j(t.$$.fragment,o),r=!0)},o(o){V(t.$$.fragment,o),r=!1},d(o){o&&x(e),pe(t)}}}function gc(n){let e,t,r,o,l,s,u,f;e=new Su({props:{$$slots:{main:[pc],sidebar:[dc],nav:[cc]},$$scope:{ctx:n}}});function c(h){n[8](h)}let p={};n[0]!==void 0&&(p.open=n[0]),r=new Hs({props:p}),ze.push(()=>st(r,"open",c,n[0]));function v(h){n[9](h)}let m={};return n[1]!==void 0&&(m.open=n[1]),s=new pu({props:m}),ze.push(()=>st(s,"open",v,n[1])),{c(){de(e.$$.fragment),t=q(),de(r.$$.fragment),l=q(),de(s.$$.fragment)},m(h,g){he(e,h,g),A(h,t,g),he(r,h,g),A(h,l,g),he(s,h,g),f=!0},p(h,[g]){const b={};g&8204&&(b.$$scope={dirty:g,ctx:h}),e.$set(b);const C={};!o&&g&1&&(o=!0,C.open=h[0],at(()=>o=!1)),r.$set(C);const B={};!u&&g&2&&(u=!0,B.open=h[1],at(()=>u=!1)),s.$set(B)},i(h){f||(j(e.$$.fragment,h),j(r.$$.fragment,h),j(s.$$.fragment,h),f=!0)},o(h){V(e.$$.fragment,h),V(r.$$.fragment,h),V(s.$$.fragment,h),f=!1},d(h){pe(e,h),h&&x(t),pe(r,h),h&&x(l),pe(s,h)}}}function mc(n,e,t){let r=!1,o=!1,l=window.location.hostname.includes("atip.uk");const s=new URLSearchParams(window.location.search);let u=s.get("authority"),f=s.get("style")||"streets";var c=`https://atip.uk/route-snappers/${u}.bin`;l||(c=`https://atip.uk/route-snappers-dev/${u}.bin`);function p(){t(0,r=!r),t(1,o=!1)}function v(){t(1,o=!o),t(0,r=!1)}let m;Cn(async()=>{t(3,m=await h())});async function h(){const B=await(await fetch(Zs)).text(),M=JSON.parse(B);return M.features=M.features.filter(k=>k.properties.name==u),M}function g(C){r=C,t(0,r)}function b(C){o=C,t(1,o)}return[r,o,c,m,u,f,p,v,g,b]}class _c extends ke{constructor(e){super(),Te(this,e,mc,gc,Ce,{})}}new _c({target:document.getElementById("app")});
