import{S as we,i as be,s as ke,B as ve,g as m,c as z,j as w,h as J,z as ye,p as $e,k,l as L,m as D,n as r,e as C,w as x,t as v,o as N,f as G,x as Se,q as Fe,v as Q,C as ee,r as Ce,D as Me,F as Ie,y as je,A as Ae,E as Be}from"./index-5e8c1361.js";import{i as Ee,l as Z,s as de,d as Le,b as Ne,g as U,f as te,a as Oe,h as He,e as ge}from"./files-07089bac.js";import{E as Re,F as ze}from"./Radio-6f289a5c.js";import{S as ne}from"./SecondaryButton-b9ba82ab.js";import{W as De}from"./WarningButton-00fcf6be.js";import{c as Ge}from"./config-19eb1e51.js";import{H as Je}from"./Header-06c1bf2b.js";import"./spread-8a54911c.js";import"./colors-27511475.js";import"./ButtonGroup-63e182e0.js";import"./Modal-99eb377d.js";function _e(o,e,t){const l=o.slice();return l[14]=e[t][0],l[15]=e[t][1],l}function We(o){let e;return{c(){e=m("p"),e.textContent="No saved files"},m(t,l){L(t,e,l)},p:Q,i:Q,o:Q,d(t){t&&N(e)}}}function Ye(o){let e,t,l,p,u,g,S,d=ge(o[1]),n=[];for(let a=0;a<d.length;a+=1)n[a]=pe(_e(o,d,a));const _=a=>C(n[a],1,1,()=>{n[a]=null});return{c(){e=m("h2"),e.textContent="Load existing files",t=w(),l=m("table"),p=m("thead"),p.innerHTML="<tr><th>File name</th> <th>Action</th></tr>",u=w(),g=m("tbody");for(let a=0;a<n.length;a+=1)n[a].c()},m(a,c){L(a,e,c),L(a,t,c),L(a,l,c),r(l,p),r(l,u),r(l,g);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(g,null);S=!0},p(a,c){if(c&626){d=ge(a[1]);let i;for(i=0;i<d.length;i+=1){const y=_e(a,d,i);n[i]?(n[i].p(y,c),v(n[i],1)):(n[i]=pe(y),n[i].c(),v(n[i],1),n[i].m(g,null))}for(ee(),i=d.length;i<n.length;i+=1)_(i);x()}},i(a){if(!S){for(let c=0;c<d.length;c+=1)v(n[c]);S=!0}},o(a){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)C(n[c]);S=!1},d(a){a&&(N(e),N(t),N(l)),je(n,a)}}}function qe(o){let e;return{c(){e=J("Rename")},m(t,l){L(t,e,l)},d(t){t&&N(e)}}}function Ke(o){let e;return{c(){e=J("Download")},m(t,l){L(t,e,l)},d(t){t&&N(e)}}}function Te(o){let e;return{c(){e=J("Delete")},m(t,l){L(t,e,l)},d(t){t&&N(e)}}}function pe(o){let e,t,l,p=o[14]+"",u,g,S,d,n,_,a,c,i,y,O,E;function s(){return o[10](o[14])}_=new ne({props:{$$slots:{default:[qe]},$$scope:{ctx:o}}}),_.$on("click",s);function b(){return o[11](o[14])}c=new ne({props:{$$slots:{default:[Ke]},$$scope:{ctx:o}}}),c.$on("click",b);function I(){return o[12](o[14])}return y=new De({props:{$$slots:{default:[Te]},$$scope:{ctx:o}}}),y.$on("click",I),{c(){e=m("tr"),t=m("td"),l=m("a"),u=J(p),S=w(),d=m("td"),n=m("div"),z(_.$$.fragment),a=w(),z(c.$$.fragment),i=w(),z(y.$$.fragment),O=w(),k(l,"href",g=te(o[4],o[14],o[15])),k(n,"class","govuk-button-group"),$e(n,"flex-wrap","nowrap")},m(h,F){L(h,e,F),r(e,t),r(t,l),r(l,u),r(e,S),r(e,d),r(d,n),D(_,n,null),r(n,a),D(c,n,null),r(n,i),D(y,n,null),r(e,O),E=!0},p(h,F){o=h,(!E||F&2)&&p!==(p=o[14]+"")&&Ae(u,p),(!E||F&2&&g!==(g=te(o[4],o[14],o[15])))&&k(l,"href",g);const q={};F&262144&&(q.$$scope={dirty:F,ctx:o}),_.$set(q);const K={};F&262144&&(K.$$scope={dirty:F,ctx:o}),c.$set(K);const Y={};F&262144&&(Y.$$scope={dirty:F,ctx:o}),y.$set(Y)},i(h){E||(v(_.$$.fragment,h),v(c.$$.fragment,h),v(y.$$.fragment,h),E=!0)},o(h){C(_.$$.fragment,h),C(c.$$.fragment,h),C(y.$$.fragment,h),E=!1},d(h){h&&N(e),G(_),G(c),G(y)}}}function Ue(o){let e;return{c(){e=J("Create new file")},m(t,l){L(t,e,l)},d(t){t&&N(e)}}}function he(o){let e,t;return e=new ze({props:{label:"Select a .geojson file",onLoad:o[8]}}),{c(){z(e.$$.fragment)},m(l,p){D(e,l,p),t=!0},p:Q,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Pe(o){let e,t,l,p,u,g,S,d,n,_,a,c,i,y,O,E,s,b,I,h,F,q,K,Y,oe,j,A,le,M,P,re,H,ae,V,se,W,ie,T;t=new Je({}),p=new ve({});const ce=[Ye,We],R=[];function ue(f,B){return f[1].length>0?0:1}j=ue(o),A=R[j]=ce[j](o),H=new ne({props:{$$slots:{default:[Ue]},$$scope:{ctx:o}}}),H.$on("click",o[7]),W=new Re({props:{errorMessage:o[2]}});let $=o[0]&&he(o);return{c(){e=m("div"),z(t.$$.fragment),l=w(),z(p.$$.fragment),u=w(),g=m("h1"),g.textContent="Manage my sketches",S=w(),d=m("div"),n=m("div"),_=m("nav"),a=m("ol"),c=m("li"),i=m("a"),y=J("Change area"),E=w(),s=m("li"),s.textContent="Manage files",b=w(),I=m("p"),h=J("You're working on sketches in "),F=m("b"),F.textContent=`${ye(o[4])}`,q=J(`
        .`),K=w(),Y=m("p"),Y.textContent=`On this page you can manage your sketch files. All files are auto-saved
        in your browser's local storage. You can close your browser and continue
        later.`,oe=w(),A.c(),le=w(),M=m("div"),P=m("h2"),P.textContent="Create a new sketch",re=w(),z(H.$$.fragment),ae=w(),V=m("h2"),V.textContent="Import a saved sketch",se=w(),z(W.$$.fragment),ie=w(),$&&$.c(),$e(g,"margin-top","30px"),k(i,"class","govuk-breadcrumbs__link"),k(i,"href",O=`choose_area.html?scheme=${o[3]}`),k(c,"class","govuk-breadcrumbs__list-item"),k(s,"class","govuk-breadcrumbs__list-item"),k(a,"class","govuk-breadcrumbs__list"),k(_,"class","govuk-breadcrumbs"),k(_,"aria-label","Breadcrumb"),k(n,"class","govuk-grid-column-two-thirds"),k(P,"class","green-bar svelte-1z050ke"),k(M,"class","govuk-grid-column-one-third"),k(d,"class","govuk-grid-row"),k(e,"class","govuk-width-container govuk-prose")},m(f,B){L(f,e,B),D(t,e,null),r(e,l),D(p,e,null),r(e,u),r(e,g),r(e,S),r(e,d),r(d,n),r(n,_),r(_,a),r(a,c),r(c,i),r(i,y),r(a,E),r(a,s),r(n,b),r(n,I),r(I,h),r(I,F),r(I,q),r(n,K),r(n,Y),r(n,oe),R[j].m(n,null),r(d,le),r(d,M),r(M,P),r(M,re),D(H,M,null),r(M,ae),r(M,V),r(M,se),D(W,M,null),r(M,ie),$&&$.m(M,null),T=!0},p(f,[B]){(!T||B&8&&O!==(O=`choose_area.html?scheme=${f[3]}`))&&k(i,"href",O);let X=j;j=ue(f),j===X?R[j].p(f,B):(ee(),C(R[X],1,1,()=>{R[X]=null}),x(),A=R[j],A?A.p(f,B):(A=R[j]=ce[j](f),A.c()),v(A,1),A.m(n,null));const fe={};B&262144&&(fe.$$scope={dirty:B,ctx:f}),H.$set(fe);const me={};B&4&&(me.errorMessage=f[2]),W.$set(me),f[0]?$?($.p(f,B),B&1&&v($,1)):($=he(f),$.c(),v($,1),$.m(M,null)):$&&(ee(),C($,1,1,()=>{$=null}),x())},i(f){T||(v(t.$$.fragment,f),v(p.$$.fragment,f),v(A),v(H.$$.fragment,f),v(W.$$.fragment,f),v($),T=!0)},o(f){C(t.$$.fragment,f),C(p.$$.fragment,f),C(A),C(H.$$.fragment,f),C(W.$$.fragment,f),C($),T=!1},d(f){f&&N(e),G(t),G(p),R[j].d(),G(H),G(W),$&&$.d()}}}function Qe(o,e,t){let l;Se(o,Be,s=>t(3,l=s));let u=new URLSearchParams(window.location.search).get("authority")||"missing",g=null;Ee(u);let S=Z(u),d="";Fe(async()=>{Ce(),t(0,g=await Me()),g.features.some(s=>s.properties.full_name==u)||(window.location.href=`choose_area.html?schema=${l}&error=Authority name not found: ${u}`)});function n(s){let b=window.prompt(`Rename file ${s} to what?`,s);if(b){let I=U(u,s),h=window.localStorage.getItem(I);de(U(u,b),h),window.localStorage.removeItem(I),t(1,S=Z(u))}}function _(s){if(!window.confirm(`Really delete file ${s}? You can't undo this. (If you delete, a copy will still be downloaded to your browser's download folder, in case you make a mistake.)`))return;let b=U(u,s);Le(`${u}_${s}.json`,window.localStorage.getItem(b)),window.localStorage.removeItem(b),t(1,S=Z(u))}function a(){let s=window.prompt("What do you want to name your new file?");if(!s)return;let b=Ie(Ge);Object.values(b.schemes)[0].scheme_name=s,de(U(u,s),JSON.stringify(Ne(u,b))),window.location.href=te(u,s,l)}function c(s,b){try{window.location.href=Oe(s,b,g)}catch(I){t(2,d=`Couldn't import file: ${I}`)}}function i(s){let b=JSON.parse(window.localStorage.getItem(U(u,s)));He(u,s,b)}return[g,S,d,l,u,n,_,a,c,i,s=>n(s),s=>i(s),s=>_(s)]}class Ve extends we{constructor(e){super(),be(this,e,Qe,Pe,ke,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new Ve({target:document.getElementById("app")});
