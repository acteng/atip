import{S as V,i as W,s as U,g as Ae,k as se,l as E,v as ae,o as G,N as fe,aj as ct,aw as Ze,O as bt,ax as De,D as Ce,t as k,A as ge,e as S,w as ye,ar as Fe,x as H,E as _e,F as be,G as we,H as ve,I as Me,J as Le,b as Ie,a as Be,c as oe,m as ne,d as Ee,f as ie,a3 as te,al as ue,ay as _t,ak as Ke,ad as Ve,a1 as kt,au as At,a2 as Ct,j as he,az as St,q as mt,aA as wt,h as vt,n as We,an as Mt,ai as Ye,ae as Lt}from"./stores-638b3428.js";import{c as dt,b as zt,E as Ot}from"./index-04d2de8e.js";const Tt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function It(n){let e;return{c(){e=Ae("div"),e.innerHTML=`<p class="govuk-phase-banner__content"><strong class="govuk-tag govuk-phase-banner__content__tag">Alpha</strong> <span class="govuk-phase-banner__text">This is a new service. Contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      with any feedback.</span></p>`,se(e,"class","govuk-phase-banner")},m(t,o){E(t,e,o)},p:ae,i:ae,o:ae,d(t){t&&G(e)}}}class Zo extends V{constructor(e){super(),W(this,e,null,It,U,{})}}const Ge=fe(""),Re=fe(null);async function Bt(n){let e=ct(Re);if(!n||!e)return"Google (attributions loading)";let[t,o]=e,r=n.getBounds(),i=`https://tile.googleapis.com/tile/v1/viewport?session=${o}&key=${t}&zoom=${Math.floor(n.getZoom())}&north=${r.getNorth()}&south=${r.getSouth()}&east=${r.getEast()}&west=${r.getWest()}`;return(await(await fetch(i)).json()).copyright}function jo(){let n=[];return dt()=="Private (development)"&&(n=n.concat([["google","Google satellite"],["Road","OS Road"],["Light","OS Light"],["Outdoor","OS Outdoor"],["bluesky","Bluesky Satellite (12.5cm)"]])),n.concat([["streets","MapTiler Streets"],["hybrid","MapTiler Satellite"],["dataviz","MapTiler Dataviz"],["uk-openzoomstack-light","OS Open Zoomstack"]])}async function qe(n){if(Re.set(null),n=="streets"||n=="hybrid"||n=="dataviz"||n=="uk-openzoomstack-light")return Ge.set("&copy; MapTiler &copy; OpenStreetMap contributors"),`https://api.maptiler.com/maps/${n}/style.json?key=MZEJTanw3WpxRvt7qDfo`;let t=await(await fetch(`${zt()}/api_keys.json`)).json(),o,r;if(n=="google"){let i=t.google,l=await Et(i);o=`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${l}&key=${i}`,r="Google (attributions loading)",Re.set([i,l])}else n=="bluesky"?(o=`https://ogc.apps.midgard.airbusds-cint.com/apgb/wmts/rest/apgb:AP-12CM5-GB-LATEST/default/EPSG-3857/EPSG:3857:{z}/{y}/{x}?GUID=${t.bluesky}&format=image/png&TRANSPARENT=FALSE,`,r="Bluesky"):(o=`https://api.os.uk/maps/raster/v1/zxy/${n}_3857/{z}/{x}/{y}.png?key=${t.ordnance_survey}`,r="Contains OS data &copy; Crown copyright and database rights 2023");return Ge.set(r),{version:8,sources:{"raster-tiles":{type:"raster",tiles:[o],tileSize:256,attribution:r}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:"https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=MZEJTanw3WpxRvt7qDfo"}}async function Et(n){try{let t=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${n}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in t?t.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(t)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}let Gt=Date.now();function Pe(n){return`${n}-${Gt++}`}const je=Symbol.for("svelte-maplibre");function ze(){return bt(je)}function Ht(n){let e=new WeakMap;return t=>{var l;let o=e.get(t.originalEvent);if(o!==void 0)return o;let i=(l=t.target.queryRenderedFeatures(t.point).find(f=>{var s;return(s=n.get(f.layer.id))==null?void 0:s.interactive}))==null?void 0:l.layer.id;return e.set(t.originalEvent,i),i}}function Ft(){let n=new Map;return Ze(je,{map:fe(null),source:De(null),layer:De(null),popupTarget:De(null),cluster:fe(),loadedImages:fe(new Set),minzoom:fe(0),maxzoom:fe(24),layerEvent:fe(null),layerInfo:n,eventTopMost:Ht(n)})}function Je(n){return{subscribe:n.subscribe}}function Ue({key:n,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:o=!1}){let r=ze(),i=fe(null),l=Je(i),f={...r,[n]:Je(i)};if(e&&(f.popupTarget=l),o){let s=fe(null);f.layerEvent=s,r.layerEvent=s}return t&&(f.cluster=fe()),Ze(je,f),{...r,self:i}}function Pt(){return Ue({key:"source",setCluster:!0})}function Dt(n=!0){return Ue({key:"layer",setPopupTarget:n,setMouseEvent:n})}function Uo(){return Ue({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function Rt(n){return"layerType"in n&&n.layerType==="deckgl"}function Xe(n){let e;return t=>{if(t)for(let o in t){let r=e==null?void 0:e[o],i=t[o];r!==i&&n(o,i,r)}else if(e)for(let o in e)n(o,void 0,e[o]);e=t}}function Zt(n,...e){let t=[n];for(let o of e)if(o)Array.isArray(o)&&o[0]===n?t.push(...o.slice(1)):t.push(o);else continue;if(t.length!==1)return t.length===2?t[1]:t}function jt(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function No(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}var He=Ut;function Ut(n){var e,t,o;if(n){if(Array.isArray(n)){for(e=[],t=n.length,o=0;o<t;o++){var r=n[o];r!=null&&e.push(r)}return e}if(typeof n=="object"){e={};var i=Object.keys(n);for(t=i.length,o=0;o<t;o++){var l=i[o],f=n[l];f!=null&&(e[l]=f)}return e}}}function xe(n){let e=n[0],t,o,r=pe(n);return{c(){r.c(),t=Ce()},m(i,l){r.m(i,l),E(i,t,l),o=!0},p(i,l){l[0]&1&&U(e,e=i[0])?(ge(),S(r,1,1,ae),ye(),r=pe(i),r.c(),k(r,1),r.m(t.parentNode,t)):r.p(i,l)},i(i){o||(k(r),o=!0)},o(i){S(r),o=!1},d(i){i&&G(t),r.d(i)}}}function pe(n){let e;const t=n[36].default,o=we(t,n,n[35],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i[1]&16)&&ve(o,t,r,r[35],e?Le(t,r[35],i,null):Me(r[35]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function Nt(n){let e,t,o=n[0]&&xe(n);return{c(){o&&o.c(),e=Ce()},m(r,i){o&&o.m(r,i),E(r,e,i),t=!0},p(r,i){r[0]?o?(o.p(r,i),i[0]&1&&k(o,1)):(o=xe(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),ye())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function Qt(n,e,t){let o,r,i,l,f,s,m,c,g,b,w,y,{$$slots:A={},$$scope:h}=e,{id:v=Pe("layer")}=e,{source:I=void 0}=e,{sourceLayer:T=void 0}=e,{beforeId:F=void 0}=e,{beforeLayerType:B=void 0}=e,{type:O}=e,{paint:L=void 0}=e,{layout:_=void 0}=e,{filter:z=void 0}=e,{applyToClusters:N=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:ce=void 0}=e,{manageHoverState:Y=!1}=e,{hovered:x=null}=e,{interactive:p=!0}=e,{hoverCursor:q=void 0}=e,{eventsIfTopMost:C=!1}=e;const J=Fe(),{map:Q,source:j,self:re,minzoom:P,maxzoom:D,eventTopMost:X,layerInfo:K}=Dt();H(n,Q,u=>t(31,g=u)),H(n,j,u=>t(32,b=u)),H(n,re,u=>t(0,c=u)),H(n,P,u=>t(34,y=u)),H(n,D,u=>t(33,w=u)),_e(()=>{c&&g&&(K.delete(c),g==null||g.removeLayer(c))});let R;function $(u){var de,ke;if(!p||!c||!g||C&&X(u)!==c)return;let a=u.features??[],M=(ke=(de=a[0])==null?void 0:de.properties)==null?void 0:ke.cluster_id,Z={event:u,map:g,clusterId:M,layer:c,source:f,features:a};J(u.type,Z)}function me(u){var de,ke;if(!p||!c||!g||C&&X(u)!==c)return;q&&(g.getCanvas().style.cursor=q);let a=u.features??[];t(6,x=a[0]??null);let M=(ke=(de=a[0])==null?void 0:de.properties)==null?void 0:ke.cluster_id;J("mouseenter",{event:u,map:g,clusterId:M,layer:c,source:f,features:a})}function Se(u){var de,ke,Qe;if(!p||!g)return;if(C&&X(u)!==c){t(6,x=null),Y&&R!==void 0&&(g==null||g.setFeatureState({source:f,sourceLayer:T,id:R},{hover:!1}),R=void 0);return}g.getCanvas().style.cursor=q;let a=u.features??[],M=(ke=(de=a[0])==null?void 0:de.properties)==null?void 0:ke.cluster_id,Z=(Qe=a[0])==null?void 0:Qe.id;Z!==R&&(Y&&(R!==void 0&&(g==null||g.setFeatureState({source:f,id:R,sourceLayer:T},{hover:!1})),g==null||g.setFeatureState({source:f,id:Z,sourceLayer:T},{hover:!0})),R=Z,t(6,x=a[0]??null)),J("mousemove",{event:u,map:g,clusterId:M,layer:c,source:f,features:a})}function le(u){if(!(!p||!c||!g)){if(q&&(g.getCanvas().style.cursor=""),t(6,x=null),Y&&R!==void 0){const a={source:f,id:R,sourceLayer:T};g==null||g.setFeatureState(a,{hover:!1}),R=void 0}J("mouseleave",{map:g,layer:c,source:f})}}let ee=!0;function Oe(u){g&&(g.off("click",u,$),g.off("dblclick",u,$),g.off("contextmenu",u,$),g.off("mouseenter",u,me),g.off("mousemove",u,Se),g.off("mouseleave",u,le))}return _e(()=>{g&&c&&Oe(c)}),n.$$set=u=>{"id"in u&&t(7,v=u.id),"source"in u&&t(8,I=u.source),"sourceLayer"in u&&t(9,T=u.sourceLayer),"beforeId"in u&&t(10,F=u.beforeId),"beforeLayerType"in u&&t(11,B=u.beforeLayerType),"type"in u&&t(12,O=u.type),"paint"in u&&t(13,L=u.paint),"layout"in u&&t(14,_=u.layout),"filter"in u&&t(15,z=u.filter),"applyToClusters"in u&&t(16,N=u.applyToClusters),"minzoom"in u&&t(17,d=u.minzoom),"maxzoom"in u&&t(18,ce=u.maxzoom),"manageHoverState"in u&&t(19,Y=u.manageHoverState),"hovered"in u&&t(6,x=u.hovered),"interactive"in u&&t(20,p=u.interactive),"hoverCursor"in u&&t(21,q=u.hoverCursor),"eventsIfTopMost"in u&&t(22,C=u.eventsIfTopMost),"$$scope"in u&&t(35,h=u.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&65536&&t(30,o=jt(N)),n.$$.dirty[0]&1073774592&&t(24,r=Zt("all",o,z)),n.$$.dirty[0]&131072|n.$$.dirty[1]&8&&t(26,i=d??y),n.$$.dirty[0]&262144|n.$$.dirty[1]&4&&t(25,l=ce??w),n.$$.dirty[0]&256|n.$$.dirty[1]&2&&t(29,f=I||b),n.$$.dirty[0]&654343809|n.$$.dirty[1]&1&&g&&c!==v&&f){c&&(Oe(c),K.delete(c));let u=F;if(!F&&B){let a=g.getStyle().layers,M=typeof B=="function"?B:de=>de.type===B,Z=a==null?void 0:a.find(M);Z&&(u=Z.id)}be(re,c=v,c),g.addLayer(He({id:c,type:O,source:f,"source-layer":T,filter:r,paint:L,layout:_,minzoom:i,maxzoom:l}),u),t(23,ee=!0),g.on("click",c,$),g.on("dblclick",c,$),g.on("contextmenu",c,$),g.on("mouseenter",c,me),g.on("mousemove",c,Se),g.on("mouseleave",c,le)}n.$$.dirty[0]&1048577&&c&&K.set(c,{interactive:p}),n.$$.dirty[0]&1|n.$$.dirty[1]&1&&t(28,s=c?Xe((u,a)=>g==null?void 0:g.setPaintProperty(c,u,a)):void 0),n.$$.dirty[0]&1|n.$$.dirty[1]&1&&t(27,m=c?Xe((u,a)=>g==null?void 0:g.setLayoutProperty(c,u,a)):void 0),n.$$.dirty[0]&268443648&&(s==null||s(L)),n.$$.dirty[0]&134234112&&(m==null||m(_)),n.$$.dirty[0]&100663297|n.$$.dirty[1]&1&&c&&(g==null||g.setLayerZoomRange(c,i,l)),n.$$.dirty[0]&25165825|n.$$.dirty[1]&1&&c&&(ee?t(23,ee=!1):g==null||g.setFilter(c,r))},[c,Q,j,re,P,D,x,v,I,T,F,B,O,L,_,z,N,d,ce,Y,p,q,C,ee,r,l,i,m,s,f,o,g,b,w,y,h,A]}class gt extends V{constructor(e){super(),W(this,e,Qt,Nt,U,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function Kt(n){let e;const t=n[15].default,o=we(t,n,n[23],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&8388608)&&ve(o,t,r,r[23],e?Le(t,r[23],i,null):Me(r[23]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function Vt(n){let e,t,o;function r(l){n[16](l)}let i={id:n[1],type:"fill",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],interactive:n[14],$$slots:{default:[Kt]},$$scope:{ctx:n}};return n[0]!==void 0&&(i.hovered=n[0]),e=new gt({props:i}),Ie.push(()=>Be(e,"hovered",r)),e.$on("click",n[17]),e.$on("dblclick",n[18]),e.$on("contextmenu",n[19]),e.$on("mouseenter",n[20]),e.$on("mousemove",n[21]),e.$on("mouseleave",n[22]),{c(){oe(e.$$.fragment)},m(l,f){ne(e,l,f),o=!0},p(l,[f]){const s={};f&2&&(s.id=l[1]),f&4&&(s.source=l[2]),f&8&&(s.sourceLayer=l[3]),f&16&&(s.beforeId=l[4]),f&32&&(s.beforeLayerType=l[5]),f&64&&(s.paint=l[6]),f&128&&(s.layout=l[7]),f&256&&(s.filter=l[8]),f&512&&(s.minzoom=l[9]),f&1024&&(s.maxzoom=l[10]),f&2048&&(s.hoverCursor=l[11]),f&4096&&(s.manageHoverState=l[12]),f&8192&&(s.eventsIfTopMost=l[13]),f&16384&&(s.interactive=l[14]),f&8388608&&(s.$$scope={dirty:f,ctx:l}),!t&&f&1&&(t=!0,s.hovered=l[0],Ee(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){S(e.$$.fragment,l),o=!1},d(l){ie(e,l)}}}function Wt(n,e,t){let{$$slots:o={},$$scope:r}=e,{id:i=Pe("fill")}=e,{source:l=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c}=e,{layout:g=void 0}=e,{filter:b=void 0}=e,{minzoom:w=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:h=!1}=e,{hovered:v=null}=e,{eventsIfTopMost:I=!1}=e,{interactive:T=!0}=e;function F(d){v=d,t(0,v)}function B(d){te.call(this,n,d)}function O(d){te.call(this,n,d)}function L(d){te.call(this,n,d)}function _(d){te.call(this,n,d)}function z(d){te.call(this,n,d)}function N(d){te.call(this,n,d)}return n.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,l=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,s=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,c=d.paint),"layout"in d&&t(7,g=d.layout),"filter"in d&&t(8,b=d.filter),"minzoom"in d&&t(9,w=d.minzoom),"maxzoom"in d&&t(10,y=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,h=d.manageHoverState),"hovered"in d&&t(0,v=d.hovered),"eventsIfTopMost"in d&&t(13,I=d.eventsIfTopMost),"interactive"in d&&t(14,T=d.interactive),"$$scope"in d&&t(23,r=d.$$scope)},[v,i,l,f,s,m,c,g,b,w,y,A,h,I,T,o,F,B,O,L,_,z,N,r]}class Qo extends V{constructor(e){super(),W(this,e,Wt,Vt,U,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function Yt(n,e,t){let o;const{map:r}=ze();H(n,r,s=>t(4,o=s));let{position:i="top-left"}=e,{container:l=void 0}=e,f=null;return _e(()=>{o!=null&&o.loaded()&&f&&o.removeControl(f)}),n.$$set=s=>{"position"in s&&t(1,i=s.position),"container"in s&&t(2,l=s.container)},n.$$.update=()=>{if(n.$$.dirty&30&&o&&!f){let s;typeof l=="string"?s=document.querySelector(l)??void 0:s=l,t(3,f=new ue.FullscreenControl({container:s})),o.addControl(f,i)}},[r,i,l,f,o]}class qt extends V{constructor(e){super(),W(this,e,Yt,null,U,{position:1,container:2})}}function Jt(n,e,t,o,r){let i=!1;n.getSource(e)&&(i=!0,n.removeSource(e));const l=()=>{o(e)&&(n.addSource(e,t),r())};if(i){const f=()=>{e&&(n.getSource(e)?setTimeout(f,1):l())};f()}else l()}function Xt(n,e,t){_t().then(()=>{let o=ct(n);if(!o)return;o.getSource(e)===t&&o.removeSource(e)})}function $e(n){let e=n[0],t,o,r=et(n);return{c(){r.c(),t=Ce()},m(i,l){r.m(i,l),E(i,t,l),o=!0},p(i,l){l&1&&U(e,e=i[0])?(ge(),S(r,1,1,ae),ye(),r=et(i),r.c(),k(r,1),r.m(t.parentNode,t)):r.p(i,l)},i(i){o||(k(r),o=!0)},o(i){S(r),o=!1},d(i){i&&G(t),r.d(i)}}}function et(n){let e;const t=n[19].default,o=we(t,n,n[18],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&262144)&&ve(o,t,r,r[18],e?Le(t,r[18],i,null):Me(r[18]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function xt(n){let e,t,o=n[0]&&$e(n);return{c(){o&&o.c(),e=Ce()},m(r,i){o&&o.m(r,i),E(r,e,i),t=!0},p(r,[i]){r[0]?o?(o.p(r,i),i&1&&k(o,1)):(o=$e(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),ye())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function pt(n,e,t){let o,r,i,{$$slots:l={},$$scope:f}=e,{id:s=Pe("geojson")}=e,{data:m}=e,{generateId:c=!1}=e,{promoteId:g=void 0}=e,{filter:b=void 0}=e,{lineMetrics:w=void 0}=e,{cluster:y=void 0}=e,{maxzoom:A=void 0}=e,{attribution:h=void 0}=e,{buffer:v=void 0}=e,{tolerance:I=void 0}=e;const{map:T,cluster:F,self:B}=Pt();H(n,T,_=>t(17,r=_)),H(n,F,_=>t(20,i=_)),H(n,B,_=>t(0,o=_));let O,L=!0;return _e(()=>{o&&O&&r&&(Xt(T,o,O),be(B,o=null,o),t(15,O=void 0))}),n.$$set=_=>{"id"in _&&t(4,s=_.id),"data"in _&&t(5,m=_.data),"generateId"in _&&t(6,c=_.generateId),"promoteId"in _&&t(7,g=_.promoteId),"filter"in _&&t(8,b=_.filter),"lineMetrics"in _&&t(9,w=_.lineMetrics),"cluster"in _&&t(10,y=_.cluster),"maxzoom"in _&&t(11,A=_.maxzoom),"attribution"in _&&t(12,h=_.attribution),"buffer"in _&&t(13,v=_.buffer),"tolerance"in _&&t(14,I=_.tolerance),"$$scope"in _&&t(18,f=_.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&be(F,i=y,i),n.$$.dirty&196593&&r&&o!==s&&(be(B,o=s,o),Jt(r,o,He({type:"geojson",data:m,filter:b,lineMetrics:w,generateId:c,promoteId:g,cluster:!!y,clusterMinPoints:y==null?void 0:y.minPoints,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius,clusterProperties:y==null?void 0:y.properties,maxzoom:A,attribution:h,buffer:v,tolerance:I}),_=>r&&_===o,()=>{o&&(t(15,O=r==null?void 0:r.getSource(o)),t(16,L=!0))})),n.$$.dirty&131088&&(r==null||r.on("style.load",()=>{t(15,O=r==null?void 0:r.getSource(s))})),n.$$.dirty&98336&&O&&(L?t(16,L=!1):O.setData(m)),n.$$.dirty&33792&&(O==null||O.setClusterOptions(He({cluster:!!y,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius})))},[o,T,F,B,s,m,c,g,b,w,y,A,h,v,I,O,L,r,f,l]}class Ko extends V{constructor(e){super(),W(this,e,pt,xt,U,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10,maxzoom:11,attribution:12,buffer:13,tolerance:14})}}function $t(n,e,t){let o;const{map:r}=ze();H(n,r,b=>t(8,o=b));let{position:i="top-left"}=e,{positionOptions:l=void 0}=e,{fitBoundsOptions:f=void 0}=e,{trackUserLocation:s=!1}=e,{showAccuracyCircle:m=!0}=e,{showUserLocation:c=!0}=e,{control:g=null}=e;return _e(()=>{o!=null&&o.loaded()&&g&&o.removeControl(g)}),n.$$set=b=>{"position"in b&&t(2,i=b.position),"positionOptions"in b&&t(3,l=b.positionOptions),"fitBoundsOptions"in b&&t(4,f=b.fitBoundsOptions),"trackUserLocation"in b&&t(5,s=b.trackUserLocation),"showAccuracyCircle"in b&&t(6,m=b.showAccuracyCircle),"showUserLocation"in b&&t(7,c=b.showUserLocation),"control"in b&&t(1,g=b.control)},n.$$.update=()=>{n.$$.dirty&510&&o&&!g&&(t(1,g=new ue.GeolocateControl({positionOptions:l,fitBoundsOptions:f,trackUserLocation:s,showAccuracyCircle:m,showUserLocation:c})),o.addControl(g,i))},[r,g,i,l,f,s,m,c,o]}class eo extends V{constructor(e){super(),W(this,e,$t,null,U,{position:2,positionOptions:3,fitBoundsOptions:4,trackUserLocation:5,showAccuracyCircle:6,showUserLocation:7,control:1})}}function to(n){let e;const t=n[15].default,o=we(t,n,n[23],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&8388608)&&ve(o,t,r,r[23],e?Le(t,r[23],i,null):Me(r[23]),null)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function oo(n){let e,t,o;function r(l){n[16](l)}let i={id:n[1],type:"line",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],interactive:n[14],$$slots:{default:[to]},$$scope:{ctx:n}};return n[0]!==void 0&&(i.hovered=n[0]),e=new gt({props:i}),Ie.push(()=>Be(e,"hovered",r)),e.$on("click",n[17]),e.$on("dblclick",n[18]),e.$on("contextmenu",n[19]),e.$on("mouseenter",n[20]),e.$on("mousemove",n[21]),e.$on("mouseleave",n[22]),{c(){oe(e.$$.fragment)},m(l,f){ne(e,l,f),o=!0},p(l,[f]){const s={};f&2&&(s.id=l[1]),f&4&&(s.source=l[2]),f&8&&(s.sourceLayer=l[3]),f&16&&(s.beforeId=l[4]),f&32&&(s.beforeLayerType=l[5]),f&64&&(s.paint=l[6]),f&128&&(s.layout=l[7]),f&256&&(s.filter=l[8]),f&512&&(s.minzoom=l[9]),f&1024&&(s.maxzoom=l[10]),f&2048&&(s.hoverCursor=l[11]),f&4096&&(s.manageHoverState=l[12]),f&8192&&(s.eventsIfTopMost=l[13]),f&16384&&(s.interactive=l[14]),f&8388608&&(s.$$scope={dirty:f,ctx:l}),!t&&f&1&&(t=!0,s.hovered=l[0],Ee(()=>t=!1)),e.$set(s)},i(l){o||(k(e.$$.fragment,l),o=!0)},o(l){S(e.$$.fragment,l),o=!1},d(l){ie(e,l)}}}function no(n,e,t){let{$$slots:o={},$$scope:r}=e,{id:i=Pe("line")}=e,{source:l=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c}=e,{layout:g=void 0}=e,{filter:b=void 0}=e,{minzoom:w=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:h=!1}=e,{hovered:v=null}=e,{eventsIfTopMost:I=!1}=e,{interactive:T=!0}=e;function F(d){v=d,t(0,v)}function B(d){te.call(this,n,d)}function O(d){te.call(this,n,d)}function L(d){te.call(this,n,d)}function _(d){te.call(this,n,d)}function z(d){te.call(this,n,d)}function N(d){te.call(this,n,d)}return n.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,l=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,s=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,c=d.paint),"layout"in d&&t(7,g=d.layout),"filter"in d&&t(8,b=d.filter),"minzoom"in d&&t(9,w=d.minzoom),"maxzoom"in d&&t(10,y=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,h=d.manageHoverState),"hovered"in d&&t(0,v=d.hovered),"eventsIfTopMost"in d&&t(13,I=d.eventsIfTopMost),"interactive"in d&&t(14,T=d.interactive),"$$scope"in d&&t(23,r=d.$$scope)},[v,i,l,f,s,m,c,g,b,w,y,A,h,I,T,o,F,B,O,L,_,z,N,r]}class Vo extends V{constructor(e){super(),W(this,e,no,oo,U,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function io(n,e,t){let o;const r=Fe();let{layer:i=void 0}=e;const{map:l}=ze();H(n,l,c=>t(2,o=c));function f(c){r(c.type,{...c,map:l})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],m=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return _e(()=>{if(o)if(i)for(const c of s)o.off(c,i,f);else for(const c of m)o.off(c,f)}),n.$$set=c=>{"layer"in c&&t(1,i=c.layer)},n.$$.update=()=>{if(n.$$.dirty&6&&o)if(i)for(const c of s)o.on(c,i,f);else for(const c of m)o.on(c,f)},[l,i,o]}class ro extends V{constructor(e){super(),W(this,e,io,null,U,{layer:1})}}function lo(n){let e=n.getCenter(),t=Math.round(n.getZoom()*100)/100,o=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,o),i=Math.round(e.lat*r)/r,l=Math.round(e.lng*r)/r,f=`${t}/${i}/${l}`,s=n.getBearing(),m=n.getPitch();return(s||m)&&(f+=`/${Math.round(s*10)/10}`),m&&(f+=`/${Math.round(m)}`),`#${f}`}function fo(n){return n.replace("#","").split("/").map(parseFloat)}var Te=Ne;function Ne(n,e){return n===e||n!==n&&e!==e?!0:typeof n!=typeof e||{}.toString.call(n)!={}.toString.call(e)||n!==Object(n)||!n?!1:Array.isArray(n)?tt(n,e):{}.toString.call(n)=="[object Set]"?tt(Array.from(n),Array.from(e)):{}.toString.call(n)=="[object Object]"?so(n,e):uo(n,e)}function uo(n,e){return n.toString()===e.toString()}function tt(n,e){var t=n.length;if(t!=e.length)return!1;for(var o=0;o<t;o++)if(!Ne(n[o],e[o]))return!1;return!0}function so(n,e){var t=Object.keys(n),o=t.length;if(o!=Object.keys(e).length)return!1;for(var r=0;r<o;r++){var i=t[r];if(!(e.hasOwnProperty(i)&&Ne(n[i],e[i])))return!1}return!0}function ao(n,e,t){let o;const{map:r}=ze();H(n,r,c=>t(6,o=c));let{position:i="top-left"}=e,{showCompass:l=!0}=e,{showZoom:f=!0}=e,{visualizePitch:s=!1}=e,m=null;return _e(()=>{o!=null&&o.loaded()&&m&&o.removeControl(m)}),n.$$set=c=>{"position"in c&&t(1,i=c.position),"showCompass"in c&&t(2,l=c.showCompass),"showZoom"in c&&t(3,f=c.showZoom),"visualizePitch"in c&&t(4,s=c.visualizePitch)},n.$$.update=()=>{n.$$.dirty&126&&o&&!m&&(t(5,m=new ue.NavigationControl({showCompass:l,showZoom:f,visualizePitch:s})),o.addControl(m,i))},[r,i,l,f,s,m,o]}class yt extends V{constructor(e){super(),W(this,e,ao,null,U,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function co(n,e,t){let o;const{map:r}=ze();H(n,r,m=>t(5,o=m));let{position:i="bottom-left"}=e,{maxWidth:l=void 0}=e,{unit:f="metric"}=e,s=null;return _e(()=>{o!=null&&o.loaded()&&s&&o.removeControl(s)}),n.$$set=m=>{"position"in m&&t(1,i=m.position),"maxWidth"in m&&t(2,l=m.maxWidth),"unit"in m&&t(3,f=m.unit)},n.$$.update=()=>{n.$$.dirty&62&&o&&!s&&(t(4,s=new ue.ScaleControl({maxWidth:l,unit:f})),o.addControl(s,i))},[r,i,l,f,s,o]}class ht extends V{constructor(e){super(),W(this,e,co,null,U,{position:1,maxWidth:2,unit:3})}}const{window:mo}=Tt,go=n=>({map:n[0]&16,loadedImages:n[0]&32,allImagesLoaded:n[0]&64}),ot=n=>({map:n[4],loadedImages:n[5],allImagesLoaded:n[6]});function nt(n){let e,t,o=n[3]&&it(n);const r=n[40].default,i=we(r,n,n[39],ot);return{c(){o&&o.c(),e=he(),i&&i.c()},m(l,f){o&&o.m(l,f),E(l,e,f),i&&i.m(l,f),t=!0},p(l,f){l[3]?o?(o.p(l,f),f[0]&8&&k(o,1)):(o=it(l),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),ye()),i&&i.p&&(!t||f[0]&112|f[1]&256)&&ve(i,r,l,l[39],t?Le(r,l[39],f,go):Me(l[39]),ot)},i(l){t||(k(o),k(i,l),t=!0)},o(l){S(o),S(i,l),t=!1},d(l){l&&G(e),o&&o.d(l),i&&i.d(l)}}}function it(n){let e,t,o,r,i,l,f,s;return e=new yt({props:{position:n[7]}}),o=new eo({props:{position:n[7],fitBoundsOptions:{maxZoom:12}}}),i=new qt({props:{position:n[7]}}),f=new ht({props:{position:n[7]}}),{c(){oe(e.$$.fragment),t=he(),oe(o.$$.fragment),r=he(),oe(i.$$.fragment),l=he(),oe(f.$$.fragment)},m(m,c){ne(e,m,c),E(m,t,c),ne(o,m,c),E(m,r,c),ne(i,m,c),E(m,l,c),ne(f,m,c),s=!0},p(m,c){const g={};c[0]&128&&(g.position=m[7]),e.$set(g);const b={};c[0]&128&&(b.position=m[7]),o.$set(b);const w={};c[0]&128&&(w.position=m[7]),i.$set(w);const y={};c[0]&128&&(y.position=m[7]),f.$set(y)},i(m){s||(k(e.$$.fragment,m),k(o.$$.fragment,m),k(i.$$.fragment,m),k(f.$$.fragment,m),s=!0)},o(m){S(e.$$.fragment,m),S(o.$$.fragment,m),S(i.$$.fragment,m),S(f.$$.fragment,m),s=!1},d(m){m&&(G(t),G(r),G(l)),ie(e,m),ie(o,m),ie(i,m),ie(f,m)}}}function yo(n){let e,t,o,r,i,l=n[4]&&n[0]&&nt(n);return{c(){e=Ae("div"),l&&l.c(),se(e,"class",t=Ke(n[2])+" svelte-p00lfq"),se(e,"data-testid","map-container"),Ve(e,"expand-map",!n[2])},m(f,s){E(f,e,s),l&&l.m(e,null),n[41](e),o=!0,r||(i=[kt(mo,"hashchange",n[11]),At(n[10].call(null,e))],r=!0)},p(f,s){f[4]&&f[0]?l?(l.p(f,s),s[0]&17&&k(l,1)):(l=nt(f),l.c(),k(l,1),l.m(e,null)):l&&(ge(),S(l,1,1,()=>{l=null}),ye()),(!o||s[0]&4&&t!==(t=Ke(f[2])+" svelte-p00lfq"))&&se(e,"class",t),(!o||s[0]&4)&&Ve(e,"expand-map",!f[2])},i(f){o||(k(l),o=!0)},o(f){S(l),o=!1},d(f){f&&G(e),l&&l.d(),n[41](null),r=!1,Ct(i)}}}function ho(n,e,t){let o,r,i,l,{$$slots:f={},$$scope:s}=e,{map:m=null}=e,{mapContainer:c=void 0}=e,{class:g=void 0}=e,{style:b}=e,{diffStyleUpdates:w=!1}=e,{center:y=void 0}=e,{zoom:A=void 0}=e,{pitch:h=0}=e,{bearing:v=0}=e,{bounds:I=void 0}=e,{hash:T=!1}=e,{updateHash:F=u=>{window.history.replaceState(window.history.state,"",u)}}=e,{loaded:B=!1}=e,{minZoom:O=0}=e,{maxZoom:L=22}=e,{antialias:_=void 0}=e,{zoomOnDoubleClick:z=!0}=e,{locale:N=void 0}=e,{interactive:d=!0}=e,{attributionControl:ce=!0}=e,{cooperativeGestures:Y=!1}=e,{preserveDrawingBuffer:x=!1}=e,{maxBounds:p=void 0}=e,{images:q=[]}=e,{standardControls:C=!1}=e,{filterLayers:J=void 0}=e,{transformRequest:Q=void 0}=e;const j=Fe(),{map:re,loadedImages:P}=Ft();H(n,re,u=>t(4,i=u)),H(n,P,u=>t(5,l=u));let D=new Set;async function X(u,a=!1){if(i&&!(!i.loaded()&&!a))if("url"in u){D.add(u.id);try{let M=await i.loadImage(u.url);i==null||i.addImage(u.id,M.data,u.options),l.add(u.id),P.set(l)}catch(M){j("error",M)}finally{D.delete(u.id)}}else i.addImage(u.id,u.data,u.options),l.add(u.id),P.set(l)}let K,R,$,me;function Se(u){return ee(),be(re,i=new ue.Map(He({container:u,style:b,locale:N,center:y,zoom:A,pitch:h,bearing:v,minZoom:O,maxZoom:L,antialias:_,interactive:d,preserveDrawingBuffer:x,maxBounds:p,bounds:I,attributionControl:ce,transformRequest:Q,cooperativeGestures:Y})),i),i.on("load",a=>{a.target.getContainer().setAttribute("data-testid","map"),a.target.getCanvas().setAttribute("data-testid","map-canvas"),t(0,B=!0),j("load",i)}),i.on("error",a=>j("error",{...a,map:i})),i.on("movestart",a=>j("movestart",{...a,map:i})),i.on("moveend",a=>{if(t(12,y=a.target.getCenter()),t(13,A=a.target.getZoom()),t(14,h=a.target.getPitch()),t(15,v=a.target.getBearing()),t(16,I=a.target.getBounds()),j("moveend",{...a,map:i}),T){let M=new URL(window.location.href.replace(/(#.+)?$/,lo(i)));F(M)}}),i.on("click",a=>j("click",{...a,map:i})),i.on("dblclick",a=>j("dblclick",{...a,map:i})),i.on("contextmenu",a=>j("contextmenu",{...a,map:i})),i.on("zoomstart",a=>j("zoomstart",{...a,map:i})),i.on("zoom",a=>{j("zoom",{...a,map:i})}),i.on("zoomend",a=>{j("zoomend",{...a,map:i})}),i.on("style.load",()=>{if(i){const a=i.getStyle();if(t(36,K=a.layers.map(M=>M.id)),t(37,R=Object.keys(a.sources)),me)for(const[M,Z]of Object.entries(me))i.addSource(M,Z);if($)for(const M of $)i.addLayer(M);for(const M of q)X(M,!0)}}),i.on("styledata",a=>{if(i&&J){const M=i.getStyle().layers;if(M)for(let Z of M)J(Z)||i.setLayoutProperty(Z.id,"visibility","none")}j("styledata",{...a,map:i})}),{destroy(){t(0,B=!1),i==null||i.remove(),be(re,i=null,i)}}}let le=b;function ee(){if(T){let u=fo(window.location.hash);u.length>=3&&(t(13,A=u[0]),t(12,y=[u[2],u[1]])),u.length==5&&(t(15,v=u[3]),t(14,h=u[4]))}}function Oe(u){Ie[u?"unshift":"push"](()=>{c=u,t(1,c)})}return n.$$set=u=>{"map"in u&&t(17,m=u.map),"mapContainer"in u&&t(1,c=u.mapContainer),"class"in u&&t(2,g=u.class),"style"in u&&t(18,b=u.style),"diffStyleUpdates"in u&&t(19,w=u.diffStyleUpdates),"center"in u&&t(12,y=u.center),"zoom"in u&&t(13,A=u.zoom),"pitch"in u&&t(14,h=u.pitch),"bearing"in u&&t(15,v=u.bearing),"bounds"in u&&t(16,I=u.bounds),"hash"in u&&t(20,T=u.hash),"updateHash"in u&&t(21,F=u.updateHash),"loaded"in u&&t(0,B=u.loaded),"minZoom"in u&&t(22,O=u.minZoom),"maxZoom"in u&&t(23,L=u.maxZoom),"antialias"in u&&t(24,_=u.antialias),"zoomOnDoubleClick"in u&&t(25,z=u.zoomOnDoubleClick),"locale"in u&&t(26,N=u.locale),"interactive"in u&&t(27,d=u.interactive),"attributionControl"in u&&t(28,ce=u.attributionControl),"cooperativeGestures"in u&&t(29,Y=u.cooperativeGestures),"preserveDrawingBuffer"in u&&t(30,x=u.preserveDrawingBuffer),"maxBounds"in u&&t(31,p=u.maxBounds),"images"in u&&t(32,q=u.images),"standardControls"in u&&t(3,C=u.standardControls),"filterLayers"in u&&t(33,J=u.filterLayers),"transformRequest"in u&&t(34,Q=u.transformRequest),"$$scope"in u&&t(39,s=u.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&8&&t(7,o=typeof C=="boolean"?void 0:C),n.$$.dirty[0]&16&&t(17,m=i),n.$$.dirty[0]&786448|n.$$.dirty[1]&224&&i&&!Te(b,le)){const u=i.getStyle();if(K&&($=u.layers.filter(a=>!K.includes(a.id))),R){const a=Object.keys(u.sources).filter(M=>!R.includes(M));me={};for(const M of a)me[M]=u.sources[M]}t(38,le=b),i.setStyle(b,{diff:w}),be(P,l=new Set,l),t(35,D=new Set)}if(n.$$.dirty[0]&49|n.$$.dirty[1]&18&&B&&i!=null&&i.loaded())for(let u of q)!l.has(u.id)&&!D.has(u.id)&&!i.hasImage(u.id)&&X(u);if(n.$$.dirty[0]&32|n.$$.dirty[1]&2&&t(6,r=q.every(u=>l.has(u.id))),n.$$.dirty[0]&61456&&i){let u={};y!=null&&!Te(y,i==null?void 0:i.getCenter())&&(u.center=y),A!=null&&!Te(A,i==null?void 0:i.getZoom())&&(u.zoom=A),v!=null&&!Te(v,i==null?void 0:i.getBearing())&&(u.bearing=v),h!=null&&!Te(h,i==null?void 0:i.getPitch())&&(u.pitch=h),Object.keys(u).length&&i.easeTo(u)}n.$$.dirty[0]&65552&&I&&!Te(I,i==null?void 0:i.getBounds())&&(i==null||i.fitBounds(I)),n.$$.dirty[0]&33554448&&(z?i==null||i.doubleClickZoom.enable():i==null||i.doubleClickZoom.disable())},[B,c,g,C,i,l,r,o,re,P,Se,ee,y,A,h,v,I,m,b,w,T,F,O,L,_,z,N,d,ce,Y,x,p,q,J,Q,D,K,R,le,s,f,Oe]}class bo extends V{constructor(e){super(),W(this,e,ho,yo,U,{map:17,mapContainer:1,class:2,style:18,diffStyleUpdates:19,center:12,zoom:13,pitch:14,bearing:15,bounds:16,hash:20,updateHash:21,loaded:0,minZoom:22,maxZoom:23,antialias:24,zoomOnDoubleClick:25,locale:26,interactive:27,attributionControl:28,cooperativeGestures:29,preserveDrawingBuffer:30,maxBounds:31,images:32,standardControls:3,filterLayers:33,transformRequest:34},null,[-1,-1])}}const _o=n=>({features:n[0]&16,data:n[0]&16,map:n[0]&4,close:n[0]&1}),rt=n=>{var e;return{features:n[4],data:(e=n[4])==null?void 0:e[0],map:n[2],close:n[31]}};function lt(n){let e,t,o=(n[4]||n[3]instanceof ue.Marker)&&ft(n);return{c(){e=Ae("div"),o&&o.c()},m(r,i){E(r,e,i),o&&o.m(e,null),n[32](e),t=!0},p(r,i){r[4]||r[3]instanceof ue.Marker?o?(o.p(r,i),i[0]&24&&k(o,1)):(o=ft(r),o.c(),k(o,1),o.m(e,null)):o&&(ge(),S(o,1,1,()=>{o=null}),ye())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(),n[32](null)}}}function ft(n){let e;const t=n[30].default,o=we(t,n,n[29],rt);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i[0]&536870933)&&ve(o,t,r,r[29],e?Le(t,r[29],i,_o):Me(r[29]),rt)},i(r){e||(k(o,r),e=!0)},o(r){S(o,r),e=!1},d(r){o&&o.d(r)}}}function ko(n){let e,t,o=n[9].default&&lt(n);return{c(){o&&o.c(),e=Ce()},m(r,i){o&&o.m(r,i),E(r,e,i),t=!0},p(r,i){r[9].default?o?(o.p(r,i),i[0]&512&&k(o,1)):(o=lt(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),ye())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function Ao(n,e,t){let o,r,i,l,f,s,{$$slots:m={},$$scope:c}=e;const g=St(m);let{closeButton:b=void 0}=e,{closeOnClickOutside:w=!0}=e,{closeOnClickInside:y=!1}=e,{closeOnMove:A=!1}=e,{openOn:h="click"}=e,{openIfTopMost:v=!0}=e,{focusAfterOpen:I=!0}=e,{anchor:T=void 0}=e,{offset:F=void 0}=e,{popupClass:B=void 0}=e,{maxWidth:O=void 0}=e,{lngLat:L=void 0}=e,{html:_=void 0}=e,{open:z=!1}=e;const N=Fe(),{map:d,popupTarget:ce,layerEvent:Y,layer:x,eventTopMost:p}=ze();H(n,d,a=>t(2,i=a)),H(n,ce,a=>t(3,f=a)),H(n,Y,a=>t(28,l=a)),H(n,x,a=>t(35,s=a));const q=["click","dblclick","contextmenu"];let C,J=!1,Q;function j(){if(!C)return;let a=C.getElement();!a||a===Q||(Q=a,h==="hover"&&(Q.style.pointerEvents="none"),Q.addEventListener("mouseenter",()=>{t(24,J=!0)},{passive:!0}),Q.addEventListener("mouseleave",()=>{t(24,J=!1)},{passive:!0}),Q.addEventListener("click",()=>{y&&t(0,z=!1)},{passive:!0}))}mt(()=>{if(i)return i.on("click",le),i.on("contextmenu",le),typeof f=="string"&&(i.on("click",f,X),i.on("dblclick",f,X),i.on("contextmenu",f,X),i.on("mousemove",f,Se),i.on("mouseleave",f,me),i.on("touchstart",f,R),i.on("touchend",f,$)),()=>{i!=null&&i.loaded()&&(C==null||C.remove(),i.off("click",le),i.off("contextmenu",le),f instanceof ue.Marker?f.getPopup()===C&&f.setPopup(void 0):typeof f=="string"&&(i.off("click",f,X),i.off("dblclick",f,X),i.off("contextmenu",f,X),i.off("mousemove",f,Se),i.off("mouseleave",f,me),i.off("touchstart",f,R),i.off("touchend",f,$)))}});function re(a){return v?!("marker"in a)&&!Rt(a)&&p(a)!==s:!1}let P=null,D="normal";function X(a){a.type===h&&(re(a)||("layerType"in a?a.layerType==="deckgl"?(t(10,L=a.coordinate),t(4,P=a.object?[a.object]:null)):(t(10,L=a.lngLat),t(4,P=a.features??[])):(t(10,L=a.lngLat),t(4,P=a.features??[])),setTimeout(()=>t(0,z=!0))))}let K=null;function R(a){K=a.point}function $(a){if(!K||h!=="hover")return;let M=K.dist(a.point);K=null,M<3&&(t(10,L=a.lngLat),t(4,P=a.features??[]),C.isOpen()?t(25,D="justOpened"):(t(25,D="opening"),t(0,z=!0)))}function me(a){h!=="hover"||K||D!=="normal"||(t(0,z=!1),t(4,P=null))}function Se(a){if(!(h!=="hover"||K||D!=="normal")){if(re(a)){t(0,z=!1),t(4,P=null);return}t(0,z=!0),t(4,P=a.features??[]),t(10,L=a.lngLat)}}function le(a){if(D==="justOpened"){t(25,D="normal");return}if(!w)return;let M=[Q,f instanceof ue.Marker?f==null?void 0:f.getElement():null];z&&C.isOpen()&&!M.some(Z=>Z==null?void 0:Z.contains(a.originalEvent.target))&&(a.type==="contextmenu"&&h==="contextmenu"||a.type!=="contextmenu")&&t(0,z=!1)}_e(()=>{i&&(C!=null&&C.isOpen())&&C.remove()});let ee;const Oe=()=>t(0,z=!1);function u(a){Ie[a?"unshift":"push"](()=>{ee=a,t(1,ee)})}return n.$$set=a=>{"closeButton"in a&&t(11,b=a.closeButton),"closeOnClickOutside"in a&&t(12,w=a.closeOnClickOutside),"closeOnClickInside"in a&&t(13,y=a.closeOnClickInside),"closeOnMove"in a&&t(14,A=a.closeOnMove),"openOn"in a&&t(15,h=a.openOn),"openIfTopMost"in a&&t(16,v=a.openIfTopMost),"focusAfterOpen"in a&&t(17,I=a.focusAfterOpen),"anchor"in a&&t(18,T=a.anchor),"offset"in a&&t(19,F=a.offset),"popupClass"in a&&t(20,B=a.popupClass),"maxWidth"in a&&t(21,O=a.maxWidth),"lngLat"in a&&t(10,L=a.lngLat),"html"in a&&t(22,_=a.html),"open"in a&&t(0,z=a.open),"$$scope"in a&&t(29,c=a.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&14336&&t(27,o=b??(!w&&!y)),n.$$.dirty[0]&146685952&&(C||(t(23,C=new ue.Popup({closeButton:o,closeOnClick:!1,closeOnMove:A,focusAfterOpen:I,maxWidth:O,className:B,anchor:T,offset:F})),Q=C.getElement(),C.on("open",()=>{t(0,z=!0),j(),N("open",C)}),C.on("close",()=>{t(0,z=!1),N("close",C)}),C.on("hover",()=>{N("hover",C)}))),n.$$.dirty[0]&8421384&&C&&f instanceof ue.Marker&&(h==="click"?f.setPopup(C):f.getPopup()===C&&f.setPopup(void 0)),n.$$.dirty[0]&268468224&&q.includes(h)&&(l==null?void 0:l.type)===h&&(X(l),be(Y,l=null,l)),n.$$.dirty[0]&268468224&&t(26,r=h==="hover"&&((l==null?void 0:l.type)==="mousemove"||(l==null?void 0:l.type)==="mouseenter")),n.$$.dirty[0]&352354304&&h==="hover"&&Y&&(r&&l&&(l.layerType==="deckgl"?(t(10,L=l.coordinate),t(4,P=l.object?[l.object]:null)):(t(10,L=l.lngLat),t(4,P=l.features??[]))),t(0,z=(r||J)??!1)),n.$$.dirty[0]&12582914&&(ee?C.setDOMContent(ee):_&&C.setHTML(_)),n.$$.dirty[0]&8389632&&L&&C.setLngLat(L),n.$$.dirty[0]&41943045&&i){let a=C.isOpen();z&&!a?(C.addTo(i),D==="opening"&&t(25,D="justOpened")):!z&&a&&C.remove()}},[z,ee,i,f,P,d,ce,Y,x,g,L,b,w,y,A,h,v,I,T,F,B,O,_,C,J,D,r,o,l,c,m,Oe,u]}class Wo extends V{constructor(e){super(),W(this,e,Ao,ko,U,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}function Co(n){let e,t,o,r;const i=[wo,So],l=[];function f(s,m){return s[0]?0:1}return e=f(n),t=l[e]=i[e](n),{c(){t.c(),o=Ce()},m(s,m){l[e].m(s,m),E(s,o,m),r=!0},p(s,m){t.p(s,m)},i(s){r||(k(t),r=!0)},o(s){S(t),r=!1},d(s){s&&G(o),l[e].d(s)}}}function So(n){let e,t;return e=new Ot({props:{errorMessage:"You shouldn't be able to view this app without being logged in!"}}),{c(){oe(e.$$.fragment)},m(o,r){ne(e,o,r),t=!0},p:ae,i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){S(e.$$.fragment,o),t=!1},d(o){ie(e,o)}}}function wo(n){let e;return{c(){e=Ae("p"),e.textContent=`Logged in as ${n[0]}`},m(t,o){E(t,e,o)},p:ae,i:ae,o:ae,d(t){t&&G(e)}}}function vo(n){let e=dt()=="Private (development)",t,o,r=e&&Co(n);return{c(){r&&r.c(),t=Ce()},m(i,l){r&&r.m(i,l),E(i,t,l),o=!0},p(i,[l]){e&&r.p(i,l)},i(i){o||(k(r),o=!0)},o(i){S(r),o=!1},d(i){i&&G(t),r&&r.d(i)}}}function Mo(n){return[wt.get("email")]}class Yo extends V{constructor(e){super(),W(this,e,Mo,vo,U,{})}}const Lo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAQAAAC1QeVaAAAAAmJLR0QA/4ePzL8AAACgSURBVBjTY2D4D4cvGHoY2BlQwH8U2I4pCQKsDHFg3VglGRjEgazvmJLlQNjIcAnIOobbztcM5piSHUBYzxDNwMfAgMtOGKjHJpnJ8IwhhcGFYREDM6ZkCMMqoPHXGC4zBKEa5cPwBKioAAiXMIQz/GZ4yuCFkHzC4MjgxPCNoZaBjeE+kOXEcB0h+RjIdWG4AGU7w9lg4A0UesBgj8oGAP6nSFElh0b7AAAAAElFTkSuQmCC",zo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAm0lEQVRIS+2U0Q2AIAxEYQM30Q3UDXQy3UhHkE0cweuHHxKTXpuQaALJ/cE9eoXGUHjFwv6hAtSEPxFRh2su0Ayd6pWzDUwFO8700AGNVggDaGAqkNYDYQBStBvCAtwQC8AF8QA2kORlJWjQmm4BSB9M5lIyC3CZswC3OQu4PxqVef7TmYikoSs0aQ19GyMMwDp+HvsrQI3v/xFduXoiGbi1DtQAAAAASUVORK5CYII=",Oo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC",To="/atip/font-change-scour-old-name/assets/google_on_non_white_hdpi-368415f0.png";function Io(n){let e,t,o,r;return{c(){e=Ae("div"),t=new Mt(!1),o=vt(` |
  `),r=Ae("a"),r.textContent="MapLibre",t.a=o,se(r,"href","https://maplibre.org/"),se(r,"target","_blank"),se(e,"class","svelte-1yeu1m4")},m(i,l){E(i,e,l),t.m(n[0],e),We(e,o),We(e,r)},p(i,[l]){l&1&&t.p(i[0])},i:ae,o:ae,d(i){i&&G(e)}}}function Bo(n,e,t){let{attribution:o}=e;return n.$$set=r=>{"attribution"in r&&t(0,o=r.attribution)},[o]}class Eo extends V{constructor(e){super(),W(this,e,Bo,Io,U,{attribution:0})}}function ut(n){let e,t,o,r;function i(s){n[9](s)}function l(s){n[10](s)}let f={style:n[4],bounds:n[0],hash:!0,images:[{id:"chevron",url:zo},{id:"cycle_parking",url:Lo},{id:"railway_station",url:Oo}],attributionControl:!1,$$slots:{default:[Go]},$$scope:{ctx:n}};return n[3]!==void 0&&(f.loaded=n[3]),n[2]!==void 0&&(f.map=n[2]),e=new bo({props:f}),Ie.push(()=>Be(e,"loaded",i)),Ie.push(()=>Be(e,"map",l)),e.$on("error",Fo),{c(){oe(e.$$.fragment)},m(s,m){ne(e,s,m),r=!0},p(s,m){const c={};m&16&&(c.style=s[4]),m&1&&(c.bounds=s[0]),m&2146&&(c.$$scope={dirty:m,ctx:s}),!t&&m&8&&(t=!0,c.loaded=s[3],Ee(()=>t=!1)),!o&&m&4&&(o=!0,c.map=s[2],Ee(()=>o=!1)),e.$set(c)},i(s){r||(k(e.$$.fragment,s),r=!0)},o(s){S(e.$$.fragment,s),r=!1},d(s){ie(e,s)}}}function st(n){let e,t,o,r,i,l,f,s,m,c;e=new ro({}),e.$on("zoomend",n[7]),e.$on("moveend",n[7]),o=new Eo({props:{attribution:n[6]}}),i=new ht({}),f=new yt({props:{position:"bottom-left",visualizePitch:!0}});let g=n[1]=="google"&&at();const b=n[8].default,w=we(b,n,n[11],null);return{c(){oe(e.$$.fragment),t=he(),oe(o.$$.fragment),r=he(),oe(i.$$.fragment),l=he(),oe(f.$$.fragment),s=he(),g&&g.c(),m=he(),w&&w.c()},m(y,A){ne(e,y,A),E(y,t,A),ne(o,y,A),E(y,r,A),ne(i,y,A),E(y,l,A),ne(f,y,A),E(y,s,A),g&&g.m(y,A),E(y,m,A),w&&w.m(y,A),c=!0},p(y,A){const h={};A&64&&(h.attribution=y[6]),o.$set(h),y[1]=="google"?g||(g=at(),g.c(),g.m(m.parentNode,m)):g&&(g.d(1),g=null),w&&w.p&&(!c||A&2048)&&ve(w,b,y,y[11],c?Le(b,y[11],A,null):Me(y[11]),null)},i(y){c||(k(e.$$.fragment,y),k(o.$$.fragment,y),k(i.$$.fragment,y),k(f.$$.fragment,y),k(w,y),c=!0)},o(y){S(e.$$.fragment,y),S(o.$$.fragment,y),S(i.$$.fragment,y),S(f.$$.fragment,y),S(w,y),c=!1},d(y){y&&(G(t),G(r),G(l),G(s),G(m)),ie(e,y),ie(o,y),ie(i,y),ie(f,y),g&&g.d(y),w&&w.d(y)}}}function at(n){let e,t;return{c(){e=Ae("img"),Lt(e.src,t=To)||se(e,"src",t),se(e,"alt","Google logo"),se(e,"class","svelte-81xaz8")},m(o,r){E(o,e,r)},d(o){o&&G(e)}}}function Go(n){let e,t,o=n[5]&&st(n);return{c(){o&&o.c(),e=Ce()},m(r,i){o&&o.m(r,i),E(r,e,i),t=!0},p(r,i){r[5]?o?(o.p(r,i),i&32&&k(o,1)):(o=st(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),ye())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d(r)}}}function Ho(n){let e,t,o=n[4]&&ut(n);return{c(){e=Ae("div"),o&&o.c(),se(e,"class","map svelte-81xaz8")},m(r,i){E(r,e,i),o&&o.m(e,null),t=!0},p(r,[i]){r[4]?o?(o.p(r,i),i&16&&k(o,1)):(o=ut(r),o.c(),k(o,1),o.m(e,null)):o&&(ge(),S(o,1,1,()=>{o=null}),ye())},i(r){t||(k(o),t=!0)},o(r){S(o),t=!1},d(r){r&&G(e),o&&o.d()}}}function Fo(n){console.error(`MapLibre error: ${n.detail.error}`)}function Po(n,e,t){let o,r;H(n,Ye,h=>t(5,o=h)),H(n,Ge,h=>t(6,r=h));let{$$slots:i={},$$scope:l}=e,{style:f}=e,{startBounds:s=void 0}=e,m=null,c,g=!1;Ze("setCamera",!window.location.hash),window.location.hash&&(s=void 0),mt(async()=>{t(4,m=await qe(f))});async function b(h){t(4,m=await qe(f));let v=new URL(window.location.href);v.searchParams.set("style",h),window.history.replaceState(null,"",v.toString())}async function w(){f=="google"&&o&&be(Ge,r=await Bt(o),r)}function y(h){g=h,t(3,g)}function A(h){c=h,t(2,c)}return n.$$set=h=>{"style"in h&&t(1,f=h.style),"startBounds"in h&&t(0,s=h.startBounds),"$$scope"in h&&t(11,l=h.$$scope)},n.$$.update=()=>{n.$$.dirty&12&&g&&Ye.set(c),n.$$.dirty&2&&b(f)},[s,f,c,g,m,o,r,w,i,y,A,l]}class qo extends V{constructor(e){super(),W(this,e,Po,Ho,U,{style:1,startBounds:0})}}export{Zo as A,Qo as F,Ko as G,Yo as L,qo as M,Wo as P,Vo as a,Jt as b,He as c,ro as d,gt as e,zo as f,Pe as g,No as h,Lo as i,Oo as j,jo as k,Uo as l,Tt as m,Xt as r,Pt as u};
