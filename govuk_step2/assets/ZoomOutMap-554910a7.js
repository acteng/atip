import{S as F,i as q,s as B,e as b,n as $,z as V,aq as le,p as f,d as y,q as v,ar as U,l as E,w as L,j as h,A as ce,ap as ue,U as pe,c as T,o as I,aC as A,u as R,g as W,f as N,t as C,h as O,N as Z,P as de,T as H,R as K,Q as fe,X as _e,W as me,V as Q,ax as X,Y as ge,r as be,ah as oe,ai as ae,au as Y,J as P,Z as ie,D as ve,E as ye,H as he,ag as D,aD as we,I as ke,B as Se,ao as Ce,K as $e}from"./maplibre_helpers-8216c700.js";function Le(o){let e,s,t,n,l,a,r;return{c(){e=b("div"),s=$(`Basemap:
  `),t=b("select"),n=b("option"),n.textContent="Streets",l=b("option"),l.textContent="Satellite",n.__value="streets",V(n,n.__value),l.__value="hybrid",V(l,l.__value),o[0]===void 0&&le(()=>o[2].call(t)),f(e,"class","svelte-1tbnm6i")},m(c,i){y(c,e,i),v(e,s),v(e,t),v(t,n),v(t,l),U(t,o[0],!0),a||(r=[E(t,"change",o[2]),E(t,"change",o[1])],a=!0)},p(c,[i]){i&1&&U(t,c[0])},i:L,o:L,d(c){c&&h(e),a=!1,ce(r)}}}function Ie(o,e,s){let{style:t}=e;function n(){let a=new URLSearchParams(window.location.search);a.set("style",t);let r=`${window.location.pathname}?${a.toString()}${window.location.hash}`;window.location.href=r}function l(){t=ue(this),s(0,t)}return o.$$set=a=>{"style"in a&&s(0,t=a.style)},[t,n,l]}class nt extends F{constructor(e){super(),q(this,e,Ie,Le,B,{style:0})}}const j=[];function M(o,e=L){let s;const t=new Set;function n(r){if(B(o,r)&&(o=r,s)){const c=!j.length;for(const i of t)i[1](),j.push(i,o);if(c){for(let i=0;i<j.length;i+=2)j[i][0](j[i+1]);j.length=0}}}function l(r){n(r(o))}function a(r,c=L){const i=[r,c];return t.add(i),t.size===1&&(s=e(n,l)||L),r(o),()=>{t.delete(i),t.size===0&&s&&(s(),s=null)}}return{set:n,update:l,subscribe:a}}function Me(o){return o=="google"||o=="bing"}function lt(o){return{v1:"Scheme Design",v2:"Experimental Scheme Design",planning:"Development Planning",criticals:"Critical Issues",atf4:"ATF4 Scheme"}[o]}const G=M(null),ot=M(null),re=M(pe()),Oe=M(null),Be=M(null),De=M(null),Fe=M(null),qe=M(ze());qe.subscribe(o=>window.localStorage.setItem("userSettings",JSON.stringify(o)));const at=M("edit-attribute"),it=M(!1);function rt(o){let e=new Set;for(let t of o.features)e.add(t.id);let s=e.size+1;for(;e.has(s);)s++;return s}function ct(o){console.log(`Deleting intervention ${o}`),re.update(e=>(e.features=e.features.filter(s=>s.id!=o),e)),Oe.set(null),Be.set(null),De.set(null),Fe.set(null)}function ze(){let o={streetViewImagery:"google",avoidDoublingBack:!1};try{let e=JSON.parse(window.localStorage.getItem("userSettings")||"{}");Me(e.streetViewImagery)&&(o.streetViewImagery=e.streetViewImagery),typeof e.avoidDoublingBack=="boolean"&&(o.avoidDoublingBack=e.avoidDoublingBack)}catch(e){console.log(`Couldn't parse userSettings from local storage: ${e}`)}return o}const je=o=>({}),x=o=>({}),Ee=o=>({}),ee=o=>({});function Pe(o){let e,s,t,n,l,a,r,c,i,u,g;const _=o[3].sidebar,d=T(_,o,o[2],ee),S=o[3].main,w=T(S,o,o[2],x);return{c(){e=b("div"),s=b("aside"),t=b("div"),d&&d.c(),n=I(),l=b("button"),l.textContent="â†’",r=I(),c=b("main"),w&&w.c(),f(t,"class","sidebar-content content-container svelte-ect12w"),f(l,"type","button"),f(l,"class","sidebar-toggle rounded-rect svelte-ect12w"),f(s,"class",a=A(o[0]?"":"collapsed")+" svelte-ect12w"),f(c,"class","svelte-ect12w"),f(e,"class","overall-layout svelte-ect12w")},m(p,m){y(p,e,m),v(e,s),v(s,t),d&&d.m(t,null),v(s,n),v(s,l),v(e,r),v(e,c),w&&w.m(c,null),i=!0,u||(g=E(l,"click",o[1]),u=!0)},p(p,[m]){d&&d.p&&(!i||m&4)&&R(d,_,p,p[2],i?N(_,p[2],m,Ee):W(p[2]),ee),(!i||m&1&&a!==(a=A(p[0]?"":"collapsed")+" svelte-ect12w"))&&f(s,"class",a),w&&w.p&&(!i||m&4)&&R(w,S,p,p[2],i?N(S,p[2],m,je):W(p[2]),x)},i(p){i||(C(d,p),C(w,p),i=!0)},o(p){O(d,p),O(w,p),i=!1},d(p){p&&h(e),d&&d.d(p),w&&w.d(p),u=!1,g()}}}function Te(o,e,s){let{$$slots:t={},$$scope:n}=e,l=!0;function a(){s(0,l=!l)}return o.$$set=r=>{"$$scope"in r&&s(2,n=r.$$scope)},[l,a,n,t]}class ut extends F{constructor(e){super(),q(this,e,Te,Pe,B,{})}}const k={area:"#D94324",route:"#555F5E",crossing:"#4daf4a",other:"#984ea3",preapp:"#e41a1c",outline:"#377eb8","reserved matters":"#4daf4a","local plan":"#984ea3",hovering:"black",lineEndpointColor:"black"},Re=10,J=10;let z="interventions";function We(o,e,s){let t,n;Z(o,G,u=>s(1,t=u)),Z(o,re,u=>s(2,n=u));let{schema:l}=e;de(t,z,n);const a=["match",["get","intervention_type"],"area",k.area,"route",k.route,"crossing",k.crossing,"other",k.other,"white"],r=["match",["get","reference_type",["get","planning"]],"preapp",k.preapp,"outline",k.outline,"reserved matters",k["reserved matters"],"local plan",k["local plan"],"white"],c=["!=","hide_while_editing",!0];return H(t,{id:"interventions-points",source:z,filter:["all",_e,c,["!=","endpoint",!0]],color:a,radius:Re}),K(t,{id:"interventions-lines",source:z,filter:["all",me,c],color:a,width:J}),H(t,{id:"interventions-lines-endpoints",source:z,filter:["==","endpoint",!0],radius:.5*J,opacity:0,strokeColor:k.lineEndpointColor,strokeWidth:2}),fe(t,{id:"interventions-polygons",source:z,filter:["all",Q,c],color:l=="planning"?r:a,opacity:.2}),K(t,{id:"interventions-polygon-outlines",source:z,filter:["all",Q,c],color:l=="planning"?r:a,opacity:.5,width:.7*J}),o.$$set=u=>{"schema"in u&&s(0,l=u.schema)},o.$$.update=()=>{if(o.$$.dirty&6){let u=JSON.parse(JSON.stringify(n)),g=[];for(let _ of u.features)if(_.geometry.type=="LineString"&&!_.properties.hide_while_editing)for(let d of[_.geometry.coordinates[0],_.geometry.coordinates[_.geometry.coordinates.length-1]])g.push({type:"Feature",properties:{endpoint:!0},geometry:{type:"Point",coordinates:d}});u.features=u.features.concat(g),t.getSource(z).setData(u)}},[l,t,n]}class pt extends F{constructor(e){super(),q(this,e,We,null,B,{schema:0})}}function Ne(o){const e=o-1;return e*e*e+1}function te(o,{delay:e=0,duration:s=400,easing:t=Ne,axis:n="y"}={}){const l=getComputedStyle(o),a=+l.opacity,r=n==="y"?"height":"width",c=parseFloat(l[r]),i=n==="y"?["top","bottom"]:["left","right"],u=i.map(m=>`${m[0].toUpperCase()}${m.slice(1)}`),g=parseFloat(l[`padding${u[0]}`]),_=parseFloat(l[`padding${u[1]}`]),d=parseFloat(l[`margin${u[0]}`]),S=parseFloat(l[`margin${u[1]}`]),w=parseFloat(l[`border${u[0]}Width`]),p=parseFloat(l[`border${u[1]}Width`]);return{delay:e,duration:s,easing:t,css:m=>`overflow: hidden;opacity: ${Math.min(m*20,1)*a};${r}: ${m*c}px;padding-${i[0]}: ${m*g}px;padding-${i[1]}: ${m*_}px;margin-${i[0]}: ${m*d}px;margin-${i[1]}: ${m*S}px;border-${i[0]}-width: ${m*w}px;border-${i[1]}-width: ${m*p}px;`}}function se(o){let e,s,t;const n=o[3].default,l=T(n,o,o[2],null);return{c(){e=b("div"),l&&l.c()},m(a,r){y(a,e,r),l&&l.m(e,null),t=!0},p(a,r){l&&l.p&&(!t||r&4)&&R(l,n,a,a[2],t?N(n,a[2],r,null):W(a[2]),null)},i(a){t||(C(l,a),a&&le(()=>{t&&(s||(s=Y(e,te,{duration:100},!0)),s.run(1))}),t=!0)},o(a){O(l,a),a&&(s||(s=Y(e,te,{duration:100},!1)),s.run(0)),t=!1},d(a){a&&h(e),l&&l.d(a),a&&s&&s.end()}}}function Ze(o){let e,s,t,n,l,a,r,c,i,u,g=o[0]&&se(o);return{c(){e=b("button"),s=X("svg"),t=X("path"),n=I(),l=$(o[1]),a=I(),g&&g.c(),r=ge(),f(t,"d","M9 5l7 7-7 7"),f(s,"style","tran"),f(s,"width","20"),f(s,"height","20"),f(s,"fill","none"),f(s,"stroke-linecap","round"),f(s,"stroke-linejoin","round"),f(s,"stroke-width","2"),f(s,"viewBox","0 0 24 24"),f(s,"stroke","currentColor"),f(s,"class","svelte-una9lq"),f(e,"aria-expanded",o[0]),f(e,"class","svelte-una9lq")},m(_,d){y(_,e,d),v(e,s),v(s,t),v(e,n),v(e,l),y(_,a,d),g&&g.m(_,d),y(_,r,d),c=!0,i||(u=E(e,"click",o[4]),i=!0)},p(_,[d]){(!c||d&2)&&be(l,_[1]),(!c||d&1)&&f(e,"aria-expanded",_[0]),_[0]?g?(g.p(_,d),d&1&&C(g,1)):(g=se(_),g.c(),C(g,1),g.m(r.parentNode,r)):g&&(oe(),O(g,1,1,()=>{g=null}),ae())},i(_){c||(C(g),c=!0)},o(_){O(g),c=!1},d(_){_&&(h(e),h(a),h(r)),g&&g.d(_),i=!1,u()}}}function Ge(o,e,s){let{$$slots:t={},$$scope:n}=e,{label:l}=e,{open:a=!1}=e;const r=()=>s(0,a=!a);return o.$$set=c=>{"label"in c&&s(1,l=c.label),"open"in c&&s(0,a=c.open),"$$scope"in c&&s(2,n=c.$$scope)},[a,l,n,t,r]}class Je extends F{constructor(e){super(),q(this,e,Ge,Ze,B,{label:1,open:0})}}function Ve(o,e,s){let t;Z(o,G,i=>s(2,t=i));let{layers:n}=e,{contents:l}=e,a=new P.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});t.on("mousemove",r),t.on("mouseout",c),ie(()=>{t.off("mousemove",r),t.off("mouseout",c),a.remove()});function r(i){if(!n.every(g=>t.getLayer(g))){a.remove();return}let u=t.queryRenderedFeatures(i.point,{layers:n});u.length>0?a.setLngLat(i.lngLat).setHTML(l(u[0].properties)).addTo(t):a.remove()}function c(){a.remove()}return o.$$set=i=>{"layers"in i&&s(0,n=i.layers),"contents"in i&&s(1,l=i.contents)},[n,l]}class dt extends F{constructor(e){super(),q(this,e,Ve,null,B,{layers:0,contents:1})}}function Ue(o){let e,s,t,n,l,a,r,c,i,u,g,_,d,S,w;return{c(){e=b("li"),s=b("span"),t=$("Areas"),n=I(),l=b("li"),a=b("span"),r=$("Routes"),c=I(),i=b("li"),u=b("span"),g=$("Crossings"),_=I(),d=b("li"),S=b("span"),w=$("Other"),f(s,"class","svelte-l42ea0"),D(s,"background",k.area),f(a,"class","svelte-l42ea0"),D(a,"background",k.route),f(u,"class","svelte-l42ea0"),D(u,"background",k.crossing),f(S,"class","svelte-l42ea0"),D(S,"background",k.other)},m(p,m){y(p,e,m),v(e,s),v(e,t),y(p,n,m),y(p,l,m),v(l,a),v(l,r),y(p,c,m),y(p,i,m),v(i,u),v(i,g),y(p,_,m),y(p,d,m),v(d,S),v(d,w)},p:L,d(p){p&&(h(e),h(n),h(l),h(c),h(i),h(_),h(d))}}}function Ae(o){let e,s,t,n,l,a,r,c,i,u,g,_,d,S,w;return{c(){e=b("li"),s=b("span"),t=$("Preapp"),n=I(),l=b("li"),a=b("span"),r=$("Outline"),c=I(),i=b("li"),u=b("span"),g=$("Reserved matters"),_=I(),d=b("li"),S=b("span"),w=$("Local plan"),f(s,"class","svelte-l42ea0"),D(s,"background",k.preapp),f(a,"class","svelte-l42ea0"),D(a,"background",k.outline),f(u,"class","svelte-l42ea0"),D(u,"background",k["reserved matters"]),f(S,"class","svelte-l42ea0"),D(S,"background",k["local plan"])},m(p,m){y(p,e,m),v(e,s),v(e,t),y(p,n,m),y(p,l,m),v(l,a),v(l,r),y(p,c,m),y(p,i,m),v(i,u),v(i,g),y(p,_,m),y(p,d,m),v(d,S),v(d,w)},p:L,d(p){p&&(h(e),h(n),h(l),h(c),h(i),h(_),h(d))}}}function He(o){let e;function s(l,a){return l[0]=="planning"?Ae:Ue}let t=s(o),n=t(o);return{c(){e=b("ul"),n.c()},m(l,a){y(l,e,a),n.m(e,null)},p(l,a){t===(t=s(l))&&n?n.p(l,a):(n.d(1),n=t(l),n&&(n.c(),n.m(e,null)))},d(l){l&&h(e),n.d()}}}function Ke(o){let e,s,t;return s=new Je({props:{label:"Objects",open:!0,$$slots:{default:[He]},$$scope:{ctx:o}}}),{c(){e=b("div"),ve(s.$$.fragment),f(e,"class","svelte-l42ea0")},m(n,l){y(n,e,l),ye(s,e,null),t=!0},p(n,[l]){const a={};l&3&&(a.$$scope={dirty:l,ctx:n}),s.$set(a)},i(n){t||(C(s.$$.fragment,n),t=!0)},o(n){O(s.$$.fragment,n),t=!1},d(n){n&&h(e),he(s)}}}function Qe(o,e,s){let{schema:t}=e;return o.$$set=n=>{"schema"in n&&s(0,t=n.schema)},[t]}class ft extends F{constructor(e){super(),q(this,e,Qe,Ke,B,{schema:0})}}function ne(o){let e;const s=o[4].default,t=T(s,o,o[3],null);return{c(){t&&t.c()},m(n,l){t&&t.m(n,l),e=!0},p(n,l){t&&t.p&&(!e||l&8)&&R(t,s,n,n[3],e?N(s,n[3],l,null):W(n[3]),null)},i(n){e||(C(t,n),e=!0)},o(n){O(t,n),e=!1},d(n){t&&t.d(n)}}}function Xe(o){let e,s,t=o[1]&&ne(o);return{c(){e=b("div"),t&&t.c(),f(e,"class","map svelte-12dpf1u")},m(n,l){y(n,e,l),t&&t.m(e,null),o[5](e),s=!0},p(n,[l]){n[1]?t?(t.p(n,l),l&2&&C(t,1)):(t=ne(n),t.c(),C(t,1),t.m(e,null)):t&&(oe(),O(t,1,1,()=>{t=null}),ae())},i(n){s||(C(t),s=!0)},o(n){O(t),s=!1},d(n){n&&h(e),t&&t.d(),o[5](null)}}}function Ye(o,e,s){let{$$slots:t={},$$scope:n}=e,{style:l}=e,a,r,c=!1;we("setCamera",!window.location.hash),ke(()=>{a=new P.Map({container:r,style:`https://api.maptiler.com/maps/${l}/style.json?key=MZEJTanw3WpxRvt7qDfo`,hash:!0}),a.addControl(new P.ScaleControl({})),a.addControl(new P.NavigationControl({visualizePitch:!0}),"bottom-right"),a.on("load",()=>{s(1,c=!0),G.set(a)}),new ResizeObserver(()=>{a.resize()}).observe(r)}),ie(()=>{a.remove()});function i(u){Se[u?"unshift":"push"](()=>{r=u,s(0,r)})}return o.$$set=u=>{"style"in u&&s(2,l=u.style),"$$scope"in u&&s(3,n=u.$$scope)},[r,c,l,n,t,i]}class _t extends F{constructor(e){super(),q(this,e,Ye,Xe,B,{style:2})}}const xe="/atip/govuk_step2/assets/zoom_out_map-b2e1091a.svg";function et(o){let e,s,t,n,l;return{c(){e=b("button"),s=b("img"),Ce(s.src,t=xe)||f(s,"src",t),f(s,"alt","Zoom to show entire boundary"),f(e,"type","button"),f(e,"title","Zoom to show entire boundary"),f(e,"class","svelte-qzjsqo")},m(a,r){y(a,e,r),v(e,s),n||(l=E(e,"click",o[0]),n=!0)},p:L,i:L,o:L,d(a){a&&h(e),n=!1,l()}}}function tt(o,e,s){let t;Z(o,G,a=>s(2,t=a));let{boundaryGeojson:n}=e;function l(){t.fitBounds($e(n),{padding:20,animate:!0,duration:500})}return o.$$set=a=>{"boundaryGeojson"in a&&s(1,n=a.boundaryGeojson)},[l,n]}class mt extends F{constructor(e){super(),q(this,e,tt,et,B,{boundaryGeojson:1})}}export{nt as B,Je as C,pt as I,ut as L,dt as M,mt as Z,Be as a,Re as b,k as c,at as d,te as e,Oe as f,re as g,ct as h,it as i,lt as j,_t as k,J as l,G as m,rt as n,Fe as o,ft as p,ot as r,De as s,qe as u};
