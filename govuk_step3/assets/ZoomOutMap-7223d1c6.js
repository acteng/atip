import{S as D,i as E,s as I,F as fe,g as H,m as V,t as C,n as O,p as W,ai as K,e as d,N as de,h as _,av as me,j as g,k as m,aE as Q,v as ae,o as b,aj as _e,aF as pe,u as U,r as L,w as ie,b as re,c as ge,l as be,O as F,J as he,al as q,f as B,aG as X,ao as G,ap as R,aq as J,C as N,E as ve,I as Y,H as $,G as ye,M as we,L as ke,K as x,y as T,P as ce,a7 as j,a9 as Se,aa as Ce,aH as Le,q as Oe,a as Ie,ag as Me,z as Be}from"./maplibre_helpers-fc33cf9d.js";function ee(l,e,s){const t=l.slice();return t[7]=e[s][0],t[8]=e[s][1],t}function te(l){let e;return{c(){e=d("option"),e.__value="",U(e,e.__value)},m(s,t){g(s,e,t)},d(s){s&&b(e)}}}function se(l){let e,s=l[8]+"",t,n;return{c(){e=d("option"),t=L(s),e.__value=n=l[7],U(e,e.__value)},m(o,a){g(o,e,a),m(e,t)},p(o,a){a&8&&s!==(s=o[8]+"")&&ie(t,s),a&8&&n!==(n=o[7])&&(e.__value=n,U(e,e.__value))},d(o){o&&b(e)}}}function De(l){let e,s,t,n,o=l[4]&&te(),a=K(l[3]),r=[];for(let u=0;u<a.length;u+=1)r[u]=se(ee(l,a,u));return{c(){e=d("select"),o&&o.c(),s=de();for(let u=0;u<r.length;u+=1)r[u].c();_(e,"class","govuk-select"),_(e,"id",l[2]),e.disabled=l[5],l[0]===void 0&&me(()=>l[6].call(e))},m(u,c){g(u,e,c),o&&o.m(e,null),m(e,s);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null);Q(e,l[0],!0),t||(n=ae(e,"change",l[6]),t=!0)},p(u,c){if(u[4]?o||(o=te(),o.c(),o.m(e,s)):o&&(o.d(1),o=null),c&8){a=K(u[3]);let i;for(i=0;i<a.length;i+=1){const h=ee(u,a,i);r[i]?r[i].p(h,c):(r[i]=se(h),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=a.length}c&4&&_(e,"id",u[2]),c&32&&(e.disabled=u[5]),c&9&&Q(e,u[0])},d(u){u&&b(e),o&&o.d(),_e(r,u),t=!1,n()}}}function Ee(l){let e,s;return e=new fe({props:{label:l[1],id:l[2],$$slots:{default:[De]},$$scope:{ctx:l}}}),{c(){H(e.$$.fragment)},m(t,n){V(e,t,n),s=!0},p(t,[n]){const o={};n&2&&(o.label=t[1]),n&4&&(o.id=t[2]),n&2109&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){s||(C(e.$$.fragment,t),s=!0)},o(t){O(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}function je(l,e,s){let{label:t}=e,{id:n}=e,{choices:o}=e,{emptyOption:a=!1}=e,{disabled:r=!1}=e,{value:u}=e;function c(){u=pe(this),s(0,u),s(3,o)}return l.$$set=i=>{"label"in i&&s(1,t=i.label),"id"in i&&s(2,n=i.id),"choices"in i&&s(3,o=i.choices),"emptyOption"in i&&s(4,a=i.emptyOption),"disabled"in i&&s(5,r=i.disabled),"value"in i&&s(0,u=i.value)},[u,t,n,o,a,r,c]}class ze extends D{constructor(e){super(),E(this,e,je,Ee,I,{label:1,id:2,choices:3,emptyOption:4,disabled:5,value:0})}}function Pe(l){let e,s,t,n;function o(r){l[2](r)}let a={label:"Basemap",id:"basemap",choices:[["streets","Streets"],["hybrid","Satellite"]]};return l[0]!==void 0&&(a.value=l[0]),s=new ze({props:a}),re.push(()=>ge(s,"value",o)),s.$on("change",l[1]),{c(){e=d("div"),H(s.$$.fragment),_(e,"class","svelte-1tbnm6i")},m(r,u){g(r,e,u),V(s,e,null),n=!0},p(r,[u]){const c={};!t&&u&1&&(t=!0,c.value=r[0],be(()=>t=!1)),s.$set(c)},i(r){n||(C(s.$$.fragment,r),n=!0)},o(r){O(s.$$.fragment,r),n=!1},d(r){r&&b(e),W(s)}}}function Fe(l,e,s){let{style:t}=e;function n(){let a=new URLSearchParams(window.location.search);a.set("style",t);let r=`${window.location.pathname}?${a.toString()}${window.location.hash}`;window.location.href=r}function o(a){t=a,s(0,t)}return l.$$set=a=>{"style"in a&&s(0,t=a.style)},[t,n,o]}class ft extends D{constructor(e){super(),E(this,e,Fe,Pe,I,{style:0})}}const P=[];function M(l,e=F){let s;const t=new Set;function n(r){if(I(l,r)&&(l=r,s)){const u=!P.length;for(const c of t)c[1](),P.push(c,l);if(u){for(let c=0;c<P.length;c+=2)P[c][0](P[c+1]);P.length=0}}}function o(r){n(r(l))}function a(r,u=F){const c=[r,u];return t.add(c),t.size===1&&(s=e(n,o)||F),r(l),()=>{t.delete(c),t.size===0&&s&&(s(),s=null)}}return{set:n,update:o,subscribe:a}}function Te(l){return l=="google"||l=="bing"}function dt(l){return{v1:"Scheme Design",v2:"Experimental Scheme Design",planning:"Development Planning",criticals:"Critical Issues",atf4:"ATF4 Scheme"}[l]}const Z=M(null),mt=M(null),ue=M(he()),qe=M(null),Ge=M(null),Re=M(null),Je=M(null),Ne=M(He());Ne.subscribe(l=>window.localStorage.setItem("userSettings",JSON.stringify(l)));const _t=M("edit-attribute"),pt=M(!1);function gt(l){let e=new Set;for(let t of l.features)e.add(t.id);let s=e.size+1;for(;e.has(s);)s++;return s}function bt(l){console.log(`Deleting intervention ${l}`),ue.update(e=>(e.features=e.features.filter(s=>s.id!=l),e)),qe.set(null),Ge.set(null),Re.set(null),Je.set(null)}function He(){let l={streetViewImagery:"google",avoidDoublingBack:!1};try{let e=JSON.parse(window.localStorage.getItem("userSettings")||"{}");Te(e.streetViewImagery)&&(l.streetViewImagery=e.streetViewImagery),typeof e.avoidDoublingBack=="boolean"&&(l.avoidDoublingBack=e.avoidDoublingBack)}catch(e){console.log(`Couldn't parse userSettings from local storage: ${e}`)}return l}const Ve=l=>({}),ne=l=>({}),We=l=>({}),le=l=>({});function Ze(l){let e,s,t,n,o,a,r,u,c,i,h;const y=l[3].sidebar,p=q(y,l,l[2],le),S=l[3].main,w=q(S,l,l[2],ne);return{c(){e=d("div"),s=d("aside"),t=d("div"),p&&p.c(),n=B(),o=d("button"),o.textContent="â†’",r=B(),u=d("main"),w&&w.c(),_(t,"class","sidebar-content content-container svelte-ect12w"),_(o,"type","button"),_(o,"class","sidebar-toggle rounded-rect svelte-ect12w"),_(s,"class",a=X(l[0]?"":"collapsed")+" svelte-ect12w"),_(u,"class","svelte-ect12w"),_(e,"class","overall-layout svelte-ect12w")},m(f,v){g(f,e,v),m(e,s),m(s,t),p&&p.m(t,null),m(s,n),m(s,o),m(e,r),m(e,u),w&&w.m(u,null),c=!0,i||(h=ae(o,"click",l[1]),i=!0)},p(f,[v]){p&&p.p&&(!c||v&4)&&G(p,y,f,f[2],c?J(y,f[2],v,We):R(f[2]),le),(!c||v&1&&a!==(a=X(f[0]?"":"collapsed")+" svelte-ect12w"))&&_(s,"class",a),w&&w.p&&(!c||v&4)&&G(w,S,f,f[2],c?J(S,f[2],v,Ve):R(f[2]),ne)},i(f){c||(C(p,f),C(w,f),c=!0)},o(f){O(p,f),O(w,f),c=!1},d(f){f&&b(e),p&&p.d(f),w&&w.d(f),i=!1,h()}}}function Ae(l,e,s){let{$$slots:t={},$$scope:n}=e,o=!0;function a(){s(0,o=!o)}return l.$$set=r=>{"$$scope"in r&&s(2,n=r.$$scope)},[o,a,n,t]}class ht extends D{constructor(e){super(),E(this,e,Ae,Ze,I,{})}}const k={area:"#D94324",route:"#555F5E",crossing:"#4daf4a",other:"#984ea3",preapp:"#e41a1c",outline:"#377eb8","reserved matters":"#4daf4a","local plan":"#984ea3",hovering:"black",lineEndpointColor:"black"},Ue=10,A=10;let z="interventions";function Ke(l,e,s){let t,n;N(l,Z,i=>s(1,t=i)),N(l,ue,i=>s(2,n=i));let{schema:o}=e;ve(t,z,n);const a=["match",["get","intervention_type"],"area",k.area,"route",k.route,"crossing",k.crossing,"other",k.other,"white"],r=["match",["get","reference_type",["get","planning"]],"preapp",k.preapp,"outline",k.outline,"reserved matters",k["reserved matters"],"local plan",k["local plan"],"white"],u=["!=","hide_while_editing",!0];return Y(t,{id:"interventions-points",source:z,filter:["all",we,u,["!=","endpoint",!0]],color:a,radius:Ue}),$(t,{id:"interventions-lines",source:z,filter:["all",ke,u],color:a,width:A}),Y(t,{id:"interventions-lines-endpoints",source:z,filter:["==","endpoint",!0],radius:.5*A,opacity:0,strokeColor:k.lineEndpointColor,strokeWidth:2}),ye(t,{id:"interventions-polygons",source:z,filter:["all",x,u],color:o=="planning"?r:a,opacity:.2}),$(t,{id:"interventions-polygon-outlines",source:z,filter:["all",x,u],color:o=="planning"?r:a,opacity:.5,width:.7*A}),l.$$set=i=>{"schema"in i&&s(0,o=i.schema)},l.$$.update=()=>{if(l.$$.dirty&6){let i=JSON.parse(JSON.stringify(n)),h=[];for(let y of i.features)if(y.geometry.type=="LineString"&&!y.properties.hide_while_editing)for(let p of[y.geometry.coordinates[0],y.geometry.coordinates[y.geometry.coordinates.length-1]])h.push({type:"Feature",properties:{endpoint:!0},geometry:{type:"Point",coordinates:p}});i.features=i.features.concat(h),t.getSource(z).setData(i)}},[o,t,n]}class vt extends D{constructor(e){super(),E(this,e,Ke,null,I,{schema:0})}}function Qe(l){let e,s,t,n,o,a,r;const u=l[3].default,c=q(u,l,l[2],null);return{c(){e=d("details"),s=d("summary"),t=d("span"),n=L(l[0]),o=B(),a=d("div"),c&&c.c(),_(t,"class","govuk-details__summary-text"),_(s,"class","govuk-details__summary"),_(a,"class","govuk-details__text"),e.open=l[1],_(e,"class","govuk-details"),_(e,"data-module","govuk-details")},m(i,h){g(i,e,h),m(e,s),m(s,t),m(t,n),m(e,o),m(e,a),c&&c.m(a,null),r=!0},p(i,[h]){(!r||h&1)&&ie(n,i[0]),c&&c.p&&(!r||h&4)&&G(c,u,i,i[2],r?J(u,i[2],h,null):R(i[2]),null),(!r||h&2)&&(e.open=i[1])},i(i){r||(C(c,i),r=!0)},o(i){O(c,i),r=!1},d(i){i&&b(e),c&&c.d(i)}}}function Xe(l,e,s){let{$$slots:t={},$$scope:n}=e,{label:o}=e,{open:a=!1}=e;return l.$$set=r=>{"label"in r&&s(0,o=r.label),"open"in r&&s(1,a=r.open),"$$scope"in r&&s(2,n=r.$$scope)},[o,a,n,t]}class Ye extends D{constructor(e){super(),E(this,e,Xe,Qe,I,{label:0,open:1})}}function $e(l,e,s){let t;N(l,Z,c=>s(2,t=c));let{layers:n}=e,{contents:o}=e,a=new T.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});t.on("mousemove",r),t.on("mouseout",u),ce(()=>{t.off("mousemove",r),t.off("mouseout",u),a.remove()});function r(c){if(!n.every(h=>t.getLayer(h))){a.remove();return}let i=t.queryRenderedFeatures(c.point,{layers:n});i.length>0?a.setLngLat(c.lngLat).setHTML(o(i[0].properties)).addTo(t):a.remove()}function u(){a.remove()}return l.$$set=c=>{"layers"in c&&s(0,n=c.layers),"contents"in c&&s(1,o=c.contents)},[n,o]}class yt extends D{constructor(e){super(),E(this,e,$e,null,I,{layers:0,contents:1})}}function xe(l){let e,s,t,n,o,a,r,u,c,i,h,y,p,S,w;return{c(){e=d("li"),s=d("span"),t=L("Areas"),n=B(),o=d("li"),a=d("span"),r=L("Routes"),u=B(),c=d("li"),i=d("span"),h=L("Crossings"),y=B(),p=d("li"),S=d("span"),w=L("Other"),_(s,"class","svelte-l42ea0"),j(s,"background",k.area),_(a,"class","svelte-l42ea0"),j(a,"background",k.route),_(i,"class","svelte-l42ea0"),j(i,"background",k.crossing),_(S,"class","svelte-l42ea0"),j(S,"background",k.other)},m(f,v){g(f,e,v),m(e,s),m(e,t),g(f,n,v),g(f,o,v),m(o,a),m(o,r),g(f,u,v),g(f,c,v),m(c,i),m(c,h),g(f,y,v),g(f,p,v),m(p,S),m(p,w)},p:F,d(f){f&&(b(e),b(n),b(o),b(u),b(c),b(y),b(p))}}}function et(l){let e,s,t,n,o,a,r,u,c,i,h,y,p,S,w;return{c(){e=d("li"),s=d("span"),t=L("Preapp"),n=B(),o=d("li"),a=d("span"),r=L("Outline"),u=B(),c=d("li"),i=d("span"),h=L("Reserved matters"),y=B(),p=d("li"),S=d("span"),w=L("Local plan"),_(s,"class","svelte-l42ea0"),j(s,"background",k.preapp),_(a,"class","svelte-l42ea0"),j(a,"background",k.outline),_(i,"class","svelte-l42ea0"),j(i,"background",k["reserved matters"]),_(S,"class","svelte-l42ea0"),j(S,"background",k["local plan"])},m(f,v){g(f,e,v),m(e,s),m(e,t),g(f,n,v),g(f,o,v),m(o,a),m(o,r),g(f,u,v),g(f,c,v),m(c,i),m(c,h),g(f,y,v),g(f,p,v),m(p,S),m(p,w)},p:F,d(f){f&&(b(e),b(n),b(o),b(u),b(c),b(y),b(p))}}}function tt(l){let e;function s(o,a){return o[0]=="planning"?et:xe}let t=s(l),n=t(l);return{c(){e=d("ul"),n.c()},m(o,a){g(o,e,a),n.m(e,null)},p(o,a){t===(t=s(o))&&n?n.p(o,a):(n.d(1),n=t(o),n&&(n.c(),n.m(e,null)))},d(o){o&&b(e),n.d()}}}function st(l){let e,s,t;return s=new Ye({props:{label:"Objects",open:!0,$$slots:{default:[tt]},$$scope:{ctx:l}}}),{c(){e=d("div"),H(s.$$.fragment),_(e,"class","svelte-l42ea0")},m(n,o){g(n,e,o),V(s,e,null),t=!0},p(n,[o]){const a={};o&3&&(a.$$scope={dirty:o,ctx:n}),s.$set(a)},i(n){t||(C(s.$$.fragment,n),t=!0)},o(n){O(s.$$.fragment,n),t=!1},d(n){n&&b(e),W(s)}}}function nt(l,e,s){let{schema:t}=e;return l.$$set=n=>{"schema"in n&&s(0,t=n.schema)},[t]}class wt extends D{constructor(e){super(),E(this,e,nt,st,I,{schema:0})}}function oe(l){let e;const s=l[4].default,t=q(s,l,l[3],null);return{c(){t&&t.c()},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&8)&&G(t,s,n,n[3],e?J(s,n[3],o,null):R(n[3]),null)},i(n){e||(C(t,n),e=!0)},o(n){O(t,n),e=!1},d(n){t&&t.d(n)}}}function lt(l){let e,s,t=l[1]&&oe(l);return{c(){e=d("div"),t&&t.c(),_(e,"class","map svelte-12dpf1u")},m(n,o){g(n,e,o),t&&t.m(e,null),l[5](e),s=!0},p(n,[o]){n[1]?t?(t.p(n,o),o&2&&C(t,1)):(t=oe(n),t.c(),C(t,1),t.m(e,null)):t&&(Se(),O(t,1,1,()=>{t=null}),Ce())},i(n){s||(C(t),s=!0)},o(n){O(t),s=!1},d(n){n&&b(e),t&&t.d(),l[5](null)}}}function ot(l,e,s){let{$$slots:t={},$$scope:n}=e,{style:o}=e,a,r,u=!1;Le("setCamera",!window.location.hash),Oe(()=>{a=new T.Map({container:r,style:`https://api.maptiler.com/maps/${o}/style.json?key=MZEJTanw3WpxRvt7qDfo`,hash:!0}),a.addControl(new T.ScaleControl({})),a.addControl(new T.NavigationControl({visualizePitch:!0}),"bottom-right"),a.on("load",()=>{s(1,u=!0),Z.set(a)}),new ResizeObserver(()=>{a.resize()}).observe(r)}),ce(()=>{a.remove()});function c(i){re[i?"unshift":"push"](()=>{r=i,s(0,r)})}return l.$$set=i=>{"style"in i&&s(2,o=i.style),"$$scope"in i&&s(3,n=i.$$scope)},[r,u,o,n,t,c]}class kt extends D{constructor(e){super(),E(this,e,ot,lt,I,{style:2})}}const at="/atip/govuk_step3/assets/zoom_out_map-b2e1091a.svg";function it(l){let e,s;return{c(){e=d("img"),Me(e.src,s=at)||_(e,"src",s),_(e,"alt","Zoom to show entire boundary")},m(t,n){g(t,e,n)},p:F,d(t){t&&b(e)}}}function rt(l){let e,s;return e=new Ie({props:{title:"Zoom to show entire boundary",$$slots:{default:[it]},$$scope:{ctx:l}}}),e.$on("click",l[0]),{c(){H(e.$$.fragment)},m(t,n){V(e,t,n),s=!0},p(t,[n]){const o={};n&8&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){s||(C(e.$$.fragment,t),s=!0)},o(t){O(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}function ct(l,e,s){let t;N(l,Z,a=>s(2,t=a));let{boundaryGeojson:n}=e;function o(){t.fitBounds(Be(n),{padding:20,animate:!0,duration:500})}return l.$$set=a=>{"boundaryGeojson"in a&&s(1,n=a.boundaryGeojson)},[o,n]}class St extends D{constructor(e){super(),E(this,e,ct,rt,I,{boundaryGeojson:1})}}export{ft as B,Ye as C,vt as I,ht as L,yt as M,ze as S,St as Z,Ge as a,Ue as b,k as c,_t as d,bt as e,qe as f,ue as g,dt as h,pt as i,kt as j,wt as k,A as l,Z as m,gt as n,Je as o,mt as r,Re as s,Ne as u};
