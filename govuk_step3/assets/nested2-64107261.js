import{S as we,i as ye,s as ke,g as F,m as M,t as g,l as y,q as N,G as ue,r as ve,T as Se,a as Y,d as Ce,F as je,al as ie,e as E,f as j,u as w,aa as ce,h as U,j as v,k as i,y as te,n as re,x as R,p as S,am as Be,z as Fe,B as me,E as Me,v as pe,w as Ne,Q as Le,R as Oe}from"./maplibre_helpers-c90a66cd.js";import{L as ze,g as X,Z as Ie,p as Te,I as Ee,B as Ge,q as Je,M as qe,m as Ae,C as De}from"./ZoomOutMap-22960ba9.js";function _e(s,e,r){const t=s.slice();return t[18]=e[r],t}function Re(s){let e;return{c(){e=w("Home")},m(r,t){v(r,e,t)},d(r){r&&S(e)}}}function $e(s){let e,r;return e=new Me({props:{errorMessage:s[5]}}),{c(){F(e.$$.fragment)},m(t,n){M(e,t,n),r=!0},p(t,n){const o={};n&32&&(o.errorMessage=t[5]),e.$set(o)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Ze(s){let e;return{c(){e=w("Clear")},m(r,t){v(r,e,t)},d(r){r&&S(e)}}}function He(s){let e,r,t,n,o,c;return t=new Y({props:{$$slots:{default:[Ze]},$$scope:{ctx:s}}}),t.$on("click",s[12]),{c(){e=E("input"),r=j(),F(t.$$.fragment),U(e,"type","text"),U(e,"class","govuk-input govuk-input--width-10"),U(e,"id","filterText")},m(u,$){v(u,e,$),pe(e,s[1]),v(u,r,$),M(t,u,$),n=!0,o||(c=Ne(e,"input",s[11]),o=!0)},p(u,$){$&2&&e.value!==u[1]&&pe(e,u[1]);const l={};$&2097152&&(l.$$scope={dirty:$,ctx:u}),t.$set(l)},i(u){n||(g(t.$$.fragment,u),n=!0)},o(u){y(t.$$.fragment,u),n=!1},d(u){u&&(S(e),S(r)),N(t,u),o=!1,c()}}}function de(s){let e,r;return e=new De({props:{label:`${s[18].scheme_reference}: ${s[18].num_features} features`,$$slots:{default:[Ue]},$$scope:{ctx:s}}}),{c(){F(e.$$.fragment)},m(t,n){M(e,t,n),r=!0},p(t,n){const o={};n&1&&(o.label=`${t[18].scheme_reference}: ${t[18].num_features} features`),n&2097153&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}function Pe(s){let e;return{c(){e=w("Show on map")},m(r,t){v(r,e,t)},d(r){r&&S(e)}}}function Qe(s){let e;return{c(){e=w("Edit scheme")},m(r,t){v(r,e,t)},d(r){r&&S(e)}}}function Ue(s){let e,r,t=s[18].authority_or_region+"",n,o,c,u,$=s[18].capital_scheme_id+"",l,p,L,Z,G=s[18].funding_programme+"",O,J,h,I,q,z,D,a;function _(){return s[13](s[18])}I=new Y({props:{$$slots:{default:[Pe]},$$scope:{ctx:s}}}),I.$on("click",_);function T(){return s[14](s[18])}return z=new Y({props:{$$slots:{default:[Qe]},$$scope:{ctx:s}}}),z.$on("click",T),{c(){e=E("p"),r=w("Authority or region: "),n=w(t),o=j(),c=E("p"),u=w("Capital scheme ID: "),l=w($),p=j(),L=E("p"),Z=w("Funding programme: "),O=w(G),J=j(),h=E("div"),F(I.$$.fragment),q=j(),F(z.$$.fragment),D=j(),U(h,"class","govuk-button-group")},m(m,k){v(m,e,k),i(e,r),i(e,n),v(m,o,k),v(m,c,k),i(c,u),i(c,l),v(m,p,k),v(m,L,k),i(L,Z),i(L,O),v(m,J,k),v(m,h,k),M(I,h,null),i(h,q),M(z,h,null),v(m,D,k),a=!0},p(m,k){s=m,(!a||k&1)&&t!==(t=s[18].authority_or_region+"")&&R(n,t),(!a||k&1)&&$!==($=s[18].capital_scheme_id+"")&&R(l,$),(!a||k&1)&&G!==(G=s[18].funding_programme+"")&&R(O,G);const K={};k&2097152&&(K.$$scope={dirty:k,ctx:s}),I.$set(K);const H={};k&2097152&&(H.$$scope={dirty:k,ctx:s}),z.$set(H)},i(m){a||(g(I.$$.fragment,m),g(z.$$.fragment,m),a=!0)},o(m){y(I.$$.fragment,m),y(z.$$.fragment,m),a=!1},d(m){m&&(S(e),S(o),S(c),S(p),S(L),S(J),S(h),S(D)),N(I),N(z)}}}function ge(s){let e=s[2].has(s[18].scheme_reference),r,t,n=e&&de(s);return{c(){n&&n.c(),r=Le()},m(o,c){n&&n.m(o,c),v(o,r,c),t=!0},p(o,c){c&5&&(e=o[2].has(o[18].scheme_reference)),e?n?(n.p(o,c),c&5&&g(n,1)):(n=de(o),n.c(),g(n,1),n.m(r.parentNode,r)):n&&(te(),y(n,1,1,()=>{n=null}),re())},i(o){t||(g(n),t=!0)},o(o){y(n),t=!1},d(o){o&&S(r),n&&n.d(o)}}}function Ke(s){let e,r,t,n,o,c,u,$,l,p,L,Z,G,O,J,h,I,q=s[2].size+"",z,D,a=s[3].route+"",_,T,m=s[3].area+"",k,K,H=s[3].crossing+"",x,ne,V=s[3].other+"",ee,se,oe,W,A;r=new Y({props:{$$slots:{default:[Re]},$$scope:{ctx:s}}}),r.$on("click",s[10]),u=new Ie({props:{boundaryGeojson:s[4]}});let C=s[5]&&$e(s);p=new Ce({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:s[7]}}),O=new je({props:{label:"Filter by any field",id:"filterText",$$slots:{default:[He]},$$scope:{ctx:s}}});let P=ie(s[0]),b=[];for(let f=0;f<P.length;f+=1)b[f]=ge(_e(s,P,f));const be=f=>y(b[f],1,1,()=>{b[f]=null});return{c(){e=E("div"),F(r.$$.fragment),t=j(),n=E("div"),o=E("h1"),o.textContent="Browse schemes",c=j(),F(u.$$.fragment),$=j(),C&&C.c(),l=j(),F(p.$$.fragment),L=j(),Z=E("br"),G=j(),F(O.$$.fragment),J=j(),h=E("p"),I=w("Showing "),z=w(q),D=w(" schemes ("),_=w(a),T=w(" routes, "),k=w(m),K=w(` areas,
      `),x=w(H),ne=w(" crossings, "),ee=w(V),se=w(" other)"),oe=j(),W=E("ul");for(let f=0;f<b.length;f+=1)b[f].c();ce(n,"display","flex"),ce(n,"justify-content","space-between"),U(e,"slot","sidebar"),U(e,"class","govuk-prose")},m(f,d){v(f,e,d),M(r,e,null),i(e,t),i(e,n),i(n,o),i(n,c),M(u,n,null),i(e,$),C&&C.m(e,null),i(e,l),M(p,e,null),i(e,L),i(e,Z),i(e,G),M(O,e,null),i(e,J),i(e,h),i(h,I),i(h,z),i(h,D),i(h,_),i(h,T),i(h,k),i(h,K),i(h,x),i(h,ne),i(h,ee),i(h,se),i(e,oe),i(e,W);for(let Q=0;Q<b.length;Q+=1)b[Q]&&b[Q].m(W,null);A=!0},p(f,d){const Q={};d&2097152&&(Q.$$scope={dirty:d,ctx:f}),r.$set(Q);const le={};d&16&&(le.boundaryGeojson=f[4]),u.$set(le),f[5]?C?(C.p(f,d),d&32&&g(C,1)):(C=$e(f),C.c(),g(C,1),C.m(e,l)):C&&(te(),y(C,1,1,()=>{C=null}),re());const ae={};if(d&2097154&&(ae.$$scope={dirty:d,ctx:f}),O.$set(ae),(!A||d&4)&&q!==(q=f[2].size+"")&&R(z,q),(!A||d&8)&&a!==(a=f[3].route+"")&&R(_,a),(!A||d&8)&&m!==(m=f[3].area+"")&&R(k,m),(!A||d&8)&&H!==(H=f[3].crossing+"")&&R(x,H),(!A||d&8)&&V!==(V=f[3].other+"")&&R(ee,V),d&773){P=ie(f[0]);let B;for(B=0;B<P.length;B+=1){const fe=_e(f,P,B);b[B]?(b[B].p(fe,d),g(b[B],1)):(b[B]=ge(fe),b[B].c(),g(b[B],1),b[B].m(W,null))}for(te(),B=P.length;B<b.length;B+=1)be(B);re()}},i(f){if(!A){g(r.$$.fragment,f),g(u.$$.fragment,f),g(C),g(p.$$.fragment,f),g(O.$$.fragment,f);for(let d=0;d<P.length;d+=1)g(b[d]);A=!0}},o(f){y(r.$$.fragment,f),y(u.$$.fragment,f),y(C),y(p.$$.fragment,f),y(O.$$.fragment,f),b=b.filter(Boolean);for(let d=0;d<b.length;d+=1)y(b[d]);A=!1},d(f){f&&S(e),N(r),N(u),C&&C.d(),N(p),N(O),Be(b,f)}}}function Ve(s){let e,r,t,n,o,c,u,$;return e=new Ee({props:{schema:he}}),t=new Ge({props:{style:s[6]}}),o=new Je({props:{schema:he}}),u=new qe({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:Ye}}),{c(){F(e.$$.fragment),r=j(),F(t.$$.fragment),n=j(),F(o.$$.fragment),c=j(),F(u.$$.fragment)},m(l,p){M(e,l,p),v(l,r,p),M(t,l,p),v(l,n,p),M(o,l,p),v(l,c,p),M(u,l,p),$=!0},p:Oe,i(l){$||(g(e.$$.fragment,l),g(t.$$.fragment,l),g(o.$$.fragment,l),g(u.$$.fragment,l),$=!0)},o(l){y(e.$$.fragment,l),y(t.$$.fragment,l),y(o.$$.fragment,l),y(u.$$.fragment,l),$=!1},d(l){l&&(S(r),S(n),S(c)),N(e,l),N(t,l),N(o,l),N(u,l)}}}function We(s){let e,r,t;return r=new Te({props:{style:s[6],$$slots:{default:[Ve]},$$scope:{ctx:s}}}),{c(){e=E("div"),F(r.$$.fragment),U(e,"slot","main")},m(n,o){v(n,e,o),M(r,e,null),t=!0},p(n,o){const c={};o&2097152&&(c.$$scope={dirty:o,ctx:n}),r.$set(c)},i(n){t||(g(r.$$.fragment,n),t=!0)},o(n){y(r.$$.fragment,n),t=!1},d(n){n&&S(e),N(r)}}}function Xe(s){let e,r;return e=new ze({props:{$$slots:{main:[We],sidebar:[Ke]},$$scope:{ctx:s}}}),{c(){F(e.$$.fragment)},m(t,n){M(e,t,n),r=!0},p(t,[n]){const o={};n&2097215&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){N(e,t)}}}const he="v1";function Ye(s){var e="<table>";for(let[r,t]of Object.entries(s))e+=`<tr><td>${r}</td><td>${t}</td></tr>`;return e+="</table>",e}function xe(s,e,r){let t,n;ue(s,X,a=>r(4,t=a)),ue(s,Ae,a=>r(15,n=a)),ve(()=>{Fe()});let c=new URLSearchParams(window.location.search).get("style")||"streets",u="",$=[],l="",p=new Set,L={area:0,route:0,crossing:0,other:0};Se(()=>{X.set(null)});function Z(a){try{let _=JSON.parse(a);X.set(_),G(_),r(5,u=""),n==null||n.fitBounds(me(_),{padding:20,animate:!1})}catch(_){r(5,u=`Couldn't load schemes from a file: ${_}`)}}function G(a){let _={};for(let[T,m]of Object.entries(a.schemes))_[T]={scheme_reference:T,num_features:0,...m};for(let T of a.features)_[T.properties.scheme_reference].num_features++;r(0,$=Object.values(_))}function O(a){let _={type:"FeatureCollection",features:t.features.filter(T=>T.properties.scheme_reference==a.scheme_reference)};n==null||n.fitBounds(me(_),{padding:20,animate:!1})}function J(a){let _={type:"FeatureCollection",features:t.features.filter(m=>m.properties.scheme_reference==a.scheme_reference)},T=a.authority_or_region;window.localStorage.setItem(T,JSON.stringify(_)),window.open(`scheme.html?authority=${a.authority_or_region}`,"_blank")}const h=()=>window.open("index.html");function I(){l=this.value,r(1,l)}const q=()=>r(1,l=""),z=a=>O(a),D=a=>J(a);return s.$$.update=()=>{if(s.$$.dirty&31){if(p.clear(),l){let a=l.toLowerCase();for(let _ of t.features)JSON.stringify(_.properties).toLowerCase().includes(a)&&p.add(_.properties.scheme_reference)}else for(let a of $)p.add(a.scheme_reference);X.update(a=>{if(!a)return null;for(let _ of a.features)p.has(_.properties.scheme_reference)?delete _.properties.hide_while_editing:_.properties.hide_while_editing=!0;return a}),r(3,L={area:0,route:0,crossing:0,other:0});for(let a of t==null?void 0:t.features)p.has(a.properties.scheme_reference)&&r(3,L[a.properties.intervention_type]++,L);r(2,p),r(1,l),r(4,t),r(0,$),r(3,L)}},[$,l,p,L,t,u,c,Z,O,J,h,I,q,z,D]}class et extends we{constructor(e){super(),ye(this,e,xe,Xe,ke,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new et({target:document.getElementById("app")});
