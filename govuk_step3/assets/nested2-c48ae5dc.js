import{S as he,i as ge,s as be,w as N,z as L,t as y,j as S,B as O,M as oe,C as we,Z as ye,o as V,r as ke,F as ve,ar as le,e as J,v as C,D as h,ag as ae,x as U,d as b,y as c,G as A,ai as _e,aj as $e,k as w,au as Se,H as Ce,J as fe,E as ue,l as je,X as Be,Y as Fe}from"./maplibre_helpers-daac31b3.js";import{L as Ne,g as Q,Z as Le,j as Oe,I as ze,B as Ie,k as Me,M as Je,m as Te,C as Ee}from"./ZoomOutMap-7c635dff.js";function ie(s,e,n){const t=s.slice();return t[17]=e[n],t}function Ge(s){let e;return{c(){e=h("Home")},m(n,t){b(n,e,t)},d(n){n&&w(e)}}}function De(s){let e;return{c(){e=h("Clear")},m(n,t){b(n,e,t)},d(n){n&&w(e)}}}function Ze(s){let e,n,t,r,l,p;return t=new V({props:{$$slots:{default:[De]},$$scope:{ctx:s}}}),t.$on("click",s[11]),{c(){e=J("input"),n=C(),N(t.$$.fragment),U(e,"type","text"),U(e,"class","govuk-input govuk-input--width-10"),U(e,"id","filterText")},m(f,m){b(f,e,m),ue(e,s[1]),b(f,n,m),L(t,f,m),r=!0,l||(p=je(e,"input",s[10]),l=!0)},p(f,m){m&2&&e.value!==f[1]&&ue(e,f[1]);const o={};m&1048576&&(o.$$scope={dirty:m,ctx:f}),t.$set(o)},i(f){r||(y(t.$$.fragment,f),r=!0)},o(f){S(t.$$.fragment,f),r=!1},d(f){f&&(w(e),w(n)),O(t,f),l=!1,p()}}}function ce(s){let e,n;return e=new Ee({props:{label:`${s[17].scheme_reference}: ${s[17].num_features} features`,$$slots:{default:[qe]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment)},m(t,r){L(e,t,r),n=!0},p(t,r){const l={};r&1&&(l.label=`${t[17].scheme_reference}: ${t[17].num_features} features`),r&1048577&&(l.$$scope={dirty:r,ctx:t}),e.$set(l)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}function Ae(s){let e;return{c(){e=h("Show on map")},m(n,t){b(n,e,t)},d(n){n&&w(e)}}}function He(s){let e;return{c(){e=h("Edit scheme")},m(n,t){b(n,e,t)},d(n){n&&w(e)}}}function qe(s){let e,n,t=s[17].authority_or_region+"",r,l,p,f,m=s[17].capital_scheme_id+"",o,g,T,H,j=s[17].funding_programme+"",G,k,M,B,Z,z,a,i;function I(){return s[12](s[17])}B=new V({props:{$$slots:{default:[Ae]},$$scope:{ctx:s}}}),B.$on("click",I);function E(){return s[13](s[17])}return z=new V({props:{$$slots:{default:[He]},$$scope:{ctx:s}}}),z.$on("click",E),{c(){e=J("p"),n=h("Authority or region: "),r=h(t),l=C(),p=J("p"),f=h("Capital scheme ID: "),o=h(m),g=C(),T=J("p"),H=h("Funding programme: "),G=h(j),k=C(),M=J("div"),N(B.$$.fragment),Z=C(),N(z.$$.fragment),a=C(),U(M,"class","govuk-button-group")},m(_,v){b(_,e,v),c(e,n),c(e,r),b(_,l,v),b(_,p,v),c(p,f),c(p,o),b(_,g,v),b(_,T,v),c(T,H),c(T,G),b(_,k,v),b(_,M,v),L(B,M,null),c(M,Z),L(z,M,null),b(_,a,v),i=!0},p(_,v){s=_,(!i||v&1)&&t!==(t=s[17].authority_or_region+"")&&A(r,t),(!i||v&1)&&m!==(m=s[17].capital_scheme_id+"")&&A(o,m),(!i||v&1)&&j!==(j=s[17].funding_programme+"")&&A(G,j);const q={};v&1048576&&(q.$$scope={dirty:v,ctx:s}),B.$set(q);const X={};v&1048576&&(X.$$scope={dirty:v,ctx:s}),z.$set(X)},i(_){i||(y(B.$$.fragment,_),y(z.$$.fragment,_),i=!0)},o(_){S(B.$$.fragment,_),S(z.$$.fragment,_),i=!1},d(_){_&&(w(e),w(l),w(p),w(g),w(T),w(k),w(M),w(a)),O(B),O(z)}}}function me(s){let e=s[2].has(s[17].scheme_reference),n,t,r=e&&ce(s);return{c(){r&&r.c(),n=Be()},m(l,p){r&&r.m(l,p),b(l,n,p),t=!0},p(l,p){p&5&&(e=l[2].has(l[17].scheme_reference)),e?r?(r.p(l,p),p&5&&y(r,1)):(r=ce(l),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(_e(),S(r,1,1,()=>{r=null}),$e())},i(l){t||(y(r),t=!0)},o(l){S(r),t=!1},d(l){l&&w(n),r&&r.d(l)}}}function Pe(s){let e,n,t,r,l,p,f,m,o,g,T,H,j,G,k,M,B=s[2].size+"",Z,z,a=s[3].route+"",i,I,E=s[3].area+"",_,v,q=s[3].crossing+"",X,x,Y=s[3].other+"",W,ee,te,K,D;n=new V({props:{$$slots:{default:[Ge]},$$scope:{ctx:s}}}),n.$on("click",s[9]),f=new Le({props:{boundaryGeojson:s[4]}}),o=new ke({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:s[6]}}),j=new ve({props:{label:"Filter by any field",id:"filterText",$$slots:{default:[Ze]},$$scope:{ctx:s}}});let P=le(s[0]),$=[];for(let u=0;u<P.length;u+=1)$[u]=me(ie(s,P,u));const de=u=>S($[u],1,1,()=>{$[u]=null});return{c(){e=J("div"),N(n.$$.fragment),t=C(),r=J("div"),l=J("h1"),l.textContent="Browse schemes",p=C(),N(f.$$.fragment),m=C(),N(o.$$.fragment),g=C(),T=J("br"),H=C(),N(j.$$.fragment),G=C(),k=J("p"),M=h("Showing "),Z=h(B),z=h(" schemes ("),i=h(a),I=h(" routes, "),_=h(E),v=h(` areas,
      `),X=h(q),x=h(" crossings, "),W=h(Y),ee=h(" other)"),te=C(),K=J("ul");for(let u=0;u<$.length;u+=1)$[u].c();ae(r,"display","flex"),ae(r,"justify-content","space-between"),U(e,"slot","sidebar"),U(e,"class","govuk-prose")},m(u,d){b(u,e,d),L(n,e,null),c(e,t),c(e,r),c(r,l),c(r,p),L(f,r,null),c(e,m),L(o,e,null),c(e,g),c(e,T),c(e,H),L(j,e,null),c(e,G),c(e,k),c(k,M),c(k,Z),c(k,z),c(k,i),c(k,I),c(k,_),c(k,v),c(k,X),c(k,x),c(k,W),c(k,ee),c(e,te),c(e,K);for(let R=0;R<$.length;R+=1)$[R]&&$[R].m(K,null);D=!0},p(u,d){const R={};d&1048576&&(R.$$scope={dirty:d,ctx:u}),n.$set(R);const ne={};d&16&&(ne.boundaryGeojson=u[4]),f.$set(ne);const re={};if(d&1048578&&(re.$$scope={dirty:d,ctx:u}),j.$set(re),(!D||d&4)&&B!==(B=u[2].size+"")&&A(Z,B),(!D||d&8)&&a!==(a=u[3].route+"")&&A(i,a),(!D||d&8)&&E!==(E=u[3].area+"")&&A(_,E),(!D||d&8)&&q!==(q=u[3].crossing+"")&&A(X,q),(!D||d&8)&&Y!==(Y=u[3].other+"")&&A(W,Y),d&389){P=le(u[0]);let F;for(F=0;F<P.length;F+=1){const se=ie(u,P,F);$[F]?($[F].p(se,d),y($[F],1)):($[F]=me(se),$[F].c(),y($[F],1),$[F].m(K,null))}for(_e(),F=P.length;F<$.length;F+=1)de(F);$e()}},i(u){if(!D){y(n.$$.fragment,u),y(f.$$.fragment,u),y(o.$$.fragment,u),y(j.$$.fragment,u);for(let d=0;d<P.length;d+=1)y($[d]);D=!0}},o(u){S(n.$$.fragment,u),S(f.$$.fragment,u),S(o.$$.fragment,u),S(j.$$.fragment,u),$=$.filter(Boolean);for(let d=0;d<$.length;d+=1)S($[d]);D=!1},d(u){u&&w(e),O(n),O(f),O(o),O(j),Se($,u)}}}function Re(s){let e,n,t,r,l,p,f,m;return e=new ze({props:{schema:pe}}),t=new Ie({props:{style:s[5]}}),l=new Me({props:{schema:pe}}),f=new Je({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:Ye}}),{c(){N(e.$$.fragment),n=C(),N(t.$$.fragment),r=C(),N(l.$$.fragment),p=C(),N(f.$$.fragment)},m(o,g){L(e,o,g),b(o,n,g),L(t,o,g),b(o,r,g),L(l,o,g),b(o,p,g),L(f,o,g),m=!0},p:Fe,i(o){m||(y(e.$$.fragment,o),y(t.$$.fragment,o),y(l.$$.fragment,o),y(f.$$.fragment,o),m=!0)},o(o){S(e.$$.fragment,o),S(t.$$.fragment,o),S(l.$$.fragment,o),S(f.$$.fragment,o),m=!1},d(o){o&&(w(n),w(r),w(p)),O(e,o),O(t,o),O(l,o),O(f,o)}}}function Ue(s){let e,n,t;return n=new Oe({props:{style:s[5],$$slots:{default:[Re]},$$scope:{ctx:s}}}),{c(){e=J("div"),N(n.$$.fragment),U(e,"slot","main")},m(r,l){b(r,e,l),L(n,e,null),t=!0},p(r,l){const p={};l&1048576&&(p.$$scope={dirty:l,ctx:r}),n.$set(p)},i(r){t||(y(n.$$.fragment,r),t=!0)},o(r){S(n.$$.fragment,r),t=!1},d(r){r&&w(e),O(n)}}}function Xe(s){let e,n;return e=new Ne({props:{$$slots:{main:[Ue],sidebar:[Pe]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment)},m(t,r){L(e,t,r),n=!0},p(t,[r]){const l={};r&1048607&&(l.$$scope={dirty:r,ctx:t}),e.$set(l)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){O(e,t)}}}const pe="v1";function Ye(s){var e="<table>";for(let[n,t]of Object.entries(s))e+=`<tr><td>${n}</td><td>${t}</td></tr>`;return e+="</table>",e}function Ke(s,e,n){let t,r;oe(s,Q,a=>n(4,t=a)),oe(s,Te,a=>n(14,r=a)),we(()=>{Ce()});let p=new URLSearchParams(window.location.search).get("style")||"streets",f=[],m="",o=new Set,g={area:0,route:0,crossing:0,other:0};ye(()=>{Q.set(null)});function T(a){try{let i=JSON.parse(a);Q.set(i),H(i),r==null||r.fitBounds(fe(i),{padding:20,animate:!1})}catch(i){window.alert(`Couldn't load schemes from a file: ${i}`)}}function H(a){let i={};for(let[I,E]of Object.entries(a.schemes))i[I]={scheme_reference:I,num_features:0,...E};for(let I of a.features)i[I.properties.scheme_reference].num_features++;n(0,f=Object.values(i))}function j(a){let i={type:"FeatureCollection",features:t.features.filter(I=>I.properties.scheme_reference==a.scheme_reference)};r==null||r.fitBounds(fe(i),{padding:20,animate:!1})}function G(a){let i={type:"FeatureCollection",features:t.features.filter(E=>E.properties.scheme_reference==a.scheme_reference)},I=a.authority_or_region;window.localStorage.setItem(I,JSON.stringify(i)),window.open(`scheme.html?authority=${a.authority_or_region}`,"_blank")}const k=()=>window.open("index.html");function M(){m=this.value,n(1,m)}const B=()=>n(1,m=""),Z=a=>j(a),z=a=>G(a);return s.$$.update=()=>{if(s.$$.dirty&31){if(o.clear(),m){let a=m.toLowerCase();for(let i of t.features)JSON.stringify(i.properties).toLowerCase().includes(a)&&o.add(i.properties.scheme_reference)}else for(let a of f)o.add(a.scheme_reference);Q.update(a=>{if(!a)return null;for(let i of a.features)o.has(i.properties.scheme_reference)?delete i.properties.hide_while_editing:i.properties.hide_while_editing=!0;return a}),n(3,g={area:0,route:0,crossing:0,other:0});for(let a of t==null?void 0:t.features)o.has(a.properties.scheme_reference)&&n(3,g[a.properties.intervention_type]++,g);n(2,o),n(1,m),n(4,t),n(0,f),n(3,g)}},[f,m,o,g,t,p,T,j,G,k,M,B,Z,z]}class Qe extends he{constructor(e){super(),ge(this,e,Ke,Xe,be,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Qe({target:document.getElementById("app")});
