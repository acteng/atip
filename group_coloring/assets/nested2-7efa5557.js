import{S as q,i as W,s as Y,g as L,f as z,e as O,u as E,m as S,j as k,k as D,T as J,t as d,l as $,p as T,q as U,Z as Q,a1 as se,r as Ue,b as oe,c as ie,F as St,o as le,a as de,h as F,v as Ve,w as Ut,M as De,C as _e,aV as et,a0 as Dt,G as Mt,J as Et,K as Ct,L as Bt,aU as Me,a6 as zt,x as At,D as tt,aW as Ze,af as rt,d as Nt,W as He,y as ce,n as me,z as Ot,A as It,a8 as Pt,aO as jt,E as Vt,U as xe,V as Zt,ac as Ht}from"./data_getter-df6eed20.js";import{C as Ee,S as Fe,d as nt,e as st,H as ot,L as xt,Z as Ft,M as Rt,I as Kt,h as Gt,B as Jt,b as qt}from"./Map-2f34a131.js";function Wt(n){let e=new Map;for(let[r,t]of Object.entries(n.schemes))e.set(r,{scheme_reference:r,num_features:0,authority_or_region:t.authority_or_region,capital_scheme_id:t.capital_scheme_id,funding_programme:t.funding_programme});for(let r of n.features)e.get(r.properties.scheme_reference).num_features++,delete r.properties.id,delete r.properties.authority_or_region,delete r.properties.capital_scheme_id,delete r.properties.funding_programme,delete r.properties.valid,delete r.properties.centroid_lon,delete r.properties.centroid_lat;return e}function Yt(n){let e;return{c(){e=E("Clear")},m(r,t){k(r,e,t)},d(r){r&&T(e)}}}function Qt(n){let e,r,t,s,o,i;return t=new de({props:{$$slots:{default:[Yt]},$$scope:{ctx:n}}}),t.$on("click",n[11]),{c(){e=O("input"),r=z(),L(t.$$.fragment),F(e,"type","text"),F(e,"class","govuk-input govuk-input--width-10"),F(e,"id","filterText")},m(a,l){k(a,e,l),Ve(e,n[0]),k(a,r,l),S(t,a,l),s=!0,o||(i=Ut(e,"input",n[10]),o=!0)},p(a,l){l&1&&e.value!==a[0]&&Ve(e,a[0]);const u={};l&16384&&(u.$$scope={dirty:l,ctx:a}),t.$set(u)},i(a){s||(d(t.$$.fragment,a),s=!0)},o(a){$(t.$$.fragment,a),s=!1},d(a){a&&(T(e),T(r)),U(t,a),o=!1,i()}}}function Xt(n){let e,r,t,s,o,i,a,l;function u(m){n[8](m)}let f={label:"Authority or region",id:"filterAuthority",choices:n[4],emptyOption:!0};n[2]!==void 0&&(f.value=n[2]),e=new Fe({props:f}),oe.push(()=>ie(e,"value",u));function c(m){n[9](m)}let w={label:"Funding programme",id:"filterFundingProgramme",choices:n[5],emptyOption:!0};return n[3]!==void 0&&(w.value=n[3]),s=new Fe({props:w}),oe.push(()=>ie(s,"value",c)),a=new St({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[Qt]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment),t=z(),L(s.$$.fragment),i=z(),L(a.$$.fragment)},m(m,g){S(e,m,g),k(m,t,g),S(s,m,g),k(m,i,g),S(a,m,g),l=!0},p(m,g){const _={};g&16&&(_.choices=m[4]),!r&&g&4&&(r=!0,_.value=m[2],le(()=>r=!1)),e.$set(_);const y={};g&32&&(y.choices=m[5]),!o&&g&8&&(o=!0,y.value=m[3],le(()=>o=!1)),s.$set(y);const p={};g&16385&&(p.$$scope={dirty:g,ctx:m}),a.$set(p)},i(m){l||(d(e.$$.fragment,m),d(s.$$.fragment,m),d(a.$$.fragment,m),l=!0)},o(m){$(e.$$.fragment,m),$(s.$$.fragment,m),$(a.$$.fragment,m),l=!1},d(m){m&&(T(t),T(i)),U(e,m),U(s,m),U(a,m)}}}function er(n){let e,r,t,s,o=n[1].size+"",i,a,l=n[6].route+"",u,f,c=n[6].area+"",w,m,g=n[6].crossing+"",_,y,p=n[6].other+"",h,b,C;return e=new Ee({props:{label:"Filters",$$slots:{default:[Xt]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment),r=z(),t=O("p"),s=E("Showing "),i=E(o),a=E(" schemes ("),u=E(l),f=E(" routes, "),w=E(c),m=E(` areas,
  `),_=E(g),y=E(" crossings, "),h=E(p),b=E(" other)")},m(v,M){S(e,v,M),k(v,r,M),k(v,t,M),D(t,s),D(t,i),D(t,a),D(t,u),D(t,f),D(t,w),D(t,m),D(t,_),D(t,y),D(t,h),D(t,b),C=!0},p(v,[M]){const A={};M&16445&&(A.$$scope={dirty:M,ctx:v}),e.$set(A),(!C||M&2)&&o!==(o=v[1].size+"")&&J(i,o),(!C||M&64)&&l!==(l=v[6].route+"")&&J(u,l),(!C||M&64)&&c!==(c=v[6].area+"")&&J(w,c),(!C||M&64)&&g!==(g=v[6].crossing+"")&&J(_,g),(!C||M&64)&&p!==(p=v[6].other+"")&&J(h,p)},i(v){C||(d(e.$$.fragment,v),C=!0)},o(v){$(e.$$.fragment,v),C=!1},d(v){v&&(T(r),T(t)),U(e,v)}}}function tr(n,e,r){let t;Q(n,se,p=>r(12,t=p));let{schemes:s}=e,{schemesToBeShown:o=new Set}=e,{filterText:i=""}=e,a=[],l="",u=[],f="",c={area:0,route:0,crossing:0,other:0};Ue(()=>{let p=new Set,h=new Set;for(let b of s.values())b.authority_or_region&&p.add(b.authority_or_region),b.funding_programme&&h.add(b.funding_programme);r(4,a=Array.from(p.entries())),a.sort(),r(5,u=Array.from(h.entries())),u.sort()});function w(p,h,b){let C=p.toLowerCase(),v=A=>{var N,R;if(C&&!((N=A.properties.name)!=null&&N.toLowerCase().includes(C))&&!((R=A.properties.description)!=null&&R.toLowerCase().includes(C)))return!1;if(h||b){let I=s.get(A.properties.scheme_reference);if(h&&I.authority_or_region!=h||b&&I.funding_programme!=b)return!1}return!0};r(1,o=new Set(t.features.filter(v).map(A=>A.properties.scheme_reference))),r(6,c={area:0,route:0,crossing:0,other:0});let M=A=>{var N,R;return!(!o.has(A.properties.scheme_reference)||C&&!((N=A.properties.name)!=null&&N.toLowerCase().includes(C))&&!((R=A.properties.description)!=null&&R.toLowerCase().includes(C)))};se.update(A=>{for(let N of A.features)M(N)?(delete N.properties.hide_while_editing,r(6,c[N.properties.intervention_type]++,c)):N.properties.hide_while_editing=!0;return A}),r(6,c)}function m(p){l=p,r(2,l)}function g(p){f=p,r(3,f)}function _(){i=this.value,r(0,i)}const y=()=>r(0,i="");return n.$$set=p=>{"schemes"in p&&r(7,s=p.schemes),"schemesToBeShown"in p&&r(1,o=p.schemesToBeShown),"filterText"in p&&r(0,i=p.filterText)},n.$$.update=()=>{n.$$.dirty&13&&w(i,l,f)},[i,o,l,f,a,u,c,s,m,g,_,y]}class rr extends q{constructor(e){super(),W(this,e,tr,er,Y,{schemes:7,schemesToBeShown:1,filterText:0})}}function nr(n){let e,r,t,s;return e=new st({props:{color:n[2]}}),{c(){L(e.$$.fragment),r=z(),t=E(n[1])},m(o,i){S(e,o,i),k(o,r,i),k(o,t,i),s=!0},p(o,i){const a={};i&4&&(a.color=o[2]),e.$set(a),(!s||i&2)&&J(t,o[1])},i(o){s||(d(e.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),s=!1},d(o){o&&(T(r),T(t)),U(e,o)}}}function sr(n){let e;const r=n[7].default,t=Mt(r,n,n[9],null);return{c(){t&&t.c()},m(s,o){t&&t.m(s,o),e=!0},p(s,o){t&&t.p&&(!e||o&512)&&Et(t,r,s,s[9],e?Bt(r,s[9],o,null):Ct(s[9]),null)},i(s){e||(d(t,s),e=!0)},o(s){$(t,s),e=!1},d(s){t&&t.d(s)}}}function or(n){let e,r,t;return r=new ot({props:{$$slots:{default:[sr]},$$scope:{ctx:n}}}),{c(){e=O("span"),L(r.$$.fragment),F(e,"slot","right")},m(s,o){k(s,e,o),S(r,e,null),t=!0},p(s,o){const i={};o&512&&(i.$$scope={dirty:o,ctx:s}),r.$set(i)},i(s){t||(d(r.$$.fragment,s),t=!0)},o(s){$(r.$$.fragment,s),t=!1},d(s){s&&T(e),U(r)}}}function ir(n){let e,r,t,s,o;function i(l){n[8](l)}let a={id:n[0],$$slots:{right:[or],default:[nr]},$$scope:{ctx:n}};return n[3]!==void 0&&(a.checked=n[3]),e=new nt({props:a}),oe.push(()=>ie(e,"checked",i)),s=new De({props:{layers:[n[0]],contents:n[4]}}),{c(){L(e.$$.fragment),t=z(),L(s.$$.fragment)},m(l,u){S(e,l,u),k(l,t,u),S(s,l,u),o=!0},p(l,[u]){const f={};u&1&&(f.id=l[0]),u&518&&(f.$$scope={dirty:u,ctx:l}),!r&&u&8&&(r=!0,f.checked=l[3],le(()=>r=!1)),e.$set(f);const c={};u&1&&(c.layers=[l[0]]),s.$set(c)},i(l){o||(d(e.$$.fragment,l),d(s.$$.fragment,l),o=!0)},o(l){$(e.$$.fragment,l),$(s.$$.fragment,l),o=!1},d(l){l&&T(t),U(e,l),U(s,l)}}}function lr(n,e,r){let t;Q(n,_e,m=>r(6,t=m));let{$$slots:s={},$$scope:o}=e,{name:i}=e,{singularNoun:a}=e,{pluralNoun:l}=e,{color:u}=e;et(t,i,`https://atip.uk/layers/v1/${i}.pmtiles`),Dt(t,{id:i,source:i,sourceLayer:i,color:u,opacity:.8});let f=!1;function c(m){return`<p>${m.name??`Unnamed ${a}`}</p>`}function w(m){f=m,r(3,f)}return n.$$set=m=>{"name"in m&&r(0,i=m.name),"singularNoun"in m&&r(5,a=m.singularNoun),"pluralNoun"in m&&r(1,l=m.pluralNoun),"color"in m&&r(2,u=m.color),"$$scope"in m&&r(9,o=m.$$scope)},n.$$.update=()=>{n.$$.dirty&73&&t.getLayer(i)&&t.setLayoutProperty(i,"visibility",f?"visible":"none")},[i,l,u,f,c,a,t,s,w,o]}class it extends q{constructor(e){super(),W(this,e,lr,ir,Y,{name:0,singularNoun:5,pluralNoun:1,color:2})}}function ar(n){let e;return{c(){e=E("hospital")},m(r,t){k(r,e,t)},d(r){r&&T(e)}}}function fr(n){let e,r,t,s,o;return t=new Me({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[ar]},$$scope:{ctx:n}}}),{c(){e=O("p"),r=E("This shows "),L(t.$$.fragment),s=E(` data from OpenStreetMap. It doesn't include outpatient clinics
    or individual doctor's offices.`)},m(i,a){k(i,e,a),D(e,r),S(t,e,null),D(e,s),o=!0},p(i,a){const l={};a&1&&(l.$$scope={dirty:a,ctx:i}),t.$set(l)},i(i){o||(d(t.$$.fragment,i),o=!0)},o(i){$(t.$$.fragment,i),o=!1},d(i){i&&T(e),U(t)}}}function ur(n){let e,r;return e=new it({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",color:"blue",$$slots:{default:[fr]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){S(e,t,s),r=!0},p(t,[s]){const o={};s&1&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){U(e,t)}}}class cr extends q{constructor(e){super(),W(this,e,null,ur,Y,{})}}function mr(n){let e,r,t;return e=new st({props:{color:lt}}),{c(){L(e.$$.fragment),r=E(`
  MRN`)},m(s,o){S(e,s,o),k(s,r,o),t=!0},p:At,i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){s&&T(r),U(e,s)}}}function hr(n){let e;return{c(){e=E(`Major Road Network
        `)},m(r,t){k(r,e,t)},d(r){r&&T(e)}}}function pr(n){let e,r,t,s,o;return t=new Me({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[hr]},$$scope:{ctx:n}}}),{c(){e=O("p"),r=E("Data from the "),L(t.$$.fragment),s=E(".")},m(i,a){k(i,e,a),D(e,r),S(t,e,null),D(e,s),o=!0},p(i,a){const l={};a&8&&(l.$$scope={dirty:a,ctx:i}),t.$set(l)},i(i){o||(d(t.$$.fragment,i),o=!0)},o(i){$(t.$$.fragment,i),o=!1},d(i){i&&T(e),U(t)}}}function gr(n){let e,r,t;return r=new ot({props:{$$slots:{default:[pr]},$$scope:{ctx:n}}}),{c(){e=O("span"),L(r.$$.fragment),F(e,"slot","right")},m(s,o){k(s,e,o),S(r,e,null),t=!0},p(s,o){const i={};o&8&&(i.$$scope={dirty:o,ctx:s}),r.$set(i)},i(s){t||(d(r.$$.fragment,s),t=!0)},o(s){$(r.$$.fragment,s),t=!1},d(s){s&&T(e),U(r)}}}function dr(n){let e,r,t,s,o;function i(l){n[2](l)}let a={id:G,$$slots:{right:[gr],default:[mr]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new nt({props:a}),oe.push(()=>ie(e,"checked",i)),s=new De({props:{layers:[G],contents:$r}}),{c(){L(e.$$.fragment),t=z(),L(s.$$.fragment)},m(l,u){S(e,l,u),k(l,t,u),S(s,l,u),o=!0},p(l,[u]){const f={};u&8&&(f.$$scope={dirty:u,ctx:l}),!r&&u&1&&(r=!0,f.checked=l[0],le(()=>r=!1)),e.$set(f)},i(l){o||(d(e.$$.fragment,l),d(s.$$.fragment,l),o=!0)},o(l){$(e.$$.fragment,l),$(s.$$.fragment,l),o=!1},d(l){l&&T(t),U(e,l),U(s,l)}}}let G="mrn",lt="purple";function $r(n){return`<p>${n.name??"Unknown MRN road"}</p>`}function _r(n,e,r){let t;Q(n,_e,i=>r(1,t=i)),et(t,G,`https://atip.uk/layers/v1/${G}.pmtiles`),zt(t,{id:G,source:G,sourceLayer:G,color:lt,width:7});let s=!1;function o(i){s=i,r(0,s)}return n.$$.update=()=>{n.$$.dirty&3&&t.getLayer(G)&&t.setLayoutProperty(G,"visibility",s?"visible":"none")},[s,t,o]}class wr extends q{constructor(e){super(),W(this,e,_r,dr,Y,{})}}function vr(n){let e;return{c(){e=E("Show on map")},m(r,t){k(r,e,t)},d(r){r&&T(e)}}}function yr(n){let e;return{c(){e=E("Edit scheme locally")},m(r,t){k(r,e,t)},d(r){r&&T(e)}}}function br(n){let e,r,t=n[0].authority_or_region+"",s,o,i,a,l=n[0].capital_scheme_id+"",u,f,c,w,m=n[0].funding_programme+"",g,_,y,p,h,b,C;return p=new de({props:{$$slots:{default:[vr]},$$scope:{ctx:n}}}),p.$on("click",n[3]),b=new de({props:{disabled:n[1],title:n[2],$$slots:{default:[yr]},$$scope:{ctx:n}}}),b.$on("click",n[4]),{c(){e=O("p"),r=E("Authority or region: "),s=E(t),o=z(),i=O("p"),a=E("Capital scheme ID: "),u=E(l),f=z(),c=O("p"),w=E("Funding programme: "),g=E(m),_=z(),y=O("div"),L(p.$$.fragment),h=z(),L(b.$$.fragment),F(y,"class","govuk-button-group")},m(v,M){k(v,e,M),D(e,r),D(e,s),k(v,o,M),k(v,i,M),D(i,a),D(i,u),k(v,f,M),k(v,c,M),D(c,w),D(c,g),k(v,_,M),k(v,y,M),S(p,y,null),D(y,h),S(b,y,null),C=!0},p(v,M){(!C||M&1)&&t!==(t=v[0].authority_or_region+"")&&J(s,t),(!C||M&1)&&l!==(l=v[0].capital_scheme_id+"")&&J(u,l),(!C||M&1)&&m!==(m=v[0].funding_programme+"")&&J(g,m);const A={};M&256&&(A.$$scope={dirty:M,ctx:v}),p.$set(A);const N={};M&256&&(N.$$scope={dirty:M,ctx:v}),b.$set(N)},i(v){C||(d(p.$$.fragment,v),d(b.$$.fragment,v),C=!0)},o(v){$(p.$$.fragment,v),$(b.$$.fragment,v),C=!1},d(v){v&&(T(e),T(o),T(i),T(f),T(c),T(_),T(y)),U(p),U(b)}}}function kr(n){let e,r;return e=new Ee({props:{label:`${n[0].scheme_reference}: ${n[0].num_features} features`,$$slots:{default:[br]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){S(e,t,s),r=!0},p(t,[s]){const o={};s&1&&(o.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),s&257&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){U(e,t)}}}function Tr(n,e,r){let t,s;Q(n,se,c=>r(6,t=c)),Q(n,_e,c=>r(7,s=c));let{scheme:o}=e,{authorityNames:i}=e,a=!i.has(o.authority_or_region),l=a?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function u(){let c={type:"FeatureCollection",features:t.features.filter(w=>w.properties.scheme_reference==o.scheme_reference)};s==null||s.fitBounds(tt(c),{padding:20,animate:!1})}function f(){let c={type:"FeatureCollection",features:t.features.filter(m=>m.properties.scheme_reference==o.scheme_reference)},w=o.authority_or_region;window.localStorage.setItem(w,JSON.stringify(c)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return n.$$set=c=>{"scheme"in c&&r(0,o=c.scheme),"authorityNames"in c&&r(5,i=c.authorityNames)},[o,a,l,u,f,i]}class Lr extends q{constructor(e){super(),W(this,e,Tr,kr,Y,{scheme:0,authorityNames:5})}}function Sr(n){let e;return{c(){e=E("primary and secondary schools")},m(r,t){k(r,e,t)},d(r){r&&T(e)}}}function Ur(n){let e,r,t,s,o;return t=new Me({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Sr]},$$scope:{ctx:n}}}),{c(){e=O("p"),r=E("This shows "),L(t.$$.fragment),s=E(` from OpenStreetMap. It doesn't include kindergartens, colleges,
    universities, or other training schools.`)},m(i,a){k(i,e,a),D(e,r),S(t,e,null),D(e,s),o=!0},p(i,a){const l={};a&1&&(l.$$scope={dirty:a,ctx:i}),t.$set(l)},i(i){o||(d(t.$$.fragment,i),o=!0)},o(i){$(t.$$.fragment,i),o=!1},d(i){i&&T(e),U(t)}}}function Dr(n){let e,r;return e=new it({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",color:"red",$$slots:{default:[Ur]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){S(e,t,s),r=!0},p(t,[s]){const o={};s&1&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){U(e,t)}}}class Mr extends q{constructor(e){super(),W(this,e,null,Dr,Y,{})}}var P=(n,e,r)=>new Promise((t,s)=>{var o=l=>{try{a(r.next(l))}catch(u){s(u)}},i=l=>{try{a(r.throw(l))}catch(u){s(u)}},a=l=>l.done?t(l.value):Promise.resolve(l.value).then(o,i);a((r=r.apply(n,e)).next())}),V=Uint8Array,re=Uint16Array,Er=Int32Array,at=new V([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ft=new V([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Cr=new V([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ut=function(n,e){for(var r=new re(31),t=0;t<31;++t)r[t]=e+=1<<n[t-1];for(var s=new Er(r[30]),t=1;t<30;++t)for(var o=r[t];o<r[t+1];++o)s[o]=o-r[t]<<5|t;return{b:r,r:s}},ct=ut(at,2),mt=ct.b,Br=ct.r;mt[28]=258,Br[258]=28;var zr=ut(ft,0),Ar=zr.b,Le=new re(32768);for(B=0;B<32768;++B)K=(B&43690)>>1|(B&21845)<<1,K=(K&52428)>>2|(K&13107)<<2,K=(K&61680)>>4|(K&3855)<<4,Le[B]=((K&65280)>>8|(K&255)<<8)>>1;var K,B,he=function(n,e,r){for(var t=n.length,s=0,o=new re(e);s<t;++s)n[s]&&++o[n[s]-1];var i=new re(e);for(s=1;s<e;++s)i[s]=i[s-1]+o[s-1]<<1;var a;if(r){a=new re(1<<e);var l=15-e;for(s=0;s<t;++s)if(n[s])for(var u=s<<4|n[s],f=e-n[s],c=i[n[s]-1]++<<f,w=c|(1<<f)-1;c<=w;++c)a[Le[c]>>l]=u}else for(a=new re(t),s=0;s<t;++s)n[s]&&(a[s]=Le[i[n[s]-1]++]>>15-n[s]);return a},pe=new V(288);for(B=0;B<144;++B)pe[B]=8;var B;for(B=144;B<256;++B)pe[B]=9;var B;for(B=256;B<280;++B)pe[B]=7;var B;for(B=280;B<288;++B)pe[B]=8;var B,ht=new V(32);for(B=0;B<32;++B)ht[B]=5;var B,Nr=he(pe,9,1),Or=he(ht,5,1),ke=function(n){for(var e=n[0],r=1;r<n.length;++r)n[r]>e&&(e=n[r]);return e},H=function(n,e,r){var t=e/8|0;return(n[t]|n[t+1]<<8)>>(e&7)&r},Te=function(n,e){var r=e/8|0;return(n[r]|n[r+1]<<8|n[r+2]<<16)>>(e&7)},Ir=function(n){return(n+7)/8|0},Pr=function(n,e,r){(e==null||e<0)&&(e=0),(r==null||r>n.length)&&(r=n.length);var t=new V(r-e);return t.set(n.subarray(e,r)),t},jr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],j=function(n,e,r){var t=new Error(e||jr[n]);if(t.code=n,Error.captureStackTrace&&Error.captureStackTrace(t,j),!r)throw t;return t},Ce=function(n,e,r,t){var s=n.length,o=t?t.length:0;if(!s||e.f&&!e.l)return r||new V(0);var i=!r||e.i!=2,a=e.i;r||(r=new V(s*3));var l=function(Ie){var Pe=r.length;if(Ie>Pe){var je=new V(Math.max(Pe*2,Ie));je.set(r),r=je}},u=e.f||0,f=e.p||0,c=e.b||0,w=e.l,m=e.d,g=e.m,_=e.n,y=s*8;do{if(!w){u=H(n,f,1);var p=H(n,f+1,3);if(f+=3,p)if(p==1)w=Nr,m=Or,g=9,_=5;else if(p==2){var v=H(n,f,31)+257,M=H(n,f+10,15)+4,A=v+H(n,f+5,31)+1;f+=14;for(var N=new V(A),R=new V(19),I=0;I<M;++I)R[Cr[I]]=H(n,f+I*3,7);f+=M*3;for(var Be=ke(R),yt=(1<<Be)-1,bt=he(R,Be,1),I=0;I<A;){var ze=bt[H(n,f,yt)];f+=ze&15;var h=ze>>4;if(h<16)N[I++]=h;else{var X=0,ge=0;for(h==16?(ge=3+H(n,f,3),f+=2,X=N[I-1]):h==17?(ge=3+H(n,f,7),f+=3):h==18&&(ge=11+H(n,f,127),f+=7);ge--;)N[I++]=X}}var Ae=N.subarray(0,v),Z=N.subarray(v);g=ke(Ae),_=ke(Z),w=he(Ae,g,1),m=he(Z,_,1)}else j(1);else{var h=Ir(f)+4,b=n[h-4]|n[h-3]<<8,C=h+b;if(C>s){a&&j(0);break}i&&l(c+b),r.set(n.subarray(h,C),c),e.b=c+=b,e.p=f=C*8,e.f=u;continue}if(f>y){a&&j(0);break}}i&&l(c+131072);for(var kt=(1<<g)-1,Tt=(1<<_)-1,we=f;;we=f){var X=w[Te(n,f)&kt],ee=X>>4;if(f+=X&15,f>y){a&&j(0);break}if(X||j(2),ee<256)r[c++]=ee;else if(ee==256){we=f,w=null;break}else{var Ne=ee-254;if(ee>264){var I=ee-257,ae=at[I];Ne=H(n,f,(1<<ae)-1)+mt[I],f+=ae}var ve=m[Te(n,f)&Tt],ye=ve>>4;ve||j(3),f+=ve&15;var Z=Ar[ye];if(ye>3){var ae=ft[ye];Z+=Te(n,f)&(1<<ae)-1,f+=ae}if(f>y){a&&j(0);break}i&&l(c+131072);var be=c+Ne;if(c<Z){var Oe=o-Z,Lt=Math.min(Z,be);for(Oe+c<0&&j(3);c<Lt;++c)r[c]=t[Oe+c]}for(;c<be;c+=4)r[c]=r[c-Z],r[c+1]=r[c+1-Z],r[c+2]=r[c+2-Z],r[c+3]=r[c+3-Z];c=be}}e.l=w,e.p=we,e.b=c,e.f=u,w&&(u=1,e.m=g,e.d=m,e.n=_)}while(!u);return c==r.length?r:Pr(r,0,c)},Vr=new V(0),Zr=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&j(6,"invalid gzip data");var e=n[3],r=10;e&4&&(r+=(n[10]|n[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!n[r++]);return r+(e&2)},Hr=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},xr=function(n,e){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&j(6,"invalid zlib data"),(n[1]>>5&1)==+!e&&j(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function Fr(n,e){return Ce(n,{i:2},e&&e.out,e&&e.dictionary)}function Rr(n,e){var r=Zr(n);return r+8>n.length&&j(6,"invalid gzip data"),Ce(n.subarray(r,-8),{i:2},e&&e.out||new V(Hr(n)),e&&e.dictionary)}function Kr(n,e){return Ce(n.subarray(xr(n,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Se(n,e){return n[0]==31&&n[1]==139&&n[2]==8?Rr(n,e):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?Fr(n,e):Kr(n,e)}var Gr=typeof TextDecoder<"u"&&new TextDecoder,Jr=0;try{Gr.decode(Vr,{stream:!0}),Jr=1}catch{}var pt=(n,e)=>n*Math.pow(2,e),fe=(n,e)=>Math.floor(n/Math.pow(2,e)),$e=(n,e)=>pt(n.getUint16(e+1,!0),8)+n.getUint8(e),gt=(n,e)=>pt(n.getUint32(e+2,!0),16)+n.getUint16(e,!0),qr=(n,e,r,t,s)=>{if(n!=t.getUint8(s))return n-t.getUint8(s);const o=$e(t,s+1);if(e!=o)return e-o;const i=$e(t,s+4);return r!=i?r-i:0},Wr=(n,e,r,t)=>{const s=dt(n,e|128,r,t);return s?{z:e,x:r,y:t,offset:s[0],length:s[1],is_dir:!0}:null},Re=(n,e,r,t)=>{const s=dt(n,e,r,t);return s?{z:e,x:r,y:t,offset:s[0],length:s[1],is_dir:!1}:null},dt=(n,e,r,t)=>{let s=0,o=n.byteLength/17-1;for(;s<=o;){const i=o+s>>1,a=qr(e,r,t,n,i*17);if(a>0)s=i+1;else if(a<0)o=i-1;else return[gt(n,i*17+7),n.getUint32(i*17+13,!0)]}return null},Yr=(n,e)=>n.is_dir&&!e.is_dir?1:!n.is_dir&&e.is_dir?-1:n.z!==e.z?n.z-e.z:n.x!==e.x?n.x-e.x:n.y-e.y,$t=(n,e)=>{const r=n.getUint8(e*17);return{z:r&127,x:$e(n,e*17+1),y:$e(n,e*17+4),offset:gt(n,e*17+7),length:n.getUint32(e*17+13,!0),is_dir:r>>7===1}},Ke=n=>{const e=[],r=new DataView(n);for(let t=0;t<r.byteLength/17;t++)e.push($t(r,t));return Qr(e)},Qr=n=>{n.sort(Yr);const e=new ArrayBuffer(17*n.length),r=new Uint8Array(e);for(let t=0;t<n.length;t++){const s=n[t];let o=s.z;s.is_dir&&(o=o|128),r[t*17]=o,r[t*17+1]=s.x&255,r[t*17+2]=s.x>>8&255,r[t*17+3]=s.x>>16&255,r[t*17+4]=s.y&255,r[t*17+5]=s.y>>8&255,r[t*17+6]=s.y>>16&255,r[t*17+7]=s.offset&255,r[t*17+8]=fe(s.offset,8)&255,r[t*17+9]=fe(s.offset,16)&255,r[t*17+10]=fe(s.offset,24)&255,r[t*17+11]=fe(s.offset,32)&255,r[t*17+12]=fe(s.offset,48)&255,r[t*17+13]=s.length&255,r[t*17+14]=s.length>>8&255,r[t*17+15]=s.length>>16&255,r[t*17+16]=s.length>>24&255}return e},Xr=(n,e)=>{if(n.byteLength<17)return null;const r=n.byteLength/17,t=$t(n,r-1);if(t.is_dir){const s=t.z,o=e.z-s,i=Math.trunc(e.x/(1<<o)),a=Math.trunc(e.y/(1<<o));return{z:s,x:i,y:a}}return null};function en(n){return P(this,null,function*(){const e=yield n.getBytes(0,512e3),r=new DataView(e.data),t=r.getUint32(4,!0),s=r.getUint16(8,!0),o=new TextDecoder("utf-8"),i=JSON.parse(o.decode(new DataView(e.data,10,t)));let a=0;i.compression==="gzip"&&(a=2);let l=0;"minzoom"in i&&(l=+i.minzoom);let u=0;"maxzoom"in i&&(u=+i.maxzoom);let f=0,c=0,w=0,m=-180,g=-85,_=180,y=85;if(i.bounds){const h=i.bounds.split(",");m=+h[0],g=+h[1],_=+h[2],y=+h[3]}if(i.center){const h=i.center.split(",");f=+h[0],c=+h[1],w=+h[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:a,tileType:1,minZoom:l,maxZoom:u,minLon:m,minLat:g,maxLon:_,maxLat:y,centerZoom:w,centerLon:f,centerLat:c,etag:e.etag}})}function tn(n,e,r,t,s,o,i){return P(this,null,function*(){let a=yield r.getArrayBuffer(e,n.rootDirectoryOffset,n.rootDirectoryLength,n);n.specVersion===1&&(a=Ke(a));const l=Re(new DataView(a),t,s,o);if(l){let c=(yield e.getBytes(l.offset,l.length,i)).data;const w=new DataView(c);return w.getUint8(0)==31&&w.getUint8(1)==139&&(c=Se(new Uint8Array(c))),{data:c}}const u=Xr(new DataView(a),{z:t,x:s,y:o});if(u){const f=Wr(new DataView(a),u.z,u.x,u.y);if(f){let c=yield r.getArrayBuffer(e,f.offset,f.length,n);n.specVersion===1&&(c=Ke(c));const w=Re(new DataView(c),t,s,o);if(w){let g=(yield e.getBytes(w.offset,w.length,i)).data;const _=new DataView(g);return _.getUint8(0)==31&&_.getUint8(1)==139&&(g=Se(new Uint8Array(g))),{data:g}}}}})}var _t={getHeader:en,getZxy:tn},rn=class{constructor(){this.tile=(n,e)=>{if(n.type=="json"){const r=n.url.substr(10);let t=this.tiles.get(r);return t||(t=new Ge(r),this.tiles.set(r,t)),t.getHeader().then(s=>{const o={tiles:[n.url+"/{z}/{x}/{y}"],minzoom:s.minZoom,maxzoom:s.maxZoom,bounds:[s.minLon,s.minLat,s.maxLon,s.maxLat]};e(null,o,null,null)}).catch(s=>{e(s,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=n.url.match(r);if(!t)throw new Error("Invalid PMTiles protocol URL");const s=t[1];let o=this.tiles.get(s);o||(o=new Ge(s),this.tiles.set(s,o));const i=t[2],a=t[3],l=t[4],u=new AbortController,f=u.signal;let c=()=>{u.abort()};return o.getHeader().then(w=>{o.getZxy(+i,+a,+l,f).then(m=>{m?e(null,new Uint8Array(m.data),m.cacheControl,m.expires):w.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(m=>{m.name!=="AbortError"&&e(m,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(n){this.tiles.set(n.source.getKey(),n)}get(n){return this.tiles.get(n)}};function te(n,e){return(e>>>0)*4294967296+(n>>>0)}function nn(n,e){const r=e.buf;let t,s;if(s=r[e.pos++],t=(s&112)>>4,s<128||(s=r[e.pos++],t|=(s&127)<<3,s<128)||(s=r[e.pos++],t|=(s&127)<<10,s<128)||(s=r[e.pos++],t|=(s&127)<<17,s<128)||(s=r[e.pos++],t|=(s&127)<<24,s<128)||(s=r[e.pos++],t|=(s&1)<<31,s<128))return te(n,t);throw new Error("Expected varint not more than 10 bytes")}function ue(n){const e=n.buf;let r,t;return t=e[n.pos++],r=t&127,t<128||(t=e[n.pos++],r|=(t&127)<<7,t<128)||(t=e[n.pos++],r|=(t&127)<<14,t<128)||(t=e[n.pos++],r|=(t&127)<<21,t<128)?r:(t=e[n.pos],r|=(t&15)<<28,nn(r,n))}function sn(n,e,r,t){if(t==0){r==1&&(e[0]=n-1-e[0],e[1]=n-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}var on=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function ln(n,e,r){if(n>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,n)-1||r>Math.pow(2,n)-1)throw Error("tile x/y outside zoom level bounds");const t=on[n],s=Math.pow(2,n);let o=0,i=0,a=0;const l=[e,r];let u=s/2;for(;u>0;)o=(l[0]&u)>0?1:0,i=(l[1]&u)>0?1:0,a+=u*u*(3*o^i),sn(u,l,o,i),u=u/2;return t+a}function wt(n,e){return P(this,null,function*(){if(e===1||e===0)return n;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Se(new Uint8Array(n));{let t=new Response(n).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var an=127;function fn(n,e){let r=0,t=n.length-1;for(;r<=t;){const s=t+r>>1,o=e-n[s].tileId;if(o>0)r=s+1;else if(o<0)t=s-1;else return n[s]}return t>=0&&(n[t].runLength===0||e-n[t].tileId<n[t].runLength)?n[t]:null}var un=class{constructor(n){this.url=n}getKey(){return this.url}getBytes(n,e,r){return P(this,null,function*(){let t;r||(t=new AbortController,r=t.signal);let s=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+n+"-"+(n+e-1)}});if(s.status===416&&n===0){const a=s.headers.get("Content-Range");if(!a||!a.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const l=+a.substr(8);s=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(l-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const o=s.headers.get("Content-Length");if(s.status===200&&(!o||+o>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function x(n,e){const r=n.getUint32(e+4,!0),t=n.getUint32(e+0,!0);return r*Math.pow(2,32)+t}function cn(n,e){const r=new DataView(n),t=r.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:x(r,8),rootDirectoryLength:x(r,16),jsonMetadataOffset:x(r,24),jsonMetadataLength:x(r,32),leafDirectoryOffset:x(r,40),leafDirectoryLength:x(r,48),tileDataOffset:x(r,56),tileDataLength:x(r,64),numAddressedTiles:x(r,72),numTileEntries:x(r,80),numTileContents:x(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function vt(n){const e={buf:new Uint8Array(n),pos:0},r=ue(e),t=[];let s=0;for(let o=0;o<r;o++){const i=ue(e);t.push({tileId:s+i,offset:0,length:0,runLength:1}),s+=i}for(let o=0;o<r;o++)t[o].runLength=ue(e);for(let o=0;o<r;o++)t[o].length=ue(e);for(let o=0;o<r;o++){const i=ue(e);i===0&&o>0?t[o].offset=t[o-1].offset+t[o-1].length:t[o].offset=i-1}return t}function mn(n){const e=new DataView(n);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ne=class extends Error{};function hn(n,e,r,t){return P(this,null,function*(){const s=yield n.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(mn(s.data)<3)return[yield _t.getHeader(n)];const i=s.data.slice(0,an);let a=s.etag;t&&s.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+n.getKey()),a=void 0);const l=cn(i,a);if(r){const u=s.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),f=n.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,c=vt(yield e(u,l.internalCompression));return[l,[f,c.length,c]]}return[l,void 0]})}function pn(n,e,r,t,s){return P(this,null,function*(){const o=yield n.getBytes(r,t);if(s.etag&&s.etag!==o.etag)throw new ne(o.etag);const i=yield e(o.data,s.internalCompression),a=vt(i);if(a.length===0)throw new Error("Empty directory is invalid");return a})}var gn=class{constructor(n=100,e=!0,r=wt){this.cache=new Map,this.maxCacheEntries=n,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(n,e){return P(this,null,function*(){const r=n.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const t=new Promise((s,o)=>{hn(n,this.decompress,this.prefetch,e).then(i=>{i[1]&&this.cache.set(i[1][0],{lastUsed:this.counter++,data:Promise.resolve(i[1][2])}),s(i[0]),this.prune()}).catch(i=>{o(i)})});return this.cache.set(r,{lastUsed:this.counter++,data:t}),t})}getDirectory(n,e,r,t){return P(this,null,function*(){const s=n.getKey()+"|"+(t.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((i,a)=>{pn(n,this.decompress,e,r,t).then(l=>{i(l),this.prune()}).catch(l=>{a(l)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(n,e,r,t){return P(this,null,function*(){const s=n.getKey()+"|"+(t.etag||"")+"|"+e+"|"+r;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((i,a)=>{n.getBytes(e,r).then(l=>{if(t.etag&&t.etag!==l.etag)throw new ne(l.etag);i(l.data),this.cache.has(s),this.prune()}).catch(l=>{a(l)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let n=1/0,e;this.cache.forEach((r,t)=>{r.lastUsed<n&&(n=r.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(n,e){return P(this,null,function*(){this.cache.delete(n.getKey()),yield this.getHeader(n,e)})}},Ge=class{constructor(n,e,r){typeof n=="string"?this.source=new un(n):this.source=n,r?this.decompress=r:this.decompress=wt,e?this.cache=e:this.cache=new gn}getHeader(){return P(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(n,e,r,t){return P(this,null,function*(){const s=ln(n,e,r),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return _t.getZxy(o,this.source,this.cache,n,e,r,t);if(n<o.minZoom||n>o.maxZoom)return;let i=o.rootDirectoryOffset,a=o.rootDirectoryLength;for(let l=0;l<=3;l++){const u=yield this.cache.getDirectory(this.source,i,a,o),f=fn(u,s);if(f)if(f.runLength>0){const c=yield this.source.getBytes(o.tileDataOffset+f.offset,f.length,t);if(o.etag&&o.etag!==c.etag)throw new ne(c.etag);return{data:yield this.decompress(c.data,o.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else i=o.leafDirectoryOffset+f.offset,a=f.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(n,e,r,t){return P(this,null,function*(){try{return yield this.getZxyAttempt(n,e,r,t)}catch(s){if(s instanceof ne)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(n,e,r,t);throw s}})}getMetadataAttempt(){return P(this,null,function*(){const n=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(n.jsonMetadataOffset,n.jsonMetadataLength);if(n.etag&&n.etag!==e.etag)throw new ne(e.etag);const r=yield this.decompress(e.data,n.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(r))})}getMetadata(){return P(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(n){if(n instanceof ne)return this.cache.invalidate(this.source,n.message),yield this.getMetadataAttempt();throw n}})}};function dn(n){return Ue(()=>{let e=new rn;Ze.addProtocol("pmtiles",e.tile)}),rt(()=>{Ze.removeProtocol("pmtiles")}),[]}class $n extends q{constructor(e){super(),W(this,e,dn,null,Y,{})}}function Je(n,e,r){const t=n.slice();return t[15]=e[r],t}function _n(n){let e;return{c(){e=E("Home")},m(r,t){k(r,e,t)},d(r){r&&T(e)}}}function qe(n){let e,r;return e=new Vt({props:{errorMessage:n[1]}}),{c(){L(e.$$.fragment)},m(t,s){S(e,t,s),r=!0},p(t,s){const o={};s&2&&(o.errorMessage=t[1]),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){U(e,t)}}}function We(n){let e,r,t,s;function o(l){n[10](l)}function i(l){n[11](l)}let a={schemes:n[2]};return n[3]!==void 0&&(a.schemesToBeShown=n[3]),n[4]!==void 0&&(a.filterText=n[4]),e=new rr({props:a}),oe.push(()=>ie(e,"schemesToBeShown",o)),oe.push(()=>ie(e,"filterText",i)),{c(){L(e.$$.fragment)},m(l,u){S(e,l,u),s=!0},p(l,u){const f={};u&4&&(f.schemes=l[2]),!r&&u&8&&(r=!0,f.schemesToBeShown=l[3],le(()=>r=!1)),!t&&u&16&&(t=!0,f.filterText=l[4],le(()=>t=!1)),e.$set(f)},i(l){s||(d(e.$$.fragment,l),s=!0)},o(l){$(e.$$.fragment,l),s=!1},d(l){U(e,l)}}}function Ye(n){let e,r,t=xe(n[2].values()),s=[];for(let i=0;i<t.length;i+=1)s[i]=Xe(Je(n,t,i));const o=i=>$(s[i],1,1,()=>{s[i]=null});return{c(){e=O("ul");for(let i=0;i<s.length;i+=1)s[i].c()},m(i,a){k(i,e,a);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);r=!0},p(i,a){if(a&13){t=xe(i[2].values());let l;for(l=0;l<t.length;l+=1){const u=Je(i,t,l);s[l]?(s[l].p(u,a),d(s[l],1)):(s[l]=Xe(u),s[l].c(),d(s[l],1),s[l].m(e,null))}for(ce(),l=t.length;l<s.length;l+=1)o(l);me()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)d(s[a]);r=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)$(s[a]);r=!1},d(i){i&&T(e),Zt(s,i)}}}function Qe(n){let e,r;return e=new Lr({props:{scheme:n[15],authorityNames:n[0]}}),{c(){L(e.$$.fragment)},m(t,s){S(e,t,s),r=!0},p(t,s){const o={};s&4&&(o.scheme=t[15]),s&1&&(o.authorityNames=t[0]),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){U(e,t)}}}function Xe(n){let e=n[3].has(n[15].scheme_reference),r,t,s=e&&Qe(n);return{c(){s&&s.c(),r=Ht()},m(o,i){s&&s.m(o,i),k(o,r,i),t=!0},p(o,i){i&12&&(e=o[3].has(o[15].scheme_reference)),e?s?(s.p(o,i),i&12&&d(s,1)):(s=Qe(o),s.c(),d(s,1),s.m(r.parentNode,r)):s&&(ce(),$(s,1,1,()=>{s=null}),me())},i(o){t||(d(s),t=!0)},o(o){$(s),t=!1},d(o){o&&T(r),s&&s.d(o)}}}function wn(n){let e,r,t,s,o,i,a,l,u,f,c,w,m;r=new de({props:{$$slots:{default:[_n]},$$scope:{ctx:n}}}),r.$on("click",n[9]),a=new Ft({props:{boundaryGeojson:n[5]}});let g=n[1]&&qe(n);f=new Nt({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:n[7]}});let _=n[2].size>0&&We(n),y=n[0]&&Ye(n);return{c(){e=O("div"),L(r.$$.fragment),t=z(),s=O("div"),o=O("h1"),o.textContent="Browse schemes",i=z(),L(a.$$.fragment),l=z(),g&&g.c(),u=z(),L(f.$$.fragment),c=z(),_&&_.c(),w=z(),y&&y.c(),He(s,"display","flex"),He(s,"justify-content","space-between"),F(e,"slot","sidebar"),F(e,"class","govuk-prose")},m(p,h){k(p,e,h),S(r,e,null),D(e,t),D(e,s),D(s,o),D(s,i),S(a,s,null),D(e,l),g&&g.m(e,null),D(e,u),S(f,e,null),D(e,c),_&&_.m(e,null),D(e,w),y&&y.m(e,null),m=!0},p(p,h){const b={};h&262144&&(b.$$scope={dirty:h,ctx:p}),r.$set(b);const C={};h&32&&(C.boundaryGeojson=p[5]),a.$set(C),p[1]?g?(g.p(p,h),h&2&&d(g,1)):(g=qe(p),g.c(),d(g,1),g.m(e,u)):g&&(ce(),$(g,1,1,()=>{g=null}),me()),p[2].size>0?_?(_.p(p,h),h&4&&d(_,1)):(_=We(p),_.c(),d(_,1),_.m(e,w)):_&&(ce(),$(_,1,1,()=>{_=null}),me()),p[0]?y?(y.p(p,h),h&1&&d(y,1)):(y=Ye(p),y.c(),d(y,1),y.m(e,null)):y&&(ce(),$(y,1,1,()=>{y=null}),me())},i(p){m||(d(r.$$.fragment,p),d(a.$$.fragment,p),d(g),d(f.$$.fragment,p),d(_),d(y),m=!0)},o(p){$(r.$$.fragment,p),$(a.$$.fragment,p),$(g),$(f.$$.fragment,p),$(_),$(y),m=!1},d(p){p&&T(e),U(r),U(a),g&&g.d(),U(f),_&&_.d(),y&&y.d()}}}function vn(n){let e,r,t,s,o,i;return e=new Mr({}),t=new cr({}),o=new wr({}),{c(){L(e.$$.fragment),r=z(),L(t.$$.fragment),s=z(),L(o.$$.fragment)},m(a,l){S(e,a,l),k(a,r,l),S(t,a,l),k(a,s,l),S(o,a,l),i=!0},i(a){i||(d(e.$$.fragment,a),d(t.$$.fragment,a),d(o.$$.fragment,a),i=!0)},o(a){$(e.$$.fragment,a),$(t.$$.fragment,a),$(o.$$.fragment,a),i=!1},d(a){a&&(T(r),T(s)),U(e,a),U(t,a),U(o,a)}}}function yn(n){let e,r,t,s;return e=new Jt({props:{style:n[6]}}),t=new qt({props:{small:!0,$$slots:{default:[vn]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment),r=z(),L(t.$$.fragment)},m(o,i){S(e,o,i),k(o,r,i),S(t,o,i),s=!0},p(o,i){const a={};i&262144&&(a.$$scope={dirty:i,ctx:o}),t.$set(a)},i(o){s||(d(e.$$.fragment,o),d(t.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),s=!1},d(o){o&&T(r),U(e,o),U(t,o)}}}function bn(n){let e,r,t,s,o,i,a;return e=new Kt({props:{colorInterventions:Gt("v1")}}),t=new De({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:n[8]}}),i=new Ee({props:{label:"Layers",open:!0,$$slots:{default:[yn]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment),r=z(),L(t.$$.fragment),s=z(),o=O("div"),L(i.$$.fragment),F(o,"class","top-right svelte-nlvvhu")},m(l,u){S(e,l,u),k(l,r,u),S(t,l,u),k(l,s,u),k(l,o,u),S(i,o,null),a=!0},p(l,u){const f={};u&262144&&(f.$$scope={dirty:u,ctx:l}),i.$set(f)},i(l){a||(d(e.$$.fragment,l),d(t.$$.fragment,l),d(i.$$.fragment,l),a=!0)},o(l){$(e.$$.fragment,l),$(t.$$.fragment,l),$(i.$$.fragment,l),a=!1},d(l){l&&(T(r),T(s),T(o)),U(e,l),U(t,l),U(i)}}}function kn(n){let e,r,t,s,o;return r=new $n({}),s=new Rt({props:{style:n[6],$$slots:{default:[bn]},$$scope:{ctx:n}}}),{c(){e=O("div"),L(r.$$.fragment),t=z(),L(s.$$.fragment),F(e,"slot","main")},m(i,a){k(i,e,a),S(r,e,null),D(e,t),S(s,e,null),o=!0},p(i,a){const l={};a&262144&&(l.$$scope={dirty:a,ctx:i}),s.$set(l)},i(i){o||(d(r.$$.fragment,i),d(s.$$.fragment,i),o=!0)},o(i){$(r.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&T(e),U(r),U(s)}}}function Tn(n){let e,r;return e=new xt({props:{$$slots:{main:[kn],sidebar:[wn]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(t,s){S(e,t,s),r=!0},p(t,[s]){const o={};s&262207&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){U(e,t)}}}function Ln(n,e,r){let t,s;Q(n,_e,h=>r(12,t=h)),Q(n,se,h=>r(5,s=h));let o=null;Ue(async()=>{Ot();let h=await It();r(0,o=new Set(h.features.map(b=>b.properties.name)))});let a=new URLSearchParams(window.location.search).get("style")||"streets",l="",u=new Map,f=new Set,c="";rt(()=>{se.set(Pt())});function w(h){try{let b=JSON.parse(h);r(2,u=Wt(b)),se.set(b),r(1,l=""),t==null||t.fitBounds(tt(b),{padding:20,animate:!1})}catch(b){r(1,l=`Couldn't load schemes from a file: ${b}`)}}function m(h){var b='<div style="max-width: 30vw;">';return b+=`<h2>${g(h.name)} (${h.intervention_type})</h2>`,b+=`<p>Scheme reference: ${h.scheme_reference}</p>`,h.length_meters&&(b+=`<p>Length: ${jt(h.length_meters)}</p>`),h.description&&(b+=`<p>${g(h.description)}</p>`),b+="</div>",b}function g(h){return c?h.replace(new RegExp(c,"gi"),b=>`<mark>${b}</mark>`):h}const _=()=>window.open("index.html");function y(h){f=h,r(3,f)}function p(h){c=h,r(4,c)}return[o,l,u,f,c,s,a,w,m,_,y,p]}class Sn extends q{constructor(e){super(),W(this,e,Ln,Tn,Y,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Sn({target:document.getElementById("app")});
