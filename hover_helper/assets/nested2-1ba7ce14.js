import{S as K,i as G,s as q,g as y,f as B,e as z,u as U,m as b,j as d,k as C,U as Y,t as h,l as $,p as _,q as k,_ as Q,a2 as ue,r as Ee,b as ee,c as te,F as At,o as ne,a as ye,h as R,v as qe,w as zt,I as ce,C as pe,aW as Ae,a1 as at,G as ze,H as Pt,L as Ot,M as Nt,N as It,aV as re,az as Ft,a7 as ft,x as ut,D as ct,aX as Je,ag as pt,d as jt,X as We,y as $e,n as de,z as Vt,A as Ht,a9 as Zt,aP as Rt,E as xt,V as Xe,W as Kt,ad as Gt}from"./data_getter-b1ef8a45.js";import{C as Pe,S as Ce,d as Oe,j as Ne,H as Ie,h as qt,i as Ye,g as mt,L as Jt,Z as Wt,M as Xt,I as Yt,b as Qt,B as en}from"./Map-bddfa3a8.js";function tn(r){let e=new Map;for(let[t,s]of Object.entries(r.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:s.authority_or_region,capital_scheme_id:s.capital_scheme_id,funding_programme:s.funding_programme});let n=1;for(let t of r.features){let s=e.get(t.properties.scheme_reference);s.num_features++,t.properties.funding_programme=s.funding_programme,t.id=n++}return e}function nn(r){let e;return{c(){e=U("Clear")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function rn(r){let e,n,t,s,o,l;return t=new ye({props:{$$slots:{default:[nn]},$$scope:{ctx:r}}}),t.$on("click",r[11]),{c(){e=z("input"),n=B(),y(t.$$.fragment),R(e,"type","text"),R(e,"class","govuk-input govuk-input--width-10"),R(e,"id","filterText")},m(u,i){d(u,e,i),qe(e,r[0]),d(u,n,i),b(t,u,i),s=!0,o||(l=zt(e,"input",r[10]),o=!0)},p(u,i){i&1&&e.value!==u[0]&&qe(e,u[0]);const f={};i&16384&&(f.$$scope={dirty:i,ctx:u}),t.$set(f)},i(u){s||(h(t.$$.fragment,u),s=!0)},o(u){$(t.$$.fragment,u),s=!1},d(u){u&&(_(e),_(n)),k(t,u),o=!1,l()}}}function sn(r){let e,n,t,s,o,l,u,i;function f(p){r[8](p)}let a={label:"Authority or region",id:"filterAuthority",choices:r[4],emptyOption:!0};r[2]!==void 0&&(a.value=r[2]),e=new Ce({props:a}),ee.push(()=>te(e,"value",f));function c(p){r[9](p)}let m={label:"Funding programme",id:"filterFundingProgramme",choices:r[5],emptyOption:!0};return r[3]!==void 0&&(m.value=r[3]),s=new Ce({props:m}),ee.push(()=>te(s,"value",c)),u=new At({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[rn]},$$scope:{ctx:r}}}),{c(){y(e.$$.fragment),t=B(),y(s.$$.fragment),l=B(),y(u.$$.fragment)},m(p,w){b(e,p,w),d(p,t,w),b(s,p,w),d(p,l,w),b(u,p,w),i=!0},p(p,w){const T={};w&16&&(T.choices=p[4]),!n&&w&4&&(n=!0,T.value=p[2],ne(()=>n=!1)),e.$set(T);const S={};w&32&&(S.choices=p[5]),!o&&w&8&&(o=!0,S.value=p[3],ne(()=>o=!1)),s.$set(S);const g={};w&16385&&(g.$$scope={dirty:w,ctx:p}),u.$set(g)},i(p){i||(h(e.$$.fragment,p),h(s.$$.fragment,p),h(u.$$.fragment,p),i=!0)},o(p){$(e.$$.fragment,p),$(s.$$.fragment,p),$(u.$$.fragment,p),i=!1},d(p){p&&(_(t),_(l)),k(e,p),k(s,p),k(u,p)}}}function on(r){let e,n,t,s,o=r[1].size+"",l,u,i=r[6].route+"",f,a,c=r[6].area+"",m,p,w=r[6].crossing+"",T,S,g=r[6].other+"",v,L,M;return e=new Pe({props:{label:"Filters",$$slots:{default:[sn]},$$scope:{ctx:r}}}),{c(){y(e.$$.fragment),n=B(),t=z("p"),s=U("Showing "),l=U(o),u=U(" schemes ("),f=U(i),a=U(" routes, "),m=U(c),p=U(` areas,
  `),T=U(w),S=U(" crossings, "),v=U(g),L=U(" other)")},m(D,E){b(e,D,E),d(D,n,E),d(D,t,E),C(t,s),C(t,l),C(t,u),C(t,f),C(t,a),C(t,m),C(t,p),C(t,T),C(t,S),C(t,v),C(t,L),M=!0},p(D,[E]){const P={};E&16445&&(P.$$scope={dirty:E,ctx:D}),e.$set(P),(!M||E&2)&&o!==(o=D[1].size+"")&&Y(l,o),(!M||E&64)&&i!==(i=D[6].route+"")&&Y(f,i),(!M||E&64)&&c!==(c=D[6].area+"")&&Y(m,c),(!M||E&64)&&w!==(w=D[6].crossing+"")&&Y(T,w),(!M||E&64)&&g!==(g=D[6].other+"")&&Y(v,g)},i(D){M||(h(e.$$.fragment,D),M=!0)},o(D){$(e.$$.fragment,D),M=!1},d(D){D&&(_(n),_(t)),k(e,D)}}}function ln(r,e,n){let t;Q(r,ue,g=>n(12,t=g));let{schemes:s}=e,{schemesToBeShown:o=new Set}=e,{filterText:l=""}=e,u=[],i="",f=[],a="",c={area:0,route:0,crossing:0,other:0};Ee(()=>{let g=new Set,v=new Set;for(let L of s.values())L.authority_or_region&&g.add(L.authority_or_region),L.funding_programme&&v.add(L.funding_programme);n(4,u=Array.from(g.entries())),u.sort(),n(5,f=Array.from(v.entries())),f.sort()});function m(g,v,L){let M=g.toLowerCase(),D=P=>{var O,J;if(M&&!((O=P.properties.name)!=null&&O.toLowerCase().includes(M))&&!((J=P.properties.description)!=null&&J.toLowerCase().includes(M)))return!1;if(v||L){let N=s.get(P.properties.scheme_reference);if(v&&N.authority_or_region!=v||L&&N.funding_programme!=L)return!1}return!0};n(1,o=new Set(t.features.filter(D).map(P=>P.properties.scheme_reference))),n(6,c={area:0,route:0,crossing:0,other:0});let E=P=>{var O,J;return!(!o.has(P.properties.scheme_reference)||M&&!((O=P.properties.name)!=null&&O.toLowerCase().includes(M))&&!((J=P.properties.description)!=null&&J.toLowerCase().includes(M)))};ue.update(P=>{for(let O of P.features)E(O)?(delete O.properties.hide_while_editing,n(6,c[O.properties.intervention_type]++,c)):O.properties.hide_while_editing=!0;return P}),n(6,c)}function p(g){i=g,n(2,i)}function w(g){a=g,n(3,a)}function T(){l=this.value,n(0,l)}const S=()=>n(0,l="");return r.$$set=g=>{"schemes"in g&&n(7,s=g.schemes),"schemesToBeShown"in g&&n(1,o=g.schemesToBeShown),"filterText"in g&&n(0,l=g.filterText)},r.$$.update=()=>{r.$$.dirty&13&&m(l,i,a)},[l,o,i,a,u,f,c,s,p,w,T,S]}class an extends K{constructor(e){super(),G(this,e,ln,on,q,{schemes:7,schemesToBeShown:1,filterText:0})}}const X={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",parliamentary_constituencies:"#006E59",atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function fn(r){let e,n,t,s;return e=new Ne({props:{color:r[3]}}),{c(){y(e.$$.fragment),n=B(),t=U(r[1])},m(o,l){b(e,o,l),d(o,n,l),d(o,t,l),s=!0},p(o,l){(!s||l&2)&&Y(t,o[1])},i(o){s||(h(e.$$.fragment,o),s=!0)},o(o){$(e.$$.fragment,o),s=!1},d(o){o&&(_(n),_(t)),k(e,o)}}}function un(r){let e;const n=r[6].default,t=Pt(n,r,r[8],null);return{c(){t&&t.c()},m(s,o){t&&t.m(s,o),e=!0},p(s,o){t&&t.p&&(!e||o&256)&&Ot(t,n,s,s[8],e?It(n,s[8],o,null):Nt(s[8]),null)},i(s){e||(h(t,s),e=!0)},o(s){$(t,s),e=!1},d(s){t&&t.d(s)}}}function cn(r){let e,n,t;return n=new Ie({props:{$$slots:{default:[un]},$$scope:{ctx:r}}}),{c(){e=z("span"),y(n.$$.fragment),R(e,"slot","right")},m(s,o){d(s,e,o),b(n,e,null),t=!0},p(s,o){const l={};o&256&&(l.$$scope={dirty:o,ctx:s}),n.$set(l)},i(s){t||(h(n.$$.fragment,s),t=!0)},o(s){$(n.$$.fragment,s),t=!1},d(s){s&&_(e),k(n)}}}function pn(r){let e,n,t,s,o;function l(i){r[7](i)}let u={id:r[0],$$slots:{right:[cn],default:[fn]},$$scope:{ctx:r}};return r[2]!==void 0&&(u.checked=r[2]),e=new Oe({props:u}),ee.push(()=>te(e,"checked",l)),s=new ce({props:{layer:r[0],tooltip:r[4],show:r[2]}}),{c(){y(e.$$.fragment),t=B(),y(s.$$.fragment)},m(i,f){b(e,i,f),d(i,t,f),b(s,i,f),o=!0},p(i,[f]){const a={};f&1&&(a.id=i[0]),f&258&&(a.$$scope={dirty:f,ctx:i}),!n&&f&4&&(n=!0,a.checked=i[2],ne(()=>n=!1)),e.$set(a);const c={};f&1&&(c.layer=i[0]),f&4&&(c.show=i[2]),s.$set(c)},i(i){o||(h(e.$$.fragment,i),h(s.$$.fragment,i),o=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&_(t),k(e,i),k(s,i)}}}function mn(r,e,n){let t;Q(r,pe,p=>n(9,t=p));let{$$slots:s={},$$scope:o}=e,{name:l}=e,{singularNoun:u}=e,{pluralNoun:i}=e,f=X[l];Ae(t,l,`https://atip.uk/layers/v1/${l}.pmtiles`),at(t,{id:l,source:l,sourceLayer:l,color:f,opacity:ze(1,.7)});let a=!1;function c(p){return`<p>${p.properties.name??`Unnamed ${u}`}</p>`}function m(p){a=p,n(2,a)}return r.$$set=p=>{"name"in p&&n(0,l=p.name),"singularNoun"in p&&n(5,u=p.singularNoun),"pluralNoun"in p&&n(1,i=p.pluralNoun),"$$scope"in p&&n(8,o=p.$$scope)},[l,i,a,f,c,u,s,m,o]}class ht extends K{constructor(e){super(),G(this,e,mn,pn,q,{name:0,singularNoun:5,pluralNoun:1})}}function hn(r){let e;return{c(){e=U("hospital")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function gn(r){let e;return{c(){e=U("Open Data Commons Open Database License")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function $n(r){let e,n,t,s,o,l,u,i,f;return t=new re({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[hn]},$$scope:{ctx:r}}}),i=new re({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[gn]},$$scope:{ctx:r}}}),{c(){e=z("p"),n=U("This shows "),y(t.$$.fragment),s=U(` data from OpenStreetMap. It doesn't include outpatient clinics
    or individual doctor's offices.`),o=B(),l=z("p"),u=U("License: "),y(i.$$.fragment)},m(a,c){d(a,e,c),C(e,n),b(t,e,null),C(e,s),d(a,o,c),d(a,l,c),C(l,u),b(i,l,null),f=!0},p(a,c){const m={};c&1&&(m.$$scope={dirty:c,ctx:a}),t.$set(m);const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),i.$set(p)},i(a){f||(h(t.$$.fragment,a),h(i.$$.fragment,a),f=!0)},o(a){$(t.$$.fragment,a),$(i.$$.fragment,a),f=!1},d(a){a&&(_(e),_(o),_(l)),k(t),k(i)}}}function dn(r){let e,n;return e=new ht({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[$n]},$$scope:{ctx:r}}}),{c(){y(e.$$.fragment)},m(t,s){b(e,t,s),n=!0},p(t,[s]){const o={};s&1&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class _n extends K{constructor(e){super(),G(this,e,null,dn,q,{})}}function wn(r){let e,n,t,s,o;function l(i){r[3](i)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return r[0]!==void 0&&(u.value=r[0]),e=new Ce({props:u}),ee.push(()=>te(e,"value",l)),e.$on("change",r[2]),s=new qt({props:{rows:r[1]}}),{c(){y(e.$$.fragment),t=B(),y(s.$$.fragment)},m(i,f){b(e,i,f),d(i,t,f),b(s,i,f),o=!0},p(i,[f]){const a={};!n&&f&1&&(n=!0,a.value=i[0],ne(()=>n=!1)),e.$set(a);const c={};f&2&&(c.rows=i[1]),s.$set(c)},i(i){o||(h(e.$$.fragment,i),h(s.$$.fragment,i),o=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&_(t),k(e,i),k(s,i)}}}function vn(r,e,n){let t;Q(r,pe,i=>n(4,t=i));let s="interventionType",o=Ye("v1");function l(){let i;s=="interventionType"?(i=mt("v1"),n(1,o=Ye("v1"))):(i=Ft(["get","funding_programme"],{ATF2:X.atf2,ATF3:X.atf3,ATF4:X.atf4},"grey"),n(1,o=[["ATF2",X.atf2],["ATF3",X.atf3],["ATF4",X.atf4]])),t.setPaintProperty("interventions-points","circle-color",i),t.setPaintProperty("interventions-lines","line-color",i),t.setPaintProperty("interventions-polygons","fill-color",i),t.setPaintProperty("interventions-polygon-outlines","line-color",i)}function u(i){s=i,n(0,s)}return[s,o,l,u]}class yn extends K{constructor(e){super(),G(this,e,vn,wn,q,{})}}function bn(r){let e,n,t;return e=new Ne({props:{color:r[1]}}),{c(){y(e.$$.fragment),n=U(`
  MRN`)},m(s,o){b(e,s,o),d(s,n,o),t=!0},p:ut,i(s){t||(h(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){s&&_(n),k(e,s)}}}function kn(r){let e;return{c(){e=U(`Major Road Network
        `)},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function Tn(r){let e;return{c(){e=U("Open Government License")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function Ln(r){let e,n,t,s,o,l,u,i,f;return t=new re({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[kn]},$$scope:{ctx:r}}}),i=new re({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Tn]},$$scope:{ctx:r}}}),{c(){e=z("p"),n=U("Data from the "),y(t.$$.fragment),s=U("."),o=B(),l=z("p"),u=U("License: "),y(i.$$.fragment)},m(a,c){d(a,e,c),C(e,n),b(t,e,null),C(e,s),d(a,o,c),d(a,l,c),C(l,u),b(i,l,null),f=!0},p(a,c){const m={};c&16&&(m.$$scope={dirty:c,ctx:a}),t.$set(m);const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),i.$set(p)},i(a){f||(h(t.$$.fragment,a),h(i.$$.fragment,a),f=!0)},o(a){$(t.$$.fragment,a),$(i.$$.fragment,a),f=!1},d(a){a&&(_(e),_(o),_(l)),k(t),k(i)}}}function Dn(r){let e,n,t;return n=new Ie({props:{$$slots:{default:[Ln]},$$scope:{ctx:r}}}),{c(){e=z("span"),y(n.$$.fragment),R(e,"slot","right")},m(s,o){d(s,e,o),b(n,e,null),t=!0},p(s,o){const l={};o&16&&(l.$$scope={dirty:o,ctx:s}),n.$set(l)},i(s){t||(h(n.$$.fragment,s),t=!0)},o(s){$(n.$$.fragment,s),t=!1},d(s){s&&_(e),k(n)}}}function Sn(r){let e,n,t,s,o;function l(i){r[2](i)}let u={id:se,$$slots:{right:[Dn],default:[bn]},$$scope:{ctx:r}};return r[0]!==void 0&&(u.checked=r[0]),e=new Oe({props:u}),ee.push(()=>te(e,"checked",l)),s=new ce({props:{layer:se,tooltip:Un,show:r[0]}}),{c(){y(e.$$.fragment),t=B(),y(s.$$.fragment)},m(i,f){b(e,i,f),d(i,t,f),b(s,i,f),o=!0},p(i,[f]){const a={};f&16&&(a.$$scope={dirty:f,ctx:i}),!n&&f&1&&(n=!0,a.checked=i[0],ne(()=>n=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),s.$set(c)},i(i){o||(h(e.$$.fragment,i),h(s.$$.fragment,i),o=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&_(t),k(e,i),k(s,i)}}}let se="mrn";function Un(r){return`<p>${r.properties.name??"Unknown MRN road"}</p>`}function Cn(r,e,n){let t;Q(r,pe,u=>n(3,t=u));let s=X.mrn;Ae(t,se,`https://atip.uk/layers/v1/${se}.pmtiles`),ft(t,{id:se,source:se,sourceLayer:se,color:s,width:7,opacity:ze(.5,1)});let o=!1;function l(u){o=u,n(0,o)}return[o,s,l]}class Mn extends K{constructor(e){super(),G(this,e,Cn,Sn,q,{})}}function Bn(r){let e,n,t;return e=new Ne({props:{color:r[1]}}),{c(){y(e.$$.fragment),n=U(`
  Parliamentary constituencies`)},m(s,o){b(e,s,o),d(s,n,o),t=!0},p:ut,i(s){t||(h(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){s&&_(n),k(e,s)}}}function En(r){let e;return{c(){e=U(`Ordnance Survey Boundary-Line
        `)},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function An(r){let e;return{c(){e=U("Open Government License")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function zn(r){let e,n,t,s,o,l,u,i,f;return t=new re({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[En]},$$scope:{ctx:r}}}),i=new re({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[An]},$$scope:{ctx:r}}}),{c(){e=z("p"),n=U("Data from "),y(t.$$.fragment),s=U("."),o=B(),l=z("p"),u=U("License: "),y(i.$$.fragment)},m(a,c){d(a,e,c),C(e,n),b(t,e,null),C(e,s),d(a,o,c),d(a,l,c),C(l,u),b(i,l,null),f=!0},p(a,c){const m={};c&32&&(m.$$scope={dirty:c,ctx:a}),t.$set(m);const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),i.$set(p)},i(a){f||(h(t.$$.fragment,a),h(i.$$.fragment,a),f=!0)},o(a){$(t.$$.fragment,a),$(i.$$.fragment,a),f=!1},d(a){a&&(_(e),_(o),_(l)),k(t),k(i)}}}function Pn(r){let e,n,t;return n=new Ie({props:{$$slots:{default:[zn]},$$scope:{ctx:r}}}),{c(){e=z("span"),y(n.$$.fragment),R(e,"slot","right")},m(s,o){d(s,e,o),b(n,e,null),t=!0},p(s,o){const l={};o&32&&(l.$$scope={dirty:o,ctx:s}),n.$set(l)},i(s){t||(h(n.$$.fragment,s),t=!0)},o(s){$(n.$$.fragment,s),t=!1},d(s){s&&_(e),k(n)}}}function On(r){let e,n,t,s,o;function l(i){r[3](i)}let u={id:x,$$slots:{right:[Pn],default:[Bn]},$$scope:{ctx:r}};return r[0]!==void 0&&(u.checked=r[0]),e=new Oe({props:u}),ee.push(()=>te(e,"checked",l)),s=new ce({props:{layer:x,tooltip:Nn,show:r[0]}}),s.$on("click",In),{c(){y(e.$$.fragment),t=B(),y(s.$$.fragment)},m(i,f){b(e,i,f),d(i,t,f),b(s,i,f),o=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!n&&f&1&&(n=!0,a.checked=i[0],ne(()=>n=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),s.$set(c)},i(i){o||(h(e.$$.fragment,i),h(s.$$.fragment,i),o=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),o=!1},d(i){i&&_(t),k(e,i),k(s,i)}}}let x="parliamentary_constituencies";function Nn(r){return`<p>${r.properties.Name}</p>`}function In(r){window.open(`https://www.ons.gov.uk/visualisations/areas/${r.detail.properties.Census_Code}`,"_blank")}function Fn(r,e,n){let t;Q(r,pe,i=>n(2,t=i));let s=X.parliamentary_constituencies,o=`${x}-outline`;Ae(t,x,`https://atip.uk/layers/v1/${x}.pmtiles`),at(t,{id:x,source:x,sourceLayer:x,color:s,opacity:ze(.5,.1)}),ft(t,{id:o,source:x,sourceLayer:x,color:s,width:5});let l=!1;function u(i){l=i,n(0,l)}return r.$$.update=()=>{r.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",l?"visible":"none")},[l,s,t,u]}class jn extends K{constructor(e){super(),G(this,e,Fn,On,q,{})}}function Vn(r){let e;return{c(){e=U("Show on map")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function Hn(r){let e;return{c(){e=U("Edit scheme locally")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function Zn(r){let e,n,t=r[0].authority_or_region+"",s,o,l,u,i=r[0].capital_scheme_id+"",f,a,c,m,p=r[0].funding_programme+"",w,T,S,g,v,L,M;return g=new ye({props:{$$slots:{default:[Vn]},$$scope:{ctx:r}}}),g.$on("click",r[3]),L=new ye({props:{disabled:r[1],title:r[2],$$slots:{default:[Hn]},$$scope:{ctx:r}}}),L.$on("click",r[4]),{c(){e=z("p"),n=U("Authority or region: "),s=U(t),o=B(),l=z("p"),u=U("Capital scheme ID: "),f=U(i),a=B(),c=z("p"),m=U("Funding programme: "),w=U(p),T=B(),S=z("div"),y(g.$$.fragment),v=B(),y(L.$$.fragment),R(S,"class","govuk-button-group")},m(D,E){d(D,e,E),C(e,n),C(e,s),d(D,o,E),d(D,l,E),C(l,u),C(l,f),d(D,a,E),d(D,c,E),C(c,m),C(c,w),d(D,T,E),d(D,S,E),b(g,S,null),C(S,v),b(L,S,null),M=!0},p(D,E){(!M||E&1)&&t!==(t=D[0].authority_or_region+"")&&Y(s,t),(!M||E&1)&&i!==(i=D[0].capital_scheme_id+"")&&Y(f,i),(!M||E&1)&&p!==(p=D[0].funding_programme+"")&&Y(w,p);const P={};E&256&&(P.$$scope={dirty:E,ctx:D}),g.$set(P);const O={};E&256&&(O.$$scope={dirty:E,ctx:D}),L.$set(O)},i(D){M||(h(g.$$.fragment,D),h(L.$$.fragment,D),M=!0)},o(D){$(g.$$.fragment,D),$(L.$$.fragment,D),M=!1},d(D){D&&(_(e),_(o),_(l),_(a),_(c),_(T),_(S)),k(g),k(L)}}}function Rn(r){let e,n;return e=new Pe({props:{label:`${r[0].scheme_reference}: ${r[0].num_features} features`,$$slots:{default:[Zn]},$$scope:{ctx:r}}}),{c(){y(e.$$.fragment)},m(t,s){b(e,t,s),n=!0},p(t,[s]){const o={};s&1&&(o.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),s&257&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function xn(r,e,n){let t,s;Q(r,ue,c=>n(6,t=c)),Q(r,pe,c=>n(7,s=c));let{scheme:o}=e,{authorityNames:l}=e,u=!l.has(o.authority_or_region),i=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:t.features.filter(m=>m.properties.scheme_reference==o.scheme_reference)};s==null||s.fitBounds(ct(c),{padding:20,animate:!1})}function a(){let c={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==o.scheme_reference)},m=o.authority_or_region;window.localStorage.setItem(m,JSON.stringify(c)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return r.$$set=c=>{"scheme"in c&&n(0,o=c.scheme),"authorityNames"in c&&n(5,l=c.authorityNames)},[o,u,i,f,a,l]}class Kn extends K{constructor(e){super(),G(this,e,xn,Rn,q,{scheme:0,authorityNames:5})}}function Gn(r){let e;return{c(){e=U("primary and secondary schools")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function qn(r){let e;return{c(){e=U("Open Data Commons Open Database License")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function Jn(r){let e,n,t,s,o,l,u,i,f;return t=new re({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Gn]},$$scope:{ctx:r}}}),i=new re({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[qn]},$$scope:{ctx:r}}}),{c(){e=z("p"),n=U("This shows "),y(t.$$.fragment),s=U(` from OpenStreetMap. It doesn't include kindergartens, colleges,
    universities, or other training schools.`),o=B(),l=z("p"),u=U("License: "),y(i.$$.fragment)},m(a,c){d(a,e,c),C(e,n),b(t,e,null),C(e,s),d(a,o,c),d(a,l,c),C(l,u),b(i,l,null),f=!0},p(a,c){const m={};c&1&&(m.$$scope={dirty:c,ctx:a}),t.$set(m);const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),i.$set(p)},i(a){f||(h(t.$$.fragment,a),h(i.$$.fragment,a),f=!0)},o(a){$(t.$$.fragment,a),$(i.$$.fragment,a),f=!1},d(a){a&&(_(e),_(o),_(l)),k(t),k(i)}}}function Wn(r){let e,n;return e=new ht({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Jn]},$$scope:{ctx:r}}}),{c(){y(e.$$.fragment)},m(t,s){b(e,t,s),n=!0},p(t,[s]){const o={};s&1&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class Xn extends K{constructor(e){super(),G(this,e,null,Wn,q,{})}}var I=(r,e,n)=>new Promise((t,s)=>{var o=i=>{try{u(n.next(i))}catch(f){s(f)}},l=i=>{try{u(n.throw(i))}catch(f){s(f)}},u=i=>i.done?t(i.value):Promise.resolve(i.value).then(o,l);u((n=n.apply(r,e)).next())}),j=Uint8Array,ae=Uint16Array,Yn=Int32Array,gt=new j([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$t=new j([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Qn=new j([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dt=function(r,e){for(var n=new ae(31),t=0;t<31;++t)n[t]=e+=1<<r[t-1];for(var s=new Yn(n[30]),t=1;t<30;++t)for(var o=n[t];o<n[t+1];++o)s[o]=o-n[t]<<5|t;return{b:n,r:s}},_t=dt(gt,2),wt=_t.b,er=_t.r;wt[28]=258,er[258]=28;var tr=dt($t,0),nr=tr.b,Me=new ae(32768);for(A=0;A<32768;++A)W=(A&43690)>>1|(A&21845)<<1,W=(W&52428)>>2|(W&13107)<<2,W=(W&61680)>>4|(W&3855)<<4,Me[A]=((W&65280)>>8|(W&255)<<8)>>1;var W,A,_e=function(r,e,n){for(var t=r.length,s=0,o=new ae(e);s<t;++s)r[s]&&++o[r[s]-1];var l=new ae(e);for(s=1;s<e;++s)l[s]=l[s-1]+o[s-1]<<1;var u;if(n){u=new ae(1<<e);var i=15-e;for(s=0;s<t;++s)if(r[s])for(var f=s<<4|r[s],a=e-r[s],c=l[r[s]-1]++<<a,m=c|(1<<a)-1;c<=m;++c)u[Me[c]>>i]=f}else for(u=new ae(t),s=0;s<t;++s)r[s]&&(u[s]=Me[l[r[s]-1]++]>>15-r[s]);return u},we=new j(288);for(A=0;A<144;++A)we[A]=8;var A;for(A=144;A<256;++A)we[A]=9;var A;for(A=256;A<280;++A)we[A]=7;var A;for(A=280;A<288;++A)we[A]=8;var A,vt=new j(32);for(A=0;A<32;++A)vt[A]=5;var A,rr=_e(we,9,1),sr=_e(vt,5,1),Se=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},H=function(r,e,n){var t=e/8|0;return(r[t]|r[t+1]<<8)>>(e&7)&n},Ue=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},or=function(r){return(r+7)/8|0},ir=function(r,e,n){(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length);var t=new j(n-e);return t.set(r.subarray(e,n)),t},lr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(r,e,n){var t=new Error(e||lr[r]);if(t.code=r,Error.captureStackTrace&&Error.captureStackTrace(t,F),!n)throw t;return t},Fe=function(r,e,n,t){var s=r.length,o=t?t.length:0;if(!s||e.f&&!e.l)return n||new j(0);var l=!n||e.i!=2,u=e.i;n||(n=new j(s*3));var i=function(xe){var Ke=n.length;if(xe>Ke){var Ge=new j(Math.max(Ke*2,xe));Ge.set(n),n=Ge}},f=e.f||0,a=e.p||0,c=e.b||0,m=e.l,p=e.d,w=e.m,T=e.n,S=s*8;do{if(!m){f=H(r,a,1);var g=H(r,a+1,3);if(a+=3,g)if(g==1)m=rr,p=sr,w=9,T=5;else if(g==2){var D=H(r,a,31)+257,E=H(r,a+10,15)+4,P=D+H(r,a+5,31)+1;a+=14;for(var O=new j(P),J=new j(19),N=0;N<E;++N)J[Qn[N]]=H(r,a+N*3,7);a+=E*3;for(var je=Se(J),Ut=(1<<je)-1,Ct=_e(J,je,1),N=0;N<P;){var Ve=Ct[H(r,a,Ut)];a+=Ve&15;var v=Ve>>4;if(v<16)O[N++]=v;else{var oe=0,ve=0;for(v==16?(ve=3+H(r,a,3),a+=2,oe=O[N-1]):v==17?(ve=3+H(r,a,7),a+=3):v==18&&(ve=11+H(r,a,127),a+=7);ve--;)O[N++]=oe}}var He=O.subarray(0,D),V=O.subarray(D);w=Se(He),T=Se(V),m=_e(He,w,1),p=_e(V,T,1)}else F(1);else{var v=or(a)+4,L=r[v-4]|r[v-3]<<8,M=v+L;if(M>s){u&&F(0);break}l&&i(c+L),n.set(r.subarray(v,M),c),e.b=c+=L,e.p=a=M*8,e.f=f;continue}if(a>S){u&&F(0);break}}l&&i(c+131072);for(var Mt=(1<<w)-1,Bt=(1<<T)-1,ke=a;;ke=a){var oe=m[Ue(r,a)&Mt],ie=oe>>4;if(a+=oe&15,a>S){u&&F(0);break}if(oe||F(2),ie<256)n[c++]=ie;else if(ie==256){ke=a,m=null;break}else{var Ze=ie-254;if(ie>264){var N=ie-257,me=gt[N];Ze=H(r,a,(1<<me)-1)+wt[N],a+=me}var Te=p[Ue(r,a)&Bt],Le=Te>>4;Te||F(3),a+=Te&15;var V=nr[Le];if(Le>3){var me=$t[Le];V+=Ue(r,a)&(1<<me)-1,a+=me}if(a>S){u&&F(0);break}l&&i(c+131072);var De=c+Ze;if(c<V){var Re=o-V,Et=Math.min(V,De);for(Re+c<0&&F(3);c<Et;++c)n[c]=t[Re+c]}for(;c<De;c+=4)n[c]=n[c-V],n[c+1]=n[c+1-V],n[c+2]=n[c+2-V],n[c+3]=n[c+3-V];c=De}}e.l=m,e.p=ke,e.b=c,e.f=f,m&&(f=1,e.m=w,e.d=p,e.n=T)}while(!f);return c==n.length?n:ir(n,0,c)},ar=new j(0),fr=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&F(6,"invalid gzip data");var e=r[3],n=10;e&4&&(n+=(r[10]|r[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!r[n++]);return n+(e&2)},ur=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},cr=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&F(6,"invalid zlib data"),(r[1]>>5&1)==+!e&&F(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function pr(r,e){return Fe(r,{i:2},e&&e.out,e&&e.dictionary)}function mr(r,e){var n=fr(r);return n+8>r.length&&F(6,"invalid gzip data"),Fe(r.subarray(n,-8),{i:2},e&&e.out||new j(ur(r)),e&&e.dictionary)}function hr(r,e){return Fe(r.subarray(cr(r,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Be(r,e){return r[0]==31&&r[1]==139&&r[2]==8?mr(r,e):(r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31?pr(r,e):hr(r,e)}var gr=typeof TextDecoder<"u"&&new TextDecoder,$r=0;try{gr.decode(ar,{stream:!0}),$r=1}catch{}var yt=(r,e)=>r*Math.pow(2,e),he=(r,e)=>Math.floor(r/Math.pow(2,e)),be=(r,e)=>yt(r.getUint16(e+1,!0),8)+r.getUint8(e),bt=(r,e)=>yt(r.getUint32(e+2,!0),16)+r.getUint16(e,!0),dr=(r,e,n,t,s)=>{if(r!=t.getUint8(s))return r-t.getUint8(s);const o=be(t,s+1);if(e!=o)return e-o;const l=be(t,s+4);return n!=l?n-l:0},_r=(r,e,n,t)=>{const s=kt(r,e|128,n,t);return s?{z:e,x:n,y:t,offset:s[0],length:s[1],is_dir:!0}:null},Qe=(r,e,n,t)=>{const s=kt(r,e,n,t);return s?{z:e,x:n,y:t,offset:s[0],length:s[1],is_dir:!1}:null},kt=(r,e,n,t)=>{let s=0,o=r.byteLength/17-1;for(;s<=o;){const l=o+s>>1,u=dr(e,n,t,r,l*17);if(u>0)s=l+1;else if(u<0)o=l-1;else return[bt(r,l*17+7),r.getUint32(l*17+13,!0)]}return null},wr=(r,e)=>r.is_dir&&!e.is_dir?1:!r.is_dir&&e.is_dir?-1:r.z!==e.z?r.z-e.z:r.x!==e.x?r.x-e.x:r.y-e.y,Tt=(r,e)=>{const n=r.getUint8(e*17);return{z:n&127,x:be(r,e*17+1),y:be(r,e*17+4),offset:bt(r,e*17+7),length:r.getUint32(e*17+13,!0),is_dir:n>>7===1}},et=r=>{const e=[],n=new DataView(r);for(let t=0;t<n.byteLength/17;t++)e.push(Tt(n,t));return vr(e)},vr=r=>{r.sort(wr);const e=new ArrayBuffer(17*r.length),n=new Uint8Array(e);for(let t=0;t<r.length;t++){const s=r[t];let o=s.z;s.is_dir&&(o=o|128),n[t*17]=o,n[t*17+1]=s.x&255,n[t*17+2]=s.x>>8&255,n[t*17+3]=s.x>>16&255,n[t*17+4]=s.y&255,n[t*17+5]=s.y>>8&255,n[t*17+6]=s.y>>16&255,n[t*17+7]=s.offset&255,n[t*17+8]=he(s.offset,8)&255,n[t*17+9]=he(s.offset,16)&255,n[t*17+10]=he(s.offset,24)&255,n[t*17+11]=he(s.offset,32)&255,n[t*17+12]=he(s.offset,48)&255,n[t*17+13]=s.length&255,n[t*17+14]=s.length>>8&255,n[t*17+15]=s.length>>16&255,n[t*17+16]=s.length>>24&255}return e},yr=(r,e)=>{if(r.byteLength<17)return null;const n=r.byteLength/17,t=Tt(r,n-1);if(t.is_dir){const s=t.z,o=e.z-s,l=Math.trunc(e.x/(1<<o)),u=Math.trunc(e.y/(1<<o));return{z:s,x:l,y:u}}return null};function br(r){return I(this,null,function*(){const e=yield r.getBytes(0,512e3),n=new DataView(e.data),t=n.getUint32(4,!0),s=n.getUint16(8,!0),o=new TextDecoder("utf-8"),l=JSON.parse(o.decode(new DataView(e.data,10,t)));let u=0;l.compression==="gzip"&&(u=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let f=0;"maxzoom"in l&&(f=+l.maxzoom);let a=0,c=0,m=0,p=-180,w=-85,T=180,S=85;if(l.bounds){const v=l.bounds.split(",");p=+v[0],w=+v[1],T=+v[2],S=+v[3]}if(l.center){const v=l.center.split(",");a=+v[0],c=+v[1],m=+v[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:i,maxZoom:f,minLon:p,minLat:w,maxLon:T,maxLat:S,centerZoom:m,centerLon:a,centerLat:c,etag:e.etag}})}function kr(r,e,n,t,s,o,l){return I(this,null,function*(){let u=yield n.getArrayBuffer(e,r.rootDirectoryOffset,r.rootDirectoryLength,r);r.specVersion===1&&(u=et(u));const i=Qe(new DataView(u),t,s,o);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const m=new DataView(c);return m.getUint8(0)==31&&m.getUint8(1)==139&&(c=Be(new Uint8Array(c))),{data:c}}const f=yr(new DataView(u),{z:t,x:s,y:o});if(f){const a=_r(new DataView(u),f.z,f.x,f.y);if(a){let c=yield n.getArrayBuffer(e,a.offset,a.length,r);r.specVersion===1&&(c=et(c));const m=Qe(new DataView(c),t,s,o);if(m){let w=(yield e.getBytes(m.offset,m.length,l)).data;const T=new DataView(w);return T.getUint8(0)==31&&T.getUint8(1)==139&&(w=Be(new Uint8Array(w))),{data:w}}}}})}var Lt={getHeader:br,getZxy:kr},Tr=class{constructor(){this.tile=(r,e)=>{if(r.type=="json"){const n=r.url.substr(10);let t=this.tiles.get(n);return t||(t=new tt(n),this.tiles.set(n,t)),t.getHeader().then(s=>{const o={tiles:[r.url+"/{z}/{x}/{y}"],minzoom:s.minZoom,maxzoom:s.maxZoom,bounds:[s.minLon,s.minLat,s.maxLon,s.maxLat]};e(null,o,null,null)}).catch(s=>{e(s,null,null,null)}),{cancel:()=>{}}}else{const n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=r.url.match(n);if(!t)throw new Error("Invalid PMTiles protocol URL");const s=t[1];let o=this.tiles.get(s);o||(o=new tt(s),this.tiles.set(s,o));const l=t[2],u=t[3],i=t[4],f=new AbortController,a=f.signal;let c=()=>{f.abort()};return o.getHeader().then(m=>{o.getZxy(+l,+u,+i,a).then(p=>{p?e(null,new Uint8Array(p.data),p.cacheControl,p.expires):m.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(p=>{p.name!=="AbortError"&&e(p,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(r){this.tiles.set(r.source.getKey(),r)}get(r){return this.tiles.get(r)}};function le(r,e){return(e>>>0)*4294967296+(r>>>0)}function Lr(r,e){const n=e.buf;let t,s;if(s=n[e.pos++],t=(s&112)>>4,s<128||(s=n[e.pos++],t|=(s&127)<<3,s<128)||(s=n[e.pos++],t|=(s&127)<<10,s<128)||(s=n[e.pos++],t|=(s&127)<<17,s<128)||(s=n[e.pos++],t|=(s&127)<<24,s<128)||(s=n[e.pos++],t|=(s&1)<<31,s<128))return le(r,t);throw new Error("Expected varint not more than 10 bytes")}function ge(r){const e=r.buf;let n,t;return t=e[r.pos++],n=t&127,t<128||(t=e[r.pos++],n|=(t&127)<<7,t<128)||(t=e[r.pos++],n|=(t&127)<<14,t<128)||(t=e[r.pos++],n|=(t&127)<<21,t<128)?n:(t=e[r.pos],n|=(t&15)<<28,Lr(n,r))}function Dr(r,e,n,t){if(t==0){n==1&&(e[0]=r-1-e[0],e[1]=r-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}var Sr=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Ur(r,e,n){if(r>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,r)-1||n>Math.pow(2,r)-1)throw Error("tile x/y outside zoom level bounds");const t=Sr[r],s=Math.pow(2,r);let o=0,l=0,u=0;const i=[e,n];let f=s/2;for(;f>0;)o=(i[0]&f)>0?1:0,l=(i[1]&f)>0?1:0,u+=f*f*(3*o^l),Dr(f,i,o,l),f=f/2;return t+u}function Dt(r,e){return I(this,null,function*(){if(e===1||e===0)return r;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Be(new Uint8Array(r));{let t=new Response(r).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var Cr=127;function Mr(r,e){let n=0,t=r.length-1;for(;n<=t;){const s=t+n>>1,o=e-r[s].tileId;if(o>0)n=s+1;else if(o<0)t=s-1;else return r[s]}return t>=0&&(r[t].runLength===0||e-r[t].tileId<r[t].runLength)?r[t]:null}var Br=class{constructor(r){this.url=r}getKey(){return this.url}getBytes(r,e,n){return I(this,null,function*(){let t;n||(t=new AbortController,n=t.signal);let s=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+r+"-"+(r+e-1)}});if(s.status===416&&r===0){const u=s.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+u.substr(8);s=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(i-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const o=s.headers.get("Content-Length");if(s.status===200&&(!o||+o>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function Z(r,e){const n=r.getUint32(e+4,!0),t=r.getUint32(e+0,!0);return n*Math.pow(2,32)+t}function Er(r,e){const n=new DataView(r),t=n.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:Z(n,8),rootDirectoryLength:Z(n,16),jsonMetadataOffset:Z(n,24),jsonMetadataLength:Z(n,32),leafDirectoryOffset:Z(n,40),leafDirectoryLength:Z(n,48),tileDataOffset:Z(n,56),tileDataLength:Z(n,64),numAddressedTiles:Z(n,72),numTileEntries:Z(n,80),numTileContents:Z(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function St(r){const e={buf:new Uint8Array(r),pos:0},n=ge(e),t=[];let s=0;for(let o=0;o<n;o++){const l=ge(e);t.push({tileId:s+l,offset:0,length:0,runLength:1}),s+=l}for(let o=0;o<n;o++)t[o].runLength=ge(e);for(let o=0;o<n;o++)t[o].length=ge(e);for(let o=0;o<n;o++){const l=ge(e);l===0&&o>0?t[o].offset=t[o-1].offset+t[o-1].length:t[o].offset=l-1}return t}function Ar(r){const e=new DataView(r);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var fe=class extends Error{};function zr(r,e,n,t){return I(this,null,function*(){const s=yield r.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Ar(s.data)<3)return[yield Lt.getHeader(r)];const l=s.data.slice(0,Cr);let u=s.etag;t&&s.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+r.getKey()),u=void 0);const i=Er(l,u);if(n){const f=s.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),a=r.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=St(yield e(f,i.internalCompression));return[i,[a,c.length,c]]}return[i,void 0]})}function Pr(r,e,n,t,s){return I(this,null,function*(){const o=yield r.getBytes(n,t);if(s.etag&&s.etag!==o.etag)throw new fe(o.etag);const l=yield e(o.data,s.internalCompression),u=St(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Or=class{constructor(r=100,e=!0,n=Dt){this.cache=new Map,this.maxCacheEntries=r,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(r,e){return I(this,null,function*(){const n=r.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const t=new Promise((s,o)=>{zr(r,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),s(l[0]),this.prune()}).catch(l=>{o(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:t}),t})}getDirectory(r,e,n,t){return I(this,null,function*(){const s=r.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((l,u)=>{Pr(r,this.decompress,e,n,t).then(i=>{l(i),this.prune()}).catch(i=>{u(i)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(r,e,n,t){return I(this,null,function*(){const s=r.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const o=new Promise((l,u)=>{r.getBytes(e,n).then(i=>{if(t.etag&&t.etag!==i.etag)throw new fe(i.etag);l(i.data),this.cache.has(s),this.prune()}).catch(i=>{u(i)})});return this.cache.set(s,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let r=1/0,e;this.cache.forEach((n,t)=>{n.lastUsed<r&&(r=n.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(r,e){return I(this,null,function*(){this.cache.delete(r.getKey()),yield this.getHeader(r,e)})}},tt=class{constructor(r,e,n){typeof r=="string"?this.source=new Br(r):this.source=r,n?this.decompress=n:this.decompress=Dt,e?this.cache=e:this.cache=new Or}getHeader(){return I(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(r,e,n,t){return I(this,null,function*(){const s=Ur(r,e,n),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return Lt.getZxy(o,this.source,this.cache,r,e,n,t);if(r<o.minZoom||r>o.maxZoom)return;let l=o.rootDirectoryOffset,u=o.rootDirectoryLength;for(let i=0;i<=3;i++){const f=yield this.cache.getDirectory(this.source,l,u,o),a=Mr(f,s);if(a)if(a.runLength>0){const c=yield this.source.getBytes(o.tileDataOffset+a.offset,a.length,t);if(o.etag&&o.etag!==c.etag)throw new fe(c.etag);return{data:yield this.decompress(c.data,o.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=o.leafDirectoryOffset+a.offset,u=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(r,e,n,t){return I(this,null,function*(){try{return yield this.getZxyAttempt(r,e,n,t)}catch(s){if(s instanceof fe)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(r,e,n,t);throw s}})}getMetadataAttempt(){return I(this,null,function*(){const r=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(r.jsonMetadataOffset,r.jsonMetadataLength);if(r.etag&&r.etag!==e.etag)throw new fe(e.etag);const n=yield this.decompress(e.data,r.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(n))})}getMetadata(){return I(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(r){if(r instanceof fe)return this.cache.invalidate(this.source,r.message),yield this.getMetadataAttempt();throw r}})}};function Nr(r){return Ee(()=>{let e=new Tr;Je.addProtocol("pmtiles",e.tile)}),pt(()=>{Je.removeProtocol("pmtiles")}),[]}class Ir extends K{constructor(e){super(),G(this,e,Nr,null,q,{})}}function nt(r,e,n){const t=r.slice();return t[15]=e[n],t}function Fr(r){let e;return{c(){e=U("Home")},m(n,t){d(n,e,t)},d(n){n&&_(e)}}}function rt(r){let e,n;return e=new xt({props:{errorMessage:r[1]}}),{c(){y(e.$$.fragment)},m(t,s){b(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.errorMessage=t[1]),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function st(r){let e,n,t,s;function o(i){r[10](i)}function l(i){r[11](i)}let u={schemes:r[2]};return r[3]!==void 0&&(u.schemesToBeShown=r[3]),r[4]!==void 0&&(u.filterText=r[4]),e=new an({props:u}),ee.push(()=>te(e,"schemesToBeShown",o)),ee.push(()=>te(e,"filterText",l)),{c(){y(e.$$.fragment)},m(i,f){b(e,i,f),s=!0},p(i,f){const a={};f&4&&(a.schemes=i[2]),!n&&f&8&&(n=!0,a.schemesToBeShown=i[3],ne(()=>n=!1)),!t&&f&16&&(t=!0,a.filterText=i[4],ne(()=>t=!1)),e.$set(a)},i(i){s||(h(e.$$.fragment,i),s=!0)},o(i){$(e.$$.fragment,i),s=!1},d(i){k(e,i)}}}function ot(r){let e,n,t=Xe(r[2].values()),s=[];for(let l=0;l<t.length;l+=1)s[l]=lt(nt(r,t,l));const o=l=>$(s[l],1,1,()=>{s[l]=null});return{c(){e=z("ul");for(let l=0;l<s.length;l+=1)s[l].c()},m(l,u){d(l,e,u);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(l,u){if(u&13){t=Xe(l[2].values());let i;for(i=0;i<t.length;i+=1){const f=nt(l,t,i);s[i]?(s[i].p(f,u),h(s[i],1)):(s[i]=lt(f),s[i].c(),h(s[i],1),s[i].m(e,null))}for($e(),i=t.length;i<s.length;i+=1)o(i);de()}},i(l){if(!n){for(let u=0;u<t.length;u+=1)h(s[u]);n=!0}},o(l){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)$(s[u]);n=!1},d(l){l&&_(e),Kt(s,l)}}}function it(r){let e,n;return e=new Kn({props:{scheme:r[15],authorityNames:r[0]}}),{c(){y(e.$$.fragment)},m(t,s){b(e,t,s),n=!0},p(t,s){const o={};s&4&&(o.scheme=t[15]),s&1&&(o.authorityNames=t[0]),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function lt(r){let e=r[3].has(r[15].scheme_reference),n,t,s=e&&it(r);return{c(){s&&s.c(),n=Gt()},m(o,l){s&&s.m(o,l),d(o,n,l),t=!0},p(o,l){l&12&&(e=o[3].has(o[15].scheme_reference)),e?s?(s.p(o,l),l&12&&h(s,1)):(s=it(o),s.c(),h(s,1),s.m(n.parentNode,n)):s&&($e(),$(s,1,1,()=>{s=null}),de())},i(o){t||(h(s),t=!0)},o(o){$(s),t=!1},d(o){o&&_(n),s&&s.d(o)}}}function jr(r){let e,n,t,s,o,l,u,i,f,a,c,m,p;n=new ye({props:{$$slots:{default:[Fr]},$$scope:{ctx:r}}}),n.$on("click",r[9]),u=new Wt({props:{boundaryGeojson:r[5]}});let w=r[1]&&rt(r);a=new jt({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:r[7]}});let T=r[2].size>0&&st(r),S=r[0]&&ot(r);return{c(){e=z("div"),y(n.$$.fragment),t=B(),s=z("div"),o=z("h1"),o.textContent="Browse schemes",l=B(),y(u.$$.fragment),i=B(),w&&w.c(),f=B(),y(a.$$.fragment),c=B(),T&&T.c(),m=B(),S&&S.c(),We(s,"display","flex"),We(s,"justify-content","space-between"),R(e,"slot","sidebar"),R(e,"class","govuk-prose")},m(g,v){d(g,e,v),b(n,e,null),C(e,t),C(e,s),C(s,o),C(s,l),b(u,s,null),C(e,i),w&&w.m(e,null),C(e,f),b(a,e,null),C(e,c),T&&T.m(e,null),C(e,m),S&&S.m(e,null),p=!0},p(g,v){const L={};v&262144&&(L.$$scope={dirty:v,ctx:g}),n.$set(L);const M={};v&32&&(M.boundaryGeojson=g[5]),u.$set(M),g[1]?w?(w.p(g,v),v&2&&h(w,1)):(w=rt(g),w.c(),h(w,1),w.m(e,f)):w&&($e(),$(w,1,1,()=>{w=null}),de()),g[2].size>0?T?(T.p(g,v),v&4&&h(T,1)):(T=st(g),T.c(),h(T,1),T.m(e,m)):T&&($e(),$(T,1,1,()=>{T=null}),de()),g[0]?S?(S.p(g,v),v&1&&h(S,1)):(S=ot(g),S.c(),h(S,1),S.m(e,null)):S&&($e(),$(S,1,1,()=>{S=null}),de())},i(g){p||(h(n.$$.fragment,g),h(u.$$.fragment,g),h(w),h(a.$$.fragment,g),h(T),h(S),p=!0)},o(g){$(n.$$.fragment,g),$(u.$$.fragment,g),$(w),$(a.$$.fragment,g),$(T),$(S),p=!1},d(g){g&&_(e),k(n),k(u),w&&w.d(),k(a),T&&T.d(),S&&S.d()}}}function Vr(r){let e,n,t,s,o,l,u,i;return e=new Xn({}),t=new _n({}),o=new Mn({}),u=new jn({}),{c(){y(e.$$.fragment),n=B(),y(t.$$.fragment),s=B(),y(o.$$.fragment),l=B(),y(u.$$.fragment)},m(f,a){b(e,f,a),d(f,n,a),b(t,f,a),d(f,s,a),b(o,f,a),d(f,l,a),b(u,f,a),i=!0},i(f){i||(h(e.$$.fragment,f),h(t.$$.fragment,f),h(o.$$.fragment,f),h(u.$$.fragment,f),i=!0)},o(f){$(e.$$.fragment,f),$(t.$$.fragment,f),$(o.$$.fragment,f),$(u.$$.fragment,f),i=!1},d(f){f&&(_(n),_(s),_(l)),k(e,f),k(t,f),k(o,f),k(u,f)}}}function Hr(r){let e,n,t,s,o,l,u,i;return e=new yn({}),o=new Qt({props:{small:!0,$$slots:{default:[Vr]},$$scope:{ctx:r}}}),u=new en({props:{style:r[6]}}),{c(){y(e.$$.fragment),n=B(),t=z("hr"),s=B(),y(o.$$.fragment),l=B(),y(u.$$.fragment)},m(f,a){b(e,f,a),d(f,n,a),d(f,t,a),d(f,s,a),b(o,f,a),d(f,l,a),b(u,f,a),i=!0},p(f,a){const c={};a&262144&&(c.$$scope={dirty:a,ctx:f}),o.$set(c)},i(f){i||(h(e.$$.fragment,f),h(o.$$.fragment,f),h(u.$$.fragment,f),i=!0)},o(f){$(e.$$.fragment,f),$(o.$$.fragment,f),$(u.$$.fragment,f),i=!1},d(f){f&&(_(n),_(t),_(s),_(l)),k(e,f),k(o,f),k(u,f)}}}function Zr(r){let e,n,t,s,o,l,u,i,f,a,c;return e=new Yt({props:{colorInterventions:mt("v1")}}),t=new ce({props:{layer:"interventions-points",tooltip:r[8]}}),o=new ce({props:{layer:"interventions-lines",tooltip:r[8]}}),u=new ce({props:{layer:"interventions-polygons",tooltip:r[8]}}),a=new Pe({props:{label:"Layers",open:!0,$$slots:{default:[Hr]},$$scope:{ctx:r}}}),{c(){y(e.$$.fragment),n=B(),y(t.$$.fragment),s=B(),y(o.$$.fragment),l=B(),y(u.$$.fragment),i=B(),f=z("div"),y(a.$$.fragment),R(f,"class","top-right svelte-nlvvhu")},m(m,p){b(e,m,p),d(m,n,p),b(t,m,p),d(m,s,p),b(o,m,p),d(m,l,p),b(u,m,p),d(m,i,p),d(m,f,p),b(a,f,null),c=!0},p(m,p){const w={};p&262144&&(w.$$scope={dirty:p,ctx:m}),a.$set(w)},i(m){c||(h(e.$$.fragment,m),h(t.$$.fragment,m),h(o.$$.fragment,m),h(u.$$.fragment,m),h(a.$$.fragment,m),c=!0)},o(m){$(e.$$.fragment,m),$(t.$$.fragment,m),$(o.$$.fragment,m),$(u.$$.fragment,m),$(a.$$.fragment,m),c=!1},d(m){m&&(_(n),_(s),_(l),_(i),_(f)),k(e,m),k(t,m),k(o,m),k(u,m),k(a)}}}function Rr(r){let e,n,t,s,o;return n=new Ir({}),s=new Xt({props:{style:r[6],$$slots:{default:[Zr]},$$scope:{ctx:r}}}),{c(){e=z("div"),y(n.$$.fragment),t=B(),y(s.$$.fragment),R(e,"slot","main")},m(l,u){d(l,e,u),b(n,e,null),C(e,t),b(s,e,null),o=!0},p(l,u){const i={};u&262144&&(i.$$scope={dirty:u,ctx:l}),s.$set(i)},i(l){o||(h(n.$$.fragment,l),h(s.$$.fragment,l),o=!0)},o(l){$(n.$$.fragment,l),$(s.$$.fragment,l),o=!1},d(l){l&&_(e),k(n),k(s)}}}function xr(r){let e,n;return e=new Jt({props:{$$slots:{main:[Rr],sidebar:[jr]},$$scope:{ctx:r}}}),{c(){y(e.$$.fragment)},m(t,s){b(e,t,s),n=!0},p(t,[s]){const o={};s&262207&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Kr(r,e,n){let t,s;Q(r,pe,v=>n(12,t=v)),Q(r,ue,v=>n(5,s=v));let o=null;Ee(async()=>{Vt();let v=await Ht();n(0,o=new Set(v.features.map(L=>L.properties.name)))});let u=new URLSearchParams(window.location.search).get("style")||"dataviz",i="",f=new Map,a=new Set,c="";pt(()=>{ue.set(Zt())});function m(v){try{let L=JSON.parse(v);n(2,f=tn(L)),ue.set(L),n(1,i=""),t==null||t.fitBounds(ct(L),{padding:20,animate:!1})}catch(L){n(1,i=`Couldn't load schemes from a file: ${L}`)}}function p(v){let L=v.properties;var M='<div style="max-width: 30vw;">';return M+=`<h2>${w(L.name)} (${L.intervention_type})</h2>`,M+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(M+=`<p>Length: ${Rt(L.length_meters)}</p>`),L.description&&(M+=`<p>${w(L.description)}</p>`),M+="</div>",M}function w(v){return c?v.replace(new RegExp(c,"gi"),L=>`<mark>${L}</mark>`):v}const T=()=>window.open("index.html");function S(v){a=v,n(3,a)}function g(v){c=v,n(4,c)}return[o,i,f,a,c,s,u,m,p,T,S,g]}class Gr extends K{constructor(e){super(),G(this,e,Kr,xr,q,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Gr({target:document.getElementById("app")});
