import{S as z,i as j,s as q,e as b,t as L,ae as ne,f as m,g as v,h as g,af as V,l as $,L as B,p as y,r as re,ad as ce,G as ue,an as P,c as M,au as H,ao as R,ap as G,aq as W,n as C,o as I,z as J,B as fe,E as U,D as A,C as pe,J as de,I as me,H as K,al as Q,K as _e,a9 as be,a2 as oe,a3 as le,ai as X,av as E,ab as ie,d as ge,m as ve,q as ye,a1 as F,aw as he,u as we,b as ke,a8 as Se,w as Ce}from"./maplibre_helpers-b1963fe0.js";function Le(o){let e,n,t,s,l,i,r;return{c(){e=b("div"),n=L(`Basemap:
  `),t=b("select"),s=b("option"),s.textContent="Streets",l=b("option"),l.textContent="Satellite",s.__value="streets",s.value=s.__value,l.__value="hybrid",l.value=l.__value,o[0]===void 0&&ne(()=>o[2].call(t)),m(e,"class","svelte-1tbnm6i")},m(u,a){v(u,e,a),g(e,n),g(e,t),g(t,s),g(t,l),V(t,o[0]),i||(r=[$(t,"change",o[2]),$(t,"change",o[1])],i=!0)},p(u,[a]){a&1&&V(t,u[0])},i:B,o:B,d(u){u&&y(e),i=!1,re(r)}}}function Be(o,e,n){let{style:t}=e;function s(){let i=new URLSearchParams(window.location.search);i.set("style",t);let r=`${window.location.pathname}?${i.toString()}${window.location.hash}`;window.location.href=r}function l(){t=ce(this),n(0,t)}return o.$$set=i=>{"style"in i&&n(0,t=i.style)},[t,s,l]}class st extends z{constructor(e){super(),j(this,e,Be,Le,q,{style:0})}}const T=[];function O(o,e=B){let n;const t=new Set;function s(r){if(q(o,r)&&(o=r,n)){const u=!T.length;for(const a of t)a[1](),T.push(a,o);if(u){for(let a=0;a<T.length;a+=2)T[a][0](T[a+1]);T.length=0}}}function l(r){s(r(o))}function i(r,u=B){const a=[r,u];return t.add(a),t.size===1&&(n=e(s)||B),r(o),()=>{t.delete(a),t.size===0&&(n(),n=null)}}return{set:s,update:l,subscribe:i}}function Me(o){return o=="google"||o=="bing"}const N=O(null),nt=O(null),ae=O(ue()),Oe=O(null),Ie=O(null),qe=O(null),Fe=O(null),ze=O(je());ze.subscribe(o=>window.localStorage.setItem("userSettings",JSON.stringify(o)));const ot=O("edit-attribute"),lt=O(!1);function it(o){let e=new Set;for(let t of o.features)e.add(t.id);let n=e.size+1;for(;e.has(n);)n++;return n}function at(o){console.log(`Deleting intervention ${o}`),ae.update(e=>(e.features=e.features.filter(n=>n.id!=o),e)),Oe.set(null),Ie.set(null),qe.set(null),Fe.set(null)}function je(){let o={streetViewImagery:"google",avoidDoublingBack:!1};try{let e=JSON.parse(window.localStorage.getItem("userSettings")||"{}");Me(e.streetViewImagery)&&(o.streetViewImagery=e.streetViewImagery),typeof e.avoidDoublingBack=="boolean"&&(o.avoidDoublingBack=e.avoidDoublingBack)}catch(e){console.log(`Couldn't parse userSettings from local storage: ${e}`)}return o}const De=o=>({}),Y=o=>({}),Te=o=>({}),x=o=>({});function $e(o){let e,n,t,s,l,i,r,u,a,p,_;const d=o[3].sidebar,f=P(d,o,o[2],x),S=o[3].main,w=P(S,o,o[2],Y);return{c(){e=b("div"),n=b("aside"),t=b("div"),f&&f.c(),s=M(),l=b("button"),l.textContent="â†’",r=M(),u=b("main"),w&&w.c(),m(t,"class","sidebar-content content-container svelte-ect12w"),m(l,"type","button"),m(l,"class","sidebar-toggle rounded-rect svelte-ect12w"),m(n,"class",i=H(o[0]?"":"collapsed")+" svelte-ect12w"),m(u,"class","svelte-ect12w"),m(e,"class","overall-layout svelte-ect12w")},m(c,h){v(c,e,h),g(e,n),g(n,t),f&&f.m(t,null),g(n,s),g(n,l),g(e,r),g(e,u),w&&w.m(u,null),a=!0,p||(_=$(l,"click",o[1]),p=!0)},p(c,[h]){f&&f.p&&(!a||h&4)&&R(f,d,c,c[2],a?W(d,c[2],h,Te):G(c[2]),x),(!a||h&1&&i!==(i=H(c[0]?"":"collapsed")+" svelte-ect12w"))&&m(n,"class",i),w&&w.p&&(!a||h&4)&&R(w,S,c,c[2],a?W(S,c[2],h,De):G(c[2]),Y)},i(c){a||(C(f,c),C(w,c),a=!0)},o(c){I(f,c),I(w,c),a=!1},d(c){c&&y(e),f&&f.d(c),w&&w.d(c),p=!1,_()}}}function Ee(o,e,n){let{$$slots:t={},$$scope:s}=e,l=!0;function i(){n(0,l=!l)}return o.$$set=r=>{"$$scope"in r&&n(2,s=r.$$scope)},[l,i,s,t]}class rt extends z{constructor(e){super(),j(this,e,Ee,$e,q,{})}}const k={area:"#D94324",route:"#555F5E",crossing:"#4daf4a",other:"#984ea3",preapp:"#e41a1c",outline:"#377eb8","reserved matters":"#4daf4a","local plan":"#984ea3",hovering:"black",lineEndpointColor:"black"},Pe=10,Z=10;let D="interventions";function Re(o,e,n){let t,s;J(o,N,p=>n(1,t=p)),J(o,ae,p=>n(2,s=p));let{schema:l}=e;fe(t,D,s);const i=["match",["get","intervention_type"],"area",k.area,"route",k.route,"crossing",k.crossing,"other",k.other,"white"],r=["match",["get","reference_type",["get","planning"]],"preapp",k.preapp,"outline",k.outline,"reserved matters",k["reserved matters"],"local plan",k["local plan"],"white"],u=["!=","hide_while_editing",!0];return U(t,{id:"interventions-points",source:D,filter:["all",de,u,["!=","endpoint",!0]],color:i,radius:Pe}),A(t,{id:"interventions-lines",source:D,filter:["all",me,u],color:i,width:Z}),U(t,{id:"interventions-lines-endpoints",source:D,filter:["==","endpoint",!0],radius:.5*Z,opacity:0,strokeColor:k.lineEndpointColor,strokeWidth:2}),pe(t,{id:"interventions-polygons",source:D,filter:["all",K,u],color:l=="planning"?r:i,opacity:.2}),A(t,{id:"interventions-polygon-outlines",source:D,filter:["all",K,u],color:l=="planning"?r:i,opacity:.5,width:.7*Z}),o.$$set=p=>{"schema"in p&&n(0,l=p.schema)},o.$$.update=()=>{if(o.$$.dirty&6){let p=JSON.parse(JSON.stringify(s)),_=[];for(let d of p.features)if(d.geometry.type=="LineString"&&!d.properties.hide_while_editing)for(let f of[d.geometry.coordinates[0],d.geometry.coordinates[d.geometry.coordinates.length-1]])_.push({type:"Feature",properties:{endpoint:!0},geometry:{type:"Point",coordinates:f}});p.features=p.features.concat(_),t.getSource(D).setData(p)}},[l,t,s]}class ct extends z{constructor(e){super(),j(this,e,Re,null,q,{schema:0})}}function Ge(o){const e=o-1;return e*e*e+1}function ee(o,{delay:e=0,duration:n=400,easing:t=Ge}={}){const s=getComputedStyle(o),l=+s.opacity,i=parseFloat(s.height),r=parseFloat(s.paddingTop),u=parseFloat(s.paddingBottom),a=parseFloat(s.marginTop),p=parseFloat(s.marginBottom),_=parseFloat(s.borderTopWidth),d=parseFloat(s.borderBottomWidth);return{delay:e,duration:n,easing:t,css:f=>`overflow: hidden;opacity: ${Math.min(f*20,1)*l};height: ${f*i}px;padding-top: ${f*r}px;padding-bottom: ${f*u}px;margin-top: ${f*a}px;margin-bottom: ${f*p}px;border-top-width: ${f*_}px;border-bottom-width: ${f*d}px;`}}function te(o){let e,n,t;const s=o[3].default,l=P(s,o,o[2],null);return{c(){e=b("div"),l&&l.c()},m(i,r){v(i,e,r),l&&l.m(e,null),t=!0},p(i,r){l&&l.p&&(!t||r&4)&&R(l,s,i,i[2],t?W(s,i[2],r,null):G(i[2]),null)},i(i){t||(C(l,i),ne(()=>{n||(n=X(e,ee,{duration:100},!0)),n.run(1)}),t=!0)},o(i){I(l,i),n||(n=X(e,ee,{duration:100},!1)),n.run(0),t=!1},d(i){i&&y(e),l&&l.d(i),i&&n&&n.end()}}}function We(o){let e,n,t,s,l,i,r,u,a,p,_=o[0]&&te(o);return{c(){e=b("button"),n=Q("svg"),t=Q("path"),s=M(),l=L(o[1]),i=M(),_&&_.c(),r=_e(),m(t,"d","M9 5l7 7-7 7"),m(n,"style","tran"),m(n,"width","20"),m(n,"height","20"),m(n,"fill","none"),m(n,"stroke-linecap","round"),m(n,"stroke-linejoin","round"),m(n,"stroke-width","2"),m(n,"viewBox","0 0 24 24"),m(n,"stroke","currentColor"),m(n,"class","svelte-una9lq"),m(e,"aria-expanded",o[0]),m(e,"class","svelte-una9lq")},m(d,f){v(d,e,f),g(e,n),g(n,t),g(e,s),g(e,l),v(d,i,f),_&&_.m(d,f),v(d,r,f),u=!0,a||(p=$(e,"click",o[4]),a=!0)},p(d,[f]){(!u||f&2)&&be(l,d[1]),(!u||f&1)&&m(e,"aria-expanded",d[0]),d[0]?_?(_.p(d,f),f&1&&C(_,1)):(_=te(d),_.c(),C(_,1),_.m(r.parentNode,r)):_&&(oe(),I(_,1,1,()=>{_=null}),le())},i(d){u||(C(_),u=!0)},o(d){I(_),u=!1},d(d){d&&y(e),d&&y(i),_&&_.d(d),d&&y(r),a=!1,p()}}}function Je(o,e,n){let{$$slots:t={},$$scope:s}=e,{label:l}=e,{open:i=!1}=e;const r=()=>n(0,i=!i);return o.$$set=u=>{"label"in u&&n(1,l=u.label),"open"in u&&n(0,i=u.open),"$$scope"in u&&n(2,s=u.$$scope)},[i,l,s,t,r]}class Ne extends z{constructor(e){super(),j(this,e,Je,We,q,{label:1,open:0})}}function Ze(o,e,n){let t;J(o,N,a=>n(2,t=a));let{layers:s}=e,{contents:l}=e,i=new E.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});t.on("mousemove",r),t.on("mouseout",u),ie(()=>{t.off("mousemove",r),t.off("mouseout",u),i.remove()});function r(a){if(!s.every(_=>t.getLayer(_))){i.remove();return}let p=t.queryRenderedFeatures(a.point,{layers:s});p.length>0?i.setLngLat(a.lngLat).setHTML(l(p[0].properties)).addTo(t):i.remove()}function u(){i.remove()}return o.$$set=a=>{"layers"in a&&n(0,s=a.layers),"contents"in a&&n(1,l=a.contents)},[s,l]}class ut extends z{constructor(e){super(),j(this,e,Ze,null,q,{layers:0,contents:1})}}function Ve(o){let e,n,t,s,l,i,r,u,a,p,_,d,f,S,w;return{c(){e=b("li"),n=b("span"),t=L("Areas"),s=M(),l=b("li"),i=b("span"),r=L("Routes"),u=M(),a=b("li"),p=b("span"),_=L("Crossings"),d=M(),f=b("li"),S=b("span"),w=L("Other"),m(n,"class","svelte-l42ea0"),F(n,"background",k.area),m(i,"class","svelte-l42ea0"),F(i,"background",k.route),m(p,"class","svelte-l42ea0"),F(p,"background",k.crossing),m(S,"class","svelte-l42ea0"),F(S,"background",k.other)},m(c,h){v(c,e,h),g(e,n),g(e,t),v(c,s,h),v(c,l,h),g(l,i),g(l,r),v(c,u,h),v(c,a,h),g(a,p),g(a,_),v(c,d,h),v(c,f,h),g(f,S),g(f,w)},p:B,d(c){c&&y(e),c&&y(s),c&&y(l),c&&y(u),c&&y(a),c&&y(d),c&&y(f)}}}function He(o){let e,n,t,s,l,i,r,u,a,p,_,d,f,S,w;return{c(){e=b("li"),n=b("span"),t=L("Preapp"),s=M(),l=b("li"),i=b("span"),r=L("Outline"),u=M(),a=b("li"),p=b("span"),_=L("Reserved matters"),d=M(),f=b("li"),S=b("span"),w=L("Local plan"),m(n,"class","svelte-l42ea0"),F(n,"background",k.preapp),m(i,"class","svelte-l42ea0"),F(i,"background",k.outline),m(p,"class","svelte-l42ea0"),F(p,"background",k["reserved matters"]),m(S,"class","svelte-l42ea0"),F(S,"background",k["local plan"])},m(c,h){v(c,e,h),g(e,n),g(e,t),v(c,s,h),v(c,l,h),g(l,i),g(l,r),v(c,u,h),v(c,a,h),g(a,p),g(a,_),v(c,d,h),v(c,f,h),g(f,S),g(f,w)},p:B,d(c){c&&y(e),c&&y(s),c&&y(l),c&&y(u),c&&y(a),c&&y(d),c&&y(f)}}}function Ue(o){let e;function n(l,i){return l[0]=="planning"?He:Ve}let t=n(o),s=t(o);return{c(){e=b("ul"),s.c()},m(l,i){v(l,e,i),s.m(e,null)},p(l,i){t===(t=n(l))&&s?s.p(l,i):(s.d(1),s=t(l),s&&(s.c(),s.m(e,null)))},d(l){l&&y(e),s.d()}}}function Ae(o){let e,n,t;return n=new Ne({props:{label:"Objects",open:!0,$$slots:{default:[Ue]},$$scope:{ctx:o}}}),{c(){e=b("div"),ge(n.$$.fragment),m(e,"class","svelte-l42ea0")},m(s,l){v(s,e,l),ve(n,e,null),t=!0},p(s,[l]){const i={};l&3&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){t||(C(n.$$.fragment,s),t=!0)},o(s){I(n.$$.fragment,s),t=!1},d(s){s&&y(e),ye(n)}}}function Ke(o,e,n){let{schema:t}=e;return o.$$set=s=>{"schema"in s&&n(0,t=s.schema)},[t]}class ft extends z{constructor(e){super(),j(this,e,Ke,Ae,q,{schema:0})}}function se(o){let e;const n=o[4].default,t=P(n,o,o[3],null);return{c(){t&&t.c()},m(s,l){t&&t.m(s,l),e=!0},p(s,l){t&&t.p&&(!e||l&8)&&R(t,n,s,s[3],e?W(n,s[3],l,null):G(s[3]),null)},i(s){e||(C(t,s),e=!0)},o(s){I(t,s),e=!1},d(s){t&&t.d(s)}}}function Qe(o){let e,n,t=o[1]&&se(o);return{c(){e=b("div"),t&&t.c(),m(e,"class","map svelte-12dpf1u")},m(s,l){v(s,e,l),t&&t.m(e,null),o[5](e),n=!0},p(s,[l]){s[1]?t?(t.p(s,l),l&2&&C(t,1)):(t=se(s),t.c(),C(t,1),t.m(e,null)):t&&(oe(),I(t,1,1,()=>{t=null}),le())},i(s){n||(C(t),n=!0)},o(s){I(t),n=!1},d(s){s&&y(e),t&&t.d(),o[5](null)}}}function Xe(o,e,n){let{$$slots:t={},$$scope:s}=e,{style:l}=e,i,r,u=!1;he("setCamera",!window.location.hash),we(()=>{i=new E.Map({container:r,style:`https://api.maptiler.com/maps/${l}/style.json?key=MZEJTanw3WpxRvt7qDfo`,hash:!0}),i.addControl(new E.ScaleControl({})),i.addControl(new E.NavigationControl({visualizePitch:!0}),"bottom-right"),i.on("load",()=>{n(1,u=!0),N.set(i)}),new ResizeObserver(()=>{i.resize()}).observe(r)}),ie(()=>{i.remove()});function a(p){ke[p?"unshift":"push"](()=>{r=p,n(0,r)})}return o.$$set=p=>{"style"in p&&n(2,l=p.style),"$$scope"in p&&n(3,s=p.$$scope)},[r,u,l,s,t,a]}class pt extends z{constructor(e){super(),j(this,e,Xe,Qe,q,{style:2})}}const Ye="/atip/kelin_colors/assets/zoom_out_map-b2e1091a.svg";function xe(o){let e,n,t,s,l;return{c(){e=b("button"),n=b("img"),Se(n.src,t=Ye)||m(n,"src",t),m(n,"alt","Zoom to show entire boundary"),m(e,"type","button"),m(e,"title","Zoom to show entire boundary"),m(e,"class","svelte-qzjsqo")},m(i,r){v(i,e,r),g(e,n),s||(l=$(e,"click",o[0]),s=!0)},p:B,i:B,o:B,d(i){i&&y(e),s=!1,l()}}}function et(o,e,n){let t;J(o,N,i=>n(2,t=i));let{boundaryGeojson:s}=e;function l(){t.fitBounds(Ce(s),{padding:20,animate:!0,duration:500})}return o.$$set=i=>{"boundaryGeojson"in i&&n(1,s=i.boundaryGeojson)},[l,s]}class dt extends z{constructor(e){super(),j(this,e,et,xe,q,{boundaryGeojson:1})}}export{st as B,Ne as C,ct as I,rt as L,ut as M,dt as Z,Ie as a,Pe as b,k as c,ot as d,ee as e,Oe as f,ae as g,at as h,lt as i,pt as j,ft as k,Z as l,N as m,it as n,Fe as o,nt as r,qe as s,ze as u};
