var ke=Object.defineProperty;var ve=(E,h,k)=>h in E?ke(E,h,{enumerable:!0,configurable:!0,writable:!0,value:k}):E[h]=k;var ne=(E,h,k)=>(ve(E,typeof h!="symbol"?h+"":h,k),k);(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E=Symbol("Comlink.proxy"),h=Symbol("Comlink.endpoint"),k=Symbol("Comlink.releaseProxy"),U=Symbol("Comlink.finalizer"),F=Symbol("Comlink.thrown"),G=n=>typeof n=="object"&&n!==null||typeof n=="function",te={canHandle:n=>G(n)&&n[E],serialize(n){const{port1:e,port2:t}=new MessageChannel;return z(n,e),[t,[t]]},deserialize(n){return n.start(),ae(n)}},re={canHandle:n=>G(n)&&F in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},J=new Map([["proxy",te],["throw",re]]);function oe(n,e){for(const t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function z(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(o){if(!o||!o.data)return;if(!oe(t,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:l,type:s,path:_}=Object.assign({path:[]},o.data),c=(o.data.argumentList||[]).map(v);let i;try{const d=_.slice(0,-1).reduce((w,j)=>w[j],n),p=_.reduce((w,j)=>w[j],n);switch(s){case"GET":i=p;break;case"SET":d[_.slice(-1)[0]]=v(o.data.value),i=!0;break;case"APPLY":i=p.apply(d,c);break;case"CONSTRUCT":{const w=new p(...c);i=ue(w)}break;case"ENDPOINT":{const{port1:w,port2:j}=new MessageChannel;z(n,j),i=fe(w,[w])}break;case"RELEASE":i=void 0;break;default:return}}catch(d){i={value:d,[F]:0}}Promise.resolve(i).catch(d=>({value:d,[F]:0})).then(d=>{const[p,w]=W(d);e.postMessage(Object.assign(Object.assign({},p),{id:l}),w),s==="RELEASE"&&(e.removeEventListener("message",r),Y(e),U in n&&typeof n[U]=="function"&&n[U]())}).catch(d=>{const[p,w]=W({value:new TypeError("Unserializable return value"),[F]:0});e.postMessage(Object.assign(Object.assign({},p),{id:l}),w)})}),e.start&&e.start()}function ie(n){return n.constructor.name==="MessagePort"}function Y(n){ie(n)&&n.close()}function ae(n,e){return B(n,[],e)}function P(n){if(n)throw new Error("Proxy has been released and is not useable")}function X(n){return A(n,{type:"RELEASE"}).then(()=>{Y(n)})}const C=new WeakMap,N="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const e=(C.get(n)||0)-1;C.set(n,e),e===0&&X(n)});function se(n,e){const t=(C.get(e)||0)+1;C.set(e,t),N&&N.register(n,e,n)}function _e(n){N&&N.unregister(n)}function B(n,e=[],t=function(){}){let r=!1;const o=new Proxy(t,{get(l,s){if(P(r),s===k)return()=>{_e(o),X(n),r=!0};if(s==="then"){if(e.length===0)return{then:()=>o};const _=A(n,{type:"GET",path:e.map(c=>c.toString())}).then(v);return _.then.bind(_)}return B(n,[...e,s])},set(l,s,_){P(r);const[c,i]=W(_);return A(n,{type:"SET",path:[...e,s].map(d=>d.toString()),value:c},i).then(v)},apply(l,s,_){P(r);const c=e[e.length-1];if(c===h)return A(n,{type:"ENDPOINT"}).then(v);if(c==="bind")return B(n,e.slice(0,-1));const[i,d]=K(_);return A(n,{type:"APPLY",path:e.map(p=>p.toString()),argumentList:i},d).then(v)},construct(l,s){P(r);const[_,c]=K(s);return A(n,{type:"CONSTRUCT",path:e.map(i=>i.toString()),argumentList:_},c).then(v)}});return se(o,n),o}function ce(n){return Array.prototype.concat.apply([],n)}function K(n){const e=n.map(W);return[e.map(t=>t[0]),ce(e.map(t=>t[1]))]}const Q=new WeakMap;function fe(n,e){return Q.set(n,e),n}function ue(n){return Object.assign(n,{[E]:!0})}function W(n){for(const[e,t]of J)if(t.canHandle(n)){const[r,o]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:n},Q.get(n)||[]]}function v(n){switch(n.type){case"HANDLER":return J.get(n.name).deserialize(n.value);case"RAW":return n.value}}function A(n,e,t){return new Promise(r=>{const o=le();n.addEventListener("message",function l(s){!s.data||!s.data.id||s.data.id!==o||(n.removeEventListener("message",l),r(s.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:o},e),t)})}function le(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let a;const Z=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Z.decode();let L=null;function R(){return(L===null||L.byteLength===0)&&(L=new Uint8Array(a.memory.buffer)),L}function b(n,e){return n=n>>>0,Z.decode(R().subarray(n,n+e))}const m=new Array(128).fill(void 0);m.push(void 0,null,!0,!1);let x=m.length;function g(n){x===m.length&&m.push(m.length+1);const e=x;return x=m[e],m[e]=n,e}function f(n){return m[n]}function de(n){n<132||(m[n]=x,x=n)}function y(n){const e=f(n);return de(n),e}let S=0;const D=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ge=typeof D.encodeInto=="function"?function(n,e){return D.encodeInto(n,e)}:function(n,e){const t=D.encode(n);return e.set(t),{read:n.length,written:t.length}};function $(n,e,t){if(t===void 0){const _=D.encode(n),c=e(_.length)>>>0;return R().subarray(c,c+_.length).set(_),S=_.length,c}let r=n.length,o=e(r)>>>0;const l=R();let s=0;for(;s<r;s++){const _=n.charCodeAt(s);if(_>127)break;l[o+s]=_}if(s!==r){s!==0&&(n=n.slice(s)),o=t(o,r,r=s+n.length*3)>>>0;const _=R().subarray(o+s,o+r),c=ge(n,_);s+=c.written}return S=s,o}function M(n){return n==null}let I=null;function u(){return(I===null||I.byteLength===0)&&(I=new Int32Array(a.memory.buffer)),I}let O=null;function be(){return(O===null||O.byteLength===0)&&(O=new Float64Array(a.memory.buffer)),O}let T=null;function we(){return(T===null||T.byteLength===0)&&(T=new BigInt64Array(a.memory.buffer)),T}function H(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let l="[";o>0&&(l+=H(n[0]));for(let s=1;s<o;s++)l+=", "+H(n[s]);return l+="]",l}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function ye(n,e){const t=e(n.length*1)>>>0;return R().set(n,t/1),S=n.length,t}function V(n,e){try{return n.apply(this,e)}catch(t){a.__wbindgen_exn_store(g(t))}}let q=class{static __wrap(e){e=e>>>0;const t=Object.create(q.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();a.__wbg_routeinfo_free(e)}constructor(e){try{const l=a.__wbindgen_add_to_stack_pointer(-16),s=ye(e,a.__wbindgen_malloc),_=S;a.routeinfo_new(l,s,_);var t=u()[l/4+0],r=u()[l/4+1],o=u()[l/4+2];if(o)throw y(r);return q.__wrap(t)}finally{a.__wbindgen_add_to_stack_pointer(16)}}nameForRoute(e){let t,r;try{const d=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_nameForRoute(d,this.__wbg_ptr,g(e));var o=u()[d/4+0],l=u()[d/4+1],s=u()[d/4+2],_=u()[d/4+3],c=o,i=l;if(_)throw c=0,i=0,y(s);return t=c,r=i,b(c,i)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(t,r)}}speedLimitForRoute(e){let t,r;try{const d=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_speedLimitForRoute(d,this.__wbg_ptr,g(e));var o=u()[d/4+0],l=u()[d/4+1],s=u()[d/4+2],_=u()[d/4+3],c=o,i=l;if(_)throw c=0,i=0,y(s);return t=c,r=i,b(c,i)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(t,r)}}allSpeedLimits(){let e,t;try{const i=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_allSpeedLimits(i,this.__wbg_ptr);var r=u()[i/4+0],o=u()[i/4+1],l=u()[i/4+2],s=u()[i/4+3],_=r,c=o;if(s)throw _=0,c=0,y(l);return e=_,t=c,b(_,c)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(e,t)}}renderLanePolygons(){let e,t;try{const i=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_renderLanePolygons(i,this.__wbg_ptr);var r=u()[i/4+0],o=u()[i/4+1],l=u()[i/4+2],s=u()[i/4+3],_=r,c=o;if(s)throw _=0,c=0,y(l);return e=_,t=c,b(_,c)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(e,t)}}renderLaneMarkings(){let e,t;try{const i=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_renderLaneMarkings(i,this.__wbg_ptr);var r=u()[i/4+0],o=u()[i/4+1],l=u()[i/4+2],s=u()[i/4+3],_=r,c=o;if(s)throw _=0,c=0,y(l);return e=_,t=c,b(_,c)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(e,t)}}renderIntersectionPolygons(){let e,t;try{const i=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_renderIntersectionPolygons(i,this.__wbg_ptr);var r=u()[i/4+0],o=u()[i/4+1],l=u()[i/4+2],s=u()[i/4+3],_=r,c=o;if(s)throw _=0,c=0,y(l);return e=_,t=c,b(_,c)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(e,t)}}renderIntersectionMarkings(){let e,t;try{const i=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_renderIntersectionMarkings(i,this.__wbg_ptr);var r=u()[i/4+0],o=u()[i/4+1],l=u()[i/4+2],s=u()[i/4+3],_=r,c=o;if(s)throw _=0,c=0,y(l);return e=_,t=c,b(_,c)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(e,t)}}renderLaneDetailsForRoute(e){let t,r;try{const d=a.__wbindgen_add_to_stack_pointer(-16);a.routeinfo_renderLaneDetailsForRoute(d,this.__wbg_ptr,g(e));var o=u()[d/4+0],l=u()[d/4+1],s=u()[d/4+2],_=u()[d/4+3],c=o,i=l;if(_)throw c=0,i=0,y(s);return t=c,r=i,b(c,i)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(t,r)}}};async function he(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function me(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const r=b(e,t);return g(r)},n.wbg.__wbindgen_object_drop_ref=function(e){y(e)},n.wbg.__wbindgen_string_get=function(e,t){const r=f(t),o=typeof r=="string"?r:void 0;var l=M(o)?0:$(o,a.__wbindgen_malloc,a.__wbindgen_realloc),s=S;u()[e/4+1]=s,u()[e/4+0]=l},n.wbg.__wbindgen_boolean_get=function(e){const t=f(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_error_new=function(e,t){const r=new Error(b(e,t));return g(r)},n.wbg.__wbindgen_is_bigint=function(e){return typeof f(e)=="bigint"},n.wbg.__wbindgen_bigint_from_i64=function(e){return g(e)},n.wbg.__wbindgen_jsval_eq=function(e,t){return f(e)===f(t)},n.wbg.__wbindgen_number_get=function(e,t){const r=f(t),o=typeof r=="number"?r:void 0;be()[e/8+1]=M(o)?0:o,u()[e/4+0]=!M(o)},n.wbg.__wbindgen_is_object=function(e){const t=f(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_in=function(e,t){return f(e)in f(t)},n.wbg.__wbindgen_bigint_from_u64=function(e){const t=BigInt.asUintN(64,e);return g(t)},n.wbg.__wbindgen_is_undefined=function(e){return f(e)===void 0},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return f(e)==f(t)},n.wbg.__wbindgen_object_clone_ref=function(e){const t=f(e);return g(t)},n.wbg.__wbg_getwithrefkey_5e6d9547403deab8=function(e,t){const r=f(e)[f(t)];return g(r)},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return g(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const r=f(t).stack,o=$(r,a.__wbindgen_malloc,a.__wbindgen_realloc),l=S;u()[e/4+1]=l,u()[e/4+0]=o},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let r,o;try{r=e,o=t,console.error(b(e,t))}finally{a.__wbindgen_free(r,o)}},n.wbg.__wbg_debug_917e579618ee56f5=function(e){console.debug(f(e))},n.wbg.__wbg_error_ea7597dedb63d9a4=function(e){console.error(f(e))},n.wbg.__wbg_info_fc2a17f38101c41c=function(e){console.info(f(e))},n.wbg.__wbg_log_003c998d6df63565=function(e){console.log(f(e))},n.wbg.__wbg_warn_ebfcadd0780df93a=function(e){console.warn(f(e))},n.wbg.__wbg_get_e52aaca45f37b337=function(e,t){const r=f(e)[t>>>0];return g(r)},n.wbg.__wbg_length_070e3265c186df02=function(e){return f(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof f(e)=="function"},n.wbg.__wbg_next_3975dcca26737a22=function(e){const t=f(e).next;return g(t)},n.wbg.__wbg_next_5a9700550e162aa3=function(){return V(function(e){const t=f(e).next();return g(t)},arguments)},n.wbg.__wbg_done_a184612220756243=function(e){return f(e).done},n.wbg.__wbg_value_6cc144c1d9645dd5=function(e){const t=f(e).value;return g(t)},n.wbg.__wbg_iterator_c1677479667ea090=function(){return g(Symbol.iterator)},n.wbg.__wbg_get_363c3b466fe4896b=function(){return V(function(e,t){const r=Reflect.get(f(e),f(t));return g(r)},arguments)},n.wbg.__wbg_call_f96b398515635514=function(){return V(function(e,t){const r=f(e).call(f(t));return g(r)},arguments)},n.wbg.__wbg_isArray_07d89ced8fb14171=function(e){return Array.isArray(f(e))},n.wbg.__wbg_instanceof_ArrayBuffer_de688b806c28ff28=function(e){let t;try{t=f(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_isSafeInteger_fcdf4c4f25c86778=function(e){return Number.isSafeInteger(f(e))},n.wbg.__wbg_entries_c3e06bf0354f5d20=function(e){const t=Object.entries(f(e));return g(t)},n.wbg.__wbg_buffer_fcbfb6d88b2732e9=function(e){const t=f(e).buffer;return g(t)},n.wbg.__wbg_new_bc5d9aad3f9ac80e=function(e){const t=new Uint8Array(f(e));return g(t)},n.wbg.__wbg_set_4b3aa8445ac1e91c=function(e,t,r){f(e).set(f(t),r>>>0)},n.wbg.__wbg_length_d9c4ded7e708c6a1=function(e){return f(e).length},n.wbg.__wbg_instanceof_Uint8Array_4733577ba827276b=function(e){let t;try{t=f(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const r=f(t),o=typeof r=="bigint"?r:void 0;we()[e/8+1]=M(o)?BigInt(0):o,u()[e/4+0]=!M(o)},n.wbg.__wbindgen_debug_string=function(e,t){const r=H(f(t)),o=$(r,a.__wbindgen_malloc,a.__wbindgen_realloc),l=S;u()[e/4+1]=l,u()[e/4+0]=o},n.wbg.__wbindgen_throw=function(e,t){throw new Error(b(e,t))},n.wbg.__wbindgen_memory=function(){const e=a.memory;return g(e)},n}function pe(n,e){return a=n.exports,ee.__wbindgen_wasm_module=e,T=null,O=null,I=null,L=null,a}async function ee(n){if(a!==void 0)return a;typeof n>"u"&&(n="/atip/layer_lanes/assets/route_info_bg.wasm");const e=me();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await he(await n,e);return pe(t,r)}class Ee{constructor(){ne(this,"inner");this.inner=null}async loadFile(e){await ee(),console.log(`Grabbing A/B Street map model data from ${e}`);let r=await(await fetch(e)).arrayBuffer();this.inner=new q(new Uint8Array(r)),console.log("RouteInfo is ready!")}nameForRoute(e){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");return this.inner.nameForRoute(e)}speedLimitForRoute(e){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");return this.inner.speedLimitForRoute(e)}allSpeedLimits(){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");return this.inner.allSpeedLimits()}renderAllLaneDetails(){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");console.log("do 1");let e=this.inner.renderLanePolygons();console.log("do 2");let t=this.inner.renderLaneMarkings();return[e,t,"",""]}renderLaneDetailsForRoute(e){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");return JSON.parse(this.inner.renderLaneDetailsForRoute(e))}}z(Ee)})();
