var ke=Object.defineProperty;var Ae=(E,y,k)=>y in E?ke(E,y,{enumerable:!0,configurable:!0,writable:!0,value:k}):E[y]=k;var ne=(E,y,k)=>(Ae(E,typeof y!="symbol"?y+"":y,k),k);(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),k=Symbol("Comlink.releaseProxy"),z=Symbol("Comlink.finalizer"),P=Symbol("Comlink.thrown"),G=e=>typeof e=="object"&&e!==null||typeof e=="function",te={canHandle:e=>G(e)&&e[E],serialize(e){const{port1:n,port2:t}=new MessageChannel;return B(e,n),[t,[t]]},deserialize(e){return e.start(),se(e)}},re={canHandle:e=>G(e)&&P in e,serialize({value:e}){let n;return e instanceof Error?n={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:n={isError:!1,value:e},[n,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},Y=new Map([["proxy",te],["throw",re]]);function oe(e,n){for(const t of e)if(n===t||t==="*"||t instanceof RegExp&&t.test(n))return!0;return!1}function B(e,n=globalThis,t=["*"]){n.addEventListener("message",function r(o){if(!o||!o.data)return;if(!oe(t,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:u,type:a,path:c}=Object.assign({path:[]},o.data),f=(o.data.argumentList||[]).map(A);let i;try{const d=c.slice(0,-1).reduce((b,j)=>b[j],e),p=c.reduce((b,j)=>b[j],e);switch(a){case"GET":i=p;break;case"SET":d[c.slice(-1)[0]]=A(o.data.value),i=!0;break;case"APPLY":i=p.apply(d,f);break;case"CONSTRUCT":{const b=new p(...f);i=ue(b)}break;case"ENDPOINT":{const{port1:b,port2:j}=new MessageChannel;B(e,j),i=fe(b,[b])}break;case"RELEASE":i=void 0;break;default:return}}catch(d){i={value:d,[P]:0}}Promise.resolve(i).catch(d=>({value:d,[P]:0})).then(d=>{const[p,b]=N(d);n.postMessage(Object.assign(Object.assign({},p),{id:u}),b),a==="RELEASE"&&(n.removeEventListener("message",r),J(n),z in e&&typeof e[z]=="function"&&e[z]())}).catch(d=>{const[p,b]=N({value:new TypeError("Unserializable return value"),[P]:0});n.postMessage(Object.assign(Object.assign({},p),{id:u}),b)})}),n.start&&n.start()}function ie(e){return e.constructor.name==="MessagePort"}function J(e){ie(e)&&e.close()}function se(e,n){return D(e,[],n)}function F(e){if(e)throw new Error("Proxy has been released and is not useable")}function X(e){return v(e,{type:"RELEASE"}).then(()=>{J(e)})}const C=new WeakMap,W="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const n=(C.get(e)||0)-1;C.set(e,n),n===0&&X(e)});function ae(e,n){const t=(C.get(n)||0)+1;C.set(n,t),W&&W.register(e,n,e)}function ce(e){W&&W.unregister(e)}function D(e,n=[],t=function(){}){let r=!1;const o=new Proxy(t,{get(u,a){if(F(r),a===k)return()=>{ce(o),X(e),r=!0};if(a==="then"){if(n.length===0)return{then:()=>o};const c=v(e,{type:"GET",path:n.map(f=>f.toString())}).then(A);return c.then.bind(c)}return D(e,[...n,a])},set(u,a,c){F(r);const[f,i]=N(c);return v(e,{type:"SET",path:[...n,a].map(d=>d.toString()),value:f},i).then(A)},apply(u,a,c){F(r);const f=n[n.length-1];if(f===y)return v(e,{type:"ENDPOINT"}).then(A);if(f==="bind")return D(e,n.slice(0,-1));const[i,d]=K(c);return v(e,{type:"APPLY",path:n.map(p=>p.toString()),argumentList:i},d).then(A)},construct(u,a){F(r);const[c,f]=K(a);return v(e,{type:"CONSTRUCT",path:n.map(i=>i.toString()),argumentList:c},f).then(A)}});return ae(o,e),o}function _e(e){return Array.prototype.concat.apply([],e)}function K(e){const n=e.map(N);return[n.map(t=>t[0]),_e(n.map(t=>t[1]))]}const Q=new WeakMap;function fe(e,n){return Q.set(e,n),e}function ue(e){return Object.assign(e,{[E]:!0})}function N(e){for(const[n,t]of Y)if(t.canHandle(e)){const[r,o]=t.serialize(e);return[{type:"HANDLER",name:n,value:r},o]}return[{type:"RAW",value:e},Q.get(e)||[]]}function A(e){switch(e.type){case"HANDLER":return Y.get(e.name).deserialize(e.value);case"RAW":return e.value}}function v(e,n,t){return new Promise(r=>{const o=le();e.addEventListener("message",function u(a){!a.data||!a.data.id||a.data.id!==o||(e.removeEventListener("message",u),r(a.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:o},n),t)})}function le(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let s;const Z=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Z.decode();let L=null;function R(){return(L===null||L.byteLength===0)&&(L=new Uint8Array(s.memory.buffer)),L}function w(e,n){return e=e>>>0,Z.decode(R().subarray(e,e+n))}const m=new Array(128).fill(void 0);m.push(void 0,null,!0,!1);let x=m.length;function g(e){x===m.length&&m.push(m.length+1);const n=x;return x=m[n],m[n]=e,n}function _(e){return m[e]}let S=0;const U=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},de=typeof U.encodeInto=="function"?function(e,n){return U.encodeInto(e,n)}:function(e,n){const t=U.encode(e);return n.set(t),{read:e.length,written:t.length}};function $(e,n,t){if(t===void 0){const c=U.encode(e),f=n(c.length)>>>0;return R().subarray(f,f+c.length).set(c),S=c.length,f}let r=e.length,o=n(r)>>>0;const u=R();let a=0;for(;a<r;a++){const c=e.charCodeAt(a);if(c>127)break;u[o+a]=c}if(a!==r){a!==0&&(e=e.slice(a)),o=t(o,r,r=a+e.length*3)>>>0;const c=R().subarray(o+a,o+r),f=de(e,c);a+=f.written}return S=a,o}function M(e){return e==null}let I=null;function l(){return(I===null||I.byteLength===0)&&(I=new Int32Array(s.memory.buffer)),I}function ge(e){e<132||(m[e]=x,x=e)}function h(e){const n=_(e);return ge(e),n}let T=null;function be(){return(T===null||T.byteLength===0)&&(T=new Float64Array(s.memory.buffer)),T}let O=null;function we(){return(O===null||O.byteLength===0)&&(O=new BigInt64Array(s.memory.buffer)),O}function H(e){const n=typeof e;if(n=="number"||n=="boolean"||e==null)return`${e}`;if(n=="string")return`"${e}"`;if(n=="symbol"){const o=e.description;return o==null?"Symbol":`Symbol(${o})`}if(n=="function"){const o=e.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(e)){const o=e.length;let u="[";o>0&&(u+=H(e[0]));for(let a=1;a<o;a++)u+=", "+H(e[a]);return u+="]",u}const t=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(t.length>1)r=t[1];else return toString.call(e);if(r=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:r}function ye(e,n){const t=n(e.length*1)>>>0;return R().set(e,t/1),S=e.length,t}function V(e,n){try{return e.apply(this,n)}catch(t){s.__wbindgen_exn_store(g(t))}}let q=class{static __wrap(n){n=n>>>0;const t=Object.create(q.prototype);return t.__wbg_ptr=n,t}__destroy_into_raw(){const n=this.__wbg_ptr;return this.__wbg_ptr=0,n}free(){const n=this.__destroy_into_raw();s.__wbg_routeinfo_free(n)}constructor(n){try{const u=s.__wbindgen_add_to_stack_pointer(-16),a=ye(n,s.__wbindgen_malloc),c=S;s.routeinfo_new(u,a,c);var t=l()[u/4+0],r=l()[u/4+1],o=l()[u/4+2];if(o)throw h(r);return q.__wrap(t)}finally{s.__wbindgen_add_to_stack_pointer(16)}}nameForRoute(n){let t,r;try{const d=s.__wbindgen_add_to_stack_pointer(-16);s.routeinfo_nameForRoute(d,this.__wbg_ptr,g(n));var o=l()[d/4+0],u=l()[d/4+1],a=l()[d/4+2],c=l()[d/4+3],f=o,i=u;if(c)throw f=0,i=0,h(a);return t=f,r=i,w(f,i)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(t,r)}}speedLimitForRoute(n){let t,r;try{const d=s.__wbindgen_add_to_stack_pointer(-16);s.routeinfo_speedLimitForRoute(d,this.__wbg_ptr,g(n));var o=l()[d/4+0],u=l()[d/4+1],a=l()[d/4+2],c=l()[d/4+3],f=o,i=u;if(c)throw f=0,i=0,h(a);return t=f,r=i,w(f,i)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(t,r)}}allSpeedLimits(){let n,t;try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.routeinfo_allSpeedLimits(i,this.__wbg_ptr);var r=l()[i/4+0],o=l()[i/4+1],u=l()[i/4+2],a=l()[i/4+3],c=r,f=o;if(a)throw c=0,f=0,h(u);return n=c,t=f,w(c,f)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(n,t)}}renderLanePolygons(){let n,t;try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.routeinfo_renderLanePolygons(i,this.__wbg_ptr);var r=l()[i/4+0],o=l()[i/4+1],u=l()[i/4+2],a=l()[i/4+3],c=r,f=o;if(a)throw c=0,f=0,h(u);return n=c,t=f,w(c,f)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(n,t)}}renderLaneMarkings(){let n,t;try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.routeinfo_renderLaneMarkings(i,this.__wbg_ptr);var r=l()[i/4+0],o=l()[i/4+1],u=l()[i/4+2],a=l()[i/4+3],c=r,f=o;if(a)throw c=0,f=0,h(u);return n=c,t=f,w(c,f)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(n,t)}}renderIntersectionPolygons(){let n,t;try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.routeinfo_renderIntersectionPolygons(i,this.__wbg_ptr);var r=l()[i/4+0],o=l()[i/4+1],u=l()[i/4+2],a=l()[i/4+3],c=r,f=o;if(a)throw c=0,f=0,h(u);return n=c,t=f,w(c,f)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(n,t)}}renderIntersectionMarkings(){let n,t;try{const i=s.__wbindgen_add_to_stack_pointer(-16);s.routeinfo_renderIntersectionMarkings(i,this.__wbg_ptr);var r=l()[i/4+0],o=l()[i/4+1],u=l()[i/4+2],a=l()[i/4+3],c=r,f=o;if(a)throw c=0,f=0,h(u);return n=c,t=f,w(c,f)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(n,t)}}};async function me(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(r){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}else{const t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}function he(){const e={};return e.wbg={},e.wbg.__wbindgen_string_new=function(n,t){const r=w(n,t);return g(r)},e.wbg.__wbindgen_error_new=function(n,t){const r=new Error(w(n,t));return g(r)},e.wbg.__wbindgen_string_get=function(n,t){const r=_(t),o=typeof r=="string"?r:void 0;var u=M(o)?0:$(o,s.__wbindgen_malloc,s.__wbindgen_realloc),a=S;l()[n/4+1]=a,l()[n/4+0]=u},e.wbg.__wbindgen_object_drop_ref=function(n){h(n)},e.wbg.__wbindgen_boolean_get=function(n){const t=_(n);return typeof t=="boolean"?t?1:0:2},e.wbg.__wbindgen_is_bigint=function(n){return typeof _(n)=="bigint"},e.wbg.__wbindgen_bigint_from_i64=function(n){return g(n)},e.wbg.__wbindgen_jsval_eq=function(n,t){return _(n)===_(t)},e.wbg.__wbindgen_number_get=function(n,t){const r=_(t),o=typeof r=="number"?r:void 0;be()[n/8+1]=M(o)?0:o,l()[n/4+0]=!M(o)},e.wbg.__wbindgen_is_object=function(n){const t=_(n);return typeof t=="object"&&t!==null},e.wbg.__wbindgen_in=function(n,t){return _(n)in _(t)},e.wbg.__wbindgen_bigint_from_u64=function(n){const t=BigInt.asUintN(64,n);return g(t)},e.wbg.__wbindgen_is_undefined=function(n){return _(n)===void 0},e.wbg.__wbindgen_jsval_loose_eq=function(n,t){return _(n)==_(t)},e.wbg.__wbindgen_object_clone_ref=function(n){const t=_(n);return g(t)},e.wbg.__wbg_getwithrefkey_5e6d9547403deab8=function(n,t){const r=_(n)[_(t)];return g(r)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){const n=new Error;return g(n)},e.wbg.__wbg_stack_658279fe44541cf6=function(n,t){const r=_(t).stack,o=$(r,s.__wbindgen_malloc,s.__wbindgen_realloc),u=S;l()[n/4+1]=u,l()[n/4+0]=o},e.wbg.__wbg_error_f851667af71bcfc6=function(n,t){let r,o;try{r=n,o=t,console.error(w(n,t))}finally{s.__wbindgen_free(r,o)}},e.wbg.__wbg_debug_917e579618ee56f5=function(n){console.debug(_(n))},e.wbg.__wbg_error_ea7597dedb63d9a4=function(n){console.error(_(n))},e.wbg.__wbg_info_fc2a17f38101c41c=function(n){console.info(_(n))},e.wbg.__wbg_log_003c998d6df63565=function(n){console.log(_(n))},e.wbg.__wbg_warn_ebfcadd0780df93a=function(n){console.warn(_(n))},e.wbg.__wbg_get_e52aaca45f37b337=function(n,t){const r=_(n)[t>>>0];return g(r)},e.wbg.__wbg_length_070e3265c186df02=function(n){return _(n).length},e.wbg.__wbindgen_is_function=function(n){return typeof _(n)=="function"},e.wbg.__wbg_next_3975dcca26737a22=function(n){const t=_(n).next;return g(t)},e.wbg.__wbg_next_5a9700550e162aa3=function(){return V(function(n){const t=_(n).next();return g(t)},arguments)},e.wbg.__wbg_done_a184612220756243=function(n){return _(n).done},e.wbg.__wbg_value_6cc144c1d9645dd5=function(n){const t=_(n).value;return g(t)},e.wbg.__wbg_iterator_c1677479667ea090=function(){return g(Symbol.iterator)},e.wbg.__wbg_get_363c3b466fe4896b=function(){return V(function(n,t){const r=Reflect.get(_(n),_(t));return g(r)},arguments)},e.wbg.__wbg_call_f96b398515635514=function(){return V(function(n,t){const r=_(n).call(_(t));return g(r)},arguments)},e.wbg.__wbg_isArray_07d89ced8fb14171=function(n){return Array.isArray(_(n))},e.wbg.__wbg_instanceof_ArrayBuffer_de688b806c28ff28=function(n){let t;try{t=_(n)instanceof ArrayBuffer}catch{t=!1}return t},e.wbg.__wbg_isSafeInteger_fcdf4c4f25c86778=function(n){return Number.isSafeInteger(_(n))},e.wbg.__wbg_entries_c3e06bf0354f5d20=function(n){const t=Object.entries(_(n));return g(t)},e.wbg.__wbg_buffer_fcbfb6d88b2732e9=function(n){const t=_(n).buffer;return g(t)},e.wbg.__wbg_new_bc5d9aad3f9ac80e=function(n){const t=new Uint8Array(_(n));return g(t)},e.wbg.__wbg_set_4b3aa8445ac1e91c=function(n,t,r){_(n).set(_(t),r>>>0)},e.wbg.__wbg_length_d9c4ded7e708c6a1=function(n){return _(n).length},e.wbg.__wbg_instanceof_Uint8Array_4733577ba827276b=function(n){let t;try{t=_(n)instanceof Uint8Array}catch{t=!1}return t},e.wbg.__wbindgen_bigint_get_as_i64=function(n,t){const r=_(t),o=typeof r=="bigint"?r:void 0;we()[n/8+1]=M(o)?BigInt(0):o,l()[n/4+0]=!M(o)},e.wbg.__wbindgen_debug_string=function(n,t){const r=H(_(t)),o=$(r,s.__wbindgen_malloc,s.__wbindgen_realloc),u=S;l()[n/4+1]=u,l()[n/4+0]=o},e.wbg.__wbindgen_throw=function(n,t){throw new Error(w(n,t))},e.wbg.__wbindgen_memory=function(){const n=s.memory;return g(n)},e}function pe(e,n){return s=e.exports,ee.__wbindgen_wasm_module=n,O=null,T=null,I=null,L=null,s}async function ee(e){if(s!==void 0)return s;typeof e>"u"&&(e="/atip/layer_lanes/assets/route_info_bg.wasm");const n=he();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:r}=await me(await e,n);return pe(t,r)}class Ee{constructor(){ne(this,"inner");this.inner=null}async loadFile(n){await ee(),console.log(`Grabbing A/B Street map model data from ${n}`);let r=await(await fetch(n)).arrayBuffer();this.inner=new q(new Uint8Array(r)),console.log("RouteInfo is ready!")}nameForRoute(n){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");return this.inner.nameForRoute(n)}speedLimitForRoute(n){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");return this.inner.speedLimitForRoute(n)}allSpeedLimits(){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");return this.inner.allSpeedLimits()}renderLaneDetails(){if(!this.inner)throw new Error("Still loading route info, please retry after a few seconds");console.log("do 1");let n=this.inner.renderLanePolygons();console.log("do 2");let t=this.inner.renderLaneMarkings();return[n,t,"",""]}}B(Ee)})();
