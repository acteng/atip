import{S as V,i as q,s as K,M as zn,b as U,c as z,e as D,d as O,g as _,ax as Gn,h as R,j as m,k as T,m as w,w as It,l as G,t as d,n as g,p as h,q as b,aJ as tn,aK as rn,aL as nn,aM as on,u as y,f as or,x as Q,an as Vn,N as X,C as re,ap as sn,T as mt,r as Ft,F as ln,a as Kt,v as pr,I as Le,aR as le,Y as ge,G as ue,aQ as B,az as ze,ao as xe,aA as Et,y as ae,o as fe,Q as Ve,aS as Ge,P as sr,aT as qn,_ as an,Z as ht,E as fn,a2 as xt,R as un,aU as $r,D as Kn,aV as mr,a5 as cn,L as Zn,z as Xn,aG as Yn}from"./index-16feadf9.js";import{e as Pt,C as Fe,b as St,d as te,a as Jn,S as Qn,L as eo,M as to}from"./StreetViewController-73e22430.js";import{L as ro,d as hr,c as pn,C as _e,B as no,Z as oo,I as so}from"./schemas-9ac3cfe0.js";import{I as J}from"./InteractiveLayer-15c0cd5a.js";import{F as io}from"./FileInput-5fc77189.js";const lo="/atip/less_route_info/assets/help-d011708a.svg";function ao(t){let e,r;const n=t[1].default,o=tn(n,t,t[4],null);return{c(){e=D("div"),o&&o.c(),R(e,"class","govuk-prose")},m(s,l){m(s,e,l),o&&o.m(e,null),r=!0},p(s,l){o&&o.p&&(!r||l&16)&&rn(o,n,s,s[4],r?on(n,s[4],l,null):nn(s[4]),null)},i(s){r||(d(o,s),r=!0)},o(s){g(o,s),r=!1},d(s){s&&h(e),o&&o.d(s)}}}function fo(t){let e,r,n,o,s,l,u,i,f;function a(p){t[3](p)}let c={title:"Help",$$slots:{default:[ao]},$$scope:{ctx:t}};return t[0]!==void 0&&(c.open=t[0]),s=new zn({props:c}),U.push(()=>z(s,"open",a)),{c(){e=D("button"),r=D("img"),o=O(),_(s.$$.fragment),Gn(r.src,n=lo)||R(r,"src",n),R(r,"title","Help"),R(r,"alt","Help"),R(e,"class","svelte-7d9d1l")},m(p,$){m(p,e,$),T(e,r),m(p,o,$),w(s,p,$),u=!0,i||(f=It(e,"click",t[2]),i=!0)},p(p,[$]){const v={};$&16&&(v.$$scope={dirty:$,ctx:p}),!l&&$&1&&(l=!0,v.open=p[0],G(()=>l=!1)),s.$set(v)},i(p){u||(d(s.$$.fragment,p),u=!0)},o(p){g(s.$$.fragment,p),u=!1},d(p){p&&(h(e),h(o)),b(s,p),i=!1,f()}}}function uo(t,e,r){let{$$slots:n={},$$scope:o}=e,s=!1;const l=()=>r(0,s=!0);function u(i){s=i,r(0,s)}return t.$$set=i=>{"$$scope"in i&&r(4,o=i.$$scope)},[s,n,l,u,o]}class ne extends V{constructor(e){super(),q(this,e,uo,fo,K,{})}}function co(t){let e;return{c(){e=D("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function po(t){let e,r,n,o,s=t[0]=="Private (development)"&&co();return{c(){s&&s.c(),e=O(),r=D("p"),r.textContent="Note the ATF scheme data has not been validated.",n=O(),o=D("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,u){s&&s.m(l,u),m(l,e,u),m(l,r,u),m(l,n,u),m(l,o,u)},p:Q,d(l){l&&(h(e),h(r),h(n),h(o)),s&&s.d(l)}}}function $o(t){let e,r,n,o,s,l;return s=new ne({props:{$$slots:{default:[po]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("App version: "),n=y(t[0]),o=O(),_(s.$$.fragment)},m(u,i){m(u,e,i),T(e,r),T(e,n),T(e,o),w(s,e,null),l=!0},p(u,[i]){const f={};i&2&&(f.$$scope={dirty:i,ctx:u}),s.$set(f)},i(u){l||(d(s.$$.fragment,u),l=!0)},o(u){g(s.$$.fragment,u),l=!1},d(u){u&&h(e),b(s)}}}function mo(t){return[or()]}class ho extends V{constructor(e){super(),q(this,e,mo,$o,K,{})}}const go={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var me=Uint8Array,rt=Uint16Array,$n=Uint32Array,mn=new me([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hn=new me([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),_o=new me([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dn=function(t,e){for(var r=new rt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new $n(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},gn=dn(mn,2),_n=gn[0],wo=gn[1];_n[28]=258,wo[258]=28;var bo=dn(hn,0),vo=bo[0],Zt=new rt(32768);for(var Y=0;Y<32768;++Y){var je=(Y&43690)>>>1|(Y&21845)<<1;je=(je&52428)>>>2|(je&13107)<<2,je=(je&61680)>>>4|(je&3855)<<4,Zt[Y]=((je&65280)>>>8|(je&255)<<8)>>>1}var bt=function(t,e,r){for(var n=t.length,o=0,s=new rt(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new rt(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var u;if(r){u=new rt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)u[Zt[c]>>>i]=f}else for(u=new rt(n),o=0;o<n;++o)t[o]&&(u[o]=Zt[l[t[o]-1]++]>>>15-t[o]);return u},Ct=new me(288);for(var Y=0;Y<144;++Y)Ct[Y]=8;for(var Y=144;Y<256;++Y)Ct[Y]=9;for(var Y=256;Y<280;++Y)Ct[Y]=7;for(var Y=280;Y<288;++Y)Ct[Y]=8;var wn=new me(32);for(var Y=0;Y<32;++Y)wn[Y]=5;var yo=bt(Ct,9,1),ko=bt(wn,5,1),jt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Rt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},So=function(t){return(t+7)/8|0},ir=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?rt:t.BYTES_PER_ELEMENT==4?$n:me)(r-e);return n.set(t.subarray(e,r)),n},Co=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Se=function(t,e,r){var n=new Error(e||Co[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Se),!r)throw n;return n},Lo=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new me(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new me(n*3));var l=function(at){var ft=e.length;if(at>ft){var gt=new me(Math.max(ft*2,at));gt.set(e),e=gt}},u=r.f||0,i=r.p||0,f=r.b||0,a=r.l,c=r.d,p=r.m,$=r.n,v=n*8;do{if(!a){u=ve(t,i,1);var k=ve(t,i+1,3);if(i+=3,k)if(k==1)a=yo,c=ko,p=9,$=5;else if(k==2){var F=ve(t,i,31)+257,C=ve(t,i+10,15)+4,A=F+ve(t,i+5,31)+1;i+=14;for(var x=new me(A),I=new me(19),P=0;P<C;++P)I[_o[P]]=ve(t,i+P*3,7);i+=C*3;for(var M=jt(I),N=(1<<M)-1,j=bt(I,M,1),P=0;P<A;){var ee=j[ve(t,i,N)];i+=ee&15;var S=ee>>>4;if(S<16)x[P++]=S;else{var H=0,ce=0;for(S==16?(ce=3+ve(t,i,3),i+=2,H=x[P-1]):S==17?(ce=3+ve(t,i,7),i+=3):S==18&&(ce=11+ve(t,i,127),i+=7);ce--;)x[P++]=H}}var we=x.subarray(0,F),oe=x.subarray(F);p=jt(we),$=jt(oe),a=bt(we,p,1),c=bt(oe,$,1)}else Se(1);else{var S=So(i)+4,L=t[S-4]|t[S-3]<<8,E=S+L;if(E>n){s&&Se(0);break}o&&l(f+L),e.set(t.subarray(S,E),f),r.b=f+=L,r.p=i=E*8,r.f=u;continue}if(i>v){s&&Se(0);break}}o&&l(f+131072);for(var Ke=(1<<p)-1,pe=(1<<$)-1,dt=i;;dt=i){var H=a[Rt(t,i)&Ke],Be=H>>>4;if(i+=H&15,i>v){s&&Se(0);break}if(H||Se(2),Be<256)e[f++]=Be;else if(Be==256){dt=i,a=null;break}else{var st=Be-254;if(Be>264){var P=Be-257,be=mn[P];st=ve(t,i,(1<<be)-1)+_n[P],i+=be}var it=c[Rt(t,i)&pe],Ne=it>>>4;it||Se(3),i+=it&15;var oe=vo[Ne];if(Ne>3){var be=hn[Ne];oe+=Rt(t,i)&(1<<be)-1,i+=be}if(i>v){s&&Se(0);break}o&&l(f+131072);for(var lt=f+st;f<lt;f+=4)e[f]=e[f-oe],e[f+1]=e[f+1-oe],e[f+2]=e[f+2-oe],e[f+3]=e[f+3-oe];f=lt}}r.l=a,r.p=dt,r.b=f,r.f=u,a&&(u=1,r.m=p,r.d=c,r.n=$)}while(!u);return f==e.length?e:ir(e,0,f)},Oo=new me(0),Pe=function(t,e){return t[e]|t[e+1]<<8},Ce=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Ut=function(t,e){return Ce(t,e)+Ce(t,e+4)*4294967296};function To(t,e){return Lo(t,e)}var Xt=typeof TextDecoder<"u"&&new TextDecoder,Ao=0;try{Xt.decode(Oo,{stream:!0}),Ao=1}catch{}var Do=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,ir(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function bn(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Xt)return Xt.decode(t);var o=Do(t),s=o[0],l=o[1];return l.length&&Se(8),s}}var Eo=function(t,e){return e+30+Pe(t,e+26)+Pe(t,e+28)},Po=function(t,e,r){var n=Pe(t,e+28),o=bn(t.subarray(e+46,e+46+n),!(Pe(t,e+8)&2048)),s=e+46+n,l=Ce(t,e+20),u=r&&l==4294967295?Mo(t,s):[l,Ce(t,e+24),Ce(t,e+42)],i=u[0],f=u[1],a=u[2];return[Pe(t,e+10),i,f,o,s+Pe(t,e+30)+Pe(t,e+32),a]},Mo=function(t,e){for(;Pe(t,e)!=1;e+=4+Pe(t,e+2));return[Ut(t,e+12),Ut(t,e+4),Ut(t,e+20)]};function No(t,e){for(var r={},n=t.length-22;Ce(t,n)!=101010256;--n)(!n||t.length-n>65558)&&Se(13);var o=Pe(t,n+8);if(!o)return{};var s=Ce(t,n+16),l=s==4294967295||o==65535;if(l){var u=Ce(t,n-12);l=Ce(t,u)==101075792,l&&(o=Ce(t,u+32),s=Ce(t,u+48))}for(var i=e&&e.filter,f=0;f<o;++f){var a=Po(t,s,l),c=a[0],p=a[1],$=a[2],v=a[3],k=a[4],S=a[5],L=Eo(t,S);s=k,(!i||i({name:v,size:p,originalSize:$,compression:c}))&&(c?c==8?r[v]=To(t.subarray(L,L+p),new me($)):Se(14,"unknown compression type "+c):r[v]=ir(t,L,L+p))}return r}function Io(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Ht):Ht(t)}function Ht(t){var e=new Uint8Array(t),r=No(e);return Promise.resolve(Fo(r))}function Fo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=bn(t[o])}return e}function Me(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&ot(n)===e)return n;r++}}function Lt(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&ot(o)===e&&r.push(o),n++}return r}function Mt(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&ot(o)===e&&r(o,n):r(o,n),n++}}function xo(t,e,r){var n=[];return Mt(t,e,function(o,s){n.push(r(o,s))}),n}var Bo=/.+\:/;function ot(t){return t.tagName.replace(Bo,"")}function vn(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+ot(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=vn(t.childNodes[n]),n++;return e+="</"+ot(t)+">",e}function jo(t){var e=t.documentElement,r=Me(e,"sheetData"),n=[];return Mt(r,"row",function(o){Mt(o,"c",function(s){n.push(s)})}),n}function Ro(t,e){return Me(e,"v")}function Uo(t,e){if(e.firstChild&&ot(e.firstChild)==="is"&&e.firstChild.firstChild&&ot(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function Ho(t){var e=t.documentElement,r=Me(e,"dimension");if(r)return r.getAttribute("ref")}function Wo(t){var e=t.documentElement,r=Me(e,"cellStyleXfs");return r?Lt(r,"xf"):[]}function zo(t){var e=t.documentElement,r=Me(e,"cellXfs");return r?Lt(r,"xf"):[]}function Go(t){var e=t.documentElement,r=Me(e,"numFmts");return r?Lt(r,"numFmt"):[]}function Vo(t){var e=t.documentElement;return xo(e,"si",function(r){var n=Me(r,"t");if(n)return n.textContent;var o="";return Mt(r,"r",function(s){o+=Me(s,"t").textContent}),o})}function qo(t){var e=t.documentElement;return Me(e,"workbookPr")}function Ko(t){var e=t.documentElement;return Lt(e,"Relationship")}function Zo(t){var e=t.documentElement,r=Me(e,"sheets");return Lt(r,"sheet")}function Xo(t,e){var r=e.createDocument(t),n={},o=qo(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(u){u.getAttribute("name")&&n.sheets.push({id:u.getAttribute("sheetId"),name:u.getAttribute("name"),relationId:u.getAttribute("r:id")})};return Zo(r).forEach(s),n}function Yo(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var u=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=Wt(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=Wt(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=Wt(u);break}};return Ko(r).forEach(o),n}function Wt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function dr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function gr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dr(Object(r),!0).forEach(function(n){Jo(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qo(t,e){if(!t)return{};var r=e.createDocument(t),n=Wo(r).map(zt),o=Go(r).map(es).reduce(function(l,u){return l[u.id]=u,l},[]),s=function(u){return u.hasAttribute("xfId")?gr(gr({},n[u.xfId]),zt(u,o)):zt(u,o)};return zo(r).map(s)}function es(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function zt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function ts(t,e){return t?Vo(e.createDocument(t)):[]}function yn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function rs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ns(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ns(t,e){if(t){if(typeof t=="string")return _r(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _r(t,e)}}function _r(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function os(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(ss.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&as(o.numberFormat.template))return!0}}var ss=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],is=/^\[\$-414\]/,ls=/;@$/;function as(t){t=t.toLowerCase(),t=t.replace(is,""),t=t.replace(ls,"");for(var e=t.split(/\W+/),r=rs(e),n;!(n=r()).done;){var o=n.value;if(fs.indexOf(o)<0)return!1}return!0}var fs=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function us(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,u=r.values,i=r.properties,f=r.options;switch(e||(e="n"),e){case"str":t=Gt(t,f);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Gt(t,f);break;case"s":var a=Number(t);if(isNaN(a))throw new Error('Invalid "shared" string index: '.concat(t));if(a>=u.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=u[a],t=Gt(t,f);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=cs(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,os(t,s(),l,f)&&(t=yn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function cs(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Gt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var ps=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function $s(t){var e=function(f,a){return f-a},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],u=n[n.length-1];return[{row:o,column:l},{row:s,column:u}]}function ms(t){for(var e=0,r=0;r<t.length;)e*=26,e+=ps.indexOf(t[r]),r++;return e}function kn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),ms(t[0].trim())]}function hs(t,e,r,n,o,s,l){var u=kn(t.getAttribute("r")),i=Ro(e,t),f=i&&i.textContent,a;return t.hasAttribute("t")&&(a=t.getAttribute("t")),{row:u[0],column:u[1],value:us(f,a,{getInlineStringValue:function(){return Uo(e,t)},getInlineStringXml:function(){return vn(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function ds(t,e,r,n,o,s){var l=jo(t);return l.length===0?[]:l.map(function(u){return hs(u,t,e,r,n,o,s)})}function gs(t,e){return vs(t)||bs(t,e)||ws(t,e)||_s()}function _s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ws(t,e){if(t){if(typeof t=="string")return wr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(t,e)}}function wr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function vs(t){if(Array.isArray(t))return t}function ys(t){var e=Ho(t);if(e)return e=e.split(":").map(kn).map(function(r){var n=gs(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function ks(t,e,r,n,o,s){var l=e.createDocument(t),u=ds(l,e,r,n,o,s),i=ys(l)||$s(u);return{cells:u,dimensions:i}}function Ss(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Cs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cs(t,e){if(t){if(typeof t=="string")return br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(t,e)}}function br(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ls(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var u=!0,i=Ss(t[l]),f;!(f=i()).done;){var a=f.value;if(o(a)!==null){u=!1;break}}if(u)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function Os(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ts(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ts(t,e){if(t){if(typeof t=="string")return vr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vr(t,e)}}function vr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function As(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,u=Os(t),i;!(i=u()).done;){var f=i.value;if(n(f[s])!==null){l=!1;break}}if(l)for(var a=0;a<t.length;)t[a].splice(s,1),a++;else if(o)break;s--}return t}function Ds(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Sn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Es(t,e){return Ns(t)||Ms(t,e)||Sn(t,e)||Ps()}function Ps(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sn(t,e){if(t){if(typeof t=="string")return yr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(t,e)}}function yr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ms(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function Ns(t){if(Array.isArray(t))return t}function Is(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Es(r,2);o[0];for(var s=o[1],l=s.column,u=s.row,i=new Array(u),f=0;f<u;){i[f]=new Array(l);for(var a=0;a<l;)i[f][a]=null,a++;f++}for(var c=Ds(n),p;!(p=c()).done;){var $=p.value,v=$.row-1,k=$.column-1;k<l&&v<u&&(i[v][k]=$.value)}var S=e.rowMap;if(S)for(var L=0;L<i.length;)S[L]=L,L++;return i=Ls(As(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:S}),e.transformData&&(i=e.transformData(i)),i}function Fs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=xs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xs(t,e){if(t){if(typeof t=="string")return kr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kr(t,e)}}function kr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Sr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Bs(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sr(Object(r),!0).forEach(function(n){js(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function js(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=Bs({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=Yo(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?ts(n(o.sharedStrings),e):[],l=o.styles?Qo(n(o.styles),e):{},u=Xo(n("xl/workbook.xml"),e);if(r.getSheets)return u.sheets.map(function(c){var p=c.name;return{name:p}});var i=Us(r.sheet,u.sheets);if(!i||!o.sheets[i])throw Hs(r.sheet,u.sheets);var f=ks(n(o.sheets[i]),e,s,l,u,r),a=Is(f,r);return r.properties?{data:a,properties:u}:a}function Us(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Fs(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function Hs(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function Yt(t){"@babel/helpers - typeof";return Yt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(t)}function Cr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ws(t,e,r){return e&&Cr(t.prototype,e),r&&Cr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yt(t,e)}function Vs(t){var e=Cn();return function(){var n=kt(t),o;if(e){var s=kt(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return qs(this,o)}}function qs(t,e){if(e&&(Yt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ks(t)}function Ks(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jt(t){var e=typeof Map=="function"?new Map:void 0;return Jt=function(n){if(n===null||!Zs(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return At(n,arguments,kt(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),yt(o,n)},Jt(t)}function At(t,e,r){return Cn()?At=Reflect.construct:At=function(o,s,l){var u=[null];u.push.apply(u,s);var i=Function.bind.apply(o,u),f=new i;return l&&yt(f,l.prototype),f},At.apply(null,arguments)}function Cn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zs(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function yt(t,e){return yt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},yt(t,e)}function kt(t){return kt=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},kt(t)}var he=function(t){Gs(r,t);var e=Vs(r);function r(n){var o;return zs(this,r),o=e.call(this,"invalid"),o.reason=n,o}return Ws(r)}(Jt(Error));function Xs(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new he("not_a_number")}if(typeof t!="number")throw new he("not_a_number");if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return t}function Ys(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return String(t)}throw new he("not_a_string")}function Js(t){if(typeof t=="boolean")return t;throw new he("not_a_boolean")}function Qs(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new he("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");var n=yn(t,r);if(isNaN(n.valueOf()))throw new he("out_of_bounds");return n}throw new he("not_a_date")}function ei(t,e){return ni(t)||ri(t,e)||Ln(t,e)||ti()}function ti(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ri(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function ni(t){if(Array.isArray(t))return t}function Qt(t){"@babel/helpers - typeof";return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qt(t)}function oi(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ln(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ln(t,e){if(t){if(typeof t=="string")return Lr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lr(t,e)}}function Lr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Or(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Tr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Or(Object(r),!0).forEach(function(n){si(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Or(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function si(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ar={isColumnOriented:!1};function ii(t,e,r){r?r=Tr(Tr({},Ar),r):r=Ar;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;ui(e),o&&(t=fi(t));for(var u=t[0],i=[],f=[],a=1;a<t.length;a++){var c=On(e,t[a],a,u,f,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=oi(f),$;!($=p()).done;){var v=$.value;v.row=s[v.row-1]+1}return{rows:i,errors:f}}function On(t,e,r,n,o,s){for(var l={},u=!0,i=function(){var p=a[f],$=t[p],v=Qt($.type)==="object"&&!Array.isArray($.type),k=e[n.indexOf(p)];k===void 0&&(k=null);var S=void 0,L=void 0,E=void 0;if(v)S=On($.type,e,r,n,o,s);else if(k===null)S=null;else if(Array.isArray($.type)){var F=!1,C=ai(k).map(function(x){var I=Dr(x,$,s);return I.error&&(S=x,L=I.error,E=I.reason),I.value!==null&&(F=!0),I.value});L||(S=F?C:null)}else{var A=Dr(k,$,s);L=A.error,E=A.reason,S=L?k:A.value}!L&&S===null&&$.required&&(L="required"),L?(L={error:L,row:r+1,column:p,value:S},E&&(L.reason=E),$.type&&(L.type=$.type),o.push(L)):(u&&S!==null&&(u=!1),(S!==null||s.includeNullValues)&&(l[$.prop]=S))},f=0,a=Object.keys(t);f<a.length;f++)i();return u?null:l}function Dr(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=ct(t,e.parse):e.type?n=li(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function ct(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function li(t,e,r){switch(e){case String:return ct(t,Ys);case Number:return ct(t,Xs);case Date:return ct(t,function(n){return Qs(n,{properties:r.properties})});case Boolean:return ct(t,Js);default:if(typeof e=="function")return ct(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Tn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=Tn(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function ai(t){for(var e=[],r=0;r<t.length;){var n=Tn(t,",",r),o=ei(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var fi=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function ui(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function er(t){"@babel/helpers - typeof";return er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(t)}function An(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;er(s)==="object"&&(s=Object.keys(t[o])[0],l=An(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var ci=["schema","map"];function Er(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Tt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Er(Object(r),!0).forEach(function(n){pi(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Er(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pi(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $i(t,e){if(t==null)return{};var r=mi(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function mi(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function hi(t,e,r){var n=r.schema,o=r.map,s=$i(r,ci);!n&&o&&(n=An(o));var l=Rs(t,e,Tt(Tt({},s),{},{properties:n||s.properties}));return n?ii(l.data,n,Tt(Tt({},s),{},{properties:l.properties})):l}function di(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Io(t).then(function(r){return hi(r,go,e)})}function gi(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function _i(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await di(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=Vn(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const W={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Bt=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function wi(t){let e,r,n,o,s;function l(i){t[3](i)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(u.value=t[0]),e=new Pt({props:u}),U.push(()=>z(e,"value",l)),e.$on("change",t[2]),o=new ro({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};!r&&f&1&&(r=!0,a.value=i[0],G(()=>r=!1)),e.$set(a);const c={};f&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function bi(t,e,r){let n;X(t,re,i=>r(4,n=i));let o="interventionType",s=hr("v1");function l(){let i;o=="interventionType"?(i=pn("v1"),r(1,s=hr("v1"))):(i=sn(["get","funding_programme"],{ATF2:W.atf2,ATF3:W.atf3,ATF4:W.atf4},"grey"),r(1,s=[["ATF2",W.atf2],["ATF3",W.atf3],["ATF4",W.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function u(i){o=i,r(0,o)}return[o,s,l,u]}class vi extends V{constructor(e){super(),q(this,e,bi,wi,K,{})}}function yi(t){let e;return{c(){e=y("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ki(t){let e,r,n,o,s,l;return n=new Kt({props:{$$slots:{default:[yi]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=D("input"),r=O(),_(n.$$.fragment),R(e,"type","text"),R(e,"class","govuk-input govuk-input--width-10"),R(e,"id","filterText")},m(u,i){m(u,e,i),pr(e,t[0]),m(u,r,i),w(n,u,i),o=!0,s||(l=It(e,"input",t[12]),s=!0)},p(u,i){i&1&&e.value!==u[0]&&pr(e,u[0]);const f={};i&131072&&(f.$$scope={dirty:i,ctx:u}),n.$set(f)},i(u){o||(d(n.$$.fragment,u),o=!0)},o(u){g(n.$$.fragment,u),o=!1},d(u){u&&(h(e),h(r)),b(n,u),s=!1,l()}}}function Si(t){let e,r,n,o,s,l,u,i,f,a;function c(k){t[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Pt({props:p}),U.push(()=>z(e,"value",c));function $(k){t[11](k)}let v={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(v.value=t[3]),o=new Pt({props:v}),U.push(()=>z(o,"value",$)),u=new ln({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[ki]},$$scope:{ctx:t}}}),f=new vi({}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(k,S){w(e,k,S),m(k,n,S),w(o,k,S),m(k,l,S),w(u,k,S),m(k,i,S),w(f,k,S),a=!0},p(k,S){const L={};S&32&&(L.choices=k[5]),!r&&S&4&&(r=!0,L.value=k[2],G(()=>r=!1)),e.$set(L);const E={};S&64&&(E.choices=k[6]),!s&&S&8&&(s=!0,E.value=k[3],G(()=>s=!1)),o.$set(E);const F={};S&131073&&(F.$$scope={dirty:S,ctx:k}),u.$set(F)},i(k){a||(d(e.$$.fragment,k),d(o.$$.fragment,k),d(u.$$.fragment,k),d(f.$$.fragment,k),a=!0)},o(k){g(e.$$.fragment,k),g(o.$$.fragment,k),g(u.$$.fragment,k),g(f.$$.fragment,k),a=!1},d(k){k&&(h(n),h(l),h(i)),b(e,k),b(o,k),b(u,k),b(f,k)}}}function Ci(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,u,i=t[7].area.toLocaleString()+"",f,a,c=t[7].crossing.toLocaleString()+"",p,$,v=t[7].other.toLocaleString()+"",k,S;return{c(){e=y("Showing "),n=y(r),o=y(" schemes ("),l=y(s),u=y(`
    routes, `),f=y(i),a=y(` areas,
    `),p=y(c),$=y(" crossings, "),k=y(v),S=y(`
    other)`)},m(L,E){m(L,e,E),m(L,n,E),m(L,o,E),m(L,l,E),m(L,u,E),m(L,f,E),m(L,a,E),m(L,p,E),m(L,$,E),m(L,k,E),m(L,S,E)},p(L,E){E&2&&r!==(r=L[1].size.toLocaleString()+"")&&Le(n,r),E&128&&s!==(s=L[7].route.toLocaleString()+"")&&Le(l,s),E&128&&i!==(i=L[7].area.toLocaleString()+"")&&Le(f,i),E&128&&c!==(c=L[7].crossing.toLocaleString()+"")&&Le(p,c),E&128&&v!==(v=L[7].other.toLocaleString()+"")&&Le(k,v)},d(L){L&&(h(e),h(n),h(o),h(l),h(u),h(f),h(a),h(p),h($),h(k),h(S))}}}function Li(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[Ci]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),U.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,u){w(e,l,u),n=!0},p(l,u){const i={};u&131202&&(i.$$scope={dirty:u,ctx:l}),!r&&u&16&&(r=!0,i.checked=l[4],G(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function Oi(t){let e,r,n,o;return e=new Fe({props:{label:"Filters",$$slots:{default:[Si]},$$scope:{ctx:t}}}),n=new St({props:{small:!0,$$slots:{default:[Li]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},p(s,[l]){const u={};l&131181&&(u.$$scope={dirty:l,ctx:s}),e.$set(u);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Ti(t,e,r){let n,o;X(t,mt,C=>r(15,n=C)),X(t,re,C=>r(9,o=C));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:u=""}=e,i=[],f="",a=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;Ft(()=>{let C=new Set,A=new Set;for(let x of s.values())x.authority_or_region&&C.add(x.authority_or_region),x.funding_programme&&A.add(x.funding_programme);r(5,i=Array.from(C.entries())),i.sort(),r(6,a=Array.from(A.entries())),a.sort()});function v(C,A,x){let I=C.toLowerCase(),P=N=>{var j,ee;if(I&&!((j=N.properties.name)!=null&&j.toLowerCase().includes(I))&&!((ee=N.properties.description)!=null&&ee.toLowerCase().includes(I)))return!1;if(A||x){let H=s.get(N.properties.scheme_reference);if(A&&H.authority_or_region!=A||x&&H.funding_programme!=x)return!1}return!0};r(1,l=new Set(n.features.filter(P).map(N=>N.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let M=N=>{var j,ee;return!(!l.has(N.properties.scheme_reference)||I&&!((j=N.properties.name)!=null&&j.toLowerCase().includes(I))&&!((ee=N.properties.description)!=null&&ee.toLowerCase().includes(I)))};mt.update(N=>{for(let j of N.features)M(j)?(delete j.properties.hide_while_editing,r(7,p[j.properties.intervention_type]++,p)):j.properties.hide_while_editing=!0;return N}),r(7,p)}function k(C){f=C,r(2,f)}function S(C){c=C,r(3,c)}function L(){u=this.value,r(0,u)}const E=()=>r(0,u="");function F(C){$=C,r(4,$)}return t.$$set=C=>{"schemes"in C&&r(8,s=C.schemes),"schemesToBeShown"in C&&r(1,l=C.schemesToBeShown),"filterText"in C&&r(0,u=C.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let C of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(C)&&o.setLayoutProperty(C,"visibility",$?"visible":"none");t.$$.dirty&13&&v(u,f,c)},[u,l,f,c,$,i,a,p,s,o,k,S,L,E,F]}class Ai extends V{constructor(e){super(),q(this,e,Ti,Oi,K,{schemes:8,schemesToBeShown:1,filterText:0})}}function Di(t){let e,r,n;return e=new _e({props:{color:W.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=y(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ei(t){let e;return{c(){e=y(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pi(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Mi(t){let e,r,n,o,s,l,u,i,f,a,c;return s=new B({props:{href:"https://gtfs.org",$$slots:{default:[Ei]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Pi]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=O(),n=D("p"),o=y("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),l=y(`, and doesn't include which routes are run or the
        frequency of service.`),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment)},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),T(n,o),w(s,n,null),T(n,l),m(p,u,$),m(p,i,$),T(i,f),w(a,i,null),c=!0},p(p,$){const v={};$&8&&(v.$$scope={dirty:$,ctx:p}),s.$set(v);const k={};$&8&&(k.$$scope={dirty:$,ctx:p}),a.$set(k)},i(p){c||(d(s.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(s.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(u),h(i)),b(s),b(a)}}}function Ni(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Mi]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ii(t){let e,r,n,o,s;function l(i){t[1](i)}let u={id:Ze,$$slots:{right:[Ni],default:[Di]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ze,tooltip:Fi,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&8&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ze="bus_routes";function Fi(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function xi(t,e,r){let n;X(t,re,l=>r(2,n=l)),le(n,Ze,`https://atip.uk/layers/v1/${Ze}.pmtiles`),ge(n,{id:Ze,source:Ze,sourceLayer:Ze,color:["case",["boolean",["get","has_bus_lane"],!1],W.bus_route_with_lane,W.bus_route_without_lane],width:5,opacity:ue(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class Bi extends V{constructor(e){super(),q(this,e,xi,Ii,K,{})}}function Pr(t,e,r){const n=t.slice();return n[2]=e[r],n}function Mr(t,e,r){const n=t.slice();return n[5]=e[r],n}function Nr(t){let e,r;return{c(){e=D("span"),r=y(` 
    `),xe(e,"background",t[5]),xe(e,"width","100%"),xe(e,"border","1px solid black")},m(n,o){m(n,e,o),T(e,r)},p(n,o){o&1&&xe(e,"background",n[5])},d(n){n&&h(e)}}}function Ir(t){let e,r=t[2]+"",n;return{c(){e=D("span"),n=y(r)},m(o,s){m(o,e,s),T(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&Le(n,r)},d(o){o&&h(e)}}}function ji(t){let e,r,n,o=ze(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Nr(Mr(t,o,i));let l=ze(t[1]),u=[];for(let i=0;i<l.length;i+=1)u[i]=Ir(Pr(t,l,i));return{c(){e=D("div");for(let i=0;i<s.length;i+=1)s[i].c();r=O(),n=D("div");for(let i=0;i<u.length;i+=1)u[i].c();xe(e,"display","flex"),xe(n,"display","flex"),xe(n,"justify-content","space-between")},m(i,f){m(i,e,f);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);m(i,r,f),m(i,n,f);for(let a=0;a<u.length;a+=1)u[a]&&u[a].m(n,null)},p(i,[f]){if(f&1){o=ze(i[0]);let a;for(a=0;a<o.length;a+=1){const c=Mr(i,o,a);s[a]?s[a].p(c,f):(s[a]=Nr(c),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=o.length}if(f&2){l=ze(i[1]);let a;for(a=0;a<l.length;a+=1){const c=Pr(i,l,a);u[a]?u[a].p(c,f):(u[a]=Ir(c),u[a].c(),u[a].m(n,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=l.length}},i:Q,o:Q,d(i){i&&(h(e),h(r),h(n)),Et(s,i),Et(u,i)}}}function Ri(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class qe extends V{constructor(e){super(),q(this,e,Ri,ji,K,{colorScale:0,limits:1})}}function Ui(t){let e;return{c(){e=y("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Hi(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Wi(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zi(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gi(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Hi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Wi]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[zi]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&65536&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&65536&&(S.$$scope={dirty:v,ctx:$}),s.$set(S);const L={};v&65536&&(L.$$scope={dirty:v,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function Vi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Gi]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Fr(t){let e,r;return e=new qe({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function qi(t){let e;return{c(){e=y("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ki(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zi(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xi(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yi(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v;return s=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ki]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Zi]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Xi]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=O(),n=D("p"),o=y("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),l=y(". Output area boundaries from "),_(u.$$.fragment),i=y("."),f=O(),a=D("p"),c=y("License: "),_(p.$$.fragment),$=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(k,S){m(k,e,S),m(k,r,S),m(k,n,S),T(n,o),w(s,n,null),T(n,l),w(u,n,null),T(n,i),m(k,f,S),m(k,a,S),T(a,c),w(p,a,null),T(a,$),v=!0},p(k,S){const L={};S&65536&&(L.$$scope={dirty:S,ctx:k}),s.$set(L);const E={};S&65536&&(E.$$scope={dirty:S,ctx:k}),u.$set(E);const F={};S&65536&&(F.$$scope={dirty:S,ctx:k}),p.$set(F)},i(k){v||(d(s.$$.fragment,k),d(u.$$.fragment,k),d(p.$$.fragment,k),v=!0)},o(k){g(s.$$.fragment,k),g(u.$$.fragment,k),g(p.$$.fragment,k),v=!1},d(k){k&&(h(e),h(r),h(n),h(f),h(a)),b(s),b(u),b(p)}}}function Ji(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Yi]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function xr(t){let e,r;return e=new qe({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Qi(t){let e;return{c(){e=y("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function el(t){let e;return{c(){e=y(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rl(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nl(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[el]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[tl]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[rl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=y(". Output area boundaries from "),_(s.$$.fragment),l=y("."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&65536&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&65536&&(S.$$scope={dirty:v,ctx:$}),s.$set(S);const L={};v&65536&&(L.$$scope={dirty:v,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function ol(t){let e,r,n;return r=new ne({props:{$$slots:{default:[nl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Br(t){let e,r,n,o;return n=new qe({props:{colorScale:t[4],limits:t[7]().map(il)}}),{c(){e=D("p"),e.textContent="(people per square kilometres)",r=O(),_(n.$$.fragment)},m(s,l){m(s,e,l),m(s,r,l),w(n,s,l),o=!0},p:Q,i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function sl(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v;function k(P){t[9](P)}let S={id:"percent_households_with_car",$$slots:{right:[Vi],default:[Ui]},$$scope:{ctx:t}};t[0]!==void 0&&(S.checked=t[0]),e=new te({props:S}),U.push(()=>z(e,"checked",k)),e.$on("change",t[10]);let L=t[3]=="percent_households_with_car"&&Fr(t);function E(P){t[11](P)}let F={id:"average_cars_per_household",$$slots:{right:[Ji],default:[qi]},$$scope:{ctx:t}};t[1]!==void 0&&(F.checked=t[1]),s=new te({props:F}),U.push(()=>z(s,"checked",E)),s.$on("change",t[12]);let C=t[3]=="average_cars_per_household"&&xr(t);function A(P){t[13](P)}let x={id:"population_density",$$slots:{right:[ol],default:[Qi]},$$scope:{ctx:t}};t[2]!==void 0&&(x.checked=t[2]),f=new te({props:x}),U.push(()=>z(f,"checked",A)),f.$on("change",t[14]);let I=t[3]=="population_density"&&Br(t);return $=new J({props:{layer:Oe,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=O(),L&&L.c(),o=O(),_(s.$$.fragment),u=O(),C&&C.c(),i=O(),_(f.$$.fragment),c=O(),I&&I.c(),p=O(),_($.$$.fragment)},m(P,M){w(e,P,M),m(P,n,M),L&&L.m(P,M),m(P,o,M),w(s,P,M),m(P,u,M),C&&C.m(P,M),m(P,i,M),w(f,P,M),m(P,c,M),I&&I.m(P,M),m(P,p,M),w($,P,M),v=!0},p(P,[M]){const N={};M&65536&&(N.$$scope={dirty:M,ctx:P}),!r&&M&1&&(r=!0,N.checked=P[0],G(()=>r=!1)),e.$set(N),P[3]=="percent_households_with_car"?L?(L.p(P,M),M&8&&d(L,1)):(L=Fr(P),L.c(),d(L,1),L.m(o.parentNode,o)):L&&(ae(),g(L,1,1,()=>{L=null}),fe());const j={};M&65536&&(j.$$scope={dirty:M,ctx:P}),!l&&M&2&&(l=!0,j.checked=P[1],G(()=>l=!1)),s.$set(j),P[3]=="average_cars_per_household"?C?(C.p(P,M),M&8&&d(C,1)):(C=xr(P),C.c(),d(C,1),C.m(i.parentNode,i)):C&&(ae(),g(C,1,1,()=>{C=null}),fe());const ee={};M&65536&&(ee.$$scope={dirty:M,ctx:P}),!a&&M&4&&(a=!0,ee.checked=P[2],G(()=>a=!1)),f.$set(ee),P[3]=="population_density"?I?(I.p(P,M),M&8&&d(I,1)):(I=Br(P),I.c(),d(I,1),I.m(p.parentNode,p)):I&&(ae(),g(I,1,1,()=>{I=null}),fe());const H={};M&8&&(H.show=P[3]!=""),$.$set(H)},i(P){v||(d(e.$$.fragment,P),d(L),d(s.$$.fragment,P),d(C),d(f.$$.fragment,P),d(I),d($.$$.fragment,P),v=!0)},o(P){g(e.$$.fragment,P),g(L),g(s.$$.fragment,P),g(C),g(f.$$.fragment,P),g(I),g($.$$.fragment,P),v=!1},d(P){P&&(h(n),h(o),h(u),h(i),h(c),h(p)),b(e,P),L&&L.d(P),b(s,P),C&&C.d(P),b(f,P),I&&I.d(P),b($,P)}}}let Oe="census_output_areas";const il=t=>t.toLocaleString();function ll(t,e,r){let n;X(t,re,F=>r(8,n=F));let o=`${Oe}-outline`,s=W.sequential_low_to_high,l=!1,u=!1,i=!1,f="";le(n,Oe,`https://atip.uk/layers/v1/${Oe}.pmtiles`),Ve(n,{id:Oe,source:Oe,sourceLayer:Oe,color:"black",opacity:ue(.5,.7)}),ge(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});function a(F){let C=F.properties.OA21CD,A=F.properties[f];return f=="percent_households_with_car"?`<p>${A}% of households in ${C} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${C} have an average of ${A} cars</p>`:`<p>There are ${A.toLocaleString()} people per square kilometre in ${C}</p>`}function c(F){let C=F.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${C}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${C}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(F){l=F,r(0,l)}const v=()=>{r(1,u=!1),r(2,i=!1)};function k(F){u=F,r(1,u)}const S=()=>{r(0,l=!1),r(2,i=!1)};function L(F){i=F,r(2,i)}const E=()=>{r(0,l=!1),r(1,u=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,f="percent_households_with_car"):u?r(3,f="average_cars_per_household"):i?r(3,f="population_density"):r(3,f=""),f?(n.setPaintProperty(Oe,"fill-color",Ge(["get",f],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,u,i,f,s,a,c,p,n,$,v,k,S,L,E]}class al extends V{constructor(e){super(),q(this,e,ll,sl,K,{})}}function fl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ul(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function cl(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pl(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[ul]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[cl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of December 2022."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment),f=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const v={};p&32&&(v.$$scope={dirty:p,ctx:c}),i.$set(v)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function $l(t){let e,r,n;return r=new ne({props:{$$slots:{default:[pl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ml(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Re,$$slots:{right:[$l],default:[fl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Re,tooltip:hl,show:t[0],clickable:!0}}),o.$on("click",dl),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Re="combined_authorities";function hl(t){return`<p>${t.properties.name}</p>`}function dl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function gl(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.combined_authorities,s=`${Re}-outline`;sr(n,Re,`https://atip.uk/layers/v1/${Re}.geojson`),Ve(n,{id:Re,source:Re,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Re,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class _l extends V{constructor(e){super(),q(this,e,gl,ml,K,{})}}function wl(t){let e,r,n;return{c(){e=D("input"),R(e,"class","govuk-file-upload"),R(e,"id","load-criticals"),R(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=It(e,"change",t[4]),r=!0)},p:Q,d(o){o&&h(e),t[7](null),r=!1,n()}}}function jr(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[vl]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function bl(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new _e({props:{color:tr}}),{c(){_(e.$$.fragment),r=y(`
        Show `),o=y(n),s=y(" issues")},m(u,i){w(e,u,i),m(u,r,i),m(u,o,i),m(u,s,i),l=!0},p(u,i){(!l||i&4)&&n!==(n=u[2].toLocaleString()+"")&&Le(o,n)},i(u){l||(d(e.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),l=!1},d(u){u&&(h(r),h(o),h(s)),b(e,u)}}}function vl(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[bl]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),U.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,u){w(e,l,u),n=!0},p(l,u){const i={};u&516&&(i.$$scope={dirty:u,ctx:l}),!r&&u&1&&(r=!0,i.checked=l[0],G(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function yl(t){let e,r,n,o,s,l;e=new ln({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[wl]},$$scope:{ctx:t}}}),n=new fn({props:{errorMessage:t[3]}});let u=t[2]>0&&jr(t);return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),u&&u.c(),s=xt()},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),m(i,o,f),u&&u.m(i,f),m(i,s,f),l=!0},p(i,f){const a={};f&514&&(a.$$scope={dirty:f,ctx:i}),e.$set(a);const c={};f&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?u?(u.p(i,f),f&4&&d(u,1)):(u=jr(i),u.c(),d(u,1),u.m(s.parentNode,s)):u&&(ae(),g(u,1,1,()=>{u=null}),fe())},i(i){l||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(u),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(u),l=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),u&&u.d(i)}}}function kl(t){let e,r,n,o,s,l;return e=new Fe({props:{label:"Critical Issues",$$slots:{default:[yl]},$$scope:{ctx:t}}}),n=new J({props:{layer:se+"-points",tooltip:Sl,show:t[0],clickable:!1}}),s=new J({props:{layer:se+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[se+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment)},m(u,i){w(e,u,i),m(u,r,i),w(n,u,i),m(u,o,i),w(s,u,i),l=!0},p(u,[i]){const f={};i&527&&(f.$$scope={dirty:i,ctx:u}),e.$set(f);const a={};i&1&&(a.show=u[0]),n.$set(a);const c={};i&1&&(c.show=u[0]),s.$set(c)},i(u){l||(d(e.$$.fragment,u),d(n.$$.fragment,u),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),l=!1},d(u){u&&(h(r),h(o)),b(e,u),b(n,u),b(s,u)}}}let se="criticals",tr="red";function Sl(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function Cl(t,e,r){let n;X(t,re,p=>r(6,n=p));let o,s=!0,l=0,u="";qn(n,se),n.addSource(se,{type:"geojson",data:an(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),ht(n,{id:`${se}-clusters`,source:se,filter:["has","point_count"],color:tr,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${se}-counts`,source:se,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),ht(n,{id:`${se}-points`,source:se,filter:["!",["has","point_count"]],color:tr,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await _i(o.files[0]);n.getSource(se).setData($),r(2,l=$.features.length),r(3,u="")}catch($){r(3,u=`The file you loaded is broken: ${$}`)}}function f(p){n.getSource(se).getClusterExpansionZoom(p.detail.properties.cluster_id,($,v)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:v})})}function a(p){U[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${se}-counts`)&&n.setLayoutProperty(`${se}-counts`,"visibility",s?"visible":"none")},[s,o,l,u,i,f,n,a,c]}class Ll extends V{constructor(e){super(),q(this,e,Cl,kl,K,{})}}function Ol(t){let e,r,n;return e=new _e({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=y(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Tl(t){let e;return{c(){e=y("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Al(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Dl(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[Tl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Al]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function El(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Dl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Pl(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Ue,$$slots:{right:[El],default:[Ol]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ue,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",Ml),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&64&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Ue="crossings";function Ml(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function Nl(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=!1;function s(f){const a=f.properties.crossing;return`<p>${l.get(a)??`Crossing with unknown type (${a})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);le(n,Ue,`https://atip.uk/layers/v1/${Ue}.pmtiles`);let u=W[Ue];ht(n,{id:Ue,source:Ue,sourceLayer:Ue,color:u,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(f){o=f,r(0,o)}return[o,s,u,i]}class Il extends V{constructor(e){super(),q(this,e,Nl,Pl,K,{})}}function Fl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function xl(t){let e;return{c(){e=y("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bl(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function jl(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[xl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Bl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Cycle parking, according to "),_(n.$$.fragment),o=y(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Rl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[jl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ul(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:Xe,$$slots:{right:[Rl],default:[Fl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Xe,tooltip:Hl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&16&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Xe="cycle_parking";function Hl(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function Wl(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=W.cycle_parking;le(n,Xe,`https://atip.uk/layers/v1/${Xe}.pmtiles`),ht(n,{id:Xe,source:Xe,sourceLayer:Xe,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class zl extends V{constructor(e){super(),q(this,e,Wl,Ul,K,{})}}function Rr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function Gl(t){let e;return{c(){e=y("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vl(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ql(t){let e,r,n,o,s,l,u,i,f,a;return f=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Vl]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=O(),n=D("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=O(),s=D("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=O(),u=D("p"),i=y("License: "),_(f.$$.fragment)},m(c,p){m(c,e,p),m(c,r,p),m(c,n,p),m(c,o,p),m(c,s,p),m(c,l,p),m(c,u,p),T(u,i),w(f,u,null),a=!0},p(c,p){const $={};p&256&&($.$$scope={dirty:p,ctx:c}),f.$set($)},i(c){a||(d(f.$$.fragment,c),a=!0)},o(c){g(f.$$.fragment,c),a=!1},d(c){c&&(h(e),h(r),h(n),h(o),h(s),h(l),h(u)),b(f)}}}function Kl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ql]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ur(t){let e,r,n=ze(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=Hr(Rr(t,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=xt()},m(l,u){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,u);m(l,e,u),r=!0},p(l,u){if(u&2){n=ze(l[1]);let i;for(i=0;i<n.length;i+=1){const f=Rr(l,n,i);o[i]?(o[i].p(f,u),d(o[i],1)):(o[i]=Hr(f),o[i].c(),d(o[i],1),o[i].m(e.parentNode,e))}for(ae(),i=n.length;i<o.length;i+=1)s(i);fe()}},i(l){if(!r){for(let u=0;u<n.length;u+=1)d(o[u]);r=!0}},o(l){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)g(o[u]);r=!1},d(l){l&&h(e),Et(o,l)}}}function Hr(t){let e,r,n,o=t[4]+"",s,l,u;return r=new _e({props:{color:t[5]}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),s=y(o),l=O()},m(i,f){m(i,e,f),w(r,e,null),T(e,n),T(e,s),T(e,l),u=!0},p:Q,i(i){u||(d(r.$$.fragment,i),u=!0)},o(i){g(r.$$.fragment,i),u=!1},d(i){i&&h(e),b(r)}}}function Zl(t){let e,r,n,o,s,l;function u(a){t[2](a)}let i={id:Ye,$$slots:{right:[Kl],default:[Gl]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&Ur(t);return s=new J({props:{layer:Ye,tooltip:Xl,show:t[0],clickable:!0}}),s.$on("click",Yl),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Ur(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(ae(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let Ye="cycle_paths";function Xl(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Yl(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Jl(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=[["Separated tracks",W.cycle_paths.track],["Unprotected lanes",W.cycle_paths.lane],["Shared-use (segregated)",W.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",W.cycle_paths.shared_use_unsegregated]];le(n,Ye,`https://atip.uk/layers/v1/${Ye}.pmtiles`),ge(n,{id:Ye,source:Ye,sourceLayer:Ye,color:sn(["get","kind"],{track:W.cycle_paths.track,lane:W.cycle_paths.lane,shared_use_segregated:W.cycle_paths.shared_use_segregated,shared_use_unsegregated:W.cycle_paths.shared_use_unsegregated},"red"),width:Bt,opacity:ue(.5,1)});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class Ql extends V{constructor(e){super(),q(this,e,Jl,Zl,K,{})}}function ea(t){let e,r,n,o;return e=new _e({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=O(),n=y(t[1])},m(s,l){w(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&Le(n,s[1])},i(s){o||(d(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function ta(t){let e;const r=t[6].default,n=tn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&rn(n,r,o,o[8],e?on(r,o[8],s,null):nn(o[8]),null)},i(o){e||(d(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function ra(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ta]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function na(t){let e,r,n,o,s;function l(i){t[7](i)}let u={id:t[0],$$slots:{right:[ra],default:[ea]},$$scope:{ctx:t}};return t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&1&&(a.id=i[0]),f&258&&(a.$$scope={dirty:f,ctx:i}),!r&&f&4&&(r=!0,a.checked=i[2],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.layer=i[0]),f&4&&(c.show=i[2]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function oa(t,e,r){let n;X(t,re,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:u}=e,{pluralNoun:i}=e,f=W[l];le(n,l,`https://atip.uk/layers/v1/${l}.pmtiles`),Ve(n,{id:l,source:l,sourceLayer:l,color:f,opacity:ue(1,.7)});let a=!1;function c($){return`<p>${$.properties.name??`Unnamed ${u}`}</p>`}function p($){a=$,r(2,a)}return t.$$set=$=>{"name"in $&&r(0,l=$.name),"singularNoun"in $&&r(5,u=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[l,i,a,f,c,u,o,p,s]}class lr extends V{constructor(e){super(),q(this,e,oa,na,K,{name:0,singularNoun:5,pluralNoun:1})}}function sa(t){let e;return{c(){e=y("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ia(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function la(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[sa]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ia]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function aa(t){let e,r;return e=new lr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[la]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class fa extends V{constructor(e){super(),q(this,e,null,aa,K,{})}}function ua(t){let e;return{c(){e=y("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ca(t){let e;return{c(){e=y(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pa(t){let e;return{c(){e=y(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $a(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ma(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[ca]},$$scope:{ctx:t}}}),s=new B({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[pa]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[$a]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("The 2019 English IMD scores come from "),_(n.$$.fragment),o=y(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),l=y("."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&64&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&64&&(S.$$scope={dirty:v,ctx:$}),s.$set(S);const L={};v&64&&(L.$$scope={dirty:v,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function ha(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ma]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Wr(t){let e,r;return e=new qe({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function da(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:Te,$$slots:{right:[ha],default:[ua]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&Wr(t);return s=new J({props:{layer:Te,tooltip:ga,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Wr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(ae(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let Te="imd";function ga(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function _a(t,e,r){let n;X(t,re,f=>r(2,n=f));let o=`${Te}-outline`,s=W.sequential_low_to_high,l=[0,2,4,6,8,10];le(n,Te,`https://atip.uk/layers/v1/${Te}.pmtiles`),Ve(n,{id:Te,source:Te,sourceLayer:Te,color:Ge(["-",10,["get","decile"]],l,s),opacity:ue(.5,.7)}),ge(n,{id:o,source:Te,sourceLayer:Te,color:"black",width:.5});let u=!1;function i(f){u=f,r(0,u)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",u?"visible":"none")},[u,s,n,i]}class wa extends V{constructor(e){super(),q(this,e,_a,da,K,{})}}function ba(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function va(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ya(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ka(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[va]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ya]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment),f=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const v={};p&32&&(v.$$scope={dirty:p,ctx:c}),i.$set(v)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function Sa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ka]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ca(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:He,$$slots:{right:[Sa],default:[ba]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:He,tooltip:La,show:t[0],clickable:!0}}),o.$on("click",Oa),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let He="local_authority_districts";function La(t){return`<p>${t.properties.name}</p>`}function Oa(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function Ta(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.local_authority_districts,s=`${He}-outline`;sr(n,He,`https://atip.uk/layers/v1/${He}.geojson`),Ve(n,{id:He,source:He,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:He,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class Aa extends V{constructor(e){super(),q(this,e,Ta,Ca,K,{})}}function Da(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ea(t){let e;return{c(){e=y(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pa(t){let e;return{c(){e=y(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ma(t){let e;return{c(){e=y(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Na(t){let e;return{c(){e=y("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ia(t){let e;return{c(){e=y(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fa(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xa(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v,k,S,L,E,F,C,A,x,I,P,M;return n=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Ea]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Pa]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Ma]},$$scope:{ctx:t}}}),$=new B({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Na]},$$scope:{ctx:t}}}),E=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Ia]},$$scope:{ctx:t}}}),I=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Fa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("LPAs may be a "),_(n.$$.fragment),o=y(", "),_(s.$$.fragment),l=y("y, or "),_(u.$$.fragment),i=y("."),f=O(),a=D("p"),c=D("strong"),p=y(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),v=y(" to get more details."),k=O(),S=D("p"),L=y("Data from ONS Geography via "),_(E.$$.fragment),F=y(", as of November 2022."),C=O(),A=D("p"),x=y("License: "),_(I.$$.fragment),P=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(N,j){m(N,e,j),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),w(u,e,null),T(e,i),m(N,f,j),m(N,a,j),T(a,c),T(c,p),w($,c,null),T(c,v),m(N,k,j),m(N,S,j),T(S,L),w(E,S,null),T(S,F),m(N,C,j),m(N,A,j),T(A,x),w(I,A,null),T(A,P),M=!0},p(N,j){const ee={};j&32&&(ee.$$scope={dirty:j,ctx:N}),n.$set(ee);const H={};j&32&&(H.$$scope={dirty:j,ctx:N}),s.$set(H);const ce={};j&32&&(ce.$$scope={dirty:j,ctx:N}),u.$set(ce);const we={};j&32&&(we.$$scope={dirty:j,ctx:N}),$.$set(we);const oe={};j&32&&(oe.$$scope={dirty:j,ctx:N}),E.$set(oe);const Ke={};j&32&&(Ke.$$scope={dirty:j,ctx:N}),I.$set(Ke)},i(N){M||(d(n.$$.fragment,N),d(s.$$.fragment,N),d(u.$$.fragment,N),d($.$$.fragment,N),d(E.$$.fragment,N),d(I.$$.fragment,N),M=!0)},o(N){g(n.$$.fragment,N),g(s.$$.fragment,N),g(u.$$.fragment,N),g($.$$.fragment,N),g(E.$$.fragment,N),g(I.$$.fragment,N),M=!1},d(N){N&&(h(e),h(f),h(a),h(k),h(S),h(C),h(A)),b(n),b(s),b(u),b($),b(E),b(I)}}}function Ba(t){let e,r,n;return r=new ne({props:{$$slots:{default:[xa]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ja(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Ae,$$slots:{right:[Ba],default:[Da]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ae,tooltip:Ra,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ae="local_planning_authorities";function Ra(t){return`<p>${t.properties.name}</p>`}function Ua(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.local_planning_authorities,s=`${Ae}-outline`;le(n,Ae,`https://atip.uk/layers/v1/${Ae}.pmtiles`),Ve(n,{id:Ae,source:Ae,sourceLayer:Ae,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Ae,sourceLayer:Ae,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class Ha extends V{constructor(e){super(),q(this,e,Ua,ja,K,{})}}function Wa(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function za(t){let e;return{c(){e=y(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ga(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Va(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[za]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ga]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from the "),_(n.$$.fragment),o=y(", as of September 2021."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function qa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Va]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ka(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:Je,$$slots:{right:[qa],default:[Wa]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Je,tooltip:Za,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&16&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Je="mrn";function Za(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Xa(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=W.mrn;le(n,Je,`https://atip.uk/layers/v1/${Je}.pmtiles`),ge(n,{id:Je,source:Je,sourceLayer:Je,color:o,width:7,opacity:ue(.5,1)});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class Ya extends V{constructor(e){super(),q(this,e,Xa,Ka,K,{})}}function Ja(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Qa(t){let e;return{c(){e=y(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ef(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tf(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Qa]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ef]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function rf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[tf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function nf(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:De,$$slots:{right:[rf],default:[Ja]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:De,tooltip:of,show:t[0],clickable:!0}}),o.$on("click",sf),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="parliamentary_constituencies";function of(t){return`<p>${t.properties.Name}</p>`}function sf(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function lf(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.parliamentary_constituencies,s=`${De}-outline`;le(n,De,`https://atip.uk/layers/v1/${De}.pmtiles`),Ve(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:De,sourceLayer:De,color:o,width:5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class af extends V{constructor(e){super(),q(this,e,lf,nf,K,{})}}function ff(t){let e;return{c(){e=y("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function uf(t){let e;return{c(){e=y("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function cf(t){let e;return{c(){e=y("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pf(t){let e,r,n,o,s,l,u,i,f,a,c;return u=new B({props:{href:"https://www.pct.bike",$$slots:{default:[uf]},$$scope:{ctx:t}}}),f=new B({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[cf]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=O(),n=D("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=O(),s=D("p"),l=y("See "),_(u.$$.fragment),i=y(" and "),_(f.$$.fragment),a=y(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),T(s,l),w(u,s,null),T(s,i),w(f,s,null),T(s,a),c=!0},p(p,$){const v={};$&2048&&(v.$$scope={dirty:$,ctx:p}),u.$set(v);const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),f.$set(k)},i(p){c||(d(u.$$.fragment,p),d(f.$$.fragment,p),c=!0)},o(p){g(u.$$.fragment,p),g(f.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(u),b(f)}}}function $f(t){let e,r,n;return r=new ne({props:{$$slots:{default:[pf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function zr(t){let e,r,n,o,s,l,u,i;e=new qe({props:{colorScale:t[3],limits:t[4]}});function f($){t[8]($)}let a={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(a.value=t[0]),n=new un({props:a}),U.push(()=>z(n,"value",f)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new Pt({props:p}),U.push(()=>z(l,"value",c)),l.$on("change",t[6]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),s=O(),_(l.$$.fragment)},m($,v){w(e,$,v),m($,r,v),w(n,$,v),m($,s,v),w(l,$,v),i=!0},p($,v){const k={};!o&&v&1&&(o=!0,k.value=$[0],G(()=>o=!1)),n.$set(k);const S={};!u&&v&2&&(u=!0,S.value=$[1],G(()=>u=!1)),l.$set(S)},i($){i||(d(e.$$.fragment,$),d(n.$$.fragment,$),d(l.$$.fragment,$),i=!0)},o($){g(e.$$.fragment,$),g(n.$$.fragment,$),g(l.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(l,$)}}}function mf(t){let e,r,n,o,s,l,u,i;function f(p){t[7](p)}let a={id:nt,$$slots:{right:[$f],default:[ff]},$$scope:{ctx:t}};t[2]!==void 0&&(a.checked=t[2]),e=new te({props:a}),U.push(()=>z(e,"checked",f));let c=t[2]&&zr(t);return s=new J({props:{layer:nt,tooltip:t[5],show:t[2]&&t[0]==nt,clickable:!1}}),u=new J({props:{layer:Dt,tooltip:t[5],show:t[2]&&t[0]==Dt,clickable:!1}}),{c(){_(e.$$.fragment),n=O(),c&&c.c(),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(u,p,$),i=!0},p(p,[$]){const v={};$&2048&&(v.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,v.checked=p[2],G(()=>r=!1)),e.$set(v),p[2]?c?(c.p(p,$),$&4&&d(c,1)):(c=zr(p),c.c(),d(c,1),c.m(o.parentNode,o)):c&&(ae(),g(c,1,1,()=>{c=null}),fe());const k={};$&5&&(k.show=p[2]&&p[0]==nt),s.$set(k);const S={};$&5&&(S.show=p[2]&&p[0]==Dt),u.$set(S)},i(p){i||(d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(u.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(u.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(l)),b(e,p),c&&c.d(p),b(s,p),b(u,p)}}}let nt="pct_commute",Dt="pct_school";function hf(t,e,r){let n;X(t,re,v=>r(10,n=v));let o=W.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=nt,u="baseline";for(let v of[nt,Dt])le(n,v,`https://atip.uk/layers/v1/${v}.pmtiles`),ge(n,{id:v,source:v,sourceLayer:v,color:Ge(["get",u],s,o),width:Bt,opacity:ue(.5,1)});let i=!1;function f(v){let k=v.properties.baseline,S=v.properties.gov_target,L=v.properties.go_dutch,E=`<h2>Trip purpose: ${l==nt?"commuting":"school"}</h2>`;if(E+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)E+=`<p>Government target (2025): <b>${S.toLocaleString()}</b></p>`,E+=`<p>Go Dutch: <b>${L.toLocaleString()}</b></p>`;else{let F=(S/k).toFixed(1),C=(L/k).toFixed(1);E+=`<p>Government target (2025): ${S.toLocaleString()} (<b>${F}x</b> of baseline)</p>`,E+=`<p>Go Dutch: ${L.toLocaleString()} (<b>${C}x</b> of baseline)</p>`}return E}function a(){n.setPaintProperty(l,"line-color",Ge(["get",u],s,o))}function c(v){i=v,r(2,i)}function p(v){l=v,r(0,l)}function $(v){u=v,r(1,u)}return[l,u,i,o,s,f,a,c,p,$]}class df extends V{constructor(e){super(),q(this,e,hf,mf,K,{})}}function gf(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function _f(t){let e;return{c(){e=y("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wf(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function bf(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[_f]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[wf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function vf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[bf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function yf(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:Qe,$$slots:{right:[vf],default:[gf]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Qe,tooltip:kf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Qe="railway_stations";function kf(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function Sf(t,e,r){let n;X(t,re,i=>r(3,n=i));const o=`https://atip.uk/layers/v1/${Qe}.geojson`;let s=!1;sr(n,Qe,o);let l=W[Qe];ht(n,{id:Qe,source:Qe,color:l,radius:Jn/2});function u(i){s=i,r(0,s)}return[s,l,u]}class Cf extends V{constructor(e){super(),q(this,e,Sf,yf,K,{})}}function Lf(t){let e;return{c(){e=y("OS Speeds")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Of(t){let e;return{c(){e=y("Basemap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Tf(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Af(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[Of]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Tf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=y(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=O(),l=D("p"),l.textContent="Data valid as of 1 September, 2023",u=O(),i=D("p"),f=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(a.$$.fragment),c=y(".")},m($,v){m($,e,v),T(e,r),w(n,e,null),T(e,o),m($,s,v),m($,l,v),m($,u,v),m($,i,v),T(i,f),w(a,i,null),T(i,c),p=!0},p($,v){const k={};v&256&&(k.$$scope={dirty:v,ctx:$}),n.$set(k);const S={};v&256&&(S.$$scope={dirty:v,ctx:$}),a.$set(S)},i($){p||(d(n.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(s),h(l),h(u),h(i)),b(n),b(a)}}}function Df(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Af]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Gr(t){let e,r,n,o,s;e=new qe({props:{colorScale:t[2],limits:t[3]}});function l(i){t[6](i)}let u={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(u.value=t[0]),n=new un({props:u}),U.push(()=>z(n,"value",l)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),s=!0},p(i,f){const a={};!o&&f&1&&(o=!0,a.value=i[0],G(()=>o=!1)),n.$set(a)},i(i){s||(d(e.$$.fragment,i),d(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(e,i),b(n,i)}}}function Ef(t){let e,r,n,o,s,l;function u(a){t[5](a)}let i={id:We,$$slots:{right:[Df],default:[Lf]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[1]&&Gr(t);return s=new J({props:{layer:We,tooltip:Pf,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:a}),!r&&c&2&&(r=!0,p.checked=a[1],G(()=>r=!1)),e.$set(p),a[1]?f?(f.p(a,c),c&2&&d(f,1)):(f=Gr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(ae(),g(f,1,1,()=>{f=null}),fe());const $={};c&2&&($.show=a[1]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let We="road_speeds";function Pf(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function Mf(t,e,r){let n;X(t,re,c=>r(7,n=c));let o=W.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";le(n,We,`https://atip.uk/private_layers/v1/${We}.pmtiles`),ge(n,{id:We,source:We,sourceLayer:We,color:Ge(["get",l],s,o),width:Bt,opacity:ue(.5,1)});let u=!1;function i(){n.setPaintProperty(We,"line-color",Ge(["get",l],s,o))}function f(c){u=c,r(1,u)}function a(c){l=c,r(0,l)}return[l,u,o,s,i,f,a]}class Nf extends V{constructor(e){super(),q(this,e,Mf,Ef,K,{})}}function If(t){let e;return{c(){e=y("OS Road widths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ff(t){let e;return{c(){e=y(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xf(t){let e,r,n,o,s,l,u,i,f;return u=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Ff]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=O(),n=D("p"),n.textContent="Data valid as of 1 September, 2023",o=O(),s=D("p"),l=y(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),i=y(".")},m(a,c){m(a,e,c),m(a,r,c),m(a,n,c),m(a,o,c),m(a,s,c),T(s,l),w(u,s,null),T(s,i),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),u.$set(p)},i(a){f||(d(u.$$.fragment,a),f=!0)},o(a){g(u.$$.fragment,a),f=!1},d(a){a&&(h(e),h(r),h(n),h(o),h(s)),b(u)}}}function Bf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[xf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Vr(t){let e,r;return e=new qe({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function jf(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:et,$$slots:{right:[Bf],default:[If]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&Vr(t);return s=new J({props:{layer:et,tooltip:Rf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Vr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(ae(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let et="road_widths";function Rf(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function Uf(t,e,r){let n;X(t,re,i=>r(4,n=i));let o=W.sequential_low_to_high,s=[0,5,10,15,20,100];le(n,et,`https://atip.uk/private_layers/v1/${et}.pmtiles`),ge(n,{id:et,source:et,sourceLayer:et,color:Ge(["get","average"],s,o),width:Bt,opacity:ue(.5,1)});let l=!1;function u(i){l=i,r(0,l)}return[l,o,s,u]}class Hf extends V{constructor(e){super(),q(this,e,Uf,jf,K,{})}}function Wf(t){let e;return{c(){e=y("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zf(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gf(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Wf]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[zf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Vf(t){let e,r;return e=new lr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Gf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class qf extends V{constructor(e){super(),q(this,e,null,Vf,K,{})}}function Kf(t){let e;return{c(){e=y("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zf(t){let e;return{c(){e=y("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xf(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yf(t){let e,r,n,o,s,l,u,i,f,a,c;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[Kf]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Zf]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Xf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("This shows "),_(n.$$.fragment),o=y(" and "),_(s.$$.fragment),l=y(" data from OpenStreetMap (as of 9 August 2023)."),u=O(),i=D("p"),f=y("License: "),_(a.$$.fragment)},m(p,$){m(p,e,$),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m(p,u,$),m(p,i,$),T(i,f),w(a,i,null),c=!0},p(p,$){const v={};$&1&&(v.$$scope={dirty:$,ctx:p}),n.$set(v);const k={};$&1&&(k.$$scope={dirty:$,ctx:p}),s.$set(k);const S={};$&1&&(S.$$scope={dirty:$,ctx:p}),a.$set(S)},i(p){c||(d(n.$$.fragment,p),d(s.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function Jf(t){let e,r;return e=new lr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Yf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Qf extends V{constructor(e){super(),q(this,e,null,Jf,K,{})}}function eu(t){let e;return{c(){e=y("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tu(t){let e;return{c(){e=y(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ru(t){let e;return{c(){e=y("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nu(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ou(t){let e,r,n,o,s,l,u,i,f,a,c,p,$;return n=new B({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[tu]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[ru]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[nu]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=y(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),l=y(" for details and caveats about the measurements."),u=O(),i=D("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=O(),a=D("p"),c=y("License: "),_(p.$$.fragment)},m(v,k){m(v,e,k),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m(v,u,k),m(v,i,k),m(v,f,k),m(v,a,k),T(a,c),w(p,a,null),$=!0},p(v,k){const S={};k&64&&(S.$$scope={dirty:k,ctx:v}),n.$set(S);const L={};k&64&&(L.$$scope={dirty:k,ctx:v}),s.$set(L);const E={};k&64&&(E.$$scope={dirty:k,ctx:v}),p.$set(E)},i(v){$||(d(n.$$.fragment,v),d(s.$$.fragment,v),d(p.$$.fragment,v),$=!0)},o(v){g(n.$$.fragment,v),g(s.$$.fragment,v),g(p.$$.fragment,v),$=!1},d(v){v&&(h(e),h(u),h(i),h(f),h(a)),b(n),b(s),b(p)}}}function su(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ou]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function qr(t){let e,r;return e=new qe({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function iu(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:tt,$$slots:{right:[su],default:[eu]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),U.push(()=>z(e,"checked",u));let f=t[0]&&qr(t);return s=new J({props:{layer:tt,tooltip:lu,show:t[0],clickable:!0}}),s.$on("click",au),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=qr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(ae(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let tt="vehicle_counts";function lu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function au(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function fu(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=W.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];le(n,tt,`https://atip.uk/layers/v1/${tt}.pmtiles`),ht(n,{id:tt,source:tt,sourceLayer:tt,color:Ge(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let u=!1;function i(f){u=f,r(0,u)}return[u,o,l,i]}class uu extends V{constructor(e){super(),q(this,e,fu,iu,K,{})}}function cu(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=y(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function pu(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $u(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function mu(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[pu]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[$u]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=y("Data from "),_(n.$$.fragment),o=y(", as of May 2023."),s=O(),l=D("p"),u=y("License: "),_(i.$$.fragment),f=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const v={};p&32&&(v.$$scope={dirty:p,ctx:c}),i.$set(v)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function hu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[mu]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),R(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function du(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Ee,$$slots:{right:[hu],default:[cu]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),U.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ee,tooltip:gu,show:t[0],clickable:!0}}),o.$on("click",_u),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="wards";function gu(t){return`<p>${t.properties.name}</p>`}function _u(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function wu(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=W.wards,s=`${Ee}-outline`;le(n,Ee,`https://atip.uk/layers/v1/${Ee}.pmtiles`),Ve(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class bu extends V{constructor(e){super(),q(this,e,wu,du,K,{})}}function vu(t){let e,r,n,o,s,l,u,i;return e=new qf({}),n=new fa({}),s=new Qf({}),u=new Cf({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment)},m(f,a){w(e,f,a),m(f,r,a),w(n,f,a),m(f,o,a),w(s,f,a),m(f,l,a),w(u,f,a),i=!0},i(f){i||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),d(u.$$.fragment,f),i=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),g(u.$$.fragment,f),i=!1},d(f){f&&(h(r),h(o),h(l)),b(e,f),b(n,f),b(s,f),b(u,f)}}}function yu(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[vu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function ku(t){let e,r,n,o,s,l,u,i,f,a;return e=new Ql({}),n=new Ya({}),s=new Bi({}),u=new zl({}),f=new Il({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(u,c,p),m(c,i,p),w(f,c,p),a=!0},i(c){a||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),a=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),a=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function Su(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[ku]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Cu(t){let e,r,n,o,s,l,u,i,f,a;return e=new af({}),n=new bu({}),s=new _l({}),u=new Aa({}),f=new Ha({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(u,c,p),m(c,i,p),w(f,c,p),a=!0},i(c){a||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),a=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),a=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function Lu(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[Cu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ou(t){let e,r,n,o;return e=new al({}),n=new wa({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Tu(t){let e,r,n,o;return e=new Hf({}),n=new Nf({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Au(t){let e,r,n,o,s=or()=="Private (development)",l,u;e=new uu({}),n=new df({});let i=s&&Tu();return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),i&&i.c(),l=xt()},m(f,a){w(e,f,a),m(f,r,a),w(n,f,a),m(f,o,a),i&&i.m(f,a),m(f,l,a),u=!0},p:Q,i(f){u||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(i),u=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(i),u=!1},d(f){f&&(h(r),h(o),h(l)),b(e,f),b(n,f),i&&i.d(f)}}}function Du(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,v,k,S,L;e=new Ll({}),n=new Fe({props:{label:"Trip generators",$$slots:{default:[yu]},$$scope:{ctx:t}}}),s=new Fe({props:{label:"Existing infrastructure",$$slots:{default:[Su]},$$scope:{ctx:t}}}),u=new Fe({props:{label:"Boundaries",$$slots:{default:[Lu]},$$scope:{ctx:t}}}),f=new Fe({props:{label:"Census",$$slots:{default:[Ou]},$$scope:{ctx:t}}}),c=new Fe({props:{label:"Other",$$slots:{default:[Au]},$$scope:{ctx:t}}});function E(C){t[5](C)}let F={displayEnableButton:!0};return t[2]!==void 0&&(F.isInactive=t[2]),$=new Qn({props:F}),t[4]($),U.push(()=>z($,"isInactive",E)),S=new no({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),a=O(),_(c.$$.fragment),p=O(),_($.$$.fragment),k=O(),_(S.$$.fragment)},m(C,A){w(e,C,A),m(C,r,A),w(n,C,A),m(C,o,A),w(s,C,A),m(C,l,A),w(u,C,A),m(C,i,A),w(f,C,A),m(C,a,A),w(c,C,A),m(C,p,A),w($,C,A),m(C,k,A),w(S,C,A),L=!0},p(C,A){const x={};A&64&&(x.$$scope={dirty:A,ctx:C}),n.$set(x);const I={};A&64&&(I.$$scope={dirty:A,ctx:C}),s.$set(I);const P={};A&64&&(P.$$scope={dirty:A,ctx:C}),u.$set(P);const M={};A&64&&(M.$$scope={dirty:A,ctx:C}),f.$set(M);const N={};A&64&&(N.$$scope={dirty:A,ctx:C}),c.$set(N);const j={};!v&&A&4&&(v=!0,j.isInactive=C[2],G(()=>v=!1)),$.$set(j);const ee={};A&1&&(ee.style=C[0]),S.$set(ee)},i(C){L||(d(e.$$.fragment,C),d(n.$$.fragment,C),d(s.$$.fragment,C),d(u.$$.fragment,C),d(f.$$.fragment,C),d(c.$$.fragment,C),d($.$$.fragment,C),d(S.$$.fragment,C),L=!0)},o(C){g(e.$$.fragment,C),g(n.$$.fragment,C),g(s.$$.fragment,C),g(u.$$.fragment,C),g(f.$$.fragment,C),g(c.$$.fragment,C),g($.$$.fragment,C),g(S.$$.fragment,C),L=!1},d(C){C&&(h(r),h(o),h(l),h(i),h(a),h(p),h(k)),b(e,C),b(n,C),b(s,C),b(u,C),b(f,C),b(c,C),t[4](null),b($,C),b(S,C)}}}function Eu(t){let e,r,n,o;return e=new Fe({props:{label:"Layers",open:!0,$$slots:{default:[Du]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,l){w(e,s,l),r=!0,n||(o=It(window,"keydown",t[3]),n=!0)},p(s,[l]){const u={};l&71&&(u.$$scope={dirty:l,ctx:s}),e.$set(u)},i(s){r||(d(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function Pu(t,e,r){let n;X(t,$r,f=>r(2,n=f));let{style:o}=e,s;function l(f){!n&&f.key=="Escape"&&(s.disableStreetView(),f.preventDefault())}function u(f){U[f?"unshift":"push"](()=>{s=f,r(1,s)})}function i(f){n=f,$r.set(n)}return t.$$set=f=>{"style"in f&&r(0,o=f.style)},[o,s,n,l,u,i]}class Mu extends V{constructor(e){super(),q(this,e,Pu,Eu,K,{style:0})}}function Nu(t,e,r){let{loadFile:n}=e;return Ft(async()=>{let s=await(await fetch("https://atip.uk/random_schemes.geojson")).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class Iu extends V{constructor(e){super(),q(this,e,Nu,null,K,{loadFile:0})}}function Fu(t){let e;return{c(){e=y("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xu(t){let e;return{c(){e=y("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bu(t){let e,r,n=t[0].authority_or_region+"",o,s,l,u,i=t[0].capital_scheme_id+"",f,a,c,p,$=t[0].funding_programme+"",v,k,S,L,E,F,C;return L=new Kt({props:{$$slots:{default:[Fu]},$$scope:{ctx:t}}}),L.$on("click",t[3]),F=new Kt({props:{disabled:t[1],title:t[2],$$slots:{default:[xu]},$$scope:{ctx:t}}}),F.$on("click",t[4]),{c(){e=D("p"),r=y("Authority or region: "),o=y(n),s=O(),l=D("p"),u=y("Capital scheme ID: "),f=y(i),a=O(),c=D("p"),p=y("Funding programme: "),v=y($),k=O(),S=D("div"),_(L.$$.fragment),E=O(),_(F.$$.fragment),R(S,"class","govuk-button-group")},m(A,x){m(A,e,x),T(e,r),T(e,o),m(A,s,x),m(A,l,x),T(l,u),T(l,f),m(A,a,x),m(A,c,x),T(c,p),T(c,v),m(A,k,x),m(A,S,x),w(L,S,null),T(S,E),w(F,S,null),C=!0},p(A,x){(!C||x&1)&&n!==(n=A[0].authority_or_region+"")&&Le(o,n),(!C||x&1)&&i!==(i=A[0].capital_scheme_id+"")&&Le(f,i),(!C||x&1)&&$!==($=A[0].funding_programme+"")&&Le(v,$);const I={};x&256&&(I.$$scope={dirty:x,ctx:A}),L.$set(I);const P={};x&256&&(P.$$scope={dirty:x,ctx:A}),F.$set(P)},i(A){C||(d(L.$$.fragment,A),d(F.$$.fragment,A),C=!0)},o(A){g(L.$$.fragment,A),g(F.$$.fragment,A),C=!1},d(A){A&&(h(e),h(s),h(l),h(a),h(c),h(k),h(S)),b(L),b(F)}}}function ju(t){let e,r;return e=new Fe({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Bu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ru(t,e,r){let n,o;X(t,mt,c=>r(6,n=c)),X(t,re,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,u=!l.has(s.authority_or_region),i=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(Kn(c),{padding:20,animate:!1})}function a(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,u,i,f,a,l]}class Uu extends V{constructor(e){super(),q(this,e,Ru,ju,K,{scheme:0,authorityNames:5})}}const Hu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ie=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{u(r.next(i))}catch(f){o(f)}},l=i=>{try{u(r.throw(i))}catch(f){o(f)}},u=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);u((r=r.apply(t,e)).next())}),de=Uint8Array,pt=Uint16Array,Wu=Int32Array,Dn=new de([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),En=new de([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zu=new de([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Pn=function(t,e){for(var r=new pt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new Wu(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},Mn=Pn(Dn,2),Nn=Mn.b,Gu=Mn.r;Nn[28]=258,Gu[258]=28;var Vu=Pn(En,0),qu=Vu.b,rr=new pt(32768);for(Z=0;Z<32768;++Z)Ie=(Z&43690)>>1|(Z&21845)<<1,Ie=(Ie&52428)>>2|(Ie&13107)<<2,Ie=(Ie&61680)>>4|(Ie&3855)<<4,rr[Z]=((Ie&65280)>>8|(Ie&255)<<8)>>1;var Ie,Z,vt=function(t,e,r){for(var n=t.length,o=0,s=new pt(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new pt(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var u;if(r){u=new pt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)u[rr[c]>>i]=f}else for(u=new pt(n),o=0;o<n;++o)t[o]&&(u[o]=rr[l[t[o]-1]++]>>15-t[o]);return u},Ot=new de(288);for(Z=0;Z<144;++Z)Ot[Z]=8;var Z;for(Z=144;Z<256;++Z)Ot[Z]=9;var Z;for(Z=256;Z<280;++Z)Ot[Z]=7;var Z;for(Z=280;Z<288;++Z)Ot[Z]=8;var Z,In=new de(32);for(Z=0;Z<32;++Z)In[Z]=5;var Z,Ku=vt(Ot,9,1),Zu=vt(In,5,1),Vt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ye=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},qt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Xu=function(t){return(t+7)/8|0},Yu=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new de(r-e);return n.set(t.subarray(e,r)),n},Ju=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$e=function(t,e,r){var n=new Error(e||Ju[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,$e),!r)throw n;return n},ar=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new de(0);var l=!r||e.i!=2,u=e.i;r||(r=new de(o*3));var i=function(fr){var ur=r.length;if(fr>ur){var cr=new de(Math.max(ur*2,fr));cr.set(r),r=cr}},f=e.f||0,a=e.p||0,c=e.b||0,p=e.l,$=e.d,v=e.m,k=e.n,S=o*8;do{if(!p){f=ye(t,a,1);var L=ye(t,a+1,3);if(a+=3,L)if(L==1)p=Ku,$=Zu,v=9,k=5;else if(L==2){var A=ye(t,a,31)+257,x=ye(t,a+10,15)+4,I=A+ye(t,a+5,31)+1;a+=14;for(var P=new de(I),M=new de(19),N=0;N<x;++N)M[zu[N]]=ye(t,a+N*3,7);a+=x*3;for(var j=Vt(M),ee=(1<<j)-1,H=vt(M,j,1),N=0;N<I;){var ce=H[ye(t,a,ee)];a+=ce&15;var E=ce>>4;if(E<16)P[N++]=E;else{var we=0,oe=0;for(E==16?(oe=3+ye(t,a,3),a+=2,we=P[N-1]):E==17?(oe=3+ye(t,a,7),a+=3):E==18&&(oe=11+ye(t,a,127),a+=7);oe--;)P[N++]=we}}var Ke=P.subarray(0,A),pe=P.subarray(A);v=Vt(Ke),k=Vt(pe),p=vt(Ke,v,1),$=vt(pe,k,1)}else $e(1);else{var E=Xu(a)+4,F=t[E-4]|t[E-3]<<8,C=E+F;if(C>o){u&&$e(0);break}l&&i(c+F),r.set(t.subarray(E,C),c),e.b=c+=F,e.p=a=C*8,e.f=f;continue}if(a>S){u&&$e(0);break}}l&&i(c+131072);for(var dt=(1<<v)-1,Be=(1<<k)-1,st=a;;st=a){var we=p[qt(t,a)&dt],be=we>>4;if(a+=we&15,a>S){u&&$e(0);break}if(we||$e(2),be<256)r[c++]=be;else if(be==256){st=a,p=null;break}else{var it=be-254;if(be>264){var N=be-257,Ne=Dn[N];it=ye(t,a,(1<<Ne)-1)+Nn[N],a+=Ne}var lt=$[qt(t,a)&Be],at=lt>>4;lt||$e(3),a+=lt&15;var pe=qu[at];if(at>3){var Ne=En[at];pe+=qt(t,a)&(1<<Ne)-1,a+=Ne}if(a>S){u&&$e(0);break}l&&i(c+131072);var ft=c+it;if(c<pe){var gt=s-pe,Wn=Math.min(pe,ft);for(gt+c<0&&$e(3);c<Wn;++c)r[c]=n[gt+c]}for(;c<ft;c+=4)r[c]=r[c-pe],r[c+1]=r[c+1-pe],r[c+2]=r[c+2-pe],r[c+3]=r[c+3-pe];c=ft}}e.l=p,e.p=st,e.b=c,e.f=f,p&&(f=1,e.m=v,e.d=$,e.n=k)}while(!f);return c==r.length?r:Yu(r,0,c)},Qu=new de(0),ec=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&$e(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},tc=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},rc=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&$e(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&$e(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function nc(t,e){return ar(t,{i:2},e&&e.out,e&&e.dictionary)}function oc(t,e){var r=ec(t);return r+8>t.length&&$e(6,"invalid gzip data"),ar(t.subarray(r,-8),{i:2},e&&e.out||new de(tc(t)),e&&e.dictionary)}function sc(t,e){return ar(t.subarray(rc(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function nr(t,e){return t[0]==31&&t[1]==139&&t[2]==8?oc(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?nc(t,e):sc(t,e)}var ic=typeof TextDecoder<"u"&&new TextDecoder,lc=0;try{ic.decode(Qu,{stream:!0}),lc=1}catch{}var Fn=(t,e)=>t*Math.pow(2,e),_t=(t,e)=>Math.floor(t/Math.pow(2,e)),Nt=(t,e)=>Fn(t.getUint16(e+1,!0),8)+t.getUint8(e),xn=(t,e)=>Fn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),ac=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Nt(n,o+1);if(e!=s)return e-s;const l=Nt(n,o+4);return r!=l?r-l:0},fc=(t,e,r,n)=>{const o=Bn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Kr=(t,e,r,n)=>{const o=Bn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},Bn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,u=ac(e,r,n,t,l*17);if(u>0)o=l+1;else if(u<0)s=l-1;else return[xn(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},uc=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,jn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Nt(t,e*17+1),y:Nt(t,e*17+4),offset:xn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Zr=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(jn(r,n));return cc(e)},cc=t=>{t.sort(uc);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=_t(o.offset,8)&255,r[n*17+9]=_t(o.offset,16)&255,r[n*17+10]=_t(o.offset,24)&255,r[n*17+11]=_t(o.offset,32)&255,r[n*17+12]=_t(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},pc=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=jn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),u=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:u}}return null};function $c(t){return ie(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let u=0;l.compression==="gzip"&&(u=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let f=0;"maxzoom"in l&&(f=+l.maxzoom);let a=0,c=0,p=0,$=-180,v=-85,k=180,S=85;if(l.bounds){const E=l.bounds.split(",");$=+E[0],v=+E[1],k=+E[2],S=+E[3]}if(l.center){const E=l.center.split(",");a=+E[0],c=+E[1],p=+E[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:i,maxZoom:f,minLon:$,minLat:v,maxLon:k,maxLat:S,centerZoom:p,centerLon:a,centerLat:c,etag:e.etag}})}function mc(t,e,r,n,o,s,l){return ie(this,null,function*(){let u=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(u=Zr(u));const i=Kr(new DataView(u),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=nr(new Uint8Array(c))),{data:c}}const f=pc(new DataView(u),{z:n,x:o,y:s});if(f){const a=fc(new DataView(u),f.z,f.x,f.y);if(a){let c=yield r.getArrayBuffer(e,a.offset,a.length,t);t.specVersion===1&&(c=Zr(c));const p=Kr(new DataView(c),n,o,s);if(p){let v=(yield e.getBytes(p.offset,p.length,l)).data;const k=new DataView(v);return k.getUint8(0)==31&&k.getUint8(1)==139&&(v=nr(new Uint8Array(v))),{data:v}}}}})}var Rn={getHeader:$c,getZxy:mc},hc=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Xr(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new Xr(o),this.tiles.set(o,s));const l=n[2],u=n[3],i=n[4],f=new AbortController,a=f.signal;let c=()=>{f.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+u,+i,a).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function ut(t,e){return(e>>>0)*4294967296+(t>>>0)}function dc(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return ut(t,n);throw new Error("Expected varint not more than 10 bytes")}function wt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,dc(r,t))}function gc(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var _c=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function wc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=_c[t],o=Math.pow(2,t);let s=0,l=0,u=0;const i=[e,r];let f=o/2;for(;f>0;)s=(i[0]&f)>0?1:0,l=(i[1]&f)>0?1:0,u+=f*f*(3*s^l),gc(f,i,s,l),f=f/2;return n+u}function Un(t,e){return ie(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return nr(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var bc=127;function vc(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var yc=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ie(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const u=o.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+u.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ke(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function kc(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ke(r,8),rootDirectoryLength:ke(r,16),jsonMetadataOffset:ke(r,24),jsonMetadataLength:ke(r,32),leafDirectoryOffset:ke(r,40),leafDirectoryLength:ke(r,48),tileDataOffset:ke(r,56),tileDataLength:ke(r,64),numAddressedTiles:ke(r,72),numTileEntries:ke(r,80),numTileContents:ke(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function Hn(t){const e={buf:new Uint8Array(t),pos:0},r=wt(e),n=[];let o=0;for(let s=0;s<r;s++){const l=wt(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=wt(e);for(let s=0;s<r;s++)n[s].length=wt(e);for(let s=0;s<r;s++){const l=wt(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function Sc(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var $t=class extends Error{};function Cc(t,e,r,n){return ie(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Sc(o.data)<3)return[yield Rn.getHeader(t)];const l=o.data.slice(0,bc);let u=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),u=void 0);const i=kc(l,u);if(r){const f=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),a=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=Hn(yield e(f,i.internalCompression));return[i,[a,c.length,c]]}return[i,void 0]})}function Lc(t,e,r,n,o){return ie(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new $t(s.etag);const l=yield e(s.data,o.internalCompression),u=Hn(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Oc=class{constructor(t=100,e=!0,r=Un){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ie(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{Cc(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,u)=>{Lc(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,u)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new $t(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ie(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Xr=class{constructor(t,e,r){typeof t=="string"?this.source=new yc(t):this.source=t,r?this.decompress=r:this.decompress=Un,e?this.cache=e:this.cache=new Oc}getHeader(){return ie(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ie(this,null,function*(){const o=wc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Rn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,u=s.rootDirectoryLength;for(let i=0;i<=3;i++){const f=yield this.cache.getDirectory(this.source,l,u,s),a=vc(f,o);if(a)if(a.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+a.offset,a.length,n);if(s.etag&&s.etag!==c.etag)throw new $t(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+a.offset,u=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ie(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof $t)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ie(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new $t(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ie(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof $t)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Tc(t){return Ft(()=>{let e=new hc;mr.addProtocol("pmtiles",e.tile)}),cn(()=>{mr.removeProtocol("pmtiles")}),[]}class Ac extends V{constructor(e){super(),q(this,e,Tc,null,K,{})}}function Yr(t,e,r){const n=t.slice();return n[13]=e[r],n}function Dc(t){let e,r;return e=new Iu({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Jr(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let u={schemes:t[1]};return t[2]!==void 0&&(u.schemesToBeShown=t[2]),t[3]!==void 0&&(u.filterText=t[3]),e=new Ai({props:u}),U.push(()=>z(e,"schemesToBeShown",s)),U.push(()=>z(e,"filterText",l)),{c(){_(e.$$.fragment)},m(i,f){w(e,i,f),o=!0},p(i,f){const a={};f&2&&(a.schemes=i[1]),!r&&f&4&&(r=!0,a.schemesToBeShown=i[2],G(()=>r=!1)),!n&&f&8&&(n=!0,a.filterText=i[3],G(()=>n=!1)),e.$set(a)},i(i){o||(d(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function Qr(t){let e,r;return e=new Uu({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function en(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&Qr(t);return{c(){o&&o.c(),r=xt()},m(s,l){o&&o.m(s,l),m(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&d(o,1)):(o=Qr(s),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(ae(),g(o,1,1,()=>{o=null}),fe())},i(s){n||(d(o),n=!0)},o(s){g(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function Ec(t){let e,r,n,o,s,l,u,i,f,a,c=or()=="Private (development)",p,$,v,k,S,L,E,F;s=new oo({props:{boundaryGeojson:t[4]}}),u=new ho({}),f=new Zn({});let C=c&&Dc(t);$=new io({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),k=new fn({props:{errorMessage:t[0]}});let A=t[1].size>0&&Jr(t),x=ze(t[1].values()),I=[];for(let M=0;M<x.length;M+=1)I[M]=en(Yr(t,x,M));const P=M=>g(I[M],1,1,()=>{I[M]=null});return{c(){e=D("div"),r=D("div"),n=D("h1"),n.textContent="Browse schemes",o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),a=O(),C&&C.c(),p=O(),_($.$$.fragment),v=O(),_(k.$$.fragment),S=O(),A&&A.c(),L=O(),E=D("ul");for(let M=0;M<I.length;M+=1)I[M].c();xe(r,"display","flex"),xe(r,"justify-content","space-between"),R(e,"slot","sidebar"),R(e,"class","govuk-prose")},m(M,N){m(M,e,N),T(e,r),T(r,n),T(r,o),w(s,r,null),T(e,l),w(u,e,null),T(e,i),w(f,e,null),T(e,a),C&&C.m(e,null),T(e,p),w($,e,null),T(e,v),w(k,e,null),T(e,S),A&&A.m(e,null),T(e,L),T(e,E);for(let j=0;j<I.length;j+=1)I[j]&&I[j].m(E,null);F=!0},p(M,N){const j={};N&16&&(j.boundaryGeojson=M[4]),s.$set(j),c&&C.p(M,N);const ee={};if(N&1&&(ee.errorMessage=M[0]),k.$set(ee),M[1].size>0?A?(A.p(M,N),N&2&&d(A,1)):(A=Jr(M),A.c(),d(A,1),A.m(e,L)):A&&(ae(),g(A,1,1,()=>{A=null}),fe()),N&38){x=ze(M[1].values());let H;for(H=0;H<x.length;H+=1){const ce=Yr(M,x,H);I[H]?(I[H].p(ce,N),d(I[H],1)):(I[H]=en(ce),I[H].c(),d(I[H],1),I[H].m(E,null))}for(ae(),H=x.length;H<I.length;H+=1)P(H);fe()}},i(M){if(!F){d(s.$$.fragment,M),d(u.$$.fragment,M),d(f.$$.fragment,M),d(C),d($.$$.fragment,M),d(k.$$.fragment,M),d(A);for(let N=0;N<x.length;N+=1)d(I[N]);F=!0}},o(M){g(s.$$.fragment,M),g(u.$$.fragment,M),g(f.$$.fragment,M),g(C),g($.$$.fragment,M),g(k.$$.fragment,M),g(A),I=I.filter(Boolean);for(let N=0;N<I.length;N+=1)g(I[N]);F=!1},d(M){M&&h(e),b(s),b(u),b(f),C&&C.d(),b($),b(k),A&&A.d(),Et(I,M)}}}function Pc(t){let e,r,n,o,s,l,u,i,f,a,c;return e=new so({props:{colorInterventions:pn("v1")}}),n=new J({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new J({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),u=new J({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),a=new Mu({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),f=D("div"),_(a.$$.fragment),R(f,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(u,p,$),m(p,i,$),m(p,f,$),w(a,f,null),c=!0},p:Q,i(p){c||(d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(l),h(i),h(f)),b(e,p),b(n,p),b(s,p),b(u,p),b(a)}}}function Mc(t){let e,r,n,o,s;return r=new Ac({}),o=new to({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Pc]},$$scope:{ctx:t}}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),_(o.$$.fragment),R(e,"slot","main")},m(l,u){m(l,e,u),w(r,e,null),T(e,n),w(o,e,null),s=!0},p(l,u){const i={};u&65536&&(i.$$scope={dirty:u,ctx:l}),o.$set(i)},i(l){s||(d(r.$$.fragment,l),d(o.$$.fragment,l),s=!0)},o(l){g(r.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&h(e),b(r),b(o)}}}function Nc(t){let e,r;return e=new eo({props:{$$slots:{main:[Mc],sidebar:[Ec]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ic(t,e,r){let n;X(t,mt,S=>r(4,n=S));let o=new Set(Hu);Ft(()=>{Xn()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",u="",i=new Map,f=new Set,a="";cn(()=>{mt.set(an())});function c(S){try{let L=JSON.parse(S);r(1,i=gi(L)),mt.set(L),r(0,u="")}catch(L){r(0,u=`The file you loaded is broken: ${L}`)}}function p(S){let L=S.properties;var E='<div style="max-width: 30vw;">';return E+=`<h2>${$(L.name)} (${L.intervention_type})</h2>`,E+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(E+=`<p>Length: ${Yn(L.length_meters)}</p>`),L.description&&(E+=`<p>${$(L.description)}</p>`),E+="</div>",E}function $(S){return a?S.replace(new RegExp(a,"gi"),L=>`<mark>${L}</mark>`):S}function v(S){f=S,r(2,f)}function k(S){a=S,r(3,a)}return[u,i,f,a,n,o,l,c,p,v,k]}class Fc extends V{constructor(e){super(),q(this,e,Ic,Nc,K,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Fc({target:document.getElementById("app")});
