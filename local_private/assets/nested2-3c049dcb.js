import{S as K,i as q,s as Z,e as D,u as v,d as O,g as _,j as m,k as T,m as w,t as d,n as g,p as h,q as b,f as or,x as Q,aq as Hn,b as H,c as z,l as V,Q as X,C as re,ar as nn,W as ht,r as xt,F as on,a as qt,h as G,v as mr,w as sr,I as Oe,aS as ae,aT as se,$ as _e,G as ce,aR as B,J as Ve,N as Be,K as Pt,y as fe,o as ue,V as Ke,aU as Ge,U as ir,aV as Wn,a1 as sn,a0 as dt,E as ln,a5 as Ft,aK as zn,aL as Vn,aM as Gn,aN as Kn,R as an,aW as lr,aX as hr,D as qn,aY as dr,a8 as fn,L as Zn,z as Xn,aH as Yn}from"./index-98387c1b.js";import{H as ne,L as Jn,d as gr,c as un,C as we,B as Qn,Z as eo,I as to}from"./schemas-a7dee2f0.js";import{e as Nt,C as Fe,b as Ct,d as te,a as ro,S as no,L as oo,M as so}from"./StreetViewController-36584913.js";import{I as J,F as io}from"./InteractiveLayer-2064aca1.js";function lo(t){let e;return{c(){e=D("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ao(t){let e,r,n,o,s=t[0]=="Private (development)"&&lo();return{c(){s&&s.c(),e=O(),r=D("p"),r.textContent="Note the ATF scheme data has not been validated.",n=O(),o=D("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,u){s&&s.m(l,u),m(l,e,u),m(l,r,u),m(l,n,u),m(l,o,u)},p:Q,d(l){l&&(h(e),h(r),h(n),h(o)),s&&s.d(l)}}}function fo(t){let e,r,n,o,s,l;return s=new ne({props:{$$slots:{default:[ao]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("App version: "),n=v(t[0]),o=O(),_(s.$$.fragment)},m(u,i){m(u,e,i),T(e,r),T(e,n),T(e,o),w(s,e,null),l=!0},p(u,[i]){const f={};i&2&&(f.$$scope={dirty:i,ctx:u}),s.$set(f)},i(u){l||(d(s.$$.fragment,u),l=!0)},o(u){g(s.$$.fragment,u),l=!1},d(u){u&&h(e),b(s)}}}function uo(t){return[or()]}class co extends K{constructor(e){super(),q(this,e,uo,fo,Z,{})}}const po={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var he=Uint8Array,nt=Uint16Array,cn=Uint32Array,pn=new he([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$n=new he([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$o=new he([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mn=function(t,e){for(var r=new nt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new cn(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},hn=mn(pn,2),dn=hn[0],mo=hn[1];dn[28]=258,mo[258]=28;var ho=mn($n,0),go=ho[0],Zt=new nt(32768);for(var Y=0;Y<32768;++Y){var Re=(Y&43690)>>>1|(Y&21845)<<1;Re=(Re&52428)>>>2|(Re&13107)<<2,Re=(Re&61680)>>>4|(Re&3855)<<4,Zt[Y]=((Re&65280)>>>8|(Re&255)<<8)>>>1}var vt=function(t,e,r){for(var n=t.length,o=0,s=new nt(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new nt(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var u;if(r){u=new nt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)u[Zt[c]>>>i]=f}else for(u=new nt(n),o=0;o<n;++o)t[o]&&(u[o]=Zt[l[t[o]-1]++]>>>15-t[o]);return u},Lt=new he(288);for(var Y=0;Y<144;++Y)Lt[Y]=8;for(var Y=144;Y<256;++Y)Lt[Y]=9;for(var Y=256;Y<280;++Y)Lt[Y]=7;for(var Y=280;Y<288;++Y)Lt[Y]=8;var gn=new he(32);for(var Y=0;Y<32;++Y)gn[Y]=5;var _o=vt(Lt,9,1),wo=vt(gn,5,1),jt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ye=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Rt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},bo=function(t){return(t+7)/8|0},ar=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?nt:t.BYTES_PER_ELEMENT==4?cn:he)(r-e);return n.set(t.subarray(e,r)),n},vo=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ce=function(t,e,r){var n=new Error(e||vo[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Ce),!r)throw n;return n},yo=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new he(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new he(n*3));var l=function(ft){var ut=e.length;if(ft>ut){var _t=new he(Math.max(ut*2,ft));_t.set(e),e=_t}},u=r.f||0,i=r.p||0,f=r.b||0,a=r.l,c=r.d,p=r.m,$=r.n,y=n*8;do{if(!a){u=ye(t,i,1);var k=ye(t,i+1,3);if(i+=3,k)if(k==1)a=_o,c=wo,p=9,$=5;else if(k==2){var x=ye(t,i,31)+257,C=ye(t,i+10,15)+4,A=x+ye(t,i+5,31)+1;i+=14;for(var F=new he(A),M=new he(19),P=0;P<C;++P)M[$o[P]]=ye(t,i+P*3,7);i+=C*3;for(var N=jt(M),I=(1<<N)-1,j=vt(M,N,1),P=0;P<A;){var ee=j[ye(t,i,I)];i+=ee&15;var S=ee>>>4;if(S<16)F[P++]=S;else{var R=0,pe=0;for(S==16?(pe=3+ye(t,i,3),i+=2,R=F[P-1]):S==17?(pe=3+ye(t,i,7),i+=3):S==18&&(pe=11+ye(t,i,127),i+=7);pe--;)F[P++]=R}}var be=F.subarray(0,x),oe=F.subarray(x);p=jt(be),$=jt(oe),a=vt(be,p,1),c=vt(oe,$,1)}else Ce(1);else{var S=bo(i)+4,L=t[S-4]|t[S-3]<<8,E=S+L;if(E>n){s&&Ce(0);break}o&&l(f+L),e.set(t.subarray(S,E),f),r.b=f+=L,r.p=i=E*8,r.f=u;continue}if(i>y){s&&Ce(0);break}}o&&l(f+131072);for(var Ze=(1<<p)-1,$e=(1<<$)-1,gt=i;;gt=i){var R=a[Rt(t,i)&Ze],je=R>>>4;if(i+=R&15,i>y){s&&Ce(0);break}if(R||Ce(2),je<256)e[f++]=je;else if(je==256){gt=i,a=null;break}else{var it=je-254;if(je>264){var P=je-257,ve=pn[P];it=ye(t,i,(1<<ve)-1)+dn[P],i+=ve}var lt=c[Rt(t,i)&$e],Me=lt>>>4;lt||Ce(3),i+=lt&15;var oe=go[Me];if(Me>3){var ve=$n[Me];oe+=Rt(t,i)&(1<<ve)-1,i+=ve}if(i>y){s&&Ce(0);break}o&&l(f+131072);for(var at=f+it;f<at;f+=4)e[f]=e[f-oe],e[f+1]=e[f+1-oe],e[f+2]=e[f+2-oe],e[f+3]=e[f+3-oe];f=at}}r.l=a,r.p=gt,r.b=f,r.f=u,a&&(u=1,r.m=p,r.d=c,r.n=$)}while(!u);return f==e.length?e:ar(e,0,f)},ko=new he(0),Ne=function(t,e){return t[e]|t[e+1]<<8},Le=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Ut=function(t,e){return Le(t,e)+Le(t,e+4)*4294967296};function So(t,e){return yo(t,e)}var Xt=typeof TextDecoder<"u"&&new TextDecoder,Co=0;try{Xt.decode(ko,{stream:!0}),Co=1}catch{}var Lo=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,ar(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function _n(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Xt)return Xt.decode(t);var o=Lo(t),s=o[0],l=o[1];return l.length&&Ce(8),s}}var Oo=function(t,e){return e+30+Ne(t,e+26)+Ne(t,e+28)},To=function(t,e,r){var n=Ne(t,e+28),o=_n(t.subarray(e+46,e+46+n),!(Ne(t,e+8)&2048)),s=e+46+n,l=Le(t,e+20),u=r&&l==4294967295?Ao(t,s):[l,Le(t,e+24),Le(t,e+42)],i=u[0],f=u[1],a=u[2];return[Ne(t,e+10),i,f,o,s+Ne(t,e+30)+Ne(t,e+32),a]},Ao=function(t,e){for(;Ne(t,e)!=1;e+=4+Ne(t,e+2));return[Ut(t,e+12),Ut(t,e+4),Ut(t,e+20)]};function Do(t,e){for(var r={},n=t.length-22;Le(t,n)!=101010256;--n)(!n||t.length-n>65558)&&Ce(13);var o=Ne(t,n+8);if(!o)return{};var s=Le(t,n+16),l=s==4294967295||o==65535;if(l){var u=Le(t,n-12);l=Le(t,u)==101075792,l&&(o=Le(t,u+32),s=Le(t,u+48))}for(var i=e&&e.filter,f=0;f<o;++f){var a=To(t,s,l),c=a[0],p=a[1],$=a[2],y=a[3],k=a[4],S=a[5],L=Oo(t,S);s=k,(!i||i({name:y,size:p,originalSize:$,compression:c}))&&(c?c==8?r[y]=So(t.subarray(L,L+p),new he($)):Ce(14,"unknown compression type "+c):r[y]=ar(t,L,L+p))}return r}function Eo(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Ht):Ht(t)}function Ht(t){var e=new Uint8Array(t),r=Do(e);return Promise.resolve(Po(r))}function Po(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=_n(t[o])}return e}function Ie(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&st(n)===e)return n;r++}}function Ot(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&st(o)===e&&r.push(o),n++}return r}function It(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&st(o)===e&&r(o,n):r(o,n),n++}}function No(t,e,r){var n=[];return It(t,e,function(o,s){n.push(r(o,s))}),n}var Io=/.+\:/;function st(t){return t.tagName.replace(Io,"")}function wn(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+st(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=wn(t.childNodes[n]),n++;return e+="</"+st(t)+">",e}function Mo(t){var e=t.documentElement,r=Ie(e,"sheetData"),n=[];return It(r,"row",function(o){It(o,"c",function(s){n.push(s)})}),n}function xo(t,e){return Ie(e,"v")}function Fo(t,e){if(e.firstChild&&st(e.firstChild)==="is"&&e.firstChild.firstChild&&st(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function Bo(t){var e=t.documentElement,r=Ie(e,"dimension");if(r)return r.getAttribute("ref")}function jo(t){var e=t.documentElement,r=Ie(e,"cellStyleXfs");return r?Ot(r,"xf"):[]}function Ro(t){var e=t.documentElement,r=Ie(e,"cellXfs");return r?Ot(r,"xf"):[]}function Uo(t){var e=t.documentElement,r=Ie(e,"numFmts");return r?Ot(r,"numFmt"):[]}function Ho(t){var e=t.documentElement;return No(e,"si",function(r){var n=Ie(r,"t");if(n)return n.textContent;var o="";return It(r,"r",function(s){o+=Ie(s,"t").textContent}),o})}function Wo(t){var e=t.documentElement;return Ie(e,"workbookPr")}function zo(t){var e=t.documentElement;return Ot(e,"Relationship")}function Vo(t){var e=t.documentElement,r=Ie(e,"sheets");return Ot(r,"sheet")}function Go(t,e){var r=e.createDocument(t),n={},o=Wo(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(u){u.getAttribute("name")&&n.sheets.push({id:u.getAttribute("sheetId"),name:u.getAttribute("name"),relationId:u.getAttribute("r:id")})};return Vo(r).forEach(s),n}function Ko(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var u=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=Wt(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=Wt(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=Wt(u);break}};return zo(r).forEach(o),n}function Wt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function _r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function wr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_r(Object(r),!0).forEach(function(n){qo(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zo(t,e){if(!t)return{};var r=e.createDocument(t),n=jo(r).map(zt),o=Uo(r).map(Xo).reduce(function(l,u){return l[u.id]=u,l},[]),s=function(u){return u.hasAttribute("xfId")?wr(wr({},n[u.xfId]),zt(u,o)):zt(u,o)};return Ro(r).map(s)}function Xo(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function zt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function Yo(t,e){return t?Ho(e.createDocument(t)):[]}function bn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function Jo(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Qo(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qo(t,e){if(t){if(typeof t=="string")return br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(t,e)}}function br(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function es(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(ts.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&os(o.numberFormat.template))return!0}}var ts=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],rs=/^\[\$-414\]/,ns=/;@$/;function os(t){t=t.toLowerCase(),t=t.replace(rs,""),t=t.replace(ns,"");for(var e=t.split(/\W+/),r=Jo(e),n;!(n=r()).done;){var o=n.value;if(ss.indexOf(o)<0)return!1}return!0}var ss=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function is(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,u=r.values,i=r.properties,f=r.options;switch(e||(e="n"),e){case"str":t=Vt(t,f);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Vt(t,f);break;case"s":var a=Number(t);if(isNaN(a))throw new Error('Invalid "shared" string index: '.concat(t));if(a>=u.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=u[a],t=Vt(t,f);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=ls(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,es(t,s(),l,f)&&(t=bn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function ls(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Vt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var as=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function fs(t){var e=function(f,a){return f-a},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],u=n[n.length-1];return[{row:o,column:l},{row:s,column:u}]}function us(t){for(var e=0,r=0;r<t.length;)e*=26,e+=as.indexOf(t[r]),r++;return e}function vn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),us(t[0].trim())]}function cs(t,e,r,n,o,s,l){var u=vn(t.getAttribute("r")),i=xo(e,t),f=i&&i.textContent,a;return t.hasAttribute("t")&&(a=t.getAttribute("t")),{row:u[0],column:u[1],value:is(f,a,{getInlineStringValue:function(){return Fo(e,t)},getInlineStringXml:function(){return wn(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function ps(t,e,r,n,o,s){var l=Mo(t);return l.length===0?[]:l.map(function(u){return cs(u,t,e,r,n,o,s)})}function $s(t,e){return gs(t)||ds(t,e)||hs(t,e)||ms()}function ms(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hs(t,e){if(t){if(typeof t=="string")return vr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vr(t,e)}}function vr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ds(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function gs(t){if(Array.isArray(t))return t}function _s(t){var e=Bo(t);if(e)return e=e.split(":").map(vn).map(function(r){var n=$s(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function ws(t,e,r,n,o,s){var l=e.createDocument(t),u=ps(l,e,r,n,o,s),i=_s(l)||fs(u);return{cells:u,dimensions:i}}function bs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=vs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vs(t,e){if(t){if(typeof t=="string")return yr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(t,e)}}function yr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ys(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var u=!0,i=bs(t[l]),f;!(f=i()).done;){var a=f.value;if(o(a)!==null){u=!1;break}}if(u)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function ks(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ss(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ss(t,e){if(t){if(typeof t=="string")return kr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kr(t,e)}}function kr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Cs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,u=ks(t),i;!(i=u()).done;){var f=i.value;if(n(f[s])!==null){l=!1;break}}if(l)for(var a=0;a<t.length;)t[a].splice(s,1),a++;else if(o)break;s--}return t}function Ls(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=yn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Os(t,e){return Ds(t)||As(t,e)||yn(t,e)||Ts()}function Ts(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yn(t,e){if(t){if(typeof t=="string")return Sr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sr(t,e)}}function Sr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function As(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function Ds(t){if(Array.isArray(t))return t}function Es(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Os(r,2);o[0];for(var s=o[1],l=s.column,u=s.row,i=new Array(u),f=0;f<u;){i[f]=new Array(l);for(var a=0;a<l;)i[f][a]=null,a++;f++}for(var c=Ls(n),p;!(p=c()).done;){var $=p.value,y=$.row-1,k=$.column-1;k<l&&y<u&&(i[y][k]=$.value)}var S=e.rowMap;if(S)for(var L=0;L<i.length;)S[L]=L,L++;return i=ys(Cs(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:S}),e.transformData&&(i=e.transformData(i)),i}function Ps(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ns(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ns(t,e){if(t){if(typeof t=="string")return Cr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(t,e)}}function Cr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Lr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Is(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lr(Object(r),!0).forEach(function(n){Ms(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ms(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=Is({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=Ko(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?Yo(n(o.sharedStrings),e):[],l=o.styles?Zo(n(o.styles),e):{},u=Go(n("xl/workbook.xml"),e);if(r.getSheets)return u.sheets.map(function(c){var p=c.name;return{name:p}});var i=Fs(r.sheet,u.sheets);if(!i||!o.sheets[i])throw Bs(r.sheet,u.sheets);var f=ws(n(o.sheets[i]),e,s,l,u,r),a=Es(f,r);return r.properties?{data:a,properties:u}:a}function Fs(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Ps(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function Bs(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function Yt(t){"@babel/helpers - typeof";return Yt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(t)}function Or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function js(t,e,r){return e&&Or(t.prototype,e),r&&Or(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Us(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kt(t,e)}function Hs(t){var e=kn();return function(){var n=St(t),o;if(e){var s=St(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Ws(this,o)}}function Ws(t,e){if(e&&(Yt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zs(t)}function zs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jt(t){var e=typeof Map=="function"?new Map:void 0;return Jt=function(n){if(n===null||!Vs(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Dt(n,arguments,St(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),kt(o,n)},Jt(t)}function Dt(t,e,r){return kn()?Dt=Reflect.construct:Dt=function(o,s,l){var u=[null];u.push.apply(u,s);var i=Function.bind.apply(o,u),f=new i;return l&&kt(f,l.prototype),f},Dt.apply(null,arguments)}function kn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vs(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function kt(t,e){return kt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},kt(t,e)}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},St(t)}var de=function(t){Us(r,t);var e=Hs(r);function r(n){var o;return Rs(this,r),o=e.call(this,"invalid"),o.reason=n,o}return js(r)}(Jt(Error));function Gs(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new de("not_a_number")}if(typeof t!="number")throw new de("not_a_number");if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");return t}function Ks(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");return String(t)}throw new de("not_a_string")}function qs(t){if(typeof t=="boolean")return t;throw new de("not_a_boolean")}function Zs(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new de("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new de("invalid_number");if(!isFinite(t))throw new de("out_of_bounds");var n=bn(t,r);if(isNaN(n.valueOf()))throw new de("out_of_bounds");return n}throw new de("not_a_date")}function Xs(t,e){return Qs(t)||Js(t,e)||Sn(t,e)||Ys()}function Ys(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Js(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,u;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function Qs(t){if(Array.isArray(t))return t}function Qt(t){"@babel/helpers - typeof";return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qt(t)}function ei(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Sn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sn(t,e){if(t){if(typeof t=="string")return Tr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tr(t,e)}}function Tr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ar(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ar(Object(r),!0).forEach(function(n){ti(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ti(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Er={isColumnOriented:!1};function ri(t,e,r){r?r=Dr(Dr({},Er),r):r=Er;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;ii(e),o&&(t=si(t));for(var u=t[0],i=[],f=[],a=1;a<t.length;a++){var c=Cn(e,t[a],a,u,f,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=ei(f),$;!($=p()).done;){var y=$.value;y.row=s[y.row-1]+1}return{rows:i,errors:f}}function Cn(t,e,r,n,o,s){for(var l={},u=!0,i=function(){var p=a[f],$=t[p],y=Qt($.type)==="object"&&!Array.isArray($.type),k=e[n.indexOf(p)];k===void 0&&(k=null);var S=void 0,L=void 0,E=void 0;if(y)S=Cn($.type,e,r,n,o,s);else if(k===null)S=null;else if(Array.isArray($.type)){var x=!1,C=oi(k).map(function(F){var M=Pr(F,$,s);return M.error&&(S=F,L=M.error,E=M.reason),M.value!==null&&(x=!0),M.value});L||(S=x?C:null)}else{var A=Pr(k,$,s);L=A.error,E=A.reason,S=L?k:A.value}!L&&S===null&&$.required&&(L="required"),L?(L={error:L,row:r+1,column:p,value:S},E&&(L.reason=E),$.type&&(L.type=$.type),o.push(L)):(u&&S!==null&&(u=!1),(S!==null||s.includeNullValues)&&(l[$.prop]=S))},f=0,a=Object.keys(t);f<a.length;f++)i();return u?null:l}function Pr(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=pt(t,e.parse):e.type?n=ni(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function pt(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function ni(t,e,r){switch(e){case String:return pt(t,Ks);case Number:return pt(t,Gs);case Date:return pt(t,function(n){return Zs(n,{properties:r.properties})});case Boolean:return pt(t,qs);default:if(typeof e=="function")return pt(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Ln(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=Ln(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function oi(t){for(var e=[],r=0;r<t.length;){var n=Ln(t,",",r),o=Xs(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var si=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function ii(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function er(t){"@babel/helpers - typeof";return er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(t)}function On(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;er(s)==="object"&&(s=Object.keys(t[o])[0],l=On(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var li=["schema","map"];function Nr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function At(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Nr(Object(r),!0).forEach(function(n){ai(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ai(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fi(t,e){if(t==null)return{};var r=ui(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ui(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function ci(t,e,r){var n=r.schema,o=r.map,s=fi(r,li);!n&&o&&(n=On(o));var l=xs(t,e,At(At({},s),{},{properties:n||s.properties}));return n?ri(l.data,n,At(At({},s),{},{properties:l.properties})):l}function pi(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Eo(t).then(function(r){return ci(r,po,e)})}function $i(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function mi(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await pi(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=Hn(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const U={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Bt=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function hi(t){let e,r,n,o,s;function l(i){t[3](i)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(u.value=t[0]),e=new Nt({props:u}),H.push(()=>z(e,"value",l)),e.$on("change",t[2]),o=new Jn({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};!r&&f&1&&(r=!0,a.value=i[0],V(()=>r=!1)),e.$set(a);const c={};f&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function di(t,e,r){let n;X(t,re,i=>r(4,n=i));let o="interventionType",s=gr("v1");function l(){let i;o=="interventionType"?(i=un("v1"),r(1,s=gr("v1"))):(i=nn(["get","funding_programme"],{ATF2:U.atf2,ATF3:U.atf3,ATF4:U.atf4},"grey"),r(1,s=[["ATF2",U.atf2],["ATF3",U.atf3],["ATF4",U.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function u(i){o=i,r(0,o)}return[o,s,l,u]}class gi extends K{constructor(e){super(),q(this,e,di,hi,Z,{})}}function _i(t){let e;return{c(){e=v("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wi(t){let e,r,n,o,s,l;return n=new qt({props:{$$slots:{default:[_i]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=D("input"),r=O(),_(n.$$.fragment),G(e,"type","text"),G(e,"class","govuk-input govuk-input--width-10"),G(e,"id","filterText")},m(u,i){m(u,e,i),mr(e,t[0]),m(u,r,i),w(n,u,i),o=!0,s||(l=sr(e,"input",t[12]),s=!0)},p(u,i){i&1&&e.value!==u[0]&&mr(e,u[0]);const f={};i&131072&&(f.$$scope={dirty:i,ctx:u}),n.$set(f)},i(u){o||(d(n.$$.fragment,u),o=!0)},o(u){g(n.$$.fragment,u),o=!1},d(u){u&&(h(e),h(r)),b(n,u),s=!1,l()}}}function bi(t){let e,r,n,o,s,l,u,i,f,a;function c(k){t[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Nt({props:p}),H.push(()=>z(e,"value",c));function $(k){t[11](k)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(y.value=t[3]),o=new Nt({props:y}),H.push(()=>z(o,"value",$)),u=new on({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[wi]},$$scope:{ctx:t}}}),f=new gi({}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(k,S){w(e,k,S),m(k,n,S),w(o,k,S),m(k,l,S),w(u,k,S),m(k,i,S),w(f,k,S),a=!0},p(k,S){const L={};S&32&&(L.choices=k[5]),!r&&S&4&&(r=!0,L.value=k[2],V(()=>r=!1)),e.$set(L);const E={};S&64&&(E.choices=k[6]),!s&&S&8&&(s=!0,E.value=k[3],V(()=>s=!1)),o.$set(E);const x={};S&131073&&(x.$$scope={dirty:S,ctx:k}),u.$set(x)},i(k){a||(d(e.$$.fragment,k),d(o.$$.fragment,k),d(u.$$.fragment,k),d(f.$$.fragment,k),a=!0)},o(k){g(e.$$.fragment,k),g(o.$$.fragment,k),g(u.$$.fragment,k),g(f.$$.fragment,k),a=!1},d(k){k&&(h(n),h(l),h(i)),b(e,k),b(o,k),b(u,k),b(f,k)}}}function vi(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,u,i=t[7].area.toLocaleString()+"",f,a,c=t[7].crossing.toLocaleString()+"",p,$,y=t[7].other.toLocaleString()+"",k,S;return{c(){e=v("Showing "),n=v(r),o=v(" schemes ("),l=v(s),u=v(`
    routes, `),f=v(i),a=v(` areas,
    `),p=v(c),$=v(" crossings, "),k=v(y),S=v(`
    other)`)},m(L,E){m(L,e,E),m(L,n,E),m(L,o,E),m(L,l,E),m(L,u,E),m(L,f,E),m(L,a,E),m(L,p,E),m(L,$,E),m(L,k,E),m(L,S,E)},p(L,E){E&2&&r!==(r=L[1].size.toLocaleString()+"")&&Oe(n,r),E&128&&s!==(s=L[7].route.toLocaleString()+"")&&Oe(l,s),E&128&&i!==(i=L[7].area.toLocaleString()+"")&&Oe(f,i),E&128&&c!==(c=L[7].crossing.toLocaleString()+"")&&Oe(p,c),E&128&&y!==(y=L[7].other.toLocaleString()+"")&&Oe(k,y)},d(L){L&&(h(e),h(n),h(o),h(l),h(u),h(f),h(a),h(p),h($),h(k),h(S))}}}function yi(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[vi]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),H.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,u){w(e,l,u),n=!0},p(l,u){const i={};u&131202&&(i.$$scope={dirty:u,ctx:l}),!r&&u&16&&(r=!0,i.checked=l[4],V(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function ki(t){let e,r,n,o;return e=new Fe({props:{label:"Filters",$$slots:{default:[bi]},$$scope:{ctx:t}}}),n=new Ct({props:{small:!0,$$slots:{default:[yi]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},p(s,[l]){const u={};l&131181&&(u.$$scope={dirty:l,ctx:s}),e.$set(u);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Si(t,e,r){let n,o;X(t,ht,C=>r(15,n=C)),X(t,re,C=>r(9,o=C));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:u=""}=e,i=[],f="",a=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;xt(()=>{let C=new Set,A=new Set;for(let F of s.values())F.authority_or_region&&C.add(F.authority_or_region),F.funding_programme&&A.add(F.funding_programme);r(5,i=Array.from(C.entries())),i.sort(),r(6,a=Array.from(A.entries())),a.sort()});function y(C,A,F){let M=C.toLowerCase(),P=I=>{var j,ee;if(M&&!((j=I.properties.name)!=null&&j.toLowerCase().includes(M))&&!((ee=I.properties.description)!=null&&ee.toLowerCase().includes(M)))return!1;if(A||F){let R=s.get(I.properties.scheme_reference);if(A&&R.authority_or_region!=A||F&&R.funding_programme!=F)return!1}return!0};r(1,l=new Set(n.features.filter(P).map(I=>I.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let N=I=>{var j,ee;return!(!l.has(I.properties.scheme_reference)||M&&!((j=I.properties.name)!=null&&j.toLowerCase().includes(M))&&!((ee=I.properties.description)!=null&&ee.toLowerCase().includes(M)))};ht.update(I=>{for(let j of I.features)N(j)?(delete j.properties.hide_while_editing,r(7,p[j.properties.intervention_type]++,p)):j.properties.hide_while_editing=!0;return I}),r(7,p)}function k(C){f=C,r(2,f)}function S(C){c=C,r(3,c)}function L(){u=this.value,r(0,u)}const E=()=>r(0,u="");function x(C){$=C,r(4,$)}return t.$$set=C=>{"schemes"in C&&r(8,s=C.schemes),"schemesToBeShown"in C&&r(1,l=C.schemesToBeShown),"filterText"in C&&r(0,u=C.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let C of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(C)&&o.setLayoutProperty(C,"visibility",$?"visible":"none");t.$$.dirty&13&&y(u,f,c)},[u,l,f,c,$,i,a,p,s,o,k,S,L,E,x]}class Ci extends K{constructor(e){super(),q(this,e,Si,ki,Z,{schemes:8,schemesToBeShown:1,filterText:0})}}function Li(t){let e,r,n;return e=new we({props:{color:U.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=v(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Oi(t){let e;return{c(){e=v(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ti(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ai(t){let e,r,n,o,s,l,u,i,f,a,c;return s=new B({props:{href:"https://gtfs.org",$$slots:{default:[Oi]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ti]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=O(),n=D("p"),o=v("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),l=v(`, and doesn't include which routes are run or the
        frequency of service.`),u=O(),i=D("p"),f=v("License: "),_(a.$$.fragment)},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),T(n,o),w(s,n,null),T(n,l),m(p,u,$),m(p,i,$),T(i,f),w(a,i,null),c=!0},p(p,$){const y={};$&8&&(y.$$scope={dirty:$,ctx:p}),s.$set(y);const k={};$&8&&(k.$$scope={dirty:$,ctx:p}),a.$set(k)},i(p){c||(d(s.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(s.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(u),h(i)),b(s),b(a)}}}function Di(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ai]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ei(t){let e,r,n,o,s;function l(i){t[1](i)}let u={id:Xe,$$slots:{right:[Di],default:[Li]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:Xe,tooltip:Pi,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&8&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Xe="bus_routes";function Pi(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Ni(t,e,r){let n;X(t,re,l=>r(2,n=l)),ae(n,Xe,`${se()}/v1/${Xe}.pmtiles`),_e(n,{id:Xe,source:Xe,sourceLayer:Xe,color:["case",["boolean",["get","has_bus_lane"],!1],U.bus_route_with_lane,U.bus_route_without_lane],width:5,opacity:ce(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class Ii extends K{constructor(e){super(),q(this,e,Ni,Ei,Z,{})}}function Ir(t,e,r){const n=t.slice();return n[2]=e[r],n}function Mr(t,e,r){const n=t.slice();return n[5]=e[r],n}function xr(t){let e,r;return{c(){e=D("span"),r=v(` 
    `),Be(e,"background",t[5]),Be(e,"width","100%"),Be(e,"border","1px solid black")},m(n,o){m(n,e,o),T(e,r)},p(n,o){o&1&&Be(e,"background",n[5])},d(n){n&&h(e)}}}function Fr(t){let e,r=t[2]+"",n;return{c(){e=D("span"),n=v(r)},m(o,s){m(o,e,s),T(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&Oe(n,r)},d(o){o&&h(e)}}}function Mi(t){let e,r,n,o=Ve(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=xr(Mr(t,o,i));let l=Ve(t[1]),u=[];for(let i=0;i<l.length;i+=1)u[i]=Fr(Ir(t,l,i));return{c(){e=D("div");for(let i=0;i<s.length;i+=1)s[i].c();r=O(),n=D("div");for(let i=0;i<u.length;i+=1)u[i].c();Be(e,"display","flex"),Be(n,"display","flex"),Be(n,"justify-content","space-between")},m(i,f){m(i,e,f);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);m(i,r,f),m(i,n,f);for(let a=0;a<u.length;a+=1)u[a]&&u[a].m(n,null)},p(i,[f]){if(f&1){o=Ve(i[0]);let a;for(a=0;a<o.length;a+=1){const c=Mr(i,o,a);s[a]?s[a].p(c,f):(s[a]=xr(c),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=o.length}if(f&2){l=Ve(i[1]);let a;for(a=0;a<l.length;a+=1){const c=Ir(i,l,a);u[a]?u[a].p(c,f):(u[a]=Fr(c),u[a].c(),u[a].m(n,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=l.length}},i:Q,o:Q,d(i){i&&(h(e),h(r),h(n)),Pt(s,i),Pt(u,i)}}}function xi(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class qe extends K{constructor(e){super(),q(this,e,xi,Mi,Z,{colorScale:0,limits:1})}}function Fi(t){let e;return{c(){e=v("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bi(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ji(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ri(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ui(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Bi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[ji]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ri]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),l=v("."),u=O(),i=D("p"),f=v("License: "),_(a.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,y),m($,i,y),T(i,f),w(a,i,null),T(i,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&65536&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&65536&&(L.$$scope={dirty:y,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function Hi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ui]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Br(t){let e,r;return e=new qe({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Wi(t){let e;return{c(){e=v("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zi(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gi(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ki(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,y;return s=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[zi]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Vi]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Gi]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=O(),n=D("p"),o=v("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),l=v(". Output area boundaries from "),_(u.$$.fragment),i=v("."),f=O(),a=D("p"),c=v("License: "),_(p.$$.fragment),$=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(k,S){m(k,e,S),m(k,r,S),m(k,n,S),T(n,o),w(s,n,null),T(n,l),w(u,n,null),T(n,i),m(k,f,S),m(k,a,S),T(a,c),w(p,a,null),T(a,$),y=!0},p(k,S){const L={};S&65536&&(L.$$scope={dirty:S,ctx:k}),s.$set(L);const E={};S&65536&&(E.$$scope={dirty:S,ctx:k}),u.$set(E);const x={};S&65536&&(x.$$scope={dirty:S,ctx:k}),p.$set(x)},i(k){y||(d(s.$$.fragment,k),d(u.$$.fragment,k),d(p.$$.fragment,k),y=!0)},o(k){g(s.$$.fragment,k),g(u.$$.fragment,k),g(p.$$.fragment,k),y=!1},d(k){k&&(h(e),h(r),h(n),h(f),h(a)),b(s),b(u),b(p)}}}function qi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ki]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function jr(t){let e,r;return e=new qe({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Zi(t){let e;return{c(){e=v("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xi(t){let e;return{c(){e=v(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ji(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qi(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Xi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Yi]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ji]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),l=v("."),u=O(),i=D("p"),f=v("License: "),_(a.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,y),m($,i,y),T(i,f),w(a,i,null),T(i,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&65536&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&65536&&(L.$$scope={dirty:y,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function el(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Qi]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Rr(t){let e,r,n,o;return n=new qe({props:{colorScale:t[4],limits:t[7]().map(rl)}}),{c(){e=D("p"),e.textContent="(people per square kilometres)",r=O(),_(n.$$.fragment)},m(s,l){m(s,e,l),m(s,r,l),w(n,s,l),o=!0},p:Q,i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function tl(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,y;function k(P){t[9](P)}let S={id:"percent_households_with_car",$$slots:{right:[Hi],default:[Fi]},$$scope:{ctx:t}};t[0]!==void 0&&(S.checked=t[0]),e=new te({props:S}),H.push(()=>z(e,"checked",k)),e.$on("change",t[10]);let L=t[3]=="percent_households_with_car"&&Br(t);function E(P){t[11](P)}let x={id:"average_cars_per_household",$$slots:{right:[qi],default:[Wi]},$$scope:{ctx:t}};t[1]!==void 0&&(x.checked=t[1]),s=new te({props:x}),H.push(()=>z(s,"checked",E)),s.$on("change",t[12]);let C=t[3]=="average_cars_per_household"&&jr(t);function A(P){t[13](P)}let F={id:"population_density",$$slots:{right:[el],default:[Zi]},$$scope:{ctx:t}};t[2]!==void 0&&(F.checked=t[2]),f=new te({props:F}),H.push(()=>z(f,"checked",A)),f.$on("change",t[14]);let M=t[3]=="population_density"&&Rr(t);return $=new J({props:{layer:Te,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=O(),L&&L.c(),o=O(),_(s.$$.fragment),u=O(),C&&C.c(),i=O(),_(f.$$.fragment),c=O(),M&&M.c(),p=O(),_($.$$.fragment)},m(P,N){w(e,P,N),m(P,n,N),L&&L.m(P,N),m(P,o,N),w(s,P,N),m(P,u,N),C&&C.m(P,N),m(P,i,N),w(f,P,N),m(P,c,N),M&&M.m(P,N),m(P,p,N),w($,P,N),y=!0},p(P,[N]){const I={};N&65536&&(I.$$scope={dirty:N,ctx:P}),!r&&N&1&&(r=!0,I.checked=P[0],V(()=>r=!1)),e.$set(I),P[3]=="percent_households_with_car"?L?(L.p(P,N),N&8&&d(L,1)):(L=Br(P),L.c(),d(L,1),L.m(o.parentNode,o)):L&&(fe(),g(L,1,1,()=>{L=null}),ue());const j={};N&65536&&(j.$$scope={dirty:N,ctx:P}),!l&&N&2&&(l=!0,j.checked=P[1],V(()=>l=!1)),s.$set(j),P[3]=="average_cars_per_household"?C?(C.p(P,N),N&8&&d(C,1)):(C=jr(P),C.c(),d(C,1),C.m(i.parentNode,i)):C&&(fe(),g(C,1,1,()=>{C=null}),ue());const ee={};N&65536&&(ee.$$scope={dirty:N,ctx:P}),!a&&N&4&&(a=!0,ee.checked=P[2],V(()=>a=!1)),f.$set(ee),P[3]=="population_density"?M?(M.p(P,N),N&8&&d(M,1)):(M=Rr(P),M.c(),d(M,1),M.m(p.parentNode,p)):M&&(fe(),g(M,1,1,()=>{M=null}),ue());const R={};N&8&&(R.show=P[3]!=""),$.$set(R)},i(P){y||(d(e.$$.fragment,P),d(L),d(s.$$.fragment,P),d(C),d(f.$$.fragment,P),d(M),d($.$$.fragment,P),y=!0)},o(P){g(e.$$.fragment,P),g(L),g(s.$$.fragment,P),g(C),g(f.$$.fragment,P),g(M),g($.$$.fragment,P),y=!1},d(P){P&&(h(n),h(o),h(u),h(i),h(c),h(p)),b(e,P),L&&L.d(P),b(s,P),C&&C.d(P),b(f,P),M&&M.d(P),b($,P)}}}let Te="census_output_areas";const rl=t=>t.toLocaleString();function nl(t,e,r){let n;X(t,re,x=>r(8,n=x));let o=`${Te}-outline`,s=U.sequential_low_to_high,l=!1,u=!1,i=!1,f="";ae(n,Te,`${se()}/v1/${Te}.pmtiles`),Ke(n,{id:Te,source:Te,sourceLayer:Te,color:"black",opacity:ce(.5,.7)}),_e(n,{id:o,source:Te,sourceLayer:Te,color:"black",width:.5});function a(x){let C=x.properties.OA21CD,A=x.properties[f];return f=="percent_households_with_car"?`<p>${A}% of households in ${C} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${C} have an average of ${A} cars</p>`:`<p>There are ${A.toLocaleString()} people per square kilometre in ${C}</p>`}function c(x){let C=x.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${C}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${C}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(x){l=x,r(0,l)}const y=()=>{r(1,u=!1),r(2,i=!1)};function k(x){u=x,r(1,u)}const S=()=>{r(0,l=!1),r(2,i=!1)};function L(x){i=x,r(2,i)}const E=()=>{r(0,l=!1),r(1,u=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,f="percent_households_with_car"):u?r(3,f="average_cars_per_household"):i?r(3,f="population_density"):r(3,f=""),f?(n.setPaintProperty(Te,"fill-color",Ge(["get",f],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,u,i,f,s,a,c,p,n,$,y,k,S,L,E]}class ol extends K{constructor(e){super(),q(this,e,nl,tl,Z,{})}}function sl(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function il(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ll(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function al(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[il]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ll]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of December 2022."),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function fl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[al]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ul(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Ue,$$slots:{right:[fl],default:[sl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ue,tooltip:cl,show:t[0],clickable:!0}}),o.$on("click",pl),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ue="combined_authorities";function cl(t){return`<p>${t.properties.name}</p>`}function pl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function $l(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.combined_authorities,s=`${Ue}-outline`;ir(n,Ue,`${se()}/v1/${Ue}.geojson`),Ke(n,{id:Ue,source:Ue,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:Ue,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class ml extends K{constructor(e){super(),q(this,e,$l,ul,Z,{})}}function hl(t){let e,r,n;return{c(){e=D("input"),G(e,"class","govuk-file-upload"),G(e,"id","load-criticals"),G(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=sr(e,"change",t[4]),r=!0)},p:Q,d(o){o&&h(e),t[7](null),r=!1,n()}}}function Ur(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[gl]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function dl(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new we({props:{color:tr}}),{c(){_(e.$$.fragment),r=v(`
        Show `),o=v(n),s=v(" issues")},m(u,i){w(e,u,i),m(u,r,i),m(u,o,i),m(u,s,i),l=!0},p(u,i){(!l||i&4)&&n!==(n=u[2].toLocaleString()+"")&&Oe(o,n)},i(u){l||(d(e.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),l=!1},d(u){u&&(h(r),h(o),h(s)),b(e,u)}}}function gl(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[dl]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),H.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(l,u){w(e,l,u),n=!0},p(l,u){const i={};u&516&&(i.$$scope={dirty:u,ctx:l}),!r&&u&1&&(r=!0,i.checked=l[0],V(()=>r=!1)),e.$set(i)},i(l){n||(d(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){b(e,l)}}}function _l(t){let e,r,n,o,s,l;e=new on({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[hl]},$$scope:{ctx:t}}}),n=new ln({props:{errorMessage:t[3]}});let u=t[2]>0&&Ur(t);return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),u&&u.c(),s=Ft()},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),m(i,o,f),u&&u.m(i,f),m(i,s,f),l=!0},p(i,f){const a={};f&514&&(a.$$scope={dirty:f,ctx:i}),e.$set(a);const c={};f&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?u?(u.p(i,f),f&4&&d(u,1)):(u=Ur(i),u.c(),d(u,1),u.m(s.parentNode,s)):u&&(fe(),g(u,1,1,()=>{u=null}),ue())},i(i){l||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(u),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(u),l=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),u&&u.d(i)}}}function wl(t){let e,r,n,o,s,l;return e=new Fe({props:{label:"Critical Issues",$$slots:{default:[_l]},$$scope:{ctx:t}}}),n=new J({props:{layer:ie+"-points",tooltip:bl,show:t[0],clickable:!1}}),s=new J({props:{layer:ie+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[ie+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment)},m(u,i){w(e,u,i),m(u,r,i),w(n,u,i),m(u,o,i),w(s,u,i),l=!0},p(u,[i]){const f={};i&527&&(f.$$scope={dirty:i,ctx:u}),e.$set(f);const a={};i&1&&(a.show=u[0]),n.$set(a);const c={};i&1&&(c.show=u[0]),s.$set(c)},i(u){l||(d(e.$$.fragment,u),d(n.$$.fragment,u),d(s.$$.fragment,u),l=!0)},o(u){g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),l=!1},d(u){u&&(h(r),h(o)),b(e,u),b(n,u),b(s,u)}}}let ie="criticals",tr="red";function bl(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function vl(t,e,r){let n;X(t,re,p=>r(6,n=p));let o,s=!0,l=0,u="";Wn(n,ie),n.addSource(ie,{type:"geojson",data:sn(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),dt(n,{id:`${ie}-clusters`,source:ie,filter:["has","point_count"],color:tr,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${ie}-counts`,source:ie,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),dt(n,{id:`${ie}-points`,source:ie,filter:["!",["has","point_count"]],color:tr,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await mi(o.files[0]);n.getSource(ie).setData($),r(2,l=$.features.length),r(3,u="")}catch($){r(3,u=`The file you loaded is broken: ${$}`)}}function f(p){n.getSource(ie).getClusterExpansionZoom(p.detail.properties.cluster_id,($,y)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:y})})}function a(p){H[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${ie}-counts`)&&n.setLayoutProperty(`${ie}-counts`,"visibility",s?"visible":"none")},[s,o,l,u,i,f,n,a,c]}class yl extends K{constructor(e){super(),q(this,e,vl,wl,Z,{})}}function kl(t){let e,r,n;return e=new we({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=v(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Sl(t){let e;return{c(){e=v("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cl(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ll(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[Sl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Cl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Ol(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ll]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Tl(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:He,$$slots:{right:[Ol],default:[kl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:He,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",Al),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&64&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const He="crossings";function Al(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function Dl(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=!1;function s(f){const a=f.properties.crossing;return`<p>${l.get(a)??`Crossing with unknown type (${a})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);ae(n,He,`${se()}/v1/${He}.pmtiles`);let u=U[He];dt(n,{id:He,source:He,sourceLayer:He,color:u,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(f){o=f,r(0,o)}return[o,s,u,i]}class El extends K{constructor(e){super(),q(this,e,Dl,Tl,Z,{})}}function Pl(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Nl(t){let e;return{c(){e=v("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Il(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ml(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Nl]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Il]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Cycle parking, according to "),_(n.$$.fragment),o=v(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function xl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ml]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Fl(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:Ye,$$slots:{right:[xl],default:[Pl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ye,tooltip:Bl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&16&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ye="cycle_parking";function Bl(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function jl(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=U.cycle_parking;ae(n,Ye,`${se()}/v1/${Ye}.pmtiles`),dt(n,{id:Ye,source:Ye,sourceLayer:Ye,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class Rl extends K{constructor(e){super(),q(this,e,jl,Fl,Z,{})}}function Hr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function Ul(t){let e;return{c(){e=v("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Hl(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Wl(t){let e,r,n,o,s,l,u,i,f,a;return f=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Hl]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=O(),n=D("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=O(),s=D("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=O(),u=D("p"),i=v("License: "),_(f.$$.fragment)},m(c,p){m(c,e,p),m(c,r,p),m(c,n,p),m(c,o,p),m(c,s,p),m(c,l,p),m(c,u,p),T(u,i),w(f,u,null),a=!0},p(c,p){const $={};p&256&&($.$$scope={dirty:p,ctx:c}),f.$set($)},i(c){a||(d(f.$$.fragment,c),a=!0)},o(c){g(f.$$.fragment,c),a=!1},d(c){c&&(h(e),h(r),h(n),h(o),h(s),h(l),h(u)),b(f)}}}function zl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Wl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Wr(t){let e,r,n=Ve(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=zr(Hr(t,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=Ft()},m(l,u){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,u);m(l,e,u),r=!0},p(l,u){if(u&2){n=Ve(l[1]);let i;for(i=0;i<n.length;i+=1){const f=Hr(l,n,i);o[i]?(o[i].p(f,u),d(o[i],1)):(o[i]=zr(f),o[i].c(),d(o[i],1),o[i].m(e.parentNode,e))}for(fe(),i=n.length;i<o.length;i+=1)s(i);ue()}},i(l){if(!r){for(let u=0;u<n.length;u+=1)d(o[u]);r=!0}},o(l){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)g(o[u]);r=!1},d(l){l&&h(e),Pt(o,l)}}}function zr(t){let e,r,n,o=t[4]+"",s,l,u;return r=new we({props:{color:t[5]}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),s=v(o),l=O()},m(i,f){m(i,e,f),w(r,e,null),T(e,n),T(e,s),T(e,l),u=!0},p:Q,i(i){u||(d(r.$$.fragment,i),u=!0)},o(i){g(r.$$.fragment,i),u=!1},d(i){i&&h(e),b(r)}}}function Vl(t){let e,r,n,o,s,l;function u(a){t[2](a)}let i={id:Je,$$slots:{right:[zl],default:[Ul]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&Wr(t);return s=new J({props:{layer:Je,tooltip:Gl,show:t[0],clickable:!0}}),s.$on("click",Kl),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],V(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Wr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let Je="cycle_paths";function Gl(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Kl(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function ql(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=[["Separated tracks",U.cycle_paths.track],["Unprotected lanes",U.cycle_paths.lane],["Shared-use (segregated)",U.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",U.cycle_paths.shared_use_unsegregated]];ae(n,Je,`${se()}/v1/${Je}.pmtiles`),_e(n,{id:Je,source:Je,sourceLayer:Je,color:nn(["get","kind"],{track:U.cycle_paths.track,lane:U.cycle_paths.lane,shared_use_segregated:U.cycle_paths.shared_use_segregated,shared_use_unsegregated:U.cycle_paths.shared_use_unsegregated},"red"),width:Bt,opacity:ce(.5,1)});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class Zl extends K{constructor(e){super(),q(this,e,ql,Vl,Z,{})}}function Xl(t){let e,r,n,o;return e=new we({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=O(),n=v(t[1])},m(s,l){w(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&Oe(n,s[1])},i(s){o||(d(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function Yl(t){let e;const r=t[6].default,n=zn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&Vn(n,r,o,o[8],e?Kn(r,o[8],s,null):Gn(o[8]),null)},i(o){e||(d(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Jl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Yl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ql(t){let e,r,n,o,s;function l(i){t[7](i)}let u={id:t[0],$$slots:{right:[Jl],default:[Xl]},$$scope:{ctx:t}};return t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&1&&(a.id=i[0]),f&258&&(a.$$scope={dirty:f,ctx:i}),!r&&f&4&&(r=!0,a.checked=i[2],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.layer=i[0]),f&4&&(c.show=i[2]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function ea(t,e,r){let n;X(t,re,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:u}=e,{pluralNoun:i}=e,f=U[l];ae(n,l,`${se()}/v1/${l}.pmtiles`),Ke(n,{id:l,source:l,sourceLayer:l,color:f,opacity:ce(1,.7)});let a=!1;function c($){return`<p>${$.properties.name??`Unnamed ${u}`}</p>`}function p($){a=$,r(2,a)}return t.$$set=$=>{"name"in $&&r(0,l=$.name),"singularNoun"in $&&r(5,u=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[l,i,a,f,c,u,o,p,s]}class fr extends K{constructor(e){super(),q(this,e,ea,Ql,Z,{name:0,singularNoun:5,pluralNoun:1})}}function ta(t){let e;return{c(){e=v("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ra(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function na(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[ta]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ra]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function oa(t){let e,r;return e=new fr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[na]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class sa extends K{constructor(e){super(),q(this,e,null,oa,Z,{})}}function ia(t){let e;return{c(){e=v("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function la(t){let e;return{c(){e=v(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function aa(t){let e;return{c(){e=v(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fa(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ua(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[la]},$$scope:{ctx:t}}}),s=new B({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[aa]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[fa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("The 2019 English IMD scores come from "),_(n.$$.fragment),o=v(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),l=v("."),u=O(),i=D("p"),f=v("License: "),_(a.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m($,u,y),m($,i,y),T(i,f),w(a,i,null),T(i,c),p=!0},p($,y){const k={};y&64&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&64&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&64&&(L.$$scope={dirty:y,ctx:$}),a.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function ca(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ua]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Vr(t){let e,r;return e=new qe({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function pa(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:Ae,$$slots:{right:[ca],default:[ia]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&Vr(t);return s=new J({props:{layer:Ae,tooltip:$a,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],V(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Vr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let Ae="imd";function $a(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function ma(t,e,r){let n;X(t,re,f=>r(2,n=f));let o=`${Ae}-outline`,s=U.sequential_low_to_high,l=[0,2,4,6,8,10];ae(n,Ae,`${se()}/v1/${Ae}.pmtiles`),Ke(n,{id:Ae,source:Ae,sourceLayer:Ae,color:Ge(["-",10,["get","decile"]],l,s),opacity:ce(.5,.7)}),_e(n,{id:o,source:Ae,sourceLayer:Ae,color:"black",width:.5});let u=!1;function i(f){u=f,r(0,u)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",u?"visible":"none")},[u,s,n,i]}class ha extends K{constructor(e){super(),q(this,e,ma,pa,Z,{})}}function da(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ga(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _a(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wa(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[ga]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[_a]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function ba(t){let e,r,n;return r=new ne({props:{$$slots:{default:[wa]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function va(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:We,$$slots:{right:[ba],default:[da]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:We,tooltip:ya,show:t[0],clickable:!0}}),o.$on("click",ka),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let We="local_authority_districts";function ya(t){return`<p>${t.properties.name}</p>`}function ka(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function Sa(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.local_authority_districts,s=`${We}-outline`;ir(n,We,`${se()}/v1/${We}.geojson`),Ke(n,{id:We,source:We,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:We,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class Ca extends K{constructor(e){super(),q(this,e,Sa,va,Z,{})}}function La(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Oa(t){let e;return{c(){e=v(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ta(t){let e;return{c(){e=v(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Aa(t){let e;return{c(){e=v(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Da(t){let e;return{c(){e=v("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ea(t){let e;return{c(){e=v(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pa(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Na(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,y,k,S,L,E,x,C,A,F,M,P,N;return n=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Oa]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Ta]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Aa]},$$scope:{ctx:t}}}),$=new B({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Da]},$$scope:{ctx:t}}}),E=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Ea]},$$scope:{ctx:t}}}),M=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Pa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("LPAs may be a "),_(n.$$.fragment),o=v(", "),_(s.$$.fragment),l=v("y, or "),_(u.$$.fragment),i=v("."),f=O(),a=D("p"),c=D("strong"),p=v(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),y=v(" to get more details."),k=O(),S=D("p"),L=v("Data from ONS Geography via "),_(E.$$.fragment),x=v(", as of November 2022."),C=O(),A=D("p"),F=v("License: "),_(M.$$.fragment),P=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(I,j){m(I,e,j),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),w(u,e,null),T(e,i),m(I,f,j),m(I,a,j),T(a,c),T(c,p),w($,c,null),T(c,y),m(I,k,j),m(I,S,j),T(S,L),w(E,S,null),T(S,x),m(I,C,j),m(I,A,j),T(A,F),w(M,A,null),T(A,P),N=!0},p(I,j){const ee={};j&32&&(ee.$$scope={dirty:j,ctx:I}),n.$set(ee);const R={};j&32&&(R.$$scope={dirty:j,ctx:I}),s.$set(R);const pe={};j&32&&(pe.$$scope={dirty:j,ctx:I}),u.$set(pe);const be={};j&32&&(be.$$scope={dirty:j,ctx:I}),$.$set(be);const oe={};j&32&&(oe.$$scope={dirty:j,ctx:I}),E.$set(oe);const Ze={};j&32&&(Ze.$$scope={dirty:j,ctx:I}),M.$set(Ze)},i(I){N||(d(n.$$.fragment,I),d(s.$$.fragment,I),d(u.$$.fragment,I),d($.$$.fragment,I),d(E.$$.fragment,I),d(M.$$.fragment,I),N=!0)},o(I){g(n.$$.fragment,I),g(s.$$.fragment,I),g(u.$$.fragment,I),g($.$$.fragment,I),g(E.$$.fragment,I),g(M.$$.fragment,I),N=!1},d(I){I&&(h(e),h(f),h(a),h(k),h(S),h(C),h(A)),b(n),b(s),b(u),b($),b(E),b(M)}}}function Ia(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Na]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ma(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:De,$$slots:{right:[Ia],default:[La]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:De,tooltip:xa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="local_planning_authorities";function xa(t){return`<p>${t.properties.name}</p>`}function Fa(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.local_planning_authorities,s=`${De}-outline`;ae(n,De,`${se()}/v1/${De}.pmtiles`),Ke(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:De,sourceLayer:De,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class Ba extends K{constructor(e){super(),q(this,e,Fa,Ma,Z,{})}}function ja(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ra(t){let e;return{c(){e=v(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ua(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ha(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Ra]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ua]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from the "),_(n.$$.fragment),o=v(", as of September 2021."),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Wa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ha]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function za(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:Qe,$$slots:{right:[Wa],default:[ja]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:Qe,tooltip:Va,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&16&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Qe="mrn";function Va(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Ga(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=U.mrn;ae(n,Qe,`${se()}/v1/${Qe}.pmtiles`),_e(n,{id:Qe,source:Qe,sourceLayer:Qe,color:o,width:7,opacity:ce(.5,1)});let s=!1;function l(u){s=u,r(0,s)}return[s,o,l]}class Ka extends K{constructor(e){super(),q(this,e,Ga,za,Z,{})}}function qa(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Za(t){let e;return{c(){e=v(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xa(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ya(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Za]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Xa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Ja(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ya]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Qa(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Ee,$$slots:{right:[Ja],default:[qa]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:Ee,tooltip:ef,show:t[0],clickable:!0}}),o.$on("click",tf),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="parliamentary_constituencies";function ef(t){return`<p>${t.properties.Name}</p>`}function tf(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function rf(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.parliamentary_constituencies,s=`${Ee}-outline`;ae(n,Ee,`${se()}/v1/${Ee}.pmtiles`),Ke(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class nf extends K{constructor(e){super(),q(this,e,rf,Qa,Z,{})}}function of(t){let e;return{c(){e=v("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function sf(t){let e;return{c(){e=v("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function lf(t){let e;return{c(){e=v("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function af(t){let e,r,n,o,s,l,u,i,f,a,c;return u=new B({props:{href:"https://www.pct.bike",$$slots:{default:[sf]},$$scope:{ctx:t}}}),f=new B({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[lf]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=O(),n=D("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=O(),s=D("p"),l=v("See "),_(u.$$.fragment),i=v(" and "),_(f.$$.fragment),a=v(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),T(s,l),w(u,s,null),T(s,i),w(f,s,null),T(s,a),c=!0},p(p,$){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),u.$set(y);const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),f.$set(k)},i(p){c||(d(u.$$.fragment,p),d(f.$$.fragment,p),c=!0)},o(p){g(u.$$.fragment,p),g(f.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(u),b(f)}}}function ff(t){let e,r,n;return r=new ne({props:{$$slots:{default:[af]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Gr(t){let e,r,n,o,s,l,u,i;e=new qe({props:{colorScale:t[3],limits:t[4]}});function f($){t[8]($)}let a={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(a.value=t[0]),n=new an({props:a}),H.push(()=>z(n,"value",f)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new Nt({props:p}),H.push(()=>z(l,"value",c)),l.$on("change",t[6]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),s=O(),_(l.$$.fragment)},m($,y){w(e,$,y),m($,r,y),w(n,$,y),m($,s,y),w(l,$,y),i=!0},p($,y){const k={};!o&&y&1&&(o=!0,k.value=$[0],V(()=>o=!1)),n.$set(k);const S={};!u&&y&2&&(u=!0,S.value=$[1],V(()=>u=!1)),l.$set(S)},i($){i||(d(e.$$.fragment,$),d(n.$$.fragment,$),d(l.$$.fragment,$),i=!0)},o($){g(e.$$.fragment,$),g(n.$$.fragment,$),g(l.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(l,$)}}}function uf(t){let e,r,n,o,s,l,u,i;function f(p){t[7](p)}let a={id:ot,$$slots:{right:[ff],default:[of]},$$scope:{ctx:t}};t[2]!==void 0&&(a.checked=t[2]),e=new te({props:a}),H.push(()=>z(e,"checked",f));let c=t[2]&&Gr(t);return s=new J({props:{layer:ot,tooltip:t[5],show:t[2]&&t[0]==ot,clickable:!1}}),u=new J({props:{layer:Et,tooltip:t[5],show:t[2]&&t[0]==Et,clickable:!1}}),{c(){_(e.$$.fragment),n=O(),c&&c.c(),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(u,p,$),i=!0},p(p,[$]){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,y.checked=p[2],V(()=>r=!1)),e.$set(y),p[2]?c?(c.p(p,$),$&4&&d(c,1)):(c=Gr(p),c.c(),d(c,1),c.m(o.parentNode,o)):c&&(fe(),g(c,1,1,()=>{c=null}),ue());const k={};$&5&&(k.show=p[2]&&p[0]==ot),s.$set(k);const S={};$&5&&(S.show=p[2]&&p[0]==Et),u.$set(S)},i(p){i||(d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(u.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(u.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(l)),b(e,p),c&&c.d(p),b(s,p),b(u,p)}}}let ot="pct_commute",Et="pct_school";function cf(t,e,r){let n;X(t,re,y=>r(10,n=y));let o=U.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=ot,u="baseline";for(let y of[ot,Et])ae(n,y,`${se()}/v1/${y}.pmtiles`),_e(n,{id:y,source:y,sourceLayer:y,color:Ge(["get",u],s,o),width:Bt,opacity:ce(.5,1)});let i=!1;function f(y){let k=y.properties.baseline,S=y.properties.gov_target,L=y.properties.go_dutch,E=`<h2>Trip purpose: ${l==ot?"commuting":"school"}</h2>`;if(E+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)E+=`<p>Government target (2025): <b>${S.toLocaleString()}</b></p>`,E+=`<p>Go Dutch: <b>${L.toLocaleString()}</b></p>`;else{let x=(S/k).toFixed(1),C=(L/k).toFixed(1);E+=`<p>Government target (2025): ${S.toLocaleString()} (<b>${x}x</b> of baseline)</p>`,E+=`<p>Go Dutch: ${L.toLocaleString()} (<b>${C}x</b> of baseline)</p>`}return E}function a(){n.setPaintProperty(l,"line-color",Ge(["get",u],s,o))}function c(y){i=y,r(2,i)}function p(y){l=y,r(0,l)}function $(y){u=y,r(1,u)}return[l,u,i,o,s,f,a,c,p,$]}class pf extends K{constructor(e){super(),q(this,e,cf,uf,Z,{})}}function $f(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function mf(t){let e;return{c(){e=v("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function hf(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function df(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[mf]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[hf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function gf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[df]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function _f(t){let e,r,n,o,s;function l(i){t[2](i)}let u={id:et,$$slots:{right:[gf],default:[$f]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:et,tooltip:wf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const et="railway_stations";function wf(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function bf(t,e,r){let n;X(t,re,i=>r(3,n=i));const o=`${se()}/v1/${et}.geojson`;let s=!1;ir(n,et,o);let l=U[et];dt(n,{id:et,source:et,color:l,radius:ro/2});function u(i){s=i,r(0,s)}return[s,l,u]}class vf extends K{constructor(e){super(),q(this,e,bf,_f,Z,{})}}function yf(t){let e;return{c(){e=v("OS Speeds")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function kf(t){let e;return{c(){e=v("Basemap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Sf(t){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cf(t){let e,r,n,o,s,l,u,i,f,a,c,p;return n=new B({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[kf]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Sf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=v(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=O(),l=D("p"),l.textContent="Data valid as of 1 September, 2023",u=O(),i=D("p"),f=v(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(a.$$.fragment),c=v(".")},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),m($,s,y),m($,l,y),m($,u,y),m($,i,y),T(i,f),w(a,i,null),T(i,c),p=!0},p($,y){const k={};y&256&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&256&&(S.$$scope={dirty:y,ctx:$}),a.$set(S)},i($){p||(d(n.$$.fragment,$),d(a.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(s),h(l),h(u),h(i)),b(n),b(a)}}}function Lf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Cf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kr(t){let e,r,n,o,s;e=new qe({props:{colorScale:t[2],limits:t[3]}});function l(i){t[6](i)}let u={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(u.value=t[0]),n=new an({props:u}),H.push(()=>z(n,"value",l)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),s=!0},p(i,f){const a={};!o&&f&1&&(o=!0,a.value=i[0],V(()=>o=!1)),n.$set(a)},i(i){s||(d(e.$$.fragment,i),d(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(e,i),b(n,i)}}}function Of(t){let e,r,n,o,s,l;function u(a){t[5](a)}let i={id:ze,$$slots:{right:[Lf],default:[yf]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[1]&&Kr(t);return s=new J({props:{layer:ze,tooltip:Tf,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:a}),!r&&c&2&&(r=!0,p.checked=a[1],V(()=>r=!1)),e.$set(p),a[1]?f?(f.p(a,c),c&2&&d(f,1)):(f=Kr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&2&&($.show=a[1]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let ze="road_speeds";function Tf(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function Af(t,e,r){let n;X(t,re,c=>r(7,n=c));let o=U.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";ae(n,ze,`${lr()}/v1/${ze}.pmtiles`),_e(n,{id:ze,source:ze,sourceLayer:ze,color:Ge(["get",l],s,o),width:Bt,opacity:ce(.5,1)});let u=!1;function i(){n.setPaintProperty(ze,"line-color",Ge(["get",l],s,o))}function f(c){u=c,r(1,u)}function a(c){l=c,r(0,l)}return[l,u,o,s,i,f,a]}class Df extends K{constructor(e){super(),q(this,e,Af,Of,Z,{})}}function Ef(t){let e;return{c(){e=v("OS Road widths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pf(t){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Nf(t){let e,r,n,o,s,l,u,i,f;return u=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Pf]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=O(),n=D("p"),n.textContent="Data valid as of 1 September, 2023",o=O(),s=D("p"),l=v(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),i=v(".")},m(a,c){m(a,e,c),m(a,r,c),m(a,n,c),m(a,o,c),m(a,s,c),T(s,l),w(u,s,null),T(s,i),f=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),u.$set(p)},i(a){f||(d(u.$$.fragment,a),f=!0)},o(a){g(u.$$.fragment,a),f=!1},d(a){a&&(h(e),h(r),h(n),h(o),h(s)),b(u)}}}function If(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Nf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function qr(t){let e,r;return e=new qe({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Mf(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:tt,$$slots:{right:[If],default:[Ef]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&qr(t);return s=new J({props:{layer:tt,tooltip:xf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],V(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=qr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let tt="road_widths";function xf(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function Ff(t,e,r){let n;X(t,re,i=>r(4,n=i));let o=U.sequential_low_to_high,s=[0,5,10,15,20,100];ae(n,tt,`${lr()}/v1/${tt}.pmtiles`),_e(n,{id:tt,source:tt,sourceLayer:tt,color:Ge(["get","average"],s,o),width:Bt,opacity:ce(.5,1)});let l=!1;function u(i){l=i,r(0,l)}return[l,o,s,u]}class Bf extends K{constructor(e){super(),q(this,e,Ff,Mf,Z,{})}}function jf(t){let e;return{c(){e=v("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Rf(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Uf(t){let e,r,n,o,s,l,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[jf]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Rf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment)},m(a,c){m(a,e,c),T(e,r),w(n,e,null),T(e,o),m(a,s,c),m(a,l,c),T(l,u),w(i,l,null),f=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){f||(d(n.$$.fragment,a),d(i.$$.fragment,a),f=!0)},o(a){g(n.$$.fragment,a),g(i.$$.fragment,a),f=!1},d(a){a&&(h(e),h(s),h(l)),b(n),b(i)}}}function Hf(t){let e,r;return e=new fr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Uf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Wf extends K{constructor(e){super(),q(this,e,null,Hf,Z,{})}}function zf(t){let e;return{c(){e=v("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vf(t){let e;return{c(){e=v("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gf(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Kf(t){let e,r,n,o,s,l,u,i,f,a,c;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[zf]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Vf]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Gf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(" and "),_(s.$$.fragment),l=v(" data from OpenStreetMap (as of 9 August 2023)."),u=O(),i=D("p"),f=v("License: "),_(a.$$.fragment)},m(p,$){m(p,e,$),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m(p,u,$),m(p,i,$),T(i,f),w(a,i,null),c=!0},p(p,$){const y={};$&1&&(y.$$scope={dirty:$,ctx:p}),n.$set(y);const k={};$&1&&(k.$$scope={dirty:$,ctx:p}),s.$set(k);const S={};$&1&&(S.$$scope={dirty:$,ctx:p}),a.$set(S)},i(p){c||(d(n.$$.fragment,p),d(s.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(u),h(i)),b(n),b(s),b(a)}}}function qf(t){let e,r;return e=new fr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Kf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Zf extends K{constructor(e){super(),q(this,e,null,qf,Z,{})}}function Xf(t){let e;return{c(){e=v("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yf(t){let e;return{c(){e=v(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Jf(t){let e;return{c(){e=v("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qf(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function eu(t){let e,r,n,o,s,l,u,i,f,a,c,p,$;return n=new B({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[Yf]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[Jf]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Qf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=v(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),l=v(" for details and caveats about the measurements."),u=O(),i=D("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=O(),a=D("p"),c=v("License: "),_(p.$$.fragment)},m(y,k){m(y,e,k),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,l),m(y,u,k),m(y,i,k),m(y,f,k),m(y,a,k),T(a,c),w(p,a,null),$=!0},p(y,k){const S={};k&64&&(S.$$scope={dirty:k,ctx:y}),n.$set(S);const L={};k&64&&(L.$$scope={dirty:k,ctx:y}),s.$set(L);const E={};k&64&&(E.$$scope={dirty:k,ctx:y}),p.$set(E)},i(y){$||(d(n.$$.fragment,y),d(s.$$.fragment,y),d(p.$$.fragment,y),$=!0)},o(y){g(n.$$.fragment,y),g(s.$$.fragment,y),g(p.$$.fragment,y),$=!1},d(y){y&&(h(e),h(u),h(i),h(f),h(a)),b(n),b(s),b(p)}}}function tu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[eu]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Zr(t){let e,r;return e=new qe({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function ru(t){let e,r,n,o,s,l;function u(a){t[3](a)}let i={id:rt,$$slots:{right:[tu],default:[Xf]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&Zr(t);return s=new J({props:{layer:rt,tooltip:nu,show:t[0],clickable:!0}}),s.$on("click",ou),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(a,c){w(e,a,c),m(a,n,c),f&&f.m(a,c),m(a,o,c),w(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],V(()=>r=!1)),e.$set(p),a[0]?f?(f.p(a,c),c&1&&d(f,1)):(f=Zr(a),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(fe(),g(f,1,1,()=>{f=null}),ue());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(d(e.$$.fragment,a),d(f),d(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(f),g(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),b(e,a),f&&f.d(a),b(s,a)}}}let rt="vehicle_counts";function nu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function ou(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function su(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=U.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];ae(n,rt,`${se()}/v1/${rt}.pmtiles`),dt(n,{id:rt,source:rt,sourceLayer:rt,color:Ge(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let u=!1;function i(f){u=f,r(0,u)}return[u,o,l,i]}class iu extends K{constructor(e){super(),q(this,e,su,ru,Z,{})}}function lu(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function au(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fu(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function uu(t){let e,r,n,o,s,l,u,i,f,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[au]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[fu]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=O(),l=D("p"),u=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,l,p),T(l,u),w(i,l,null),T(l,f),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){a||(d(n.$$.fragment,c),d(i.$$.fragment,c),a=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),b(n),b(i)}}}function cu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[uu]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function pu(t){let e,r,n,o,s;function l(i){t[3](i)}let u={id:Pe,$$slots:{right:[cu],default:[lu]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",l)),o=new J({props:{layer:Pe,tooltip:$u,show:t[0],clickable:!0}}),o.$on("click",mu),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const a={};f&32&&(a.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,a.checked=i[0],V(()=>r=!1)),e.$set(a);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Pe="wards";function $u(t){return`<p>${t.properties.name}</p>`}function mu(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function hu(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.wards,s=`${Pe}-outline`;ae(n,Pe,`${se()}/v1/${Pe}.pmtiles`),Ke(n,{id:Pe,source:Pe,sourceLayer:Pe,color:o,opacity:ce(.5,0)}),_e(n,{id:s,source:Pe,sourceLayer:Pe,color:o,width:2.5});let l=!1;function u(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,u]}class du extends K{constructor(e){super(),q(this,e,hu,pu,Z,{})}}function gu(t){let e,r,n,o,s,l,u,i;return e=new Wf({}),n=new sa({}),s=new Zf({}),u=new vf({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment)},m(f,a){w(e,f,a),m(f,r,a),w(n,f,a),m(f,o,a),w(s,f,a),m(f,l,a),w(u,f,a),i=!0},i(f){i||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),d(u.$$.fragment,f),i=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),g(u.$$.fragment,f),i=!1},d(f){f&&(h(r),h(o),h(l)),b(e,f),b(n,f),b(s,f),b(u,f)}}}function _u(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[gu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function wu(t){let e,r,n,o,s,l,u,i,f,a;return e=new Zl({}),n=new Ka({}),s=new Ii({}),u=new Rl({}),f=new El({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(u,c,p),m(c,i,p),w(f,c,p),a=!0},i(c){a||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),a=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),a=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function bu(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[wu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function vu(t){let e,r,n,o,s,l,u,i,f,a;return e=new nf({}),n=new du({}),s=new ml({}),u=new Ca({}),f=new Ba({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,l,p),w(u,c,p),m(c,i,p),w(f,c,p),a=!0},i(c){a||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),a=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),a=!1},d(c){c&&(h(r),h(o),h(l),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function yu(t){let e,r;return e=new Ct({props:{small:!0,$$slots:{default:[vu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function ku(t){let e,r,n,o;return e=new ol({}),n=new ha({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Su(t){let e,r,n,o;return e=new Bf({}),n=new Df({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,l){w(e,s,l),m(s,r,l),w(n,s,l),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Cu(t){let e,r,n,o,s=or()=="Private (development)",l,u;e=new iu({}),n=new pf({});let i=s&&Su();return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),i&&i.c(),l=Ft()},m(f,a){w(e,f,a),m(f,r,a),w(n,f,a),m(f,o,a),i&&i.m(f,a),m(f,l,a),u=!0},p:Q,i(f){u||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(i),u=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(i),u=!1},d(f){f&&(h(r),h(o),h(l)),b(e,f),b(n,f),i&&i.d(f)}}}function Lu(t){let e,r,n,o,s,l,u,i,f,a,c,p,$,y,k,S,L;e=new yl({}),n=new Fe({props:{label:"Trip generators",$$slots:{default:[_u]},$$scope:{ctx:t}}}),s=new Fe({props:{label:"Existing infrastructure",$$slots:{default:[bu]},$$scope:{ctx:t}}}),u=new Fe({props:{label:"Boundaries",$$slots:{default:[yu]},$$scope:{ctx:t}}}),f=new Fe({props:{label:"Census",$$slots:{default:[ku]},$$scope:{ctx:t}}}),c=new Fe({props:{label:"Other",$$slots:{default:[Cu]},$$scope:{ctx:t}}});function E(C){t[5](C)}let x={displayEnableButton:!0};return t[2]!==void 0&&(x.isInactive=t[2]),$=new no({props:x}),t[4]($),H.push(()=>z($,"isInactive",E)),S=new Qn({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),a=O(),_(c.$$.fragment),p=O(),_($.$$.fragment),k=O(),_(S.$$.fragment)},m(C,A){w(e,C,A),m(C,r,A),w(n,C,A),m(C,o,A),w(s,C,A),m(C,l,A),w(u,C,A),m(C,i,A),w(f,C,A),m(C,a,A),w(c,C,A),m(C,p,A),w($,C,A),m(C,k,A),w(S,C,A),L=!0},p(C,A){const F={};A&64&&(F.$$scope={dirty:A,ctx:C}),n.$set(F);const M={};A&64&&(M.$$scope={dirty:A,ctx:C}),s.$set(M);const P={};A&64&&(P.$$scope={dirty:A,ctx:C}),u.$set(P);const N={};A&64&&(N.$$scope={dirty:A,ctx:C}),f.$set(N);const I={};A&64&&(I.$$scope={dirty:A,ctx:C}),c.$set(I);const j={};!y&&A&4&&(y=!0,j.isInactive=C[2],V(()=>y=!1)),$.$set(j);const ee={};A&1&&(ee.style=C[0]),S.$set(ee)},i(C){L||(d(e.$$.fragment,C),d(n.$$.fragment,C),d(s.$$.fragment,C),d(u.$$.fragment,C),d(f.$$.fragment,C),d(c.$$.fragment,C),d($.$$.fragment,C),d(S.$$.fragment,C),L=!0)},o(C){g(e.$$.fragment,C),g(n.$$.fragment,C),g(s.$$.fragment,C),g(u.$$.fragment,C),g(f.$$.fragment,C),g(c.$$.fragment,C),g($.$$.fragment,C),g(S.$$.fragment,C),L=!1},d(C){C&&(h(r),h(o),h(l),h(i),h(a),h(p),h(k)),b(e,C),b(n,C),b(s,C),b(u,C),b(f,C),b(c,C),t[4](null),b($,C),b(S,C)}}}function Ou(t){let e,r,n,o;return e=new Fe({props:{label:"Layers",open:!0,$$slots:{default:[Lu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,l){w(e,s,l),r=!0,n||(o=sr(window,"keydown",t[3]),n=!0)},p(s,[l]){const u={};l&71&&(u.$$scope={dirty:l,ctx:s}),e.$set(u)},i(s){r||(d(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function Tu(t,e,r){let n;X(t,hr,f=>r(2,n=f));let{style:o}=e,s;function l(f){!n&&f.key=="Escape"&&(s.disableStreetView(),f.preventDefault())}function u(f){H[f?"unshift":"push"](()=>{s=f,r(1,s)})}function i(f){n=f,hr.set(n)}return t.$$set=f=>{"style"in f&&r(0,o=f.style)},[o,s,n,l,u,i]}class Au extends K{constructor(e){super(),q(this,e,Tu,Ou,Z,{style:0})}}function Du(t,e,r){let{loadFile:n}=e;return xt(async()=>{let s=await(await fetch(`${lr()}/v1/random_schemes.geojson`)).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class Eu extends K{constructor(e){super(),q(this,e,Du,null,Z,{loadFile:0})}}function Pu(t){let e;return{c(){e=v("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Nu(t){let e;return{c(){e=v("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Iu(t){let e,r,n=t[0].authority_or_region+"",o,s,l,u,i=t[0].capital_scheme_id+"",f,a,c,p,$=t[0].funding_programme+"",y,k,S,L,E,x,C;return L=new qt({props:{$$slots:{default:[Pu]},$$scope:{ctx:t}}}),L.$on("click",t[3]),x=new qt({props:{disabled:t[1],title:t[2],$$slots:{default:[Nu]},$$scope:{ctx:t}}}),x.$on("click",t[4]),{c(){e=D("p"),r=v("Authority or region: "),o=v(n),s=O(),l=D("p"),u=v("Capital scheme ID: "),f=v(i),a=O(),c=D("p"),p=v("Funding programme: "),y=v($),k=O(),S=D("div"),_(L.$$.fragment),E=O(),_(x.$$.fragment),G(S,"class","govuk-button-group")},m(A,F){m(A,e,F),T(e,r),T(e,o),m(A,s,F),m(A,l,F),T(l,u),T(l,f),m(A,a,F),m(A,c,F),T(c,p),T(c,y),m(A,k,F),m(A,S,F),w(L,S,null),T(S,E),w(x,S,null),C=!0},p(A,F){(!C||F&1)&&n!==(n=A[0].authority_or_region+"")&&Oe(o,n),(!C||F&1)&&i!==(i=A[0].capital_scheme_id+"")&&Oe(f,i),(!C||F&1)&&$!==($=A[0].funding_programme+"")&&Oe(y,$);const M={};F&256&&(M.$$scope={dirty:F,ctx:A}),L.$set(M);const P={};F&256&&(P.$$scope={dirty:F,ctx:A}),x.$set(P)},i(A){C||(d(L.$$.fragment,A),d(x.$$.fragment,A),C=!0)},o(A){g(L.$$.fragment,A),g(x.$$.fragment,A),C=!1},d(A){A&&(h(e),h(s),h(l),h(a),h(c),h(k),h(S)),b(L),b(x)}}}function Mu(t){let e,r;return e=new Fe({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Iu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function xu(t,e,r){let n,o;X(t,ht,c=>r(6,n=c)),X(t,re,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,u=!l.has(s.authority_or_region),i=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(qn(c),{padding:20,animate:!1})}function a(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,u,i,f,a,l]}class Fu extends K{constructor(e){super(),q(this,e,xu,Mu,Z,{scheme:0,authorityNames:5})}}const Bu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var le=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{u(r.next(i))}catch(f){o(f)}},l=i=>{try{u(r.throw(i))}catch(f){o(f)}},u=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);u((r=r.apply(t,e)).next())}),ge=Uint8Array,$t=Uint16Array,ju=Int32Array,Tn=new ge([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),An=new ge([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ru=new ge([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Dn=function(t,e){for(var r=new $t(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new ju(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},En=Dn(Tn,2),Pn=En.b,Uu=En.r;Pn[28]=258,Uu[258]=28;var Hu=Dn(An,0),Wu=Hu.b,rr=new $t(32768);for(W=0;W<32768;++W)xe=(W&43690)>>1|(W&21845)<<1,xe=(xe&52428)>>2|(xe&13107)<<2,xe=(xe&61680)>>4|(xe&3855)<<4,rr[W]=((xe&65280)>>8|(xe&255)<<8)>>1;var xe,W,yt=function(t,e,r){for(var n=t.length,o=0,s=new $t(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new $t(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var u;if(r){u=new $t(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)u[rr[c]>>i]=f}else for(u=new $t(n),o=0;o<n;++o)t[o]&&(u[o]=rr[l[t[o]-1]++]>>15-t[o]);return u},Tt=new ge(288);for(W=0;W<144;++W)Tt[W]=8;var W;for(W=144;W<256;++W)Tt[W]=9;var W;for(W=256;W<280;++W)Tt[W]=7;var W;for(W=280;W<288;++W)Tt[W]=8;var W,Nn=new ge(32);for(W=0;W<32;++W)Nn[W]=5;var W,zu=yt(Tt,9,1),Vu=yt(Nn,5,1),Gt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ke=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Kt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Gu=function(t){return(t+7)/8|0},Ku=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new ge(r-e);return n.set(t.subarray(e,r)),n},qu=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],me=function(t,e,r){var n=new Error(e||qu[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,me),!r)throw n;return n},ur=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new ge(0);var l=!r||e.i!=2,u=e.i;r||(r=new ge(o*3));var i=function(cr){var pr=r.length;if(cr>pr){var $r=new ge(Math.max(pr*2,cr));$r.set(r),r=$r}},f=e.f||0,a=e.p||0,c=e.b||0,p=e.l,$=e.d,y=e.m,k=e.n,S=o*8;do{if(!p){f=ke(t,a,1);var L=ke(t,a+1,3);if(a+=3,L)if(L==1)p=zu,$=Vu,y=9,k=5;else if(L==2){var A=ke(t,a,31)+257,F=ke(t,a+10,15)+4,M=A+ke(t,a+5,31)+1;a+=14;for(var P=new ge(M),N=new ge(19),I=0;I<F;++I)N[Ru[I]]=ke(t,a+I*3,7);a+=F*3;for(var j=Gt(N),ee=(1<<j)-1,R=yt(N,j,1),I=0;I<M;){var pe=R[ke(t,a,ee)];a+=pe&15;var E=pe>>4;if(E<16)P[I++]=E;else{var be=0,oe=0;for(E==16?(oe=3+ke(t,a,3),a+=2,be=P[I-1]):E==17?(oe=3+ke(t,a,7),a+=3):E==18&&(oe=11+ke(t,a,127),a+=7);oe--;)P[I++]=be}}var Ze=P.subarray(0,A),$e=P.subarray(A);y=Gt(Ze),k=Gt($e),p=yt(Ze,y,1),$=yt($e,k,1)}else me(1);else{var E=Gu(a)+4,x=t[E-4]|t[E-3]<<8,C=E+x;if(C>o){u&&me(0);break}l&&i(c+x),r.set(t.subarray(E,C),c),e.b=c+=x,e.p=a=C*8,e.f=f;continue}if(a>S){u&&me(0);break}}l&&i(c+131072);for(var gt=(1<<y)-1,je=(1<<k)-1,it=a;;it=a){var be=p[Kt(t,a)&gt],ve=be>>4;if(a+=be&15,a>S){u&&me(0);break}if(be||me(2),ve<256)r[c++]=ve;else if(ve==256){it=a,p=null;break}else{var lt=ve-254;if(ve>264){var I=ve-257,Me=Tn[I];lt=ke(t,a,(1<<Me)-1)+Pn[I],a+=Me}var at=$[Kt(t,a)&je],ft=at>>4;at||me(3),a+=at&15;var $e=Wu[ft];if(ft>3){var Me=An[ft];$e+=Kt(t,a)&(1<<Me)-1,a+=Me}if(a>S){u&&me(0);break}l&&i(c+131072);var ut=c+lt;if(c<$e){var _t=s-$e,Un=Math.min($e,ut);for(_t+c<0&&me(3);c<Un;++c)r[c]=n[_t+c]}for(;c<ut;c+=4)r[c]=r[c-$e],r[c+1]=r[c+1-$e],r[c+2]=r[c+2-$e],r[c+3]=r[c+3-$e];c=ut}}e.l=p,e.p=it,e.b=c,e.f=f,p&&(f=1,e.m=y,e.d=$,e.n=k)}while(!f);return c==r.length?r:Ku(r,0,c)},Zu=new ge(0),Xu=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&me(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},Yu=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Ju=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&me(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&me(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Qu(t,e){return ur(t,{i:2},e&&e.out,e&&e.dictionary)}function ec(t,e){var r=Xu(t);return r+8>t.length&&me(6,"invalid gzip data"),ur(t.subarray(r,-8),{i:2},e&&e.out||new ge(Yu(t)),e&&e.dictionary)}function tc(t,e){return ur(t.subarray(Ju(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function nr(t,e){return t[0]==31&&t[1]==139&&t[2]==8?ec(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Qu(t,e):tc(t,e)}var rc=typeof TextDecoder<"u"&&new TextDecoder,nc=0;try{rc.decode(Zu,{stream:!0}),nc=1}catch{}var In=(t,e)=>t*Math.pow(2,e),wt=(t,e)=>Math.floor(t/Math.pow(2,e)),Mt=(t,e)=>In(t.getUint16(e+1,!0),8)+t.getUint8(e),Mn=(t,e)=>In(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),oc=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Mt(n,o+1);if(e!=s)return e-s;const l=Mt(n,o+4);return r!=l?r-l:0},sc=(t,e,r,n)=>{const o=xn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Xr=(t,e,r,n)=>{const o=xn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},xn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,u=oc(e,r,n,t,l*17);if(u>0)o=l+1;else if(u<0)s=l-1;else return[Mn(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},ic=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,Fn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Mt(t,e*17+1),y:Mt(t,e*17+4),offset:Mn(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Yr=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(Fn(r,n));return lc(e)},lc=t=>{t.sort(ic);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=wt(o.offset,8)&255,r[n*17+9]=wt(o.offset,16)&255,r[n*17+10]=wt(o.offset,24)&255,r[n*17+11]=wt(o.offset,32)&255,r[n*17+12]=wt(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},ac=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=Fn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),u=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:u}}return null};function fc(t){return le(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let u=0;l.compression==="gzip"&&(u=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let f=0;"maxzoom"in l&&(f=+l.maxzoom);let a=0,c=0,p=0,$=-180,y=-85,k=180,S=85;if(l.bounds){const E=l.bounds.split(",");$=+E[0],y=+E[1],k=+E[2],S=+E[3]}if(l.center){const E=l.center.split(",");a=+E[0],c=+E[1],p=+E[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:i,maxZoom:f,minLon:$,minLat:y,maxLon:k,maxLat:S,centerZoom:p,centerLon:a,centerLat:c,etag:e.etag}})}function uc(t,e,r,n,o,s,l){return le(this,null,function*(){let u=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(u=Yr(u));const i=Xr(new DataView(u),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=nr(new Uint8Array(c))),{data:c}}const f=ac(new DataView(u),{z:n,x:o,y:s});if(f){const a=sc(new DataView(u),f.z,f.x,f.y);if(a){let c=yield r.getArrayBuffer(e,a.offset,a.length,t);t.specVersion===1&&(c=Yr(c));const p=Xr(new DataView(c),n,o,s);if(p){let y=(yield e.getBytes(p.offset,p.length,l)).data;const k=new DataView(y);return k.getUint8(0)==31&&k.getUint8(1)==139&&(y=nr(new Uint8Array(y))),{data:y}}}}})}var Bn={getHeader:fc,getZxy:uc},cc=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Jr(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new Jr(o),this.tiles.set(o,s));const l=n[2],u=n[3],i=n[4],f=new AbortController,a=f.signal;let c=()=>{f.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+u,+i,a).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function ct(t,e){return(e>>>0)*4294967296+(t>>>0)}function pc(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return ct(t,n);throw new Error("Expected varint not more than 10 bytes")}function bt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,pc(r,t))}function $c(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var mc=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function hc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=mc[t],o=Math.pow(2,t);let s=0,l=0,u=0;const i=[e,r];let f=o/2;for(;f>0;)s=(i[0]&f)>0?1:0,l=(i[1]&f)>0?1:0,u+=f*f*(3*s^l),$c(f,i,s,l),f=f/2;return n+u}function jn(t,e){return le(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return nr(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var dc=127;function gc(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var _c=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return le(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const u=o.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+u.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function Se(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function wc(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:Se(r,8),rootDirectoryLength:Se(r,16),jsonMetadataOffset:Se(r,24),jsonMetadataLength:Se(r,32),leafDirectoryOffset:Se(r,40),leafDirectoryLength:Se(r,48),tileDataOffset:Se(r,56),tileDataLength:Se(r,64),numAddressedTiles:Se(r,72),numTileEntries:Se(r,80),numTileContents:Se(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function Rn(t){const e={buf:new Uint8Array(t),pos:0},r=bt(e),n=[];let o=0;for(let s=0;s<r;s++){const l=bt(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=bt(e);for(let s=0;s<r;s++)n[s].length=bt(e);for(let s=0;s<r;s++){const l=bt(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function bc(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var mt=class extends Error{};function vc(t,e,r,n){return le(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(bc(o.data)<3)return[yield Bn.getHeader(t)];const l=o.data.slice(0,dc);let u=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),u=void 0);const i=wc(l,u);if(r){const f=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),a=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=Rn(yield e(f,i.internalCompression));return[i,[a,c.length,c]]}return[i,void 0]})}function yc(t,e,r,n,o){return le(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new mt(s.etag);const l=yield e(s.data,o.internalCompression),u=Rn(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var kc=class{constructor(t=100,e=!0,r=jn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return le(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{vc(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return le(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,u)=>{yc(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return le(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,u)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new mt(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return le(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Jr=class{constructor(t,e,r){typeof t=="string"?this.source=new _c(t):this.source=t,r?this.decompress=r:this.decompress=jn,e?this.cache=e:this.cache=new kc}getHeader(){return le(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return le(this,null,function*(){const o=hc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Bn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,u=s.rootDirectoryLength;for(let i=0;i<=3;i++){const f=yield this.cache.getDirectory(this.source,l,u,s),a=gc(f,o);if(a)if(a.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+a.offset,a.length,n);if(s.etag&&s.etag!==c.etag)throw new mt(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+a.offset,u=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return le(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof mt)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return le(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new mt(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return le(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof mt)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Sc(t){return xt(()=>{let e=new cc;dr.addProtocol("pmtiles",e.tile)}),fn(()=>{dr.removeProtocol("pmtiles")}),[]}class Cc extends K{constructor(e){super(),q(this,e,Sc,null,Z,{})}}function Qr(t,e,r){const n=t.slice();return n[13]=e[r],n}function Lc(t){let e,r;return e=new Eu({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function en(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let u={schemes:t[1]};return t[2]!==void 0&&(u.schemesToBeShown=t[2]),t[3]!==void 0&&(u.filterText=t[3]),e=new Ci({props:u}),H.push(()=>z(e,"schemesToBeShown",s)),H.push(()=>z(e,"filterText",l)),{c(){_(e.$$.fragment)},m(i,f){w(e,i,f),o=!0},p(i,f){const a={};f&2&&(a.schemes=i[1]),!r&&f&4&&(r=!0,a.schemesToBeShown=i[2],V(()=>r=!1)),!n&&f&8&&(n=!0,a.filterText=i[3],V(()=>n=!1)),e.$set(a)},i(i){o||(d(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function tn(t){let e,r;return e=new Fu({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function rn(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&tn(t);return{c(){o&&o.c(),r=Ft()},m(s,l){o&&o.m(s,l),m(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&d(o,1)):(o=tn(s),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(fe(),g(o,1,1,()=>{o=null}),ue())},i(s){n||(d(o),n=!0)},o(s){g(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function Oc(t){let e,r,n,o,s,l,u,i,f,a,c=or()=="Private (development)",p,$,y,k,S,L,E,x;s=new eo({props:{boundaryGeojson:t[4]}}),u=new co({}),f=new Zn({});let C=c&&Lc(t);$=new io({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),k=new ln({props:{errorMessage:t[0]}});let A=t[1].size>0&&en(t),F=Ve(t[1].values()),M=[];for(let N=0;N<F.length;N+=1)M[N]=rn(Qr(t,F,N));const P=N=>g(M[N],1,1,()=>{M[N]=null});return{c(){e=D("div"),r=D("div"),n=D("h1"),n.textContent="Browse schemes",o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),a=O(),C&&C.c(),p=O(),_($.$$.fragment),y=O(),_(k.$$.fragment),S=O(),A&&A.c(),L=O(),E=D("ul");for(let N=0;N<M.length;N+=1)M[N].c();Be(r,"display","flex"),Be(r,"justify-content","space-between"),G(e,"slot","sidebar"),G(e,"class","govuk-prose")},m(N,I){m(N,e,I),T(e,r),T(r,n),T(r,o),w(s,r,null),T(e,l),w(u,e,null),T(e,i),w(f,e,null),T(e,a),C&&C.m(e,null),T(e,p),w($,e,null),T(e,y),w(k,e,null),T(e,S),A&&A.m(e,null),T(e,L),T(e,E);for(let j=0;j<M.length;j+=1)M[j]&&M[j].m(E,null);x=!0},p(N,I){const j={};I&16&&(j.boundaryGeojson=N[4]),s.$set(j),c&&C.p(N,I);const ee={};if(I&1&&(ee.errorMessage=N[0]),k.$set(ee),N[1].size>0?A?(A.p(N,I),I&2&&d(A,1)):(A=en(N),A.c(),d(A,1),A.m(e,L)):A&&(fe(),g(A,1,1,()=>{A=null}),ue()),I&38){F=Ve(N[1].values());let R;for(R=0;R<F.length;R+=1){const pe=Qr(N,F,R);M[R]?(M[R].p(pe,I),d(M[R],1)):(M[R]=rn(pe),M[R].c(),d(M[R],1),M[R].m(E,null))}for(fe(),R=F.length;R<M.length;R+=1)P(R);ue()}},i(N){if(!x){d(s.$$.fragment,N),d(u.$$.fragment,N),d(f.$$.fragment,N),d(C),d($.$$.fragment,N),d(k.$$.fragment,N),d(A);for(let I=0;I<F.length;I+=1)d(M[I]);x=!0}},o(N){g(s.$$.fragment,N),g(u.$$.fragment,N),g(f.$$.fragment,N),g(C),g($.$$.fragment,N),g(k.$$.fragment,N),g(A),M=M.filter(Boolean);for(let I=0;I<M.length;I+=1)g(M[I]);x=!1},d(N){N&&h(e),b(s),b(u),b(f),C&&C.d(),b($),b(k),A&&A.d(),Pt(M,N)}}}function Tc(t){let e,r,n,o,s,l,u,i,f,a,c;return e=new to({props:{colorInterventions:un("v1")}}),n=new J({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new J({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),u=new J({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),a=new Au({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),l=O(),_(u.$$.fragment),i=O(),f=D("div"),_(a.$$.fragment),G(f,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,l,$),w(u,p,$),m(p,i,$),m(p,f,$),w(a,f,null),c=!0},p:Q,i(p){c||(d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),d(a.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),g(a.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(l),h(i),h(f)),b(e,p),b(n,p),b(s,p),b(u,p),b(a)}}}function Ac(t){let e,r,n,o,s;return r=new Cc({}),o=new so({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Tc]},$$scope:{ctx:t}}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),_(o.$$.fragment),G(e,"slot","main")},m(l,u){m(l,e,u),w(r,e,null),T(e,n),w(o,e,null),s=!0},p(l,u){const i={};u&65536&&(i.$$scope={dirty:u,ctx:l}),o.$set(i)},i(l){s||(d(r.$$.fragment,l),d(o.$$.fragment,l),s=!0)},o(l){g(r.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&h(e),b(r),b(o)}}}function Dc(t){let e,r;return e=new oo({props:{$$slots:{main:[Ac],sidebar:[Oc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Ec(t,e,r){let n;X(t,ht,S=>r(4,n=S));let o=new Set(Bu);xt(()=>{Xn()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",u="",i=new Map,f=new Set,a="";fn(()=>{ht.set(sn())});function c(S){try{let L=JSON.parse(S);r(1,i=$i(L)),ht.set(L),r(0,u="")}catch(L){r(0,u=`The file you loaded is broken: ${L}`)}}function p(S){let L=S.properties;var E='<div style="max-width: 30vw;">';return E+=`<h2>${$(L.name)} (${L.intervention_type})</h2>`,E+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(E+=`<p>Length: ${Yn(L.length_meters)}</p>`),L.description&&(E+=`<p>${$(L.description)}</p>`),E+="</div>",E}function $(S){return a?S.replace(new RegExp(a,"gi"),L=>`<mark>${L}</mark>`):S}function y(S){f=S,r(2,f)}function k(S){a=S,r(3,a)}return[u,i,f,a,n,o,l,c,p,y,k]}class Pc extends K{constructor(e){super(),q(this,e,Ec,Dc,Z,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Pc({target:document.getElementById("app")});
