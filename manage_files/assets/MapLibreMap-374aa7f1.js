import{S as N,i as Q,s as U,e as _e,b as Y,c as E,n as ae,d as G,X as ue,aK as ct,aT as mt,aP as bt,L as Ce,M as Se,N as ve,O as we,t as k,p as S,b1 as Re,a4 as _t,b2 as Ze,Y as Me,y as ge,q as he,$ as He,v as P,Z as ke,_ as be,g as Ie,h as Be,j as ne,o as ie,r as Ee,u as le,P as oe,aM as se,b3 as kt,aL as Ke,aW as Ve,aa as At,a_ as Ct,aA as St,a as ye,b4 as vt,w as dt,b5 as wt,E as Mt,x as Lt,m as We,aQ as zt,aG as Ye,av as Ot}from"./index-31c14ddd.js";const Tt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function It(n){let e;return{c(){e=_e("div"),e.innerHTML=`<p class="govuk-phase-banner__content"><strong class="govuk-tag govuk-phase-banner__content__tag">Alpha</strong> <span class="govuk-phase-banner__text">This is a new service. Contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      with any feedback.</span></p>`,Y(e,"class","govuk-phase-banner")},m(t,o){E(t,e,o)},p:ae,i:ae,o:ae,d(t){t&&G(e)}}}class Uo extends N{constructor(e){super(),Q(this,e,null,It,U,{})}}const Ge=ue(""),De=ue(null);async function Bt(n){let e=ct(De);if(!n||!e)return"Google (attributions loading)";let[t,o]=e,l=n.getBounds(),i=`https://tile.googleapis.com/tile/v1/viewport?session=${o}&key=${t}&zoom=${Math.floor(n.getZoom())}&north=${l.getNorth()}&south=${l.getSouth()}&east=${l.getEast()}&west=${l.getWest()}`;return(await(await fetch(i)).json()).copyright}function jo(){let n=[];return mt()=="Private (development)"&&(n=n.concat([["google","Google satellite"],["Road","OS Road"],["Light","OS Light"],["Outdoor","OS Outdoor"],["bluesky","Bluesky Satellite (12.5cm)"]])),n.concat([["streets","MapTiler Streets"],["hybrid","MapTiler Satellite"],["dataviz","MapTiler Dataviz"],["uk-openzoomstack-light","OS Open Zoomstack"]])}async function qe(n){if(De.set(null),n=="streets"||n=="hybrid"||n=="dataviz"||n=="uk-openzoomstack-light")return Ge.set("&copy; MapTiler &copy; OpenStreetMap contributors"),`https://api.maptiler.com/maps/${n}/style.json?key=MZEJTanw3WpxRvt7qDfo`;let t=await(await fetch(`${bt()}/api_keys.json`)).json(),o,l;if(n=="google"){let i=t.google,r=await Et(i);o=`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${r}&key=${i}`,l="Google (attributions loading)",De.set([i,r])}else n=="bluesky"?(o=`https://ogc.apps.midgard.airbusds-cint.com/apgb/wmts/rest/apgb:AP-12CM5-GB-LATEST/default/EPSG-3857/EPSG:3857:{z}/{y}/{x}?GUID=${t.bluesky}&format=image/png&TRANSPARENT=FALSE,`,l="Bluesky"):(o=`https://api.os.uk/maps/raster/v1/zxy/${n}_3857/{z}/{x}/{y}.png?key=${t.ordnance_survey}`,l="Contains OS data &copy; Crown copyright and database rights 2023");return Ge.set(l),{version:8,sources:{"raster-tiles":{type:"raster",tiles:[o],tileSize:256,attribution:l}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:"https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=MZEJTanw3WpxRvt7qDfo"}}async function Et(n){try{let t=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${n}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in t?t.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(t)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}function Gt(n){let e,t;const o=n[2].default,l=Ce(o,n,n[1],null);return{c(){e=_e("a"),l&&l.c(),Y(e,"href",n[0]),Y(e,"target","_blank"),Y(e,"rel","noreferrer")},m(i,r){E(i,e,r),l&&l.m(e,null),t=!0},p(i,[r]){l&&l.p&&(!t||r&2)&&Se(l,o,i,i[1],t?we(o,i[1],r,null):ve(i[1]),null),(!t||r&1)&&Y(e,"href",i[0])},i(i){t||(k(l,i),t=!0)},o(i){S(l,i),t=!1},d(i){i&&G(e),l&&l.d(i)}}}function Pt(n,e,t){let{$$slots:o={},$$scope:l}=e,{href:i}=e;return n.$$set=r=>{"href"in r&&t(0,i=r.href),"$$scope"in r&&t(1,l=r.$$scope)},[i,l,o]}class No extends N{constructor(e){super(),Q(this,e,Pt,Gt,U,{href:0})}}var Pe=Ht;function Ht(n){var e,t,o;if(n){if(Array.isArray(n)){for(e=[],t=n.length,o=0;o<t;o++){var l=n[o];l!=null&&e.push(l)}return e}if(typeof n=="object"){e={};var i=Object.keys(n);for(t=i.length,o=0;o<t;o++){var r=i[o],f=n[r];f!=null&&(e[r]=f)}return e}}}var Te=Ue;function Ue(n,e){return n===e||n!==n&&e!==e?!0:typeof n!=typeof e||{}.toString.call(n)!={}.toString.call(e)||n!==Object(n)||!n?!1:Array.isArray(n)?Je(n,e):{}.toString.call(n)=="[object Set]"?Je(Array.from(n),Array.from(e)):{}.toString.call(n)=="[object Object]"?Zt(n,e):Ft(n,e)}function Ft(n,e){return n.toString()===e.toString()}function Je(n,e){var t=n.length;if(t!=e.length)return!1;for(var o=0;o<t;o++)if(!Ue(n[o],e[o]))return!1;return!0}function Zt(n,e){var t=Object.keys(n),o=t.length;if(o!=Object.keys(e).length)return!1;for(var l=0;l<o;l++){var i=t[l];if(!(e.hasOwnProperty(i)&&Ue(n[i],e[i])))return!1}return!0}let Dt=Date.now();function Fe(n){return`${n}-${Dt++}`}const je=Symbol.for("svelte-maplibre");function ze(){return _t(je)}function Rt(n){let e=new WeakMap;return t=>{var r;let o=e.get(t.originalEvent);if(o!==void 0)return o;let i=(r=t.target.queryRenderedFeatures(t.point).find(f=>{var s;return(s=n.get(f.layer.id))==null?void 0:s.interactive}))==null?void 0:r.layer.id;return e.set(t.originalEvent,i),i}}function Ut(){let n=new Map;return Re(je,{map:ue(null),source:Ze(null),layer:Ze(null),popupTarget:Ze(null),cluster:ue(),loadedImages:ue(new Set),minzoom:ue(0),maxzoom:ue(24),layerEvent:ue(null),layerInfo:n,eventTopMost:Rt(n)})}function Xe(n){return{subscribe:n.subscribe}}function Ne({key:n,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:o=!1}){let l=ze(),i=ue(null),r=Xe(i),f={...l,[n]:Xe(i)};if(e&&(f.popupTarget=r),o){let s=ue(null);f.layerEvent=s,l.layerEvent=s}return t&&(f.cluster=ue()),Re(je,f),{...l,self:i}}function jt(){return Ne({key:"source",setCluster:!0})}function Nt(n=!0){return Ne({key:"layer",setPopupTarget:n,setMouseEvent:n})}function Qo(){return Ne({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function Qt(n){return"layerType"in n&&n.layerType==="deckgl"}function xe(n){let e;return t=>{if(t)for(let o in t){let l=e==null?void 0:e[o],i=t[o];l!==i&&n(o,i,l)}else if(e)for(let o in e)n(o,void 0,e[o]);e=t}}function Kt(n,...e){let t=[n];for(let o of e)if(o)Array.isArray(o)&&o[0]===n?t.push(...o.slice(1)):t.push(o);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Vt(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function Ko(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}function pe(n){let e=n[0],t,o,l=$e(n);return{c(){l.c(),t=Me()},m(i,r){l.m(i,r),E(i,t,r),o=!0},p(i,r){r[0]&1&&U(e,e=i[0])?(ge(),S(l,1,1,ae),he(),l=$e(i),l.c(),k(l,1),l.m(t.parentNode,t)):l.p(i,r)},i(i){o||(k(l),o=!0)},o(i){S(l),o=!1},d(i){i&&G(t),l.d(i)}}}function $e(n){let e;const t=n[36].default,o=Ce(t,n,n[35],null);return{c(){o&&o.c()},m(l,i){o&&o.m(l,i),e=!0},p(l,i){o&&o.p&&(!e||i[1]&16)&&Se(o,t,l,l[35],e?we(t,l[35],i,null):ve(l[35]),null)},i(l){e||(k(o,l),e=!0)},o(l){S(o,l),e=!1},d(l){o&&o.d(l)}}}function Wt(n){let e,t,o=n[0]&&pe(n);return{c(){o&&o.c(),e=Me()},m(l,i){o&&o.m(l,i),E(l,e,i),t=!0},p(l,i){l[0]?o?(o.p(l,i),i[0]&1&&k(o,1)):(o=pe(l),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(l){t||(k(o),t=!0)},o(l){S(o),t=!1},d(l){l&&G(e),o&&o.d(l)}}}function Yt(n,e,t){let o,l,i,r,f,s,m,c,g,b,v,h,{$$slots:A={},$$scope:y}=e,{id:w=Fe("layer")}=e,{source:I=void 0}=e,{sourceLayer:T=void 0}=e,{beforeId:H=void 0}=e,{beforeLayerType:B=void 0}=e,{type:O}=e,{paint:L=void 0}=e,{layout:_=void 0}=e,{filter:z=void 0}=e,{applyToClusters:K=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:ce=void 0}=e,{manageHoverState:q=!1}=e,{hovered:p=null}=e,{interactive:$=!0}=e,{hoverCursor:J=void 0}=e,{eventsIfTopMost:C=!1}=e;const X=He(),{map:V,source:j,self:re,minzoom:F,maxzoom:Z,eventTopMost:x,layerInfo:W}=Nt();P(n,V,u=>t(31,g=u)),P(n,j,u=>t(32,b=u)),P(n,re,u=>t(0,c=u)),P(n,F,u=>t(34,h=u)),P(n,Z,u=>t(33,v=u)),ke(()=>{c&&g&&(W.delete(c),g==null||g.removeLayer(c))});let D;function ee(u){var de,Ae;if(!$||!c||!g||C&&x(u)!==c)return;let a=u.features??[],M=(Ae=(de=a[0])==null?void 0:de.properties)==null?void 0:Ae.cluster_id,R={event:u,map:g,clusterId:M,layer:c,source:f,features:a};X(u.type,R)}function me(u){var de,Ae;if(!$||!c||!g||C&&x(u)!==c)return;J&&(g.getCanvas().style.cursor=J);let a=u.features??[];t(6,p=a[0]??null);let M=(Ae=(de=a[0])==null?void 0:de.properties)==null?void 0:Ae.cluster_id;X("mouseenter",{event:u,map:g,clusterId:M,layer:c,source:f,features:a})}function Le(u){var de,Ae,Qe;if(!$||!g)return;if(C&&x(u)!==c){t(6,p=null),q&&D!==void 0&&(g==null||g.setFeatureState({source:f,sourceLayer:T,id:D},{hover:!1}),D=void 0);return}g.getCanvas().style.cursor=J;let a=u.features??[],M=(Ae=(de=a[0])==null?void 0:de.properties)==null?void 0:Ae.cluster_id,R=(Qe=a[0])==null?void 0:Qe.id;R!==D&&(q&&(D!==void 0&&(g==null||g.setFeatureState({source:f,id:D,sourceLayer:T},{hover:!1})),g==null||g.setFeatureState({source:f,id:R,sourceLayer:T},{hover:!0})),D=R,t(6,p=a[0]??null)),X("mousemove",{event:u,map:g,clusterId:M,layer:c,source:f,features:a})}function fe(u){if(!(!$||!c||!g)){if(J&&(g.getCanvas().style.cursor=""),t(6,p=null),q&&D!==void 0){const a={source:f,id:D,sourceLayer:T};g==null||g.setFeatureState(a,{hover:!1}),D=void 0}X("mouseleave",{map:g,layer:c,source:f})}}let te=!0;function Oe(u){g&&(g.off("click",u,ee),g.off("dblclick",u,ee),g.off("contextmenu",u,ee),g.off("mouseenter",u,me),g.off("mousemove",u,Le),g.off("mouseleave",u,fe))}return ke(()=>{g&&c&&Oe(c)}),n.$$set=u=>{"id"in u&&t(7,w=u.id),"source"in u&&t(8,I=u.source),"sourceLayer"in u&&t(9,T=u.sourceLayer),"beforeId"in u&&t(10,H=u.beforeId),"beforeLayerType"in u&&t(11,B=u.beforeLayerType),"type"in u&&t(12,O=u.type),"paint"in u&&t(13,L=u.paint),"layout"in u&&t(14,_=u.layout),"filter"in u&&t(15,z=u.filter),"applyToClusters"in u&&t(16,K=u.applyToClusters),"minzoom"in u&&t(17,d=u.minzoom),"maxzoom"in u&&t(18,ce=u.maxzoom),"manageHoverState"in u&&t(19,q=u.manageHoverState),"hovered"in u&&t(6,p=u.hovered),"interactive"in u&&t(20,$=u.interactive),"hoverCursor"in u&&t(21,J=u.hoverCursor),"eventsIfTopMost"in u&&t(22,C=u.eventsIfTopMost),"$$scope"in u&&t(35,y=u.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&65536&&t(30,o=Vt(K)),n.$$.dirty[0]&1073774592&&t(24,l=Kt("all",o,z)),n.$$.dirty[0]&131072|n.$$.dirty[1]&8&&t(26,i=d??h),n.$$.dirty[0]&262144|n.$$.dirty[1]&4&&t(25,r=ce??v),n.$$.dirty[0]&256|n.$$.dirty[1]&2&&t(29,f=I||b),n.$$.dirty[0]&654343809|n.$$.dirty[1]&1&&g&&c!==w&&f){c&&(Oe(c),W.delete(c));let u=H;if(!H&&B){let a=g.getStyle().layers,M=typeof B=="function"?B:de=>de.type===B,R=a==null?void 0:a.find(M);R&&(u=R.id)}be(re,c=w,c),g.addLayer(Pe({id:c,type:O,source:f,"source-layer":T,filter:l,paint:L,layout:_,minzoom:i,maxzoom:r}),u),t(23,te=!0),g.on("click",c,ee),g.on("dblclick",c,ee),g.on("contextmenu",c,ee),g.on("mouseenter",c,me),g.on("mousemove",c,Le),g.on("mouseleave",c,fe)}n.$$.dirty[0]&1048577&&c&&W.set(c,{interactive:$}),n.$$.dirty[0]&1|n.$$.dirty[1]&1&&t(28,s=c?xe((u,a)=>g==null?void 0:g.setPaintProperty(c,u,a)):void 0),n.$$.dirty[0]&1|n.$$.dirty[1]&1&&t(27,m=c?xe((u,a)=>g==null?void 0:g.setLayoutProperty(c,u,a)):void 0),n.$$.dirty[0]&268443648&&(s==null||s(L)),n.$$.dirty[0]&134234112&&(m==null||m(_)),n.$$.dirty[0]&100663297|n.$$.dirty[1]&1&&c&&(g==null||g.setLayerZoomRange(c,i,r)),n.$$.dirty[0]&25165825|n.$$.dirty[1]&1&&c&&(te?t(23,te=!1):g==null||g.setFilter(c,l))},[c,V,j,re,F,Z,p,w,I,T,H,B,O,L,_,z,K,d,ce,q,$,J,C,te,l,r,i,m,s,f,o,g,b,v,h,y,A]}class gt extends N{constructor(e){super(),Q(this,e,Yt,Wt,U,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function qt(n){let e;const t=n[15].default,o=Ce(t,n,n[23],null);return{c(){o&&o.c()},m(l,i){o&&o.m(l,i),e=!0},p(l,i){o&&o.p&&(!e||i&8388608)&&Se(o,t,l,l[23],e?we(t,l[23],i,null):ve(l[23]),null)},i(l){e||(k(o,l),e=!0)},o(l){S(o,l),e=!1},d(l){o&&o.d(l)}}}function Jt(n){let e,t,o;function l(r){n[16](r)}let i={id:n[1],type:"fill",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],interactive:n[14],$$slots:{default:[qt]},$$scope:{ctx:n}};return n[0]!==void 0&&(i.hovered=n[0]),e=new gt({props:i}),Ie.push(()=>Be(e,"hovered",l)),e.$on("click",n[17]),e.$on("dblclick",n[18]),e.$on("contextmenu",n[19]),e.$on("mouseenter",n[20]),e.$on("mousemove",n[21]),e.$on("mouseleave",n[22]),{c(){ne(e.$$.fragment)},m(r,f){ie(e,r,f),o=!0},p(r,[f]){const s={};f&2&&(s.id=r[1]),f&4&&(s.source=r[2]),f&8&&(s.sourceLayer=r[3]),f&16&&(s.beforeId=r[4]),f&32&&(s.beforeLayerType=r[5]),f&64&&(s.paint=r[6]),f&128&&(s.layout=r[7]),f&256&&(s.filter=r[8]),f&512&&(s.minzoom=r[9]),f&1024&&(s.maxzoom=r[10]),f&2048&&(s.hoverCursor=r[11]),f&4096&&(s.manageHoverState=r[12]),f&8192&&(s.eventsIfTopMost=r[13]),f&16384&&(s.interactive=r[14]),f&8388608&&(s.$$scope={dirty:f,ctx:r}),!t&&f&1&&(t=!0,s.hovered=r[0],Ee(()=>t=!1)),e.$set(s)},i(r){o||(k(e.$$.fragment,r),o=!0)},o(r){S(e.$$.fragment,r),o=!1},d(r){le(e,r)}}}function Xt(n,e,t){let{$$slots:o={},$$scope:l}=e,{id:i=Fe("fill")}=e,{source:r=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c}=e,{layout:g=void 0}=e,{filter:b=void 0}=e,{minzoom:v=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:y=!1}=e,{hovered:w=null}=e,{eventsIfTopMost:I=!1}=e,{interactive:T=!0}=e;function H(d){w=d,t(0,w)}function B(d){oe.call(this,n,d)}function O(d){oe.call(this,n,d)}function L(d){oe.call(this,n,d)}function _(d){oe.call(this,n,d)}function z(d){oe.call(this,n,d)}function K(d){oe.call(this,n,d)}return n.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,r=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,s=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,c=d.paint),"layout"in d&&t(7,g=d.layout),"filter"in d&&t(8,b=d.filter),"minzoom"in d&&t(9,v=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,y=d.manageHoverState),"hovered"in d&&t(0,w=d.hovered),"eventsIfTopMost"in d&&t(13,I=d.eventsIfTopMost),"interactive"in d&&t(14,T=d.interactive),"$$scope"in d&&t(23,l=d.$$scope)},[w,i,r,f,s,m,c,g,b,v,h,A,y,I,T,o,H,B,O,L,_,z,K,l]}class Vo extends N{constructor(e){super(),Q(this,e,Xt,Jt,U,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function xt(n,e,t){let o;const{map:l}=ze();P(n,l,s=>t(4,o=s));let{position:i="top-left"}=e,{container:r=void 0}=e,f=null;return ke(()=>{o!=null&&o.loaded()&&f&&o.removeControl(f)}),n.$$set=s=>{"position"in s&&t(1,i=s.position),"container"in s&&t(2,r=s.container)},n.$$.update=()=>{if(n.$$.dirty&30&&o&&!f){let s;typeof r=="string"?s=document.querySelector(r)??void 0:s=r,t(3,f=new se.FullscreenControl({container:s})),o.addControl(f,i)}},[l,i,r,f,o]}class pt extends N{constructor(e){super(),Q(this,e,xt,null,U,{position:1,container:2})}}function $t(n,e,t,o,l){let i=!1;n.getSource(e)&&(i=!0,n.removeSource(e));const r=()=>{o(e)&&(n.addSource(e,t),l())};if(i){const f=()=>{e&&(n.getSource(e)?setTimeout(f,1):r())};f()}else r()}function eo(n,e,t){kt().then(()=>{let o=ct(n);if(!o)return;o.getSource(e)===t&&o.removeSource(e)})}function et(n){let e=n[0],t,o,l=tt(n);return{c(){l.c(),t=Me()},m(i,r){l.m(i,r),E(i,t,r),o=!0},p(i,r){r&1&&U(e,e=i[0])?(ge(),S(l,1,1,ae),he(),l=tt(i),l.c(),k(l,1),l.m(t.parentNode,t)):l.p(i,r)},i(i){o||(k(l),o=!0)},o(i){S(l),o=!1},d(i){i&&G(t),l.d(i)}}}function tt(n){let e;const t=n[19].default,o=Ce(t,n,n[18],null);return{c(){o&&o.c()},m(l,i){o&&o.m(l,i),e=!0},p(l,i){o&&o.p&&(!e||i&262144)&&Se(o,t,l,l[18],e?we(t,l[18],i,null):ve(l[18]),null)},i(l){e||(k(o,l),e=!0)},o(l){S(o,l),e=!1},d(l){o&&o.d(l)}}}function to(n){let e,t,o=n[0]&&et(n);return{c(){o&&o.c(),e=Me()},m(l,i){o&&o.m(l,i),E(l,e,i),t=!0},p(l,[i]){l[0]?o?(o.p(l,i),i&1&&k(o,1)):(o=et(l),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(l){t||(k(o),t=!0)},o(l){S(o),t=!1},d(l){l&&G(e),o&&o.d(l)}}}function oo(n,e,t){let o,l,i,{$$slots:r={},$$scope:f}=e,{id:s=Fe("geojson")}=e,{data:m}=e,{generateId:c=!1}=e,{promoteId:g=void 0}=e,{filter:b=void 0}=e,{lineMetrics:v=void 0}=e,{cluster:h=void 0}=e,{maxzoom:A=void 0}=e,{attribution:y=void 0}=e,{buffer:w=void 0}=e,{tolerance:I=void 0}=e;const{map:T,cluster:H,self:B}=jt();P(n,T,_=>t(17,l=_)),P(n,H,_=>t(20,i=_)),P(n,B,_=>t(0,o=_));let O,L=!0;return ke(()=>{o&&O&&l&&(eo(T,o,O),be(B,o=null,o),t(15,O=void 0))}),n.$$set=_=>{"id"in _&&t(4,s=_.id),"data"in _&&t(5,m=_.data),"generateId"in _&&t(6,c=_.generateId),"promoteId"in _&&t(7,g=_.promoteId),"filter"in _&&t(8,b=_.filter),"lineMetrics"in _&&t(9,v=_.lineMetrics),"cluster"in _&&t(10,h=_.cluster),"maxzoom"in _&&t(11,A=_.maxzoom),"attribution"in _&&t(12,y=_.attribution),"buffer"in _&&t(13,w=_.buffer),"tolerance"in _&&t(14,I=_.tolerance),"$$scope"in _&&t(18,f=_.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&be(H,i=h,i),n.$$.dirty&196593&&l&&o!==s&&(be(B,o=s,o),$t(l,o,Pe({type:"geojson",data:m,filter:b,lineMetrics:v,generateId:c,promoteId:g,cluster:!!h,clusterMinPoints:h==null?void 0:h.minPoints,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius,clusterProperties:h==null?void 0:h.properties,maxzoom:A,attribution:y,buffer:w,tolerance:I}),_=>l&&_===o,()=>{o&&(t(15,O=l==null?void 0:l.getSource(o)),t(16,L=!0))})),n.$$.dirty&131088&&(l==null||l.on("style.load",()=>{t(15,O=l==null?void 0:l.getSource(s))})),n.$$.dirty&98336&&O&&(L?t(16,L=!1):O.setData(m)),n.$$.dirty&33792&&(O==null||O.setClusterOptions(Pe({cluster:!!h,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius})))},[o,T,H,B,s,m,c,g,b,v,h,A,y,w,I,O,L,l,f,r]}class Wo extends N{constructor(e){super(),Q(this,e,oo,to,U,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10,maxzoom:11,attribution:12,buffer:13,tolerance:14})}}function no(n,e,t){let o;const{map:l}=ze();P(n,l,b=>t(8,o=b));let{position:i="top-left"}=e,{positionOptions:r=void 0}=e,{fitBoundsOptions:f=void 0}=e,{trackUserLocation:s=!1}=e,{showAccuracyCircle:m=!0}=e,{showUserLocation:c=!0}=e,{control:g=null}=e;return ke(()=>{o!=null&&o.loaded()&&g&&o.removeControl(g)}),n.$$set=b=>{"position"in b&&t(2,i=b.position),"positionOptions"in b&&t(3,r=b.positionOptions),"fitBoundsOptions"in b&&t(4,f=b.fitBoundsOptions),"trackUserLocation"in b&&t(5,s=b.trackUserLocation),"showAccuracyCircle"in b&&t(6,m=b.showAccuracyCircle),"showUserLocation"in b&&t(7,c=b.showUserLocation),"control"in b&&t(1,g=b.control)},n.$$.update=()=>{n.$$.dirty&510&&o&&!g&&(t(1,g=new se.GeolocateControl({positionOptions:r,fitBoundsOptions:f,trackUserLocation:s,showAccuracyCircle:m,showUserLocation:c})),o.addControl(g,i))},[l,g,i,r,f,s,m,c,o]}class io extends N{constructor(e){super(),Q(this,e,no,null,U,{position:2,positionOptions:3,fitBoundsOptions:4,trackUserLocation:5,showAccuracyCircle:6,showUserLocation:7,control:1})}}function lo(n){let e;const t=n[15].default,o=Ce(t,n,n[23],null);return{c(){o&&o.c()},m(l,i){o&&o.m(l,i),e=!0},p(l,i){o&&o.p&&(!e||i&8388608)&&Se(o,t,l,l[23],e?we(t,l[23],i,null):ve(l[23]),null)},i(l){e||(k(o,l),e=!0)},o(l){S(o,l),e=!1},d(l){o&&o.d(l)}}}function ro(n){let e,t,o;function l(r){n[16](r)}let i={id:n[1],type:"line",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],interactive:n[14],$$slots:{default:[lo]},$$scope:{ctx:n}};return n[0]!==void 0&&(i.hovered=n[0]),e=new gt({props:i}),Ie.push(()=>Be(e,"hovered",l)),e.$on("click",n[17]),e.$on("dblclick",n[18]),e.$on("contextmenu",n[19]),e.$on("mouseenter",n[20]),e.$on("mousemove",n[21]),e.$on("mouseleave",n[22]),{c(){ne(e.$$.fragment)},m(r,f){ie(e,r,f),o=!0},p(r,[f]){const s={};f&2&&(s.id=r[1]),f&4&&(s.source=r[2]),f&8&&(s.sourceLayer=r[3]),f&16&&(s.beforeId=r[4]),f&32&&(s.beforeLayerType=r[5]),f&64&&(s.paint=r[6]),f&128&&(s.layout=r[7]),f&256&&(s.filter=r[8]),f&512&&(s.minzoom=r[9]),f&1024&&(s.maxzoom=r[10]),f&2048&&(s.hoverCursor=r[11]),f&4096&&(s.manageHoverState=r[12]),f&8192&&(s.eventsIfTopMost=r[13]),f&16384&&(s.interactive=r[14]),f&8388608&&(s.$$scope={dirty:f,ctx:r}),!t&&f&1&&(t=!0,s.hovered=r[0],Ee(()=>t=!1)),e.$set(s)},i(r){o||(k(e.$$.fragment,r),o=!0)},o(r){S(e.$$.fragment,r),o=!1},d(r){le(e,r)}}}function fo(n,e,t){let{$$slots:o={},$$scope:l}=e,{id:i=Fe("line")}=e,{source:r=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:c}=e,{layout:g=void 0}=e,{filter:b=void 0}=e,{minzoom:v=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:y=!1}=e,{hovered:w=null}=e,{eventsIfTopMost:I=!1}=e,{interactive:T=!0}=e;function H(d){w=d,t(0,w)}function B(d){oe.call(this,n,d)}function O(d){oe.call(this,n,d)}function L(d){oe.call(this,n,d)}function _(d){oe.call(this,n,d)}function z(d){oe.call(this,n,d)}function K(d){oe.call(this,n,d)}return n.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,r=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,s=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,c=d.paint),"layout"in d&&t(7,g=d.layout),"filter"in d&&t(8,b=d.filter),"minzoom"in d&&t(9,v=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,y=d.manageHoverState),"hovered"in d&&t(0,w=d.hovered),"eventsIfTopMost"in d&&t(13,I=d.eventsIfTopMost),"interactive"in d&&t(14,T=d.interactive),"$$scope"in d&&t(23,l=d.$$scope)},[w,i,r,f,s,m,c,g,b,v,h,A,y,I,T,o,H,B,O,L,_,z,K,l]}class Yo extends N{constructor(e){super(),Q(this,e,fo,ro,U,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function uo(n,e,t){let o;const l=He();let{layer:i=void 0}=e;const{map:r}=ze();P(n,r,c=>t(2,o=c));function f(c){l(c.type,{...c,map:r})}const s=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],m=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return ke(()=>{if(o)if(i)for(const c of s)o.off(c,i,f);else for(const c of m)o.off(c,f)}),n.$$set=c=>{"layer"in c&&t(1,i=c.layer)},n.$$.update=()=>{if(n.$$.dirty&6&&o)if(i)for(const c of s)o.on(c,i,f);else for(const c of m)o.on(c,f)},[r,i,o]}class so extends N{constructor(e){super(),Q(this,e,uo,null,U,{layer:1})}}function ao(n){let e=n.getCenter(),t=Math.round(n.getZoom()*100)/100,o=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),l=Math.pow(10,o),i=Math.round(e.lat*l)/l,r=Math.round(e.lng*l)/l,f=`${t}/${i}/${r}`,s=n.getBearing(),m=n.getPitch();return(s||m)&&(f+=`/${Math.round(s*10)/10}`),m&&(f+=`/${Math.round(m)}`),`#${f}`}function co(n){return n.replace("#","").split("/").map(parseFloat)}function mo(n,e,t){let o;const{map:l}=ze();P(n,l,c=>t(6,o=c));let{position:i="top-left"}=e,{showCompass:r=!0}=e,{showZoom:f=!0}=e,{visualizePitch:s=!1}=e,m=null;return ke(()=>{o!=null&&o.loaded()&&m&&o.removeControl(m)}),n.$$set=c=>{"position"in c&&t(1,i=c.position),"showCompass"in c&&t(2,r=c.showCompass),"showZoom"in c&&t(3,f=c.showZoom),"visualizePitch"in c&&t(4,s=c.visualizePitch)},n.$$.update=()=>{n.$$.dirty&126&&o&&!m&&(t(5,m=new se.NavigationControl({showCompass:r,showZoom:f,visualizePitch:s})),o.addControl(m,i))},[l,i,r,f,s,m,o]}class ht extends N{constructor(e){super(),Q(this,e,mo,null,U,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function go(n,e,t){let o;const{map:l}=ze();P(n,l,m=>t(5,o=m));let{position:i="bottom-left"}=e,{maxWidth:r=void 0}=e,{unit:f="metric"}=e,s=null;return ke(()=>{o!=null&&o.loaded()&&s&&o.removeControl(s)}),n.$$set=m=>{"position"in m&&t(1,i=m.position),"maxWidth"in m&&t(2,r=m.maxWidth),"unit"in m&&t(3,f=m.unit)},n.$$.update=()=>{n.$$.dirty&62&&o&&!s&&(t(4,s=new se.ScaleControl({maxWidth:r,unit:f})),o.addControl(s,i))},[l,i,r,f,s,o]}class yt extends N{constructor(e){super(),Q(this,e,go,null,U,{position:1,maxWidth:2,unit:3})}}const{window:ho}=Tt,yo=n=>({map:n[0]&16,loadedImages:n[0]&32,allImagesLoaded:n[0]&64}),ot=n=>({map:n[4],loadedImages:n[5],allImagesLoaded:n[6]});function nt(n){let e,t,o=n[3]&&it(n);const l=n[40].default,i=Ce(l,n,n[39],ot);return{c(){o&&o.c(),e=ye(),i&&i.c()},m(r,f){o&&o.m(r,f),E(r,e,f),i&&i.m(r,f),t=!0},p(r,f){r[3]?o?(o.p(r,f),f[0]&8&&k(o,1)):(o=it(r),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he()),i&&i.p&&(!t||f[0]&112|f[1]&256)&&Se(i,l,r,r[39],t?we(l,r[39],f,yo):ve(r[39]),ot)},i(r){t||(k(o),k(i,r),t=!0)},o(r){S(o),S(i,r),t=!1},d(r){r&&G(e),o&&o.d(r),i&&i.d(r)}}}function it(n){let e,t,o,l,i,r,f,s;return e=new ht({props:{position:n[7]}}),o=new io({props:{position:n[7],fitBoundsOptions:{maxZoom:12}}}),i=new pt({props:{position:n[7]}}),f=new yt({props:{position:n[7]}}),{c(){ne(e.$$.fragment),t=ye(),ne(o.$$.fragment),l=ye(),ne(i.$$.fragment),r=ye(),ne(f.$$.fragment)},m(m,c){ie(e,m,c),E(m,t,c),ie(o,m,c),E(m,l,c),ie(i,m,c),E(m,r,c),ie(f,m,c),s=!0},p(m,c){const g={};c[0]&128&&(g.position=m[7]),e.$set(g);const b={};c[0]&128&&(b.position=m[7]),o.$set(b);const v={};c[0]&128&&(v.position=m[7]),i.$set(v);const h={};c[0]&128&&(h.position=m[7]),f.$set(h)},i(m){s||(k(e.$$.fragment,m),k(o.$$.fragment,m),k(i.$$.fragment,m),k(f.$$.fragment,m),s=!0)},o(m){S(e.$$.fragment,m),S(o.$$.fragment,m),S(i.$$.fragment,m),S(f.$$.fragment,m),s=!1},d(m){m&&(G(t),G(l),G(r)),le(e,m),le(o,m),le(i,m),le(f,m)}}}function bo(n){let e,t,o,l,i,r=n[4]&&n[0]&&nt(n);return{c(){e=_e("div"),r&&r.c(),Y(e,"class",t=Ke(n[2])+" svelte-p00lfq"),Y(e,"data-testid","map-container"),Ve(e,"expand-map",!n[2])},m(f,s){E(f,e,s),r&&r.m(e,null),n[41](e),o=!0,l||(i=[At(ho,"hashchange",n[11]),Ct(n[10].call(null,e))],l=!0)},p(f,s){f[4]&&f[0]?r?(r.p(f,s),s[0]&17&&k(r,1)):(r=nt(f),r.c(),k(r,1),r.m(e,null)):r&&(ge(),S(r,1,1,()=>{r=null}),he()),(!o||s[0]&4&&t!==(t=Ke(f[2])+" svelte-p00lfq"))&&Y(e,"class",t),(!o||s[0]&4)&&Ve(e,"expand-map",!f[2])},i(f){o||(k(r),o=!0)},o(f){S(r),o=!1},d(f){f&&G(e),r&&r.d(),n[41](null),l=!1,St(i)}}}function _o(n,e,t){let o,l,i,r,{$$slots:f={},$$scope:s}=e,{map:m=null}=e,{mapContainer:c=void 0}=e,{class:g=void 0}=e,{style:b}=e,{diffStyleUpdates:v=!1}=e,{center:h=void 0}=e,{zoom:A=void 0}=e,{pitch:y=0}=e,{bearing:w=0}=e,{bounds:I=void 0}=e,{hash:T=!1}=e,{updateHash:H=u=>{window.history.replaceState(window.history.state,"",u)}}=e,{loaded:B=!1}=e,{minZoom:O=0}=e,{maxZoom:L=22}=e,{antialias:_=void 0}=e,{zoomOnDoubleClick:z=!0}=e,{locale:K=void 0}=e,{interactive:d=!0}=e,{attributionControl:ce=!0}=e,{cooperativeGestures:q=!1}=e,{preserveDrawingBuffer:p=!1}=e,{maxBounds:$=void 0}=e,{images:J=[]}=e,{standardControls:C=!1}=e,{filterLayers:X=void 0}=e,{transformRequest:V=void 0}=e;const j=He(),{map:re,loadedImages:F}=Ut();P(n,re,u=>t(4,i=u)),P(n,F,u=>t(5,r=u));let Z=new Set;async function x(u,a=!1){if(i&&!(!i.loaded()&&!a))if("url"in u){Z.add(u.id);try{let M=await i.loadImage(u.url);i==null||i.addImage(u.id,M.data,u.options),r.add(u.id),F.set(r)}catch(M){j("error",M)}finally{Z.delete(u.id)}}else i.addImage(u.id,u.data,u.options),r.add(u.id),F.set(r)}let W,D,ee,me;function Le(u){return te(),be(re,i=new se.Map(Pe({container:u,style:b,locale:K,center:h,zoom:A,pitch:y,bearing:w,minZoom:O,maxZoom:L,antialias:_,interactive:d,preserveDrawingBuffer:p,maxBounds:$,bounds:I,attributionControl:ce,transformRequest:V,cooperativeGestures:q})),i),i.on("load",a=>{a.target.getContainer().setAttribute("data-testid","map"),a.target.getCanvas().setAttribute("data-testid","map-canvas"),t(0,B=!0),j("load",i)}),i.on("error",a=>j("error",{...a,map:i})),i.on("movestart",a=>j("movestart",{...a,map:i})),i.on("moveend",a=>{if(t(12,h=a.target.getCenter()),t(13,A=a.target.getZoom()),t(14,y=a.target.getPitch()),t(15,w=a.target.getBearing()),t(16,I=a.target.getBounds()),j("moveend",{...a,map:i}),T){let M=new URL(window.location.href.replace(/(#.+)?$/,ao(i)));H(M)}}),i.on("click",a=>j("click",{...a,map:i})),i.on("dblclick",a=>j("dblclick",{...a,map:i})),i.on("contextmenu",a=>j("contextmenu",{...a,map:i})),i.on("zoomstart",a=>j("zoomstart",{...a,map:i})),i.on("zoom",a=>{j("zoom",{...a,map:i})}),i.on("zoomend",a=>{j("zoomend",{...a,map:i})}),i.on("style.load",()=>{if(i){const a=i.getStyle();if(t(36,W=a.layers.map(M=>M.id)),t(37,D=Object.keys(a.sources)),me)for(const[M,R]of Object.entries(me))i.addSource(M,R);if(ee)for(const M of ee)i.addLayer(M);for(const M of J)x(M,!0)}}),i.on("styledata",a=>{if(i&&X){const M=i.getStyle().layers;if(M)for(let R of M)X(R)||i.setLayoutProperty(R.id,"visibility","none")}j("styledata",{...a,map:i})}),{destroy(){t(0,B=!1),i==null||i.remove(),be(re,i=null,i)}}}let fe=b;function te(){if(T){let u=co(window.location.hash);u.length>=3&&(t(13,A=u[0]),t(12,h=[u[2],u[1]])),u.length==5&&(t(15,w=u[3]),t(14,y=u[4]))}}function Oe(u){Ie[u?"unshift":"push"](()=>{c=u,t(1,c)})}return n.$$set=u=>{"map"in u&&t(17,m=u.map),"mapContainer"in u&&t(1,c=u.mapContainer),"class"in u&&t(2,g=u.class),"style"in u&&t(18,b=u.style),"diffStyleUpdates"in u&&t(19,v=u.diffStyleUpdates),"center"in u&&t(12,h=u.center),"zoom"in u&&t(13,A=u.zoom),"pitch"in u&&t(14,y=u.pitch),"bearing"in u&&t(15,w=u.bearing),"bounds"in u&&t(16,I=u.bounds),"hash"in u&&t(20,T=u.hash),"updateHash"in u&&t(21,H=u.updateHash),"loaded"in u&&t(0,B=u.loaded),"minZoom"in u&&t(22,O=u.minZoom),"maxZoom"in u&&t(23,L=u.maxZoom),"antialias"in u&&t(24,_=u.antialias),"zoomOnDoubleClick"in u&&t(25,z=u.zoomOnDoubleClick),"locale"in u&&t(26,K=u.locale),"interactive"in u&&t(27,d=u.interactive),"attributionControl"in u&&t(28,ce=u.attributionControl),"cooperativeGestures"in u&&t(29,q=u.cooperativeGestures),"preserveDrawingBuffer"in u&&t(30,p=u.preserveDrawingBuffer),"maxBounds"in u&&t(31,$=u.maxBounds),"images"in u&&t(32,J=u.images),"standardControls"in u&&t(3,C=u.standardControls),"filterLayers"in u&&t(33,X=u.filterLayers),"transformRequest"in u&&t(34,V=u.transformRequest),"$$scope"in u&&t(39,s=u.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&8&&t(7,o=typeof C=="boolean"?void 0:C),n.$$.dirty[0]&16&&t(17,m=i),n.$$.dirty[0]&786448|n.$$.dirty[1]&224&&i&&!Te(b,fe)){const u=i.getStyle();if(W&&(ee=u.layers.filter(a=>!W.includes(a.id))),D){const a=Object.keys(u.sources).filter(M=>!D.includes(M));me={};for(const M of a)me[M]=u.sources[M]}t(38,fe=b),i.setStyle(b,{diff:v}),be(F,r=new Set,r),t(35,Z=new Set)}if(n.$$.dirty[0]&49|n.$$.dirty[1]&18&&B&&i!=null&&i.loaded())for(let u of J)!r.has(u.id)&&!Z.has(u.id)&&!i.hasImage(u.id)&&x(u);if(n.$$.dirty[0]&32|n.$$.dirty[1]&2&&t(6,l=J.every(u=>r.has(u.id))),n.$$.dirty[0]&61456&&i){let u={};h!=null&&!Te(h,i==null?void 0:i.getCenter())&&(u.center=h),A!=null&&!Te(A,i==null?void 0:i.getZoom())&&(u.zoom=A),w!=null&&!Te(w,i==null?void 0:i.getBearing())&&(u.bearing=w),y!=null&&!Te(y,i==null?void 0:i.getPitch())&&(u.pitch=y),Object.keys(u).length&&i.easeTo(u)}n.$$.dirty[0]&65552&&I&&!Te(I,i==null?void 0:i.getBounds())&&(i==null||i.fitBounds(I)),n.$$.dirty[0]&33554448&&(z?i==null||i.doubleClickZoom.enable():i==null||i.doubleClickZoom.disable())},[B,c,g,C,i,r,l,o,re,F,Le,te,h,A,y,w,I,m,b,v,T,H,O,L,_,z,K,d,ce,q,p,$,J,X,V,Z,W,D,fe,s,f,Oe]}class ko extends N{constructor(e){super(),Q(this,e,_o,bo,U,{map:17,mapContainer:1,class:2,style:18,diffStyleUpdates:19,center:12,zoom:13,pitch:14,bearing:15,bounds:16,hash:20,updateHash:21,loaded:0,minZoom:22,maxZoom:23,antialias:24,zoomOnDoubleClick:25,locale:26,interactive:27,attributionControl:28,cooperativeGestures:29,preserveDrawingBuffer:30,maxBounds:31,images:32,standardControls:3,filterLayers:33,transformRequest:34},null,[-1,-1])}}const Ao=n=>({features:n[0]&16,data:n[0]&16,map:n[0]&4,close:n[0]&1}),lt=n=>{var e;return{features:n[4],data:(e=n[4])==null?void 0:e[0],map:n[2],close:n[31]}};function rt(n){let e,t,o=(n[4]||n[3]instanceof se.Marker)&&ft(n);return{c(){e=_e("div"),o&&o.c()},m(l,i){E(l,e,i),o&&o.m(e,null),n[32](e),t=!0},p(l,i){l[4]||l[3]instanceof se.Marker?o?(o.p(l,i),i[0]&24&&k(o,1)):(o=ft(l),o.c(),k(o,1),o.m(e,null)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(l){t||(k(o),t=!0)},o(l){S(o),t=!1},d(l){l&&G(e),o&&o.d(),n[32](null)}}}function ft(n){let e;const t=n[30].default,o=Ce(t,n,n[29],lt);return{c(){o&&o.c()},m(l,i){o&&o.m(l,i),e=!0},p(l,i){o&&o.p&&(!e||i[0]&536870933)&&Se(o,t,l,l[29],e?we(t,l[29],i,Ao):ve(l[29]),lt)},i(l){e||(k(o,l),e=!0)},o(l){S(o,l),e=!1},d(l){o&&o.d(l)}}}function Co(n){let e,t,o=n[9].default&&rt(n);return{c(){o&&o.c(),e=Me()},m(l,i){o&&o.m(l,i),E(l,e,i),t=!0},p(l,i){l[9].default?o?(o.p(l,i),i[0]&512&&k(o,1)):(o=rt(l),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(l){t||(k(o),t=!0)},o(l){S(o),t=!1},d(l){l&&G(e),o&&o.d(l)}}}function So(n,e,t){let o,l,i,r,f,s,{$$slots:m={},$$scope:c}=e;const g=vt(m);let{closeButton:b=void 0}=e,{closeOnClickOutside:v=!0}=e,{closeOnClickInside:h=!1}=e,{closeOnMove:A=!1}=e,{openOn:y="click"}=e,{openIfTopMost:w=!0}=e,{focusAfterOpen:I=!0}=e,{anchor:T=void 0}=e,{offset:H=void 0}=e,{popupClass:B=void 0}=e,{maxWidth:O=void 0}=e,{lngLat:L=void 0}=e,{html:_=void 0}=e,{open:z=!1}=e;const K=He(),{map:d,popupTarget:ce,layerEvent:q,layer:p,eventTopMost:$}=ze();P(n,d,a=>t(2,i=a)),P(n,ce,a=>t(3,f=a)),P(n,q,a=>t(28,r=a)),P(n,p,a=>t(35,s=a));const J=["click","dblclick","contextmenu"];let C,X=!1,V;function j(){if(!C)return;let a=C.getElement();!a||a===V||(V=a,y==="hover"&&(V.style.pointerEvents="none"),V.addEventListener("mouseenter",()=>{t(24,X=!0)},{passive:!0}),V.addEventListener("mouseleave",()=>{t(24,X=!1)},{passive:!0}),V.addEventListener("click",()=>{h&&t(0,z=!1)},{passive:!0}))}dt(()=>{if(i)return i.on("click",fe),i.on("contextmenu",fe),typeof f=="string"&&(i.on("click",f,x),i.on("dblclick",f,x),i.on("contextmenu",f,x),i.on("mousemove",f,Le),i.on("mouseleave",f,me),i.on("touchstart",f,D),i.on("touchend",f,ee)),()=>{i!=null&&i.loaded()&&(C==null||C.remove(),i.off("click",fe),i.off("contextmenu",fe),f instanceof se.Marker?f.getPopup()===C&&f.setPopup(void 0):typeof f=="string"&&(i.off("click",f,x),i.off("dblclick",f,x),i.off("contextmenu",f,x),i.off("mousemove",f,Le),i.off("mouseleave",f,me),i.off("touchstart",f,D),i.off("touchend",f,ee)))}});function re(a){return w?!("marker"in a)&&!Qt(a)&&$(a)!==s:!1}let F=null,Z="normal";function x(a){a.type===y&&(re(a)||("layerType"in a?a.layerType==="deckgl"?(t(10,L=a.coordinate),t(4,F=a.object?[a.object]:null)):(t(10,L=a.lngLat),t(4,F=a.features??[])):(t(10,L=a.lngLat),t(4,F=a.features??[])),setTimeout(()=>t(0,z=!0))))}let W=null;function D(a){W=a.point}function ee(a){if(!W||y!=="hover")return;let M=W.dist(a.point);W=null,M<3&&(t(10,L=a.lngLat),t(4,F=a.features??[]),C.isOpen()?t(25,Z="justOpened"):(t(25,Z="opening"),t(0,z=!0)))}function me(a){y!=="hover"||W||Z!=="normal"||(t(0,z=!1),t(4,F=null))}function Le(a){if(!(y!=="hover"||W||Z!=="normal")){if(re(a)){t(0,z=!1),t(4,F=null);return}t(0,z=!0),t(4,F=a.features??[]),t(10,L=a.lngLat)}}function fe(a){if(Z==="justOpened"){t(25,Z="normal");return}if(!v)return;let M=[V,f instanceof se.Marker?f==null?void 0:f.getElement():null];z&&C.isOpen()&&!M.some(R=>R==null?void 0:R.contains(a.originalEvent.target))&&(a.type==="contextmenu"&&y==="contextmenu"||a.type!=="contextmenu")&&t(0,z=!1)}ke(()=>{i&&(C!=null&&C.isOpen())&&C.remove()});let te;const Oe=()=>t(0,z=!1);function u(a){Ie[a?"unshift":"push"](()=>{te=a,t(1,te)})}return n.$$set=a=>{"closeButton"in a&&t(11,b=a.closeButton),"closeOnClickOutside"in a&&t(12,v=a.closeOnClickOutside),"closeOnClickInside"in a&&t(13,h=a.closeOnClickInside),"closeOnMove"in a&&t(14,A=a.closeOnMove),"openOn"in a&&t(15,y=a.openOn),"openIfTopMost"in a&&t(16,w=a.openIfTopMost),"focusAfterOpen"in a&&t(17,I=a.focusAfterOpen),"anchor"in a&&t(18,T=a.anchor),"offset"in a&&t(19,H=a.offset),"popupClass"in a&&t(20,B=a.popupClass),"maxWidth"in a&&t(21,O=a.maxWidth),"lngLat"in a&&t(10,L=a.lngLat),"html"in a&&t(22,_=a.html),"open"in a&&t(0,z=a.open),"$$scope"in a&&t(29,c=a.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&14336&&t(27,o=b??(!v&&!h)),n.$$.dirty[0]&146685952&&(C||(t(23,C=new se.Popup({closeButton:o,closeOnClick:!1,closeOnMove:A,focusAfterOpen:I,maxWidth:O,className:B,anchor:T,offset:H})),V=C.getElement(),C.on("open",()=>{t(0,z=!0),j(),K("open",C)}),C.on("close",()=>{t(0,z=!1),K("close",C)}),C.on("hover",()=>{K("hover",C)}))),n.$$.dirty[0]&8421384&&C&&f instanceof se.Marker&&(y==="click"?f.setPopup(C):f.getPopup()===C&&f.setPopup(void 0)),n.$$.dirty[0]&268468224&&J.includes(y)&&(r==null?void 0:r.type)===y&&(x(r),be(q,r=null,r)),n.$$.dirty[0]&268468224&&t(26,l=y==="hover"&&((r==null?void 0:r.type)==="mousemove"||(r==null?void 0:r.type)==="mouseenter")),n.$$.dirty[0]&352354304&&y==="hover"&&q&&(l&&r&&(r.layerType==="deckgl"?(t(10,L=r.coordinate),t(4,F=r.object?[r.object]:null)):(t(10,L=r.lngLat),t(4,F=r.features??[]))),t(0,z=(l||X)??!1)),n.$$.dirty[0]&12582914&&(te?C.setDOMContent(te):_&&C.setHTML(_)),n.$$.dirty[0]&8389632&&L&&C.setLngLat(L),n.$$.dirty[0]&41943045&&i){let a=C.isOpen();z&&!a?(C.addTo(i),Z==="opening"&&t(25,Z="justOpened")):!z&&a&&C.remove()}},[z,te,i,f,F,d,ce,q,p,g,L,b,v,h,A,y,w,I,T,H,B,O,_,C,X,Z,l,o,r,c,m,Oe,u]}class qo extends N{constructor(e){super(),Q(this,e,So,Co,U,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}function vo(n){let e,t,o,l;const i=[Mo,wo],r=[];function f(s,m){return s[0]?0:1}return e=f(n),t=r[e]=i[e](n),{c(){t.c(),o=Me()},m(s,m){r[e].m(s,m),E(s,o,m),l=!0},p(s,m){t.p(s,m)},i(s){l||(k(t),l=!0)},o(s){S(t),l=!1},d(s){s&&G(o),r[e].d(s)}}}function wo(n){let e,t;return e=new Mt({props:{errorMessage:"You shouldn't be able to view this app without being logged in!"}}),{c(){ne(e.$$.fragment)},m(o,l){ie(e,o,l),t=!0},p:ae,i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){S(e.$$.fragment,o),t=!1},d(o){le(e,o)}}}function Mo(n){let e;return{c(){e=_e("p"),e.textContent=`Logged in as ${n[0]}`},m(t,o){E(t,e,o)},p:ae,i:ae,o:ae,d(t){t&&G(e)}}}function Lo(n){let e=mt()=="Private (development)",t,o,l=e&&vo(n);return{c(){l&&l.c(),t=Me()},m(i,r){l&&l.m(i,r),E(i,t,r),o=!0},p(i,[r]){e&&l.p(i,r)},i(i){o||(k(l),o=!0)},o(i){S(l),o=!1},d(i){i&&G(t),l&&l.d(i)}}}function zo(n){return[wt.get("email")]}class Jo extends N{constructor(e){super(),Q(this,e,zo,Lo,U,{})}}const Oo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAQAAAC1QeVaAAAAAmJLR0QA/4ePzL8AAACgSURBVBjTY2D4D4cvGHoY2BlQwH8U2I4pCQKsDHFg3VglGRjEgazvmJLlQNjIcAnIOobbztcM5piSHUBYzxDNwMfAgMtOGKjHJpnJ8IwhhcGFYREDM6ZkCMMqoPHXGC4zBKEa5cPwBKioAAiXMIQz/GZ4yuCFkHzC4MjgxPCNoZaBjeE+kOXEcB0h+RjIdWG4AGU7w9lg4A0UesBgj8oGAP6nSFElh0b7AAAAAElFTkSuQmCC",To="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAm0lEQVRIS+2U0Q2AIAxEYQM30Q3UDXQy3UhHkE0cweuHHxKTXpuQaALJ/cE9eoXGUHjFwv6hAtSEPxFRh2su0Ayd6pWzDUwFO8700AGNVggDaGAqkNYDYQBStBvCAtwQC8AF8QA2kORlJWjQmm4BSB9M5lIyC3CZswC3OQu4PxqVef7TmYikoSs0aQ19GyMMwDp+HvsrQI3v/xFduXoiGbi1DtQAAAAASUVORK5CYII=",Io="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC",Bo="/atip/manage_files/assets/google_on_non_white_hdpi-368415f0.png";function Eo(n){let e,t,o,l;return{c(){e=_e("div"),t=new zt(!1),o=Lt(` |
  `),l=_e("a"),l.textContent="MapLibre",t.a=o,Y(l,"href","https://maplibre.org/"),Y(l,"target","_blank"),Y(e,"class","svelte-1yeu1m4")},m(i,r){E(i,e,r),t.m(n[0],e),We(e,o),We(e,l)},p(i,[r]){r&1&&t.p(i[0])},i:ae,o:ae,d(i){i&&G(e)}}}function Go(n,e,t){let{attribution:o}=e;return n.$$set=l=>{"attribution"in l&&t(0,o=l.attribution)},[o]}class Po extends N{constructor(e){super(),Q(this,e,Go,Eo,U,{attribution:0})}}function ut(n){let e,t,o,l;function i(s){n[9](s)}function r(s){n[10](s)}let f={style:n[4],bounds:n[0],hash:!0,images:[{id:"chevron",url:To},{id:"cycle_parking",url:Oo},{id:"railway_station",url:Io}],attributionControl:!1,$$slots:{default:[Ho]},$$scope:{ctx:n}};return n[3]!==void 0&&(f.loaded=n[3]),n[2]!==void 0&&(f.map=n[2]),e=new ko({props:f}),Ie.push(()=>Be(e,"loaded",i)),Ie.push(()=>Be(e,"map",r)),e.$on("error",Zo),{c(){ne(e.$$.fragment)},m(s,m){ie(e,s,m),l=!0},p(s,m){const c={};m&16&&(c.style=s[4]),m&1&&(c.bounds=s[0]),m&2146&&(c.$$scope={dirty:m,ctx:s}),!t&&m&8&&(t=!0,c.loaded=s[3],Ee(()=>t=!1)),!o&&m&4&&(o=!0,c.map=s[2],Ee(()=>o=!1)),e.$set(c)},i(s){l||(k(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){le(e,s)}}}function st(n){let e,t,o,l,i,r,f,s,m,c;e=new so({}),e.$on("zoomend",n[7]),e.$on("moveend",n[7]),o=new Po({props:{attribution:n[6]}}),i=new yt({}),f=new ht({props:{position:"bottom-left",visualizePitch:!0}});let g=n[1]=="google"&&at();const b=n[8].default,v=Ce(b,n,n[11],null);return{c(){ne(e.$$.fragment),t=ye(),ne(o.$$.fragment),l=ye(),ne(i.$$.fragment),r=ye(),ne(f.$$.fragment),s=ye(),g&&g.c(),m=ye(),v&&v.c()},m(h,A){ie(e,h,A),E(h,t,A),ie(o,h,A),E(h,l,A),ie(i,h,A),E(h,r,A),ie(f,h,A),E(h,s,A),g&&g.m(h,A),E(h,m,A),v&&v.m(h,A),c=!0},p(h,A){const y={};A&64&&(y.attribution=h[6]),o.$set(y),h[1]=="google"?g||(g=at(),g.c(),g.m(m.parentNode,m)):g&&(g.d(1),g=null),v&&v.p&&(!c||A&2048)&&Se(v,b,h,h[11],c?we(b,h[11],A,null):ve(h[11]),null)},i(h){c||(k(e.$$.fragment,h),k(o.$$.fragment,h),k(i.$$.fragment,h),k(f.$$.fragment,h),k(v,h),c=!0)},o(h){S(e.$$.fragment,h),S(o.$$.fragment,h),S(i.$$.fragment,h),S(f.$$.fragment,h),S(v,h),c=!1},d(h){h&&(G(t),G(l),G(r),G(s),G(m)),le(e,h),le(o,h),le(i,h),le(f,h),g&&g.d(h),v&&v.d(h)}}}function at(n){let e,t;return{c(){e=_e("img"),Ot(e.src,t=Bo)||Y(e,"src",t),Y(e,"alt","Google logo"),Y(e,"class","svelte-81xaz8")},m(o,l){E(o,e,l)},d(o){o&&G(e)}}}function Ho(n){let e,t,o=n[5]&&st(n);return{c(){o&&o.c(),e=Me()},m(l,i){o&&o.m(l,i),E(l,e,i),t=!0},p(l,i){l[5]?o?(o.p(l,i),i&32&&k(o,1)):(o=st(l),o.c(),k(o,1),o.m(e.parentNode,e)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(l){t||(k(o),t=!0)},o(l){S(o),t=!1},d(l){l&&G(e),o&&o.d(l)}}}function Fo(n){let e,t,o=n[4]&&ut(n);return{c(){e=_e("div"),o&&o.c(),Y(e,"class","map svelte-81xaz8")},m(l,i){E(l,e,i),o&&o.m(e,null),t=!0},p(l,[i]){l[4]?o?(o.p(l,i),i&16&&k(o,1)):(o=ut(l),o.c(),k(o,1),o.m(e,null)):o&&(ge(),S(o,1,1,()=>{o=null}),he())},i(l){t||(k(o),t=!0)},o(l){S(o),t=!1},d(l){l&&G(e),o&&o.d()}}}function Zo(n){console.error(`MapLibre error: ${n.detail.error}`)}function Do(n,e,t){let o,l;P(n,Ye,y=>t(5,o=y)),P(n,Ge,y=>t(6,l=y));let{$$slots:i={},$$scope:r}=e,{style:f}=e,{startBounds:s=void 0}=e,m=null,c,g=!1;Re("setCamera",!window.location.hash),window.location.hash&&(s=void 0),dt(async()=>{t(4,m=await qe(f))});async function b(y){t(4,m=await qe(f));let w=new URL(window.location.href);w.searchParams.set("style",y),window.history.replaceState(null,"",w.toString())}async function v(){f=="google"&&o&&be(Ge,l=await Bt(o),l)}function h(y){g=y,t(3,g)}function A(y){c=y,t(2,c)}return n.$$set=y=>{"style"in y&&t(1,f=y.style),"startBounds"in y&&t(0,s=y.startBounds),"$$scope"in y&&t(11,r=y.$$scope)},n.$$.update=()=>{n.$$.dirty&12&&g&&Ye.set(c),n.$$.dirty&2&&b(f)},[s,f,c,g,m,o,l,v,i,h,A,r]}class Xo extends N{constructor(e){super(),Q(this,e,Do,Fo,U,{style:1,startBounds:0})}}export{Uo as A,No as E,Vo as F,Wo as G,Jo as L,Xo as M,qo as P,Yo as a,$t as b,Pe as c,Kt as d,Tt as e,so as f,Fe as g,Ko as h,Vt as i,gt as j,To as k,Oo as l,ze as m,Io as n,jo as o,Qo as p,eo as r,jt as u};
