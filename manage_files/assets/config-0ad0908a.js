import{S as J,i as K,s as H,M as Ve,e as G,b as T,c as $,N as Xe,O as Ye,P as xe,t as d,q as h,d as b,aD as ae,j as y,p as S,v as j,aI as ue,E as _e,f as oe,a as N,aA as z,ab as V,y as D,o as E,H as fe,aB as et,Q as tt,a6 as je,aJ as Oe,a7 as ct,aK as Ue,g as L,h as B,R as pe,Z as ie,u as R,w as ve,aa as nt,z as se,r as re,n as de,aj as ke,K as ge,L as it,ax as qe,G as ne,D as st,$ as pt,aL as le,aG as mt}from"./index-db5d9753.js";import{S as Ne,p as he,a as me,C as _t,g as dt,b as gt,t as ht,r as Ie}from"./colors-f4b84deb.js";function $t(n){let e,i;const t=n[1].default,s=Ve(t,n,n[0],null);return{c(){e=G("div"),s&&s.c(),T(e,"class","govuk-button-group")},m(u,r){$(u,e,r),s&&s.m(e,null),i=!0},p(u,[r]){s&&s.p&&(!i||r&1)&&Xe(s,t,u,u[0],i?xe(t,u[0],r,null):Ye(u[0]),null)},i(u){i||(d(s,u),i=!0)},o(u){h(s,u),i=!1},d(u){u&&b(e),s&&s.d(u)}}}function bt(n,e,i){let{$$slots:t={},$$scope:s}=e;return n.$$set=u=>{"$$scope"in u&&i(0,s=u.$$scope)},[s,t]}class vt extends J{constructor(e){super(),K(this,e,bt,$t,H,{})}}function Te(n){let e,i,t=$e(n[0])+"",s;return{c(){e=G("div"),i=D("Â£"),s=D(t),T(e,"class","govuk-hint")},m(u,r){$(u,e,r),E(e,i),E(e,s)},p(u,r){r&1&&t!==(t=$e(u[0])+"")&&fe(s,t)},d(u){u&&b(e)}}}function kt(n){let e;return{c(){e=D("multiply by 1 million")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function wt(n){let e,i,t,s,u,r,f,l,a;e=new _e({props:{errorMessage:Ae(n[2])}});let o=n[0]!=null&&Te(n);return r=new oe({props:{disabled:n[0]==null||n[0]>1e3,$$slots:{default:[kt]},$$scope:{ctx:n}}}),r.$on("click",n[4]),{c(){y(e.$$.fragment),i=N(),o&&o.c(),t=N(),s=G("input"),u=N(),y(r.$$.fragment),T(s,"type","text"),T(s,"inputmode","numeric"),T(s,"class","govuk-input govuk-input--width-10"),T(s,"id",n[3])},m(p,c){S(e,p,c),$(p,i,c),o&&o.m(p,c),$(p,t,c),$(p,s,c),z(s,n[2]),$(p,u,c),S(r,p,c),f=!0,l||(a=V(s,"input",n[5]),l=!0)},p(p,c){const _={};c&4&&(_.errorMessage=Ae(p[2])),e.$set(_),p[0]!=null?o?o.p(p,c):(o=Te(p),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null),c&4&&s.value!==p[2]&&z(s,p[2]);const q={};c&1&&(q.disabled=p[0]==null||p[0]>1e3),c&128&&(q.$$scope={dirty:c,ctx:p}),r.$set(q)},i(p){f||(d(e.$$.fragment,p),d(r.$$.fragment,p),f=!0)},o(p){h(e.$$.fragment,p),h(r.$$.fragment,p),f=!1},d(p){p&&(b(i),b(t),b(s),b(u)),j(e,p),o&&o.d(p),j(r,p),l=!1,a()}}}function yt(n){let e,i;return e=new ae({props:{label:n[1],id:n[3],$$slots:{default:[wt]},$$scope:{ctx:n}}}),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,[s]){const u={};s&2&&(u.label=t[1]),s&133&&(u.$$scope={dirty:s,ctx:t}),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function rt(n){if(n!="")return parseFloat(n.replaceAll(",",""))}function Ae(n){let e=rt(n);return e==null?"":isNaN(e)?"Please enter a valid number":e<0?"Please enter a positive number":""}function $e(n){return n.toLocaleString()}function St(n,e,i){let{label:t}=e,{value:s}=e,u=ue(),r=s==null?"":$e(s);function f(o){i(0,s=rt(o))}function l(){i(2,r=$e(s*1e6))}function a(){r=this.value,i(2,r)}return n.$$set=o=>{"label"in o&&i(1,t=o.label),"value"in o&&i(0,s=o.value)},n.$$.update=()=>{n.$$.dirty&4&&f(r)},[s,t,r,u,l,a]}class jt extends J{constructor(e){super(),K(this,e,St,yt,H,{label:1,value:0})}}function qt(n){let e,i,t,s,u,r,f;return e=new _e({props:{errorMessage:n[5](n[2])}}),{c(){y(e.$$.fragment),i=N(),t=G("input"),T(t,"type","text"),T(t,"inputmode","numeric"),T(t,"class",s=`govuk-input govuk-input--width-${n[1]}`),T(t,"id",n[3])},m(l,a){S(e,l,a),$(l,i,a),$(l,t,a),z(t,n[2]),u=!0,r||(f=[V(t,"input",n[9]),V(t,"change",n[4])],r=!0)},p(l,a){const o={};a&4&&(o.errorMessage=l[5](l[2])),e.$set(o),(!u||a&2&&s!==(s=`govuk-input govuk-input--width-${l[1]}`))&&T(t,"class",s),a&4&&t.value!==l[2]&&z(t,l[2])},i(l){u||(d(e.$$.fragment,l),u=!0)},o(l){h(e.$$.fragment,l),u=!1},d(l){l&&(b(i),b(t)),j(e,l),r=!1,et(f)}}}function Nt(n){let e,i;return e=new ae({props:{label:n[0],id:n[3],$$slots:{default:[qt]},$$scope:{ctx:n}}}),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,[s]){const u={};s&1&&(u.label=t[0]),s&1030&&(u.$$scope={dirty:s,ctx:t}),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function Ft(n,e,i){let{label:t}=e,{value:s}=e,{width:u}=e,{min:r=void 0}=e,{max:f=void 0}=e,l=s==null?void 0:s.toString(),a=ue();function o(){i(6,s=l==null?void 0:parseInt(l,10))}function p(_){if(_==""||_==null)return"";if(_.includes("."))return"Please enter a number without decimals";let q=Number(_);return isNaN(q)?"Please enter a valid number":r!=null&&q<r?`Please enter a number that's at least ${r};`:f!=null&&q>f?`Please enter a number that's at most ${f};`:""}function c(){l=this.value,i(2,l)}return n.$$set=_=>{"label"in _&&i(0,t=_.label),"value"in _&&i(6,s=_.value),"width"in _&&i(1,u=_.width),"min"in _&&i(7,r=_.min),"max"in _&&i(8,f=_.max)},[t,u,l,a,o,p,s,r,f,c]}class Se extends J{constructor(e){super(),K(this,e,Ft,Nt,H,{label:0,value:6,width:1,min:7,max:8})}}function Ee(n){let e,i;return{c(){e=G("div"),i=D(n[2]),T(e,"class","govuk-hint")},m(t,s){$(t,e,s),E(e,i)},p(t,s){s&4&&fe(i,t[2])},d(t){t&&b(e)}}}function Pt(n){let e,i,t,s,u,r,f;e=new _e({props:{errorMessage:n[4]}});let l=n[2]&&Ee(n);return{c(){y(e.$$.fragment),i=N(),l&&l.c(),t=N(),s=G("textarea"),T(s,"class","govuk-textarea"),T(s,"id",n[5]),T(s,"rows",n[3])},m(a,o){S(e,a,o),$(a,i,o),l&&l.m(a,o),$(a,t,o),$(a,s,o),z(s,n[0]),u=!0,r||(f=V(s,"input",n[6]),r=!0)},p(a,o){const p={};o&16&&(p.errorMessage=a[4]),e.$set(p),a[2]?l?l.p(a,o):(l=Ee(a),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null),(!u||o&8)&&T(s,"rows",a[3]),o&1&&z(s,a[0])},i(a){u||(d(e.$$.fragment,a),u=!0)},o(a){h(e.$$.fragment,a),u=!1},d(a){a&&(b(i),b(t),b(s)),j(e,a),l&&l.d(a),r=!1,f()}}}function Mt(n){let e,i;return e=new ae({props:{label:n[1],id:n[5],$$slots:{default:[Pt]},$$scope:{ctx:n}}}),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,[s]){const u={};s&2&&(u.label=t[1]),s&157&&(u.$$scope={dirty:s,ctx:t}),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function Ct(n,e,i){let{label:t}=e,{hint:s=""}=e,{value:u}=e,{rows:r=5}=e,{errorMessage:f=""}=e,l=ue();function a(){u=this.value,i(0,u)}return n.$$set=o=>{"label"in o&&i(1,t=o.label),"hint"in o&&i(2,s=o.hint),"value"in o&&i(0,u=o.value),"rows"in o&&i(3,r=o.rows),"errorMessage"in o&&i(4,f=o.errorMessage)},[u,t,s,r,f,l,a]}class Fe extends J{constructor(e){super(),K(this,e,Ct,Mt,H,{label:1,hint:2,value:0,rows:3,errorMessage:4})}}function Ot(n){let e,i,t,s,u,r;return e=new _e({props:{errorMessage:n[2]}}),{c(){y(e.$$.fragment),i=N(),t=G("input"),T(t,"type","text"),T(t,"class","govuk-input"),T(t,"id",n[3])},m(f,l){S(e,f,l),$(f,i,l),$(f,t,l),z(t,n[0]),s=!0,u||(r=[V(t,"input",n[6]),V(t,"change",n[5])],u=!0)},p(f,l){const a={};l&4&&(a.errorMessage=f[2]),e.$set(a),l&1&&t.value!==f[0]&&z(t,f[0])},i(f){s||(d(e.$$.fragment,f),s=!0)},o(f){h(e.$$.fragment,f),s=!1},d(f){f&&(b(i),b(t)),j(e,f),u=!1,et(r)}}}function Ut(n){let e,i;return e=new ae({props:{label:n[1],id:n[3],$$slots:{default:[Ot]},$$scope:{ctx:n}}}),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,[s]){const u={};s&2&&(u.label=t[1]),s&133&&(u.$$scope={dirty:s,ctx:t}),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function It(n,e,i){let t,{label:s}=e,{value:u}=e,{required:r=!1}=e,f=ue();function l(o){tt.call(this,n,o)}function a(){u=this.value,i(0,u)}return n.$$set=o=>{"label"in o&&i(1,s=o.label),"value"in o&&i(0,u=o.value),"required"in o&&i(4,r=o.required)},n.$$.update=()=>{n.$$.dirty&17&&i(2,t=r&&(u==null||u=="")?"Required":"")},[u,s,t,f,r,l,a]}class Pe extends J{constructor(e){super(),K(this,e,It,Ut,H,{label:1,value:0,required:4})}}function Tt(n){let e,i,t,s;const u=n[2].default,r=Ve(u,n,n[1],null);let f=[{type:"button"},{class:"govuk-button govuk-button--warning"},{"data-module":"govuk-button"},n[0]],l={};for(let a=0;a<f.length;a+=1)l=je(l,f[a]);return{c(){e=G("button"),r&&r.c(),Oe(e,l)},m(a,o){$(a,e,o),r&&r.m(e,null),e.autofocus&&e.focus(),i=!0,t||(s=V(e,"click",n[3]),t=!0)},p(a,[o]){r&&r.p&&(!i||o&2)&&Xe(r,u,a,a[1],i?xe(u,a[1],o,null):Ye(a[1]),null),Oe(e,l=ct(f,[{type:"button"},{class:"govuk-button govuk-button--warning"},{"data-module":"govuk-button"},o&1&&a[0]]))},i(a){i||(d(r,a),i=!0)},o(a){h(r,a),i=!1},d(a){a&&b(e),r&&r.d(a),t=!1,s()}}}function At(n,e,i){let{$$slots:t={},$$scope:s}=e;function u(r){tt.call(this,n,r)}return n.$$set=r=>{i(0,e=je(je({},e),Ue(r))),"$$scope"in r&&i(1,s=r.$$scope)},e=Ue(e),[e,s,t,u]}class Et extends J{constructor(e){super(),K(this,e,At,Tt,H,{})}}function Le(n,e){return`sketch/${n}/${e}`}function Hn(n){let e=`sketch/${n}/`,i=[];for(let t=0;t<window.localStorage.length;t++){let s=window.localStorage.key(t);s.startsWith(e)&&i.push(s.slice(e.length))}return i.sort(),i}function Qn(n,e){let i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),i.setAttribute("download",n),document.body.appendChild(i),i.click(),document.body.removeChild(i)}function Zn(n){let e=[];for(let i=0;i<window.localStorage.length;i++){let t=window.localStorage.key(i);t==n?e.push([t,Le(n,"old v1 sketch")]):t==`${n}_pipeline`&&e.push([t,Le(n,"old pipeline sketch")])}for(let[i,t]of e){console.log(`Renaming ${i} to ${t}`);let s=window.localStorage.getItem(i);window.localStorage.setItem(t,s),window.localStorage.removeItem(i)}}function Be(n){let e,i;return e=new oe({props:{disabled:!n[2],$$slots:{default:[Lt]},$$scope:{ctx:n}}}),e.$on("click",n[7]),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,s){const u={};s&4&&(u.disabled=!t[2]),s&4096&&(u.$$scope={dirty:s,ctx:t}),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function Lt(n){let e;return{c(){e=D("Auto-fill")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function Bt(n){let e,i,t,s,u,r,f=n[0].length_meters&&Be(n);return{c(){e=G("input"),i=N(),f&&f.c(),t=ie(),T(e,"type","text"),T(e,"class","govuk-input"),T(e,"id",n[5])},m(l,a){$(l,e,a),z(e,n[0].name),$(l,i,a),f&&f.m(l,a),$(l,t,a),s=!0,u||(r=V(e,"input",n[6]),u=!0)},p(l,a){a&1&&e.value!==l[0].name&&z(e,l[0].name),l[0].length_meters?f?(f.p(l,a),a&1&&d(f,1)):(f=Be(l),f.c(),d(f,1),f.m(t.parentNode,t)):f&&(se(),h(f,1,1,()=>{f=null}),re())},i(l){s||(d(f),s=!0)},o(l){h(f),s=!1},d(l){l&&(b(e),b(i),b(t)),f&&f.d(l),u=!1,r()}}}function Re(n){let e,i,t=he(n[0].length_meters)+"",s;return{c(){e=G("p"),i=D("Length: "),s=D(t)},m(u,r){$(u,e,r),E(e,i),E(e,s)},p(u,r){r&1&&t!==(t=he(u[0].length_meters)+"")&&fe(s,t)},d(u){u&&b(e)}}}function Rt(n){let e,i,t,s,u,r,f,l,a,o,p,c,_;e=new ae({props:{label:"Name",id:n[5],$$slots:{default:[Bt]},$$scope:{ctx:n}}});function q(m){n[9](m)}let A={label:"Scheme",choices:Object.values(n[3].schemes).map(n[8])};n[0].scheme_reference!==void 0&&(A.value=n[0].scheme_reference),t=new Ne({props:A}),L.push(()=>B(t,"value",q));function F(m){n[10](m)}let v={label:"Type",choices:[["area","Area"],["route","Route"],["crossing","Crossing"],["other","Other"]],inlineSmall:!0,required:!0};n[0].intervention_type!==void 0&&(v.value=n[0].intervention_type),r=new pe({props:v}),L.push(()=>B(r,"value",F));function k(m){n[11](m)}let M={label:"Description"};n[0].description!==void 0&&(M.value=n[0].description),a=new Fe({props:M}),L.push(()=>B(a,"value",k));let O=n[0].length_meters&&Re(n);return{c(){y(e.$$.fragment),i=N(),y(t.$$.fragment),u=N(),y(r.$$.fragment),l=N(),y(a.$$.fragment),p=N(),O&&O.c(),c=ie()},m(m,g){S(e,m,g),$(m,i,g),S(t,m,g),$(m,u,g),S(r,m,g),$(m,l,g),S(a,m,g),$(m,p,g),O&&O.m(m,g),$(m,c,g),_=!0},p(m,[g]){const I={};g&4101&&(I.$$scope={dirty:g,ctx:m}),e.$set(I);const U={};g&8&&(U.choices=Object.values(m[3].schemes).map(m[8])),!s&&g&1&&(s=!0,U.value=m[0].scheme_reference,R(()=>s=!1)),t.$set(U);const Q={};!f&&g&1&&(f=!0,Q.value=m[0].intervention_type,R(()=>f=!1)),r.$set(Q);const Z={};!o&&g&1&&(o=!0,Z.value=m[0].description,R(()=>o=!1)),a.$set(Z),m[0].length_meters?O?O.p(m,g):(O=Re(m),O.c(),O.m(c.parentNode,c)):O&&(O.d(1),O=null)},i(m){_||(d(e.$$.fragment,m),d(t.$$.fragment,m),d(r.$$.fragment,m),d(a.$$.fragment,m),_=!0)},o(m){h(e.$$.fragment,m),h(t.$$.fragment,m),h(r.$$.fragment,m),h(a.$$.fragment,m),_=!1},d(m){m&&(b(i),b(u),b(l),b(p),b(c)),j(e,m),j(t,m),j(r,m),j(a,m),O&&O.d(m)}}}function Wt(n,e,i){let t,s,u=de,r=()=>(u(),u=ke(f,v=>i(3,s=v)),f);ve(n,nt,v=>i(2,t=v)),n.$$.on_destroy.push(()=>u());let{gjSchemes:f}=e;r();let{props:l}=e;function a(){try{i(0,l.name=t.inner.routeNameForWaypoints(l.waypoints),l)}catch(v){window.alert(`Couldn't auto-name route: ${v}`)}}let o=ue();function p(){l.name=this.value,i(0,l)}const c=()=>a(),_=v=>[v.scheme_reference,Me(v)];function q(v){n.$$.not_equal(l.scheme_reference,v)&&(l.scheme_reference=v,i(0,l))}function A(v){n.$$.not_equal(l.intervention_type,v)&&(l.intervention_type=v,i(0,l))}function F(v){n.$$.not_equal(l.description,v)&&(l.description=v,i(0,l))}return n.$$set=v=>{"gjSchemes"in v&&r(i(1,f=v.gjSchemes)),"props"in v&&i(0,l=v.props)},[l,f,t,s,a,o,p,c,_,q,A,F]}class Dt extends J{constructor(e){super(),K(this,e,Wt,Rt,H,{gjSchemes:1,props:0})}}function Gt(n){let e,i,t;function s(r){n[2](r)}let u={label:n[1],choices:[x("New segregated cycling facility"),x("New junction treatment"),x("New permanent footway"),["New shared use facilities","New shared use (walking and cycling) facilities"],["Improvements to existing route","Improvements to make an existing walking/cycle route safer"],["Area-wide traffic management","Area-wide traffic management (including by TROs - both permanent and experimental)"],["Bus priority measures","Bus priority measures that also enable active travel (for example, bus gates)"],["Secure cycle parking","Provision of secure cycle parking facilities"],x("New road crossings"),x("Restriction or reduction of car parking availability"),x("School streets"),x("Quiet mixed traffic streets"),x("Traffic free routes"),x("Not specified in LCWIP")],emptyOption:!0};return n[0]!==void 0&&(u.value=n[0]),e=new Ne({props:u}),L.push(()=>B(e,"value",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),t=!0},p(r,[f]){const l={};f&2&&(l.label=r[1]),!i&&f&1&&(i=!0,l.value=r[0],R(()=>i=!1)),e.$set(l)},i(r){t||(d(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function x(n){return[n,n]}function Jt(n,e,i){let{label:t}=e,{value:s}=e;function u(r){s=r,i(0,s)}return n.$$set=r=>{"label"in r&&i(1,t=r.label),"value"in r&&i(0,s=r.value)},[s,t,u]}class lt extends J{constructor(e){super(),K(this,e,Jt,Gt,H,{label:1,value:0})}}function Kt(n){let e,i,t,s,u,r,f,l,a,o,p,c,_,q,A,F,v,k;function M(P){n[3](P)}let O={label:"Status",choices:[["","Unknown"],["aspiration","Aspiration"],["planned","Planned"],["in development","In development"],["in construction","In construction"],["completed","Completed"]],inlineSmall:!0,required:n[1]};n[0].status!==void 0&&(O.value=n[0].status),s=new pe({props:O}),L.push(()=>B(s,"value",M));function m(P){n[4](P)}let g={label:"Timescale",choices:[["","Unknown"],["short","Short (1-3 years)"],["medium","Medium (3-6 years)"],["long","Long (6-10 years)"]],inlineSmall:!0,required:n[1]};n[0].timescale!==void 0&&(g.value=n[0].timescale),f=new pe({props:g}),L.push(()=>B(f,"value",m));function I(P){n[5](P)}let U={label:"Estimated completion year (if known)",width:4,min:2010,max:2100};n[0].timescale_year!==void 0&&(U.value=n[0].timescale_year),o=new Se({props:U}),L.push(()=>B(o,"value",I));function Q(P){n[6](P)}let Z={label:"What year was this scheme most recently published?",width:4,min:2010,max:2100};n[0].year_published!==void 0&&(Z.value=n[0].year_published),_=new Se({props:Z}),L.push(()=>B(_,"value",Q));function X(P){n[7](P)}let C={label:"What year was this scheme most recently consulted on?",width:4,min:2010,max:2100};return n[0].year_consulted!==void 0&&(C.value=n[0].year_consulted),F=new Se({props:C}),L.push(()=>B(F,"value",X)),{c(){e=G("fieldset"),i=G("legend"),i.textContent="Timing and status",t=N(),y(s.$$.fragment),r=N(),y(f.$$.fragment),a=N(),y(o.$$.fragment),c=N(),y(_.$$.fragment),A=N(),y(F.$$.fragment),T(i,"class","govuk-fieldset__legend"),T(e,"class","govuk-fieldset svelte-1bxyfcq")},m(P,w){$(P,e,w),E(e,i),E(e,t),S(s,e,null),E(e,r),S(f,e,null),E(e,a),S(o,e,null),E(e,c),S(_,e,null),E(e,A),S(F,e,null),k=!0},p(P,[w]){const W={};w&2&&(W.required=P[1]),!u&&w&1&&(u=!0,W.value=P[0].status,R(()=>u=!1)),s.$set(W);const Y={};w&2&&(Y.required=P[1]),!l&&w&1&&(l=!0,Y.value=P[0].timescale,R(()=>l=!1)),f.$set(Y);const ee={};!p&&w&1&&(p=!0,ee.value=P[0].timescale_year,R(()=>p=!1)),o.$set(ee);const te={};!q&&w&1&&(q=!0,te.value=P[0].year_published,R(()=>q=!1)),_.$set(te);const ce={};!v&&w&1&&(v=!0,ce.value=P[0].year_consulted,R(()=>v=!1)),F.$set(ce)},i(P){k||(d(s.$$.fragment,P),d(f.$$.fragment,P),d(o.$$.fragment,P),d(_.$$.fragment,P),d(F.$$.fragment,P),k=!0)},o(P){h(s.$$.fragment,P),h(f.$$.fragment,P),h(o.$$.fragment,P),h(_.$$.fragment,P),h(F.$$.fragment,P),k=!1},d(P){P&&b(e),j(s),j(f),j(o),j(_),j(F)}}}function Ht(n,e,i){let{data:t}=e,{required:s}=e,{onUpdate:u}=e;function r(c){u()}function f(c){n.$$.not_equal(t.status,c)&&(t.status=c,i(0,t))}function l(c){n.$$.not_equal(t.timescale,c)&&(t.timescale=c,i(0,t))}function a(c){n.$$.not_equal(t.timescale_year,c)&&(t.timescale_year=c,i(0,t))}function o(c){n.$$.not_equal(t.year_published,c)&&(t.year_published=c,i(0,t))}function p(c){n.$$.not_equal(t.year_consulted,c)&&(t.year_consulted=c,i(0,t))}return n.$$set=c=>{"data"in c&&i(0,t=c.data),"required"in c&&i(1,s=c.required),"onUpdate"in c&&i(2,u=c.onUpdate)},n.$$.update=()=>{n.$$.dirty&1&&r()},[t,s,u,f,l,a,o,p]}class ut extends J{constructor(e){super(),K(this,e,Ht,Kt,H,{data:0,required:1,onUpdate:2})}}function We(n,e,i){const t=n.slice();return t[9]=e[i],t[10]=e,t[11]=i,t}function Qt(n){let e;return{c(){e=D("Is the development fully funded?")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function Zt(n){let e;return{c(){e=D("Is the construction fully funded?")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function zt(n){let e,i,t;function s(r){n[6](r,n[9])}let u={$$slots:{default:[Vt]},$$scope:{ctx:n}};return n[0].funding_sources[n[9]]!==void 0&&(u.checked=n[0].funding_sources[n[9]]),e=new me({props:u}),L.push(()=>B(e,"checked",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),t=!0},p(r,f){n=r;const l={};f&4096&&(l.$$scope={dirty:f,ctx:n}),!i&&f&3&&(i=!0,l.checked=n[0].funding_sources[n[9]],R(()=>i=!1)),e.$set(l)},i(r){t||(d(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function Vt(n){let e=n[9].toUpperCase()+"",i,t;return{c(){i=D(e),t=N()},m(s,u){$(s,i,u),$(s,t,u)},p:de,d(s){s&&(b(i),b(t))}}}function De(n){let e,i,t=n[9]!="other"&&zt(n);return{c(){t&&t.c(),e=ie()},m(s,u){t&&t.m(s,u),$(s,e,u),i=!0},p(s,u){s[9]!="other"&&t.p(s,u)},i(s){i||(d(t),i=!0)},o(s){h(t),i=!1},d(s){s&&b(e),t&&t.d(s)}}}function Xt(n){let e,i,t=ge(n[1]),s=[];for(let r=0;r<t.length;r+=1)s[r]=De(We(n,t,r));const u=r=>h(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=ie()},m(r,f){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(r,f);$(r,e,f),i=!0},p(r,f){if(f&3){t=ge(r[1]);let l;for(l=0;l<t.length;l+=1){const a=We(r,t,l);s[l]?(s[l].p(a,f),d(s[l],1)):(s[l]=De(a),s[l].c(),d(s[l],1),s[l].m(e.parentNode,e))}for(se(),l=t.length;l<s.length;l+=1)u(l);re()}},i(r){if(!i){for(let f=0;f<t.length;f+=1)d(s[f]);i=!0}},o(r){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)h(s[f]);i=!1},d(r){r&&b(e),it(s,r)}}}function Yt(n){let e,i,t,s,u,r,f,l,a,o,p,c,_,q,A,F,v,k,M;function O(C){n[3](C)}let m={label:"Cost (GBP)"};n[0].budget!==void 0&&(m.value=n[0].budget),s=new jt({props:m}),L.push(()=>B(s,"value",O));function g(C){n[4](C)}let I={$$slots:{default:[Qt]},$$scope:{ctx:n}};n[0].development_funded!==void 0&&(I.checked=n[0].development_funded),f=new me({props:I}),L.push(()=>B(f,"checked",g));function U(C){n[5](C)}let Q={$$slots:{default:[Zt]},$$scope:{ctx:n}};n[0].construction_funded!==void 0&&(Q.checked=n[0].construction_funded),o=new me({props:Q}),L.push(()=>B(o,"checked",U)),A=new _t({props:{$$slots:{default:[Xt]},$$scope:{ctx:n}}});function Z(C){n[7](C)}let X={label:"Other funding sources"};return n[0].funding_sources.other!==void 0&&(X.value=n[0].funding_sources.other),v=new Pe({props:X}),L.push(()=>B(v,"value",Z)),{c(){e=G("fieldset"),i=G("legend"),i.textContent="Budget",t=N(),y(s.$$.fragment),r=N(),y(f.$$.fragment),a=N(),y(o.$$.fragment),c=N(),_=G("p"),_.textContent="Funding sources",q=N(),y(A.$$.fragment),F=N(),y(v.$$.fragment),T(i,"class","govuk-fieldset__legend"),T(e,"class","govuk-fieldset svelte-1bxyfcq")},m(C,P){$(C,e,P),E(e,i),E(e,t),S(s,e,null),E(e,r),S(f,e,null),E(e,a),S(o,e,null),E(e,c),E(e,_),E(e,q),S(A,e,null),E(e,F),S(v,e,null),M=!0},p(C,[P]){const w={};!u&&P&1&&(u=!0,w.value=C[0].budget,R(()=>u=!1)),s.$set(w);const W={};P&4096&&(W.$$scope={dirty:P,ctx:C}),!l&&P&1&&(l=!0,W.checked=C[0].development_funded,R(()=>l=!1)),f.$set(W);const Y={};P&4096&&(Y.$$scope={dirty:P,ctx:C}),!p&&P&1&&(p=!0,Y.checked=C[0].construction_funded,R(()=>p=!1)),o.$set(Y);const ee={};P&4097&&(ee.$$scope={dirty:P,ctx:C}),A.$set(ee);const te={};!k&&P&1&&(k=!0,te.value=C[0].funding_sources.other,R(()=>k=!1)),v.$set(te)},i(C){M||(d(s.$$.fragment,C),d(f.$$.fragment,C),d(o.$$.fragment,C),d(A.$$.fragment,C),d(v.$$.fragment,C),M=!0)},o(C){h(s.$$.fragment,C),h(f.$$.fragment,C),h(o.$$.fragment,C),h(A.$$.fragment,C),h(v.$$.fragment,C),M=!1},d(C){C&&b(e),j(s),j(f),j(o),j(A),j(v)}}}function xt(n,e,i){let{data:t}=e,{onUpdate:s}=e;function u(c){s()}let r=["atf2","atf3","atf4","atf4e","crsts","luf"];function f(c){n.$$.not_equal(t.budget,c)&&(t.budget=c,i(0,t))}function l(c){n.$$.not_equal(t.development_funded,c)&&(t.development_funded=c,i(0,t))}function a(c){n.$$.not_equal(t.construction_funded,c)&&(t.construction_funded=c,i(0,t))}function o(c,_){n.$$.not_equal(t.funding_sources[_],c)&&(t.funding_sources[_]=c,i(0,t))}function p(c){n.$$.not_equal(t.funding_sources.other,c)&&(t.funding_sources.other=c,i(0,t))}return n.$$set=c=>{"data"in c&&i(0,t=c.data),"onUpdate"in c&&i(2,s=c.onUpdate)},n.$$.update=()=>{n.$$.dirty&1&&u()},[t,r,s,f,l,a,o,p]}class ot extends J{constructor(e){super(),K(this,e,xt,Yt,H,{data:0,onUpdate:2})}}function Ge(n){let e,i;return e=new oe({props:{disabled:!n[2],$$slots:{default:[en]},$$scope:{ctx:n}}}),e.$on("click",n[8]),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,s){const u={};s&4&&(u.disabled=!t[2]),s&65536&&(u.$$scope={dirty:s,ctx:t}),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function en(n){let e;return{c(){e=D("Auto-fill with street names")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function tn(n){let e,i,t,s,u,r,f,l,a=n[0].length_meters&&Ge(n);return{c(){e=G("div"),e.textContent="Use the name from the LCWIP if possible",i=N(),t=G("input"),s=N(),a&&a.c(),u=ie(),T(e,"class","govuk-hint"),T(t,"type","text"),T(t,"class","govuk-input"),T(t,"id",n[6])},m(o,p){$(o,e,p),$(o,i,p),$(o,t,p),z(t,n[0].name),$(o,s,p),a&&a.m(o,p),$(o,u,p),r=!0,f||(l=V(t,"input",n[7]),f=!0)},p(o,p){p&1&&t.value!==o[0].name&&z(t,o[0].name),o[0].length_meters?a?(a.p(o,p),p&1&&d(a,1)):(a=Ge(o),a.c(),d(a,1),a.m(u.parentNode,u)):a&&(se(),h(a,1,1,()=>{a=null}),re())},i(o){r||(d(a),r=!0)},o(o){h(a),r=!1},d(o){o&&(b(e),b(i),b(t),b(s),b(u)),a&&a.d(o),f=!1,l()}}}function Je(n){let e,i,t=he(n[0].length_meters)+"",s;return{c(){e=G("p"),i=D("Length: "),s=D(t)},m(u,r){$(u,e,r),E(e,i),E(e,s)},p(u,r){r&1&&t!==(t=he(u[0].length_meters)+"")&&fe(s,t)},d(u){u&&b(e)}}}function Ke(n){let e,i,t,s,u,r,f,l,a,o,p,c,_,q;function A(g){n[12](g)}let F={label:"Type"};n[0].pipeline.atf4_type!==void 0&&(F.value=n[0].pipeline.atf4_type),e=new lt({props:F}),L.push(()=>B(e,"value",A));function v(g){n[13](g)}let k={label:"Accuracy of mapped data",choices:[["high","High"],["medium","Medium"],["low","Low"]],required:!0,inlineSmall:!0};n[0].pipeline.accuracy!==void 0&&(k.value=n[0].pipeline.accuracy),s=new pe({props:k}),L.push(()=>B(s,"value",v));function M(g){n[14](g)}let O={$$slots:{default:[nn]},$$scope:{ctx:n}};n[0].pipeline.is_alternative!==void 0&&(O.checked=n[0].pipeline.is_alternative),f=new me({props:O}),L.push(()=>B(f,"checked",M));let m=n[4]&&n[0].is_coverage_polygon!==void 0&&He(n);return p=new ut({props:{data:n[0].pipeline,required:!1,onUpdate:ln}}),_=new ot({props:{data:n[0].pipeline,onUpdate:un}}),{c(){y(e.$$.fragment),t=N(),y(s.$$.fragment),r=N(),y(f.$$.fragment),a=N(),m&&m.c(),o=N(),y(p.$$.fragment),c=N(),y(_.$$.fragment)},m(g,I){S(e,g,I),$(g,t,I),S(s,g,I),$(g,r,I),S(f,g,I),$(g,a,I),m&&m.m(g,I),$(g,o,I),S(p,g,I),$(g,c,I),S(_,g,I),q=!0},p(g,I){const U={};!i&&I&1&&(i=!0,U.value=g[0].pipeline.atf4_type,R(()=>i=!1)),e.$set(U);const Q={};!u&&I&1&&(u=!0,Q.value=g[0].pipeline.accuracy,R(()=>u=!1)),s.$set(Q);const Z={};I&65536&&(Z.$$scope={dirty:I,ctx:g}),!l&&I&1&&(l=!0,Z.checked=g[0].pipeline.is_alternative,R(()=>l=!1)),f.$set(Z),g[4]&&g[0].is_coverage_polygon!==void 0?m?(m.p(g,I),I&1&&d(m,1)):(m=He(g),m.c(),d(m,1),m.m(o.parentNode,o)):m&&(se(),h(m,1,1,()=>{m=null}),re());const X={};I&1&&(X.data=g[0].pipeline),p.$set(X);const C={};I&1&&(C.data=g[0].pipeline),_.$set(C)},i(g){q||(d(e.$$.fragment,g),d(s.$$.fragment,g),d(f.$$.fragment,g),d(m),d(p.$$.fragment,g),d(_.$$.fragment,g),q=!0)},o(g){h(e.$$.fragment,g),h(s.$$.fragment,g),h(f.$$.fragment,g),h(m),h(p.$$.fragment,g),h(_.$$.fragment,g),q=!1},d(g){g&&(b(t),b(r),b(a),b(o),b(c)),j(e,g),j(s,g),j(f,g),m&&m.d(g),j(p,g),j(_,g)}}}function nn(n){let e;return{c(){e=D("Is this an alternative route and not the default option?")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function He(n){let e,i,t;function s(r){n[15](r)}let u={$$slots:{default:[sn]},$$scope:{ctx:n}};return n[0].is_coverage_polygon!==void 0&&(u.checked=n[0].is_coverage_polygon),e=new me({props:u}),L.push(()=>B(e,"checked",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),t=!0},p(r,f){const l={};f&65536&&(l.$$scope={dirty:f,ctx:r}),!i&&f&1&&(i=!0,l.checked=r[0].is_coverage_polygon,R(()=>i=!1)),e.$set(l)},i(r){t||(d(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function sn(n){let e;return{c(){e=D(`Does this polygon show the coverage of the scheme? (All area considered
      while making the scheme)`)},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function rn(n){let e,i,t,s,u,r,f,l,a,o,p;e=new ae({props:{label:"Name",id:n[6],$$slots:{default:[tn]},$$scope:{ctx:n}}});function c(k){n[10](k)}let _={label:"Scheme",choices:Object.values(n[3].schemes).map(n[9])};n[0].scheme_reference!==void 0&&(_.value=n[0].scheme_reference),t=new Ne({props:_}),L.push(()=>B(t,"value",c));function q(k){n[11](k)}let A={label:"Description"};n[0].description!==void 0&&(A.value=n[0].description),r=new Fe({props:A}),L.push(()=>B(r,"value",q));let F=n[0].length_meters&&Je(n),v=n[0].pipeline&&Ke(n);return{c(){y(e.$$.fragment),i=N(),y(t.$$.fragment),u=N(),y(r.$$.fragment),l=N(),F&&F.c(),a=N(),v&&v.c(),o=ie()},m(k,M){S(e,k,M),$(k,i,M),S(t,k,M),$(k,u,M),S(r,k,M),$(k,l,M),F&&F.m(k,M),$(k,a,M),v&&v.m(k,M),$(k,o,M),p=!0},p(k,[M]){const O={};M&65541&&(O.$$scope={dirty:M,ctx:k}),e.$set(O);const m={};M&8&&(m.choices=Object.values(k[3].schemes).map(k[9])),!s&&M&1&&(s=!0,m.value=k[0].scheme_reference,R(()=>s=!1)),t.$set(m);const g={};!f&&M&1&&(f=!0,g.value=k[0].description,R(()=>f=!1)),r.$set(g),k[0].length_meters?F?F.p(k,M):(F=Je(k),F.c(),F.m(a.parentNode,a)):F&&(F.d(1),F=null),k[0].pipeline?v?(v.p(k,M),M&1&&d(v,1)):(v=Ke(k),v.c(),d(v,1),v.m(o.parentNode,o)):v&&(se(),h(v,1,1,()=>{v=null}),re())},i(k){p||(d(e.$$.fragment,k),d(t.$$.fragment,k),d(r.$$.fragment,k),d(v),p=!0)},o(k){h(e.$$.fragment,k),h(t.$$.fragment,k),h(r.$$.fragment,k),h(v),p=!1},d(k){k&&(b(i),b(u),b(l),b(a),b(o)),j(e,k),j(t,k),j(r,k),F&&F.d(k),v&&v.d(k)}}}const ln=()=>{},un=()=>{};function on(n,e,i){let t,s,u=de,r=()=>(u(),u=ke(f,m=>i(3,s=m)),f);ve(n,nt,m=>i(2,t=m)),n.$$.on_destroy.push(()=>u());let{gjSchemes:f}=e;r();let{props:l}=e;l.pipeline||(l.pipeline={atf4_type:"",accuracy:"",is_alternative:!1,development_funded:!1,construction_funded:!1,funding_sources:be(),status:"",timescale:""}),l.is_coverage_polygon||(l.is_coverage_polygon=!1);const a=(s.features.filter(m=>m.properties.is_coverage_polygon).length==0||l.is_coverage_polygon===!0)&&l.intervention_type==="area";function o(){try{i(0,l.name=t.inner.routeNameForWaypoints(l.waypoints),l)}catch(m){window.alert(`Couldn't auto-name route: ${m}`)}}let p=ue();function c(){l.name=this.value,i(0,l)}const _=()=>o(),q=m=>[m.scheme_reference,Me(m)];function A(m){n.$$.not_equal(l.scheme_reference,m)&&(l.scheme_reference=m,i(0,l))}function F(m){n.$$.not_equal(l.description,m)&&(l.description=m,i(0,l))}function v(m){n.$$.not_equal(l.pipeline.atf4_type,m)&&(l.pipeline.atf4_type=m,i(0,l))}function k(m){n.$$.not_equal(l.pipeline.accuracy,m)&&(l.pipeline.accuracy=m,i(0,l))}function M(m){n.$$.not_equal(l.pipeline.is_alternative,m)&&(l.pipeline.is_alternative=m,i(0,l))}function O(m){n.$$.not_equal(l.is_coverage_polygon,m)&&(l.is_coverage_polygon=m,i(0,l))}return n.$$set=m=>{"gjSchemes"in m&&r(i(1,f=m.gjSchemes)),"props"in m&&i(0,l=m.props)},[l,f,t,s,a,o,p,c,_,q,A,F,v,k,M,O]}class fn extends J{constructor(e){super(),K(this,e,on,rn,H,{gjSchemes:1,props:0})}}function Qe(n,e,i){const t=n.slice();return t[9]=e[i][0],t[10]=e[i][1],t}function Ze(n){let e,i;return e=new oe({props:{$$slots:{default:[an]},$$scope:{ctx:n}}}),e.$on("click",n[6]),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,s){const u={};s&8192&&(u.$$scope={dirty:s,ctx:t}),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function an(n){let e;return{c(){e=D("Handle extra GeoJSON properties")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function ze(n){let e,i,t=n[9]+"",s,u,r=JSON.stringify(n[10])+"",f,l;return{c(){e=G("li"),i=G("b"),s=D(t),u=D(`
        = `),f=D(r),l=N()},m(a,o){$(a,e,o),E(e,i),E(i,s),E(e,u),E(e,f),E(e,l)},p(a,o){o&2&&t!==(t=a[9]+"")&&fe(s,t),o&2&&r!==(r=JSON.stringify(a[10])+"")&&fe(f,r)},d(a){a&&b(e)}}}function cn(n){let e;return{c(){e=D("Remove these properties")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function pn(n){let e;return{c(){e=D("Cancel")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function mn(n){let e,i,t,s;return e=new Et({props:{$$slots:{default:[cn]},$$scope:{ctx:n}}}),e.$on("click",n[2]),t=new oe({props:{$$slots:{default:[pn]},$$scope:{ctx:n}}}),t.$on("click",n[7]),{c(){y(e.$$.fragment),i=N(),y(t.$$.fragment)},m(u,r){S(e,u,r),$(u,i,r),S(t,u,r),s=!0},p(u,r){const f={};r&8192&&(f.$$scope={dirty:r,ctx:u}),e.$set(f);const l={};r&8192&&(l.$$scope={dirty:r,ctx:u}),t.$set(l)},i(u){s||(d(e.$$.fragment,u),d(t.$$.fragment,u),s=!0)},o(u){h(e.$$.fragment,u),h(t.$$.fragment,u),s=!1},d(u){u&&b(i),j(e,u),j(t,u)}}}function _n(n){let e,i,t,s,u,r,f=ge(Object.entries(n[1])),l=[];for(let a=0;a<f.length;a+=1)l[a]=ze(Qe(n,f,a));return u=new vt({props:{$$slots:{default:[mn]},$$scope:{ctx:n}}}),{c(){e=G("p"),e.textContent="The unexpected properties:",i=N(),t=G("ul");for(let a=0;a<l.length;a+=1)l[a].c();s=N(),y(u.$$.fragment)},m(a,o){$(a,e,o),$(a,i,o),$(a,t,o);for(let p=0;p<l.length;p+=1)l[p]&&l[p].m(t,null);$(a,s,o),S(u,a,o),r=!0},p(a,o){if(o&2){f=ge(Object.entries(a[1]));let c;for(c=0;c<f.length;c+=1){const _=Qe(a,f,c);l[c]?l[c].p(_,o):(l[c]=ze(_),l[c].c(),l[c].m(t,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=f.length}const p={};o&8193&&(p.$$scope={dirty:o,ctx:a}),u.$set(p)},i(a){r||(d(u.$$.fragment,a),r=!0)},o(a){h(u.$$.fragment,a),r=!1},d(a){a&&(b(e),b(i),b(t),b(s)),it(l,a),j(u,a)}}}function dn(n){let e=Object.entries(n[1]).length>0,i,t,s,u,r=e&&Ze(n);function f(a){n[8](a)}let l={title:"This imported GeoJSON feature has unexpected properties",$$slots:{default:[_n]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.open=n[0]),t=new qe({props:l}),L.push(()=>B(t,"open",f)),{c(){r&&r.c(),i=N(),y(t.$$.fragment)},m(a,o){r&&r.m(a,o),$(a,i,o),S(t,a,o),u=!0},p(a,[o]){o&2&&(e=Object.entries(a[1]).length>0),e?r?(r.p(a,o),o&2&&d(r,1)):(r=Ze(a),r.c(),d(r,1),r.m(i.parentNode,i)):r&&(se(),h(r,1,1,()=>{r=null}),re());const p={};o&8195&&(p.$$scope={dirty:o,ctx:a}),!s&&o&1&&(s=!0,p.open=a[0],R(()=>s=!1)),t.$set(p)},i(a){u||(d(r),d(t.$$.fragment,a),u=!0)},o(a){h(r),h(t.$$.fragment,a),u=!1},d(a){a&&b(i),r&&r.d(a),j(t,a)}}}function gn(n,e,i){let t,{gjSchemes:s}=e,{id:u}=e,{props:r}=e,f=!1;function l(){i(0,f=!1),s.update(c=>{let _=c.features.find(q=>q.id==u);for(let q of Object.keys(t))delete _.properties[q];return c})}const a=()=>i(0,f=!0),o=()=>i(0,f=!1);function p(c){f=c,i(0,f)}return n.$$set=c=>{"gjSchemes"in c&&i(3,s=c.gjSchemes),"id"in c&&i(4,u=c.id),"props"in c&&i(5,r=c.props)},n.$$.update=()=>{n.$$.dirty&32&&i(1,t=at(r))},[f,t,l,s,u,r,a,o,p]}class hn extends J{constructor(e){super(),K(this,e,gn,dn,H,{gjSchemes:3,id:4,props:5})}}function $n(n){let e,i,t;function s(r){n[6](r)}let u={gjSchemes:n[1]};return n[0]!==void 0&&(u.props=n[0]),e=new fn({props:u}),L.push(()=>B(e,"props",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),t=!0},p(r,f){const l={};f&2&&(l.gjSchemes=r[1]),!i&&f&1&&(i=!0,l.props=r[0],R(()=>i=!1)),e.$set(l)},i(r){t||(d(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function bn(n){let e,i,t;function s(r){n[5](r)}let u={gjSchemes:n[1]};return n[0]!==void 0&&(u.props=n[0]),e=new Dt({props:u}),L.push(()=>B(e,"props",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),t=!0},p(r,f){const l={};f&2&&(l.gjSchemes=r[1]),!i&&f&1&&(i=!0,l.props=r[0],R(()=>i=!1)),e.$set(l)},i(r){t||(d(e.$$.fragment,r),t=!0)},o(r){h(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function vn(n){let e,i,t,s,u,r;e=new hn({props:{gjSchemes:n[1],id:n[2],props:n[0]}});const f=[bn,$n],l=[];function a(o,p){return o[3]=="v1"?0:o[3]=="pipeline"?1:-1}return~(t=a(n))&&(s=l[t]=f[t](n)),{c(){y(e.$$.fragment),i=N(),s&&s.c(),u=ie()},m(o,p){S(e,o,p),$(o,i,p),~t&&l[t].m(o,p),$(o,u,p),r=!0},p(o,[p]){const c={};p&2&&(c.gjSchemes=o[1]),p&4&&(c.id=o[2]),p&1&&(c.props=o[0]),e.$set(c);let _=t;t=a(o),t===_?~t&&l[t].p(o,p):(s&&(se(),h(l[_],1,1,()=>{l[_]=null}),re()),~t?(s=l[t],s?s.p(o,p):(s=l[t]=f[t](o),s.c()),d(s,1),s.m(u.parentNode,u)):s=null)},i(o){r||(d(e.$$.fragment,o),d(s),r=!0)},o(o){h(e.$$.fragment,o),h(s),r=!1},d(o){o&&(b(i),b(u)),j(e,o),~t&&l[t].d(o)}}}function kn(n,e,i){let t;ve(n,ne,o=>i(3,t=o));let{cfg:s}=e,{gjSchemes:u}=e,{id:r}=e,{props:f}=e;function l(o){f=o,i(0,f)}function a(o){f=o,i(0,f)}return n.$$set=o=>{"cfg"in o&&i(4,s=o.cfg),"gjSchemes"in o&&i(1,u=o.gjSchemes),"id"in o&&i(2,r=o.id),"props"in o&&i(0,f=o.props)},[f,u,r,t,s,l,a]}class wn extends J{constructor(e){super(),K(this,e,kn,vn,H,{cfg:4,gjSchemes:1,id:2,props:0})}}function yn(n){let e;return{c(){e=D("Scheme details")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function Sn(n){let e;return{c(){e=D("Save")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function jn(n){let e,i,t,s,u;function r(l){n[6](l)}let f={label:"Scheme name",required:!0};return n[3].schemes[n[1]].scheme_name!==void 0&&(f.value=n[3].schemes[n[1]].scheme_name),e=new Pe({props:f}),L.push(()=>B(e,"value",r)),s=new st({props:{$$slots:{default:[Sn]},$$scope:{ctx:n}}}),s.$on("click",n[7]),{c(){y(e.$$.fragment),t=N(),y(s.$$.fragment)},m(l,a){S(e,l,a),$(l,t,a),S(s,l,a),u=!0},p(l,a){const o={};!i&&a&10&&(i=!0,o.value=l[3].schemes[l[1]].scheme_name,R(()=>i=!1)),e.$set(o);const p={};a&512&&(p.$$scope={dirty:a,ctx:l}),s.$set(p)},i(l){u||(d(e.$$.fragment,l),d(s.$$.fragment,l),u=!0)},o(l){h(e.$$.fragment,l),h(s.$$.fragment,l),u=!1},d(l){l&&b(t),j(e,l),j(s,l)}}}function qn(n){let e,i,t,s,u,r,f;e=new oe({props:{$$slots:{default:[yn]},$$scope:{ctx:n}}}),e.$on("click",n[5]);function l(o){n[8](o)}let a={title:"Scheme details",$$slots:{default:[jn]},$$scope:{ctx:n}};return n[2]!==void 0&&(a.open=n[2]),t=new qe({props:a}),L.push(()=>B(t,"open",l)),{c(){y(e.$$.fragment),i=N(),y(t.$$.fragment)},m(o,p){S(e,o,p),$(o,i,p),S(t,o,p),u=!0,r||(f=V(window,"keydown",n[4]),r=!0)},p(o,[p]){const c={};p&512&&(c.$$scope={dirty:p,ctx:o}),e.$set(c);const _={};p&526&&(_.$$scope={dirty:p,ctx:o}),!s&&p&4&&(s=!0,_.open=o[2],R(()=>s=!1)),t.$set(_)},i(o){u||(d(e.$$.fragment,o),d(t.$$.fragment,o),u=!0)},o(o){h(e.$$.fragment,o),h(t.$$.fragment,o),u=!1},d(o){o&&b(i),j(e,o),j(t,o),r=!1,f()}}}function Nn(n,e,i){let t,s=de,u=()=>(s(),s=ke(r,q=>i(3,t=q)),r);n.$$.on_destroy.push(()=>s());let{gjSchemes:r}=e;u();let{scheme_reference:f}=e,l=!1;function a(q){l&&q.key=="Escape"&&(q.stopPropagation(),i(2,l=!1))}const o=()=>i(2,l=!0);function p(q){n.$$.not_equal(t.schemes[f].scheme_name,q)&&(t.schemes[f].scheme_name=q,r.set(t))}const c=()=>i(2,l=!1);function _(q){l=q,i(2,l)}return n.$$set=q=>{"gjSchemes"in q&&u(i(0,r=q.gjSchemes)),"scheme_reference"in q&&i(1,f=q.scheme_reference)},[r,f,l,t,a,o,p,c,_]}class Fn extends J{constructor(e){super(),K(this,e,Nn,qn,H,{gjSchemes:0,scheme_reference:1})}}function Pn(n){let e;return{c(){e=D("Scheme details")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function Mn(n){let e;return{c(){e=D("Save")},m(i,t){$(i,e,t)},d(i){i&&b(e)}}}function Cn(n){let e,i,t,s,u,r,f,l,a,o,p,c,_,q,A,F,v,k,M,O,m;function g(w){n[9](w)}let I={label:"Scheme name",required:!0};n[6].schemes[n[1]].scheme_name!==void 0&&(I.value=n[6].schemes[n[1]].scheme_name),e=new Pe({props:I}),L.push(()=>B(e,"value",g));function U(w){n[10](w)}let Q={label:"Scheme type",choices:[["cycling route","Cycling route"],["walking route","Walking route"],["shared-use route","Shared-use route"],["cycling and walking route","Cycling and walking route, not shared use"],["area-based scheme","Area-based scheme"],["intersection","Intersection/junction scheme"]],inlineSmall:!0,required:!0};n[3].scheme_type!==void 0&&(Q.value=n[3].scheme_type),f=new pe({props:Q}),L.push(()=>B(f,"value",U));function Z(w){n[11](w)}let X={label:"Type of the main intervention"};n[3].atf4_lead_type!==void 0&&(X.value=n[3].atf4_lead_type),o=new lt({props:X}),L.push(()=>B(o,"value",Z));function C(w){n[12](w)}let P={label:"Scheme description (150 words max)"};return n[3].scheme_description!==void 0&&(P.value=n[3].scheme_description),_=new Fe({props:P}),L.push(()=>B(_,"value",C)),F=new ut({props:{data:n[3],required:!0,onUpdate:n[13]}}),k=new ot({props:{data:n[3],onUpdate:n[14]}}),O=new st({props:{$$slots:{default:[Mn]},$$scope:{ctx:n}}}),O.$on("click",n[15]),{c(){y(e.$$.fragment),t=N(),s=G("fieldset"),u=G("legend"),u.textContent="Basic information",r=N(),y(f.$$.fragment),a=N(),y(o.$$.fragment),c=N(),y(_.$$.fragment),A=N(),y(F.$$.fragment),v=N(),y(k.$$.fragment),M=N(),y(O.$$.fragment),T(u,"class","govuk-fieldset__legend"),T(s,"class","govuk-fieldset svelte-1bxyfcq")},m(w,W){S(e,w,W),$(w,t,W),$(w,s,W),E(s,u),E(s,r),S(f,s,null),E(s,a),S(o,s,null),E(s,c),S(_,s,null),$(w,A,W),S(F,w,W),$(w,v,W),S(k,w,W),$(w,M,W),S(O,w,W),m=!0},p(w,W){const Y={};!i&&W&66&&(i=!0,Y.value=w[6].schemes[w[1]].scheme_name,R(()=>i=!1)),e.$set(Y);const ee={};!l&&W&8&&(l=!0,ee.value=w[3].scheme_type,R(()=>l=!1)),f.$set(ee);const te={};!p&&W&8&&(p=!0,te.value=w[3].atf4_lead_type,R(()=>p=!1)),o.$set(te);const ce={};!q&&W&8&&(q=!0,ce.value=w[3].scheme_description,R(()=>q=!1)),_.$set(ce);const we={};W&8&&(we.data=w[3]),W&16&&(we.onUpdate=w[13]),F.$set(we);const ye={};W&8&&(ye.data=w[3]),W&16&&(ye.onUpdate=w[14]),k.$set(ye);const Ce={};W&524288&&(Ce.$$scope={dirty:W,ctx:w}),O.$set(Ce)},i(w){m||(d(e.$$.fragment,w),d(f.$$.fragment,w),d(o.$$.fragment,w),d(_.$$.fragment,w),d(F.$$.fragment,w),d(k.$$.fragment,w),d(O.$$.fragment,w),m=!0)},o(w){h(e.$$.fragment,w),h(f.$$.fragment,w),h(o.$$.fragment,w),h(_.$$.fragment,w),h(F.$$.fragment,w),h(k.$$.fragment,w),h(O.$$.fragment,w),m=!1},d(w){w&&(b(t),b(s),b(A),b(v),b(M)),j(e,w),j(f),j(o),j(_),j(F,w),j(k,w),j(O,w)}}}function On(n){let e,i,t,s,u,r,f,l,a;e=new _e({props:{errorMessage:n[5]}}),t=new oe({props:{$$slots:{default:[Pn]},$$scope:{ctx:n}}}),t.$on("click",n[8]);function o(c){n[16](c)}let p={title:"Scheme details",$$slots:{default:[Cn]},$$scope:{ctx:n}};return n[2]!==void 0&&(p.open=n[2]),u=new qe({props:p}),L.push(()=>B(u,"open",o)),{c(){y(e.$$.fragment),i=N(),y(t.$$.fragment),s=N(),y(u.$$.fragment)},m(c,_){S(e,c,_),$(c,i,_),S(t,c,_),$(c,s,_),S(u,c,_),f=!0,l||(a=V(window,"keydown",n[7]),l=!0)},p(c,[_]){const q={};_&32&&(q.errorMessage=c[5]),e.$set(q);const A={};_&524288&&(A.$$scope={dirty:_,ctx:c}),t.$set(A);const F={};_&524382&&(F.$$scope={dirty:_,ctx:c}),!r&&_&4&&(r=!0,F.open=c[2],R(()=>r=!1)),u.$set(F)},i(c){f||(d(e.$$.fragment,c),d(t.$$.fragment,c),d(u.$$.fragment,c),f=!0)},o(c){h(e.$$.fragment,c),h(t.$$.fragment,c),h(u.$$.fragment,c),f=!1},d(c){c&&(b(i),b(s)),j(e,c),j(t,c),j(u,c),l=!1,a()}}}function Un(n,e,i){let t,s,u=de,r=()=>(u(),u=ke(f,U=>i(6,s=U)),f);n.$$.on_destroy.push(()=>u());let{gjSchemes:f}=e;r();let{scheme_reference:l}=e,a=!1,o=s.schemes[l].pipeline,p=0;function c(U,Q){return o.scheme_type&&o.status&&o.timescale?"":"Missing some required data"}function _(U){a&&U.key=="Escape"&&(U.stopPropagation(),i(2,a=!1))}function q(){pt(f,s.schemes[l].pipeline=o,s),f.set(s)}const A=()=>i(2,a=!0);function F(U){n.$$.not_equal(s.schemes[l].scheme_name,U)&&(s.schemes[l].scheme_name=U,f.set(s))}function v(U){n.$$.not_equal(o.scheme_type,U)&&(o.scheme_type=U,i(3,o))}function k(U){n.$$.not_equal(o.atf4_lead_type,U)&&(o.atf4_lead_type=U,i(3,o))}function M(U){n.$$.not_equal(o.scheme_description,U)&&(o.scheme_description=U,i(3,o))}const O=()=>i(4,p++,p),m=()=>i(4,p++,p),g=()=>i(2,a=!1);function I(U){a=U,i(2,a)}return n.$$set=U=>{"gjSchemes"in U&&r(i(0,f=U.gjSchemes)),"scheme_reference"in U&&i(1,l=U.scheme_reference)},n.$$.update=()=>{n.$$.dirty&24&&i(5,t=c()),n.$$.dirty&4&&(a||q())},[f,l,a,o,p,t,s,_,A,F,v,k,M,O,m,g,I]}class In extends J{constructor(e){super(),K(this,e,Un,On,H,{gjSchemes:0,scheme_reference:1})}}function Tn(n){let e,i;return e=new Fn({props:{gjSchemes:n[0],scheme_reference:n[1]}}),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,s){const u={};s&1&&(u.gjSchemes=t[0]),s&2&&(u.scheme_reference=t[1]),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function An(n){let e,i;return e=new In({props:{gjSchemes:n[0],scheme_reference:n[1]}}),{c(){y(e.$$.fragment)},m(t,s){S(e,t,s),i=!0},p(t,s){const u={};s&1&&(u.gjSchemes=t[0]),s&2&&(u.scheme_reference=t[1]),e.$set(u)},i(t){i||(d(e.$$.fragment,t),i=!0)},o(t){h(e.$$.fragment,t),i=!1},d(t){j(e,t)}}}function En(n){let e,i,t,s;const u=[An,Tn],r=[];function f(l,a){return l[2]=="pipeline"?0:1}return e=f(n),i=r[e]=u[e](n),{c(){i.c(),t=ie()},m(l,a){r[e].m(l,a),$(l,t,a),s=!0},p(l,[a]){let o=e;e=f(l),e===o?r[e].p(l,a):(se(),h(r[o],1,1,()=>{r[o]=null}),re(),i=r[e],i?i.p(l,a):(i=r[e]=u[e](l),i.c()),d(i,1),i.m(t.parentNode,t))},i(l){s||(d(i),s=!0)},o(l){h(i),s=!1},d(l){l&&b(t),r[e].d(l)}}}function Ln(n,e,i){let t;ve(n,ne,r=>i(2,t=r));let{gjSchemes:s}=e,{scheme_reference:u}=e;return n.$$set=r=>{"gjSchemes"in r&&i(0,s=r.gjSchemes),"scheme_reference"in r&&i(1,u=r.scheme_reference)},[s,u,t]}class Bn extends J{constructor(e){super(),K(this,e,Ln,En,H,{gjSchemes:0,scheme_reference:1})}}let zn={interventionName:Dn,schemeName:Me,backfill:Rn,initializeEmptyScheme:Wn,interventionWarning:Gn,editFeatureForm:wn,editSchemeForm:Bn,newPointFeature:n=>{n.properties.intervention_type="other"},newPolygonFeature:n=>{n.properties.intervention_type="area",n.properties.is_coverage_polygon=!1},newLineStringFeature:n=>{n.properties.intervention_type="route",n.properties.route_name&&(le(ne)!="pipeline"&&(n.properties.name=n.properties.route_name),delete n.properties.route_name)},updateFeature:(n,e)=>{e.properties.route_name&&!n.properties.name&&le(ne)!="pipeline"&&(n.properties.name=e.properties.route_name)},maptilerApiKey:"MZEJTanw3WpxRvt7qDfo",getStreetViewRoadLayerNames:n=>dt(n,le(mt)),layerZorder:gt};function Rn(n){var t,s,u,r,f,l,a,o;let e=le(ne),i=1;for(let p of n.features)p.properties||(p.properties={name:"",scheme_reference:"",description:"",intervention_type:"other",is_coverage_polygon:!1}),e=="pipeline"&&!p.properties.intervention_type&&(p.properties.intervention_type=new Map([["LineString","route"],["Polygon","area"]]).get(p.geometry.type)??"other"),p.geometry.type=="LineString"&&!p.properties.length_meters&&(p.properties.length_meters=ht(p,{units:"kilometers"})*1e3),p.id=i++;if(!n.schemes){let p=ue();n.schemes={},n.schemes[p]={scheme_reference:p,color:Ie()},n.scheme_name&&(n.schemes[p].scheme_name=n.scheme_name,delete n.scheme_name),n.pipeline&&(n.schemes[p].pipeline=n.pipeline,delete n.pipeline);for(let c of n.features)c.properties.scheme_reference=p}for(let p of Object.values(n.schemes)){let c=p;if(c.color??(c.color=Ie()),e=="pipeline"){c.pipeline??(c.pipeline=ft()),(t=c.pipeline).development_funded??(t.development_funded=!1),(s=c.pipeline).construction_funded??(s.construction_funded=!1),(u=c.pipeline).funding_sources??(u.funding_sources=be()),delete c.pipeline.budget_funded,delete c.pipeline.budget_unfunded,delete c.pipeline.funding_source,delete c.pipeline.funded;for(let _ of n.features)_.properties.pipeline&&((r=_.properties.pipeline).development_funded??(r.development_funded=!1),(f=_.properties.pipeline).construction_funded??(f.construction_funded=!1),(l=_.properties.pipeline).funding_sources??(l.funding_sources=be()),(a=_.properties.pipeline).status??(a.status=""),(o=_.properties.pipeline).timescale??(o.timescale=""))}}return n}function Wn(n){let e=n;return le(ne)=="pipeline"&&(e.pipeline=ft()),e}function ft(){return{scheme_type:"",atf4_lead_type:"",scheme_description:"",status:"",timescale:"",development_funded:!1,construction_funded:!1,funding_sources:be()}}function be(){return{atf2:!1,atf3:!1,atf4:!1,atf4e:!1,crsts:!1,luf:!1,other:""}}function Dn(n){if(n.properties.name)return n.properties.name;var e=n.properties.intervention_type;return e=="other"&&(n.geometry.type=="Point"?e="point":n.geometry.type=="LineString"?e="line":e="polygon"),`Untitled ${e}`}function Me(n){return n.scheme_name??"Untitled scheme"}function Gn(n){var t;let e=le(ne);if(!n.properties.name)return"No name";if(!new Set(["route","area","crossing","other"]).has(n.properties.intervention_type))return"No intervention type";if(e=="pipeline"&&!((t=n.properties.pipeline)!=null&&t.accuracy))return"Accuracy not specified";let i=at(n.properties);return Object.entries(i).length>0?`Extra GeoJSON properties: ${Object.keys(i).join(", ")}`:null}function at(n){let e=le(ne),i=JSON.parse(JSON.stringify(n));for(let t of["name","description","intervention_type","length_meters","waypoints","hide_while_editing","is_coverage_polygon","scheme_reference"])delete i[t];if(e=="pipeline"&&i.pipeline){for(let t of["atf4_type","accuracy","is_alternative","budget","development_funded","construction_funded","funding_sources","status","timescale","timescale_year","year_published","year_consulted"])delete i.pipeline[t];Object.entries(i.pipeline).length==0&&delete i.pipeline}return i}export{vt as B,Pe as T,Et as W,Rn as b,zn as c,Qn as d,Le as g,Zn as i,Hn as l};
