import{S as G,i as K,s as z,L as Ze,e as D,b as T,c as $,M as Ye,N as Xe,O as xe,t as d,p as h,d as b,aC as ae,j as y,o as S,u as j,aH as ue,E as _e,f as oe,a as N,az as V,aa as Z,x as W,m as E,G as fe,aA as et,P as tt,a5 as je,aI as Me,a6 as ct,aJ as Ue,g as L,h as B,R as pe,Y as ie,r as J,v as ve,a9 as nt,y as se,q as re,n as de,ai as ke,J as ge,K as it,ay as qe,C as ne,D as st,_ as pt,aK as le,aF as mt}from"./index-fdf52a33.js";import{S as Ne,p as he,a as me,C as _t,g as dt,b as gt,t as ht,r as Ie}from"./colors-2c55fe44.js";function $t(t){let e,i;const n=t[1].default,s=Ze(n,t,t[0],null);return{c(){e=D("div"),s&&s.c(),T(e,"class","govuk-button-group")},m(u,r){$(u,e,r),s&&s.m(e,null),i=!0},p(u,[r]){s&&s.p&&(!i||r&1)&&Ye(s,n,u,u[0],i?xe(n,u[0],r,null):Xe(u[0]),null)},i(u){i||(d(s,u),i=!0)},o(u){h(s,u),i=!1},d(u){u&&b(e),s&&s.d(u)}}}function bt(t,e,i){let{$$slots:n={},$$scope:s}=e;return t.$$set=u=>{"$$scope"in u&&i(0,s=u.$$scope)},[s,n]}class vt extends G{constructor(e){super(),K(this,e,bt,$t,z,{})}}function Te(t){let e,i,n=$e(t[0])+"",s;return{c(){e=D("div"),i=W("Â£"),s=W(n),T(e,"class","govuk-hint")},m(u,r){$(u,e,r),E(e,i),E(e,s)},p(u,r){r&1&&n!==(n=$e(u[0])+"")&&fe(s,n)},d(u){u&&b(e)}}}function kt(t){let e;return{c(){e=W("multiply by 1 million")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function wt(t){let e,i,n,s,u,r,f,l,a;e=new _e({props:{errorMessage:Ae(t[2])}});let o=t[0]!=null&&Te(t);return r=new oe({props:{disabled:t[0]==null||t[0]>1e3,$$slots:{default:[kt]},$$scope:{ctx:t}}}),r.$on("click",t[4]),{c(){y(e.$$.fragment),i=N(),o&&o.c(),n=N(),s=D("input"),u=N(),y(r.$$.fragment),T(s,"type","text"),T(s,"inputmode","numeric"),T(s,"class","govuk-input govuk-input--width-10"),T(s,"id",t[3])},m(p,c){S(e,p,c),$(p,i,c),o&&o.m(p,c),$(p,n,c),$(p,s,c),V(s,t[2]),$(p,u,c),S(r,p,c),f=!0,l||(a=Z(s,"input",t[5]),l=!0)},p(p,c){const _={};c&4&&(_.errorMessage=Ae(p[2])),e.$set(_),p[0]!=null?o?o.p(p,c):(o=Te(p),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null),c&4&&s.value!==p[2]&&V(s,p[2]);const q={};c&1&&(q.disabled=p[0]==null||p[0]>1e3),c&128&&(q.$$scope={dirty:c,ctx:p}),r.$set(q)},i(p){f||(d(e.$$.fragment,p),d(r.$$.fragment,p),f=!0)},o(p){h(e.$$.fragment,p),h(r.$$.fragment,p),f=!1},d(p){p&&(b(i),b(n),b(s),b(u)),j(e,p),o&&o.d(p),j(r,p),l=!1,a()}}}function yt(t){let e,i;return e=new ae({props:{label:t[1],id:t[3],$$slots:{default:[wt]},$$scope:{ctx:t}}}),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,[s]){const u={};s&2&&(u.label=n[1]),s&133&&(u.$$scope={dirty:s,ctx:n}),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function rt(t){if(t!="")return parseFloat(t.replaceAll(",",""))}function Ae(t){let e=rt(t);return e==null?"":isNaN(e)?"Please enter a valid number":e<0?"Please enter a positive number":""}function $e(t){return t.toLocaleString()}function St(t,e,i){let{label:n}=e,{value:s}=e,u=ue(),r=s==null?"":$e(s);function f(o){i(0,s=rt(o))}function l(){i(2,r=$e(s*1e6))}function a(){r=this.value,i(2,r)}return t.$$set=o=>{"label"in o&&i(1,n=o.label),"value"in o&&i(0,s=o.value)},t.$$.update=()=>{t.$$.dirty&4&&f(r)},[s,n,r,u,l,a]}class jt extends G{constructor(e){super(),K(this,e,St,yt,z,{label:1,value:0})}}function qt(t){let e,i,n,s,u,r,f;return e=new _e({props:{errorMessage:t[5](t[2])}}),{c(){y(e.$$.fragment),i=N(),n=D("input"),T(n,"type","text"),T(n,"inputmode","numeric"),T(n,"class",s=`govuk-input govuk-input--width-${t[1]}`),T(n,"id",t[3])},m(l,a){S(e,l,a),$(l,i,a),$(l,n,a),V(n,t[2]),u=!0,r||(f=[Z(n,"input",t[9]),Z(n,"change",t[4])],r=!0)},p(l,a){const o={};a&4&&(o.errorMessage=l[5](l[2])),e.$set(o),(!u||a&2&&s!==(s=`govuk-input govuk-input--width-${l[1]}`))&&T(n,"class",s),a&4&&n.value!==l[2]&&V(n,l[2])},i(l){u||(d(e.$$.fragment,l),u=!0)},o(l){h(e.$$.fragment,l),u=!1},d(l){l&&(b(i),b(n)),j(e,l),r=!1,et(f)}}}function Nt(t){let e,i;return e=new ae({props:{label:t[0],id:t[3],$$slots:{default:[qt]},$$scope:{ctx:t}}}),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,[s]){const u={};s&1&&(u.label=n[0]),s&1030&&(u.$$scope={dirty:s,ctx:n}),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function Ft(t,e,i){let{label:n}=e,{value:s}=e,{width:u}=e,{min:r=void 0}=e,{max:f=void 0}=e,l=s==null?void 0:s.toString(),a=ue();function o(){i(6,s=l==null?void 0:parseInt(l,10))}function p(_){if(_==""||_==null)return"";if(_.includes("."))return"Please enter a number without decimals";let q=Number(_);return isNaN(q)?"Please enter a valid number":r!=null&&q<r?`Please enter a number that's at least ${r};`:f!=null&&q>f?`Please enter a number that's at most ${f};`:""}function c(){l=this.value,i(2,l)}return t.$$set=_=>{"label"in _&&i(0,n=_.label),"value"in _&&i(6,s=_.value),"width"in _&&i(1,u=_.width),"min"in _&&i(7,r=_.min),"max"in _&&i(8,f=_.max)},[n,u,l,a,o,p,s,r,f,c]}class Se extends G{constructor(e){super(),K(this,e,Ft,Nt,z,{label:0,value:6,width:1,min:7,max:8})}}function Ee(t){let e,i;return{c(){e=D("div"),i=W(t[2]),T(e,"class","govuk-hint")},m(n,s){$(n,e,s),E(e,i)},p(n,s){s&4&&fe(i,n[2])},d(n){n&&b(e)}}}function Ct(t){let e,i,n,s,u,r,f;e=new _e({props:{errorMessage:t[4]}});let l=t[2]&&Ee(t);return{c(){y(e.$$.fragment),i=N(),l&&l.c(),n=N(),s=D("textarea"),T(s,"class","govuk-textarea"),T(s,"id",t[5]),T(s,"rows",t[3])},m(a,o){S(e,a,o),$(a,i,o),l&&l.m(a,o),$(a,n,o),$(a,s,o),V(s,t[0]),u=!0,r||(f=Z(s,"input",t[6]),r=!0)},p(a,o){const p={};o&16&&(p.errorMessage=a[4]),e.$set(p),a[2]?l?l.p(a,o):(l=Ee(a),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null),(!u||o&8)&&T(s,"rows",a[3]),o&1&&V(s,a[0])},i(a){u||(d(e.$$.fragment,a),u=!0)},o(a){h(e.$$.fragment,a),u=!1},d(a){a&&(b(i),b(n),b(s)),j(e,a),l&&l.d(a),r=!1,f()}}}function Ot(t){let e,i;return e=new ae({props:{label:t[1],id:t[5],$$slots:{default:[Ct]},$$scope:{ctx:t}}}),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,[s]){const u={};s&2&&(u.label=n[1]),s&157&&(u.$$scope={dirty:s,ctx:n}),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function Pt(t,e,i){let{label:n}=e,{hint:s=""}=e,{value:u}=e,{rows:r=5}=e,{errorMessage:f=""}=e,l=ue();function a(){u=this.value,i(0,u)}return t.$$set=o=>{"label"in o&&i(1,n=o.label),"hint"in o&&i(2,s=o.hint),"value"in o&&i(0,u=o.value),"rows"in o&&i(3,r=o.rows),"errorMessage"in o&&i(4,f=o.errorMessage)},[u,n,s,r,f,l,a]}class Fe extends G{constructor(e){super(),K(this,e,Pt,Ot,z,{label:1,hint:2,value:0,rows:3,errorMessage:4})}}function Mt(t){let e,i,n,s,u,r;return e=new _e({props:{errorMessage:t[2]}}),{c(){y(e.$$.fragment),i=N(),n=D("input"),T(n,"type","text"),T(n,"class","govuk-input"),T(n,"id",t[3])},m(f,l){S(e,f,l),$(f,i,l),$(f,n,l),V(n,t[0]),s=!0,u||(r=[Z(n,"input",t[6]),Z(n,"change",t[5])],u=!0)},p(f,l){const a={};l&4&&(a.errorMessage=f[2]),e.$set(a),l&1&&n.value!==f[0]&&V(n,f[0])},i(f){s||(d(e.$$.fragment,f),s=!0)},o(f){h(e.$$.fragment,f),s=!1},d(f){f&&(b(i),b(n)),j(e,f),u=!1,et(r)}}}function Ut(t){let e,i;return e=new ae({props:{label:t[1],id:t[3],$$slots:{default:[Mt]},$$scope:{ctx:t}}}),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,[s]){const u={};s&2&&(u.label=n[1]),s&133&&(u.$$scope={dirty:s,ctx:n}),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function It(t,e,i){let n,{label:s}=e,{value:u}=e,{required:r=!1}=e,f=ue();function l(o){tt.call(this,t,o)}function a(){u=this.value,i(0,u)}return t.$$set=o=>{"label"in o&&i(1,s=o.label),"value"in o&&i(0,u=o.value),"required"in o&&i(4,r=o.required)},t.$$.update=()=>{t.$$.dirty&17&&i(2,n=r&&(u==null||u=="")?"Required":"")},[u,s,n,f,r,l,a]}class Ce extends G{constructor(e){super(),K(this,e,It,Ut,z,{label:1,value:0,required:4})}}function Tt(t){let e,i,n,s;const u=t[2].default,r=Ze(u,t,t[1],null);let f=[{type:"button"},{class:"govuk-button govuk-button--warning"},{"data-module":"govuk-button"},t[0]],l={};for(let a=0;a<f.length;a+=1)l=je(l,f[a]);return{c(){e=D("button"),r&&r.c(),Me(e,l)},m(a,o){$(a,e,o),r&&r.m(e,null),e.autofocus&&e.focus(),i=!0,n||(s=Z(e,"click",t[3]),n=!0)},p(a,[o]){r&&r.p&&(!i||o&2)&&Ye(r,u,a,a[1],i?xe(u,a[1],o,null):Xe(a[1]),null),Me(e,l=ct(f,[{type:"button"},{class:"govuk-button govuk-button--warning"},{"data-module":"govuk-button"},o&1&&a[0]]))},i(a){i||(d(r,a),i=!0)},o(a){h(r,a),i=!1},d(a){a&&b(e),r&&r.d(a),n=!1,s()}}}function At(t,e,i){let{$$slots:n={},$$scope:s}=e;function u(r){tt.call(this,t,r)}return t.$$set=r=>{i(0,e=je(je({},e),Ue(r))),"$$scope"in r&&i(1,s=r.$$scope)},e=Ue(e),[e,s,n,u]}class Et extends G{constructor(e){super(),K(this,e,At,Tt,z,{})}}function Le(t,e){return`sketch/${t}/${e}`}function Qn(t){let e=`sketch/${t}/`,i=[];for(let n=0;n<window.localStorage.length;n++){let s=window.localStorage.key(n);s.startsWith(e)&&i.push(s.slice(e.length))}return i.sort(),i}function Lt(t,e){let i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i)}function Vn(t){let e=[];for(let i=0;i<window.localStorage.length;i++){let n=window.localStorage.key(i);n==t?e.push([n,Le(t,"old v1 sketch")]):n==`${t}_pipeline`&&e.push([n,Le(t,"old pipeline sketch")])}for(let[i,n]of e){console.log(`Renaming ${i} to ${n}`);let s=window.localStorage.getItem(i);window.localStorage.setItem(n,s),window.localStorage.removeItem(i)}}function Bt(t,e){let i=JSON.parse(JSON.stringify(e));for(let n of i.features)delete n.properties.hide_while_editing;return i.authority=t,i.origin="atip-v2",i}function Zn(t,e,i){let n=Bt(t,i);Lt(`${t}_${e}.geojson`,JSON.stringify(n,null,"  "))}function Be(t){let e,i;return e=new oe({props:{disabled:!t[2],$$slots:{default:[Jt]},$$scope:{ctx:t}}}),e.$on("click",t[7]),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,s){const u={};s&4&&(u.disabled=!n[2]),s&4096&&(u.$$scope={dirty:s,ctx:n}),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function Jt(t){let e;return{c(){e=W("Auto-fill")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function Rt(t){let e,i,n,s,u,r,f=t[0].length_meters&&Be(t);return{c(){e=D("input"),i=N(),f&&f.c(),n=ie(),T(e,"type","text"),T(e,"class","govuk-input"),T(e,"id",t[5])},m(l,a){$(l,e,a),V(e,t[0].name),$(l,i,a),f&&f.m(l,a),$(l,n,a),s=!0,u||(r=Z(e,"input",t[6]),u=!0)},p(l,a){a&1&&e.value!==l[0].name&&V(e,l[0].name),l[0].length_meters?f?(f.p(l,a),a&1&&d(f,1)):(f=Be(l),f.c(),d(f,1),f.m(n.parentNode,n)):f&&(se(),h(f,1,1,()=>{f=null}),re())},i(l){s||(d(f),s=!0)},o(l){h(f),s=!1},d(l){l&&(b(e),b(i),b(n)),f&&f.d(l),u=!1,r()}}}function Je(t){let e,i,n=he(t[0].length_meters)+"",s;return{c(){e=D("p"),i=W("Length: "),s=W(n)},m(u,r){$(u,e,r),E(e,i),E(e,s)},p(u,r){r&1&&n!==(n=he(u[0].length_meters)+"")&&fe(s,n)},d(u){u&&b(e)}}}function Wt(t){let e,i,n,s,u,r,f,l,a,o,p,c,_;e=new ae({props:{label:"Name",id:t[5],$$slots:{default:[Rt]},$$scope:{ctx:t}}});function q(m){t[9](m)}let A={label:"Scheme",choices:Object.values(t[3].schemes).map(t[8])};t[0].scheme_reference!==void 0&&(A.value=t[0].scheme_reference),n=new Ne({props:A}),L.push(()=>B(n,"value",q));function F(m){t[10](m)}let v={label:"Type",choices:[["area","Area"],["route","Route"],["crossing","Crossing"],["other","Other"]],inlineSmall:!0,required:!0};t[0].intervention_type!==void 0&&(v.value=t[0].intervention_type),r=new pe({props:v}),L.push(()=>B(r,"value",F));function k(m){t[11](m)}let O={label:"Description"};t[0].description!==void 0&&(O.value=t[0].description),a=new Fe({props:O}),L.push(()=>B(a,"value",k));let M=t[0].length_meters&&Je(t);return{c(){y(e.$$.fragment),i=N(),y(n.$$.fragment),u=N(),y(r.$$.fragment),l=N(),y(a.$$.fragment),p=N(),M&&M.c(),c=ie()},m(m,g){S(e,m,g),$(m,i,g),S(n,m,g),$(m,u,g),S(r,m,g),$(m,l,g),S(a,m,g),$(m,p,g),M&&M.m(m,g),$(m,c,g),_=!0},p(m,[g]){const I={};g&4101&&(I.$$scope={dirty:g,ctx:m}),e.$set(I);const U={};g&8&&(U.choices=Object.values(m[3].schemes).map(m[8])),!s&&g&1&&(s=!0,U.value=m[0].scheme_reference,J(()=>s=!1)),n.$set(U);const H={};!f&&g&1&&(f=!0,H.value=m[0].intervention_type,J(()=>f=!1)),r.$set(H);const Q={};!o&&g&1&&(o=!0,Q.value=m[0].description,J(()=>o=!1)),a.$set(Q),m[0].length_meters?M?M.p(m,g):(M=Je(m),M.c(),M.m(c.parentNode,c)):M&&(M.d(1),M=null)},i(m){_||(d(e.$$.fragment,m),d(n.$$.fragment,m),d(r.$$.fragment,m),d(a.$$.fragment,m),_=!0)},o(m){h(e.$$.fragment,m),h(n.$$.fragment,m),h(r.$$.fragment,m),h(a.$$.fragment,m),_=!1},d(m){m&&(b(i),b(u),b(l),b(p),b(c)),j(e,m),j(n,m),j(r,m),j(a,m),M&&M.d(m)}}}function Dt(t,e,i){let n,s,u=de,r=()=>(u(),u=ke(f,v=>i(3,s=v)),f);ve(t,nt,v=>i(2,n=v)),t.$$.on_destroy.push(()=>u());let{gjSchemes:f}=e;r();let{props:l}=e;function a(){try{i(0,l.name=n.inner.routeNameForWaypoints(l.waypoints),l)}catch(v){window.alert(`Couldn't auto-name route: ${v}`)}}let o=ue();function p(){l.name=this.value,i(0,l)}const c=()=>a(),_=v=>[v.scheme_reference,Oe(v)];function q(v){t.$$.not_equal(l.scheme_reference,v)&&(l.scheme_reference=v,i(0,l))}function A(v){t.$$.not_equal(l.intervention_type,v)&&(l.intervention_type=v,i(0,l))}function F(v){t.$$.not_equal(l.description,v)&&(l.description=v,i(0,l))}return t.$$set=v=>{"gjSchemes"in v&&r(i(1,f=v.gjSchemes)),"props"in v&&i(0,l=v.props)},[l,f,n,s,a,o,p,c,_,q,A,F]}class Gt extends G{constructor(e){super(),K(this,e,Dt,Wt,z,{gjSchemes:1,props:0})}}function Kt(t){let e,i,n;function s(r){t[2](r)}let u={label:t[1],choices:[x("New segregated cycling facility"),x("New junction treatment"),x("New permanent footway"),["New shared use facilities","New shared use (walking and cycling) facilities"],["Improvements to existing route","Improvements to make an existing walking/cycle route safer"],["Area-wide traffic management","Area-wide traffic management (including by TROs - both permanent and experimental)"],["Bus priority measures","Bus priority measures that also enable active travel (for example, bus gates)"],["Secure cycle parking","Provision of secure cycle parking facilities"],x("New road crossings"),x("Restriction or reduction of car parking availability"),x("School streets"),x("Quiet mixed traffic streets"),x("Traffic free routes"),x("Not specified in LCWIP")],emptyOption:!0};return t[0]!==void 0&&(u.value=t[0]),e=new Ne({props:u}),L.push(()=>B(e,"value",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),n=!0},p(r,[f]){const l={};f&2&&(l.label=r[1]),!i&&f&1&&(i=!0,l.value=r[0],J(()=>i=!1)),e.$set(l)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){h(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function x(t){return[t,t]}function zt(t,e,i){let{label:n}=e,{value:s}=e;function u(r){s=r,i(0,s)}return t.$$set=r=>{"label"in r&&i(1,n=r.label),"value"in r&&i(0,s=r.value)},[s,n,u]}class lt extends G{constructor(e){super(),K(this,e,zt,Kt,z,{label:1,value:0})}}function Ht(t){let e,i,n,s,u,r,f,l,a,o,p,c,_,q,A,F,v,k;function O(C){t[3](C)}let M={label:"Status",choices:[["","Unknown"],["aspiration","Aspiration"],["planned","Planned"],["in development","In development"],["in construction","In construction"],["completed","Completed"]],inlineSmall:!0,required:t[1]};t[0].status!==void 0&&(M.value=t[0].status),s=new pe({props:M}),L.push(()=>B(s,"value",O));function m(C){t[4](C)}let g={label:"Timescale",choices:[["","Unknown"],["short","Short (1-3 years)"],["medium","Medium (3-6 years)"],["long","Long (6-10 years)"]],inlineSmall:!0,required:t[1]};t[0].timescale!==void 0&&(g.value=t[0].timescale),f=new pe({props:g}),L.push(()=>B(f,"value",m));function I(C){t[5](C)}let U={label:"Estimated completion year (if known)",width:4,min:2010,max:2100};t[0].timescale_year!==void 0&&(U.value=t[0].timescale_year),o=new Se({props:U}),L.push(()=>B(o,"value",I));function H(C){t[6](C)}let Q={label:"What year was this scheme most recently published?",width:4,min:2010,max:2100};t[0].year_published!==void 0&&(Q.value=t[0].year_published),_=new Se({props:Q}),L.push(()=>B(_,"value",H));function Y(C){t[7](C)}let P={label:"What year was this scheme most recently consulted on?",width:4,min:2010,max:2100};return t[0].year_consulted!==void 0&&(P.value=t[0].year_consulted),F=new Se({props:P}),L.push(()=>B(F,"value",Y)),{c(){e=D("fieldset"),i=D("legend"),i.textContent="Timing and status",n=N(),y(s.$$.fragment),r=N(),y(f.$$.fragment),a=N(),y(o.$$.fragment),c=N(),y(_.$$.fragment),A=N(),y(F.$$.fragment),T(i,"class","govuk-fieldset__legend"),T(e,"class","govuk-fieldset svelte-1bxyfcq")},m(C,w){$(C,e,w),E(e,i),E(e,n),S(s,e,null),E(e,r),S(f,e,null),E(e,a),S(o,e,null),E(e,c),S(_,e,null),E(e,A),S(F,e,null),k=!0},p(C,[w]){const R={};w&2&&(R.required=C[1]),!u&&w&1&&(u=!0,R.value=C[0].status,J(()=>u=!1)),s.$set(R);const X={};w&2&&(X.required=C[1]),!l&&w&1&&(l=!0,X.value=C[0].timescale,J(()=>l=!1)),f.$set(X);const ee={};!p&&w&1&&(p=!0,ee.value=C[0].timescale_year,J(()=>p=!1)),o.$set(ee);const te={};!q&&w&1&&(q=!0,te.value=C[0].year_published,J(()=>q=!1)),_.$set(te);const ce={};!v&&w&1&&(v=!0,ce.value=C[0].year_consulted,J(()=>v=!1)),F.$set(ce)},i(C){k||(d(s.$$.fragment,C),d(f.$$.fragment,C),d(o.$$.fragment,C),d(_.$$.fragment,C),d(F.$$.fragment,C),k=!0)},o(C){h(s.$$.fragment,C),h(f.$$.fragment,C),h(o.$$.fragment,C),h(_.$$.fragment,C),h(F.$$.fragment,C),k=!1},d(C){C&&b(e),j(s),j(f),j(o),j(_),j(F)}}}function Qt(t,e,i){let{data:n}=e,{required:s}=e,{onUpdate:u}=e;function r(c){u()}function f(c){t.$$.not_equal(n.status,c)&&(n.status=c,i(0,n))}function l(c){t.$$.not_equal(n.timescale,c)&&(n.timescale=c,i(0,n))}function a(c){t.$$.not_equal(n.timescale_year,c)&&(n.timescale_year=c,i(0,n))}function o(c){t.$$.not_equal(n.year_published,c)&&(n.year_published=c,i(0,n))}function p(c){t.$$.not_equal(n.year_consulted,c)&&(n.year_consulted=c,i(0,n))}return t.$$set=c=>{"data"in c&&i(0,n=c.data),"required"in c&&i(1,s=c.required),"onUpdate"in c&&i(2,u=c.onUpdate)},t.$$.update=()=>{t.$$.dirty&1&&r()},[n,s,u,f,l,a,o,p]}class ut extends G{constructor(e){super(),K(this,e,Qt,Ht,z,{data:0,required:1,onUpdate:2})}}function Re(t,e,i){const n=t.slice();return n[9]=e[i],n[10]=e,n[11]=i,n}function Vt(t){let e;return{c(){e=W("Is the development fully funded?")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function Zt(t){let e;return{c(){e=W("Is the construction fully funded?")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function Yt(t){let e,i,n;function s(r){t[6](r,t[9])}let u={$$slots:{default:[Xt]},$$scope:{ctx:t}};return t[0].funding_sources[t[9]]!==void 0&&(u.checked=t[0].funding_sources[t[9]]),e=new me({props:u}),L.push(()=>B(e,"checked",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),n=!0},p(r,f){t=r;const l={};f&4096&&(l.$$scope={dirty:f,ctx:t}),!i&&f&3&&(i=!0,l.checked=t[0].funding_sources[t[9]],J(()=>i=!1)),e.$set(l)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){h(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function Xt(t){let e=t[9].toUpperCase()+"",i,n;return{c(){i=W(e),n=N()},m(s,u){$(s,i,u),$(s,n,u)},p:de,d(s){s&&(b(i),b(n))}}}function We(t){let e,i,n=t[9]!="other"&&Yt(t);return{c(){n&&n.c(),e=ie()},m(s,u){n&&n.m(s,u),$(s,e,u),i=!0},p(s,u){s[9]!="other"&&n.p(s,u)},i(s){i||(d(n),i=!0)},o(s){h(n),i=!1},d(s){s&&b(e),n&&n.d(s)}}}function xt(t){let e,i,n=ge(t[1]),s=[];for(let r=0;r<n.length;r+=1)s[r]=We(Re(t,n,r));const u=r=>h(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=ie()},m(r,f){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(r,f);$(r,e,f),i=!0},p(r,f){if(f&3){n=ge(r[1]);let l;for(l=0;l<n.length;l+=1){const a=Re(r,n,l);s[l]?(s[l].p(a,f),d(s[l],1)):(s[l]=We(a),s[l].c(),d(s[l],1),s[l].m(e.parentNode,e))}for(se(),l=n.length;l<s.length;l+=1)u(l);re()}},i(r){if(!i){for(let f=0;f<n.length;f+=1)d(s[f]);i=!0}},o(r){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)h(s[f]);i=!1},d(r){r&&b(e),it(s,r)}}}function en(t){let e,i,n,s,u,r,f,l,a,o,p,c,_,q,A,F,v,k,O;function M(P){t[3](P)}let m={label:"Cost (GBP)"};t[0].budget!==void 0&&(m.value=t[0].budget),s=new jt({props:m}),L.push(()=>B(s,"value",M));function g(P){t[4](P)}let I={$$slots:{default:[Vt]},$$scope:{ctx:t}};t[0].development_funded!==void 0&&(I.checked=t[0].development_funded),f=new me({props:I}),L.push(()=>B(f,"checked",g));function U(P){t[5](P)}let H={$$slots:{default:[Zt]},$$scope:{ctx:t}};t[0].construction_funded!==void 0&&(H.checked=t[0].construction_funded),o=new me({props:H}),L.push(()=>B(o,"checked",U)),A=new _t({props:{$$slots:{default:[xt]},$$scope:{ctx:t}}});function Q(P){t[7](P)}let Y={label:"Other funding sources"};return t[0].funding_sources.other!==void 0&&(Y.value=t[0].funding_sources.other),v=new Ce({props:Y}),L.push(()=>B(v,"value",Q)),{c(){e=D("fieldset"),i=D("legend"),i.textContent="Budget",n=N(),y(s.$$.fragment),r=N(),y(f.$$.fragment),a=N(),y(o.$$.fragment),c=N(),_=D("p"),_.textContent="Funding sources",q=N(),y(A.$$.fragment),F=N(),y(v.$$.fragment),T(i,"class","govuk-fieldset__legend"),T(e,"class","govuk-fieldset svelte-1bxyfcq")},m(P,C){$(P,e,C),E(e,i),E(e,n),S(s,e,null),E(e,r),S(f,e,null),E(e,a),S(o,e,null),E(e,c),E(e,_),E(e,q),S(A,e,null),E(e,F),S(v,e,null),O=!0},p(P,[C]){const w={};!u&&C&1&&(u=!0,w.value=P[0].budget,J(()=>u=!1)),s.$set(w);const R={};C&4096&&(R.$$scope={dirty:C,ctx:P}),!l&&C&1&&(l=!0,R.checked=P[0].development_funded,J(()=>l=!1)),f.$set(R);const X={};C&4096&&(X.$$scope={dirty:C,ctx:P}),!p&&C&1&&(p=!0,X.checked=P[0].construction_funded,J(()=>p=!1)),o.$set(X);const ee={};C&4097&&(ee.$$scope={dirty:C,ctx:P}),A.$set(ee);const te={};!k&&C&1&&(k=!0,te.value=P[0].funding_sources.other,J(()=>k=!1)),v.$set(te)},i(P){O||(d(s.$$.fragment,P),d(f.$$.fragment,P),d(o.$$.fragment,P),d(A.$$.fragment,P),d(v.$$.fragment,P),O=!0)},o(P){h(s.$$.fragment,P),h(f.$$.fragment,P),h(o.$$.fragment,P),h(A.$$.fragment,P),h(v.$$.fragment,P),O=!1},d(P){P&&b(e),j(s),j(f),j(o),j(A),j(v)}}}function tn(t,e,i){let{data:n}=e,{onUpdate:s}=e;function u(c){s()}let r=["atf2","atf3","atf4","atf4e","crsts","luf"];function f(c){t.$$.not_equal(n.budget,c)&&(n.budget=c,i(0,n))}function l(c){t.$$.not_equal(n.development_funded,c)&&(n.development_funded=c,i(0,n))}function a(c){t.$$.not_equal(n.construction_funded,c)&&(n.construction_funded=c,i(0,n))}function o(c,_){t.$$.not_equal(n.funding_sources[_],c)&&(n.funding_sources[_]=c,i(0,n))}function p(c){t.$$.not_equal(n.funding_sources.other,c)&&(n.funding_sources.other=c,i(0,n))}return t.$$set=c=>{"data"in c&&i(0,n=c.data),"onUpdate"in c&&i(2,s=c.onUpdate)},t.$$.update=()=>{t.$$.dirty&1&&u()},[n,r,s,f,l,a,o,p]}class ot extends G{constructor(e){super(),K(this,e,tn,en,z,{data:0,onUpdate:2})}}function De(t){let e,i;return e=new oe({props:{disabled:!t[2],$$slots:{default:[nn]},$$scope:{ctx:t}}}),e.$on("click",t[8]),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,s){const u={};s&4&&(u.disabled=!n[2]),s&65536&&(u.$$scope={dirty:s,ctx:n}),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function nn(t){let e;return{c(){e=W("Auto-fill with street names")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function sn(t){let e,i,n,s,u,r,f,l,a=t[0].length_meters&&De(t);return{c(){e=D("div"),e.textContent="Use the name from the LCWIP if possible",i=N(),n=D("input"),s=N(),a&&a.c(),u=ie(),T(e,"class","govuk-hint"),T(n,"type","text"),T(n,"class","govuk-input"),T(n,"id",t[6])},m(o,p){$(o,e,p),$(o,i,p),$(o,n,p),V(n,t[0].name),$(o,s,p),a&&a.m(o,p),$(o,u,p),r=!0,f||(l=Z(n,"input",t[7]),f=!0)},p(o,p){p&1&&n.value!==o[0].name&&V(n,o[0].name),o[0].length_meters?a?(a.p(o,p),p&1&&d(a,1)):(a=De(o),a.c(),d(a,1),a.m(u.parentNode,u)):a&&(se(),h(a,1,1,()=>{a=null}),re())},i(o){r||(d(a),r=!0)},o(o){h(a),r=!1},d(o){o&&(b(e),b(i),b(n),b(s),b(u)),a&&a.d(o),f=!1,l()}}}function Ge(t){let e,i,n=he(t[0].length_meters)+"",s;return{c(){e=D("p"),i=W("Length: "),s=W(n)},m(u,r){$(u,e,r),E(e,i),E(e,s)},p(u,r){r&1&&n!==(n=he(u[0].length_meters)+"")&&fe(s,n)},d(u){u&&b(e)}}}function Ke(t){let e,i,n,s,u,r,f,l,a,o,p,c,_,q;function A(g){t[12](g)}let F={label:"Type"};t[0].pipeline.atf4_type!==void 0&&(F.value=t[0].pipeline.atf4_type),e=new lt({props:F}),L.push(()=>B(e,"value",A));function v(g){t[13](g)}let k={label:"Accuracy of mapped data",choices:[["high","High"],["medium","Medium"],["low","Low"]],required:!0,inlineSmall:!0};t[0].pipeline.accuracy!==void 0&&(k.value=t[0].pipeline.accuracy),s=new pe({props:k}),L.push(()=>B(s,"value",v));function O(g){t[14](g)}let M={$$slots:{default:[rn]},$$scope:{ctx:t}};t[0].pipeline.is_alternative!==void 0&&(M.checked=t[0].pipeline.is_alternative),f=new me({props:M}),L.push(()=>B(f,"checked",O));let m=t[4]&&t[0].is_coverage_polygon!==void 0&&ze(t);return p=new ut({props:{data:t[0].pipeline,required:!1,onUpdate:on}}),_=new ot({props:{data:t[0].pipeline,onUpdate:fn}}),{c(){y(e.$$.fragment),n=N(),y(s.$$.fragment),r=N(),y(f.$$.fragment),a=N(),m&&m.c(),o=N(),y(p.$$.fragment),c=N(),y(_.$$.fragment)},m(g,I){S(e,g,I),$(g,n,I),S(s,g,I),$(g,r,I),S(f,g,I),$(g,a,I),m&&m.m(g,I),$(g,o,I),S(p,g,I),$(g,c,I),S(_,g,I),q=!0},p(g,I){const U={};!i&&I&1&&(i=!0,U.value=g[0].pipeline.atf4_type,J(()=>i=!1)),e.$set(U);const H={};!u&&I&1&&(u=!0,H.value=g[0].pipeline.accuracy,J(()=>u=!1)),s.$set(H);const Q={};I&65536&&(Q.$$scope={dirty:I,ctx:g}),!l&&I&1&&(l=!0,Q.checked=g[0].pipeline.is_alternative,J(()=>l=!1)),f.$set(Q),g[4]&&g[0].is_coverage_polygon!==void 0?m?(m.p(g,I),I&1&&d(m,1)):(m=ze(g),m.c(),d(m,1),m.m(o.parentNode,o)):m&&(se(),h(m,1,1,()=>{m=null}),re());const Y={};I&1&&(Y.data=g[0].pipeline),p.$set(Y);const P={};I&1&&(P.data=g[0].pipeline),_.$set(P)},i(g){q||(d(e.$$.fragment,g),d(s.$$.fragment,g),d(f.$$.fragment,g),d(m),d(p.$$.fragment,g),d(_.$$.fragment,g),q=!0)},o(g){h(e.$$.fragment,g),h(s.$$.fragment,g),h(f.$$.fragment,g),h(m),h(p.$$.fragment,g),h(_.$$.fragment,g),q=!1},d(g){g&&(b(n),b(r),b(a),b(o),b(c)),j(e,g),j(s,g),j(f,g),m&&m.d(g),j(p,g),j(_,g)}}}function rn(t){let e;return{c(){e=W("Is this an alternative route and not the default option?")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function ze(t){let e,i,n;function s(r){t[15](r)}let u={$$slots:{default:[ln]},$$scope:{ctx:t}};return t[0].is_coverage_polygon!==void 0&&(u.checked=t[0].is_coverage_polygon),e=new me({props:u}),L.push(()=>B(e,"checked",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),n=!0},p(r,f){const l={};f&65536&&(l.$$scope={dirty:f,ctx:r}),!i&&f&1&&(i=!0,l.checked=r[0].is_coverage_polygon,J(()=>i=!1)),e.$set(l)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){h(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function ln(t){let e;return{c(){e=W(`Does this polygon show the coverage of the scheme? (All area considered
      while making the scheme)`)},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function un(t){let e,i,n,s,u,r,f,l,a,o,p;e=new ae({props:{label:"Name",id:t[6],$$slots:{default:[sn]},$$scope:{ctx:t}}});function c(k){t[10](k)}let _={label:"Scheme",choices:Object.values(t[3].schemes).map(t[9])};t[0].scheme_reference!==void 0&&(_.value=t[0].scheme_reference),n=new Ne({props:_}),L.push(()=>B(n,"value",c));function q(k){t[11](k)}let A={label:"Description"};t[0].description!==void 0&&(A.value=t[0].description),r=new Fe({props:A}),L.push(()=>B(r,"value",q));let F=t[0].length_meters&&Ge(t),v=t[0].pipeline&&Ke(t);return{c(){y(e.$$.fragment),i=N(),y(n.$$.fragment),u=N(),y(r.$$.fragment),l=N(),F&&F.c(),a=N(),v&&v.c(),o=ie()},m(k,O){S(e,k,O),$(k,i,O),S(n,k,O),$(k,u,O),S(r,k,O),$(k,l,O),F&&F.m(k,O),$(k,a,O),v&&v.m(k,O),$(k,o,O),p=!0},p(k,[O]){const M={};O&65541&&(M.$$scope={dirty:O,ctx:k}),e.$set(M);const m={};O&8&&(m.choices=Object.values(k[3].schemes).map(k[9])),!s&&O&1&&(s=!0,m.value=k[0].scheme_reference,J(()=>s=!1)),n.$set(m);const g={};!f&&O&1&&(f=!0,g.value=k[0].description,J(()=>f=!1)),r.$set(g),k[0].length_meters?F?F.p(k,O):(F=Ge(k),F.c(),F.m(a.parentNode,a)):F&&(F.d(1),F=null),k[0].pipeline?v?(v.p(k,O),O&1&&d(v,1)):(v=Ke(k),v.c(),d(v,1),v.m(o.parentNode,o)):v&&(se(),h(v,1,1,()=>{v=null}),re())},i(k){p||(d(e.$$.fragment,k),d(n.$$.fragment,k),d(r.$$.fragment,k),d(v),p=!0)},o(k){h(e.$$.fragment,k),h(n.$$.fragment,k),h(r.$$.fragment,k),h(v),p=!1},d(k){k&&(b(i),b(u),b(l),b(a),b(o)),j(e,k),j(n,k),j(r,k),F&&F.d(k),v&&v.d(k)}}}const on=()=>{},fn=()=>{};function an(t,e,i){let n,s,u=de,r=()=>(u(),u=ke(f,m=>i(3,s=m)),f);ve(t,nt,m=>i(2,n=m)),t.$$.on_destroy.push(()=>u());let{gjSchemes:f}=e;r();let{props:l}=e;l.pipeline||(l.pipeline={atf4_type:"",accuracy:"",is_alternative:!1,development_funded:!1,construction_funded:!1,funding_sources:be(),status:"",timescale:""}),l.is_coverage_polygon||(l.is_coverage_polygon=!1);const a=(s.features.filter(m=>m.properties.is_coverage_polygon).length==0||l.is_coverage_polygon===!0)&&l.intervention_type==="area";function o(){try{i(0,l.name=n.inner.routeNameForWaypoints(l.waypoints),l)}catch(m){window.alert(`Couldn't auto-name route: ${m}`)}}let p=ue();function c(){l.name=this.value,i(0,l)}const _=()=>o(),q=m=>[m.scheme_reference,Oe(m)];function A(m){t.$$.not_equal(l.scheme_reference,m)&&(l.scheme_reference=m,i(0,l))}function F(m){t.$$.not_equal(l.description,m)&&(l.description=m,i(0,l))}function v(m){t.$$.not_equal(l.pipeline.atf4_type,m)&&(l.pipeline.atf4_type=m,i(0,l))}function k(m){t.$$.not_equal(l.pipeline.accuracy,m)&&(l.pipeline.accuracy=m,i(0,l))}function O(m){t.$$.not_equal(l.pipeline.is_alternative,m)&&(l.pipeline.is_alternative=m,i(0,l))}function M(m){t.$$.not_equal(l.is_coverage_polygon,m)&&(l.is_coverage_polygon=m,i(0,l))}return t.$$set=m=>{"gjSchemes"in m&&r(i(1,f=m.gjSchemes)),"props"in m&&i(0,l=m.props)},[l,f,n,s,a,o,p,c,_,q,A,F,v,k,O,M]}class cn extends G{constructor(e){super(),K(this,e,an,un,z,{gjSchemes:1,props:0})}}function He(t,e,i){const n=t.slice();return n[9]=e[i][0],n[10]=e[i][1],n}function Qe(t){let e,i;return e=new oe({props:{$$slots:{default:[pn]},$$scope:{ctx:t}}}),e.$on("click",t[6]),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,s){const u={};s&8192&&(u.$$scope={dirty:s,ctx:n}),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function pn(t){let e;return{c(){e=W("Handle extra GeoJSON properties")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function Ve(t){let e,i,n=t[9]+"",s,u,r=JSON.stringify(t[10])+"",f,l;return{c(){e=D("li"),i=D("b"),s=W(n),u=W(`
        = `),f=W(r),l=N()},m(a,o){$(a,e,o),E(e,i),E(i,s),E(e,u),E(e,f),E(e,l)},p(a,o){o&2&&n!==(n=a[9]+"")&&fe(s,n),o&2&&r!==(r=JSON.stringify(a[10])+"")&&fe(f,r)},d(a){a&&b(e)}}}function mn(t){let e;return{c(){e=W("Remove these properties")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function _n(t){let e;return{c(){e=W("Cancel")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function dn(t){let e,i,n,s;return e=new Et({props:{$$slots:{default:[mn]},$$scope:{ctx:t}}}),e.$on("click",t[2]),n=new oe({props:{$$slots:{default:[_n]},$$scope:{ctx:t}}}),n.$on("click",t[7]),{c(){y(e.$$.fragment),i=N(),y(n.$$.fragment)},m(u,r){S(e,u,r),$(u,i,r),S(n,u,r),s=!0},p(u,r){const f={};r&8192&&(f.$$scope={dirty:r,ctx:u}),e.$set(f);const l={};r&8192&&(l.$$scope={dirty:r,ctx:u}),n.$set(l)},i(u){s||(d(e.$$.fragment,u),d(n.$$.fragment,u),s=!0)},o(u){h(e.$$.fragment,u),h(n.$$.fragment,u),s=!1},d(u){u&&b(i),j(e,u),j(n,u)}}}function gn(t){let e,i,n,s,u,r,f=ge(Object.entries(t[1])),l=[];for(let a=0;a<f.length;a+=1)l[a]=Ve(He(t,f,a));return u=new vt({props:{$$slots:{default:[dn]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent="The unexpected properties:",i=N(),n=D("ul");for(let a=0;a<l.length;a+=1)l[a].c();s=N(),y(u.$$.fragment)},m(a,o){$(a,e,o),$(a,i,o),$(a,n,o);for(let p=0;p<l.length;p+=1)l[p]&&l[p].m(n,null);$(a,s,o),S(u,a,o),r=!0},p(a,o){if(o&2){f=ge(Object.entries(a[1]));let c;for(c=0;c<f.length;c+=1){const _=He(a,f,c);l[c]?l[c].p(_,o):(l[c]=Ve(_),l[c].c(),l[c].m(n,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=f.length}const p={};o&8193&&(p.$$scope={dirty:o,ctx:a}),u.$set(p)},i(a){r||(d(u.$$.fragment,a),r=!0)},o(a){h(u.$$.fragment,a),r=!1},d(a){a&&(b(e),b(i),b(n),b(s)),it(l,a),j(u,a)}}}function hn(t){let e=Object.entries(t[1]).length>0,i,n,s,u,r=e&&Qe(t);function f(a){t[8](a)}let l={title:"This imported GeoJSON feature has unexpected properties",$$slots:{default:[gn]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.open=t[0]),n=new qe({props:l}),L.push(()=>B(n,"open",f)),{c(){r&&r.c(),i=N(),y(n.$$.fragment)},m(a,o){r&&r.m(a,o),$(a,i,o),S(n,a,o),u=!0},p(a,[o]){o&2&&(e=Object.entries(a[1]).length>0),e?r?(r.p(a,o),o&2&&d(r,1)):(r=Qe(a),r.c(),d(r,1),r.m(i.parentNode,i)):r&&(se(),h(r,1,1,()=>{r=null}),re());const p={};o&8195&&(p.$$scope={dirty:o,ctx:a}),!s&&o&1&&(s=!0,p.open=a[0],J(()=>s=!1)),n.$set(p)},i(a){u||(d(r),d(n.$$.fragment,a),u=!0)},o(a){h(r),h(n.$$.fragment,a),u=!1},d(a){a&&b(i),r&&r.d(a),j(n,a)}}}function $n(t,e,i){let n,{gjSchemes:s}=e,{id:u}=e,{props:r}=e,f=!1;function l(){i(0,f=!1),s.update(c=>{let _=c.features.find(q=>q.id==u);for(let q of Object.keys(n))delete _.properties[q];return c})}const a=()=>i(0,f=!0),o=()=>i(0,f=!1);function p(c){f=c,i(0,f)}return t.$$set=c=>{"gjSchemes"in c&&i(3,s=c.gjSchemes),"id"in c&&i(4,u=c.id),"props"in c&&i(5,r=c.props)},t.$$.update=()=>{t.$$.dirty&32&&i(1,n=at(r))},[f,n,l,s,u,r,a,o,p]}class bn extends G{constructor(e){super(),K(this,e,$n,hn,z,{gjSchemes:3,id:4,props:5})}}function vn(t){let e,i,n;function s(r){t[6](r)}let u={gjSchemes:t[1]};return t[0]!==void 0&&(u.props=t[0]),e=new cn({props:u}),L.push(()=>B(e,"props",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),n=!0},p(r,f){const l={};f&2&&(l.gjSchemes=r[1]),!i&&f&1&&(i=!0,l.props=r[0],J(()=>i=!1)),e.$set(l)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){h(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function kn(t){let e,i,n;function s(r){t[5](r)}let u={gjSchemes:t[1]};return t[0]!==void 0&&(u.props=t[0]),e=new Gt({props:u}),L.push(()=>B(e,"props",s)),{c(){y(e.$$.fragment)},m(r,f){S(e,r,f),n=!0},p(r,f){const l={};f&2&&(l.gjSchemes=r[1]),!i&&f&1&&(i=!0,l.props=r[0],J(()=>i=!1)),e.$set(l)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){h(e.$$.fragment,r),n=!1},d(r){j(e,r)}}}function wn(t){let e,i,n,s,u,r;e=new bn({props:{gjSchemes:t[1],id:t[2],props:t[0]}});const f=[kn,vn],l=[];function a(o,p){return o[3]=="v1"?0:o[3]=="pipeline"?1:-1}return~(n=a(t))&&(s=l[n]=f[n](t)),{c(){y(e.$$.fragment),i=N(),s&&s.c(),u=ie()},m(o,p){S(e,o,p),$(o,i,p),~n&&l[n].m(o,p),$(o,u,p),r=!0},p(o,[p]){const c={};p&2&&(c.gjSchemes=o[1]),p&4&&(c.id=o[2]),p&1&&(c.props=o[0]),e.$set(c);let _=n;n=a(o),n===_?~n&&l[n].p(o,p):(s&&(se(),h(l[_],1,1,()=>{l[_]=null}),re()),~n?(s=l[n],s?s.p(o,p):(s=l[n]=f[n](o),s.c()),d(s,1),s.m(u.parentNode,u)):s=null)},i(o){r||(d(e.$$.fragment,o),d(s),r=!0)},o(o){h(e.$$.fragment,o),h(s),r=!1},d(o){o&&(b(i),b(u)),j(e,o),~n&&l[n].d(o)}}}function yn(t,e,i){let n;ve(t,ne,o=>i(3,n=o));let{cfg:s}=e,{gjSchemes:u}=e,{id:r}=e,{props:f}=e;function l(o){f=o,i(0,f)}function a(o){f=o,i(0,f)}return t.$$set=o=>{"cfg"in o&&i(4,s=o.cfg),"gjSchemes"in o&&i(1,u=o.gjSchemes),"id"in o&&i(2,r=o.id),"props"in o&&i(0,f=o.props)},[f,u,r,n,s,l,a]}class Sn extends G{constructor(e){super(),K(this,e,yn,wn,z,{cfg:4,gjSchemes:1,id:2,props:0})}}function jn(t){let e;return{c(){e=W("Scheme details")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function qn(t){let e;return{c(){e=W("Save")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function Nn(t){let e,i,n,s,u;function r(l){t[6](l)}let f={label:"Scheme name",required:!0};return t[3].schemes[t[1]].scheme_name!==void 0&&(f.value=t[3].schemes[t[1]].scheme_name),e=new Ce({props:f}),L.push(()=>B(e,"value",r)),s=new st({props:{$$slots:{default:[qn]},$$scope:{ctx:t}}}),s.$on("click",t[7]),{c(){y(e.$$.fragment),n=N(),y(s.$$.fragment)},m(l,a){S(e,l,a),$(l,n,a),S(s,l,a),u=!0},p(l,a){const o={};!i&&a&10&&(i=!0,o.value=l[3].schemes[l[1]].scheme_name,J(()=>i=!1)),e.$set(o);const p={};a&512&&(p.$$scope={dirty:a,ctx:l}),s.$set(p)},i(l){u||(d(e.$$.fragment,l),d(s.$$.fragment,l),u=!0)},o(l){h(e.$$.fragment,l),h(s.$$.fragment,l),u=!1},d(l){l&&b(n),j(e,l),j(s,l)}}}function Fn(t){let e,i,n,s,u,r,f;e=new oe({props:{$$slots:{default:[jn]},$$scope:{ctx:t}}}),e.$on("click",t[5]);function l(o){t[8](o)}let a={title:"Scheme details",$$slots:{default:[Nn]},$$scope:{ctx:t}};return t[2]!==void 0&&(a.open=t[2]),n=new qe({props:a}),L.push(()=>B(n,"open",l)),{c(){y(e.$$.fragment),i=N(),y(n.$$.fragment)},m(o,p){S(e,o,p),$(o,i,p),S(n,o,p),u=!0,r||(f=Z(window,"keydown",t[4]),r=!0)},p(o,[p]){const c={};p&512&&(c.$$scope={dirty:p,ctx:o}),e.$set(c);const _={};p&526&&(_.$$scope={dirty:p,ctx:o}),!s&&p&4&&(s=!0,_.open=o[2],J(()=>s=!1)),n.$set(_)},i(o){u||(d(e.$$.fragment,o),d(n.$$.fragment,o),u=!0)},o(o){h(e.$$.fragment,o),h(n.$$.fragment,o),u=!1},d(o){o&&b(i),j(e,o),j(n,o),r=!1,f()}}}function Cn(t,e,i){let n,s=de,u=()=>(s(),s=ke(r,q=>i(3,n=q)),r);t.$$.on_destroy.push(()=>s());let{gjSchemes:r}=e;u();let{scheme_reference:f}=e,l=!1;function a(q){l&&q.key=="Escape"&&(q.stopPropagation(),i(2,l=!1))}const o=()=>i(2,l=!0);function p(q){t.$$.not_equal(n.schemes[f].scheme_name,q)&&(n.schemes[f].scheme_name=q,r.set(n))}const c=()=>i(2,l=!1);function _(q){l=q,i(2,l)}return t.$$set=q=>{"gjSchemes"in q&&u(i(0,r=q.gjSchemes)),"scheme_reference"in q&&i(1,f=q.scheme_reference)},[r,f,l,n,a,o,p,c,_]}class On extends G{constructor(e){super(),K(this,e,Cn,Fn,z,{gjSchemes:0,scheme_reference:1})}}function Pn(t){let e;return{c(){e=W("Scheme details")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function Mn(t){let e;return{c(){e=W("Save")},m(i,n){$(i,e,n)},d(i){i&&b(e)}}}function Un(t){let e,i,n,s,u,r,f,l,a,o,p,c,_,q,A,F,v,k,O,M,m;function g(w){t[9](w)}let I={label:"Scheme name",required:!0};t[6].schemes[t[1]].scheme_name!==void 0&&(I.value=t[6].schemes[t[1]].scheme_name),e=new Ce({props:I}),L.push(()=>B(e,"value",g));function U(w){t[10](w)}let H={label:"Scheme type",choices:[["cycling route","Cycling route"],["walking route","Walking route"],["shared-use route","Shared-use route"],["cycling and walking route","Cycling and walking route, not shared use"],["area-based scheme","Area-based scheme"],["intersection","Intersection/junction scheme"]],inlineSmall:!0,required:!0};t[3].scheme_type!==void 0&&(H.value=t[3].scheme_type),f=new pe({props:H}),L.push(()=>B(f,"value",U));function Q(w){t[11](w)}let Y={label:"Type of the main intervention"};t[3].atf4_lead_type!==void 0&&(Y.value=t[3].atf4_lead_type),o=new lt({props:Y}),L.push(()=>B(o,"value",Q));function P(w){t[12](w)}let C={label:"Scheme description (150 words max)"};return t[3].scheme_description!==void 0&&(C.value=t[3].scheme_description),_=new Fe({props:C}),L.push(()=>B(_,"value",P)),F=new ut({props:{data:t[3],required:!0,onUpdate:t[13]}}),k=new ot({props:{data:t[3],onUpdate:t[14]}}),M=new st({props:{$$slots:{default:[Mn]},$$scope:{ctx:t}}}),M.$on("click",t[15]),{c(){y(e.$$.fragment),n=N(),s=D("fieldset"),u=D("legend"),u.textContent="Basic information",r=N(),y(f.$$.fragment),a=N(),y(o.$$.fragment),c=N(),y(_.$$.fragment),A=N(),y(F.$$.fragment),v=N(),y(k.$$.fragment),O=N(),y(M.$$.fragment),T(u,"class","govuk-fieldset__legend"),T(s,"class","govuk-fieldset svelte-1bxyfcq")},m(w,R){S(e,w,R),$(w,n,R),$(w,s,R),E(s,u),E(s,r),S(f,s,null),E(s,a),S(o,s,null),E(s,c),S(_,s,null),$(w,A,R),S(F,w,R),$(w,v,R),S(k,w,R),$(w,O,R),S(M,w,R),m=!0},p(w,R){const X={};!i&&R&66&&(i=!0,X.value=w[6].schemes[w[1]].scheme_name,J(()=>i=!1)),e.$set(X);const ee={};!l&&R&8&&(l=!0,ee.value=w[3].scheme_type,J(()=>l=!1)),f.$set(ee);const te={};!p&&R&8&&(p=!0,te.value=w[3].atf4_lead_type,J(()=>p=!1)),o.$set(te);const ce={};!q&&R&8&&(q=!0,ce.value=w[3].scheme_description,J(()=>q=!1)),_.$set(ce);const we={};R&8&&(we.data=w[3]),R&16&&(we.onUpdate=w[13]),F.$set(we);const ye={};R&8&&(ye.data=w[3]),R&16&&(ye.onUpdate=w[14]),k.$set(ye);const Pe={};R&524288&&(Pe.$$scope={dirty:R,ctx:w}),M.$set(Pe)},i(w){m||(d(e.$$.fragment,w),d(f.$$.fragment,w),d(o.$$.fragment,w),d(_.$$.fragment,w),d(F.$$.fragment,w),d(k.$$.fragment,w),d(M.$$.fragment,w),m=!0)},o(w){h(e.$$.fragment,w),h(f.$$.fragment,w),h(o.$$.fragment,w),h(_.$$.fragment,w),h(F.$$.fragment,w),h(k.$$.fragment,w),h(M.$$.fragment,w),m=!1},d(w){w&&(b(n),b(s),b(A),b(v),b(O)),j(e,w),j(f),j(o),j(_),j(F,w),j(k,w),j(M,w)}}}function In(t){let e,i,n,s,u,r,f,l,a;e=new _e({props:{errorMessage:t[5]}}),n=new oe({props:{$$slots:{default:[Pn]},$$scope:{ctx:t}}}),n.$on("click",t[8]);function o(c){t[16](c)}let p={title:"Scheme details",$$slots:{default:[Un]},$$scope:{ctx:t}};return t[2]!==void 0&&(p.open=t[2]),u=new qe({props:p}),L.push(()=>B(u,"open",o)),{c(){y(e.$$.fragment),i=N(),y(n.$$.fragment),s=N(),y(u.$$.fragment)},m(c,_){S(e,c,_),$(c,i,_),S(n,c,_),$(c,s,_),S(u,c,_),f=!0,l||(a=Z(window,"keydown",t[7]),l=!0)},p(c,[_]){const q={};_&32&&(q.errorMessage=c[5]),e.$set(q);const A={};_&524288&&(A.$$scope={dirty:_,ctx:c}),n.$set(A);const F={};_&524382&&(F.$$scope={dirty:_,ctx:c}),!r&&_&4&&(r=!0,F.open=c[2],J(()=>r=!1)),u.$set(F)},i(c){f||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(u.$$.fragment,c),f=!0)},o(c){h(e.$$.fragment,c),h(n.$$.fragment,c),h(u.$$.fragment,c),f=!1},d(c){c&&(b(i),b(s)),j(e,c),j(n,c),j(u,c),l=!1,a()}}}function Tn(t,e,i){let n,s,u=de,r=()=>(u(),u=ke(f,U=>i(6,s=U)),f);t.$$.on_destroy.push(()=>u());let{gjSchemes:f}=e;r();let{scheme_reference:l}=e,a=!1,o=s.schemes[l].pipeline,p=0;function c(U,H){return o.scheme_type&&o.status&&o.timescale?"":"Missing some required data"}function _(U){a&&U.key=="Escape"&&(U.stopPropagation(),i(2,a=!1))}function q(){pt(f,s.schemes[l].pipeline=o,s),f.set(s)}const A=()=>i(2,a=!0);function F(U){t.$$.not_equal(s.schemes[l].scheme_name,U)&&(s.schemes[l].scheme_name=U,f.set(s))}function v(U){t.$$.not_equal(o.scheme_type,U)&&(o.scheme_type=U,i(3,o))}function k(U){t.$$.not_equal(o.atf4_lead_type,U)&&(o.atf4_lead_type=U,i(3,o))}function O(U){t.$$.not_equal(o.scheme_description,U)&&(o.scheme_description=U,i(3,o))}const M=()=>i(4,p++,p),m=()=>i(4,p++,p),g=()=>i(2,a=!1);function I(U){a=U,i(2,a)}return t.$$set=U=>{"gjSchemes"in U&&r(i(0,f=U.gjSchemes)),"scheme_reference"in U&&i(1,l=U.scheme_reference)},t.$$.update=()=>{t.$$.dirty&24&&i(5,n=c()),t.$$.dirty&4&&(a||q())},[f,l,a,o,p,n,s,_,A,F,v,k,O,M,m,g,I]}class An extends G{constructor(e){super(),K(this,e,Tn,In,z,{gjSchemes:0,scheme_reference:1})}}function En(t){let e,i;return e=new On({props:{gjSchemes:t[0],scheme_reference:t[1]}}),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,s){const u={};s&1&&(u.gjSchemes=n[0]),s&2&&(u.scheme_reference=n[1]),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function Ln(t){let e,i;return e=new An({props:{gjSchemes:t[0],scheme_reference:t[1]}}),{c(){y(e.$$.fragment)},m(n,s){S(e,n,s),i=!0},p(n,s){const u={};s&1&&(u.gjSchemes=n[0]),s&2&&(u.scheme_reference=n[1]),e.$set(u)},i(n){i||(d(e.$$.fragment,n),i=!0)},o(n){h(e.$$.fragment,n),i=!1},d(n){j(e,n)}}}function Bn(t){let e,i,n,s;const u=[Ln,En],r=[];function f(l,a){return l[2]=="pipeline"?0:1}return e=f(t),i=r[e]=u[e](t),{c(){i.c(),n=ie()},m(l,a){r[e].m(l,a),$(l,n,a),s=!0},p(l,[a]){let o=e;e=f(l),e===o?r[e].p(l,a):(se(),h(r[o],1,1,()=>{r[o]=null}),re(),i=r[e],i?i.p(l,a):(i=r[e]=u[e](l),i.c()),d(i,1),i.m(n.parentNode,n))},i(l){s||(d(i),s=!0)},o(l){h(i),s=!1},d(l){l&&b(n),r[e].d(l)}}}function Jn(t,e,i){let n;ve(t,ne,r=>i(2,n=r));let{gjSchemes:s}=e,{scheme_reference:u}=e;return t.$$set=r=>{"gjSchemes"in r&&i(0,s=r.gjSchemes),"scheme_reference"in r&&i(1,u=r.scheme_reference)},[s,u,n]}class Rn extends G{constructor(e){super(),K(this,e,Jn,Bn,z,{gjSchemes:0,scheme_reference:1})}}let Yn={interventionName:Gn,schemeName:Oe,backfill:Wn,initializeEmptyScheme:Dn,interventionWarning:Kn,editFeatureForm:Sn,editSchemeForm:Rn,newPointFeature:t=>{t.properties.intervention_type="other"},newPolygonFeature:t=>{t.properties.intervention_type="area",t.properties.is_coverage_polygon=!1},newLineStringFeature:t=>{t.properties.intervention_type="route",t.properties.route_name&&(le(ne)!="pipeline"&&(t.properties.name=t.properties.route_name),delete t.properties.route_name)},updateFeature:(t,e)=>{e.properties.route_name&&!t.properties.name&&le(ne)!="pipeline"&&(t.properties.name=e.properties.route_name)},maptilerApiKey:"MZEJTanw3WpxRvt7qDfo",getStreetViewRoadLayerNames:t=>dt(t,le(mt)),layerZorder:gt};function Wn(t){var n,s,u,r,f,l,a,o;let e=le(ne),i=1;for(let p of t.features)p.properties||(p.properties={name:"",scheme_reference:"",description:"",intervention_type:"other",is_coverage_polygon:!1}),e=="pipeline"&&!p.properties.intervention_type&&(p.properties.intervention_type=new Map([["LineString","route"],["Polygon","area"]]).get(p.geometry.type)??"other"),p.geometry.type=="LineString"&&!p.properties.length_meters&&(p.properties.length_meters=ht(p,{units:"kilometers"})*1e3),p.id=i++;if(!t.schemes){let p=ue();t.schemes={},t.schemes[p]={scheme_reference:p,color:Ie()},t.scheme_name&&(t.schemes[p].scheme_name=t.scheme_name,delete t.scheme_name),t.pipeline&&(t.schemes[p].pipeline=t.pipeline,delete t.pipeline);for(let c of t.features)c.properties.scheme_reference=p}for(let p of Object.values(t.schemes)){let c=p;if(c.color??(c.color=Ie()),e=="pipeline"){c.pipeline??(c.pipeline=ft()),(n=c.pipeline).development_funded??(n.development_funded=!1),(s=c.pipeline).construction_funded??(s.construction_funded=!1),(u=c.pipeline).funding_sources??(u.funding_sources=be()),delete c.pipeline.budget_funded,delete c.pipeline.budget_unfunded,delete c.pipeline.funding_source,delete c.pipeline.funded;for(let _ of t.features)_.properties.pipeline&&((r=_.properties.pipeline).development_funded??(r.development_funded=!1),(f=_.properties.pipeline).construction_funded??(f.construction_funded=!1),(l=_.properties.pipeline).funding_sources??(l.funding_sources=be()),(a=_.properties.pipeline).status??(a.status=""),(o=_.properties.pipeline).timescale??(o.timescale=""))}}return t}function Dn(t){let e=t;return le(ne)=="pipeline"&&(e.pipeline=ft()),e}function ft(){return{scheme_type:"",atf4_lead_type:"",scheme_description:"",status:"",timescale:"",development_funded:!1,construction_funded:!1,funding_sources:be()}}function be(){return{atf2:!1,atf3:!1,atf4:!1,atf4e:!1,crsts:!1,luf:!1,other:""}}function Gn(t){if(t.properties.name)return t.properties.name;var e=t.properties.intervention_type;return e=="other"&&(t.geometry.type=="Point"?e="point":t.geometry.type=="LineString"?e="line":e="polygon"),`Untitled ${e}`}function Oe(t){return t.scheme_name??"Untitled scheme"}function Kn(t){var n;let e=le(ne);if(!t.properties.name)return"No name";if(!new Set(["route","area","crossing","other"]).has(t.properties.intervention_type))return"No intervention type";if(e=="pipeline"&&!((n=t.properties.pipeline)!=null&&n.accuracy))return"Accuracy not specified";let i=at(t.properties);return Object.entries(i).length>0?`Extra GeoJSON properties: ${Object.keys(i).join(", ")}`:null}function at(t){let e=le(ne),i=JSON.parse(JSON.stringify(t));for(let n of["name","description","intervention_type","length_meters","waypoints","hide_while_editing","is_coverage_polygon","scheme_reference"])delete i[n];if(e=="pipeline"&&i.pipeline){for(let n of["atf4_type","accuracy","is_alternative","budget","development_funded","construction_funded","funding_sources","status","timescale","timescale_year","year_published","year_consulted"])delete i.pipeline[n];Object.entries(i.pipeline).length==0&&delete i.pipeline}return i}export{vt as B,Ce as T,Et as W,Wn as b,Yn as c,Lt as d,Zn as e,Le as g,Vn as i,Qn as l,Bt as s};
