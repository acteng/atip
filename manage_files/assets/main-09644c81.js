import{S as ce,i as de,s as _e,e as w,l as be,a as c,b as T,c as M,n as X,d as C,f as we,E as pe,D as Ae,R as ye,g as Y,h as Z,F as Se,j as d,k as ke,m as i,o as _,t as f,p as $,q as Le,r as x,u as h,v as Me,w as Ce,x as O,y as Ee,z as Te,A as Fe,B as Ie,C as je,G as $e}from"./index-31c14ddd.js";import{A as Be,s as Ge,P as He}from"./storage-a13daf64.js";import{A as Oe}from"./About-4d0e0cc0.js";import{A as De,L as Je,M as Ne,G as Pe,F as Re,h as qe,a as Ue}from"./MapLibreMap-374aa7f1.js";import{d as ze}from"./files-f56e01eb.js";function Ve(r){let t,a,n;return{c(){t=w("div"),t.innerHTML=`<img src="${be}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,a=c(),n=w("div"),T(t,"class","black-bar svelte-13flgp1"),T(n,"class","green-bar svelte-13flgp1")},m(l,e){M(l,t,e),M(l,a,e),M(l,n,e)},p:X,i:X,o:X,d(l){l&&(C(t),C(a),C(n))}}}class Ke extends ce{constructor(t){super(),de(this,t,null,Ve,_e,{})}}function Qe(r){let t;return{c(){t=O("About")},m(a,n){M(a,t,n)},d(a){a&&C(t)}}}function me(r){let t,a,n;function l(o){r[10](o)}let e={label:"Select Transport Authority or Local Authority District",options:r[1].features.map(ge)};return r[0]!==void 0&&(e.value=r[0]),t=new Be({props:e}),Y.push(()=>Z(t,"value",l)),{c(){d(t.$$.fragment)},m(o,v){_(t,o,v),n=!0},p(o,v){const u={};v&2&&(u.options=o[1].features.map(ge)),!a&&v&1&&(a=!0,u.value=o[0],x(()=>a=!1)),t.$set(u)},i(o){n||(f(t.$$.fragment,o),n=!0)},o(o){$(t.$$.fragment,o),n=!1},d(o){h(t,o)}}}function We(r){let t;return{c(){t=O("Start")},m(a,n){M(a,t,n)},d(a){a&&C(t)}}}function Xe(r){let t,a=r[16].name+"",n,l,e=r[16].level+"",o,v;return{c(){t=w("p"),n=O(a),l=O(" ("),o=O(e),v=O(")")},m(u,m){M(u,t,m),i(t,n),i(t,l),i(t,o),i(t,v)},p(u,m){m&65536&&a!==(a=u[16].name+"")&&$e(n,a),m&65536&&e!==(e=u[16].level+"")&&$e(o,e)},d(u){u&&C(t)}}}function Ye(r){let t,a;return t=new He({props:{$$slots:{default:[Xe,({props:n})=>({16:n}),({props:n})=>n?65536:0]},$$scope:{ctx:r}}}),{c(){d(t.$$.fragment)},m(n,l){_(t,n,l),a=!0},p(n,l){const e={};l&196608&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){a||(f(t.$$.fragment,n),a=!0)},o(n){$(t.$$.fragment,n),a=!1},d(n){h(t,n)}}}function Ze(r){let t,a,n,l;return t=new Re({props:{id:"boundaries",filter:["==",["get","level"],r[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":qe(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[Ye]},$$scope:{ctx:r}}}),t.$on("click",r[7]),n=new Ue({props:{id:"boundaries-outline",filter:["==",["get","level"],r[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){d(t.$$.fragment),a=c(),d(n.$$.fragment)},m(e,o){_(t,e,o),M(e,a,o),_(n,e,o),l=!0},p(e,o){const v={};o&16&&(v.filter=["==",["get","level"],e[4]]),o&131072&&(v.$$scope={dirty:o,ctx:e}),t.$set(v);const u={};o&16&&(u.filter=["==",["get","level"],e[4]]),n.$set(u)},i(e){l||(f(t.$$.fragment,e),f(n.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),$(n.$$.fragment,e),l=!1},d(e){e&&C(a),h(t,e),h(n,e)}}}function xe(r){let t,a;return t=new Pe({props:{data:r[1],generateId:!0,$$slots:{default:[Ze]},$$scope:{ctx:r}}}),{c(){d(t.$$.fragment)},m(n,l){_(t,n,l),a=!0},p(n,l){const e={};l&2&&(e.data=n[1]),l&131088&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){a||(f(t.$$.fragment,n),a=!0)},o(n){$(t.$$.fragment,n),a=!1},d(n){h(t,n)}}}function et(r){let t,a,n,l,e,o,v,u,m,D,F,P,S,R,L,q,J,k,b,U,A,y,j,B,ee,te,G,ne,H,ae,z,N,I,K,E,Q,V;n=new Ke({}),o=new De({}),m=new Je({}),S=new we({props:{$$slots:{default:[Qe]},$$scope:{ctx:r}}}),S.$on("click",r[9]),L=new pe({props:{errorMessage:r[3]}});let p=r[1].features.length>0&&me(r);k=new Ae({props:{disabled:!r[5],$$slots:{default:[We]},$$scope:{ctx:r}}}),k.$on("click",r[8]);function he(s){r[11](s)}let re={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};r[4]!==void 0&&(re.value=r[4]),y=new ye({props:re}),Y.push(()=>Z(y,"value",he)),G=new pe({props:{errorMessage:tt}}),H=new Se({props:{label:"Or upload an ATIP GeoJSON file",onLoad:r[6]}}),I=new Ne({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[xe]},$$scope:{ctx:r}}});function ve(s){r[12](s)}let se={};return r[2]!==void 0&&(se.open=r[2]),E=new Oe({props:se}),Y.push(()=>Z(E,"open",ve)),{c(){t=w("div"),a=w("div"),d(n.$$.fragment),l=c(),e=w("div"),d(o.$$.fragment),v=c(),u=w("div"),d(m.$$.fragment),D=c(),F=w("h1"),F.textContent="Scheme Sketcher",P=c(),d(S.$$.fragment),R=c(),d(L.$$.fragment),q=c(),p&&p.c(),J=c(),d(k.$$.fragment),b=c(),U=w("hr"),A=c(),d(y.$$.fragment),B=c(),ee=w("hr"),te=c(),d(G.$$.fragment),ne=c(),d(H.$$.fragment),ae=c(),z=w("div"),N=w("div"),d(I.$$.fragment),K=c(),d(E.$$.fragment),ke(u,"border-bottom","1px solid #b1b4b6"),T(e,"class","left svelte-lyn11h"),T(a,"class","govuk-grid-column-one-half govuk-prose"),T(N,"id","map"),T(N,"class","svelte-lyn11h"),T(z,"class","govuk-grid-column-one-half"),T(t,"class","govuk-grid-row")},m(s,g){M(s,t,g),i(t,a),_(n,a,null),i(a,l),i(a,e),_(o,e,null),i(e,v),i(e,u),_(m,u,null),i(e,D),i(e,F),i(e,P),_(S,e,null),i(e,R),_(L,e,null),i(e,q),p&&p.m(e,null),i(e,J),_(k,e,null),i(e,b),i(e,U),i(e,A),_(y,e,null),i(e,B),i(e,ee),i(e,te),_(G,e,null),i(e,ne),_(H,e,null),i(t,ae),i(t,z),i(z,N),_(I,N,null),M(s,K,g),_(E,s,g),V=!0},p(s,[g]){const oe={};g&131072&&(oe.$$scope={dirty:g,ctx:s}),S.$set(oe);const le={};g&8&&(le.errorMessage=s[3]),L.$set(le),s[1].features.length>0?p?(p.p(s,g),g&2&&f(p,1)):(p=me(s),p.c(),f(p,1),p.m(e,J)):p&&(Ee(),$(p,1,1,()=>{p=null}),Le());const W={};g&32&&(W.disabled=!s[5]),g&131072&&(W.$$scope={dirty:g,ctx:s}),k.$set(W);const ie={};!j&&g&16&&(j=!0,ie.value=s[4],x(()=>j=!1)),y.$set(ie);const ue={};g&131090&&(ue.$$scope={dirty:g,ctx:s}),I.$set(ue);const fe={};!Q&&g&4&&(Q=!0,fe.open=s[2],x(()=>Q=!1)),E.$set(fe)},i(s){V||(f(n.$$.fragment,s),f(o.$$.fragment,s),f(m.$$.fragment,s),f(S.$$.fragment,s),f(L.$$.fragment,s),f(p),f(k.$$.fragment,s),f(y.$$.fragment,s),f(G.$$.fragment,s),f(H.$$.fragment,s),f(I.$$.fragment,s),f(E.$$.fragment,s),V=!0)},o(s){$(n.$$.fragment,s),$(o.$$.fragment,s),$(m.$$.fragment,s),$(S.$$.fragment,s),$(L.$$.fragment,s),$(p),$(k.$$.fragment,s),$(y.$$.fragment,s),$(G.$$.fragment,s),$(H.$$.fragment,s),$(I.$$.fragment,s),$(E.$$.fragment,s),V=!1},d(s){s&&(C(t),C(K)),h(n),h(o),h(m),h(S),h(L),p&&p.d(),h(k),h(y),h(G),h(H),h(I),h(E,s)}}}let tt="";const ge=r=>[r.properties.full_name,`${r.properties.name} (${r.properties.level})`];function nt(r,t,a){let n,l;Me(r,je,b=>a(13,l=b));let e={type:"FeatureCollection",features:[]},o=!1,u=new URLSearchParams(window.location.search).get("error")||"",m,D=new Set,F="TA";Ce(async()=>{Te(),a(1,e=await Fe());for(let b of e.features)D.add(b.properties.full_name)});function P(b,U){try{let A=JSON.parse(U),y=Ie(A.features,e);if(!y)throw new Error("Can't figure out the authority boundary that fully contains this scheme");A.authority=y;let j=A.authority,B=ze(A);B!="v1"&&(j+=`_${B}`),Ge(j,JSON.stringify(A)),window.location.href=`scheme.html?authority=${A.authority}&schema=${B}`}catch(A){a(3,u=`Couldn't load scheme from a file: ${A}`)}}function S(b){window.location.href=`files.html?authority=${b.detail.features[0].properties.full_name}&schema=${l}`}function R(){window.location.href=`files.html?authority=${m}&schema=${l}`}const L=()=>a(2,o=!o);function q(b){m=b,a(0,m)}function J(b){F=b,a(4,F)}function k(b){o=b,a(2,o)}return r.$$.update=()=>{r.$$.dirty&1&&a(5,n=D.has(m))},[m,e,o,u,F,n,P,S,R,L,q,J,k]}class at extends ce{constructor(t){super(),de(this,t,nt,et,_e,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new at({target:document.getElementById("app")});
