import{S as ce,i as de,s as _e,e as A,l as be,a as _,b as E,c as L,n as Y,d as M,f as we,E as pe,D as Ae,R as ye,g as Z,h as x,F as Se,j as h,k as ke,m as i,o as v,t as p,p as g,q as Le,r as ee,u as b,v as Me,w as Ce,x as j,y as Ee,z as Te,A as Fe,B as Ie,C as Be,G as $e}from"./index-fdf52a33.js";import{A as Ge,s as He,P as Oe}from"./storage-a1b59902.js";import{A as je}from"./About-075db562.js";import{A as De,L as Je,M as Ne,G as Pe,F as Re,h as qe,a as Ue}from"./MapLibreMap-f0afba9b.js";function ze(a){let t,r,n;return{c(){t=A("div"),t.innerHTML=`<img src="${be}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,r=_(),n=A("div"),E(t,"class","black-bar svelte-13flgp1"),E(n,"class","green-bar svelte-13flgp1")},m(l,e){L(l,t,e),L(l,r,e),L(l,n,e)},p:Y,i:Y,o:Y,d(l){l&&(M(t),M(r),M(n))}}}class Ve extends ce{constructor(t){super(),de(this,t,null,ze,_e,{})}}function Ke(a){let t;return{c(){t=j("About")},m(r,n){L(r,t,n)},d(r){r&&M(t)}}}function me(a){let t,r,n;function l(o){a[10](o)}let e={label:"Select Transport Authority or Local Authority District",options:a[1].features.map(ge)};return a[0]!==void 0&&(e.value=a[0]),t=new Ge({props:e}),Z.push(()=>x(t,"value",l)),{c(){h(t.$$.fragment)},m(o,w){v(t,o,w),n=!0},p(o,w){const u={};w&2&&(u.options=o[1].features.map(ge)),!r&&w&1&&(r=!0,u.value=o[0],ee(()=>r=!1)),t.$set(u)},i(o){n||(p(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){b(t,o)}}}function Qe(a){let t;return{c(){t=j("Start")},m(r,n){L(r,t,n)},d(r){r&&M(t)}}}function We(a){let t,r=a[17].name+"",n,l,e=a[17].level+"",o,w;return{c(){t=A("p"),n=j(r),l=j(" ("),o=j(e),w=j(")")},m(u,c){L(u,t,c),i(t,n),i(t,l),i(t,o),i(t,w)},p(u,c){c&131072&&r!==(r=u[17].name+"")&&$e(n,r),c&131072&&e!==(e=u[17].level+"")&&$e(o,e)},d(u){u&&M(t)}}}function Xe(a){let t,r;return t=new Oe({props:{$$slots:{default:[We,({props:n})=>({17:n}),({props:n})=>n?131072:0]},$$scope:{ctx:a}}}),{c(){h(t.$$.fragment)},m(n,l){v(t,n,l),r=!0},p(n,l){const e={};l&393216&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){r||(p(t.$$.fragment,n),r=!0)},o(n){g(t.$$.fragment,n),r=!1},d(n){b(t,n)}}}function Ye(a){let t,r,n,l;return t=new Re({props:{id:"boundaries",filter:["==",["get","level"],a[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":qe(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[Xe]},$$scope:{ctx:a}}}),t.$on("click",a[7]),n=new Ue({props:{id:"boundaries-outline",filter:["==",["get","level"],a[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){h(t.$$.fragment),r=_(),h(n.$$.fragment)},m(e,o){v(t,e,o),L(e,r,o),v(n,e,o),l=!0},p(e,o){const w={};o&16&&(w.filter=["==",["get","level"],e[4]]),o&262144&&(w.$$scope={dirty:o,ctx:e}),t.$set(w);const u={};o&16&&(u.filter=["==",["get","level"],e[4]]),n.$set(u)},i(e){l||(p(t.$$.fragment,e),p(n.$$.fragment,e),l=!0)},o(e){g(t.$$.fragment,e),g(n.$$.fragment,e),l=!1},d(e){e&&M(r),b(t,e),b(n,e)}}}function Ze(a){let t,r;return t=new Pe({props:{data:a[1],generateId:!0,$$slots:{default:[Ye]},$$scope:{ctx:a}}}),{c(){h(t.$$.fragment)},m(n,l){v(t,n,l),r=!0},p(n,l){const e={};l&2&&(e.data=n[1]),l&262160&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){r||(p(t.$$.fragment,n),r=!0)},o(n){g(t.$$.fragment,n),r=!1},d(n){b(t,n)}}}function xe(a){let t,r,n,l,e,o,w,u,c,D,T,R,y,q,k,U,J,S,z,$,F,f,B,N,G,te,H,ne,O,re,V,P,I,Q,C,W,K;n=new Ve({}),o=new De({}),c=new Je({}),y=new we({props:{$$slots:{default:[Ke]},$$scope:{ctx:a}}}),y.$on("click",a[9]),k=new pe({props:{errorMessage:a[3]}});let m=a[1].features.length>0&&me(a);S=new Ae({props:{disabled:!a[5],$$slots:{default:[Qe]},$$scope:{ctx:a}}}),S.$on("click",a[8]);function he(s){a[11](s)}let ae={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};a[4]!==void 0&&(ae.value=a[4]),f=new ye({props:ae}),Z.push(()=>x(f,"value",he)),H=new pe({props:{errorMessage:et}}),O=new Se({props:{label:"Or upload an ATIP GeoJSON file",onLoad:a[6]}}),I=new Ne({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Ze]},$$scope:{ctx:a}}});function ve(s){a[12](s)}let se={};return a[2]!==void 0&&(se.open=a[2]),C=new je({props:se}),Z.push(()=>x(C,"open",ve)),{c(){t=A("div"),r=A("div"),h(n.$$.fragment),l=_(),e=A("div"),h(o.$$.fragment),w=_(),u=A("div"),h(c.$$.fragment),D=_(),T=A("h1"),T.textContent="Scheme Sketcher",R=_(),h(y.$$.fragment),q=_(),h(k.$$.fragment),U=_(),m&&m.c(),J=_(),h(S.$$.fragment),z=_(),$=A("hr"),F=_(),h(f.$$.fragment),N=_(),G=A("hr"),te=_(),h(H.$$.fragment),ne=_(),h(O.$$.fragment),re=_(),V=A("div"),P=A("div"),h(I.$$.fragment),Q=_(),h(C.$$.fragment),ke(u,"border-bottom","1px solid #b1b4b6"),E(e,"class","left svelte-lyn11h"),E(r,"class","govuk-grid-column-one-half govuk-prose"),E(P,"id","map"),E(P,"class","svelte-lyn11h"),E(V,"class","govuk-grid-column-one-half"),E(t,"class","govuk-grid-row")},m(s,d){L(s,t,d),i(t,r),v(n,r,null),i(r,l),i(r,e),v(o,e,null),i(e,w),i(e,u),v(c,u,null),i(e,D),i(e,T),i(e,R),v(y,e,null),i(e,q),v(k,e,null),i(e,U),m&&m.m(e,null),i(e,J),v(S,e,null),i(e,z),i(e,$),i(e,F),v(f,e,null),i(e,N),i(e,G),i(e,te),v(H,e,null),i(e,ne),v(O,e,null),i(t,re),i(t,V),i(V,P),v(I,P,null),L(s,Q,d),v(C,s,d),K=!0},p(s,[d]){const oe={};d&262144&&(oe.$$scope={dirty:d,ctx:s}),y.$set(oe);const le={};d&8&&(le.errorMessage=s[3]),k.$set(le),s[1].features.length>0?m?(m.p(s,d),d&2&&p(m,1)):(m=me(s),m.c(),p(m,1),m.m(e,J)):m&&(Ee(),g(m,1,1,()=>{m=null}),Le());const X={};d&32&&(X.disabled=!s[5]),d&262144&&(X.$$scope={dirty:d,ctx:s}),S.$set(X);const ie={};!B&&d&16&&(B=!0,ie.value=s[4],ee(()=>B=!1)),f.$set(ie);const ue={};d&262162&&(ue.$$scope={dirty:d,ctx:s}),I.$set(ue);const fe={};!W&&d&4&&(W=!0,fe.open=s[2],ee(()=>W=!1)),C.$set(fe)},i(s){K||(p(n.$$.fragment,s),p(o.$$.fragment,s),p(c.$$.fragment,s),p(y.$$.fragment,s),p(k.$$.fragment,s),p(m),p(S.$$.fragment,s),p(f.$$.fragment,s),p(H.$$.fragment,s),p(O.$$.fragment,s),p(I.$$.fragment,s),p(C.$$.fragment,s),K=!0)},o(s){g(n.$$.fragment,s),g(o.$$.fragment,s),g(c.$$.fragment,s),g(y.$$.fragment,s),g(k.$$.fragment,s),g(m),g(S.$$.fragment,s),g(f.$$.fragment,s),g(H.$$.fragment,s),g(O.$$.fragment,s),g(I.$$.fragment,s),g(C.$$.fragment,s),K=!1},d(s){s&&(M(t),M(Q)),b(n),b(o),b(c),b(y),b(k),m&&m.d(),b(S),b(f),b(H),b(O),b(I),b(C,s)}}}let et="";const ge=a=>[a.properties.full_name,`${a.properties.name} (${a.properties.level})`];function tt(a,t,r){let n,l;Me(a,Be,$=>r(13,l=$));let e={type:"FeatureCollection",features:[]},o=!1,u=new URLSearchParams(window.location.search).get("error")||"",c,D=new Set,T="TA";Ce(async()=>{Te(),r(1,e=await Fe());for(let $ of e.features)D.add($.properties.full_name)});function R($,F){try{let f=JSON.parse(F),B=Ie(f.features,e);if(!B)throw new Error("Can't figure out the authority boundary that fully contains this scheme");f.authority=B;let N=f.authority,G=y(f);G!="v1"&&(N+=`_${G}`),He(N,JSON.stringify(f)),window.location.href=`scheme.html?authority=${f.authority}&schema=${G}`}catch(f){r(3,u=`Couldn't load scheme from a file: ${f}`)}}function y($){if($.features.length>0){let F=$.features[0].properties;for(let f of["pipeline"])if(F&&f in F)return f}return l}function q($){window.location.href=`files.html?authority=${$.detail.features[0].properties.full_name}&schema=${l}`}function k(){window.location.href=`files.html?authority=${c}&schema=${l}`}const U=()=>r(2,o=!o);function J($){c=$,r(0,c)}function S($){T=$,r(4,T)}function z($){o=$,r(2,o)}return a.$$.update=()=>{a.$$.dirty&1&&r(5,n=D.has(c))},[c,e,o,u,T,n,R,q,k,U,J,S,z]}class nt extends ce{constructor(t){super(),de(this,t,tt,xe,_e,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new nt({target:document.getElementById("app")});
