import{S as we,i as Ae,s as ke,e as _,l as Le,a as g,b as F,c as L,n as Z,d as M,f as Me,E as ge,R as Ce,g as x,h as ee,F as ze,j as k,k as Fe,m as u,o as y,t as h,p as w,q as Te,r as te,u as S,v as Ee,w as He,x as P,y as de,z as Be,A as J,B as le,C as De,D as Ge,G as Ie,H as Oe,I as je,J as Pe,K as Je}from"./files-d83d80c1.js";import{A as Ne,P as Re}from"./Popup-8b01803a.js";import{A as qe,L as Ue,D as Ke,M as Ve,G as Qe,F as We,h as Xe,a as Ye}from"./MapLibreMap-7b6d9200.js";import{A as Ze}from"./About-aeac118f.js";function xe(r){let t,n,l;return{c(){t=_("div"),t.innerHTML=`<img src="${Le}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,n=g(),l=_("div"),F(t,"class","black-bar svelte-13flgp1"),F(l,"class","green-bar svelte-13flgp1")},m(a,e){L(a,t,e),L(a,n,e),L(a,l,e)},p:Z,i:Z,o:Z,d(a){a&&(M(t),M(n),M(l))}}}class et extends we{constructor(t){super(),Ae(this,t,null,xe,ke,{})}}function _e(r,t,n){const l=r.slice();return l[20]=t[n][0],l[21]=t[n][1],l}function tt(r){let t;return{c(){t=P("About")},m(n,l){L(n,t,l)},d(n){n&&M(t)}}}function he(r){let t,n,l;function a(o){r[14](o)}let e={label:"Select Transport Authority or Local Authority District",options:r[1].features.map(r[13])};return r[0]!==void 0&&(e.value=r[0]),t=new Ne({props:e}),x.push(()=>ee(t,"value",a)),{c(){k(t.$$.fragment)},m(o,b){y(t,o,b),l=!0},p(o,b){const c={};b&2&&(c.options=o[1].features.map(o[13])),!n&&b&1&&(n=!0,c.value=o[0],te(()=>n=!1)),t.$set(c)},i(o){l||(h(t.$$.fragment,o),l=!0)},o(o){w(t.$$.fragment,o),l=!1},d(o){S(t,o)}}}function lt(r){let t;return{c(){t=P("Start")},m(n,l){L(n,t,l)},d(n){n&&M(t)}}}function be(r){let t,n,l,a,e,o,b,c,d=de(r[5]),p=[];for(let f=0;f<d.length;f+=1)p[f]=ve(_e(r,d,f));return{c(){t=_("hr"),n=g(),l=_("p"),l.textContent="Or choose an area with existing files",a=g(),e=_("table"),o=_("thead"),o.innerHTML="<tr><th>Area</th> <th>Number of files</th></tr>",b=g(),c=_("tbody");for(let f=0;f<p.length;f+=1)p[f].c()},m(f,m){L(f,t,m),L(f,n,m),L(f,l,m),L(f,a,m),L(f,e,m),u(e,o),u(e,b),u(e,c);for(let i=0;i<p.length;i+=1)p[i]&&p[i].m(c,null)},p(f,m){if(m&160){d=de(f[5]);let i;for(i=0;i<d.length;i+=1){const H=_e(f,d,i);p[i]?p[i].p(H,m):(p[i]=ve(H),p[i].c(),p[i].m(c,null))}for(;i<p.length;i+=1)p[i].d(1);p.length=d.length}},d(f){f&&(M(t),M(n),M(l),M(a),M(e)),Be(p,f)}}}function ve(r){let t,n,l,a=J(r[20])+"",e,o,b,c,d=r[21]+"",p,f;return{c(){t=_("tr"),n=_("td"),l=_("a"),e=P(a),b=g(),c=_("td"),p=P(d),f=g(),F(l,"href",o=`files.html?authority=${r[20]}&schema=${r[7]}`)},m(m,i){L(m,t,i),u(t,n),u(n,l),u(l,e),u(t,b),u(t,c),u(c,p),u(t,f)},p(m,i){i&32&&a!==(a=J(m[20])+"")&&le(e,a),i&160&&o!==(o=`files.html?authority=${m[20]}&schema=${m[7]}`)&&F(l,"href",o),i&32&&d!==(d=m[21]+"")&&le(p,d)},d(m){m&&M(t)}}}function nt(r){let t,n=J(r[19].full_name)+"",l;return{c(){t=_("p"),l=P(n)},m(a,e){L(a,t,e),u(t,l)},p(a,e){e&524288&&n!==(n=J(a[19].full_name)+"")&&le(l,n)},d(a){a&&M(t)}}}function rt(r){let t,n;return t=new Re({props:{$$slots:{default:[nt,({props:l})=>({19:l}),({props:l})=>l?524288:0]},$$scope:{ctx:r}}}),{c(){k(t.$$.fragment)},m(l,a){y(t,l,a),n=!0},p(l,a){const e={};a&17301504&&(e.$$scope={dirty:a,ctx:l}),t.$set(e)},i(l){n||(h(t.$$.fragment,l),n=!0)},o(l){w(t.$$.fragment,l),n=!1},d(l){S(t,l)}}}function st(r){let t,n,l,a;return t=new We({props:{id:"boundaries",filter:["==",["get","level"],r[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":Xe(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[rt]},$$scope:{ctx:r}}}),t.$on("click",r[9]),l=new Ye({props:{id:"boundaries-outline",filter:["==",["get","level"],r[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){k(t.$$.fragment),n=g(),k(l.$$.fragment)},m(e,o){y(t,e,o),L(e,n,o),y(l,e,o),a=!0},p(e,o){const b={};o&16&&(b.filter=["==",["get","level"],e[4]]),o&16777216&&(b.$$scope={dirty:o,ctx:e}),t.$set(b);const c={};o&16&&(c.filter=["==",["get","level"],e[4]]),l.$set(c)},i(e){a||(h(t.$$.fragment,e),h(l.$$.fragment,e),a=!0)},o(e){w(t.$$.fragment,e),w(l.$$.fragment,e),a=!1},d(e){e&&M(n),S(t,e),S(l,e)}}}function at(r){let t,n;return t=new Qe({props:{data:r[1],generateId:!0,$$slots:{default:[st]},$$scope:{ctx:r}}}),{c(){k(t.$$.fragment)},m(l,a){y(t,l,a),n=!0},p(l,a){const e={};a&2&&(e.data=l[1]),a&16777232&&(e.$$scope={dirty:a,ctx:l}),t.$set(e)},i(l){n||(h(t.$$.fragment,l),n=!0)},o(l){w(t.$$.fragment,l),n=!1},d(l){S(t,l)}}}function ot(r){let t,n,l,a,e,o,b,c,d,p,f,m,i,H,T,N,I,z,R,q,U,$,O,K,ne,re,B,se,G,ae,oe,V,j,D,W,E,X,Q;l=new et({}),o=new qe({}),d=new Ue({}),i=new Me({props:{$$slots:{default:[tt]},$$scope:{ctx:r}}}),i.$on("click",r[12]),T=new ge({props:{errorMessage:r[8]}});let v=r[1].features.length>0&&he(r);z=new Ke({props:{disabled:!r[6],$$slots:{default:[lt]},$$scope:{ctx:r}}}),z.$on("click",r[10]);function ye(s){r[15](s)}let ie={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};r[4]!==void 0&&(ie.value=r[4]),$=new Ce({props:ie}),x.push(()=>ee($,"value",ye)),B=new ge({props:{errorMessage:r[3]}}),G=new ze({props:{label:"Or import a GeoJSON file",onLoad:r[11]}});let C=r[5].length>0&&be(r);D=new Ve({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[at]},$$scope:{ctx:r}}});function Se(s){r[16](s)}let ue={};return r[2]!==void 0&&(ue.open=r[2]),E=new Ze({props:ue}),x.push(()=>ee(E,"open",Se)),{c(){t=_("div"),n=_("div"),k(l.$$.fragment),a=g(),e=_("div"),k(o.$$.fragment),b=g(),c=_("div"),k(d.$$.fragment),p=g(),f=_("h1"),f.textContent="Scheme Sketcher",m=g(),k(i.$$.fragment),H=g(),k(T.$$.fragment),N=g(),v&&v.c(),I=g(),k(z.$$.fragment),R=g(),q=_("hr"),U=g(),k($.$$.fragment),K=g(),ne=_("hr"),re=g(),k(B.$$.fragment),se=g(),k(G.$$.fragment),ae=g(),C&&C.c(),oe=g(),V=_("div"),j=_("div"),k(D.$$.fragment),W=g(),k(E.$$.fragment),Fe(c,"border-bottom","1px solid #b1b4b6"),F(e,"class","left svelte-zzzis3"),F(n,"class","govuk-grid-column-one-half govuk-prose left-scroll svelte-zzzis3"),F(j,"id","map"),F(j,"class","svelte-zzzis3"),F(V,"class","govuk-grid-column-one-half"),F(t,"class","govuk-grid-row")},m(s,A){L(s,t,A),u(t,n),y(l,n,null),u(n,a),u(n,e),y(o,e,null),u(e,b),u(e,c),y(d,c,null),u(e,p),u(e,f),u(e,m),y(i,e,null),u(e,H),y(T,e,null),u(e,N),v&&v.m(e,null),u(e,I),y(z,e,null),u(e,R),u(e,q),u(e,U),y($,e,null),u(e,K),u(e,ne),u(e,re),y(B,e,null),u(e,se),y(G,e,null),u(e,ae),C&&C.m(e,null),u(t,oe),u(t,V),u(V,j),y(D,j,null),L(s,W,A),y(E,s,A),Q=!0},p(s,[A]){const fe={};A&16777216&&(fe.$$scope={dirty:A,ctx:s}),i.$set(fe),s[1].features.length>0?v?(v.p(s,A),A&2&&h(v,1)):(v=he(s),v.c(),h(v,1),v.m(e,I)):v&&(De(),w(v,1,1,()=>{v=null}),Te());const Y={};A&64&&(Y.disabled=!s[6]),A&16777216&&(Y.$$scope={dirty:A,ctx:s}),z.$set(Y);const pe={};!O&&A&16&&(O=!0,pe.value=s[4],te(()=>O=!1)),$.$set(pe);const $e={};A&8&&($e.errorMessage=s[3]),B.$set($e),s[5].length>0?C?C.p(s,A):(C=be(s),C.c(),C.m(e,null)):C&&(C.d(1),C=null);const me={};A&16777234&&(me.$$scope={dirty:A,ctx:s}),D.$set(me);const ce={};!X&&A&4&&(X=!0,ce.open=s[2],te(()=>X=!1)),E.$set(ce)},i(s){Q||(h(l.$$.fragment,s),h(o.$$.fragment,s),h(d.$$.fragment,s),h(i.$$.fragment,s),h(T.$$.fragment,s),h(v),h(z.$$.fragment,s),h($.$$.fragment,s),h(B.$$.fragment,s),h(G.$$.fragment,s),h(D.$$.fragment,s),h(E.$$.fragment,s),Q=!0)},o(s){w(l.$$.fragment,s),w(o.$$.fragment,s),w(d.$$.fragment,s),w(i.$$.fragment,s),w(T.$$.fragment,s),w(v),w(z.$$.fragment,s),w($.$$.fragment,s),w(B.$$.fragment,s),w(G.$$.fragment,s),w(D.$$.fragment,s),w(E.$$.fragment,s),Q=!1},d(s){s&&(M(t),M(W)),S(l),S(o),S(d),S(i),S(T),v&&v.d(),S(z),S($),S(B),S(G),C&&C.d(),S(D),S(E,s)}}}function it(r,t,n){let l,a;Ee(r,Je,$=>n(7,a=$));let e={type:"FeatureCollection",features:[]},o=!1,c=new URLSearchParams(window.location.search).get("error")||"",d="",p,f=new Set,m="TA",i=[];He(async()=>{Ge(),n(1,e=await Ie());for(let $ of e.features)f.add($.properties.full_name),Oe($.properties.full_name);n(5,i=je())});function H($){window.location.href=`files.html?authority=${$.detail.features[0].properties.full_name}&schema=${a}`}function T(){window.location.href=`files.html?authority=${p}&schema=${a}`}function N($,O){try{window.location.href=Pe($,O,e)}catch(K){n(3,d=`Couldn't import file: ${K}`)}}const I=()=>n(2,o=!o),z=$=>[$.properties.full_name,J($.properties.full_name)];function R($){p=$,n(0,p)}function q($){m=$,n(4,m)}function U($){o=$,n(2,o)}return r.$$.update=()=>{r.$$.dirty&1&&n(6,l=f.has(p))},[p,e,o,d,m,i,l,a,c,H,T,N,I,z,R,q,U]}class ut extends we{constructor(t){super(),Ae(this,t,it,ot,ke,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new ut({target:document.getElementById("app")});
