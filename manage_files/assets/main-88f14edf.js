import{S as _e,i as he,s as ve,e as A,l as Ae,a as c,b as E,c as L,n as Y,d as C,f as ye,E as me,D as Se,R as ke,g as Z,h as x,F as Le,j as _,k as Ce,m as Me,o as i,p as h,t as p,q as m,r as Ee,u as ee,v,w as Te,x as Fe,y as O,z as He,A as Ie,B as Be,C as Ge,G as Oe,H as ge}from"./index-db5d9753.js";import{A as je,s as De,P as Je}from"./storage-4ce86fbb.js";import{A as Ne}from"./About-aef6b033.js";import{A as Pe,L as Re,M as qe,G as Ue,F as Ve,h as ze,a as Ke}from"./MapLibreMap-0dc6aec0.js";function Qe(a){let t,r,n;return{c(){t=A("div"),t.innerHTML=`<img src="${Ae}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,r=c(),n=A("div"),E(t,"class","black-bar svelte-13flgp1"),E(n,"class","green-bar svelte-13flgp1")},m(l,e){L(l,t,e),L(l,r,e),L(l,n,e)},p:Y,i:Y,o:Y,d(l){l&&(C(t),C(r),C(n))}}}class We extends _e{constructor(t){super(),he(this,t,null,Qe,ve,{})}}function Xe(a){let t;return{c(){t=O("About")},m(r,n){L(r,t,n)},d(r){r&&C(t)}}}function ce(a){let t,r,n;function l(o){a[10](o)}let e={label:"Select Transport Authority or Local Authority District",options:a[1].features.map(de)};return a[0]!==void 0&&(e.value=a[0]),t=new je({props:e}),Z.push(()=>x(t,"value",l)),{c(){_(t.$$.fragment)},m(o,b){h(t,o,b),n=!0},p(o,b){const f={};b&2&&(f.options=o[1].features.map(de)),!r&&b&1&&(r=!0,f.value=o[0],ee(()=>r=!1)),t.$set(f)},i(o){n||(p(t.$$.fragment,o),n=!0)},o(o){m(t.$$.fragment,o),n=!1},d(o){v(t,o)}}}function Ye(a){let t;return{c(){t=O("Start")},m(r,n){L(r,t,n)},d(r){r&&C(t)}}}function Ze(a){let t,r=a[17].name+"",n,l,e=a[17].level+"",o,b;return{c(){t=A("p"),n=O(r),l=O(" ("),o=O(e),b=O(")")},m(f,g){L(f,t,g),i(t,n),i(t,l),i(t,o),i(t,b)},p(f,g){g&131072&&r!==(r=f[17].name+"")&&ge(n,r),g&131072&&e!==(e=f[17].level+"")&&ge(o,e)},d(f){f&&C(t)}}}function xe(a){let t,r;return t=new Je({props:{$$slots:{default:[Ze,({props:n})=>({17:n}),({props:n})=>n?131072:0]},$$scope:{ctx:a}}}),{c(){_(t.$$.fragment)},m(n,l){h(t,n,l),r=!0},p(n,l){const e={};l&393216&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){r||(p(t.$$.fragment,n),r=!0)},o(n){m(t.$$.fragment,n),r=!1},d(n){v(t,n)}}}function et(a){let t,r,n,l;return t=new Ve({props:{id:"boundaries",filter:["==",["get","level"],a[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":ze(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[xe]},$$scope:{ctx:a}}}),t.$on("click",a[7]),n=new Ke({props:{id:"boundaries-outline",filter:["==",["get","level"],a[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){_(t.$$.fragment),r=c(),_(n.$$.fragment)},m(e,o){h(t,e,o),L(e,r,o),h(n,e,o),l=!0},p(e,o){const b={};o&16&&(b.filter=["==",["get","level"],e[4]]),o&262144&&(b.$$scope={dirty:o,ctx:e}),t.$set(b);const f={};o&16&&(f.filter=["==",["get","level"],e[4]]),n.$set(f)},i(e){l||(p(t.$$.fragment,e),p(n.$$.fragment,e),l=!0)},o(e){m(t.$$.fragment,e),m(n.$$.fragment,e),l=!1},d(e){e&&C(r),v(t,e),v(n,e)}}}function tt(a){let t,r;return t=new Ue({props:{data:a[1],generateId:!0,$$slots:{default:[et]},$$scope:{ctx:a}}}),{c(){_(t.$$.fragment)},m(n,l){h(t,n,l),r=!0},p(n,l){const e={};l&2&&(e.data=n[1]),l&262160&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){r||(p(t.$$.fragment,n),r=!0)},o(n){m(t.$$.fragment,n),r=!1},d(n){v(t,n)}}}function nt(a){let t,r,n,l,e,o,b,f,g,j,T,R,D,q,S,U,k,V,J,u,F,w,N,y,H,te,ne,re,B,ae,G,se,z,P,I,Q,M,W,K;n=new We({}),o=new Pe({}),g=new Re({}),S=new ye({props:{$$slots:{default:[Xe]},$$scope:{ctx:a}}}),S.$on("click",a[9]),k=new me({props:{errorMessage:a[3]}});let $=a[1].features.length>0&&ce(a);u=new Se({props:{disabled:!a[5],$$slots:{default:[Ye]},$$scope:{ctx:a}}}),u.$on("click",a[8]);function be(s){a[11](s)}let oe={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};a[4]!==void 0&&(oe.value=a[4]),y=new ke({props:oe}),Z.push(()=>x(y,"value",be)),B=new me({props:{errorMessage:rt}}),G=new Le({props:{label:"Or upload an ATIP GeoJSON file",onLoad:a[6]}}),I=new qe({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[tt]},$$scope:{ctx:a}}});function we(s){a[12](s)}let le={};return a[2]!==void 0&&(le.open=a[2]),M=new Ne({props:le}),Z.push(()=>x(M,"open",we)),{c(){t=A("div"),r=A("div"),_(n.$$.fragment),l=c(),e=A("div"),_(o.$$.fragment),b=c(),f=A("div"),_(g.$$.fragment),j=c(),T=A("p"),T.textContent=`App version: ${Ce()}`,R=c(),D=A("h1"),D.textContent="Scheme Sketcher",q=c(),_(S.$$.fragment),U=c(),_(k.$$.fragment),V=c(),$&&$.c(),J=c(),_(u.$$.fragment),F=c(),w=A("hr"),N=c(),_(y.$$.fragment),te=c(),ne=A("hr"),re=c(),_(B.$$.fragment),ae=c(),_(G.$$.fragment),se=c(),z=A("div"),P=A("div"),_(I.$$.fragment),Q=c(),_(M.$$.fragment),Me(f,"border-bottom","1px solid #b1b4b6"),E(e,"class","left svelte-lyn11h"),E(r,"class","govuk-grid-column-one-half govuk-prose"),E(P,"id","map"),E(P,"class","svelte-lyn11h"),E(z,"class","govuk-grid-column-one-half"),E(t,"class","govuk-grid-row")},m(s,d){L(s,t,d),i(t,r),h(n,r,null),i(r,l),i(r,e),h(o,e,null),i(e,b),i(e,f),h(g,f,null),i(f,j),i(f,T),i(e,R),i(e,D),i(e,q),h(S,e,null),i(e,U),h(k,e,null),i(e,V),$&&$.m(e,null),i(e,J),h(u,e,null),i(e,F),i(e,w),i(e,N),h(y,e,null),i(e,te),i(e,ne),i(e,re),h(B,e,null),i(e,ae),h(G,e,null),i(t,se),i(t,z),i(z,P),h(I,P,null),L(s,Q,d),h(M,s,d),K=!0},p(s,[d]){const ie={};d&262144&&(ie.$$scope={dirty:d,ctx:s}),S.$set(ie);const ue={};d&8&&(ue.errorMessage=s[3]),k.$set(ue),s[1].features.length>0?$?($.p(s,d),d&2&&p($,1)):($=ce(s),$.c(),p($,1),$.m(e,J)):$&&(He(),m($,1,1,()=>{$=null}),Ee());const X={};d&32&&(X.disabled=!s[5]),d&262144&&(X.$$scope={dirty:d,ctx:s}),u.$set(X);const fe={};!H&&d&16&&(H=!0,fe.value=s[4],ee(()=>H=!1)),y.$set(fe);const pe={};d&262162&&(pe.$$scope={dirty:d,ctx:s}),I.$set(pe);const $e={};!W&&d&4&&(W=!0,$e.open=s[2],ee(()=>W=!1)),M.$set($e)},i(s){K||(p(n.$$.fragment,s),p(o.$$.fragment,s),p(g.$$.fragment,s),p(S.$$.fragment,s),p(k.$$.fragment,s),p($),p(u.$$.fragment,s),p(y.$$.fragment,s),p(B.$$.fragment,s),p(G.$$.fragment,s),p(I.$$.fragment,s),p(M.$$.fragment,s),K=!0)},o(s){m(n.$$.fragment,s),m(o.$$.fragment,s),m(g.$$.fragment,s),m(S.$$.fragment,s),m(k.$$.fragment,s),m($),m(u.$$.fragment,s),m(y.$$.fragment,s),m(B.$$.fragment,s),m(G.$$.fragment,s),m(I.$$.fragment,s),m(M.$$.fragment,s),K=!1},d(s){s&&(C(t),C(Q)),v(n),v(o),v(g),v(S),v(k),$&&$.d(),v(u),v(y),v(B),v(G),v(I),v(M,s)}}}let rt="";const de=a=>[a.properties.full_name,`${a.properties.name} (${a.properties.level})`];function at(a,t,r){let n,l;Te(a,Oe,u=>r(13,l=u));let e={type:"FeatureCollection",features:[]},o=!1,f=new URLSearchParams(window.location.search).get("error")||"",g,j=new Set,T="TA";Fe(async()=>{Ie(),r(1,e=await Be());for(let u of e.features)j.add(u.properties.full_name)});function R(u,F){try{let w=JSON.parse(F),N=Ge(w.features,e);if(!N)throw new Error("Can't figure out the authority boundary that fully contains this scheme");w.authority=N;let y=w.authority,H=D(w);H!="v1"&&(y+=`_${H}`),De(y,JSON.stringify(w)),window.location.href=`scheme.html?authority=${w.authority}&schema=${H}`}catch(w){r(3,f=`Couldn't load scheme from a file: ${w}`)}}function D(u){if(u.features.length>0){let F=u.features[0].properties;for(let w of["pipeline"])if(F&&w in F)return w}return l}function q(u){window.location.href=`files.html?authority=${u.detail.features[0].properties.full_name}&schema=${l}`}function S(){window.location.href=`files.html?authority=${g}&schema=${l}`}const U=()=>r(2,o=!o);function k(u){g=u,r(0,g)}function V(u){T=u,r(4,T)}function J(u){o=u,r(2,o)}return a.$$.update=()=>{a.$$.dirty&1&&r(5,n=j.has(g))},[g,e,o,f,T,n,R,q,S,U,k,V,J]}class st extends _e{constructor(t){super(),he(this,t,at,nt,ve,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new st({target:document.getElementById("app")});
