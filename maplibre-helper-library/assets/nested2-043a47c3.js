import{S as z,i as G,s as j,b as K,c as Z,I as Q,g as _,f as A,m as w,j as m,o as q,t as g,l as d,p as h,q as k,Y as J,B as X,M as H,u as b,x as te,e as M,h as F,aG as R,k as S,T as Ae,V as de,U as Ye,R as ae,y as be,n as ve,_ as Pe,r as tt,F as Yt,a as Fe,v as ct,w as Qt,C as Bt,H as Nt,J as At,K as Mt,aH as ft,a6 as Ot,d as Xt,z as en,E as tn,a3 as nn}from"./MapLibreMap.svelte_svelte_type_style_lang-c000e451.js";import{d as ee,j as me,H as ne,S as Qe,h as rn,i as $t,g as Pt,C as De,a as on,L as sn,Z as ln,M as an,I as un,B as cn,b as nt}from"./schemas-de664d5a.js";const fn=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"],V={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function $n(o){let e,n,t;return e=new me({props:{color:V.bus_route_with_lane}}),{c(){_(e.$$.fragment),n=b(`
  Bus routes`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function pn(o){let e;return{c(){e=b(`GTFS
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function mn(o){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function hn(o){let e,n,t,r,s,a,f,l,c,i,u;return s=new R({props:{href:"https://gtfs.org",$$slots:{default:[pn]},$$scope:{ctx:o}}}),i=new R({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[mn]},$$scope:{ctx:o}}}),{c(){e=M("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,n=A(),t=M("p"),r=b("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),a=b(`, and doesn't include which routes are run or the
        frequency of service.`),f=A(),l=M("p"),c=b("License: "),_(i.$$.fragment)},m($,p){m($,e,p),m($,n,p),m($,t,p),S(t,r),w(s,t,null),S(t,a),m($,f,p),m($,l,p),S(l,c),w(i,l,null),u=!0},p($,p){const y={};p&8&&(y.$$scope={dirty:p,ctx:$}),s.$set(y);const v={};p&8&&(v.$$scope={dirty:p,ctx:$}),i.$set(v)},i($){u||(g(s.$$.fragment,$),g(i.$$.fragment,$),u=!0)},o($){d(s.$$.fragment,$),d(i.$$.fragment,$),u=!1},d($){$&&(h(e),h(n),h(t),h(f),h(l)),k(s),k(i)}}}function gn(o){let e,n,t;return n=new ne({props:{$$slots:{default:[hn]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&8&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function dn(o){let e,n,t,r,s;function a(l){o[1](l)}let f={id:Se,$$slots:{right:[gn],default:[$n]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:Se,tooltip:_n,show:o[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&8&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Se="bus_routes";function _n(o){return o.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function wn(o,e,n){let t;J(o,X,a=>n(2,t=a)),H.overwritePmtilesSource(t,Se,`https://atip.uk/layers/v1/${Se}.pmtiles`),H.overwriteLineLayer(t,{id:Se,source:Se,sourceLayer:Se,color:["case",["boolean",["get","has_bus_lane"],!1],V.bus_route_with_lane,V.bus_route_without_lane],width:5,opacity:H.hoveredToggle(.5,1)});let r=!1;function s(a){r=a,n(0,r)}return[r,s]}class kn extends z{constructor(e){super(),G(this,e,wn,dn,j,{})}}function pt(o,e,n){const t=o.slice();return t[2]=e[n],t}function mt(o,e,n){const t=o.slice();return t[5]=e[n],t}function ht(o){let e,n;return{c(){e=M("span"),n=b(`Â 
    `),de(e,"background",o[5]),de(e,"width","100%"),de(e,"border","1px solid black")},m(t,r){m(t,e,r),S(e,n)},p(t,r){r&1&&de(e,"background",t[5])},d(t){t&&h(e)}}}function gt(o){let e,n=o[2]+"",t;return{c(){e=M("span"),t=b(n)},m(r,s){m(r,e,s),S(e,t)},p(r,s){s&2&&n!==(n=r[2]+"")&&ae(t,n)},d(r){r&&h(e)}}}function bn(o){let e,n,t,r=Ae(o[0]),s=[];for(let l=0;l<r.length;l+=1)s[l]=ht(mt(o,r,l));let a=Ae(o[1]),f=[];for(let l=0;l<a.length;l+=1)f[l]=gt(pt(o,a,l));return{c(){e=M("div");for(let l=0;l<s.length;l+=1)s[l].c();n=A(),t=M("div");for(let l=0;l<f.length;l+=1)f[l].c();de(e,"display","flex"),de(t,"display","flex"),de(t,"justify-content","space-between")},m(l,c){m(l,e,c);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);m(l,n,c),m(l,t,c);for(let i=0;i<f.length;i+=1)f[i]&&f[i].m(t,null)},p(l,[c]){if(c&1){r=Ae(l[0]);let i;for(i=0;i<r.length;i+=1){const u=mt(l,r,i);s[i]?s[i].p(u,c):(s[i]=ht(u),s[i].c(),s[i].m(e,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=r.length}if(c&2){a=Ae(l[1]);let i;for(i=0;i<a.length;i+=1){const u=pt(l,a,i);f[i]?f[i].p(u,c):(f[i]=gt(u),f[i].c(),f[i].m(t,null))}for(;i<f.length;i+=1)f[i].d(1);f.length=a.length}},i:te,o:te,d(l){l&&(h(e),h(n),h(t)),Ye(s,l),Ye(f,l)}}}function vn(o,e,n){let{colorScale:t}=e,{limits:r}=e;return o.$$set=s=>{"colorScale"in s&&n(0,t=s.colorScale),"limits"in s&&n(1,r=s.limits)},[t,r]}class Ge extends z{constructor(e){super(),G(this,e,vn,bn,j,{colorScale:0,limits:1})}}function yn(o){let e;return{c(){e=b("Percent of households with a car")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ln(o){let e;return{c(){e=b(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Sn(o){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Cn(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Tn(o){let e,n,t,r,s,a,f,l,c,i,u,$;return t=new R({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ln]},$$scope:{ctx:o}}}),s=new R({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Sn]},$$scope:{ctx:o}}}),i=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Cn]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Car/van availability data is from the 2021 census, via "),_(t.$$.fragment),r=b(". Output area boundaries from "),_(s.$$.fragment),a=b("."),f=A(),l=M("p"),c=b("License: "),_(i.$$.fragment),u=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(s,e,null),S(e,a),m(p,f,y),m(p,l,y),S(l,c),w(i,l,null),S(l,u),$=!0},p(p,y){const v={};y&65536&&(v.$$scope={dirty:y,ctx:p}),t.$set(v);const C={};y&65536&&(C.$$scope={dirty:y,ctx:p}),s.$set(C);const B={};y&65536&&(B.$$scope={dirty:y,ctx:p}),i.$set(B)},i(p){$||(g(t.$$.fragment,p),g(s.$$.fragment,p),g(i.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(s.$$.fragment,p),d(i.$$.fragment,p),$=!1},d(p){p&&(h(e),h(f),h(l)),k(t),k(s),k(i)}}}function Dn(o){let e,n,t;return n=new ne({props:{$$slots:{default:[Tn]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function dt(o){let e,n;return e=new Ge({props:{colorScale:o[4],limits:o[7]()}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:te,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Bn(o){let e;return{c(){e=b("Average cars per household")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Nn(o){let e;return{c(){e=b(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function An(o){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Mn(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function On(o){let e,n,t,r,s,a,f,l,c,i,u,$,p,y;return s=new R({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Nn]},$$scope:{ctx:o}}}),f=new R({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[An]},$$scope:{ctx:o}}}),$=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Mn]},$$scope:{ctx:o}}}),{c(){e=M("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,n=A(),t=M("p"),r=b("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),a=b(". Output area boundaries from "),_(f.$$.fragment),l=b("."),c=A(),i=M("p"),u=b("License: "),_($.$$.fragment),p=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(v,C){m(v,e,C),m(v,n,C),m(v,t,C),S(t,r),w(s,t,null),S(t,a),w(f,t,null),S(t,l),m(v,c,C),m(v,i,C),S(i,u),w($,i,null),S(i,p),y=!0},p(v,C){const B={};C&65536&&(B.$$scope={dirty:C,ctx:v}),s.$set(B);const D={};C&65536&&(D.$$scope={dirty:C,ctx:v}),f.$set(D);const O={};C&65536&&(O.$$scope={dirty:C,ctx:v}),$.$set(O)},i(v){y||(g(s.$$.fragment,v),g(f.$$.fragment,v),g($.$$.fragment,v),y=!0)},o(v){d(s.$$.fragment,v),d(f.$$.fragment,v),d($.$$.fragment,v),y=!1},d(v){v&&(h(e),h(n),h(t),h(c),h(i)),k(s),k(f),k($)}}}function Pn(o){let e,n,t;return n=new ne({props:{$$slots:{default:[On]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function _t(o){let e,n;return e=new Ge({props:{colorScale:o[4],limits:o[7]()}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:te,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function En(o){let e;return{c(){e=b("Population density")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function xn(o){let e;return{c(){e=b(`NOMIS TS006
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Hn(o){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Un(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Rn(o){let e,n,t,r,s,a,f,l,c,i,u,$;return t=new R({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[xn]},$$scope:{ctx:o}}}),s=new R({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Hn]},$$scope:{ctx:o}}}),i=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Un]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Population density data is from the 2021 census, via "),_(t.$$.fragment),r=b(". Output area boundaries from "),_(s.$$.fragment),a=b("."),f=A(),l=M("p"),c=b("License: "),_(i.$$.fragment),u=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(s,e,null),S(e,a),m(p,f,y),m(p,l,y),S(l,c),w(i,l,null),S(l,u),$=!0},p(p,y){const v={};y&65536&&(v.$$scope={dirty:y,ctx:p}),t.$set(v);const C={};y&65536&&(C.$$scope={dirty:y,ctx:p}),s.$set(C);const B={};y&65536&&(B.$$scope={dirty:y,ctx:p}),i.$set(B)},i(p){$||(g(t.$$.fragment,p),g(s.$$.fragment,p),g(i.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(s.$$.fragment,p),d(i.$$.fragment,p),$=!1},d(p){p&&(h(e),h(f),h(l)),k(t),k(s),k(i)}}}function Wn(o){let e,n,t;return n=new ne({props:{$$slots:{default:[Rn]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function wt(o){let e,n,t,r;return t=new Ge({props:{colorScale:o[4],limits:o[7]().map(Fn)}}),{c(){e=M("p"),e.textContent="(people per square kilometres)",n=A(),_(t.$$.fragment)},m(s,a){m(s,e,a),m(s,n,a),w(t,s,a),r=!0},p:te,i(s){r||(g(t.$$.fragment,s),r=!0)},o(s){d(t.$$.fragment,s),r=!1},d(s){s&&(h(e),h(n)),k(t,s)}}}function In(o){let e,n,t,r,s,a,f,l,c,i,u,$,p,y;function v(T){o[9](T)}let C={id:"percent_households_with_car",$$slots:{right:[Dn],default:[yn]},$$scope:{ctx:o}};o[0]!==void 0&&(C.checked=o[0]),e=new ee({props:C}),K.push(()=>Z(e,"checked",v)),e.$on("change",o[10]);let B=o[3]=="percent_households_with_car"&&dt(o);function D(T){o[11](T)}let O={id:"average_cars_per_household",$$slots:{right:[Pn],default:[Bn]},$$scope:{ctx:o}};o[1]!==void 0&&(O.checked=o[1]),s=new ee({props:O}),K.push(()=>Z(s,"checked",D)),s.$on("change",o[12]);let L=o[3]=="average_cars_per_household"&&_t(o);function N(T){o[13](T)}let U={id:"population_density",$$slots:{right:[Wn],default:[En]},$$scope:{ctx:o}};o[2]!==void 0&&(U.checked=o[2]),c=new ee({props:U}),K.push(()=>Z(c,"checked",N)),c.$on("change",o[14]);let P=o[3]=="population_density"&&wt(o);return p=new Q({props:{layer:ue,tooltip:o[5],show:o[3]!="",clickable:!0}}),p.$on("click",o[6]),{c(){_(e.$$.fragment),t=A(),B&&B.c(),r=A(),_(s.$$.fragment),f=A(),L&&L.c(),l=A(),_(c.$$.fragment),u=A(),P&&P.c(),$=A(),_(p.$$.fragment)},m(T,x){w(e,T,x),m(T,t,x),B&&B.m(T,x),m(T,r,x),w(s,T,x),m(T,f,x),L&&L.m(T,x),m(T,l,x),w(c,T,x),m(T,u,x),P&&P.m(T,x),m(T,$,x),w(p,T,x),y=!0},p(T,[x]){const E={};x&65536&&(E.$$scope={dirty:x,ctx:T}),!n&&x&1&&(n=!0,E.checked=T[0],q(()=>n=!1)),e.$set(E),T[3]=="percent_households_with_car"?B?(B.p(T,x),x&8&&g(B,1)):(B=dt(T),B.c(),g(B,1),B.m(r.parentNode,r)):B&&(be(),d(B,1,1,()=>{B=null}),ve());const I={};x&65536&&(I.$$scope={dirty:x,ctx:T}),!a&&x&2&&(a=!0,I.checked=T[1],q(()=>a=!1)),s.$set(I),T[3]=="average_cars_per_household"?L?(L.p(T,x),x&8&&g(L,1)):(L=_t(T),L.c(),g(L,1),L.m(l.parentNode,l)):L&&(be(),d(L,1,1,()=>{L=null}),ve());const _e={};x&65536&&(_e.$$scope={dirty:x,ctx:T}),!i&&x&4&&(i=!0,_e.checked=T[2],q(()=>i=!1)),c.$set(_e),T[3]=="population_density"?P?(P.p(T,x),x&8&&g(P,1)):(P=wt(T),P.c(),g(P,1),P.m($.parentNode,$)):P&&(be(),d(P,1,1,()=>{P=null}),ve());const ye={};x&8&&(ye.show=T[3]!=""),p.$set(ye)},i(T){y||(g(e.$$.fragment,T),g(B),g(s.$$.fragment,T),g(L),g(c.$$.fragment,T),g(P),g(p.$$.fragment,T),y=!0)},o(T){d(e.$$.fragment,T),d(B),d(s.$$.fragment,T),d(L),d(c.$$.fragment,T),d(P),d(p.$$.fragment,T),y=!1},d(T){T&&(h(t),h(r),h(f),h(l),h(u),h($)),k(e,T),B&&B.d(T),k(s,T),L&&L.d(T),k(c,T),P&&P.d(T),k(p,T)}}}let ue="census_output_areas";const Fn=o=>o.toLocaleString();function zn(o,e,n){let t;J(o,X,O=>n(8,t=O));let r=`${ue}-outline`,s=V.sequential_low_to_high,a=!1,f=!1,l=!1,c="";H.overwritePmtilesSource(t,ue,`https://atip.uk/layers/v1/${ue}.pmtiles`),H.overwritePolygonLayer(t,{id:ue,source:ue,sourceLayer:ue,color:"black",opacity:H.hoveredToggle(.5,.7)}),H.overwriteLineLayer(t,{id:r,source:ue,sourceLayer:ue,color:"black",width:.5});function i(O){let L=O.properties.OA21CD,N=O.properties[c];return c=="percent_households_with_car"?`<p>${N}% of households in ${L} have 1 or more cars</p>`:c=="average_cars_per_household"?`<p>Households in ${L} have an average of ${N} cars</p>`:`<p>There are ${N.toLocaleString()} people per square kilometre in ${L}</p>`}function u(O){let L=O.detail.properties.OA21CD;c=="percent_households_with_car"||c=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${L}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${L}`,"_blank")}function $(){return c=="percent_households_with_car"?[0,20,40,60,80,100]:c=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function p(O){a=O,n(0,a)}const y=()=>{n(1,f=!1),n(2,l=!1)};function v(O){f=O,n(1,f)}const C=()=>{n(0,a=!1),n(2,l=!1)};function B(O){l=O,n(2,l)}const D=()=>{n(0,a=!1),n(1,f=!1)};return o.$$.update=()=>{o.$$.dirty&271&&(a?n(3,c="percent_households_with_car"):f?n(3,c="average_cars_per_household"):l?n(3,c="population_density"):n(3,c=""),c?(t.setPaintProperty(ue,"fill-color",H.makeColorRamp(["get",c],$(),s)),t.setLayoutProperty(r,"visibility","visible")):t.setLayoutProperty(r,"visibility","none"))},[a,f,l,c,s,i,u,$,t,p,y,v,C,B,D]}class Gn extends z{constructor(e){super(),G(this,e,zn,In,j,{})}}function jn(o){let e,n,t;return e=new me({props:{color:o[1]}}),{c(){_(e.$$.fragment),n=b(`
  Combined authorities`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Vn(o){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Kn(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Zn(o){let e,n,t,r,s,a,f,l,c,i;return t=new R({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Vn]},$$scope:{ctx:o}}}),l=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Kn]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of December 2022."),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment),c=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(u,$){m(u,e,$),S(e,n),w(t,e,null),S(e,r),m(u,s,$),m(u,a,$),S(a,f),w(l,a,null),S(a,c),i=!0},p(u,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:u}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:u}),l.$set(y)},i(u){i||(g(t.$$.fragment,u),g(l.$$.fragment,u),i=!0)},o(u){d(t.$$.fragment,u),d(l.$$.fragment,u),i=!1},d(u){u&&(h(e),h(s),h(a)),k(t),k(l)}}}function qn(o){let e,n,t;return n=new ne({props:{$$slots:{default:[Zn]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Jn(o){let e,n,t,r,s;function a(l){o[3](l)}let f={id:we,$$slots:{right:[qn],default:[jn]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:we,tooltip:Yn,show:o[0],clickable:!0}}),r.$on("click",Qn),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&32&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let we="combined_authorities";function Yn(o){return`<p>${o.properties.name}</p>`}function Qn(o){window.open(`https://www.ons.gov.uk/visualisations/areas/${o.detail.properties.CAUTH22CD}`,"_blank")}function Xn(o,e,n){let t;J(o,X,l=>n(2,t=l));let r=V.combined_authorities,s=`${we}-outline`;H.overwriteSource(t,we,`https://atip.uk/layers/v1/${we}.geojson`),H.overwritePolygonLayer(t,{id:we,source:we,color:r,opacity:H.hoveredToggle(.5,.1)}),H.overwriteLineLayer(t,{id:s,source:we,color:r,width:2.5});let a=!1;function f(l){a=l,n(0,a)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,r,t,f]}class er extends z{constructor(e){super(),G(this,e,Xn,Jn,j,{})}}function tr(o){let e,n,t;return e=new me({props:{color:o[1]}}),{c(){_(e.$$.fragment),n=b(`
  Cycle parking`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function nr(o){let e;return{c(){e=b("OpenStreetMap")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function rr(o){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function or(o){let e,n,t,r,s,a,f,l,c;return t=new R({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[nr]},$$scope:{ctx:o}}}),l=new R({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[rr]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Cycle parking, according to "),_(t.$$.fragment),r=b(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment)},m(i,u){m(i,e,u),S(e,n),w(t,e,null),S(e,r),m(i,s,u),m(i,a,u),S(a,f),w(l,a,null),c=!0},p(i,u){const $={};u&16&&($.$$scope={dirty:u,ctx:i}),t.$set($);const p={};u&16&&(p.$$scope={dirty:u,ctx:i}),l.$set(p)},i(i){c||(g(t.$$.fragment,i),g(l.$$.fragment,i),c=!0)},o(i){d(t.$$.fragment,i),d(l.$$.fragment,i),c=!1},d(i){i&&(h(e),h(s),h(a)),k(t),k(l)}}}function sr(o){let e,n,t;return n=new ne({props:{$$slots:{default:[or]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function lr(o){let e,n,t,r,s;function a(l){o[2](l)}let f={id:Ce,$$slots:{right:[sr],default:[tr]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:Ce,tooltip:ir,show:o[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&16&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Ce="cycle_parking";function ir(o){return`<p>Capacity: ${o.properties.capacity??"unknown"}</p>`}function ar(o,e,n){let t;J(o,X,f=>n(3,t=f));let r=V.cycle_parking;H.overwritePmtilesSource(t,Ce,`https://atip.uk/layers/v1/${Ce}.pmtiles`),H.overwriteCircleLayer(t,{id:Ce,source:Ce,sourceLayer:Ce,color:r,radius:5});let s=!1;function a(f){s=f,n(0,s)}return[s,r,a]}class ur extends z{constructor(e){super(),G(this,e,ar,lr,j,{})}}function cr(o){let e=new Map;for(let[t,r]of Object.entries(o.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:r.authority_or_region,capital_scheme_id:r.capital_scheme_id,funding_programme:r.funding_programme});let n=1;for(let t of o.features){let r=e.get(t.properties.scheme_reference);r.num_features++,t.properties.funding_programme=r.funding_programme,t.id=n++}return e}function fr(o){let e,n,t,r,s;function a(l){o[3](l)}let f={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return o[0]!==void 0&&(f.value=o[0]),e=new Qe({props:f}),K.push(()=>Z(e,"value",a)),e.$on("change",o[2]),r=new rn({props:{rows:o[1]}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};!n&&c&1&&(n=!0,i.value=l[0],q(()=>n=!1)),e.$set(i);const u={};c&2&&(u.rows=l[1]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function $r(o,e,n){let t;J(o,X,l=>n(4,t=l));let r="interventionType",s=$t("v1");function a(){let l;r=="interventionType"?(l=Pt("v1"),n(1,s=$t("v1"))):(l=H.constructMatchExpression(["get","funding_programme"],{ATF2:V.atf2,ATF3:V.atf3,ATF4:V.atf4},"grey"),n(1,s=[["ATF2",V.atf2],["ATF3",V.atf3],["ATF4",V.atf4]])),t.setPaintProperty("interventions-points","circle-color",l),t.setPaintProperty("interventions-lines","line-color",l),t.setPaintProperty("interventions-polygons","fill-color",l),t.setPaintProperty("interventions-polygon-outlines","line-color",l)}function f(l){r=l,n(0,r)}return[r,s,a,f]}class pr extends z{constructor(e){super(),G(this,e,$r,fr,j,{})}}function mr(o){let e;return{c(){e=b("Clear")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function hr(o){let e,n,t,r,s,a;return t=new Fe({props:{$$slots:{default:[mr]},$$scope:{ctx:o}}}),t.$on("click",o[11]),{c(){e=M("input"),n=A(),_(t.$$.fragment),F(e,"type","text"),F(e,"class","govuk-input govuk-input--width-10"),F(e,"id","filterText")},m(f,l){m(f,e,l),ct(e,o[0]),m(f,n,l),w(t,f,l),r=!0,s||(a=Qt(e,"input",o[10]),s=!0)},p(f,l){l&1&&e.value!==f[0]&&ct(e,f[0]);const c={};l&16384&&(c.$$scope={dirty:l,ctx:f}),t.$set(c)},i(f){r||(g(t.$$.fragment,f),r=!0)},o(f){d(t.$$.fragment,f),r=!1},d(f){f&&(h(e),h(n)),k(t,f),s=!1,a()}}}function gr(o){let e,n,t,r,s,a,f,l,c,i;function u(v){o[8](v)}let $={label:"Authority or region",id:"filterAuthority",choices:o[4],emptyOption:!0};o[2]!==void 0&&($.value=o[2]),e=new Qe({props:$}),K.push(()=>Z(e,"value",u));function p(v){o[9](v)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:o[5],emptyOption:!0};return o[3]!==void 0&&(y.value=o[3]),r=new Qe({props:y}),K.push(()=>Z(r,"value",p)),f=new Yt({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[hr]},$$scope:{ctx:o}}}),c=new pr({}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment),a=A(),_(f.$$.fragment),l=A(),_(c.$$.fragment)},m(v,C){w(e,v,C),m(v,t,C),w(r,v,C),m(v,a,C),w(f,v,C),m(v,l,C),w(c,v,C),i=!0},p(v,C){const B={};C&16&&(B.choices=v[4]),!n&&C&4&&(n=!0,B.value=v[2],q(()=>n=!1)),e.$set(B);const D={};C&32&&(D.choices=v[5]),!s&&C&8&&(s=!0,D.value=v[3],q(()=>s=!1)),r.$set(D);const O={};C&16385&&(O.$$scope={dirty:C,ctx:v}),f.$set(O)},i(v){i||(g(e.$$.fragment,v),g(r.$$.fragment,v),g(f.$$.fragment,v),g(c.$$.fragment,v),i=!0)},o(v){d(e.$$.fragment,v),d(r.$$.fragment,v),d(f.$$.fragment,v),d(c.$$.fragment,v),i=!1},d(v){v&&(h(t),h(a),h(l)),k(e,v),k(r,v),k(f,v),k(c,v)}}}function dr(o){let e,n,t,r,s=o[1].size+"",a,f,l=o[6].route+"",c,i,u=o[6].area+"",$,p,y=o[6].crossing+"",v,C,B=o[6].other+"",D,O,L;return e=new De({props:{label:"Filters",$$slots:{default:[gr]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment),n=A(),t=M("p"),r=b("Showing "),a=b(s),f=b(" schemes ("),c=b(l),i=b(" routes, "),$=b(u),p=b(` areas,
  `),v=b(y),C=b(" crossings, "),D=b(B),O=b(" other)")},m(N,U){w(e,N,U),m(N,n,U),m(N,t,U),S(t,r),S(t,a),S(t,f),S(t,c),S(t,i),S(t,$),S(t,p),S(t,v),S(t,C),S(t,D),S(t,O),L=!0},p(N,[U]){const P={};U&16445&&(P.$$scope={dirty:U,ctx:N}),e.$set(P),(!L||U&2)&&s!==(s=N[1].size+"")&&ae(a,s),(!L||U&64)&&l!==(l=N[6].route+"")&&ae(c,l),(!L||U&64)&&u!==(u=N[6].area+"")&&ae($,u),(!L||U&64)&&y!==(y=N[6].crossing+"")&&ae(v,y),(!L||U&64)&&B!==(B=N[6].other+"")&&ae(D,B)},i(N){L||(g(e.$$.fragment,N),L=!0)},o(N){d(e.$$.fragment,N),L=!1},d(N){N&&(h(n),h(t)),k(e,N)}}}function _r(o,e,n){let t;J(o,Pe,B=>n(12,t=B));let{schemes:r}=e,{schemesToBeShown:s=new Set}=e,{filterText:a=""}=e,f=[],l="",c=[],i="",u={area:0,route:0,crossing:0,other:0};tt(()=>{let B=new Set,D=new Set;for(let O of r.values())O.authority_or_region&&B.add(O.authority_or_region),O.funding_programme&&D.add(O.funding_programme);n(4,f=Array.from(B.entries())),f.sort(),n(5,c=Array.from(D.entries())),c.sort()});function $(B,D,O){let L=B.toLowerCase(),N=P=>{var T,x;if(L&&!((T=P.properties.name)!=null&&T.toLowerCase().includes(L))&&!((x=P.properties.description)!=null&&x.toLowerCase().includes(L)))return!1;if(D||O){let E=r.get(P.properties.scheme_reference);if(D&&E.authority_or_region!=D||O&&E.funding_programme!=O)return!1}return!0};n(1,s=new Set(t.features.filter(N).map(P=>P.properties.scheme_reference))),n(6,u={area:0,route:0,crossing:0,other:0});let U=P=>{var T,x;return!(!s.has(P.properties.scheme_reference)||L&&!((T=P.properties.name)!=null&&T.toLowerCase().includes(L))&&!((x=P.properties.description)!=null&&x.toLowerCase().includes(L)))};Pe.update(P=>{for(let T of P.features)U(T)?(delete T.properties.hide_while_editing,n(6,u[T.properties.intervention_type]++,u)):T.properties.hide_while_editing=!0;return P}),n(6,u)}function p(B){l=B,n(2,l)}function y(B){i=B,n(3,i)}function v(){a=this.value,n(0,a)}const C=()=>n(0,a="");return o.$$set=B=>{"schemes"in B&&n(7,r=B.schemes),"schemesToBeShown"in B&&n(1,s=B.schemesToBeShown),"filterText"in B&&n(0,a=B.filterText)},o.$$.update=()=>{o.$$.dirty&13&&$(a,l,i)},[a,s,l,i,f,c,u,r,p,y,v,C]}class wr extends z{constructor(e){super(),G(this,e,_r,dr,j,{schemes:7,schemesToBeShown:1,filterText:0})}}function kr(o){let e,n,t,r;return e=new me({props:{color:o[3]}}),{c(){_(e.$$.fragment),n=A(),t=b(o[1])},m(s,a){w(e,s,a),m(s,n,a),m(s,t,a),r=!0},p(s,a){(!r||a&2)&&ae(t,s[1])},i(s){r||(g(e.$$.fragment,s),r=!0)},o(s){d(e.$$.fragment,s),r=!1},d(s){s&&(h(n),h(t)),k(e,s)}}}function br(o){let e;const n=o[6].default,t=Bt(n,o,o[8],null);return{c(){t&&t.c()},m(r,s){t&&t.m(r,s),e=!0},p(r,s){t&&t.p&&(!e||s&256)&&Nt(t,n,r,r[8],e?Mt(n,r[8],s,null):At(r[8]),null)},i(r){e||(g(t,r),e=!0)},o(r){d(t,r),e=!1},d(r){t&&t.d(r)}}}function vr(o){let e,n,t;return n=new ne({props:{$$slots:{default:[br]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function yr(o){let e,n,t,r,s;function a(l){o[7](l)}let f={id:o[0],$$slots:{right:[vr],default:[kr]},$$scope:{ctx:o}};return o[2]!==void 0&&(f.checked=o[2]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:o[0],tooltip:o[4],show:o[2],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&1&&(i.id=l[0]),c&258&&(i.$$scope={dirty:c,ctx:l}),!n&&c&4&&(n=!0,i.checked=l[2],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.layer=l[0]),c&4&&(u.show=l[2]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function Lr(o,e,n){let t;J(o,X,p=>n(9,t=p));let{$$slots:r={},$$scope:s}=e,{name:a}=e,{singularNoun:f}=e,{pluralNoun:l}=e,c=V[a];H.overwritePmtilesSource(t,a,`https://atip.uk/layers/v1/${a}.pmtiles`),H.overwritePolygonLayer(t,{id:a,source:a,sourceLayer:a,color:c,opacity:H.hoveredToggle(1,.7)});let i=!1;function u(p){return`<p>${p.properties.name??`Unnamed ${f}`}</p>`}function $(p){i=p,n(2,i)}return o.$$set=p=>{"name"in p&&n(0,a=p.name),"singularNoun"in p&&n(5,f=p.singularNoun),"pluralNoun"in p&&n(1,l=p.pluralNoun),"$$scope"in p&&n(8,s=p.$$scope)},[a,l,i,c,u,f,r,$,s]}class rt extends z{constructor(e){super(),G(this,e,Lr,yr,j,{name:0,singularNoun:5,pluralNoun:1})}}function Sr(o){let e;return{c(){e=b("hospital")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Cr(o){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Tr(o){let e,n,t,r,s,a,f,l,c;return t=new R({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[Sr]},$$scope:{ctx:o}}}),l=new R({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Cr]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("This shows "),_(t.$$.fragment),r=b(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment)},m(i,u){m(i,e,u),S(e,n),w(t,e,null),S(e,r),m(i,s,u),m(i,a,u),S(a,f),w(l,a,null),c=!0},p(i,u){const $={};u&1&&($.$$scope={dirty:u,ctx:i}),t.$set($);const p={};u&1&&(p.$$scope={dirty:u,ctx:i}),l.$set(p)},i(i){c||(g(t.$$.fragment,i),g(l.$$.fragment,i),c=!0)},o(i){d(t.$$.fragment,i),d(l.$$.fragment,i),c=!1},d(i){i&&(h(e),h(s),h(a)),k(t),k(l)}}}function Dr(o){let e,n;return e=new rt({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Tr]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class Br extends z{constructor(e){super(),G(this,e,null,Dr,j,{})}}function Nr(o){let e;return{c(){e=b("Indices of Multiple Deprivation")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ar(o){let e;return{c(){e=b(`DLUCH GIS
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Mr(o){let e;return{c(){e=b(`here
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Or(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Pr(o){let e,n,t,r,s,a,f,l,c,i,u,$;return t=new R({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Ar]},$$scope:{ctx:o}}}),s=new R({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Mr]},$$scope:{ctx:o}}}),i=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Or]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("The 2019 English IMD scores come from "),_(t.$$.fragment),r=b(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),a=b("."),f=A(),l=M("p"),c=b("License: "),_(i.$$.fragment),u=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(s,e,null),S(e,a),m(p,f,y),m(p,l,y),S(l,c),w(i,l,null),S(l,u),$=!0},p(p,y){const v={};y&64&&(v.$$scope={dirty:y,ctx:p}),t.$set(v);const C={};y&64&&(C.$$scope={dirty:y,ctx:p}),s.$set(C);const B={};y&64&&(B.$$scope={dirty:y,ctx:p}),i.$set(B)},i(p){$||(g(t.$$.fragment,p),g(s.$$.fragment,p),g(i.$$.fragment,p),$=!0)},o(p){d(t.$$.fragment,p),d(s.$$.fragment,p),d(i.$$.fragment,p),$=!1},d(p){p&&(h(e),h(f),h(l)),k(t),k(s),k(i)}}}function Er(o){let e,n,t;return n=new ne({props:{$$slots:{default:[Pr]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function kt(o){let e,n;return e=new Ge({props:{colorScale:o[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:te,i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function xr(o){let e,n,t,r,s,a;function f(i){o[3](i)}let l={id:ce,$$slots:{right:[Er],default:[Nr]},$$scope:{ctx:o}};o[0]!==void 0&&(l.checked=o[0]),e=new ee({props:l}),K.push(()=>Z(e,"checked",f));let c=o[0]&&kt(o);return s=new Q({props:{layer:ce,tooltip:Hr,show:o[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),c&&c.c(),r=A(),_(s.$$.fragment)},m(i,u){w(e,i,u),m(i,t,u),c&&c.m(i,u),m(i,r,u),w(s,i,u),a=!0},p(i,[u]){const $={};u&64&&($.$$scope={dirty:u,ctx:i}),!n&&u&1&&(n=!0,$.checked=i[0],q(()=>n=!1)),e.$set($),i[0]?c?(c.p(i,u),u&1&&g(c,1)):(c=kt(i),c.c(),g(c,1),c.m(r.parentNode,r)):c&&(be(),d(c,1,1,()=>{c=null}),ve());const p={};u&1&&(p.show=i[0]),s.$set(p)},i(i){a||(g(e.$$.fragment,i),g(c),g(s.$$.fragment,i),a=!0)},o(i){d(e.$$.fragment,i),d(c),d(s.$$.fragment,i),a=!1},d(i){i&&(h(t),h(r)),k(e,i),c&&c.d(i),k(s,i)}}}let ce="imd";function Hr(o){return`<p>${o.properties.LSOA11CD} has an IMD score of <b>${o.properties.score}</b></p><p>Rank: <b>${o.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function Ur(o,e,n){let t;J(o,X,c=>n(2,t=c));let r=`${ce}-outline`,s=V.sequential_low_to_high,a=[0,2,4,6,8,10];H.overwritePmtilesSource(t,ce,`https://atip.uk/layers/v1/${ce}.pmtiles`),H.overwritePolygonLayer(t,{id:ce,source:ce,sourceLayer:ce,color:H.makeColorRamp(["-",10,["get","decile"]],a,s),opacity:H.hoveredToggle(.5,.7)}),H.overwriteLineLayer(t,{id:r,source:ce,sourceLayer:ce,color:"black",width:.5});let f=!1;function l(c){f=c,n(0,f)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(r)&&t.setLayoutProperty(r,"visibility",f?"visible":"none")},[f,s,t,l]}class Rr extends z{constructor(e){super(),G(this,e,Ur,xr,j,{})}}function Wr(o){let e,n,t;return e=new me({props:{color:o[1]}}),{c(){_(e.$$.fragment),n=b(`
  Local Authority Districts`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Ir(o){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Fr(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function zr(o){let e,n,t,r,s,a,f,l,c,i;return t=new R({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Ir]},$$scope:{ctx:o}}}),l=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Fr]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of May 2023."),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment),c=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(u,$){m(u,e,$),S(e,n),w(t,e,null),S(e,r),m(u,s,$),m(u,a,$),S(a,f),w(l,a,null),S(a,c),i=!0},p(u,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:u}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:u}),l.$set(y)},i(u){i||(g(t.$$.fragment,u),g(l.$$.fragment,u),i=!0)},o(u){d(t.$$.fragment,u),d(l.$$.fragment,u),i=!1},d(u){u&&(h(e),h(s),h(a)),k(t),k(l)}}}function Gr(o){let e,n,t;return n=new ne({props:{$$slots:{default:[zr]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function jr(o){let e,n,t,r,s;function a(l){o[3](l)}let f={id:ke,$$slots:{right:[Gr],default:[Wr]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:ke,tooltip:Vr,show:o[0],clickable:!0}}),r.$on("click",Kr),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&32&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let ke="local_authority_districts";function Vr(o){return`<p>${o.properties.name}</p>`}function Kr(o){window.open(`https://www.ons.gov.uk/visualisations/areas/${o.detail.properties.LAD23CD}`,"_blank")}function Zr(o,e,n){let t;J(o,X,l=>n(2,t=l));let r=V.local_authority_districts,s=`${ke}-outline`;H.overwriteSource(t,ke,`https://atip.uk/layers/v1/${ke}.geojson`),H.overwritePolygonLayer(t,{id:ke,source:ke,color:r,opacity:H.hoveredToggle(.5,.1)}),H.overwriteLineLayer(t,{id:s,source:ke,color:r,width:2.5});let a=!1;function f(l){a=l,n(0,a)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,r,t,f]}class qr extends z{constructor(e){super(),G(this,e,Zr,jr,j,{})}}function Jr(o){let e,n,t;return e=new me({props:{color:o[1]}}),{c(){_(e.$$.fragment),n=b(`
  Local Planning Authorities`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function Yr(o){let e;return{c(){e=b(`local authority
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Qr(o){let e;return{c(){e=b(`national park authorit
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Xr(o){let e;return{c(){e=b(`development corporation
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function eo(o){let e;return{c(){e=b("this map")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function to(o){let e;return{c(){e=b(`planning.data.gov.uk
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function no(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ro(o){let e,n,t,r,s,a,f,l,c,i,u,$,p,y,v,C,B,D,O,L,N,U,P,T,x;return t=new R({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Yr]},$$scope:{ctx:o}}}),s=new R({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Qr]},$$scope:{ctx:o}}}),f=new R({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Xr]},$$scope:{ctx:o}}}),p=new R({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[eo]},$$scope:{ctx:o}}}),D=new R({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[to]},$$scope:{ctx:o}}}),P=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[no]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("LPAs may be a "),_(t.$$.fragment),r=b(", "),_(s.$$.fragment),a=b("y, or "),_(f.$$.fragment),l=b("."),c=A(),i=M("p"),u=M("strong"),$=b(`Note there are overlapping LPAs near Northhamptonshire, shown in a
          darker shade. Only one authority name is shown when hovering. Use `),_(p.$$.fragment),y=b(" to get more details."),v=A(),C=M("p"),B=b("Data from ONS Geography via "),_(D.$$.fragment),O=b(", as of November 2022."),L=A(),N=M("p"),U=b("License: "),_(P.$$.fragment),T=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(E,I){m(E,e,I),S(e,n),w(t,e,null),S(e,r),w(s,e,null),S(e,a),w(f,e,null),S(e,l),m(E,c,I),m(E,i,I),S(i,u),S(u,$),w(p,u,null),S(u,y),m(E,v,I),m(E,C,I),S(C,B),w(D,C,null),S(C,O),m(E,L,I),m(E,N,I),S(N,U),w(P,N,null),S(N,T),x=!0},p(E,I){const _e={};I&32&&(_e.$$scope={dirty:I,ctx:E}),t.$set(_e);const ye={};I&32&&(ye.$$scope={dirty:I,ctx:E}),s.$set(ye);const Ee={};I&32&&(Ee.$$scope={dirty:I,ctx:E}),f.$set(Ee);const he={};I&32&&(he.$$scope={dirty:I,ctx:E}),p.$set(he);const Le={};I&32&&(Le.$$scope={dirty:I,ctx:E}),D.$set(Le);const xe={};I&32&&(xe.$$scope={dirty:I,ctx:E}),P.$set(xe)},i(E){x||(g(t.$$.fragment,E),g(s.$$.fragment,E),g(f.$$.fragment,E),g(p.$$.fragment,E),g(D.$$.fragment,E),g(P.$$.fragment,E),x=!0)},o(E){d(t.$$.fragment,E),d(s.$$.fragment,E),d(f.$$.fragment,E),d(p.$$.fragment,E),d(D.$$.fragment,E),d(P.$$.fragment,E),x=!1},d(E){E&&(h(e),h(c),h(i),h(v),h(C),h(L),h(N)),k(t),k(s),k(f),k(p),k(D),k(P)}}}function oo(o){let e,n,t;return n=new ne({props:{$$slots:{default:[ro]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function so(o){let e,n,t,r,s;function a(l){o[3](l)}let f={id:fe,$$slots:{right:[oo],default:[Jr]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:fe,tooltip:lo,show:o[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&32&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let fe="local_planning_authorities";function lo(o){return`<p>${o.properties.name}</p>`}function io(o,e,n){let t;J(o,X,l=>n(2,t=l));let r=V.local_planning_authorities,s=`${fe}-outline`;H.overwritePmtilesSource(t,fe,`https://atip.uk/layers/v1/${fe}.pmtiles`),H.overwritePolygonLayer(t,{id:fe,source:fe,sourceLayer:fe,color:r,opacity:H.hoveredToggle(.5,.1)}),H.overwriteLineLayer(t,{id:s,source:fe,sourceLayer:fe,color:r,width:2.5});let a=!1;function f(l){a=l,n(0,a)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,r,t,f]}class ao extends z{constructor(e){super(),G(this,e,io,so,j,{})}}function uo(o){let e,n,t;return e=new me({props:{color:o[1]}}),{c(){_(e.$$.fragment),n=b(`
  Major Road Network`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function co(o){let e;return{c(){e=b(`Major Road Network
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function fo(o){let e;return{c(){e=b("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function $o(o){let e,n,t,r,s,a,f,l,c;return t=new R({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[co]},$$scope:{ctx:o}}}),l=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[fo]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Data from the "),_(t.$$.fragment),r=b(", as of September 2021."),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment)},m(i,u){m(i,e,u),S(e,n),w(t,e,null),S(e,r),m(i,s,u),m(i,a,u),S(a,f),w(l,a,null),c=!0},p(i,u){const $={};u&16&&($.$$scope={dirty:u,ctx:i}),t.$set($);const p={};u&16&&(p.$$scope={dirty:u,ctx:i}),l.$set(p)},i(i){c||(g(t.$$.fragment,i),g(l.$$.fragment,i),c=!0)},o(i){d(t.$$.fragment,i),d(l.$$.fragment,i),c=!1},d(i){i&&(h(e),h(s),h(a)),k(t),k(l)}}}function po(o){let e,n,t;return n=new ne({props:{$$slots:{default:[$o]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function mo(o){let e,n,t,r,s;function a(l){o[2](l)}let f={id:Te,$$slots:{right:[po],default:[uo]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:Te,tooltip:ho,show:o[0],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&16&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let Te="mrn";function ho(o){return`<p>${o.properties.name??"Unknown MRN road"}</p>`}function go(o,e,n){let t;J(o,X,f=>n(3,t=f));let r=V.mrn;H.overwritePmtilesSource(t,Te,`https://atip.uk/layers/v1/${Te}.pmtiles`),H.overwriteLineLayer(t,{id:Te,source:Te,sourceLayer:Te,color:r,width:7,opacity:H.hoveredToggle(.5,1)});let s=!1;function a(f){s=f,n(0,s)}return[s,r,a]}class _o extends z{constructor(e){super(),G(this,e,go,mo,j,{})}}function wo(o){let e,n,t;return e=new me({props:{color:o[1]}}),{c(){_(e.$$.fragment),n=b(`
  Parliamentary constituencies`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function ko(o){let e;return{c(){e=b(`Ordnance Survey Boundary-Line
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function bo(o){let e;return{c(){e=b("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function vo(o){let e,n,t,r,s,a,f,l,c;return t=new R({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[ko]},$$scope:{ctx:o}}}),l=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[bo]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of May 2023."),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment)},m(i,u){m(i,e,u),S(e,n),w(t,e,null),S(e,r),m(i,s,u),m(i,a,u),S(a,f),w(l,a,null),c=!0},p(i,u){const $={};u&32&&($.$$scope={dirty:u,ctx:i}),t.$set($);const p={};u&32&&(p.$$scope={dirty:u,ctx:i}),l.$set(p)},i(i){c||(g(t.$$.fragment,i),g(l.$$.fragment,i),c=!0)},o(i){d(t.$$.fragment,i),d(l.$$.fragment,i),c=!1},d(i){i&&(h(e),h(s),h(a)),k(t),k(l)}}}function yo(o){let e,n,t;return n=new ne({props:{$$slots:{default:[vo]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Lo(o){let e,n,t,r,s;function a(l){o[3](l)}let f={id:$e,$$slots:{right:[yo],default:[wo]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:$e,tooltip:So,show:o[0],clickable:!0}}),r.$on("click",Co),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&32&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let $e="parliamentary_constituencies";function So(o){return`<p>${o.properties.Name}</p>`}function Co(o){let e=o.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function To(o,e,n){let t;J(o,X,l=>n(2,t=l));let r=V.parliamentary_constituencies,s=`${$e}-outline`;H.overwritePmtilesSource(t,$e,`https://atip.uk/layers/v1/${$e}.pmtiles`),H.overwritePolygonLayer(t,{id:$e,source:$e,sourceLayer:$e,color:r,opacity:H.hoveredToggle(.5,.1)}),H.overwriteLineLayer(t,{id:s,source:$e,sourceLayer:$e,color:r,width:5});let a=!1;function f(l){a=l,n(0,a)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,r,t,f]}class Do extends z{constructor(e){super(),G(this,e,To,Lo,j,{})}}function Bo(o){let e,n,t,r;return e=new me({props:{color:o[3]}}),{c(){_(e.$$.fragment),n=A(),t=b(o[1])},m(s,a){w(e,s,a),m(s,n,a),m(s,t,a),r=!0},p(s,a){(!r||a&2)&&ae(t,s[1])},i(s){r||(g(e.$$.fragment,s),r=!0)},o(s){d(e.$$.fragment,s),r=!1},d(s){s&&(h(n),h(t)),k(e,s)}}}function No(o){let e;const n=o[7].default,t=Bt(n,o,o[9],null);return{c(){t&&t.c()},m(r,s){t&&t.m(r,s),e=!0},p(r,s){t&&t.p&&(!e||s&512)&&Nt(t,n,r,r[9],e?Mt(n,r[9],s,null):At(r[9]),null)},i(r){e||(g(t,r),e=!0)},o(r){d(t,r),e=!1},d(r){t&&t.d(r)}}}function Ao(o){let e,n,t;return n=new ne({props:{$$slots:{default:[No]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&512&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function Mo(o){let e,n,t,r,s;function a(l){o[8](l)}let f={id:o[0],$$slots:{right:[Ao],default:[Bo]},$$scope:{ctx:o}};return o[2]!==void 0&&(f.checked=o[2]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:o[0],tooltip:o[4],show:o[2],clickable:!1}}),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&1&&(i.id=l[0]),c&514&&(i.$$scope={dirty:c,ctx:l}),!n&&c&4&&(n=!0,i.checked=l[2],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.layer=l[0]),c&4&&(u.show=l[2]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}function Oo(o,e,n){let t;J(o,X,y=>n(10,t=y));let{$$slots:r={},$$scope:s}=e,{name:a}=e,{singularNoun:f}=e,{pluralNoun:l}=e,{circleRadius:c}=e,i=V[a];H.overwriteSource(t,a,`https://atip.uk/layers/v1/${a}.geojson`),H.overwriteCircleLayer(t,{id:a,source:a,color:i,radius:c/2});let u=!1;function $(y){return`<p>${y.properties.name??`Unnamed ${f}`}</p>`}function p(y){u=y,n(2,u)}return o.$$set=y=>{"name"in y&&n(0,a=y.name),"singularNoun"in y&&n(5,f=y.singularNoun),"pluralNoun"in y&&n(1,l=y.pluralNoun),"circleRadius"in y&&n(6,c=y.circleRadius),"$$scope"in y&&n(9,s=y.$$scope)},[a,l,u,i,$,f,c,r,p,s]}class Po extends z{constructor(e){super(),G(this,e,Oo,Mo,j,{name:0,singularNoun:5,pluralNoun:1,circleRadius:6})}}function Eo(o){let e;return{c(){e=b("railway station")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function xo(o){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Ho(o){let e,n,t,r,s,a,f,l,c;return t=new R({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[Eo]},$$scope:{ctx:o}}}),l=new R({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[xo]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("This shows "),_(t.$$.fragment),r=b(" data from OpenStreetMap (as of 9 August 2023)."),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment)},m(i,u){m(i,e,u),S(e,n),w(t,e,null),S(e,r),m(i,s,u),m(i,a,u),S(a,f),w(l,a,null),c=!0},p(i,u){const $={};u&1&&($.$$scope={dirty:u,ctx:i}),t.$set($);const p={};u&1&&(p.$$scope={dirty:u,ctx:i}),l.$set(p)},i(i){c||(g(t.$$.fragment,i),g(l.$$.fragment,i),c=!0)},o(i){d(t.$$.fragment,i),d(l.$$.fragment,i),c=!1},d(i){i&&(h(e),h(s),h(a)),k(t),k(l)}}}function Uo(o){let e,n;return e=new Po({props:{name:Ro,singularNoun:"railway station",pluralNoun:"Railway stations",circleRadius:on,$$slots:{default:[Ho]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}const Ro="railway_stations";class Wo extends z{constructor(e){super(),G(this,e,null,Uo,j,{})}}function Io(o){let e;return{c(){e=b("Show on map")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Fo(o){let e;return{c(){e=b("Edit scheme locally")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function zo(o){let e,n,t=o[0].authority_or_region+"",r,s,a,f,l=o[0].capital_scheme_id+"",c,i,u,$,p=o[0].funding_programme+"",y,v,C,B,D,O,L;return B=new Fe({props:{$$slots:{default:[Io]},$$scope:{ctx:o}}}),B.$on("click",o[3]),O=new Fe({props:{disabled:o[1],title:o[2],$$slots:{default:[Fo]},$$scope:{ctx:o}}}),O.$on("click",o[4]),{c(){e=M("p"),n=b("Authority or region: "),r=b(t),s=A(),a=M("p"),f=b("Capital scheme ID: "),c=b(l),i=A(),u=M("p"),$=b("Funding programme: "),y=b(p),v=A(),C=M("div"),_(B.$$.fragment),D=A(),_(O.$$.fragment),F(C,"class","govuk-button-group")},m(N,U){m(N,e,U),S(e,n),S(e,r),m(N,s,U),m(N,a,U),S(a,f),S(a,c),m(N,i,U),m(N,u,U),S(u,$),S(u,y),m(N,v,U),m(N,C,U),w(B,C,null),S(C,D),w(O,C,null),L=!0},p(N,U){(!L||U&1)&&t!==(t=N[0].authority_or_region+"")&&ae(r,t),(!L||U&1)&&l!==(l=N[0].capital_scheme_id+"")&&ae(c,l),(!L||U&1)&&p!==(p=N[0].funding_programme+"")&&ae(y,p);const P={};U&256&&(P.$$scope={dirty:U,ctx:N}),B.$set(P);const T={};U&256&&(T.$$scope={dirty:U,ctx:N}),O.$set(T)},i(N){L||(g(B.$$.fragment,N),g(O.$$.fragment,N),L=!0)},o(N){d(B.$$.fragment,N),d(O.$$.fragment,N),L=!1},d(N){N&&(h(e),h(s),h(a),h(i),h(u),h(v),h(C)),k(B),k(O)}}}function Go(o){let e,n;return e=new De({props:{label:`${o[0].scheme_reference}: ${o[0].num_features} features`,$$slots:{default:[zo]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),r&257&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function jo(o,e,n){let t,r;J(o,Pe,u=>n(6,t=u)),J(o,X,u=>n(7,r=u));let{scheme:s}=e,{authorityNames:a}=e,f=!a.has(s.authority_or_region),l=f?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function c(){let u={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==s.scheme_reference)};r==null||r.fitBounds(H.bbox(u),{padding:20,animate:!1})}function i(){let u={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)},$=s.authority_or_region;window.localStorage.setItem($,JSON.stringify(u)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return o.$$set=u=>{"scheme"in u&&n(0,s=u.scheme),"authorityNames"in u&&n(5,a=u.authorityNames)},[s,f,l,c,i,a]}class Vo extends z{constructor(e){super(),G(this,e,jo,Go,j,{scheme:0,authorityNames:5})}}function Ko(o){let e;return{c(){e=b("primary and secondary schools")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Zo(o){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function qo(o){let e,n,t,r,s,a,f,l,c;return t=new R({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Ko]},$$scope:{ctx:o}}}),l=new R({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Zo]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("This shows "),_(t.$$.fragment),r=b(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment)},m(i,u){m(i,e,u),S(e,n),w(t,e,null),S(e,r),m(i,s,u),m(i,a,u),S(a,f),w(l,a,null),c=!0},p(i,u){const $={};u&1&&($.$$scope={dirty:u,ctx:i}),t.$set($);const p={};u&1&&(p.$$scope={dirty:u,ctx:i}),l.$set(p)},i(i){c||(g(t.$$.fragment,i),g(l.$$.fragment,i),c=!0)},o(i){d(t.$$.fragment,i),d(l.$$.fragment,i),c=!1},d(i){i&&(h(e),h(s),h(a)),k(t),k(l)}}}function Jo(o){let e,n;return e=new rt({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[qo]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class Yo extends z{constructor(e){super(),G(this,e,null,Jo,j,{})}}function Qo(o){let e;return{c(){e=b("sports pitches")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Xo(o){let e;return{c(){e=b("sports centres")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function es(o){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ts(o){let e,n,t,r,s,a,f,l,c,i,u;return t=new R({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[Qo]},$$scope:{ctx:o}}}),s=new R({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Xo]},$$scope:{ctx:o}}}),i=new R({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[es]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("This shows "),_(t.$$.fragment),r=b(" and "),_(s.$$.fragment),a=b(" data from OpenStreetMap (as of 9 August 2023)."),f=A(),l=M("p"),c=b("License: "),_(i.$$.fragment)},m($,p){m($,e,p),S(e,n),w(t,e,null),S(e,r),w(s,e,null),S(e,a),m($,f,p),m($,l,p),S(l,c),w(i,l,null),u=!0},p($,p){const y={};p&1&&(y.$$scope={dirty:p,ctx:$}),t.$set(y);const v={};p&1&&(v.$$scope={dirty:p,ctx:$}),s.$set(v);const C={};p&1&&(C.$$scope={dirty:p,ctx:$}),i.$set(C)},i($){u||(g(t.$$.fragment,$),g(s.$$.fragment,$),g(i.$$.fragment,$),u=!0)},o($){d(t.$$.fragment,$),d(s.$$.fragment,$),d(i.$$.fragment,$),u=!1},d($){$&&(h(e),h(f),h(l)),k(t),k(s),k(i)}}}function ns(o){let e,n;return e=new rt({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[ts]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}class rs extends z{constructor(e){super(),G(this,e,null,ns,j,{})}}function os(o){let e,n,t;return e=new me({props:{color:o[1]}}),{c(){_(e.$$.fragment),n=b(`
  Wards`)},m(r,s){w(e,r,s),m(r,n,s),t=!0},p:te,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){d(e.$$.fragment,r),t=!1},d(r){r&&h(n),k(e,r)}}}function ss(o){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ls(o){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function is(o){let e,n,t,r,s,a,f,l,c,i;return t=new R({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[ss]},$$scope:{ctx:o}}}),l=new R({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ls]},$$scope:{ctx:o}}}),{c(){e=M("p"),n=b("Data from "),_(t.$$.fragment),r=b(", as of May 2023."),s=A(),a=M("p"),f=b("License: "),_(l.$$.fragment),c=b(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(u,$){m(u,e,$),S(e,n),w(t,e,null),S(e,r),m(u,s,$),m(u,a,$),S(a,f),w(l,a,null),S(a,c),i=!0},p(u,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:u}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:u}),l.$set(y)},i(u){i||(g(t.$$.fragment,u),g(l.$$.fragment,u),i=!0)},o(u){d(t.$$.fragment,u),d(l.$$.fragment,u),i=!1},d(u){u&&(h(e),h(s),h(a)),k(t),k(l)}}}function as(o){let e,n,t;return n=new ne({props:{$$slots:{default:[is]},$$scope:{ctx:o}}}),{c(){e=M("span"),_(n.$$.fragment),F(e,"slot","right")},m(r,s){m(r,e,s),w(n,e,null),t=!0},p(r,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:r}),n.$set(a)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){d(n.$$.fragment,r),t=!1},d(r){r&&h(e),k(n)}}}function us(o){let e,n,t,r,s;function a(l){o[3](l)}let f={id:pe,$$slots:{right:[as],default:[os]},$$scope:{ctx:o}};return o[0]!==void 0&&(f.checked=o[0]),e=new ee({props:f}),K.push(()=>Z(e,"checked",a)),r=new Q({props:{layer:pe,tooltip:cs,show:o[0],clickable:!0}}),r.$on("click",fs),{c(){_(e.$$.fragment),t=A(),_(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),s=!0},p(l,[c]){const i={};c&32&&(i.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,i.checked=l[0],q(()=>n=!1)),e.$set(i);const u={};c&1&&(u.show=l[0]),r.$set(u)},i(l){s||(g(e.$$.fragment,l),g(r.$$.fragment,l),s=!0)},o(l){d(e.$$.fragment,l),d(r.$$.fragment,l),s=!1},d(l){l&&h(t),k(e,l),k(r,l)}}}let pe="wards";function cs(o){return`<p>${o.properties.name}</p>`}function fs(o){let e=encodeURIComponent(o.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function $s(o,e,n){let t;J(o,X,l=>n(2,t=l));let r=V.wards,s=`${pe}-outline`;H.overwritePmtilesSource(t,pe,`https://atip.uk/layers/v1/${pe}.pmtiles`),H.overwritePolygonLayer(t,{id:pe,source:pe,sourceLayer:pe,color:r,opacity:H.hoveredToggle(.5,.1)}),H.overwriteLineLayer(t,{id:s,source:pe,sourceLayer:pe,color:r,width:2.5});let a=!1;function f(l){a=l,n(0,a)}return o.$$.update=()=>{o.$$.dirty&5&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,r,t,f]}class ps extends z{constructor(e){super(),G(this,e,$s,us,j,{})}}var Y=(o,e,n)=>new Promise((t,r)=>{var s=l=>{try{f(n.next(l))}catch(c){r(c)}},a=l=>{try{f(n.throw(l))}catch(c){r(c)}},f=l=>l.done?t(l.value):Promise.resolve(l.value).then(s,a);f((n=n.apply(o,e)).next())}),oe=Uint8Array,Me=Uint16Array,ms=Int32Array,Et=new oe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xt=new oe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hs=new oe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ht=function(o,e){for(var n=new Me(31),t=0;t<31;++t)n[t]=e+=1<<o[t-1];for(var r=new ms(n[30]),t=1;t<30;++t)for(var s=n[t];s<n[t+1];++s)r[s]=s-n[t]<<5|t;return{b:n,r}},Ut=Ht(Et,2),Rt=Ut.b,gs=Ut.r;Rt[28]=258,gs[258]=28;var ds=Ht(xt,0),_s=ds.b,Xe=new Me(32768);for(W=0;W<32768;++W)ge=(W&43690)>>1|(W&21845)<<1,ge=(ge&52428)>>2|(ge&13107)<<2,ge=(ge&61680)>>4|(ge&3855)<<4,Xe[W]=((ge&65280)>>8|(ge&255)<<8)>>1;var ge,W,We=function(o,e,n){for(var t=o.length,r=0,s=new Me(e);r<t;++r)o[r]&&++s[o[r]-1];var a=new Me(e);for(r=1;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var f;if(n){f=new Me(1<<e);var l=15-e;for(r=0;r<t;++r)if(o[r])for(var c=r<<4|o[r],i=e-o[r],u=a[o[r]-1]++<<i,$=u|(1<<i)-1;u<=$;++u)f[Xe[u]>>l]=c}else for(f=new Me(t),r=0;r<t;++r)o[r]&&(f[r]=Xe[a[o[r]-1]++]>>15-o[r]);return f},Ie=new oe(288);for(W=0;W<144;++W)Ie[W]=8;var W;for(W=144;W<256;++W)Ie[W]=9;var W;for(W=256;W<280;++W)Ie[W]=7;var W;for(W=280;W<288;++W)Ie[W]=8;var W,Wt=new oe(32);for(W=0;W<32;++W)Wt[W]=5;var W,ws=We(Ie,9,1),ks=We(Wt,5,1),qe=function(o){for(var e=o[0],n=1;n<o.length;++n)o[n]>e&&(e=o[n]);return e},le=function(o,e,n){var t=e/8|0;return(o[t]|o[t+1]<<8)>>(e&7)&n},Je=function(o,e){var n=e/8|0;return(o[n]|o[n+1]<<8|o[n+2]<<16)>>(e&7)},bs=function(o){return(o+7)/8|0},vs=function(o,e,n){(e==null||e<0)&&(e=0),(n==null||n>o.length)&&(n=o.length);var t=new oe(n-e);return t.set(o.subarray(e,n)),t},ys=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],re=function(o,e,n){var t=new Error(e||ys[o]);if(t.code=o,Error.captureStackTrace&&Error.captureStackTrace(t,re),!n)throw t;return t},ot=function(o,e,n,t){var r=o.length,s=t?t.length:0;if(!r||e.f&&!e.l)return n||new oe(0);var a=!n||e.i!=2,f=e.i;n||(n=new oe(r*3));var l=function(it){var at=n.length;if(it>at){var ut=new oe(Math.max(at*2,it));ut.set(n),n=ut}},c=e.f||0,i=e.p||0,u=e.b||0,$=e.l,p=e.d,y=e.m,v=e.n,C=r*8;do{if(!$){c=le(o,i,1);var B=le(o,i+1,3);if(i+=3,B)if(B==1)$=ws,p=ks,y=9,v=5;else if(B==2){var N=le(o,i,31)+257,U=le(o,i+10,15)+4,P=N+le(o,i+5,31)+1;i+=14;for(var T=new oe(P),x=new oe(19),E=0;E<U;++E)x[hs[E]]=le(o,i+E*3,7);i+=U*3;for(var I=qe(x),_e=(1<<I)-1,ye=We(x,I,1),E=0;E<P;){var Ee=ye[le(o,i,_e)];i+=Ee&15;var D=Ee>>4;if(D<16)T[E++]=D;else{var he=0,Le=0;for(D==16?(Le=3+le(o,i,3),i+=2,he=T[E-1]):D==17?(Le=3+le(o,i,7),i+=3):D==18&&(Le=11+le(o,i,127),i+=7);Le--;)T[E++]=he}}var xe=T.subarray(0,N),se=T.subarray(N);y=qe(xe),v=qe(se),$=We(xe,y,1),p=We(se,v,1)}else re(1);else{var D=bs(i)+4,O=o[D-4]|o[D-3]<<8,L=D+O;if(L>r){f&&re(0);break}a&&l(u+O),n.set(o.subarray(D,L),u),e.b=u+=O,e.p=i=L*8,e.f=c;continue}if(i>C){f&&re(0);break}}a&&l(u+131072);for(var Zt=(1<<y)-1,qt=(1<<v)-1,je=i;;je=i){var he=$[Je(o,i)&Zt],Be=he>>4;if(i+=he&15,i>C){f&&re(0);break}if(he||re(2),Be<256)n[u++]=Be;else if(Be==256){je=i,$=null;break}else{var st=Be-254;if(Be>264){var E=Be-257,He=Et[E];st=le(o,i,(1<<He)-1)+Rt[E],i+=He}var Ve=p[Je(o,i)&qt],Ke=Ve>>4;Ve||re(3),i+=Ve&15;var se=_s[Ke];if(Ke>3){var He=xt[Ke];se+=Je(o,i)&(1<<He)-1,i+=He}if(i>C){f&&re(0);break}a&&l(u+131072);var Ze=u+st;if(u<se){var lt=s-se,Jt=Math.min(se,Ze);for(lt+u<0&&re(3);u<Jt;++u)n[u]=t[lt+u]}for(;u<Ze;u+=4)n[u]=n[u-se],n[u+1]=n[u+1-se],n[u+2]=n[u+2-se],n[u+3]=n[u+3-se];u=Ze}}e.l=$,e.p=je,e.b=u,e.f=c,$&&(c=1,e.m=y,e.d=p,e.n=v)}while(!c);return u==n.length?n:vs(n,0,u)},Ls=new oe(0),Ss=function(o){(o[0]!=31||o[1]!=139||o[2]!=8)&&re(6,"invalid gzip data");var e=o[3],n=10;e&4&&(n+=(o[10]|o[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!o[n++]);return n+(e&2)},Cs=function(o){var e=o.length;return(o[e-4]|o[e-3]<<8|o[e-2]<<16|o[e-1]<<24)>>>0},Ts=function(o,e){return((o[0]&15)!=8||o[0]>>4>7||(o[0]<<8|o[1])%31)&&re(6,"invalid zlib data"),(o[1]>>5&1)==+!e&&re(6,"invalid zlib data: "+(o[1]&32?"need":"unexpected")+" dictionary"),(o[1]>>3&4)+2};function Ds(o,e){return ot(o,{i:2},e&&e.out,e&&e.dictionary)}function Bs(o,e){var n=Ss(o);return n+8>o.length&&re(6,"invalid gzip data"),ot(o.subarray(n,-8),{i:2},e&&e.out||new oe(Cs(o)),e&&e.dictionary)}function Ns(o,e){return ot(o.subarray(Ts(o,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function et(o,e){return o[0]==31&&o[1]==139&&o[2]==8?Bs(o,e):(o[0]&15)!=8||o[0]>>4>7||(o[0]<<8|o[1])%31?Ds(o,e):Ns(o,e)}var As=typeof TextDecoder<"u"&&new TextDecoder,Ms=0;try{As.decode(Ls,{stream:!0}),Ms=1}catch{}var It=(o,e)=>o*Math.pow(2,e),Ue=(o,e)=>Math.floor(o/Math.pow(2,e)),ze=(o,e)=>It(o.getUint16(e+1,!0),8)+o.getUint8(e),Ft=(o,e)=>It(o.getUint32(e+2,!0),16)+o.getUint16(e,!0),Os=(o,e,n,t,r)=>{if(o!=t.getUint8(r))return o-t.getUint8(r);const s=ze(t,r+1);if(e!=s)return e-s;const a=ze(t,r+4);return n!=a?n-a:0},Ps=(o,e,n,t)=>{const r=zt(o,e|128,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!0}:null},bt=(o,e,n,t)=>{const r=zt(o,e,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!1}:null},zt=(o,e,n,t)=>{let r=0,s=o.byteLength/17-1;for(;r<=s;){const a=s+r>>1,f=Os(e,n,t,o,a*17);if(f>0)r=a+1;else if(f<0)s=a-1;else return[Ft(o,a*17+7),o.getUint32(a*17+13,!0)]}return null},Es=(o,e)=>o.is_dir&&!e.is_dir?1:!o.is_dir&&e.is_dir?-1:o.z!==e.z?o.z-e.z:o.x!==e.x?o.x-e.x:o.y-e.y,Gt=(o,e)=>{const n=o.getUint8(e*17);return{z:n&127,x:ze(o,e*17+1),y:ze(o,e*17+4),offset:Ft(o,e*17+7),length:o.getUint32(e*17+13,!0),is_dir:n>>7===1}},vt=o=>{const e=[],n=new DataView(o);for(let t=0;t<n.byteLength/17;t++)e.push(Gt(n,t));return xs(e)},xs=o=>{o.sort(Es);const e=new ArrayBuffer(17*o.length),n=new Uint8Array(e);for(let t=0;t<o.length;t++){const r=o[t];let s=r.z;r.is_dir&&(s=s|128),n[t*17]=s,n[t*17+1]=r.x&255,n[t*17+2]=r.x>>8&255,n[t*17+3]=r.x>>16&255,n[t*17+4]=r.y&255,n[t*17+5]=r.y>>8&255,n[t*17+6]=r.y>>16&255,n[t*17+7]=r.offset&255,n[t*17+8]=Ue(r.offset,8)&255,n[t*17+9]=Ue(r.offset,16)&255,n[t*17+10]=Ue(r.offset,24)&255,n[t*17+11]=Ue(r.offset,32)&255,n[t*17+12]=Ue(r.offset,48)&255,n[t*17+13]=r.length&255,n[t*17+14]=r.length>>8&255,n[t*17+15]=r.length>>16&255,n[t*17+16]=r.length>>24&255}return e},Hs=(o,e)=>{if(o.byteLength<17)return null;const n=o.byteLength/17,t=Gt(o,n-1);if(t.is_dir){const r=t.z,s=e.z-r,a=Math.trunc(e.x/(1<<s)),f=Math.trunc(e.y/(1<<s));return{z:r,x:a,y:f}}return null};function Us(o){return Y(this,null,function*(){const e=yield o.getBytes(0,512e3),n=new DataView(e.data),t=n.getUint32(4,!0),r=n.getUint16(8,!0),s=new TextDecoder("utf-8"),a=JSON.parse(s.decode(new DataView(e.data,10,t)));let f=0;a.compression==="gzip"&&(f=2);let l=0;"minzoom"in a&&(l=+a.minzoom);let c=0;"maxzoom"in a&&(c=+a.maxzoom);let i=0,u=0,$=0,p=-180,y=-85,v=180,C=85;if(a.bounds){const D=a.bounds.split(",");p=+D[0],y=+D[1],v=+D[2],C=+D[3]}if(a.center){const D=a.center.split(",");i=+D[0],u=+D[1],$=+D[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:f,tileType:1,minZoom:l,maxZoom:c,minLon:p,minLat:y,maxLon:v,maxLat:C,centerZoom:$,centerLon:i,centerLat:u,etag:e.etag}})}function Rs(o,e,n,t,r,s,a){return Y(this,null,function*(){let f=yield n.getArrayBuffer(e,o.rootDirectoryOffset,o.rootDirectoryLength,o);o.specVersion===1&&(f=vt(f));const l=bt(new DataView(f),t,r,s);if(l){let u=(yield e.getBytes(l.offset,l.length,a)).data;const $=new DataView(u);return $.getUint8(0)==31&&$.getUint8(1)==139&&(u=et(new Uint8Array(u))),{data:u}}const c=Hs(new DataView(f),{z:t,x:r,y:s});if(c){const i=Ps(new DataView(f),c.z,c.x,c.y);if(i){let u=yield n.getArrayBuffer(e,i.offset,i.length,o);o.specVersion===1&&(u=vt(u));const $=bt(new DataView(u),t,r,s);if($){let y=(yield e.getBytes($.offset,$.length,a)).data;const v=new DataView(y);return v.getUint8(0)==31&&v.getUint8(1)==139&&(y=et(new Uint8Array(y))),{data:y}}}}})}var jt={getHeader:Us,getZxy:Rs},Ws=class{constructor(){this.tile=(o,e)=>{if(o.type=="json"){const n=o.url.substr(10);let t=this.tiles.get(n);return t||(t=new yt(n),this.tiles.set(n,t)),t.getHeader().then(r=>{const s={tiles:[o.url+"/{z}/{x}/{y}"],minzoom:r.minZoom,maxzoom:r.maxZoom,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat]};e(null,s,null,null)}).catch(r=>{e(r,null,null,null)}),{cancel:()=>{}}}else{const n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=o.url.match(n);if(!t)throw new Error("Invalid PMTiles protocol URL");const r=t[1];let s=this.tiles.get(r);s||(s=new yt(r),this.tiles.set(r,s));const a=t[2],f=t[3],l=t[4],c=new AbortController,i=c.signal;let u=()=>{c.abort()};return s.getHeader().then($=>{s.getZxy(+a,+f,+l,i).then(p=>{p?e(null,new Uint8Array(p.data),p.cacheControl,p.expires):$.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(p=>{p.name!=="AbortError"&&e(p,null,null,null)})}),{cancel:u}}},this.tiles=new Map}add(o){this.tiles.set(o.source.getKey(),o)}get(o){return this.tiles.get(o)}};function Ne(o,e){return(e>>>0)*4294967296+(o>>>0)}function Is(o,e){const n=e.buf;let t,r;if(r=n[e.pos++],t=(r&112)>>4,r<128||(r=n[e.pos++],t|=(r&127)<<3,r<128)||(r=n[e.pos++],t|=(r&127)<<10,r<128)||(r=n[e.pos++],t|=(r&127)<<17,r<128)||(r=n[e.pos++],t|=(r&127)<<24,r<128)||(r=n[e.pos++],t|=(r&1)<<31,r<128))return Ne(o,t);throw new Error("Expected varint not more than 10 bytes")}function Re(o){const e=o.buf;let n,t;return t=e[o.pos++],n=t&127,t<128||(t=e[o.pos++],n|=(t&127)<<7,t<128)||(t=e[o.pos++],n|=(t&127)<<14,t<128)||(t=e[o.pos++],n|=(t&127)<<21,t<128)?n:(t=e[o.pos],n|=(t&15)<<28,Is(n,o))}function Fs(o,e,n,t){if(t==0){n==1&&(e[0]=o-1-e[0],e[1]=o-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}var zs=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Gs(o,e,n){if(o>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,o)-1||n>Math.pow(2,o)-1)throw Error("tile x/y outside zoom level bounds");const t=zs[o],r=Math.pow(2,o);let s=0,a=0,f=0;const l=[e,n];let c=r/2;for(;c>0;)s=(l[0]&c)>0?1:0,a=(l[1]&c)>0?1:0,f+=c*c*(3*s^a),Fs(c,l,s,a),c=c/2;return t+f}function Vt(o,e){return Y(this,null,function*(){if(e===1||e===0)return o;if(e===2){if(typeof globalThis.DecompressionStream>"u")return et(new Uint8Array(o));{let t=new Response(o).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var js=127;function Vs(o,e){let n=0,t=o.length-1;for(;n<=t;){const r=t+n>>1,s=e-o[r].tileId;if(s>0)n=r+1;else if(s<0)t=r-1;else return o[r]}return t>=0&&(o[t].runLength===0||e-o[t].tileId<o[t].runLength)?o[t]:null}var Ks=class{constructor(o){this.url=o}getKey(){return this.url}getBytes(o,e,n){return Y(this,null,function*(){let t;n||(t=new AbortController,n=t.signal);let r=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+o+"-"+(o+e-1)}});if(r.status===416&&o===0){const f=r.headers.get("Content-Range");if(!f||!f.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const l=+f.substr(8);r=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(l-1)}})}if(r.status>=300)throw Error("Bad response code: "+r.status);const s=r.headers.get("Content-Length");if(r.status===200&&(!s||+s>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield r.arrayBuffer(),etag:r.headers.get("ETag")||void 0,cacheControl:r.headers.get("Cache-Control")||void 0,expires:r.headers.get("Expires")||void 0}})}};function ie(o,e){const n=o.getUint32(e+4,!0),t=o.getUint32(e+0,!0);return n*Math.pow(2,32)+t}function Zs(o,e){const n=new DataView(o),t=n.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:ie(n,8),rootDirectoryLength:ie(n,16),jsonMetadataOffset:ie(n,24),jsonMetadataLength:ie(n,32),leafDirectoryOffset:ie(n,40),leafDirectoryLength:ie(n,48),tileDataOffset:ie(n,56),tileDataLength:ie(n,64),numAddressedTiles:ie(n,72),numTileEntries:ie(n,80),numTileContents:ie(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function Kt(o){const e={buf:new Uint8Array(o),pos:0},n=Re(e),t=[];let r=0;for(let s=0;s<n;s++){const a=Re(e);t.push({tileId:r+a,offset:0,length:0,runLength:1}),r+=a}for(let s=0;s<n;s++)t[s].runLength=Re(e);for(let s=0;s<n;s++)t[s].length=Re(e);for(let s=0;s<n;s++){const a=Re(e);a===0&&s>0?t[s].offset=t[s-1].offset+t[s-1].length:t[s].offset=a-1}return t}function qs(o){const e=new DataView(o);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Oe=class extends Error{};function Js(o,e,n,t){return Y(this,null,function*(){const r=yield o.getBytes(0,16384);if(new DataView(r.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(qs(r.data)<3)return[yield jt.getHeader(o)];const a=r.data.slice(0,js);let f=r.etag;t&&r.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+o.getKey()),f=void 0);const l=Zs(a,f);if(n){const c=r.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),i=o.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,u=Kt(yield e(c,l.internalCompression));return[l,[i,u.length,u]]}return[l,void 0]})}function Ys(o,e,n,t,r){return Y(this,null,function*(){const s=yield o.getBytes(n,t);if(r.etag&&r.etag!==s.etag)throw new Oe(s.etag);const a=yield e(s.data,r.internalCompression),f=Kt(a);if(f.length===0)throw new Error("Empty directory is invalid");return f})}var Qs=class{constructor(o=100,e=!0,n=Vt){this.cache=new Map,this.maxCacheEntries=o,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(o,e){return Y(this,null,function*(){const n=o.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const t=new Promise((r,s)=>{Js(o,this.decompress,this.prefetch,e).then(a=>{a[1]&&this.cache.set(a[1][0],{lastUsed:this.counter++,data:Promise.resolve(a[1][2])}),r(a[0]),this.prune()}).catch(a=>{s(a)})});return this.cache.set(n,{lastUsed:this.counter++,data:t}),t})}getDirectory(o,e,n,t){return Y(this,null,function*(){const r=o.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const s=new Promise((a,f)=>{Ys(o,this.decompress,e,n,t).then(l=>{a(l),this.prune()}).catch(l=>{f(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(o,e,n,t){return Y(this,null,function*(){const r=o.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const s=new Promise((a,f)=>{o.getBytes(e,n).then(l=>{if(t.etag&&t.etag!==l.etag)throw new Oe(l.etag);a(l.data),this.cache.has(r),this.prune()}).catch(l=>{f(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let o=1/0,e;this.cache.forEach((n,t)=>{n.lastUsed<o&&(o=n.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(o,e){return Y(this,null,function*(){this.cache.delete(o.getKey()),yield this.getHeader(o,e)})}},yt=class{constructor(o,e,n){typeof o=="string"?this.source=new Ks(o):this.source=o,n?this.decompress=n:this.decompress=Vt,e?this.cache=e:this.cache=new Qs}getHeader(){return Y(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(o,e,n,t){return Y(this,null,function*(){const r=Gs(o,e,n),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return jt.getZxy(s,this.source,this.cache,o,e,n,t);if(o<s.minZoom||o>s.maxZoom)return;let a=s.rootDirectoryOffset,f=s.rootDirectoryLength;for(let l=0;l<=3;l++){const c=yield this.cache.getDirectory(this.source,a,f,s),i=Vs(c,r);if(i)if(i.runLength>0){const u=yield this.source.getBytes(s.tileDataOffset+i.offset,i.length,t);if(s.etag&&s.etag!==u.etag)throw new Oe(u.etag);return{data:yield this.decompress(u.data,s.tileCompression),cacheControl:u.cacheControl,expires:u.expires}}else a=s.leafDirectoryOffset+i.offset,f=i.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(o,e,n,t){return Y(this,null,function*(){try{return yield this.getZxyAttempt(o,e,n,t)}catch(r){if(r instanceof Oe)return this.cache.invalidate(this.source,r.message),yield this.getZxyAttempt(o,e,n,t);throw r}})}getMetadataAttempt(){return Y(this,null,function*(){const o=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(o.jsonMetadataOffset,o.jsonMetadataLength);if(o.etag&&o.etag!==e.etag)throw new Oe(e.etag);const n=yield this.decompress(e.data,o.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(n))})}getMetadata(){return Y(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(o){if(o instanceof Oe)return this.cache.invalidate(this.source,o.message),yield this.getMetadataAttempt();throw o}})}};function Xs(o){return tt(()=>{let e=new Ws;ft.addProtocol("pmtiles",e.tile)}),Ot(()=>{ft.removeProtocol("pmtiles")}),[]}class el extends z{constructor(e){super(),G(this,e,Xs,null,j,{})}}function Lt(o,e,n){const t=o.slice();return t[15]=e[n],t}function tl(o){let e;return{c(){e=b("Home")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function St(o){let e,n;return e=new tn({props:{errorMessage:o[0]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&1&&(s.errorMessage=t[0]),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Ct(o){let e,n,t,r;function s(l){o[10](l)}function a(l){o[11](l)}let f={schemes:o[1]};return o[2]!==void 0&&(f.schemesToBeShown=o[2]),o[3]!==void 0&&(f.filterText=o[3]),e=new wr({props:f}),K.push(()=>Z(e,"schemesToBeShown",s)),K.push(()=>Z(e,"filterText",a)),{c(){_(e.$$.fragment)},m(l,c){w(e,l,c),r=!0},p(l,c){const i={};c&2&&(i.schemes=l[1]),!n&&c&4&&(n=!0,i.schemesToBeShown=l[2],q(()=>n=!1)),!t&&c&8&&(t=!0,i.filterText=l[3],q(()=>t=!1)),e.$set(i)},i(l){r||(g(e.$$.fragment,l),r=!0)},o(l){d(e.$$.fragment,l),r=!1},d(l){k(e,l)}}}function Tt(o){let e,n;return e=new Vo({props:{scheme:o[15],authorityNames:o[5]}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.scheme=t[15]),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function Dt(o){let e=o[2].has(o[15].scheme_reference),n,t,r=e&&Tt(o);return{c(){r&&r.c(),n=nn()},m(s,a){r&&r.m(s,a),m(s,n,a),t=!0},p(s,a){a&6&&(e=s[2].has(s[15].scheme_reference)),e?r?(r.p(s,a),a&6&&g(r,1)):(r=Tt(s),r.c(),g(r,1),r.m(n.parentNode,n)):r&&(be(),d(r,1,1,()=>{r=null}),ve())},i(s){t||(g(r),t=!0)},o(s){d(r),t=!1},d(s){s&&h(n),r&&r.d(s)}}}function nl(o){let e,n,t,r,s,a,f,l,c,i,u,$,p,y;n=new Fe({props:{$$slots:{default:[tl]},$$scope:{ctx:o}}}),n.$on("click",o[9]),f=new ln({props:{boundaryGeojson:o[4]}});let v=o[0]&&St(o);i=new Xt({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:o[7]}});let C=o[1].size>0&&Ct(o),B=Ae(o[1].values()),D=[];for(let L=0;L<B.length;L+=1)D[L]=Dt(Lt(o,B,L));const O=L=>d(D[L],1,1,()=>{D[L]=null});return{c(){e=M("div"),_(n.$$.fragment),t=A(),r=M("div"),s=M("h1"),s.textContent="Browse schemes",a=A(),_(f.$$.fragment),l=A(),v&&v.c(),c=A(),_(i.$$.fragment),u=A(),C&&C.c(),$=A(),p=M("ul");for(let L=0;L<D.length;L+=1)D[L].c();de(r,"display","flex"),de(r,"justify-content","space-between"),F(e,"slot","sidebar"),F(e,"class","govuk-prose")},m(L,N){m(L,e,N),w(n,e,null),S(e,t),S(e,r),S(r,s),S(r,a),w(f,r,null),S(e,l),v&&v.m(e,null),S(e,c),w(i,e,null),S(e,u),C&&C.m(e,null),S(e,$),S(e,p);for(let U=0;U<D.length;U+=1)D[U]&&D[U].m(p,null);y=!0},p(L,N){const U={};N&262144&&(U.$$scope={dirty:N,ctx:L}),n.$set(U);const P={};if(N&16&&(P.boundaryGeojson=L[4]),f.$set(P),L[0]?v?(v.p(L,N),N&1&&g(v,1)):(v=St(L),v.c(),g(v,1),v.m(e,c)):v&&(be(),d(v,1,1,()=>{v=null}),ve()),L[1].size>0?C?(C.p(L,N),N&2&&g(C,1)):(C=Ct(L),C.c(),g(C,1),C.m(e,$)):C&&(be(),d(C,1,1,()=>{C=null}),ve()),N&38){B=Ae(L[1].values());let T;for(T=0;T<B.length;T+=1){const x=Lt(L,B,T);D[T]?(D[T].p(x,N),g(D[T],1)):(D[T]=Dt(x),D[T].c(),g(D[T],1),D[T].m(p,null))}for(be(),T=B.length;T<D.length;T+=1)O(T);ve()}},i(L){if(!y){g(n.$$.fragment,L),g(f.$$.fragment,L),g(v),g(i.$$.fragment,L),g(C);for(let N=0;N<B.length;N+=1)g(D[N]);y=!0}},o(L){d(n.$$.fragment,L),d(f.$$.fragment,L),d(v),d(i.$$.fragment,L),d(C),D=D.filter(Boolean);for(let N=0;N<D.length;N+=1)d(D[N]);y=!1},d(L){L&&h(e),k(n),k(f),v&&v.d(),k(i),C&&C.d(),Ye(D,L)}}}function rl(o){let e,n,t,r,s,a,f,l;return e=new Yo({}),t=new Br({}),s=new rs({}),f=new Wo({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(s.$$.fragment),a=A(),_(f.$$.fragment)},m(c,i){w(e,c,i),m(c,n,i),w(t,c,i),m(c,r,i),w(s,c,i),m(c,a,i),w(f,c,i),l=!0},i(c){l||(g(e.$$.fragment,c),g(t.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),l=!0)},o(c){d(e.$$.fragment,c),d(t.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),l=!1},d(c){c&&(h(n),h(r),h(a)),k(e,c),k(t,c),k(s,c),k(f,c)}}}function ol(o){let e,n;return e=new nt({props:{small:!0,$$slots:{default:[rl]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&262144&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function sl(o){let e,n,t,r,s,a;return e=new _o({}),t=new kn({}),s=new ur({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(s.$$.fragment)},m(f,l){w(e,f,l),m(f,n,l),w(t,f,l),m(f,r,l),w(s,f,l),a=!0},i(f){a||(g(e.$$.fragment,f),g(t.$$.fragment,f),g(s.$$.fragment,f),a=!0)},o(f){d(e.$$.fragment,f),d(t.$$.fragment,f),d(s.$$.fragment,f),a=!1},d(f){f&&(h(n),h(r)),k(e,f),k(t,f),k(s,f)}}}function ll(o){let e,n;return e=new nt({props:{small:!0,$$slots:{default:[sl]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&262144&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function il(o){let e,n,t,r,s,a,f,l,c,i;return e=new Do({}),t=new ps({}),s=new er({}),f=new qr({}),c=new ao({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(s.$$.fragment),a=A(),_(f.$$.fragment),l=A(),_(c.$$.fragment)},m(u,$){w(e,u,$),m(u,n,$),w(t,u,$),m(u,r,$),w(s,u,$),m(u,a,$),w(f,u,$),m(u,l,$),w(c,u,$),i=!0},i(u){i||(g(e.$$.fragment,u),g(t.$$.fragment,u),g(s.$$.fragment,u),g(f.$$.fragment,u),g(c.$$.fragment,u),i=!0)},o(u){d(e.$$.fragment,u),d(t.$$.fragment,u),d(s.$$.fragment,u),d(f.$$.fragment,u),d(c.$$.fragment,u),i=!1},d(u){u&&(h(n),h(r),h(a),h(l)),k(e,u),k(t,u),k(s,u),k(f,u),k(c,u)}}}function al(o){let e,n;return e=new nt({props:{small:!0,$$slots:{default:[il]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&262144&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function ul(o){let e,n,t,r;return e=new Gn({}),t=new Rr({}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment)},m(s,a){w(e,s,a),m(s,n,a),w(t,s,a),r=!0},i(s){r||(g(e.$$.fragment,s),g(t.$$.fragment,s),r=!0)},o(s){d(e.$$.fragment,s),d(t.$$.fragment,s),r=!1},d(s){s&&h(n),k(e,s),k(t,s)}}}function cl(o){let e,n,t,r,s,a,f,l,c,i;return e=new De({props:{label:"Trip generators",$$slots:{default:[ol]},$$scope:{ctx:o}}}),t=new De({props:{label:"Existing infrastructure",$$slots:{default:[ll]},$$scope:{ctx:o}}}),s=new De({props:{label:"Boundaries",$$slots:{default:[al]},$$scope:{ctx:o}}}),f=new De({props:{label:"Census",$$slots:{default:[ul]},$$scope:{ctx:o}}}),c=new cn({props:{style:o[6]}}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(s.$$.fragment),a=A(),_(f.$$.fragment),l=A(),_(c.$$.fragment)},m(u,$){w(e,u,$),m(u,n,$),w(t,u,$),m(u,r,$),w(s,u,$),m(u,a,$),w(f,u,$),m(u,l,$),w(c,u,$),i=!0},p(u,$){const p={};$&262144&&(p.$$scope={dirty:$,ctx:u}),e.$set(p);const y={};$&262144&&(y.$$scope={dirty:$,ctx:u}),t.$set(y);const v={};$&262144&&(v.$$scope={dirty:$,ctx:u}),s.$set(v);const C={};$&262144&&(C.$$scope={dirty:$,ctx:u}),f.$set(C)},i(u){i||(g(e.$$.fragment,u),g(t.$$.fragment,u),g(s.$$.fragment,u),g(f.$$.fragment,u),g(c.$$.fragment,u),i=!0)},o(u){d(e.$$.fragment,u),d(t.$$.fragment,u),d(s.$$.fragment,u),d(f.$$.fragment,u),d(c.$$.fragment,u),i=!1},d(u){u&&(h(n),h(r),h(a),h(l)),k(e,u),k(t,u),k(s,u),k(f,u),k(c,u)}}}function fl(o){let e,n,t,r,s,a,f,l,c,i,u;return e=new un({props:{colorInterventions:Pt("v1")}}),t=new Q({props:{layer:"interventions-points",tooltip:o[8],clickable:!1}}),s=new Q({props:{layer:"interventions-lines",tooltip:o[8],clickable:!1}}),f=new Q({props:{layer:"interventions-polygons",tooltip:o[8],clickable:!1}}),i=new De({props:{label:"Layers",open:!0,$$slots:{default:[cl]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment),n=A(),_(t.$$.fragment),r=A(),_(s.$$.fragment),a=A(),_(f.$$.fragment),l=A(),c=M("div"),_(i.$$.fragment),F(c,"class","top-right svelte-12h3i77")},m($,p){w(e,$,p),m($,n,p),w(t,$,p),m($,r,p),w(s,$,p),m($,a,p),w(f,$,p),m($,l,p),m($,c,p),w(i,c,null),u=!0},p($,p){const y={};p&262144&&(y.$$scope={dirty:p,ctx:$}),i.$set(y)},i($){u||(g(e.$$.fragment,$),g(t.$$.fragment,$),g(s.$$.fragment,$),g(f.$$.fragment,$),g(i.$$.fragment,$),u=!0)},o($){d(e.$$.fragment,$),d(t.$$.fragment,$),d(s.$$.fragment,$),d(f.$$.fragment,$),d(i.$$.fragment,$),u=!1},d($){$&&(h(n),h(r),h(a),h(l),h(c)),k(e,$),k(t,$),k(s,$),k(f,$),k(i)}}}function $l(o){let e,n,t,r,s;return n=new el({}),r=new an({props:{style:o[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[fl]},$$scope:{ctx:o}}}),{c(){e=M("div"),_(n.$$.fragment),t=A(),_(r.$$.fragment),F(e,"slot","main")},m(a,f){m(a,e,f),w(n,e,null),S(e,t),w(r,e,null),s=!0},p(a,f){const l={};f&262144&&(l.$$scope={dirty:f,ctx:a}),r.$set(l)},i(a){s||(g(n.$$.fragment,a),g(r.$$.fragment,a),s=!0)},o(a){d(n.$$.fragment,a),d(r.$$.fragment,a),s=!1},d(a){a&&h(e),k(n),k(r)}}}function pl(o){let e,n;return e=new sn({props:{$$slots:{main:[$l],sidebar:[nl]},$$scope:{ctx:o}}}),{c(){_(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&262175&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){d(e.$$.fragment,t),n=!1},d(t){k(e,t)}}}function ml(o,e,n){let t,r;J(o,X,D=>n(12,t=D)),J(o,Pe,D=>n(4,r=D));let s=new Set(fn);tt(()=>{en()});let f=new URLSearchParams(window.location.search).get("style")||"dataviz",l="",c=new Map,i=new Set,u="";Ot(()=>{Pe.set(H.emptyGeojson())});function $(D){try{let O=JSON.parse(D);n(1,c=cr(O)),Pe.set(O),n(0,l=""),t==null||t.fitBounds(H.bbox(O),{padding:20,animate:!1})}catch(O){n(0,l=`Couldn't load schemes from a file: ${O}`)}}function p(D){let O=D.properties;var L='<div style="max-width: 30vw;">';return L+=`<h2>${y(O.name)} (${O.intervention_type})</h2>`,L+=`<p>Scheme reference: ${O.scheme_reference}</p>`,O.length_meters&&(L+=`<p>Length: ${H.prettyPrintMeters(O.length_meters)}</p>`),O.description&&(L+=`<p>${y(O.description)}</p>`),L+="</div>",L}function y(D){return u?D.replace(new RegExp(u,"gi"),O=>`<mark>${O}</mark>`):D}const v=()=>window.open("index.html");function C(D){i=D,n(2,i)}function B(D){u=D,n(3,u)}return[l,c,i,u,r,s,f,$,p,v,C,B]}class hl extends z{constructor(e){super(),G(this,e,ml,pl,j,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new hl({target:document.getElementById("app")});
