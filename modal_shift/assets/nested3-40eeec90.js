import{S as K,i as Q,s as Y,F as ie,g as v,d as y,m as D,j as h,t as _,n as b,o as k,p as C,E as ae,e as B,h as I,v as G,w as J,aq as be,b as j,c as F,l as q,u as X,ax as we,a as he,k as T,ap as ke,q as ge,B as ve,r as de,a1 as De,b3 as Ce,f as $e,aI as ce,L as ye,_ as Se,$ as Me,M as Ee,y as Le,H as se}from"./index-445dee49.js";import{D as Re}from"./DefaultButton-c39a7961.js";import{h as Ie,i as Te,k as pe,G as Be,B as Pe,S as Ae}from"./StreetViewTool-a91df1b5.js";import{T as _e,W as je}from"./WarningButton-802f92c2.js";import{a as Fe,L as qe}from"./LineMeasureController-defe0223.js";function We(r){let e,n,t,l,o,s;return e=new ae({props:{errorMessage:r[1]}}),{c(){v(e.$$.fragment),n=y(),t=B("input"),I(t,"type","text"),I(t,"class","govuk-input"),I(t,"id","locationDescription")},m(i,a){D(e,i,a),h(i,n,a),h(i,t,a),G(t,r[0]),l=!0,o||(s=[J(t,"input",r[5]),J(t,"change",r[3])],o=!0)},p(i,a){const f={};a&2&&(f.errorMessage=i[1]),e.$set(f),a&1&&t.value!==i[0]&&G(t,i[0])},i(i){l||(_(e.$$.fragment,i),l=!0)},o(i){b(e.$$.fragment,i),l=!1},d(i){i&&(k(n),k(t)),C(e,i),o=!1,be(s)}}}function Ve(r){let e;return{c(){e=X("Lookup location description automatically")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function Ge(r){let e,n,t;function l(s){r[6](s)}let o={id:"lookupLocation",$$slots:{default:[Ve]},$$scope:{ctx:r}};return r[2]!==void 0&&(o.checked=r[2]),e=new Te({props:o}),j.push(()=>F(e,"checked",l)),{c(){v(e.$$.fragment)},m(s,i){D(e,s,i),t=!0},p(s,i){const a={};i&256&&(a.$$scope={dirty:i,ctx:s}),!n&&i&4&&(n=!0,a.checked=s[2],q(()=>n=!1)),e.$set(a)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){b(e.$$.fragment,s),t=!1},d(s){C(e,s)}}}function He(r){let e,n,t,l;return e=new ie({props:{label:"Describe this location",id:"locationDescription",$$slots:{default:[We]},$$scope:{ctx:r}}}),t=new Ie({props:{small:!0,$$slots:{default:[Ge]},$$scope:{ctx:r}}}),{c(){v(e.$$.fragment),n=y(),v(t.$$.fragment)},m(o,s){D(e,o,s),h(o,n,s),D(t,o,s),l=!0},p(o,[s]){const i={};s&259&&(i.$$scope={dirty:s,ctx:o}),e.$set(i);const a={};s&260&&(a.$$scope={dirty:s,ctx:o}),t.$set(a)},i(o){l||(_(e.$$.fragment,o),_(t.$$.fragment,o),l=!0)},o(o){b(e.$$.fragment,o),b(t.$$.fragment,o),l=!1},d(o){o&&k(n),C(e,o),C(t,o)}}}function Oe(r,e,n){let{locationDescription:t}=e,{locationDescriptionError:l}=e,{pt:o}=e,s=!0;async function i(p){if(!s)return;let w=`https://nominatim.openstreetmap.org/reverse?lat=${p.lat}&lon=${p.lng}&format=json`;try{n(0,t="Loading...");let c=await(await fetch(w)).json();n(0,t=c.address.road??c.display_name)}catch(d){console.log(`Location lookup failed: ${d}`)}}function a(){n(2,s=!1)}function f(){t=this.value,n(0,t)}function g(p){s=p,n(2,s)}return r.$$set=p=>{"locationDescription"in p&&n(0,t=p.locationDescription),"locationDescriptionError"in p&&n(1,l=p.locationDescriptionError),"pt"in p&&n(4,o=p.pt)},r.$$.update=()=>{r.$$.dirty&16&&i(o)},[t,l,s,a,o,f,g]}class Ne extends K{constructor(e){super(),Q(this,e,Oe,He,Y,{locationDescription:0,locationDescriptionError:1,pt:4})}}function Ue(r){let e,n,t,l,o,s;return e=new ae({props:{errorMessage:r[7]}}),{c(){v(e.$$.fragment),n=y(),t=B("input"),I(t,"type","text"),I(t,"class","govuk-input"),I(t,"id","inspector")},m(i,a){D(e,i,a),h(i,n,a),h(i,t,a),G(t,r[1]),l=!0,o||(s=J(t,"input",r[18]),o=!0)},p(i,a){const f={};a&128&&(f.errorMessage=i[7]),e.$set(f),a&2&&t.value!==i[1]&&G(t,i[1])},i(i){l||(_(e.$$.fragment,i),l=!0)},o(i){b(e.$$.fragment,i),l=!1},d(i){i&&(k(n),k(t)),C(e,i),o=!1,s()}}}function ze(r){let e,n,t,l,o,s,i,a;return t=new ae({props:{errorMessage:r[8]}}),{c(){e=B("div"),e.textContent="Example: ATF2_WLT_01",n=y(),v(t.$$.fragment),l=y(),o=B("input"),I(e,"class","govuk-hint"),I(o,"type","text"),I(o,"class","govuk-input"),I(o,"id","schemeReference")},m(f,g){h(f,e,g),h(f,n,g),D(t,f,g),h(f,l,g),h(f,o,g),G(o,r[2]),s=!0,i||(a=J(o,"input",r[19]),i=!0)},p(f,g){const p={};g&256&&(p.errorMessage=f[8]),t.$set(p),g&4&&o.value!==f[2]&&G(o,f[2])},i(f){s||(_(t.$$.fragment,f),s=!0)},o(f){b(t.$$.fragment,f),s=!1},d(f){f&&(k(e),k(n),k(l),k(o)),C(t,f),i=!1,a()}}}function Je(r){let e;return{c(){e=X("Export")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function Ke(r){let e;return{c(){e=X("Keep editing this issue")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function Qe(r){let e;return{c(){e=X("Done! Enter a new critical")},m(n,t){h(n,e,t)},d(n){n&&k(e)}}}function Ye(r){let e,n,t,l,o,s,i,a,f,g,p,w;return s=new _e({props:{label:"The new row has already been copied to your clipboard. If it didn't work, copy from below",value:r[14]}}),f=new he({props:{$$slots:{default:[Ke]},$$scope:{ctx:r}}}),f.$on("click",r[24]),p=new je({props:{$$slots:{default:[Qe]},$$scope:{ctx:r}}}),p.$on("click",xe),{c(){e=B("div"),n=B("p"),n.innerHTML=`Edit <i>Inspectors Log.xlsx</i>
      , add a new row at the bottom of
      <i>Form Input</i>
      , and press
      <i>Control+V</i>
      to paste.`,t=y(),l=B("p"),l.innerHTML="<b>You have to manually fill out the first ID column!</b>",o=y(),v(s.$$.fragment),i=y(),a=B("div"),v(f.$$.fragment),g=y(),v(p.$$.fragment),I(a,"class","govuk-button-group"),I(e,"class","govuk-prose")},m(d,c){h(d,e,c),T(e,n),T(e,t),T(e,l),T(e,o),D(s,e,null),T(e,i),T(e,a),D(f,a,null),T(a,g),D(p,a,null),w=!0},p(d,c){const M={};c&16384&&(M.value=d[14]),s.$set(M);const S={};c&134217728&&(S.$$scope={dirty:c,ctx:d}),f.$set(S);const E={};c&134217728&&(E.$$scope={dirty:c,ctx:d}),p.$set(E)},i(d){w||(_(s.$$.fragment,d),_(f.$$.fragment,d),_(p.$$.fragment,d),w=!0)},o(d){b(s.$$.fragment,d),b(f.$$.fragment,d),b(p.$$.fragment,d),w=!1},d(d){d&&k(e),C(s),C(f),C(p)}}}function Xe(r){let e,n,t,l,o,s,i,a,f,g,p,w,d,c,M,S,E,A,m,L,P;e=new ie({props:{label:"Inspector name",id:"inspector",$$slots:{default:[Ue]},$$scope:{ctx:r}}}),t=new ie({props:{label:"Scheme reference",id:"schemeReference",$$slots:{default:[ze]},$$scope:{ctx:r}}});function V(u){r[20](u)}let W={label:"Current design stage",id:"currentDesignStage",choices:r[15],emptyOption:!0,errorMessage:r[9]};r[3]!==void 0&&(W.value=r[3]),o=new pe({props:W}),j.push(()=>F(o,"value",V));function Z(u){r[21](u)}let H={pt:r[0],locationDescriptionError:r[11]};r[5]!==void 0&&(H.locationDescription=r[5]),a=new Ne({props:H}),j.push(()=>F(a,"locationDescription",Z));function x(u){r[22](u)}let O={label:"Critical issue type",id:"criticalIssueType",choices:r[16],emptyOption:!0,errorMessage:r[10]};r[4]!==void 0&&(O.value=r[4]),p=new pe({props:O}),j.push(()=>F(p,"value",x));function ee(u){r[23](u)}let N={label:"Comments or notes",errorMessage:r[12]};r[6]!==void 0&&(N.value=r[6]),c=new _e({props:N}),j.push(()=>F(c,"value",ee)),E=new Re({props:{$$slots:{default:[Je]},$$scope:{ctx:r}}}),E.$on("click",r[17]);function R(u){r[25](u)}let U={title:"Almost done!",displayEscapeButton:!1,canCloseByClickingBackground:!1,$$slots:{default:[Ye]},$$scope:{ctx:r}};return r[13]!==void 0&&(U.open=r[13]),m=new we({props:U}),j.push(()=>F(m,"open",R)),{c(){v(e.$$.fragment),n=y(),v(t.$$.fragment),l=y(),v(o.$$.fragment),i=y(),v(a.$$.fragment),g=y(),v(p.$$.fragment),d=y(),v(c.$$.fragment),S=y(),v(E.$$.fragment),A=y(),v(m.$$.fragment)},m(u,$){D(e,u,$),h(u,n,$),D(t,u,$),h(u,l,$),D(o,u,$),h(u,i,$),D(a,u,$),h(u,g,$),D(p,u,$),h(u,d,$),D(c,u,$),h(u,S,$),D(E,u,$),h(u,A,$),D(m,u,$),P=!0},p(u,[$]){const le={};$&134217858&&(le.$$scope={dirty:$,ctx:u}),e.$set(le);const ue={};$&134217988&&(ue.$$scope={dirty:$,ctx:u}),t.$set(ue);const te={};$&512&&(te.errorMessage=u[9]),!s&&$&8&&(s=!0,te.value=u[3],q(()=>s=!1)),o.$set(te);const z={};$&1&&(z.pt=u[0]),$&2048&&(z.locationDescriptionError=u[11]),!f&&$&32&&(f=!0,z.locationDescription=u[5],q(()=>f=!1)),a.$set(z);const ne={};$&1024&&(ne.errorMessage=u[10]),!w&&$&16&&(w=!0,ne.value=u[4],q(()=>w=!1)),p.$set(ne);const re={};$&4096&&(re.errorMessage=u[12]),!M&&$&64&&(M=!0,re.value=u[6],q(()=>M=!1)),c.$set(re);const fe={};$&134217728&&(fe.$$scope={dirty:$,ctx:u}),E.$set(fe);const oe={};$&134242304&&(oe.$$scope={dirty:$,ctx:u}),!L&&$&8192&&(L=!0,oe.open=u[13],q(()=>L=!1)),m.$set(oe)},i(u){P||(_(e.$$.fragment,u),_(t.$$.fragment,u),_(o.$$.fragment,u),_(a.$$.fragment,u),_(p.$$.fragment,u),_(c.$$.fragment,u),_(E.$$.fragment,u),_(m.$$.fragment,u),P=!0)},o(u){b(e.$$.fragment,u),b(t.$$.fragment,u),b(o.$$.fragment,u),b(a.$$.fragment,u),b(p.$$.fragment,u),b(c.$$.fragment,u),b(E.$$.fragment,u),b(m.$$.fragment,u),P=!1},d(u){u&&(k(n),k(l),k(i),k(g),k(d),k(S),k(A)),C(e,u),C(t,u),C(o,u),C(a,u),C(p,u),C(c,u),C(E,u),C(m,u)}}}function me(r){return r.map(e=>[e,e])}function Ze(r){let e=25569,t=24*(60*60*1e3);return r.getTime()/t+e}function xe(){location.reload()}function et(r,e,n){let{pt:t}=e,l=window.localStorage.getItem("inspector")??"",o=window.localStorage.getItem("schemeReference")??"",s=window.localStorage.getItem("currentDesignStage")??"",i="",a="",f="",g="",p="",w="",d="",c="",M="",S=!1,E="",A=me(["Baseline","Feasibility Design","Preliminary Design","Outline Design","Detailed Design","Inspection"]),m=me(["1 - Conflict at Side Roads","2 - Conflict at Major Junctions / Roundabouts","3 - Collision Alongside or from Behind","4 - Trip Hazard","5 - Kerbside Activity","6A - Risk of Crossing Conflict (Busy Roads)","6B - Risk of Crossing Conflict (Quieter Roads)","7A - Standard of Crossing Facility (Busy Roads)","7B - Standard of Crossing Facility (Junction)","8 - Traffic Speed (>37mph)","9A - Traffic Volume (>10,000vpd)","9B - Traffic Volume (>5% HGVs)","10 - Crossing Speed","11A - Footway Width (Absolute Minimum <1m)","11B - Footway Width (at Pinchpoints)","11C - Footway Width - Poor Pedestrian Comfort","12 - Tram - Insufficient width next to Tram Track","13 - Tram/Rail - Poor Crossing Angle","14 - Major Cycle Surface Defect","15 - Major Pedestrian Surface Defect","16 - Inappropriate Shared Use","17 - Barriers, Steps and/or Dismount signs","18 - Route isn't direct, logical or intuitive to all users","19 - Inappropriate Surface Materials","20 - Inappropriate Lighting","21 - Routes must join other facilities as a network"]);function L(){let R=0,U=Ze(new Date);return[R,l,U,o,s,i,ke(t.toArray().reverse()).join(", "),a,f].join("	")}function P(){n(7,g=l?"":"Required"),n(8,p=o?"":"Required"),n(9,w=s?"":"Required"),n(10,d=i?"":"Required"),n(11,c=a?"":"Required"),n(12,M=f?"":"Required"),!(g||p||w||d||c||M)&&(n(14,E=L()),navigator.clipboard.writeText(E),n(13,S=!0))}function V(){l=this.value,n(1,l)}function W(){o=this.value,n(2,o)}function Z(R){s=R,n(3,s)}function H(R){a=R,n(5,a)}function x(R){i=R,n(4,i)}function O(R){f=R,n(6,f)}const ee=()=>n(13,S=!1);function N(R){S=R,n(13,S)}return r.$$set=R=>{"pt"in R&&n(0,t=R.pt)},r.$$.update=()=>{r.$$.dirty&2&&window.localStorage.setItem("inspector",l),r.$$.dirty&4&&window.localStorage.setItem("schemeReference",o),r.$$.dirty&8&&window.localStorage.setItem("currentDesignStage",s)},[t,l,o,s,i,a,f,g,p,w,d,c,M,S,E,A,m,P,V,W,Z,H,x,O,ee,N]}class tt extends K{constructor(e){super(),Q(this,e,et,Xe,Y,{pt:0})}}function nt(r,e,n){let t;ge(r,ve,a=>n(3,t=a));let{enableAdding:l}=e,o=null,{markerPosition:s=null}=e;de(()=>{t.on("click",i),t.getCanvas().style.cursor="crosshair"}),De(()=>{o&&o.remove(),t.off("click",i)});function i(a){o||!l||(t.getCanvas().style.cursor="inherit",o=new Ce.Marker({draggable:!0}).setLngLat(a.lngLat).addTo(t),n(0,s=o.getLngLat()),o.on("dragstart",()=>{t.getCanvas().style.cursor="grabbing"}),o.on("dragend",()=>{t.getCanvas().style.cursor="inherit",n(0,s=o.getLngLat())}))}return r.$$set=a=>{"enableAdding"in a&&n(1,l=a.enableAdding),"markerPosition"in a&&n(0,s=a.markerPosition)},[s,l]}class rt extends K{constructor(e){super(),Q(this,e,nt,null,Y,{enableAdding:1,markerPosition:0})}}function ot(r){let e;return{c(){e=B("p"),e.textContent="Click the map to add a critical"},m(n,t){h(n,e,t)},p:se,i:se,o:se,d(n){n&&k(e)}}}function st(r){let e,n;return e=new tt({props:{pt:r[0]}}),{c(){v(e.$$.fragment)},m(t,l){D(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.pt=t[0]),e.$set(o)},i(t){n||(_(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function it(r){let e,n,t,l,o,s,i,a,f,g;s=new ye({});const p=[st,ot],w=[];function d(c,M){return c[0]?0:1}return a=d(r),f=w[a]=p[a](r),{c(){e=B("div"),n=B("h1"),n.textContent="Critical issue entry",t=y(),l=B("p"),l.textContent=`App version: ${$e()}`,o=y(),v(s.$$.fragment),i=y(),f.c(),I(e,"slot","sidebar"),I(e,"class","govuk-prose")},m(c,M){h(c,e,M),T(e,n),T(e,t),T(e,l),T(e,o),D(s,e,null),T(e,i),w[a].m(e,null),g=!0},p(c,M){let S=a;a=d(c),a===S?w[a].p(c,M):(Se(),b(w[S],1,1,()=>{w[S]=null}),Me(),f=w[a],f?f.p(c,M):(f=w[a]=p[a](c),f.c()),_(f,1),f.m(e,null))},i(c){g||(_(s.$$.fragment,c),_(f),g=!0)},o(c){b(s.$$.fragment,c),b(f),g=!1},d(c){c&&k(e),C(s),w[a].d()}}}function at(r){let e,n,t,l,o,s,i,a,f,g,p,w,d,c;e=new Be({});function M(m){r[3](m)}let S={enableAdding:!r[1]};r[0]!==void 0&&(S.markerPosition=r[0]),t=new rt({props:S}),j.push(()=>F(t,"markerPosition",M)),i=new Pe({props:{disabled:r[1]}});function E(m){r[4](m)}let A={};return r[1]!==void 0&&(A.enabled=r[1]),f=new Ae({props:A}),j.push(()=>F(f,"enabled",E)),d=new qe({}),{c(){v(e.$$.fragment),n=y(),v(t.$$.fragment),o=y(),s=B("div"),v(i.$$.fragment),a=y(),v(f.$$.fragment),p=y(),w=B("div"),v(d.$$.fragment),I(s,"class","top-right svelte-nlvvhu")},m(m,L){D(e,m,L),h(m,n,L),D(t,m,L),h(m,o,L),h(m,s,L),D(i,s,null),T(s,a),D(f,s,null),T(s,p),T(s,w),D(d,w,null),c=!0},p(m,L){const P={};L&2&&(P.enableAdding=!m[1]),!l&&L&1&&(l=!0,P.markerPosition=m[0],q(()=>l=!1)),t.$set(P);const V={};L&2&&(V.disabled=m[1]),i.$set(V);const W={};!g&&L&2&&(g=!0,W.enabled=m[1],q(()=>g=!1)),f.$set(W)},i(m){c||(_(e.$$.fragment,m),_(t.$$.fragment,m),_(i.$$.fragment,m),_(f.$$.fragment,m),_(d.$$.fragment,m),c=!0)},o(m){b(e.$$.fragment,m),b(t.$$.fragment,m),b(i.$$.fragment,m),b(f.$$.fragment,m),b(d.$$.fragment,m),c=!1},d(m){m&&(k(n),k(o),k(s)),C(e,m),C(t,m),C(i),C(f),C(d)}}}function lt(r){let e,n,t;return n=new Ee({props:{style:r[2],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[at]},$$scope:{ctx:r}}}),{c(){e=B("div"),v(n.$$.fragment),I(e,"slot","main")},m(l,o){h(l,e,o),D(n,e,null),t=!0},p(l,o){const s={};o&4&&(s.style=l[2]),o&131&&(s.$$scope={dirty:o,ctx:l}),n.$set(s)},i(l){t||(_(n.$$.fragment,l),t=!0)},o(l){b(n.$$.fragment,l),t=!1},d(l){l&&k(e),C(n)}}}function ut(r){let e,n;return e=new Fe({props:{sidebarWidth:"35rem",$$slots:{main:[lt],sidebar:[it]},$$scope:{ctx:r}}}),{c(){v(e.$$.fragment)},m(t,l){D(e,t,l),n=!0},p(t,[l]){const o={};l&135&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){n||(_(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function ft(r,e,n){let t;ge(r,ce,g=>n(2,t=g)),de(()=>{Le()});const l=new URLSearchParams(window.location.search);let o=$e()=="Private (development)"?"Road":"dataviz";ce.set(l.get("style")||o);let s=null,i=!1;function a(g){s=g,n(0,s)}function f(g){i=g,n(1,i)}return[s,i,t,a,f]}class ct extends K{constructor(e){super(),Q(this,e,ft,ut,Y,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new ct({target:document.getElementById("app")});
