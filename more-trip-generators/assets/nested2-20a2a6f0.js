import{S as j,i as F,s as G,V as Le,e as A,f as U,X as ue,j as m,x as ae,p as g,W as Ke,u as b,k as S,U as te,b as V,c as Z,I as ne,g as d,m as w,o as q,t as h,y as me,l as _,n as ge,q as v,_ as W,C as re,aW as Ee,a1 as De,G as he,a7 as Oe,h as H,aV as z,a0 as Ot,az as Qt,a2 as Te,r as Qe,F as en,a as Ie,v as ct,w as tn,H as Ut,L as Mt,M as Nt,N as At,D as Bt,aX as ut,ag as Et,d as nn,z as rn,A as sn,a9 as on,aP as ln,E as an,ad as fn}from"./data_getter-55d1076d.js";import{d as ie,H as fe,j as we,S as We,h as cn,i as $t,g as Pt,C as de,L as un,Z as $n,M as pn,I as mn,B as gn,b as et}from"./schemas-85566f27.js";const K={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",green_spaces:"green",sports_spaces:"#013220",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function pt(s,e,n){const t=s.slice();return t[2]=e[n],t}function mt(s,e,n){const t=s.slice();return t[5]=e[n],t}function gt(s){let e,n;return{c(){e=A("span"),n=b(` 
    `),ue(e,"background",s[5]),ue(e,"width","100%"),ue(e,"border","1px solid black")},m(t,r){m(t,e,r),S(e,n)},p(t,r){r&1&&ue(e,"background",t[5])},d(t){t&&g(e)}}}function ht(s){let e,n=s[2].toLocaleString()+"",t;return{c(){e=A("span"),t=b(n)},m(r,o){m(r,e,o),S(e,t)},p(r,o){o&2&&n!==(n=r[2].toLocaleString()+"")&&te(t,n)},d(r){r&&g(e)}}}function hn(s){let e,n,t,r=Le(s[0]),o=[];for(let l=0;l<r.length;l+=1)o[l]=gt(mt(s,r,l));let i=Le(s[1]),u=[];for(let l=0;l<i.length;l+=1)u[l]=ht(pt(s,i,l));return{c(){e=A("div");for(let l=0;l<o.length;l+=1)o[l].c();n=U(),t=A("div");for(let l=0;l<u.length;l+=1)u[l].c();ue(e,"display","flex"),ue(t,"display","flex"),ue(t,"justify-content","space-between")},m(l,c){m(l,e,c);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);m(l,n,c),m(l,t,c);for(let a=0;a<u.length;a+=1)u[a]&&u[a].m(t,null)},p(l,[c]){if(c&1){r=Le(l[0]);let a;for(a=0;a<r.length;a+=1){const f=mt(l,r,a);o[a]?o[a].p(f,c):(o[a]=gt(f),o[a].c(),o[a].m(e,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}if(c&2){i=Le(l[1]);let a;for(a=0;a<i.length;a+=1){const f=pt(l,i,a);u[a]?u[a].p(f,c):(u[a]=ht(f),u[a].c(),u[a].m(t,null))}for(;a<u.length;a+=1)u[a].d(1);u.length=i.length}},i:ae,o:ae,d(l){l&&(g(e),g(n),g(t)),Ke(o,l),Ke(u,l)}}}function _n(s,e,n){let{colorScale:t}=e,{limits:r}=e;return s.$$set=o=>{"colorScale"in o&&n(0,t=o.colorScale),"limits"in o&&n(1,r=o.limits)},[t,r]}class tt extends j{constructor(e){super(),F(this,e,_n,hn,G,{colorScale:0,limits:1})}}function dn(s){let e;return{c(){e=b("Percent of households with a car")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function wn(s){let e;return{c(){e=b(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function vn(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function kn(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function bn(s){let e,n,t,r,o,i,u,l,c,a,f,$;return t=new z({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[wn]},$$scope:{ctx:s}}}),o=new z({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[vn]},$$scope:{ctx:s}}}),a=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[kn]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("Car/van availability data is from the 2021 census, via "),d(t.$$.fragment),r=b(". Output area boundaries from "),d(o.$$.fragment),i=b("."),u=U(),l=A("p"),c=b("License: "),d(a.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,u,y),m(p,l,y),S(l,c),w(a,l,null),S(l,f),$=!0},p(p,y){const k={};y&131072&&(k.$$scope={dirty:y,ctx:p}),t.$set(k);const C={};y&131072&&(C.$$scope={dirty:y,ctx:p}),o.$set(C);const L={};y&131072&&(L.$$scope={dirty:y,ctx:p}),a.$set(L)},i(p){$||(h(t.$$.fragment,p),h(o.$$.fragment,p),h(a.$$.fragment,p),$=!0)},o(p){_(t.$$.fragment,p),_(o.$$.fragment,p),_(a.$$.fragment,p),$=!1},d(p){p&&(g(e),g(u),g(l)),v(t),v(o),v(a)}}}function yn(s){let e,n,t;return n=new fe({props:{$$slots:{default:[bn]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&131072&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function _t(s){let e,n;return e=new tt({props:{colorScale:s[4],limits:s[7]()}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:ae,i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ln(s){let e;return{c(){e=b("Average cars per household")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Cn(s){let e;return{c(){e=b(`NOMIS TS045
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Sn(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Tn(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Dn(s){let e,n,t,r,o,i,u,l,c,a,f,$,p,y;return o=new z({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Cn]},$$scope:{ctx:s}}}),u=new z({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Sn]},$$scope:{ctx:s}}}),$=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Tn]},$$scope:{ctx:s}}}),{c(){e=A("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,n=U(),t=A("p"),r=b("Car/van availability data is from the 2021 census, via "),d(o.$$.fragment),i=b(". Output area boundaries from "),d(u.$$.fragment),l=b("."),c=U(),a=A("p"),f=b("License: "),d($.$$.fragment),p=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(k,C){m(k,e,C),m(k,n,C),m(k,t,C),S(t,r),w(o,t,null),S(t,i),w(u,t,null),S(t,l),m(k,c,C),m(k,a,C),S(a,f),w($,a,null),S(a,p),y=!0},p(k,C){const L={};C&131072&&(L.$$scope={dirty:C,ctx:k}),o.$set(L);const D={};C&131072&&(D.$$scope={dirty:C,ctx:k}),u.$set(D);const N={};C&131072&&(N.$$scope={dirty:C,ctx:k}),$.$set(N)},i(k){y||(h(o.$$.fragment,k),h(u.$$.fragment,k),h($.$$.fragment,k),y=!0)},o(k){_(o.$$.fragment,k),_(u.$$.fragment,k),_($.$$.fragment,k),y=!1},d(k){k&&(g(e),g(n),g(t),g(c),g(a)),v(o),v(u),v($)}}}function On(s){let e,n,t;return n=new fe({props:{$$slots:{default:[Dn]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&131072&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function dt(s){let e,n;return e=new tt({props:{colorScale:s[4],limits:s[7]()}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:ae,i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Un(s){let e;return{c(){e=b("Population density")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Mn(s){let e;return{c(){e=b(`NOMIS TS006
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Nn(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function An(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Bn(s){let e,n,t,r,o,i,u,l,c,a,f,$;return t=new z({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Mn]},$$scope:{ctx:s}}}),o=new z({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Nn]},$$scope:{ctx:s}}}),a=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[An]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("Population density data is from the 2021 census, via "),d(t.$$.fragment),r=b(". Output area boundaries from "),d(o.$$.fragment),i=b("."),u=U(),l=A("p"),c=b("License: "),d(a.$$.fragment),f=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(p,y){m(p,e,y),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m(p,u,y),m(p,l,y),S(l,c),w(a,l,null),S(l,f),$=!0},p(p,y){const k={};y&131072&&(k.$$scope={dirty:y,ctx:p}),t.$set(k);const C={};y&131072&&(C.$$scope={dirty:y,ctx:p}),o.$set(C);const L={};y&131072&&(L.$$scope={dirty:y,ctx:p}),a.$set(L)},i(p){$||(h(t.$$.fragment,p),h(o.$$.fragment,p),h(a.$$.fragment,p),$=!0)},o(p){_(t.$$.fragment,p),_(o.$$.fragment,p),_(a.$$.fragment,p),$=!1},d(p){p&&(g(e),g(u),g(l)),v(t),v(o),v(a)}}}function En(s){let e,n,t;return n=new fe({props:{$$slots:{default:[Bn]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&131072&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function wt(s){let e,n,t,r;return t=new tt({props:{colorScale:s[4],limits:s[7]()}}),{c(){e=A("p"),e.textContent="(people per square kilometres)",n=U(),d(t.$$.fragment)},m(o,i){m(o,e,i),m(o,n,i),w(t,o,i),r=!0},p:ae,i(o){r||(h(t.$$.fragment,o),r=!0)},o(o){_(t.$$.fragment,o),r=!1},d(o){o&&(g(e),g(n)),v(t,o)}}}function Pn(s){let e,n,t,r,o,i,u,l,c,a,f,$,p,y;function k(T){s[9](T)}let C={id:"percent_households_with_car",$$slots:{right:[yn],default:[dn]},$$scope:{ctx:s}};s[0]!==void 0&&(C.checked=s[0]),e=new ie({props:C}),V.push(()=>Z(e,"checked",k)),e.$on("change",s[10]);let L=s[3]=="percent_households_with_car"&&_t(s);function D(T){s[11](T)}let N={id:"average_cars_per_household",$$slots:{right:[On],default:[Ln]},$$scope:{ctx:s}};s[1]!==void 0&&(N.checked=s[1]),o=new ie({props:N}),V.push(()=>Z(o,"checked",D)),o.$on("change",s[12]);let O=s[3]=="average_cars_per_household"&&dt(s);function M(T){s[13](T)}let B={id:"population_density",$$slots:{right:[En],default:[Un]},$$scope:{ctx:s}};s[2]!==void 0&&(B.checked=s[2]),c=new ie({props:B}),V.push(()=>Z(c,"checked",M)),c.$on("change",s[14]);let E=s[3]=="population_density"&&wt(s);return p=new ne({props:{layer:se,tooltip:s[5],show:s[3]!="",clickable:!0}}),p.$on("click",s[6]),{c(){d(e.$$.fragment),t=U(),L&&L.c(),r=U(),d(o.$$.fragment),u=U(),O&&O.c(),l=U(),d(c.$$.fragment),f=U(),E&&E.c(),$=U(),d(p.$$.fragment)},m(T,P){w(e,T,P),m(T,t,P),L&&L.m(T,P),m(T,r,P),w(o,T,P),m(T,u,P),O&&O.m(T,P),m(T,l,P),w(c,T,P),m(T,f,P),E&&E.m(T,P),m(T,$,P),w(p,T,P),y=!0},p(T,[P]){const I={};P&131072&&(I.$$scope={dirty:P,ctx:T}),!n&&P&1&&(n=!0,I.checked=T[0],q(()=>n=!1)),e.$set(I),T[3]=="percent_households_with_car"?L?(L.p(T,P),P&8&&h(L,1)):(L=_t(T),L.c(),h(L,1),L.m(r.parentNode,r)):L&&(me(),_(L,1,1,()=>{L=null}),ge());const ve={};P&131072&&(ve.$$scope={dirty:P,ctx:T}),!i&&P&2&&(i=!0,ve.checked=T[1],q(()=>i=!1)),o.$set(ve),T[3]=="average_cars_per_household"?O?(O.p(T,P),P&8&&h(O,1)):(O=dt(T),O.c(),h(O,1),O.m(l.parentNode,l)):O&&(me(),_(O,1,1,()=>{O=null}),ge());const Ue={};P&131072&&(Ue.$$scope={dirty:P,ctx:T}),!a&&P&4&&(a=!0,Ue.checked=T[2],q(()=>a=!1)),c.$set(Ue),T[3]=="population_density"?E?(E.p(T,P),P&8&&h(E,1)):(E=wt(T),E.c(),h(E,1),E.m($.parentNode,$)):E&&(me(),_(E,1,1,()=>{E=null}),ge());const xe={};P&8&&(xe.show=T[3]!=""),p.$set(xe)},i(T){y||(h(e.$$.fragment,T),h(L),h(o.$$.fragment,T),h(O),h(c.$$.fragment,T),h(E),h(p.$$.fragment,T),y=!0)},o(T){_(e.$$.fragment,T),_(L),_(o.$$.fragment,T),_(O),_(c.$$.fragment,T),_(E),_(p.$$.fragment,T),y=!1},d(T){T&&(g(t),g(r),g(u),g(l),g(f),g($)),v(e,T),L&&L.d(T),v(o,T),O&&O.d(T),v(c,T),E&&E.d(T),v(p,T)}}}let se="census_output_areas";function xn(s,e,n){let t;W(s,re,O=>n(8,t=O));let r=`${se}-outline`,o=K.sequential_low_to_high,i=!1,u=!1,l=!1,c="";Ee(t,se,`https://atip.uk/layers/v1/${se}.pmtiles`),De(t,{id:se,source:se,sourceLayer:se,color:"black",opacity:he(.5,.7)}),Oe(t,{id:r,source:se,sourceLayer:se,color:"black",width:.5});function a(O){let M=O.properties.OA21CD,B=O.properties[c];return c=="percent_households_with_car"?`<p>${B}% of households in ${M} have 1 or more cars</p>`:c=="average_cars_per_household"?`<p>Households in ${M} have an average of ${B} cars</p>`:`<p>There are ${B.toLocaleString()} people per square kilometre in ${M}</p>`}function f(O){let M=O.detail.properties.OA21CD;c=="percent_households_with_car"||c=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${M}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${M}`,"_blank")}function $(){return c=="percent_households_with_car"?[0,20,40,60,80,100]:c=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function p(){let O=$(),M=["step",["get",c]];for(let B=1;B<O.length;B++)M.push(o[B-1]),M.push(O[B]);return M.push(o[o.length-1]),M}function y(O){i=O,n(0,i)}const k=()=>{n(1,u=!1),n(2,l=!1)};function C(O){u=O,n(1,u)}const L=()=>{n(0,i=!1),n(2,l=!1)};function D(O){l=O,n(2,l)}const N=()=>{n(0,i=!1),n(1,u=!1)};return s.$$.update=()=>{s.$$.dirty&271&&(i?n(3,c="percent_households_with_car"):u?n(3,c="average_cars_per_household"):l?n(3,c="population_density"):n(3,c=""),c?(t.setPaintProperty(se,"fill-color",p()),t.setLayoutProperty(r,"visibility","visible")):t.setLayoutProperty(r,"visibility","none"))},[i,u,l,c,o,a,f,$,t,y,k,C,L,D,N]}class zn extends j{constructor(e){super(),F(this,e,xn,Pn,G,{})}}function In(s){let e,n,t;return e=new we({props:{color:s[1]}}),{c(){d(e.$$.fragment),n=b(`
  Combined authorities`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ae,i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&g(n),v(e,r)}}}function jn(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Fn(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Gn(s){let e,n,t,r,o,i,u,l,c,a;return t=new z({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[jn]},$$scope:{ctx:s}}}),l=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Fn]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("Data from "),d(t.$$.fragment),r=b(", as of December 2022."),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment),c=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,u),w(l,i,null),S(i,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:f}),l.$set(y)},i(f){a||(h(t.$$.fragment,f),h(l.$$.fragment,f),a=!0)},o(f){_(t.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(g(e),g(o),g(i)),v(t),v(l)}}}function Hn(s){let e,n,t;return n=new fe({props:{$$slots:{default:[Gn]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function Rn(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:$e,$$slots:{right:[Hn],default:[In]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new ie({props:u}),V.push(()=>Z(e,"checked",i)),r=new ne({props:{layer:$e,tooltip:Vn,show:s[0],clickable:!0}}),r.$on("click",Zn),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}let $e="combined_authorities";function Vn(s){return`<p>${s.properties.name}</p>`}function Zn(s){window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.CAUTH22CD}`,"_blank")}function qn(s,e,n){let t;W(s,re,l=>n(2,t=l));let r=K.combined_authorities,o=`${$e}-outline`;Ot(t,$e,`https://atip.uk/layers/v1/${$e}.geojson`),De(t,{id:$e,source:$e,color:r,opacity:he(.5,.1)}),Oe(t,{id:o,source:$e,color:r,width:2.5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Kn extends j{constructor(e){super(),F(this,e,qn,Rn,G,{})}}function Wn(s){let e=new Map;for(let[t,r]of Object.entries(s.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:r.authority_or_region,capital_scheme_id:r.capital_scheme_id,funding_programme:r.funding_programme});let n=1;for(let t of s.features){let r=e.get(t.properties.scheme_reference);r.num_features++,t.properties.funding_programme=r.funding_programme,t.id=n++}return e}function Jn(s){let e,n,t,r,o;function i(l){s[3](l)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return s[0]!==void 0&&(u.value=s[0]),e=new We({props:u}),V.push(()=>Z(e,"value",i)),e.$on("change",s[2]),r=new cn({props:{rows:s[1]}}),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};!n&&c&1&&(n=!0,a.value=l[0],q(()=>n=!1)),e.$set(a);const f={};c&2&&(f.rows=l[1]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}function Xn(s,e,n){let t;W(s,re,l=>n(4,t=l));let r="interventionType",o=$t("v1");function i(){let l;r=="interventionType"?(l=Pt("v1"),n(1,o=$t("v1"))):(l=Qt(["get","funding_programme"],{ATF2:K.atf2,ATF3:K.atf3,ATF4:K.atf4},"grey"),n(1,o=[["ATF2",K.atf2],["ATF3",K.atf3],["ATF4",K.atf4]])),t.setPaintProperty("interventions-points","circle-color",l),t.setPaintProperty("interventions-lines","line-color",l),t.setPaintProperty("interventions-polygons","fill-color",l),t.setPaintProperty("interventions-polygon-outlines","line-color",l)}function u(l){r=l,n(0,r)}return[r,o,i,u]}class Yn extends j{constructor(e){super(),F(this,e,Xn,Jn,G,{})}}function Qn(s){let e;return{c(){e=b("Clear")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function er(s){let e,n,t,r,o,i;return t=new Ie({props:{$$slots:{default:[Qn]},$$scope:{ctx:s}}}),t.$on("click",s[11]),{c(){e=A("input"),n=U(),d(t.$$.fragment),H(e,"type","text"),H(e,"class","govuk-input govuk-input--width-10"),H(e,"id","filterText")},m(u,l){m(u,e,l),ct(e,s[0]),m(u,n,l),w(t,u,l),r=!0,o||(i=tn(e,"input",s[10]),o=!0)},p(u,l){l&1&&e.value!==u[0]&&ct(e,u[0]);const c={};l&16384&&(c.$$scope={dirty:l,ctx:u}),t.$set(c)},i(u){r||(h(t.$$.fragment,u),r=!0)},o(u){_(t.$$.fragment,u),r=!1},d(u){u&&(g(e),g(n)),v(t,u),o=!1,i()}}}function tr(s){let e,n,t,r,o,i,u,l,c,a;function f(k){s[8](k)}let $={label:"Authority or region",id:"filterAuthority",choices:s[4],emptyOption:!0};s[2]!==void 0&&($.value=s[2]),e=new We({props:$}),V.push(()=>Z(e,"value",f));function p(k){s[9](k)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:s[5],emptyOption:!0};return s[3]!==void 0&&(y.value=s[3]),r=new We({props:y}),V.push(()=>Z(r,"value",p)),u=new en({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[er]},$$scope:{ctx:s}}}),c=new Yn({}),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment),i=U(),d(u.$$.fragment),l=U(),d(c.$$.fragment)},m(k,C){w(e,k,C),m(k,t,C),w(r,k,C),m(k,i,C),w(u,k,C),m(k,l,C),w(c,k,C),a=!0},p(k,C){const L={};C&16&&(L.choices=k[4]),!n&&C&4&&(n=!0,L.value=k[2],q(()=>n=!1)),e.$set(L);const D={};C&32&&(D.choices=k[5]),!o&&C&8&&(o=!0,D.value=k[3],q(()=>o=!1)),r.$set(D);const N={};C&16385&&(N.$$scope={dirty:C,ctx:k}),u.$set(N)},i(k){a||(h(e.$$.fragment,k),h(r.$$.fragment,k),h(u.$$.fragment,k),h(c.$$.fragment,k),a=!0)},o(k){_(e.$$.fragment,k),_(r.$$.fragment,k),_(u.$$.fragment,k),_(c.$$.fragment,k),a=!1},d(k){k&&(g(t),g(i),g(l)),v(e,k),v(r,k),v(u,k),v(c,k)}}}function nr(s){let e,n,t,r,o=s[1].size+"",i,u,l=s[6].route+"",c,a,f=s[6].area+"",$,p,y=s[6].crossing+"",k,C,L=s[6].other+"",D,N,O;return e=new de({props:{label:"Filters",$$slots:{default:[tr]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment),n=U(),t=A("p"),r=b("Showing "),i=b(o),u=b(" schemes ("),c=b(l),a=b(" routes, "),$=b(f),p=b(` areas,
  `),k=b(y),C=b(" crossings, "),D=b(L),N=b(" other)")},m(M,B){w(e,M,B),m(M,n,B),m(M,t,B),S(t,r),S(t,i),S(t,u),S(t,c),S(t,a),S(t,$),S(t,p),S(t,k),S(t,C),S(t,D),S(t,N),O=!0},p(M,[B]){const E={};B&16445&&(E.$$scope={dirty:B,ctx:M}),e.$set(E),(!O||B&2)&&o!==(o=M[1].size+"")&&te(i,o),(!O||B&64)&&l!==(l=M[6].route+"")&&te(c,l),(!O||B&64)&&f!==(f=M[6].area+"")&&te($,f),(!O||B&64)&&y!==(y=M[6].crossing+"")&&te(k,y),(!O||B&64)&&L!==(L=M[6].other+"")&&te(D,L)},i(M){O||(h(e.$$.fragment,M),O=!0)},o(M){_(e.$$.fragment,M),O=!1},d(M){M&&(g(n),g(t)),v(e,M)}}}function rr(s,e,n){let t;W(s,Te,L=>n(12,t=L));let{schemes:r}=e,{schemesToBeShown:o=new Set}=e,{filterText:i=""}=e,u=[],l="",c=[],a="",f={area:0,route:0,crossing:0,other:0};Qe(()=>{let L=new Set,D=new Set;for(let N of r.values())N.authority_or_region&&L.add(N.authority_or_region),N.funding_programme&&D.add(N.funding_programme);n(4,u=Array.from(L.entries())),u.sort(),n(5,c=Array.from(D.entries())),c.sort()});function $(L,D,N){let O=L.toLowerCase(),M=E=>{var T,P;if(O&&!((T=E.properties.name)!=null&&T.toLowerCase().includes(O))&&!((P=E.properties.description)!=null&&P.toLowerCase().includes(O)))return!1;if(D||N){let I=r.get(E.properties.scheme_reference);if(D&&I.authority_or_region!=D||N&&I.funding_programme!=N)return!1}return!0};n(1,o=new Set(t.features.filter(M).map(E=>E.properties.scheme_reference))),n(6,f={area:0,route:0,crossing:0,other:0});let B=E=>{var T,P;return!(!o.has(E.properties.scheme_reference)||O&&!((T=E.properties.name)!=null&&T.toLowerCase().includes(O))&&!((P=E.properties.description)!=null&&P.toLowerCase().includes(O)))};Te.update(E=>{for(let T of E.features)B(T)?(delete T.properties.hide_while_editing,n(6,f[T.properties.intervention_type]++,f)):T.properties.hide_while_editing=!0;return E}),n(6,f)}function p(L){l=L,n(2,l)}function y(L){a=L,n(3,a)}function k(){i=this.value,n(0,i)}const C=()=>n(0,i="");return s.$$set=L=>{"schemes"in L&&n(7,r=L.schemes),"schemesToBeShown"in L&&n(1,o=L.schemesToBeShown),"filterText"in L&&n(0,i=L.filterText)},s.$$.update=()=>{s.$$.dirty&13&&$(i,l,a)},[i,o,l,a,u,c,f,r,p,y,k,C]}class sr extends j{constructor(e){super(),F(this,e,rr,nr,G,{schemes:7,schemesToBeShown:1,filterText:0})}}function or(s){let e,n,t,r;return e=new we({props:{color:s[3]}}),{c(){d(e.$$.fragment),n=U(),t=b(s[1])},m(o,i){w(e,o,i),m(o,n,i),m(o,t,i),r=!0},p(o,i){(!r||i&2)&&te(t,o[1])},i(o){r||(h(e.$$.fragment,o),r=!0)},o(o){_(e.$$.fragment,o),r=!1},d(o){o&&(g(n),g(t)),v(e,o)}}}function lr(s){let e;const n=s[6].default,t=Ut(n,s,s[8],null);return{c(){t&&t.c()},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&256)&&Mt(t,n,r,r[8],e?At(n,r[8],o,null):Nt(r[8]),null)},i(r){e||(h(t,r),e=!0)},o(r){_(t,r),e=!1},d(r){t&&t.d(r)}}}function ir(s){let e,n,t;return n=new fe({props:{$$slots:{default:[lr]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&256&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function ar(s){let e,n,t,r,o;function i(l){s[7](l)}let u={id:s[0],$$slots:{right:[ir],default:[or]},$$scope:{ctx:s}};return s[2]!==void 0&&(u.checked=s[2]),e=new ie({props:u}),V.push(()=>Z(e,"checked",i)),r=new ne({props:{layer:s[0],tooltip:s[4],show:s[2],clickable:!1}}),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&1&&(a.id=l[0]),c&258&&(a.$$scope={dirty:c,ctx:l}),!n&&c&4&&(n=!0,a.checked=l[2],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.layer=l[0]),c&4&&(f.show=l[2]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}function fr(s,e,n){let t;W(s,re,p=>n(9,t=p));let{$$slots:r={},$$scope:o}=e,{name:i}=e,{singularNoun:u}=e,{pluralNoun:l}=e,c=K[i];Ee(t,i,`https://atip.uk/layers/v1/${i}.pmtiles`),De(t,{id:i,source:i,sourceLayer:i,color:c,opacity:he(1,.7)});let a=!1;function f(p){return`<p>${p.properties.name??`Unnamed ${u}`}</p>`}function $(p){a=p,n(2,a)}return s.$$set=p=>{"name"in p&&n(0,i=p.name),"singularNoun"in p&&n(5,u=p.singularNoun),"pluralNoun"in p&&n(1,l=p.pluralNoun),"$$scope"in p&&n(8,o=p.$$scope)},[i,l,a,c,f,u,r,$,o]}class Fe extends j{constructor(e){super(),F(this,e,fr,ar,G,{name:0,singularNoun:5,pluralNoun:1})}}function cr(s){let e;return{c(){e=b(`park
    `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function ur(s){let e;return{c(){e=b(`nature reserve
    `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function $r(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function pr(s){let e,n,t,r,o,i,u,l,c,a,f;return t=new z({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospitalhttps://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpark",$$slots:{default:[cr]},$$scope:{ctx:s}}}),o=new z({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dnature_reserve",$$slots:{default:[ur]},$$scope:{ctx:s}}}),a=new z({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[$r]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("This shows "),d(t.$$.fragment),r=b(", "),d(o.$$.fragment),i=b(`, national park, and areas of outstandaing natural beauty
    data from OpenStreetMap.`),u=U(),l=A("p"),c=b("License: "),d(a.$$.fragment)},m($,p){m($,e,p),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m($,u,p),m($,l,p),S(l,c),w(a,l,null),f=!0},p($,p){const y={};p&1&&(y.$$scope={dirty:p,ctx:$}),t.$set(y);const k={};p&1&&(k.$$scope={dirty:p,ctx:$}),o.$set(k);const C={};p&1&&(C.$$scope={dirty:p,ctx:$}),a.$set(C)},i($){f||(h(t.$$.fragment,$),h(o.$$.fragment,$),h(a.$$.fragment,$),f=!0)},o($){_(t.$$.fragment,$),_(o.$$.fragment,$),_(a.$$.fragment,$),f=!1},d($){$&&(g(e),g(u),g(l)),v(t),v(o),v(a)}}}function mr(s){let e,n;return e=new Fe({props:{name:"green_spaces",singularNoun:"green space",pluralNoun:"Green spaces",$$slots:{default:[pr]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class gr extends j{constructor(e){super(),F(this,e,null,mr,G,{})}}function hr(s){let e;return{c(){e=b("hospital")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function _r(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function dr(s){let e,n,t,r,o,i,u,l,c;return t=new z({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[hr]},$$scope:{ctx:s}}}),l=new z({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[_r]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("This shows "),d(t.$$.fragment),r=b(` data from OpenStreetMap. It doesn't include outpatient clinics
    or individual doctor's offices.`),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(h(t.$$.fragment,a),h(l.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(l.$$.fragment,a),c=!1},d(a){a&&(g(e),g(o),g(i)),v(t),v(l)}}}function wr(s){let e,n;return e=new Fe({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[dr]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class vr extends j{constructor(e){super(),F(this,e,null,wr,G,{})}}function kr(s){let e,n,t;return e=new we({props:{color:s[1]}}),{c(){d(e.$$.fragment),n=b(`
  Local Authority Districts`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ae,i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&g(n),v(e,r)}}}function br(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function yr(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Lr(s){let e,n,t,r,o,i,u,l,c,a;return t=new z({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[br]},$$scope:{ctx:s}}}),l=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[yr]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("Data from "),d(t.$$.fragment),r=b(", as of May 2023."),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment),c=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,u),w(l,i,null),S(i,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:f}),l.$set(y)},i(f){a||(h(t.$$.fragment,f),h(l.$$.fragment,f),a=!0)},o(f){_(t.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(g(e),g(o),g(i)),v(t),v(l)}}}function Cr(s){let e,n,t;return n=new fe({props:{$$slots:{default:[Lr]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function Sr(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:pe,$$slots:{right:[Cr],default:[kr]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new ie({props:u}),V.push(()=>Z(e,"checked",i)),r=new ne({props:{layer:pe,tooltip:Tr,show:s[0],clickable:!0}}),r.$on("click",Dr),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}let pe="local_authority_districts";function Tr(s){return`<p>${s.properties.name}</p>`}function Dr(s){window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.LAD23CD}`,"_blank")}function Or(s,e,n){let t;W(s,re,l=>n(2,t=l));let r=K.local_authority_districts,o=`${pe}-outline`;Ot(t,pe,`https://atip.uk/layers/v1/${pe}.geojson`),De(t,{id:pe,source:pe,color:r,opacity:he(.5,.1)}),Oe(t,{id:o,source:pe,color:r,width:2.5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Ur extends j{constructor(e){super(),F(this,e,Or,Sr,G,{})}}function Mr(s){let e,n,t;return e=new we({props:{color:s[1]}}),{c(){d(e.$$.fragment),n=b(`
  Major Road Network`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ae,i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&g(n),v(e,r)}}}function Nr(s){let e;return{c(){e=b(`Major Road Network
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Ar(s){let e;return{c(){e=b("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Br(s){let e,n,t,r,o,i,u,l,c;return t=new z({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Nr]},$$scope:{ctx:s}}}),l=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ar]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("Data from the "),d(t.$$.fragment),r=b("."),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&16&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&16&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(h(t.$$.fragment,a),h(l.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(l.$$.fragment,a),c=!1},d(a){a&&(g(e),g(o),g(i)),v(t),v(l)}}}function Er(s){let e,n,t;return n=new fe({props:{$$slots:{default:[Br]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&16&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function Pr(s){let e,n,t,r,o;function i(l){s[2](l)}let u={id:_e,$$slots:{right:[Er],default:[Mr]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new ie({props:u}),V.push(()=>Z(e,"checked",i)),r=new ne({props:{layer:_e,tooltip:xr,show:s[0],clickable:!1}}),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&16&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}let _e="mrn";function xr(s){return`<p>${s.properties.name??"Unknown MRN road"}</p>`}function zr(s,e,n){let t;W(s,re,u=>n(3,t=u));let r=K.mrn;Ee(t,_e,`https://atip.uk/layers/v1/${_e}.pmtiles`),Oe(t,{id:_e,source:_e,sourceLayer:_e,color:r,width:7,opacity:he(.5,1)});let o=!1;function i(u){o=u,n(0,o)}return[o,r,i]}class Ir extends j{constructor(e){super(),F(this,e,zr,Pr,G,{})}}function jr(s){let e,n,t;return e=new we({props:{color:s[1]}}),{c(){d(e.$$.fragment),n=b(`
  Parliamentary constituencies`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ae,i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&g(n),v(e,r)}}}function Fr(s){let e;return{c(){e=b(`Ordnance Survey Boundary-Line
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Gr(s){let e;return{c(){e=b("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Hr(s){let e,n,t,r,o,i,u,l,c;return t=new z({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Fr]},$$scope:{ctx:s}}}),l=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Gr]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("Data from "),d(t.$$.fragment),r=b("."),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&32&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&32&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(h(t.$$.fragment,a),h(l.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(l.$$.fragment,a),c=!1},d(a){a&&(g(e),g(o),g(i)),v(t),v(l)}}}function Rr(s){let e,n,t;return n=new fe({props:{$$slots:{default:[Hr]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function Vr(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:oe,$$slots:{right:[Rr],default:[jr]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new ie({props:u}),V.push(()=>Z(e,"checked",i)),r=new ne({props:{layer:oe,tooltip:Zr,show:s[0],clickable:!0}}),r.$on("click",qr),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}let oe="parliamentary_constituencies";function Zr(s){return`<p>${s.properties.Name}</p>`}function qr(s){let e=s.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function Kr(s,e,n){let t;W(s,re,l=>n(2,t=l));let r=K.parliamentary_constituencies,o=`${oe}-outline`;Ee(t,oe,`https://atip.uk/layers/v1/${oe}.pmtiles`),De(t,{id:oe,source:oe,sourceLayer:oe,color:r,opacity:he(.5,.1)}),Oe(t,{id:o,source:oe,sourceLayer:oe,color:r,width:5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Wr extends j{constructor(e){super(),F(this,e,Kr,Vr,G,{})}}function Jr(s){let e;return{c(){e=b("Show on map")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Xr(s){let e;return{c(){e=b("Edit scheme locally")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Yr(s){let e,n,t=s[0].authority_or_region+"",r,o,i,u,l=s[0].capital_scheme_id+"",c,a,f,$,p=s[0].funding_programme+"",y,k,C,L,D,N,O;return L=new Ie({props:{$$slots:{default:[Jr]},$$scope:{ctx:s}}}),L.$on("click",s[3]),N=new Ie({props:{disabled:s[1],title:s[2],$$slots:{default:[Xr]},$$scope:{ctx:s}}}),N.$on("click",s[4]),{c(){e=A("p"),n=b("Authority or region: "),r=b(t),o=U(),i=A("p"),u=b("Capital scheme ID: "),c=b(l),a=U(),f=A("p"),$=b("Funding programme: "),y=b(p),k=U(),C=A("div"),d(L.$$.fragment),D=U(),d(N.$$.fragment),H(C,"class","govuk-button-group")},m(M,B){m(M,e,B),S(e,n),S(e,r),m(M,o,B),m(M,i,B),S(i,u),S(i,c),m(M,a,B),m(M,f,B),S(f,$),S(f,y),m(M,k,B),m(M,C,B),w(L,C,null),S(C,D),w(N,C,null),O=!0},p(M,B){(!O||B&1)&&t!==(t=M[0].authority_or_region+"")&&te(r,t),(!O||B&1)&&l!==(l=M[0].capital_scheme_id+"")&&te(c,l),(!O||B&1)&&p!==(p=M[0].funding_programme+"")&&te(y,p);const E={};B&256&&(E.$$scope={dirty:B,ctx:M}),L.$set(E);const T={};B&256&&(T.$$scope={dirty:B,ctx:M}),N.$set(T)},i(M){O||(h(L.$$.fragment,M),h(N.$$.fragment,M),O=!0)},o(M){_(L.$$.fragment,M),_(N.$$.fragment,M),O=!1},d(M){M&&(g(e),g(o),g(i),g(a),g(f),g(k),g(C)),v(L),v(N)}}}function Qr(s){let e,n;return e=new de({props:{label:`${s[0].scheme_reference}: ${s[0].num_features} features`,$$slots:{default:[Yr]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),r&257&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function es(s,e,n){let t,r;W(s,Te,f=>n(6,t=f)),W(s,re,f=>n(7,r=f));let{scheme:o}=e,{authorityNames:i}=e,u=!i.has(o.authority_or_region),l=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function c(){let f={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==o.scheme_reference)};r==null||r.fitBounds(Bt(f),{padding:20,animate:!1})}function a(){let f={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==o.scheme_reference)},$=o.authority_or_region;window.localStorage.setItem($,JSON.stringify(f)),window.open(`scheme.html?authority=${o.authority_or_region}`,"_blank")}return s.$$set=f=>{"scheme"in f&&n(0,o=f.scheme),"authorityNames"in f&&n(5,i=f.authorityNames)},[o,u,l,c,a,i]}class ts extends j{constructor(e){super(),F(this,e,es,Qr,G,{scheme:0,authorityNames:5})}}function ns(s){let e,n,t,r;return e=new we({props:{color:s[3]}}),{c(){d(e.$$.fragment),n=U(),t=b(s[1])},m(o,i){w(e,o,i),m(o,n,i),m(o,t,i),r=!0},p(o,i){(!r||i&2)&&te(t,o[1])},i(o){r||(h(e.$$.fragment,o),r=!0)},o(o){_(e.$$.fragment,o),r=!1},d(o){o&&(g(n),g(t)),v(e,o)}}}function rs(s){let e;const n=s[6].default,t=Ut(n,s,s[8],null);return{c(){t&&t.c()},m(r,o){t&&t.m(r,o),e=!0},p(r,o){t&&t.p&&(!e||o&256)&&Mt(t,n,r,r[8],e?At(n,r[8],o,null):Nt(r[8]),null)},i(r){e||(h(t,r),e=!0)},o(r){_(t,r),e=!1},d(r){t&&t.d(r)}}}function ss(s){let e,n,t;return n=new fe({props:{$$slots:{default:[rs]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&256&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function os(s){let e,n,t,r,o;function i(l){s[7](l)}let u={id:s[0],$$slots:{right:[ss],default:[ns]},$$scope:{ctx:s}};return s[2]!==void 0&&(u.checked=s[2]),e=new ie({props:u}),V.push(()=>Z(e,"checked",i)),r=new ne({props:{layer:s[0],tooltip:s[4],show:s[2],clickable:!1}}),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&1&&(a.id=l[0]),c&258&&(a.$$scope={dirty:c,ctx:l}),!n&&c&4&&(n=!0,a.checked=l[2],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.layer=l[0]),c&4&&(f.show=l[2]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}function ls(s,e,n){let{$$slots:t={},$$scope:r}=e,{name:o}=e,{singularNoun:i}=e,{pluralNoun:u}=e,l=K[o],c=!1;function a($){return`<p>${$.properties.name??`Unnamed ${i}`}</p>`}function f($){c=$,n(2,c)}return s.$$set=$=>{"name"in $&&n(0,o=$.name),"singularNoun"in $&&n(5,i=$.singularNoun),"pluralNoun"in $&&n(1,u=$.pluralNoun),"$$scope"in $&&n(8,r=$.$$scope)},[o,u,c,l,a,i,t,f,r]}class is extends j{constructor(e){super(),F(this,e,ls,os,G,{name:0,singularNoun:5,pluralNoun:1})}}const as="/atip/more-trip-generators/assets/railway_stations-4c8eac3e.geojson";async function fs(){return await(await fetch(as)).json()}function cs(s){let e;return{c(){e=b("railway station")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function us(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function $s(s){let e,n,t,r,o,i,u,l,c;return t=new z({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[cs]},$$scope:{ctx:s}}}),l=new z({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[us]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("This shows "),d(t.$$.fragment),r=b(" data from OpenStreetMap."),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&4&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&4&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(h(t.$$.fragment,a),h(l.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(l.$$.fragment,a),c=!1},d(a){a&&(g(e),g(o),g(i)),v(t),v(l)}}}function ps(s){let e,n;return e=new is({props:{name:Je,singularNoun:"railway station",pluralNoun:"Railway stations",$$slots:{default:[$s]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&4&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}const Je="railwayStations";function ms(s,e,n){let t;W(s,re,o=>n(0,t=o));const r=o=>{let i=Je,u=Je;t.addSource(i,{type:"geojson",data:o,generateId:!0}),t.addLayer({id:u,source:i,type:"fill",paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":he(.8,.4)}})};return fs().then(r),[]}class gs extends j{constructor(e){super(),F(this,e,ms,ps,G,{})}}function hs(s){let e;return{c(){e=b("primary and secondary schools")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function _s(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function ds(s){let e,n,t,r,o,i,u,l,c;return t=new z({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[hs]},$$scope:{ctx:s}}}),l=new z({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[_s]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("This shows "),d(t.$$.fragment),r=b(` from OpenStreetMap. It doesn't include kindergartens, colleges,
    universities, or other training schools.`),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment)},m(a,f){m(a,e,f),S(e,n),w(t,e,null),S(e,r),m(a,o,f),m(a,i,f),S(i,u),w(l,i,null),c=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),l.$set(p)},i(a){c||(h(t.$$.fragment,a),h(l.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(l.$$.fragment,a),c=!1},d(a){a&&(g(e),g(o),g(i)),v(t),v(l)}}}function ws(s){let e,n;return e=new Fe({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[ds]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class vs extends j{constructor(e){super(),F(this,e,null,ws,G,{})}}function ks(s){let e;return{c(){e=b(`sports pitches
    `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function bs(s){let e;return{c(){e=b("sports centres")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function ys(s){let e;return{c(){e=b("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Ls(s){let e,n,t,r,o,i,u,l,c,a,f;return t=new z({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[ks]},$$scope:{ctx:s}}}),o=new z({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[bs]},$$scope:{ctx:s}}}),a=new z({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ys]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("This shows "),d(t.$$.fragment),r=b(", and "),d(o.$$.fragment),i=b(" data from OpenStreetMap."),u=U(),l=A("p"),c=b("License: "),d(a.$$.fragment)},m($,p){m($,e,p),S(e,n),w(t,e,null),S(e,r),w(o,e,null),S(e,i),m($,u,p),m($,l,p),S(l,c),w(a,l,null),f=!0},p($,p){const y={};p&1&&(y.$$scope={dirty:p,ctx:$}),t.$set(y);const k={};p&1&&(k.$$scope={dirty:p,ctx:$}),o.$set(k);const C={};p&1&&(C.$$scope={dirty:p,ctx:$}),a.$set(C)},i($){f||(h(t.$$.fragment,$),h(o.$$.fragment,$),h(a.$$.fragment,$),f=!0)},o($){_(t.$$.fragment,$),_(o.$$.fragment,$),_(a.$$.fragment,$),f=!1},d($){$&&(g(e),g(u),g(l)),v(t),v(o),v(a)}}}function Cs(s){let e,n;return e=new Fe({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Ls]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&1&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class Ss extends j{constructor(e){super(),F(this,e,null,Cs,G,{})}}function Ts(s){let e,n,t;return e=new we({props:{color:s[1]}}),{c(){d(e.$$.fragment),n=b(`
  Wards`)},m(r,o){w(e,r,o),m(r,n,o),t=!0},p:ae,i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&g(n),v(e,r)}}}function Ds(s){let e;return{c(){e=b(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Os(s){let e;return{c(){e=b(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Us(s){let e,n,t,r,o,i,u,l,c,a;return t=new z({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[Ds]},$$scope:{ctx:s}}}),l=new z({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Os]},$$scope:{ctx:s}}}),{c(){e=A("p"),n=b("Data from "),d(t.$$.fragment),r=b(", as of May 2023."),o=U(),i=A("p"),u=b("License: "),d(l.$$.fragment),c=b(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),S(e,n),w(t,e,null),S(e,r),m(f,o,$),m(f,i,$),S(i,u),w(l,i,null),S(i,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const y={};$&32&&(y.$$scope={dirty:$,ctx:f}),l.$set(y)},i(f){a||(h(t.$$.fragment,f),h(l.$$.fragment,f),a=!0)},o(f){_(t.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(g(e),g(o),g(i)),v(t),v(l)}}}function Ms(s){let e,n,t;return n=new fe({props:{$$slots:{default:[Us]},$$scope:{ctx:s}}}),{c(){e=A("span"),d(n.$$.fragment),H(e,"slot","right")},m(r,o){m(r,e,o),w(n,e,null),t=!0},p(r,o){const i={};o&32&&(i.$$scope={dirty:o,ctx:r}),n.$set(i)},i(r){t||(h(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&g(e),v(n)}}}function Ns(s){let e,n,t,r,o;function i(l){s[3](l)}let u={id:le,$$slots:{right:[Ms],default:[Ts]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new ie({props:u}),V.push(()=>Z(e,"checked",i)),r=new ne({props:{layer:le,tooltip:As,show:s[0],clickable:!0}}),r.$on("click",Bs),{c(){d(e.$$.fragment),t=U(),d(r.$$.fragment)},m(l,c){w(e,l,c),m(l,t,c),w(r,l,c),o=!0},p(l,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:l}),!n&&c&1&&(n=!0,a.checked=l[0],q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=l[0]),r.$set(f)},i(l){o||(h(e.$$.fragment,l),h(r.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(r.$$.fragment,l),o=!1},d(l){l&&g(t),v(e,l),v(r,l)}}}let le="wards";function As(s){return`<p>${s.properties.name}</p>`}function Bs(s){let e=encodeURIComponent(s.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Es(s,e,n){let t;W(s,re,l=>n(2,t=l));let r=K.wards,o=`${le}-outline`;Ee(t,le,`https://atip.uk/layers/v1/${le}.pmtiles`),De(t,{id:le,source:le,sourceLayer:le,color:r,opacity:he(.5,.1)}),Oe(t,{id:o,source:le,sourceLayer:le,color:r,width:2.5});let i=!1;function u(l){i=l,n(0,i)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",i?"visible":"none")},[i,r,t,u]}class Ps extends j{constructor(e){super(),F(this,e,Es,Ns,G,{})}}var R=(s,e,n)=>new Promise((t,r)=>{var o=l=>{try{u(n.next(l))}catch(c){r(c)}},i=l=>{try{u(n.throw(l))}catch(c){r(c)}},u=l=>l.done?t(l.value):Promise.resolve(l.value).then(o,i);u((n=n.apply(s,e)).next())}),X=Uint8Array,Ce=Uint16Array,xs=Int32Array,xt=new X([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zt=new X([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zs=new X([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),It=function(s,e){for(var n=new Ce(31),t=0;t<31;++t)n[t]=e+=1<<s[t-1];for(var r=new xs(n[30]),t=1;t<30;++t)for(var o=n[t];o<n[t+1];++o)r[o]=o-n[t]<<5|t;return{b:n,r}},jt=It(xt,2),Ft=jt.b,Is=jt.r;Ft[28]=258,Is[258]=28;var js=It(zt,0),Fs=js.b,Xe=new Ce(32768);for(x=0;x<32768;++x)ce=(x&43690)>>1|(x&21845)<<1,ce=(ce&52428)>>2|(ce&13107)<<2,ce=(ce&61680)>>4|(ce&3855)<<4,Xe[x]=((ce&65280)>>8|(ce&255)<<8)>>1;var ce,x,Be=function(s,e,n){for(var t=s.length,r=0,o=new Ce(e);r<t;++r)s[r]&&++o[s[r]-1];var i=new Ce(e);for(r=1;r<e;++r)i[r]=i[r-1]+o[r-1]<<1;var u;if(n){u=new Ce(1<<e);var l=15-e;for(r=0;r<t;++r)if(s[r])for(var c=r<<4|s[r],a=e-s[r],f=i[s[r]-1]++<<a,$=f|(1<<a)-1;f<=$;++f)u[Xe[f]>>l]=c}else for(u=new Ce(t),r=0;r<t;++r)s[r]&&(u[r]=Xe[i[s[r]-1]++]>>15-s[r]);return u},Pe=new X(288);for(x=0;x<144;++x)Pe[x]=8;var x;for(x=144;x<256;++x)Pe[x]=9;var x;for(x=256;x<280;++x)Pe[x]=7;var x;for(x=280;x<288;++x)Pe[x]=8;var x,Gt=new X(32);for(x=0;x<32;++x)Gt[x]=5;var x,Gs=Be(Pe,9,1),Hs=Be(Gt,5,1),Ze=function(s){for(var e=s[0],n=1;n<s.length;++n)s[n]>e&&(e=s[n]);return e},Q=function(s,e,n){var t=e/8|0;return(s[t]|s[t+1]<<8)>>(e&7)&n},qe=function(s,e){var n=e/8|0;return(s[n]|s[n+1]<<8|s[n+2]<<16)>>(e&7)},Rs=function(s){return(s+7)/8|0},Vs=function(s,e,n){(e==null||e<0)&&(e=0),(n==null||n>s.length)&&(n=s.length);var t=new X(n-e);return t.set(s.subarray(e,n)),t},Zs=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],J=function(s,e,n){var t=new Error(e||Zs[s]);if(t.code=s,Error.captureStackTrace&&Error.captureStackTrace(t,J),!n)throw t;return t},nt=function(s,e,n,t){var r=s.length,o=t?t.length:0;if(!r||e.f&&!e.l)return n||new X(0);var i=!n||e.i!=2,u=e.i;n||(n=new X(r*3));var l=function(it){var at=n.length;if(it>at){var ft=new X(Math.max(at*2,it));ft.set(n),n=ft}},c=e.f||0,a=e.p||0,f=e.b||0,$=e.l,p=e.d,y=e.m,k=e.n,C=r*8;do{if(!$){c=Q(s,a,1);var L=Q(s,a+1,3);if(a+=3,L)if(L==1)$=Gs,p=Hs,y=9,k=5;else if(L==2){var M=Q(s,a,31)+257,B=Q(s,a+10,15)+4,E=M+Q(s,a+5,31)+1;a+=14;for(var T=new X(E),P=new X(19),I=0;I<B;++I)P[zs[I]]=Q(s,a+I*3,7);a+=B*3;for(var ve=Ze(P),Ue=(1<<ve)-1,xe=Be(P,ve,1),I=0;I<E;){var rt=xe[Q(s,a,Ue)];a+=rt&15;var D=rt>>4;if(D<16)T[I++]=D;else{var ke=0,ze=0;for(D==16?(ze=3+Q(s,a,3),a+=2,ke=T[I-1]):D==17?(ze=3+Q(s,a,7),a+=3):D==18&&(ze=11+Q(s,a,127),a+=7);ze--;)T[I++]=ke}}var st=T.subarray(0,M),Y=T.subarray(M);y=Ze(st),k=Ze(Y),$=Be(st,y,1),p=Be(Y,k,1)}else J(1);else{var D=Rs(a)+4,N=s[D-4]|s[D-3]<<8,O=D+N;if(O>r){u&&J(0);break}i&&l(f+N),n.set(s.subarray(D,O),f),e.b=f+=N,e.p=a=O*8,e.f=c;continue}if(a>C){u&&J(0);break}}i&&l(f+131072);for(var Jt=(1<<y)-1,Xt=(1<<k)-1,Ge=a;;Ge=a){var ke=$[qe(s,a)&Jt],be=ke>>4;if(a+=ke&15,a>C){u&&J(0);break}if(ke||J(2),be<256)n[f++]=be;else if(be==256){Ge=a,$=null;break}else{var ot=be-254;if(be>264){var I=be-257,Me=xt[I];ot=Q(s,a,(1<<Me)-1)+Ft[I],a+=Me}var He=p[qe(s,a)&Xt],Re=He>>4;He||J(3),a+=He&15;var Y=Fs[Re];if(Re>3){var Me=zt[Re];Y+=qe(s,a)&(1<<Me)-1,a+=Me}if(a>C){u&&J(0);break}i&&l(f+131072);var Ve=f+ot;if(f<Y){var lt=o-Y,Yt=Math.min(Y,Ve);for(lt+f<0&&J(3);f<Yt;++f)n[f]=t[lt+f]}for(;f<Ve;f+=4)n[f]=n[f-Y],n[f+1]=n[f+1-Y],n[f+2]=n[f+2-Y],n[f+3]=n[f+3-Y];f=Ve}}e.l=$,e.p=Ge,e.b=f,e.f=c,$&&(c=1,e.m=y,e.d=p,e.n=k)}while(!c);return f==n.length?n:Vs(n,0,f)},qs=new X(0),Ks=function(s){(s[0]!=31||s[1]!=139||s[2]!=8)&&J(6,"invalid gzip data");var e=s[3],n=10;e&4&&(n+=(s[10]|s[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!s[n++]);return n+(e&2)},Ws=function(s){var e=s.length;return(s[e-4]|s[e-3]<<8|s[e-2]<<16|s[e-1]<<24)>>>0},Js=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&J(6,"invalid zlib data"),(s[1]>>5&1)==+!e&&J(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function Xs(s,e){return nt(s,{i:2},e&&e.out,e&&e.dictionary)}function Ys(s,e){var n=Ks(s);return n+8>s.length&&J(6,"invalid gzip data"),nt(s.subarray(n,-8),{i:2},e&&e.out||new X(Ws(s)),e&&e.dictionary)}function Qs(s,e){return nt(s.subarray(Js(s,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Ye(s,e){return s[0]==31&&s[1]==139&&s[2]==8?Ys(s,e):(s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31?Xs(s,e):Qs(s,e)}var eo=typeof TextDecoder<"u"&&new TextDecoder,to=0;try{eo.decode(qs,{stream:!0}),to=1}catch{}var Ht=(s,e)=>s*Math.pow(2,e),Ne=(s,e)=>Math.floor(s/Math.pow(2,e)),je=(s,e)=>Ht(s.getUint16(e+1,!0),8)+s.getUint8(e),Rt=(s,e)=>Ht(s.getUint32(e+2,!0),16)+s.getUint16(e,!0),no=(s,e,n,t,r)=>{if(s!=t.getUint8(r))return s-t.getUint8(r);const o=je(t,r+1);if(e!=o)return e-o;const i=je(t,r+4);return n!=i?n-i:0},ro=(s,e,n,t)=>{const r=Vt(s,e|128,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!0}:null},vt=(s,e,n,t)=>{const r=Vt(s,e,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!1}:null},Vt=(s,e,n,t)=>{let r=0,o=s.byteLength/17-1;for(;r<=o;){const i=o+r>>1,u=no(e,n,t,s,i*17);if(u>0)r=i+1;else if(u<0)o=i-1;else return[Rt(s,i*17+7),s.getUint32(i*17+13,!0)]}return null},so=(s,e)=>s.is_dir&&!e.is_dir?1:!s.is_dir&&e.is_dir?-1:s.z!==e.z?s.z-e.z:s.x!==e.x?s.x-e.x:s.y-e.y,Zt=(s,e)=>{const n=s.getUint8(e*17);return{z:n&127,x:je(s,e*17+1),y:je(s,e*17+4),offset:Rt(s,e*17+7),length:s.getUint32(e*17+13,!0),is_dir:n>>7===1}},kt=s=>{const e=[],n=new DataView(s);for(let t=0;t<n.byteLength/17;t++)e.push(Zt(n,t));return oo(e)},oo=s=>{s.sort(so);const e=new ArrayBuffer(17*s.length),n=new Uint8Array(e);for(let t=0;t<s.length;t++){const r=s[t];let o=r.z;r.is_dir&&(o=o|128),n[t*17]=o,n[t*17+1]=r.x&255,n[t*17+2]=r.x>>8&255,n[t*17+3]=r.x>>16&255,n[t*17+4]=r.y&255,n[t*17+5]=r.y>>8&255,n[t*17+6]=r.y>>16&255,n[t*17+7]=r.offset&255,n[t*17+8]=Ne(r.offset,8)&255,n[t*17+9]=Ne(r.offset,16)&255,n[t*17+10]=Ne(r.offset,24)&255,n[t*17+11]=Ne(r.offset,32)&255,n[t*17+12]=Ne(r.offset,48)&255,n[t*17+13]=r.length&255,n[t*17+14]=r.length>>8&255,n[t*17+15]=r.length>>16&255,n[t*17+16]=r.length>>24&255}return e},lo=(s,e)=>{if(s.byteLength<17)return null;const n=s.byteLength/17,t=Zt(s,n-1);if(t.is_dir){const r=t.z,o=e.z-r,i=Math.trunc(e.x/(1<<o)),u=Math.trunc(e.y/(1<<o));return{z:r,x:i,y:u}}return null};function io(s){return R(this,null,function*(){const e=yield s.getBytes(0,512e3),n=new DataView(e.data),t=n.getUint32(4,!0),r=n.getUint16(8,!0),o=new TextDecoder("utf-8"),i=JSON.parse(o.decode(new DataView(e.data,10,t)));let u=0;i.compression==="gzip"&&(u=2);let l=0;"minzoom"in i&&(l=+i.minzoom);let c=0;"maxzoom"in i&&(c=+i.maxzoom);let a=0,f=0,$=0,p=-180,y=-85,k=180,C=85;if(i.bounds){const D=i.bounds.split(",");p=+D[0],y=+D[1],k=+D[2],C=+D[3]}if(i.center){const D=i.center.split(",");a=+D[0],f=+D[1],$=+D[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:l,maxZoom:c,minLon:p,minLat:y,maxLon:k,maxLat:C,centerZoom:$,centerLon:a,centerLat:f,etag:e.etag}})}function ao(s,e,n,t,r,o,i){return R(this,null,function*(){let u=yield n.getArrayBuffer(e,s.rootDirectoryOffset,s.rootDirectoryLength,s);s.specVersion===1&&(u=kt(u));const l=vt(new DataView(u),t,r,o);if(l){let f=(yield e.getBytes(l.offset,l.length,i)).data;const $=new DataView(f);return $.getUint8(0)==31&&$.getUint8(1)==139&&(f=Ye(new Uint8Array(f))),{data:f}}const c=lo(new DataView(u),{z:t,x:r,y:o});if(c){const a=ro(new DataView(u),c.z,c.x,c.y);if(a){let f=yield n.getArrayBuffer(e,a.offset,a.length,s);s.specVersion===1&&(f=kt(f));const $=vt(new DataView(f),t,r,o);if($){let y=(yield e.getBytes($.offset,$.length,i)).data;const k=new DataView(y);return k.getUint8(0)==31&&k.getUint8(1)==139&&(y=Ye(new Uint8Array(y))),{data:y}}}}})}var qt={getHeader:io,getZxy:ao},fo=class{constructor(){this.tile=(s,e)=>{if(s.type=="json"){const n=s.url.substr(10);let t=this.tiles.get(n);return t||(t=new bt(n),this.tiles.set(n,t)),t.getHeader().then(r=>{const o={tiles:[s.url+"/{z}/{x}/{y}"],minzoom:r.minZoom,maxzoom:r.maxZoom,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat]};e(null,o,null,null)}).catch(r=>{e(r,null,null,null)}),{cancel:()=>{}}}else{const n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=s.url.match(n);if(!t)throw new Error("Invalid PMTiles protocol URL");const r=t[1];let o=this.tiles.get(r);o||(o=new bt(r),this.tiles.set(r,o));const i=t[2],u=t[3],l=t[4],c=new AbortController,a=c.signal;let f=()=>{c.abort()};return o.getHeader().then($=>{o.getZxy(+i,+u,+l,a).then(p=>{p?e(null,new Uint8Array(p.data),p.cacheControl,p.expires):$.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(p=>{p.name!=="AbortError"&&e(p,null,null,null)})}),{cancel:f}}},this.tiles=new Map}add(s){this.tiles.set(s.source.getKey(),s)}get(s){return this.tiles.get(s)}};function ye(s,e){return(e>>>0)*4294967296+(s>>>0)}function co(s,e){const n=e.buf;let t,r;if(r=n[e.pos++],t=(r&112)>>4,r<128||(r=n[e.pos++],t|=(r&127)<<3,r<128)||(r=n[e.pos++],t|=(r&127)<<10,r<128)||(r=n[e.pos++],t|=(r&127)<<17,r<128)||(r=n[e.pos++],t|=(r&127)<<24,r<128)||(r=n[e.pos++],t|=(r&1)<<31,r<128))return ye(s,t);throw new Error("Expected varint not more than 10 bytes")}function Ae(s){const e=s.buf;let n,t;return t=e[s.pos++],n=t&127,t<128||(t=e[s.pos++],n|=(t&127)<<7,t<128)||(t=e[s.pos++],n|=(t&127)<<14,t<128)||(t=e[s.pos++],n|=(t&127)<<21,t<128)?n:(t=e[s.pos],n|=(t&15)<<28,co(n,s))}function uo(s,e,n,t){if(t==0){n==1&&(e[0]=s-1-e[0],e[1]=s-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}var $o=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function po(s,e,n){if(s>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,s)-1||n>Math.pow(2,s)-1)throw Error("tile x/y outside zoom level bounds");const t=$o[s],r=Math.pow(2,s);let o=0,i=0,u=0;const l=[e,n];let c=r/2;for(;c>0;)o=(l[0]&c)>0?1:0,i=(l[1]&c)>0?1:0,u+=c*c*(3*o^i),uo(c,l,o,i),c=c/2;return t+u}function Kt(s,e){return R(this,null,function*(){if(e===1||e===0)return s;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Ye(new Uint8Array(s));{let t=new Response(s).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var mo=127;function go(s,e){let n=0,t=s.length-1;for(;n<=t;){const r=t+n>>1,o=e-s[r].tileId;if(o>0)n=r+1;else if(o<0)t=r-1;else return s[r]}return t>=0&&(s[t].runLength===0||e-s[t].tileId<s[t].runLength)?s[t]:null}var ho=class{constructor(s){this.url=s}getKey(){return this.url}getBytes(s,e,n){return R(this,null,function*(){let t;n||(t=new AbortController,n=t.signal);let r=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+s+"-"+(s+e-1)}});if(r.status===416&&s===0){const u=r.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const l=+u.substr(8);r=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(l-1)}})}if(r.status>=300)throw Error("Bad response code: "+r.status);const o=r.headers.get("Content-Length");if(r.status===200&&(!o||+o>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield r.arrayBuffer(),etag:r.headers.get("ETag")||void 0,cacheControl:r.headers.get("Cache-Control")||void 0,expires:r.headers.get("Expires")||void 0}})}};function ee(s,e){const n=s.getUint32(e+4,!0),t=s.getUint32(e+0,!0);return n*Math.pow(2,32)+t}function _o(s,e){const n=new DataView(s),t=n.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:ee(n,8),rootDirectoryLength:ee(n,16),jsonMetadataOffset:ee(n,24),jsonMetadataLength:ee(n,32),leafDirectoryOffset:ee(n,40),leafDirectoryLength:ee(n,48),tileDataOffset:ee(n,56),tileDataLength:ee(n,64),numAddressedTiles:ee(n,72),numTileEntries:ee(n,80),numTileContents:ee(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function Wt(s){const e={buf:new Uint8Array(s),pos:0},n=Ae(e),t=[];let r=0;for(let o=0;o<n;o++){const i=Ae(e);t.push({tileId:r+i,offset:0,length:0,runLength:1}),r+=i}for(let o=0;o<n;o++)t[o].runLength=Ae(e);for(let o=0;o<n;o++)t[o].length=Ae(e);for(let o=0;o<n;o++){const i=Ae(e);i===0&&o>0?t[o].offset=t[o-1].offset+t[o-1].length:t[o].offset=i-1}return t}function wo(s){const e=new DataView(s);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Se=class extends Error{};function vo(s,e,n,t){return R(this,null,function*(){const r=yield s.getBytes(0,16384);if(new DataView(r.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(wo(r.data)<3)return[yield qt.getHeader(s)];const i=r.data.slice(0,mo);let u=r.etag;t&&r.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+s.getKey()),u=void 0);const l=_o(i,u);if(n){const c=r.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),a=s.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,f=Wt(yield e(c,l.internalCompression));return[l,[a,f.length,f]]}return[l,void 0]})}function ko(s,e,n,t,r){return R(this,null,function*(){const o=yield s.getBytes(n,t);if(r.etag&&r.etag!==o.etag)throw new Se(o.etag);const i=yield e(o.data,r.internalCompression),u=Wt(i);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var bo=class{constructor(s=100,e=!0,n=Kt){this.cache=new Map,this.maxCacheEntries=s,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(s,e){return R(this,null,function*(){const n=s.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const t=new Promise((r,o)=>{vo(s,this.decompress,this.prefetch,e).then(i=>{i[1]&&this.cache.set(i[1][0],{lastUsed:this.counter++,data:Promise.resolve(i[1][2])}),r(i[0]),this.prune()}).catch(i=>{o(i)})});return this.cache.set(n,{lastUsed:this.counter++,data:t}),t})}getDirectory(s,e,n,t){return R(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const o=new Promise((i,u)=>{ko(s,this.decompress,e,n,t).then(l=>{i(l),this.prune()}).catch(l=>{u(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:o}),o})}getArrayBuffer(s,e,n,t){return R(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const o=new Promise((i,u)=>{s.getBytes(e,n).then(l=>{if(t.etag&&t.etag!==l.etag)throw new Se(l.etag);i(l.data),this.cache.has(r),this.prune()}).catch(l=>{u(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:o}),o})}prune(){if(this.cache.size>=this.maxCacheEntries){let s=1/0,e;this.cache.forEach((n,t)=>{n.lastUsed<s&&(s=n.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(s,e){return R(this,null,function*(){this.cache.delete(s.getKey()),yield this.getHeader(s,e)})}},bt=class{constructor(s,e,n){typeof s=="string"?this.source=new ho(s):this.source=s,n?this.decompress=n:this.decompress=Kt,e?this.cache=e:this.cache=new bo}getHeader(){return R(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(s,e,n,t){return R(this,null,function*(){const r=po(s,e,n),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return qt.getZxy(o,this.source,this.cache,s,e,n,t);if(s<o.minZoom||s>o.maxZoom)return;let i=o.rootDirectoryOffset,u=o.rootDirectoryLength;for(let l=0;l<=3;l++){const c=yield this.cache.getDirectory(this.source,i,u,o),a=go(c,r);if(a)if(a.runLength>0){const f=yield this.source.getBytes(o.tileDataOffset+a.offset,a.length,t);if(o.etag&&o.etag!==f.etag)throw new Se(f.etag);return{data:yield this.decompress(f.data,o.tileCompression),cacheControl:f.cacheControl,expires:f.expires}}else i=o.leafDirectoryOffset+a.offset,u=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(s,e,n,t){return R(this,null,function*(){try{return yield this.getZxyAttempt(s,e,n,t)}catch(r){if(r instanceof Se)return this.cache.invalidate(this.source,r.message),yield this.getZxyAttempt(s,e,n,t);throw r}})}getMetadataAttempt(){return R(this,null,function*(){const s=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(s.jsonMetadataOffset,s.jsonMetadataLength);if(s.etag&&s.etag!==e.etag)throw new Se(e.etag);const n=yield this.decompress(e.data,s.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(n))})}getMetadata(){return R(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(s){if(s instanceof Se)return this.cache.invalidate(this.source,s.message),yield this.getMetadataAttempt();throw s}})}};function yo(s){return Qe(()=>{let e=new fo;ut.addProtocol("pmtiles",e.tile)}),Et(()=>{ut.removeProtocol("pmtiles")}),[]}class Lo extends j{constructor(e){super(),F(this,e,yo,null,G,{})}}function yt(s,e,n){const t=s.slice();return t[15]=e[n],t}function Co(s){let e;return{c(){e=b("Home")},m(n,t){m(n,e,t)},d(n){n&&g(e)}}}function Lt(s){let e,n;return e=new an({props:{errorMessage:s[1]}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&2&&(o.errorMessage=t[1]),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ct(s){let e,n,t,r;function o(l){s[10](l)}function i(l){s[11](l)}let u={schemes:s[2]};return s[3]!==void 0&&(u.schemesToBeShown=s[3]),s[4]!==void 0&&(u.filterText=s[4]),e=new sr({props:u}),V.push(()=>Z(e,"schemesToBeShown",o)),V.push(()=>Z(e,"filterText",i)),{c(){d(e.$$.fragment)},m(l,c){w(e,l,c),r=!0},p(l,c){const a={};c&4&&(a.schemes=l[2]),!n&&c&8&&(n=!0,a.schemesToBeShown=l[3],q(()=>n=!1)),!t&&c&16&&(t=!0,a.filterText=l[4],q(()=>t=!1)),e.$set(a)},i(l){r||(h(e.$$.fragment,l),r=!0)},o(l){_(e.$$.fragment,l),r=!1},d(l){v(e,l)}}}function St(s){let e,n,t=Le(s[2].values()),r=[];for(let i=0;i<t.length;i+=1)r[i]=Dt(yt(s,t,i));const o=i=>_(r[i],1,1,()=>{r[i]=null});return{c(){e=A("ul");for(let i=0;i<r.length;i+=1)r[i].c()},m(i,u){m(i,e,u);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null);n=!0},p(i,u){if(u&13){t=Le(i[2].values());let l;for(l=0;l<t.length;l+=1){const c=yt(i,t,l);r[l]?(r[l].p(c,u),h(r[l],1)):(r[l]=Dt(c),r[l].c(),h(r[l],1),r[l].m(e,null))}for(me(),l=t.length;l<r.length;l+=1)o(l);ge()}},i(i){if(!n){for(let u=0;u<t.length;u+=1)h(r[u]);n=!0}},o(i){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)_(r[u]);n=!1},d(i){i&&g(e),Ke(r,i)}}}function Tt(s){let e,n;return e=new ts({props:{scheme:s[15],authorityNames:s[0]}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&4&&(o.scheme=t[15]),r&1&&(o.authorityNames=t[0]),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Dt(s){let e=s[3].has(s[15].scheme_reference),n,t,r=e&&Tt(s);return{c(){r&&r.c(),n=fn()},m(o,i){r&&r.m(o,i),m(o,n,i),t=!0},p(o,i){i&12&&(e=o[3].has(o[15].scheme_reference)),e?r?(r.p(o,i),i&12&&h(r,1)):(r=Tt(o),r.c(),h(r,1),r.m(n.parentNode,n)):r&&(me(),_(r,1,1,()=>{r=null}),ge())},i(o){t||(h(r),t=!0)},o(o){_(r),t=!1},d(o){o&&g(n),r&&r.d(o)}}}function So(s){let e,n,t,r,o,i,u,l,c,a,f,$,p;n=new Ie({props:{$$slots:{default:[Co]},$$scope:{ctx:s}}}),n.$on("click",s[9]),u=new $n({props:{boundaryGeojson:s[5]}});let y=s[1]&&Lt(s);a=new nn({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:s[7]}});let k=s[2].size>0&&Ct(s),C=s[0]&&St(s);return{c(){e=A("div"),d(n.$$.fragment),t=U(),r=A("div"),o=A("h1"),o.textContent="Browse schemes",i=U(),d(u.$$.fragment),l=U(),y&&y.c(),c=U(),d(a.$$.fragment),f=U(),k&&k.c(),$=U(),C&&C.c(),ue(r,"display","flex"),ue(r,"justify-content","space-between"),H(e,"slot","sidebar"),H(e,"class","govuk-prose")},m(L,D){m(L,e,D),w(n,e,null),S(e,t),S(e,r),S(r,o),S(r,i),w(u,r,null),S(e,l),y&&y.m(e,null),S(e,c),w(a,e,null),S(e,f),k&&k.m(e,null),S(e,$),C&&C.m(e,null),p=!0},p(L,D){const N={};D&262144&&(N.$$scope={dirty:D,ctx:L}),n.$set(N);const O={};D&32&&(O.boundaryGeojson=L[5]),u.$set(O),L[1]?y?(y.p(L,D),D&2&&h(y,1)):(y=Lt(L),y.c(),h(y,1),y.m(e,c)):y&&(me(),_(y,1,1,()=>{y=null}),ge()),L[2].size>0?k?(k.p(L,D),D&4&&h(k,1)):(k=Ct(L),k.c(),h(k,1),k.m(e,$)):k&&(me(),_(k,1,1,()=>{k=null}),ge()),L[0]?C?(C.p(L,D),D&1&&h(C,1)):(C=St(L),C.c(),h(C,1),C.m(e,null)):C&&(me(),_(C,1,1,()=>{C=null}),ge())},i(L){p||(h(n.$$.fragment,L),h(u.$$.fragment,L),h(y),h(a.$$.fragment,L),h(k),h(C),p=!0)},o(L){_(n.$$.fragment,L),_(u.$$.fragment,L),_(y),_(a.$$.fragment,L),_(k),_(C),p=!1},d(L){L&&g(e),v(n),v(u),y&&y.d(),v(a),k&&k.d(),C&&C.d()}}}function To(s){let e,n,t,r,o,i,u,l,c,a;return e=new vs({}),t=new vr({}),o=new gr({}),u=new Ss({}),c=new gs({}),{c(){d(e.$$.fragment),n=U(),d(t.$$.fragment),r=U(),d(o.$$.fragment),i=U(),d(u.$$.fragment),l=U(),d(c.$$.fragment)},m(f,$){w(e,f,$),m(f,n,$),w(t,f,$),m(f,r,$),w(o,f,$),m(f,i,$),w(u,f,$),m(f,l,$),w(c,f,$),a=!0},i(f){a||(h(e.$$.fragment,f),h(t.$$.fragment,f),h(o.$$.fragment,f),h(u.$$.fragment,f),h(c.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o.$$.fragment,f),_(u.$$.fragment,f),_(c.$$.fragment,f),a=!1},d(f){f&&(g(n),g(r),g(i),g(l)),v(e,f),v(t,f),v(o,f),v(u,f),v(c,f)}}}function Do(s){let e,n;return e=new et({props:{small:!0,$$slots:{default:[To]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&262144&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Oo(s){let e,n;return e=new Ir({}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Uo(s){let e,n;return e=new et({props:{small:!0,$$slots:{default:[Oo]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&262144&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Mo(s){let e,n,t,r,o,i,u,l;return e=new Wr({}),t=new Ps({}),o=new Kn({}),u=new Ur({}),{c(){d(e.$$.fragment),n=U(),d(t.$$.fragment),r=U(),d(o.$$.fragment),i=U(),d(u.$$.fragment)},m(c,a){w(e,c,a),m(c,n,a),w(t,c,a),m(c,r,a),w(o,c,a),m(c,i,a),w(u,c,a),l=!0},i(c){l||(h(e.$$.fragment,c),h(t.$$.fragment,c),h(o.$$.fragment,c),h(u.$$.fragment,c),l=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(o.$$.fragment,c),_(u.$$.fragment,c),l=!1},d(c){c&&(g(n),g(r),g(i)),v(e,c),v(t,c),v(o,c),v(u,c)}}}function No(s){let e,n;return e=new et({props:{small:!0,$$slots:{default:[Mo]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const o={};r&262144&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ao(s){let e,n;return e=new zn({}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Bo(s){let e,n,t,r,o,i,u,l,c,a;return e=new de({props:{label:"Trip generators",$$slots:{default:[Do]},$$scope:{ctx:s}}}),t=new de({props:{label:"Road network",$$slots:{default:[Uo]},$$scope:{ctx:s}}}),o=new de({props:{label:"Boundaries",$$slots:{default:[No]},$$scope:{ctx:s}}}),u=new de({props:{label:"Census",$$slots:{default:[Ao]},$$scope:{ctx:s}}}),c=new gn({props:{style:s[6]}}),{c(){d(e.$$.fragment),n=U(),d(t.$$.fragment),r=U(),d(o.$$.fragment),i=U(),d(u.$$.fragment),l=U(),d(c.$$.fragment)},m(f,$){w(e,f,$),m(f,n,$),w(t,f,$),m(f,r,$),w(o,f,$),m(f,i,$),w(u,f,$),m(f,l,$),w(c,f,$),a=!0},p(f,$){const p={};$&262144&&(p.$$scope={dirty:$,ctx:f}),e.$set(p);const y={};$&262144&&(y.$$scope={dirty:$,ctx:f}),t.$set(y);const k={};$&262144&&(k.$$scope={dirty:$,ctx:f}),o.$set(k);const C={};$&262144&&(C.$$scope={dirty:$,ctx:f}),u.$set(C)},i(f){a||(h(e.$$.fragment,f),h(t.$$.fragment,f),h(o.$$.fragment,f),h(u.$$.fragment,f),h(c.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o.$$.fragment,f),_(u.$$.fragment,f),_(c.$$.fragment,f),a=!1},d(f){f&&(g(n),g(r),g(i),g(l)),v(e,f),v(t,f),v(o,f),v(u,f),v(c,f)}}}function Eo(s){let e,n,t,r,o,i,u,l,c,a,f;return e=new mn({props:{colorInterventions:Pt("v1")}}),t=new ne({props:{layer:"interventions-points",tooltip:s[8],clickable:!1}}),o=new ne({props:{layer:"interventions-lines",tooltip:s[8],clickable:!1}}),u=new ne({props:{layer:"interventions-polygons",tooltip:s[8],clickable:!1}}),a=new de({props:{label:"Layers",open:!0,$$slots:{default:[Bo]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment),n=U(),d(t.$$.fragment),r=U(),d(o.$$.fragment),i=U(),d(u.$$.fragment),l=U(),c=A("div"),d(a.$$.fragment),H(c,"class","top-right svelte-12h3i77")},m($,p){w(e,$,p),m($,n,p),w(t,$,p),m($,r,p),w(o,$,p),m($,i,p),w(u,$,p),m($,l,p),m($,c,p),w(a,c,null),f=!0},p($,p){const y={};p&262144&&(y.$$scope={dirty:p,ctx:$}),a.$set(y)},i($){f||(h(e.$$.fragment,$),h(t.$$.fragment,$),h(o.$$.fragment,$),h(u.$$.fragment,$),h(a.$$.fragment,$),f=!0)},o($){_(e.$$.fragment,$),_(t.$$.fragment,$),_(o.$$.fragment,$),_(u.$$.fragment,$),_(a.$$.fragment,$),f=!1},d($){$&&(g(n),g(r),g(i),g(l),g(c)),v(e,$),v(t,$),v(o,$),v(u,$),v(a)}}}function Po(s){let e,n,t,r,o;return n=new Lo({}),r=new pn({props:{style:s[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Eo]},$$scope:{ctx:s}}}),{c(){e=A("div"),d(n.$$.fragment),t=U(),d(r.$$.fragment),H(e,"slot","main")},m(i,u){m(i,e,u),w(n,e,null),S(e,t),w(r,e,null),o=!0},p(i,u){const l={};u&262144&&(l.$$scope={dirty:u,ctx:i}),r.$set(l)},i(i){o||(h(n.$$.fragment,i),h(r.$$.fragment,i),o=!0)},o(i){_(n.$$.fragment,i),_(r.$$.fragment,i),o=!1},d(i){i&&g(e),v(n),v(r)}}}function xo(s){let e,n;return e=new un({props:{$$slots:{main:[Po],sidebar:[So]},$$scope:{ctx:s}}}),{c(){d(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const o={};r&262207&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function zo(s,e,n){let t,r;W(s,re,D=>n(12,t=D)),W(s,Te,D=>n(5,r=D));let o=null;Qe(async()=>{rn();let D=await sn();n(0,o=new Set(D.features.map(N=>N.properties.name)))});let u=new URLSearchParams(window.location.search).get("style")||"dataviz",l="",c=new Map,a=new Set,f="";Et(()=>{Te.set(on())});function $(D){try{let N=JSON.parse(D);n(2,c=Wn(N)),Te.set(N),n(1,l=""),t==null||t.fitBounds(Bt(N),{padding:20,animate:!1})}catch(N){n(1,l=`Couldn't load schemes from a file: ${N}`)}}function p(D){let N=D.properties;var O='<div style="max-width: 30vw;">';return O+=`<h2>${y(N.name)} (${N.intervention_type})</h2>`,O+=`<p>Scheme reference: ${N.scheme_reference}</p>`,N.length_meters&&(O+=`<p>Length: ${ln(N.length_meters)}</p>`),N.description&&(O+=`<p>${y(N.description)}</p>`),O+="</div>",O}function y(D){return f?D.replace(new RegExp(f,"gi"),N=>`<mark>${N}</mark>`):D}const k=()=>window.open("index.html");function C(D){a=D,n(3,a)}function L(D){f=D,n(4,f)}return[o,l,c,a,f,r,u,$,p,k,C,L]}class Io extends j{constructor(e){super(),F(this,e,zo,xo,G,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Io({target:document.getElementById("app")});
