var At=Object.defineProperty;var St=(o,e,t)=>e in o?At(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var qe=(o,e,t)=>(St(o,typeof e!="symbol"?e+"":e,t),t);import{Z as me,aA as ht,aJ as yt,aF as wt,aS as We,X as vt,aT as Ne,S as J,i as X,s as j,G as Me,f as H,h as C,C as be,j as w,v as _e,k as R,aN as Ue,x as Z,H as Se,I as Ae,q as ve,J as ze,K as Oe,L as Te,M as Ie,r as Pe,u as He,c as ne,m as ie,w as Re,l as le,N as oe,aC as de,aU as Mt,e as Le,d as ye,aB as Ye,af as Je,aa as Lt,aQ as zt,ab as Ot,a as Ce,aV as Tt,o as bt,aW as It,t as Bt,g as Xe,aG as Et,az as xe,av as Pt}from"./index-99a3bf68.js";import{E as Gt}from"./Radio-97148066.js";const Ht=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Fe=me(""),je=me(null);async function Rt(o){let e=ht(je);if(!o||!e)return"Google (attributions loading)";let[t,n]=e,l=o.getBounds(),i=`https://tile.googleapis.com/tile/v1/viewport?session=${n}&key=${t}&zoom=${Math.floor(o.getZoom())}&north=${l.getNorth()}&south=${l.getSouth()}&east=${l.getEast()}&west=${l.getWest()}`;return(await(await fetch(i)).json()).copyright}function Vo(){let o=[];return yt()=="Private (development)"&&(o=o.concat([["google","Google satellite"],["Road","OS Road"],["Light","OS Light"],["Outdoor","OS Outdoor"],["bluesky","Bluesky Satellite (12.5cm)"]])),o.concat([["streets","MapTiler Streets"],["hybrid","MapTiler Satellite"],["dataviz","MapTiler Dataviz"],["uk-openzoomstack-light","OS Open Zoomstack"],["openstreetmap","OpenStreetMap"]])}async function pe(o){if(je.set(null),o=="streets"||o=="hybrid"||o=="dataviz"||o=="uk-openzoomstack-light"||o=="openstreetmap"){let i=o=="streets"?"streets-v2":o;return Fe.set("&copy; MapTiler &copy; OpenStreetMap contributors"),`https://api.maptiler.com/maps/${i}/style.json?key=MZEJTanw3WpxRvt7qDfo`}let t=await(await fetch(`${wt()}/api_keys.json`)).json(),n,l;if(o=="google"){let i=t.google,r=await Ft(i);n=`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${r}&key=${i}`,l="Google (attributions loading)",je.set([i,r])}else o=="bluesky"?(n=`https://ogc.apps.midgard.airbusds-cint.com/apgb/wmts/rest/apgb:AP-12CM5-GB-LATEST/default/EPSG-3857/EPSG:3857:{z}/{y}/{x}?GUID=${t.bluesky}&format=image/png&TRANSPARENT=FALSE,`,l="Bluesky"):(n=`https://api.os.uk/maps/raster/v1/zxy/${o}_3857/{z}/{x}/{y}.png?key=${t.ordnance_survey}`,l="Contains OS data &copy; Crown copyright and database rights 2023");return Fe.set(l),{version:8,sources:{"raster-tiles":{type:"raster",tiles:[n],tileSize:256,attribution:l}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:"https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=MZEJTanw3WpxRvt7qDfo"}}async function Ft(o){try{let t=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${o}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in t?t.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(t)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}let Zt=Date.now();function De(o){return`${o}-${Zt++}`}const Qe=Symbol.for("svelte-maplibre");function Be(){return vt(Qe)}function Ut(o){let e=new WeakMap;return t=>{var r;let n=e.get(t.originalEvent);if(n!==void 0)return n;let i=(r=t.target.queryRenderedFeatures(t.point).find(f=>{var u;return(u=o.get(f.layer.id))==null?void 0:u.interactive}))==null?void 0:r.layer.id;return e.set(t.originalEvent,i),i}}function Dt(){let o=new Map;return We(Qe,{map:me(null),source:Ne(null),layer:Ne(null),popupTarget:Ne(null),cluster:me(),loadedImages:me(new Set),minzoom:me(0),maxzoom:me(24),layerEvent:me(null),layerInfo:o,eventTopMost:Ut(o),markerClickManager:new Qt})}function $e(o){return{subscribe:o.subscribe}}function Ke({key:o,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:n=!1}){let l=Be(),i=me(null),r=$e(i),f={...l,[o]:$e(i)};if(e&&(f.popupTarget=r),n){let u=me(null);f.layerEvent=u,l.layerEvent=u}return t&&(f.cluster=me()),We(Qe,f),{...l,self:i}}function Nt(){return Ke({key:"source",setCluster:!0})}function jt(o=!0){return Ke({key:"layer",setPopupTarget:o,setMouseEvent:o})}function qo(){return Ke({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function Wt(o){return"layerType"in o&&o.layerType==="deckgl"}class Qt{constructor(){qe(this,"_handlers",new Set)}add(e){this._handlers.add(e)}remove(e){this._handlers.delete(e)}handleClick(e){for(const t of this._handlers)t(e)}}function et(o){let e;return t=>{if(t)for(let n in t){let l=e==null?void 0:e[n],i=t[n];l!==i&&o(n,i,l)}else if(e)for(let n in e)o(n,void 0,e[n]);e=t}}function Kt(o,...e){let t=[o];for(let n of e)if(n)Array.isArray(n)&&n[0]===o?t.push(...n.slice(1)):t.push(n);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Vt(o){return o===!0?["has","point_count"]:o===!1?["!",["has","point_count"]]:void 0}function Yo(o,e){return["case",["boolean",["feature-state","hover"],!1],e,o]}var Ze=qt;function qt(o){var e,t,n;if(o){if(Array.isArray(o)){for(e=[],t=o.length,n=0;n<t;n++){var l=o[n];l!=null&&e.push(l)}return e}if(typeof o=="object"){e={};var i=Object.keys(o);for(t=i.length,n=0;n<t;n++){var r=i[n],f=o[r];f!=null&&(e[r]=f)}return e}}}function tt(o){let e=o[0],t,n,l=ot(o);return{c(){l.c(),t=Me()},m(i,r){l.m(i,r),H(i,t,r),n=!0},p(i,r){r[0]&1&&j(e,e=i[0])?(be(),w(l,1,1,ve),_e(),l=ot(i),l.c(),C(l,1),l.m(t.parentNode,t)):l.p(i,r)},i(i){n||(C(l),n=!0)},o(i){w(l),n=!1},d(i){i&&R(t),l.d(i)}}}function ot(o){let e;const t=o[36].default,n=ze(t,o,o[35],null);return{c(){n&&n.c()},m(l,i){n&&n.m(l,i),e=!0},p(l,i){n&&n.p&&(!e||i[1]&16)&&Oe(n,t,l,l[35],e?Ie(t,l[35],i,null):Te(l[35]),null)},i(l){e||(C(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function Yt(o){let e,t,n=o[0]&&tt(o);return{c(){n&&n.c(),e=Me()},m(l,i){n&&n.m(l,i),H(l,e,i),t=!0},p(l,i){l[0]?n?(n.p(l,i),i[0]&1&&C(n,1)):(n=tt(l),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(be(),w(n,1,1,()=>{n=null}),_e())},i(l){t||(C(n),t=!0)},o(l){w(n),t=!1},d(l){l&&R(e),n&&n.d(l)}}}function Jt(o,e,t){let n,l,i,r,f,u,m,a,c,_,v,h,{$$slots:A={},$$scope:b}=e,{id:L=De("layer")}=e,{source:P=void 0}=e,{sourceLayer:B=void 0}=e,{beforeId:U=void 0}=e,{beforeLayerType:G=void 0}=e,{type:I}=e,{paint:E=void 0}=e,{layout:k=void 0}=e,{filter:T=void 0}=e,{applyToClusters:W=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:ge=void 0}=e,{manageHoverState:q=!1}=e,{hovered:x=null}=e,{interactive:p=!0}=e,{hoverCursor:$=void 0}=e,{eventsIfTopMost:re=!1}=e;const S=Ue(),{map:fe,source:Q,self:ke,minzoom:ue,maxzoom:K,eventTopMost:D,layerInfo:he}=jt();Z(o,fe,y=>t(31,c=y)),Z(o,Q,y=>t(32,_=y)),Z(o,ke,y=>t(0,a=y)),Z(o,ue,y=>t(34,h=y)),Z(o,K,y=>t(33,v=y)),Se(()=>{a&&c&&(he.delete(a),c==null||c.removeLayer(a))});let O;function N(y){var g,Y;if(!p||!a||!c||re&&D(y)!==a)return;let z=y.features??[],ce=(Y=(g=z[0])==null?void 0:g.properties)==null?void 0:Y.cluster_id,V={event:y,map:c,clusterId:ce,layer:a,source:f,features:z};S(y.type,V)}function se(y){var g,Y;if(!p||!a||!c||re&&D(y)!==a)return;$&&(c.getCanvas().style.cursor=$);let z=y.features??[];t(6,x=z[0]??null);let ce=(Y=(g=z[0])==null?void 0:g.properties)==null?void 0:Y.cluster_id;S("mouseenter",{event:y,map:c,clusterId:ce,layer:a,source:f,features:z})}function ae(y){var g,Y,s;if(!p||!c)return;if(re&&D(y)!==a){t(6,x=null),q&&O!==void 0&&(c==null||c.setFeatureState({source:f,sourceLayer:B,id:O},{hover:!1}),O=void 0);return}c.getCanvas().style.cursor=$;let z=y.features??[],ce=(Y=(g=z[0])==null?void 0:g.properties)==null?void 0:Y.cluster_id,V=(s=z[0])==null?void 0:s.id;V!==O&&(q&&(O!==void 0&&(c==null||c.setFeatureState({source:f,id:O,sourceLayer:B},{hover:!1})),c==null||c.setFeatureState({source:f,id:V,sourceLayer:B},{hover:!0})),O=V,t(6,x=z[0]??null)),S("mousemove",{event:y,map:c,clusterId:ce,layer:a,source:f,features:z})}function we(y){if(!(!p||!a||!c)){if($&&(c.getCanvas().style.cursor=""),t(6,x=null),q&&O!==void 0){const z={source:f,id:O,sourceLayer:B};c==null||c.setFeatureState(z,{hover:!1}),O=void 0}S("mouseleave",{map:c,layer:a,source:f})}}let ee=!0;function te(y){c&&(c.off("click",y,N),c.off("dblclick",y,N),c.off("contextmenu",y,N),c.off("mouseenter",y,se),c.off("mousemove",y,ae),c.off("mouseleave",y,we))}return Se(()=>{c&&a&&te(a)}),o.$$set=y=>{"id"in y&&t(7,L=y.id),"source"in y&&t(8,P=y.source),"sourceLayer"in y&&t(9,B=y.sourceLayer),"beforeId"in y&&t(10,U=y.beforeId),"beforeLayerType"in y&&t(11,G=y.beforeLayerType),"type"in y&&t(12,I=y.type),"paint"in y&&t(13,E=y.paint),"layout"in y&&t(14,k=y.layout),"filter"in y&&t(15,T=y.filter),"applyToClusters"in y&&t(16,W=y.applyToClusters),"minzoom"in y&&t(17,d=y.minzoom),"maxzoom"in y&&t(18,ge=y.maxzoom),"manageHoverState"in y&&t(19,q=y.manageHoverState),"hovered"in y&&t(6,x=y.hovered),"interactive"in y&&t(20,p=y.interactive),"hoverCursor"in y&&t(21,$=y.hoverCursor),"eventsIfTopMost"in y&&t(22,re=y.eventsIfTopMost),"$$scope"in y&&t(35,b=y.$$scope)},o.$$.update=()=>{if(o.$$.dirty[0]&65536&&t(30,n=Vt(W)),o.$$.dirty[0]&1073774592&&t(24,l=Kt("all",n,T)),o.$$.dirty[0]&131072|o.$$.dirty[1]&8&&t(26,i=d??h),o.$$.dirty[0]&262144|o.$$.dirty[1]&4&&t(25,r=ge??v),o.$$.dirty[0]&256|o.$$.dirty[1]&2&&t(29,f=P||_),o.$$.dirty[0]&654343809|o.$$.dirty[1]&1&&c&&a!==L&&f){a&&(te(a),he.delete(a));let y=U;if(!U&&G){let z=c.getStyle().layers,ce=typeof G=="function"?G:g=>g.type===G,V=z==null?void 0:z.find(ce);V&&(y=V.id)}Ae(ke,a=L,a),c.addLayer(Ze({id:a,type:I,source:f,"source-layer":B,filter:l,paint:E,layout:k,minzoom:i,maxzoom:r}),y),t(23,ee=!0),c.on("click",a,N),c.on("dblclick",a,N),c.on("contextmenu",a,N),c.on("mouseenter",a,se),c.on("mousemove",a,ae),c.on("mouseleave",a,we)}o.$$.dirty[0]&1048577&&a&&he.set(a,{interactive:p}),o.$$.dirty[0]&1|o.$$.dirty[1]&1&&t(28,u=a?et((y,z)=>{c!=null&&c.style._loaded?c.setPaintProperty(a,y,z):c==null||c.once("styledata",()=>c==null?void 0:c.setPaintProperty(a,y,z))}):void 0),o.$$.dirty[0]&1|o.$$.dirty[1]&1&&t(27,m=a?et((y,z)=>{c!=null&&c.style._loaded?c.setLayoutProperty(a,y,z):c==null||c.once("styledata",()=>c==null?void 0:c.setLayoutProperty(a,y,z))}):void 0),o.$$.dirty[0]&268443648&&(u==null||u(E)),o.$$.dirty[0]&134234112&&(m==null||m(k)),o.$$.dirty[0]&100663297|o.$$.dirty[1]&1&&a&&(c==null||c.setLayerZoomRange(a,i,r)),o.$$.dirty[0]&25165825|o.$$.dirty[1]&1&&a&&(ee?t(23,ee=!1):c==null||c.setFilter(a,l))},[a,fe,Q,ke,ue,K,x,L,P,B,U,G,I,E,k,T,W,d,ge,q,p,$,re,ee,l,r,i,m,u,f,n,c,_,v,h,b,A]}class _t extends J{constructor(e){super(),X(this,e,Jt,Yt,j,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function Xt(o){let e;const t=o[15].default,n=ze(t,o,o[23],null);return{c(){n&&n.c()},m(l,i){n&&n.m(l,i),e=!0},p(l,i){n&&n.p&&(!e||i&8388608)&&Oe(n,t,l,l[23],e?Ie(t,l[23],i,null):Te(l[23]),null)},i(l){e||(C(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function xt(o){let e,t,n;function l(r){o[16](r)}let i={id:o[1],type:"fill",source:o[2],sourceLayer:o[3],beforeId:o[4],beforeLayerType:o[5],paint:o[6],layout:o[7],filter:o[8],minzoom:o[9],maxzoom:o[10],hoverCursor:o[11],manageHoverState:o[12],eventsIfTopMost:o[13],interactive:o[14],$$slots:{default:[Xt]},$$scope:{ctx:o}};return o[0]!==void 0&&(i.hovered=o[0]),e=new _t({props:i}),Pe.push(()=>He(e,"hovered",l)),e.$on("click",o[17]),e.$on("dblclick",o[18]),e.$on("contextmenu",o[19]),e.$on("mouseenter",o[20]),e.$on("mousemove",o[21]),e.$on("mouseleave",o[22]),{c(){ne(e.$$.fragment)},m(r,f){ie(e,r,f),n=!0},p(r,[f]){const u={};f&2&&(u.id=r[1]),f&4&&(u.source=r[2]),f&8&&(u.sourceLayer=r[3]),f&16&&(u.beforeId=r[4]),f&32&&(u.beforeLayerType=r[5]),f&64&&(u.paint=r[6]),f&128&&(u.layout=r[7]),f&256&&(u.filter=r[8]),f&512&&(u.minzoom=r[9]),f&1024&&(u.maxzoom=r[10]),f&2048&&(u.hoverCursor=r[11]),f&4096&&(u.manageHoverState=r[12]),f&8192&&(u.eventsIfTopMost=r[13]),f&16384&&(u.interactive=r[14]),f&8388608&&(u.$$scope={dirty:f,ctx:r}),!t&&f&1&&(t=!0,u.hovered=r[0],Re(()=>t=!1)),e.$set(u)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){w(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function pt(o,e,t){let{$$slots:n={},$$scope:l}=e,{id:i=De("fill")}=e,{source:r=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:u=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:a}=e,{layout:c=void 0}=e,{filter:_=void 0}=e,{minzoom:v=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:b=!1}=e,{hovered:L=null}=e,{eventsIfTopMost:P=!1}=e,{interactive:B=!0}=e;function U(d){L=d,t(0,L)}function G(d){oe.call(this,o,d)}function I(d){oe.call(this,o,d)}function E(d){oe.call(this,o,d)}function k(d){oe.call(this,o,d)}function T(d){oe.call(this,o,d)}function W(d){oe.call(this,o,d)}return o.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,r=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,u=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,a=d.paint),"layout"in d&&t(7,c=d.layout),"filter"in d&&t(8,_=d.filter),"minzoom"in d&&t(9,v=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,b=d.manageHoverState),"hovered"in d&&t(0,L=d.hovered),"eventsIfTopMost"in d&&t(13,P=d.eventsIfTopMost),"interactive"in d&&t(14,B=d.interactive),"$$scope"in d&&t(23,l=d.$$scope)},[L,i,r,f,u,m,a,c,_,v,h,A,b,P,B,n,U,G,I,E,k,T,W,l]}class Jo extends J{constructor(e){super(),X(this,e,pt,xt,j,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function $t(o,e,t){let n;const{map:l}=Be();Z(o,l,u=>t(4,n=u));let{position:i="top-left"}=e,{container:r=void 0}=e,f=null;return Se(()=>{n!=null&&n.loaded()&&f&&n.removeControl(f)}),o.$$set=u=>{"position"in u&&t(1,i=u.position),"container"in u&&t(2,r=u.container)},o.$$.update=()=>{if(o.$$.dirty&30&&n&&!f){let u;typeof r=="string"?u=document.querySelector(r)??void 0:u=r,t(3,f=new de.FullscreenControl({container:u})),n.addControl(f,i)}},[l,i,r,f,n]}class eo extends J{constructor(e){super(),X(this,e,$t,null,j,{position:1,container:2})}}function to(o,e,t,n,l){let i=!1;o.getSource(e)&&(i=!0,o.removeSource(e));const r=()=>{n(e)&&(o.addSource(e,t),l())};if(i){const f=()=>{e&&(o.getSource(e)?setTimeout(f,1):r())};f()}else r()}function oo(o,e,t){Mt().then(()=>{let n=ht(o);if(!n)return;n.getSource(e)===t&&n.removeSource(e)})}function nt(o){let e=o[0],t,n,l=it(o);return{c(){l.c(),t=Me()},m(i,r){l.m(i,r),H(i,t,r),n=!0},p(i,r){r&1&&j(e,e=i[0])?(be(),w(l,1,1,ve),_e(),l=it(i),l.c(),C(l,1),l.m(t.parentNode,t)):l.p(i,r)},i(i){n||(C(l),n=!0)},o(i){w(l),n=!1},d(i){i&&R(t),l.d(i)}}}function it(o){let e;const t=o[19].default,n=ze(t,o,o[18],null);return{c(){n&&n.c()},m(l,i){n&&n.m(l,i),e=!0},p(l,i){n&&n.p&&(!e||i&262144)&&Oe(n,t,l,l[18],e?Ie(t,l[18],i,null):Te(l[18]),null)},i(l){e||(C(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function no(o){let e,t,n=o[0]&&nt(o);return{c(){n&&n.c(),e=Me()},m(l,i){n&&n.m(l,i),H(l,e,i),t=!0},p(l,[i]){l[0]?n?(n.p(l,i),i&1&&C(n,1)):(n=nt(l),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(be(),w(n,1,1,()=>{n=null}),_e())},i(l){t||(C(n),t=!0)},o(l){w(n),t=!1},d(l){l&&R(e),n&&n.d(l)}}}function io(o,e,t){let n,l,i,{$$slots:r={},$$scope:f}=e,{id:u=De("geojson")}=e,{data:m}=e,{generateId:a=!1}=e,{promoteId:c=void 0}=e,{filter:_=void 0}=e,{lineMetrics:v=void 0}=e,{cluster:h=void 0}=e,{maxzoom:A=void 0}=e,{attribution:b=void 0}=e,{buffer:L=void 0}=e,{tolerance:P=void 0}=e;const{map:B,cluster:U,self:G}=Nt();Z(o,B,k=>t(17,l=k)),Z(o,U,k=>t(20,i=k)),Z(o,G,k=>t(0,n=k));let I,E=!0;return Se(()=>{n&&I&&l&&(oo(B,n,I),Ae(G,n=null,n),t(15,I=void 0))}),o.$$set=k=>{"id"in k&&t(4,u=k.id),"data"in k&&t(5,m=k.data),"generateId"in k&&t(6,a=k.generateId),"promoteId"in k&&t(7,c=k.promoteId),"filter"in k&&t(8,_=k.filter),"lineMetrics"in k&&t(9,v=k.lineMetrics),"cluster"in k&&t(10,h=k.cluster),"maxzoom"in k&&t(11,A=k.maxzoom),"attribution"in k&&t(12,b=k.attribution),"buffer"in k&&t(13,L=k.buffer),"tolerance"in k&&t(14,P=k.tolerance),"$$scope"in k&&t(18,f=k.$$scope)},o.$$.update=()=>{o.$$.dirty&1024&&Ae(U,i=h,i),o.$$.dirty&196593&&l&&n!==u&&(Ae(G,n=u,n),to(l,n,Ze({type:"geojson",data:m,filter:_,lineMetrics:v,generateId:a,promoteId:c,cluster:!!h,clusterMinPoints:h==null?void 0:h.minPoints,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius,clusterProperties:h==null?void 0:h.properties,maxzoom:A,attribution:b,buffer:L,tolerance:P}),k=>l&&k===n,()=>{n&&(t(15,I=l==null?void 0:l.getSource(n)),t(16,E=!0))})),o.$$.dirty&131088&&(l==null||l.on("style.load",()=>{t(15,I=l==null?void 0:l.getSource(u))})),o.$$.dirty&98336&&I&&(E?t(16,E=!1):I.setData(m)),o.$$.dirty&33792&&(I==null||I.setClusterOptions(Ze({cluster:!!h,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius})))},[n,B,U,G,u,m,a,c,_,v,h,A,b,L,P,I,E,l,f,r]}class Xo extends J{constructor(e){super(),X(this,e,io,no,j,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10,maxzoom:11,attribution:12,buffer:13,tolerance:14})}}function lo(o,e,t){let n;const{map:l}=Be();Z(o,l,_=>t(8,n=_));let{position:i="top-left"}=e,{positionOptions:r=void 0}=e,{fitBoundsOptions:f=void 0}=e,{trackUserLocation:u=!1}=e,{showAccuracyCircle:m=!0}=e,{showUserLocation:a=!0}=e,{control:c=null}=e;return Se(()=>{n!=null&&n.loaded()&&c&&n.removeControl(c)}),o.$$set=_=>{"position"in _&&t(2,i=_.position),"positionOptions"in _&&t(3,r=_.positionOptions),"fitBoundsOptions"in _&&t(4,f=_.fitBoundsOptions),"trackUserLocation"in _&&t(5,u=_.trackUserLocation),"showAccuracyCircle"in _&&t(6,m=_.showAccuracyCircle),"showUserLocation"in _&&t(7,a=_.showUserLocation),"control"in _&&t(1,c=_.control)},o.$$.update=()=>{o.$$.dirty&510&&n&&!c&&(t(1,c=new de.GeolocateControl({positionOptions:r,fitBoundsOptions:f,trackUserLocation:u,showAccuracyCircle:m,showUserLocation:a})),n.addControl(c,i))},[l,c,i,r,f,u,m,a,n]}class ro extends J{constructor(e){super(),X(this,e,lo,null,j,{position:2,positionOptions:3,fitBoundsOptions:4,trackUserLocation:5,showAccuracyCircle:6,showUserLocation:7,control:1})}}function fo(o){let e;const t=o[15].default,n=ze(t,o,o[23],null);return{c(){n&&n.c()},m(l,i){n&&n.m(l,i),e=!0},p(l,i){n&&n.p&&(!e||i&8388608)&&Oe(n,t,l,l[23],e?Ie(t,l[23],i,null):Te(l[23]),null)},i(l){e||(C(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function uo(o){let e,t,n;function l(r){o[16](r)}let i={id:o[1],type:"line",source:o[2],sourceLayer:o[3],beforeId:o[4],beforeLayerType:o[5],paint:o[6],layout:o[7],filter:o[8],minzoom:o[9],maxzoom:o[10],hoverCursor:o[11],manageHoverState:o[12],eventsIfTopMost:o[13],interactive:o[14],$$slots:{default:[fo]},$$scope:{ctx:o}};return o[0]!==void 0&&(i.hovered=o[0]),e=new _t({props:i}),Pe.push(()=>He(e,"hovered",l)),e.$on("click",o[17]),e.$on("dblclick",o[18]),e.$on("contextmenu",o[19]),e.$on("mouseenter",o[20]),e.$on("mousemove",o[21]),e.$on("mouseleave",o[22]),{c(){ne(e.$$.fragment)},m(r,f){ie(e,r,f),n=!0},p(r,[f]){const u={};f&2&&(u.id=r[1]),f&4&&(u.source=r[2]),f&8&&(u.sourceLayer=r[3]),f&16&&(u.beforeId=r[4]),f&32&&(u.beforeLayerType=r[5]),f&64&&(u.paint=r[6]),f&128&&(u.layout=r[7]),f&256&&(u.filter=r[8]),f&512&&(u.minzoom=r[9]),f&1024&&(u.maxzoom=r[10]),f&2048&&(u.hoverCursor=r[11]),f&4096&&(u.manageHoverState=r[12]),f&8192&&(u.eventsIfTopMost=r[13]),f&16384&&(u.interactive=r[14]),f&8388608&&(u.$$scope={dirty:f,ctx:r}),!t&&f&1&&(t=!0,u.hovered=r[0],Re(()=>t=!1)),e.$set(u)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){w(e.$$.fragment,r),n=!1},d(r){le(e,r)}}}function so(o,e,t){let{$$slots:n={},$$scope:l}=e,{id:i=De("line")}=e,{source:r=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:u=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:a}=e,{layout:c=void 0}=e,{filter:_=void 0}=e,{minzoom:v=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:A=void 0}=e,{manageHoverState:b=!1}=e,{hovered:L=null}=e,{eventsIfTopMost:P=!1}=e,{interactive:B=!0}=e;function U(d){L=d,t(0,L)}function G(d){oe.call(this,o,d)}function I(d){oe.call(this,o,d)}function E(d){oe.call(this,o,d)}function k(d){oe.call(this,o,d)}function T(d){oe.call(this,o,d)}function W(d){oe.call(this,o,d)}return o.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,r=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,u=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,a=d.paint),"layout"in d&&t(7,c=d.layout),"filter"in d&&t(8,_=d.filter),"minzoom"in d&&t(9,v=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,A=d.hoverCursor),"manageHoverState"in d&&t(12,b=d.manageHoverState),"hovered"in d&&t(0,L=d.hovered),"eventsIfTopMost"in d&&t(13,P=d.eventsIfTopMost),"interactive"in d&&t(14,B=d.interactive),"$$scope"in d&&t(23,l=d.$$scope)},[L,i,r,f,u,m,a,c,_,v,h,A,b,P,B,n,U,G,I,E,k,T,W,l]}class xo extends J{constructor(e){super(),X(this,e,so,uo,j,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function ao(o,e,t){let n;const l=Ue();let{layer:i=void 0}=e;const{map:r}=Be();Z(o,r,a=>t(2,n=a));function f(a){l(a.type,{...a,map:r})}const u=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],m=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return Se(()=>{if(n)if(i)for(const a of u)n.off(a,i,f);else for(const a of m)n.off(a,f)}),o.$$set=a=>{"layer"in a&&t(1,i=a.layer)},o.$$.update=()=>{if(o.$$.dirty&6&&n)if(i)for(const a of u)n.on(a,i,f);else for(const a of m)n.on(a,f)},[r,i,n]}class co extends J{constructor(e){super(),X(this,e,ao,null,j,{layer:1})}}function mo(o){let e=o.getCenter(),t=Math.round(o.getZoom()*100)/100,n=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),l=Math.pow(10,n),i=Math.round(e.lat*l)/l,r=Math.round(e.lng*l)/l,f=`${t}/${i}/${r}`,u=o.getBearing(),m=o.getPitch();return(u||m)&&(f+=`/${Math.round(u*10)/10}`),m&&(f+=`/${Math.round(m)}`),`#${f}`}function go(o){return o.replace("#","").split("/").map(parseFloat)}var Ee=Ve;function Ve(o,e){return o===e||o!==o&&e!==e?!0:typeof o!=typeof e||{}.toString.call(o)!={}.toString.call(e)||o!==Object(o)||!o?!1:Array.isArray(o)?lt(o,e):{}.toString.call(o)=="[object Set]"?lt(Array.from(o),Array.from(e)):{}.toString.call(o)=="[object Object]"?yo(o,e):ho(o,e)}function ho(o,e){return o.toString()===e.toString()}function lt(o,e){var t=o.length;if(t!=e.length)return!1;for(var n=0;n<t;n++)if(!Ve(o[n],e[n]))return!1;return!0}function yo(o,e){var t=Object.keys(o),n=t.length;if(n!=Object.keys(e).length)return!1;for(var l=0;l<n;l++){var i=t[l];if(!(e.hasOwnProperty(i)&&Ve(o[i],e[i])))return!1}return!0}function bo(o,e,t){let n;const{map:l}=Be();Z(o,l,a=>t(6,n=a));let{position:i="top-left"}=e,{showCompass:r=!0}=e,{showZoom:f=!0}=e,{visualizePitch:u=!1}=e,m=null;return Se(()=>{n!=null&&n.loaded()&&m&&n.removeControl(m)}),o.$$set=a=>{"position"in a&&t(1,i=a.position),"showCompass"in a&&t(2,r=a.showCompass),"showZoom"in a&&t(3,f=a.showZoom),"visualizePitch"in a&&t(4,u=a.visualizePitch)},o.$$.update=()=>{o.$$.dirty&126&&n&&!m&&(t(5,m=new de.NavigationControl({showCompass:r,showZoom:f,visualizePitch:u})),n.addControl(m,i))},[l,i,r,f,u,m,n]}class kt extends J{constructor(e){super(),X(this,e,bo,null,j,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function _o(o,e,t){let n;const{map:l}=Be();Z(o,l,m=>t(5,n=m));let{position:i="bottom-left"}=e,{maxWidth:r=void 0}=e,{unit:f="metric"}=e,u=null;return Se(()=>{n!=null&&n.loaded()&&u&&n.removeControl(u)}),o.$$set=m=>{"position"in m&&t(1,i=m.position),"maxWidth"in m&&t(2,r=m.maxWidth),"unit"in m&&t(3,f=m.unit)},o.$$.update=()=>{o.$$.dirty&62&&n&&!u&&(t(4,u=new de.ScaleControl({maxWidth:r,unit:f})),n.addControl(u,i))},[l,i,r,f,u,n]}class Ct extends J{constructor(e){super(),X(this,e,_o,null,j,{position:1,maxWidth:2,unit:3})}}const{window:ko}=Ht,Co=o=>({map:o[0]&16,loadedImages:o[0]&32,allImagesLoaded:o[0]&64}),rt=o=>({map:o[4],loadedImages:o[5],allImagesLoaded:o[6]});function ft(o){let e,t,n=o[3]&&ut(o);const l=o[46].default,i=ze(l,o,o[45],rt);return{c(){n&&n.c(),e=Ce(),i&&i.c()},m(r,f){n&&n.m(r,f),H(r,e,f),i&&i.m(r,f),t=!0},p(r,f){r[3]?n?(n.p(r,f),f[0]&8&&C(n,1)):(n=ut(r),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(be(),w(n,1,1,()=>{n=null}),_e()),i&&i.p&&(!t||f[0]&112|f[1]&16384)&&Oe(i,l,r,r[45],t?Ie(l,r[45],f,Co):Te(r[45]),rt)},i(r){t||(C(n),C(i,r),t=!0)},o(r){w(n),w(i,r),t=!1},d(r){r&&R(e),n&&n.d(r),i&&i.d(r)}}}function ut(o){let e,t,n,l,i,r,f,u;return e=new kt({props:{position:o[7]}}),n=new ro({props:{position:o[7],fitBoundsOptions:{maxZoom:12}}}),i=new eo({props:{position:o[7]}}),f=new Ct({props:{position:o[7]}}),{c(){ne(e.$$.fragment),t=Ce(),ne(n.$$.fragment),l=Ce(),ne(i.$$.fragment),r=Ce(),ne(f.$$.fragment)},m(m,a){ie(e,m,a),H(m,t,a),ie(n,m,a),H(m,l,a),ie(i,m,a),H(m,r,a),ie(f,m,a),u=!0},p(m,a){const c={};a[0]&128&&(c.position=m[7]),e.$set(c);const _={};a[0]&128&&(_.position=m[7]),n.$set(_);const v={};a[0]&128&&(v.position=m[7]),i.$set(v);const h={};a[0]&128&&(h.position=m[7]),f.$set(h)},i(m){u||(C(e.$$.fragment,m),C(n.$$.fragment,m),C(i.$$.fragment,m),C(f.$$.fragment,m),u=!0)},o(m){w(e.$$.fragment,m),w(n.$$.fragment,m),w(i.$$.fragment,m),w(f.$$.fragment,m),u=!1},d(m){m&&(R(t),R(l),R(r)),le(e,m),le(n,m),le(i,m),le(f,m)}}}function Ao(o){let e,t,n,l,i,r=o[4]&&o[0]&&ft(o);return{c(){e=Le("div"),r&&r.c(),ye(e,"class",t=Ye(o[2])+" svelte-p00lfq"),ye(e,"data-testid","map-container"),Je(e,"expand-map",!o[2])},m(f,u){H(f,e,u),r&&r.m(e,null),o[47](e),n=!0,l||(i=[Lt(ko,"hashchange",o[11]),zt(o[10].call(null,e))],l=!0)},p(f,u){f[4]&&f[0]?r?(r.p(f,u),u[0]&17&&C(r,1)):(r=ft(f),r.c(),C(r,1),r.m(e,null)):r&&(be(),w(r,1,1,()=>{r=null}),_e()),(!n||u[0]&4&&t!==(t=Ye(f[2])+" svelte-p00lfq"))&&ye(e,"class",t),(!n||u[0]&4)&&Je(e,"expand-map",!f[2])},i(f){n||(C(r),n=!0)},o(f){w(r),n=!1},d(f){f&&R(e),r&&r.d(),o[47](null),l=!1,Ot(i)}}}function So(o,e,t){let n,l,i,r,{$$slots:f={},$$scope:u}=e,{map:m=null}=e,{mapContainer:a=void 0}=e,{class:c=void 0}=e,{style:_}=e,{diffStyleUpdates:v=!1}=e,{center:h=void 0}=e,{zoom:A=void 0}=e,{pitch:b=0}=e,{bearing:L=0}=e,{bounds:P=void 0}=e,{hash:B=!1}=e,{updateHash:U=s=>{window.history.replaceState(window.history.state,"",s)}}=e,{loaded:G=!1}=e,{minZoom:I=0}=e,{maxZoom:E=22}=e,{minPitch:k=0}=e,{maxPitch:T=60}=e,{renderWorldCopies:W=void 0}=e,{dragPan:d=void 0}=e,{dragRotate:ge=void 0}=e,{pitchWithRotate:q=void 0}=e,{antialias:x=void 0}=e,{zoomOnDoubleClick:p=!0}=e,{locale:$=void 0}=e,{interactive:re=!0}=e,{attributionControl:S=!0}=e,{cooperativeGestures:fe=!1}=e,{preserveDrawingBuffer:Q=!1}=e,{maxBounds:ke=void 0}=e,{images:ue=[]}=e,{standardControls:K=!1}=e,{filterLayers:D=void 0}=e,{transformRequest:he=void 0}=e;const O=Ue(),{map:N,loadedImages:se}=Dt();Z(o,N,s=>t(4,i=s)),Z(o,se,s=>t(5,r=s));let ae=new Set;async function we(s,M=!1){if(i&&!(!i.loaded()&&!M))if("url"in s){ae.add(s.id);try{let F=await i.loadImage(s.url);i==null||i.addImage(s.id,F.data,s.options),r.add(s.id),se.set(r)}catch(F){O("error",F)}finally{ae.delete(s.id)}}else i.addImage(s.id,s.data,s.options),r.add(s.id),se.set(r)}let ee,te,y,z;function ce(s){return g(),Ae(N,i=new de.Map(Ze({container:s,style:_,locale:$,center:h,zoom:A,pitch:b,bearing:L,minZoom:I,maxZoom:E,minPitch:k,maxPitch:T,renderWorldCopies:W,dragPan:d,dragRotate:ge,pitchWithRotate:q,antialias:x,interactive:re,preserveDrawingBuffer:Q,maxBounds:ke,bounds:P,attributionControl:S,transformRequest:he,cooperativeGestures:fe})),i),i.on("load",M=>{M.target.getContainer().setAttribute("data-testid","map"),M.target.getCanvas().setAttribute("data-testid","map-canvas"),t(0,G=!0),O("load",i)}),i.on("error",M=>O("error",{...M,map:i})),i.on("movestart",M=>O("movestart",{...M,map:i})),i.on("moveend",M=>{if(t(12,h=M.target.getCenter()),t(13,A=M.target.getZoom()),t(14,b=M.target.getPitch()),t(15,L=M.target.getBearing()),t(16,P=M.target.getBounds()),O("moveend",{...M,map:i}),B){let F=new URL(window.location.href.replace(/(#.+)?$/,mo(i)));U(F)}}),i.on("click",M=>O("click",{...M,map:i})),i.on("dblclick",M=>O("dblclick",{...M,map:i})),i.on("contextmenu",M=>O("contextmenu",{...M,map:i})),i.on("zoomstart",M=>O("zoomstart",{...M,map:i})),i.on("zoom",M=>{O("zoom",{...M,map:i})}),i.on("zoomend",M=>{O("zoomend",{...M,map:i})}),i.on("style.load",()=>{if(i){const M=i.getStyle();if(t(42,ee=M.layers.map(F=>F.id)),t(43,te=Object.keys(M.sources)),z)for(const[F,Ge]of Object.entries(z))i.addSource(F,Ge);if(y)for(const F of y)i.addLayer(F);for(const F of ue)we(F,!0)}}),i.on("styledata",M=>{if(i&&D){const F=i.getStyle().layers;if(F)for(let Ge of F)D(Ge)||i.setLayoutProperty(Ge.id,"visibility","none")}O("styledata",{...M,map:i})}),{destroy(){t(0,G=!1),i==null||i.remove(),Ae(N,i=null,i)}}}let V=_;function g(){if(B){let s=go(window.location.hash);s.length>=3&&(t(13,A=s[0]),t(12,h=[s[2],s[1]])),s.length==5&&(t(15,L=s[3]),t(14,b=s[4]))}}function Y(s){Pe[s?"unshift":"push"](()=>{a=s,t(1,a)})}return o.$$set=s=>{"map"in s&&t(17,m=s.map),"mapContainer"in s&&t(1,a=s.mapContainer),"class"in s&&t(2,c=s.class),"style"in s&&t(18,_=s.style),"diffStyleUpdates"in s&&t(19,v=s.diffStyleUpdates),"center"in s&&t(12,h=s.center),"zoom"in s&&t(13,A=s.zoom),"pitch"in s&&t(14,b=s.pitch),"bearing"in s&&t(15,L=s.bearing),"bounds"in s&&t(16,P=s.bounds),"hash"in s&&t(20,B=s.hash),"updateHash"in s&&t(21,U=s.updateHash),"loaded"in s&&t(0,G=s.loaded),"minZoom"in s&&t(22,I=s.minZoom),"maxZoom"in s&&t(23,E=s.maxZoom),"minPitch"in s&&t(24,k=s.minPitch),"maxPitch"in s&&t(25,T=s.maxPitch),"renderWorldCopies"in s&&t(26,W=s.renderWorldCopies),"dragPan"in s&&t(27,d=s.dragPan),"dragRotate"in s&&t(28,ge=s.dragRotate),"pitchWithRotate"in s&&t(29,q=s.pitchWithRotate),"antialias"in s&&t(30,x=s.antialias),"zoomOnDoubleClick"in s&&t(31,p=s.zoomOnDoubleClick),"locale"in s&&t(32,$=s.locale),"interactive"in s&&t(33,re=s.interactive),"attributionControl"in s&&t(34,S=s.attributionControl),"cooperativeGestures"in s&&t(35,fe=s.cooperativeGestures),"preserveDrawingBuffer"in s&&t(36,Q=s.preserveDrawingBuffer),"maxBounds"in s&&t(37,ke=s.maxBounds),"images"in s&&t(38,ue=s.images),"standardControls"in s&&t(3,K=s.standardControls),"filterLayers"in s&&t(39,D=s.filterLayers),"transformRequest"in s&&t(40,he=s.transformRequest),"$$scope"in s&&t(45,u=s.$$scope)},o.$$.update=()=>{if(o.$$.dirty[0]&8&&t(7,n=typeof K=="boolean"?void 0:K),o.$$.dirty[0]&16&&t(17,m=i),o.$$.dirty[0]&786448|o.$$.dirty[1]&14336&&i&&!Ee(_,V)){const s=i.getStyle();if(ee&&(y=s.layers.filter(M=>!ee.includes(M.id))),te){const M=Object.keys(s.sources).filter(F=>!te.includes(F));z={};for(const F of M)z[F]=s.sources[F]}t(44,V=_),i.setStyle(_,{diff:v}),Ae(se,r=new Set,r),t(41,ae=new Set)}if(o.$$.dirty[0]&49|o.$$.dirty[1]&1152&&G&&i!=null&&i.loaded())for(let s of ue)!r.has(s.id)&&!ae.has(s.id)&&!i.hasImage(s.id)&&we(s);if(o.$$.dirty[0]&32|o.$$.dirty[1]&128&&t(6,l=ue.every(s=>r.has(s.id))),o.$$.dirty[0]&61456&&i){let s={};h!=null&&!Ee(h,i==null?void 0:i.getCenter())&&(s.center=h),A!=null&&!Ee(A,i==null?void 0:i.getZoom())&&(s.zoom=A),L!=null&&!Ee(L,i==null?void 0:i.getBearing())&&(s.bearing=L),b!=null&&!Ee(b,i==null?void 0:i.getPitch())&&(s.pitch=b),Object.keys(s).length&&i.easeTo(s)}o.$$.dirty[0]&65552&&P&&!Ee(P,i==null?void 0:i.getBounds())&&(i==null||i.fitBounds(P)),o.$$.dirty[0]&16|o.$$.dirty[1]&1&&(p?i==null||i.doubleClickZoom.enable():i==null||i.doubleClickZoom.disable())},[G,a,c,K,i,r,l,n,N,se,ce,g,h,A,b,L,P,m,_,v,B,U,I,E,k,T,W,d,ge,q,x,p,$,re,S,fe,Q,ke,ue,D,he,ae,ee,te,V,u,f,Y]}class wo extends J{constructor(e){super(),X(this,e,So,Ao,j,{map:17,mapContainer:1,class:2,style:18,diffStyleUpdates:19,center:12,zoom:13,pitch:14,bearing:15,bounds:16,hash:20,updateHash:21,loaded:0,minZoom:22,maxZoom:23,minPitch:24,maxPitch:25,renderWorldCopies:26,dragPan:27,dragRotate:28,pitchWithRotate:29,antialias:30,zoomOnDoubleClick:31,locale:32,interactive:33,attributionControl:34,cooperativeGestures:35,preserveDrawingBuffer:36,maxBounds:37,images:38,standardControls:3,filterLayers:39,transformRequest:40},null,[-1,-1])}}const vo=o=>({features:o[0]&16,data:o[0]&16,map:o[0]&4,close:o[0]&1}),st=o=>{var e;return{features:o[4],data:((e=o[4])==null?void 0:e[0])??null,map:o[2],close:o[31]}};function at(o){var l;let e,t,n=(((l=o[4])==null?void 0:l.length)||o[3]instanceof de.Marker)&&ct(o);return{c(){e=Le("div"),n&&n.c()},m(i,r){H(i,e,r),n&&n.m(e,null),o[32](e),t=!0},p(i,r){var f;(f=i[4])!=null&&f.length||i[3]instanceof de.Marker?n?(n.p(i,r),r[0]&24&&C(n,1)):(n=ct(i),n.c(),C(n,1),n.m(e,null)):n&&(be(),w(n,1,1,()=>{n=null}),_e())},i(i){t||(C(n),t=!0)},o(i){w(n),t=!1},d(i){i&&R(e),n&&n.d(),o[32](null)}}}function ct(o){let e;const t=o[30].default,n=ze(t,o,o[29],st);return{c(){n&&n.c()},m(l,i){n&&n.m(l,i),e=!0},p(l,i){n&&n.p&&(!e||i[0]&536870933)&&Oe(n,t,l,l[29],e?Ie(t,l[29],i,vo):Te(l[29]),st)},i(l){e||(C(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function Mo(o){let e,t,n=o[9].default&&at(o);return{c(){n&&n.c(),e=Me()},m(l,i){n&&n.m(l,i),H(l,e,i),t=!0},p(l,i){l[9].default?n?(n.p(l,i),i[0]&512&&C(n,1)):(n=at(l),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(be(),w(n,1,1,()=>{n=null}),_e())},i(l){t||(C(n),t=!0)},o(l){w(n),t=!1},d(l){l&&R(e),n&&n.d(l)}}}function Lo(o,e,t){let n,l,i,r,f,u,{$$slots:m={},$$scope:a}=e;const c=Tt(m);let{closeButton:_=void 0}=e,{closeOnClickOutside:v=!0}=e,{closeOnClickInside:h=!1}=e,{closeOnMove:A=!1}=e,{openOn:b="click"}=e,{openIfTopMost:L=!0}=e,{focusAfterOpen:P=!0}=e,{anchor:B=void 0}=e,{offset:U=void 0}=e,{popupClass:G=void 0}=e,{maxWidth:I=void 0}=e,{lngLat:E=void 0}=e,{html:k=void 0}=e,{open:T=!1}=e;const W=Ue(),{map:d,popupTarget:ge,layerEvent:q,layer:x,eventTopMost:p,markerClickManager:$}=Be();Z(o,d,g=>t(2,i=g)),Z(o,ge,g=>t(3,f=g)),Z(o,q,g=>t(28,r=g)),Z(o,x,g=>t(35,u=g));const re=["click","dblclick","contextmenu"];let S,fe=!1,Q;function ke(){if(!S)return;let g=S.getElement();!g||g===Q||(Q=g,b==="hover"&&(Q.style.pointerEvents="none"),Q.addEventListener("mouseenter",()=>{t(24,fe=!0)},{passive:!0}),Q.addEventListener("mouseleave",()=>{t(24,fe=!1)},{passive:!0}),Q.addEventListener("click",()=>{h&&t(0,T=!1)},{passive:!0}))}bt(()=>{if(i)return i.on("click",te),i.on("contextmenu",te),$.add(y),typeof f=="string"&&(i.on("click",f,O),i.on("dblclick",f,O),i.on("contextmenu",f,O),i.on("mousemove",f,ee),i.on("mouseleave",f,we),i.on("touchstart",f,se),i.on("touchend",f,ae)),()=>{i!=null&&i.loaded()&&(S==null||S.remove(),i.off("click",te),i.off("contextmenu",te),$.remove(y),f instanceof de.Marker?f.getPopup()===S&&f.setPopup(void 0):typeof f=="string"&&(i.off("click",f,O),i.off("dblclick",f,O),i.off("contextmenu",f,O),i.off("mousemove",f,ee),i.off("mouseleave",f,we),i.off("touchstart",f,se),i.off("touchend",f,ae)))}});function ue(g){return L?!("marker"in g)&&!Wt(g)&&p(g)!==u:!1}let K=null,D="normal";function he(g){"layerType"in g&&g.layerType==="deckgl"?(t(10,E=g.coordinate),t(4,K=g.object?[g.object]:null)):(t(10,E=g.lngLat),t(4,K=g.features??[]))}function O(g){g.type!==b||ue(g)||(he(g),setTimeout(()=>t(0,T=!0)))}let N=null;function se(g){N=g.point}function ae(g){if(!N||b!=="hover")return;let Y=N.dist(g.point);N=null,Y<3&&(t(10,E=g.lngLat),t(4,K=g.features??[]),S.isOpen()?t(25,D="justOpened"):(t(25,D="opening"),t(0,T=!0)))}function we(g){b!=="hover"||N||D!=="normal"||(t(0,T=!1),t(4,K=null))}function ee(g){if(!(b!=="hover"||N||D!=="normal")){if(ue(g)){t(0,T=!1),t(4,K=null);return}t(0,T=!0),t(4,K=g.features??[]),t(10,E=g.lngLat)}}function te(g){if(D==="justOpened"){t(25,D="normal");return}if(!v)return;let Y=[Q,f instanceof de.Marker?f==null?void 0:f.getElement():null];T&&S.isOpen()&&!Y.some(s=>s==null?void 0:s.contains(g.originalEvent.target))&&(g.type==="contextmenu"&&b==="contextmenu"||g.type!=="contextmenu")&&t(0,T=!1)}function y(g){v&&T&&S.isOpen()&&g.marker!==f&&t(0,T=!1)}Se(()=>{i&&(S!=null&&S.isOpen())&&S.remove()});let z;const ce=()=>t(0,T=!1);function V(g){Pe[g?"unshift":"push"](()=>{z=g,t(1,z)})}return o.$$set=g=>{"closeButton"in g&&t(11,_=g.closeButton),"closeOnClickOutside"in g&&t(12,v=g.closeOnClickOutside),"closeOnClickInside"in g&&t(13,h=g.closeOnClickInside),"closeOnMove"in g&&t(14,A=g.closeOnMove),"openOn"in g&&t(15,b=g.openOn),"openIfTopMost"in g&&t(16,L=g.openIfTopMost),"focusAfterOpen"in g&&t(17,P=g.focusAfterOpen),"anchor"in g&&t(18,B=g.anchor),"offset"in g&&t(19,U=g.offset),"popupClass"in g&&t(20,G=g.popupClass),"maxWidth"in g&&t(21,I=g.maxWidth),"lngLat"in g&&t(10,E=g.lngLat),"html"in g&&t(22,k=g.html),"open"in g&&t(0,T=g.open),"$$scope"in g&&t(29,a=g.$$scope)},o.$$.update=()=>{if(o.$$.dirty[0]&14336&&t(27,n=_??(!v&&!h)),o.$$.dirty[0]&146685952&&(S||(t(23,S=new de.Popup({closeButton:n,closeOnClick:!1,closeOnMove:A,focusAfterOpen:P,maxWidth:I,className:G,anchor:B,offset:U})),Q=S.getElement(),S.on("open",()=>{t(0,T=!0),ke(),W("open",S)}),S.on("close",()=>{t(0,T=!1),W("close",S)}),S.on("hover",()=>{W("hover",S)}))),o.$$.dirty[0]&8421384&&S&&f instanceof de.Marker&&(b==="click"?f.setPopup(S):f.getPopup()===S&&f.setPopup(void 0)),o.$$.dirty[0]&268468224&&re.includes(b)&&(r==null?void 0:r.type)===b&&(O(r),Ae(q,r=null,r)),o.$$.dirty[0]&268468224&&t(26,l=b==="hover"&&((r==null?void 0:r.type)==="mousemove"||(r==null?void 0:r.type)==="mouseenter")),o.$$.dirty[0]&352354304&&b==="hover"&&q&&(l&&r&&he(r),t(0,T=(l||fe)??!1)),o.$$.dirty[0]&12582914&&(z?S.setDOMContent(z):k&&S.setHTML(k)),o.$$.dirty[0]&8389632&&E&&S.setLngLat(E),o.$$.dirty[0]&41943045&&i){let g=S.isOpen();T&&!g?(S.addTo(i),D==="opening"&&t(25,D="justOpened")):!T&&g&&S.remove()}},[T,z,i,f,K,d,ge,q,x,c,E,_,v,h,A,b,L,P,B,U,G,I,k,S,fe,D,l,n,r,a,m,ce,V]}class po extends J{constructor(e){super(),X(this,e,Lo,Mo,j,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}function zo(o){let e,t,n,l;const i=[To,Oo],r=[];function f(u,m){return u[0]?0:1}return e=f(o),t=r[e]=i[e](o),{c(){t.c(),n=Me()},m(u,m){r[e].m(u,m),H(u,n,m),l=!0},p(u,m){t.p(u,m)},i(u){l||(C(t),l=!0)},o(u){w(t),l=!1},d(u){u&&R(n),r[e].d(u)}}}function Oo(o){let e,t;return e=new Gt({props:{errorMessage:"You shouldn't be able to view this app without being logged in!"}}),{c(){ne(e.$$.fragment)},m(n,l){ie(e,n,l),t=!0},p:ve,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){le(e,n)}}}function To(o){let e;return{c(){e=Le("p"),e.textContent=`Logged in as ${o[0]}`},m(t,n){H(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&R(e)}}}function Io(o){let e=yt()=="Private (development)",t,n,l=e&&zo(o);return{c(){l&&l.c(),t=Me()},m(i,r){l&&l.m(i,r),H(i,t,r),n=!0},p(i,[r]){e&&l.p(i,r)},i(i){n||(C(l),n=!0)},o(i){w(l),n=!1},d(i){i&&R(t),l&&l.d(i)}}}function Bo(o){return[It.get("email")]}class $o extends J{constructor(e){super(),X(this,e,Bo,Io,j,{})}}const Eo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAQAAAC1QeVaAAAAAmJLR0QA/4ePzL8AAACgSURBVBjTY2D4D4cvGHoY2BlQwH8U2I4pCQKsDHFg3VglGRjEgazvmJLlQNjIcAnIOobbztcM5piSHUBYzxDNwMfAgMtOGKjHJpnJ8IwhhcGFYREDM6ZkCMMqoPHXGC4zBKEa5cPwBKioAAiXMIQz/GZ4yuCFkHzC4MjgxPCNoZaBjeE+kOXEcB0h+RjIdWG4AGU7w9lg4A0UesBgj8oGAP6nSFElh0b7AAAAAElFTkSuQmCC",Po="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAm0lEQVRIS+2U0Q2AIAxEYQM30Q3UDXQy3UhHkE0cweuHHxKTXpuQaALJ/cE9eoXGUHjFwv6hAtSEPxFRh2su0Ayd6pWzDUwFO8700AGNVggDaGAqkNYDYQBStBvCAtwQC8AF8QA2kORlJWjQmm4BSB9M5lIyC3CZswC3OQu4PxqVef7TmYikoSs0aQ19GyMMwDp+HvsrQI3v/xFduXoiGbi1DtQAAAAASUVORK5CYII=",Go="/atip/new-cycleway-colours/assets/google_on_non_white_hdpi-368415f0.png",Ho="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC";function Ro(o){let e,t,n,l;return{c(){e=Le("div"),t=new Et(!1),n=Bt(` |
  `),l=Le("a"),l.textContent="MapLibre",t.a=n,ye(l,"href","https://maplibre.org/"),ye(l,"target","_blank"),ye(e,"class","svelte-1yeu1m4")},m(i,r){H(i,e,r),t.m(o[0],e),Xe(e,n),Xe(e,l)},p(i,[r]){r&1&&t.p(i[0])},i:ve,o:ve,d(i){i&&R(e)}}}function Fo(o,e,t){let{attribution:n}=e;return o.$$set=l=>{"attribution"in l&&t(0,n=l.attribution)},[n]}class Zo extends J{constructor(e){super(),X(this,e,Fo,Ro,j,{attribution:0})}}function mt(o){let e,t,n,l;function i(u){o[9](u)}function r(u){o[10](u)}let f={style:o[4],bounds:o[0],hash:!0,images:[{id:"chevron",url:Po},{id:"cycle_parking",url:Eo},{id:"railway_station",url:Ho}],attributionControl:!1,$$slots:{default:[Uo]},$$scope:{ctx:o}};return o[3]!==void 0&&(f.loaded=o[3]),o[2]!==void 0&&(f.map=o[2]),e=new wo({props:f}),Pe.push(()=>He(e,"loaded",i)),Pe.push(()=>He(e,"map",r)),e.$on("error",No),{c(){ne(e.$$.fragment)},m(u,m){ie(e,u,m),l=!0},p(u,m){const a={};m&16&&(a.style=u[4]),m&1&&(a.bounds=u[0]),m&2146&&(a.$$scope={dirty:m,ctx:u}),!t&&m&8&&(t=!0,a.loaded=u[3],Re(()=>t=!1)),!n&&m&4&&(n=!0,a.map=u[2],Re(()=>n=!1)),e.$set(a)},i(u){l||(C(e.$$.fragment,u),l=!0)},o(u){w(e.$$.fragment,u),l=!1},d(u){le(e,u)}}}function dt(o){let e,t,n,l,i,r,f,u,m,a;e=new co({}),e.$on("zoomend",o[7]),e.$on("moveend",o[7]),n=new Zo({props:{attribution:o[6]}}),i=new Ct({}),f=new kt({props:{position:"bottom-left",visualizePitch:!0}});let c=o[1]=="google"&&gt();const _=o[8].default,v=ze(_,o,o[11],null);return{c(){ne(e.$$.fragment),t=Ce(),ne(n.$$.fragment),l=Ce(),ne(i.$$.fragment),r=Ce(),ne(f.$$.fragment),u=Ce(),c&&c.c(),m=Ce(),v&&v.c()},m(h,A){ie(e,h,A),H(h,t,A),ie(n,h,A),H(h,l,A),ie(i,h,A),H(h,r,A),ie(f,h,A),H(h,u,A),c&&c.m(h,A),H(h,m,A),v&&v.m(h,A),a=!0},p(h,A){const b={};A&64&&(b.attribution=h[6]),n.$set(b),h[1]=="google"?c||(c=gt(),c.c(),c.m(m.parentNode,m)):c&&(c.d(1),c=null),v&&v.p&&(!a||A&2048)&&Oe(v,_,h,h[11],a?Ie(_,h[11],A,null):Te(h[11]),null)},i(h){a||(C(e.$$.fragment,h),C(n.$$.fragment,h),C(i.$$.fragment,h),C(f.$$.fragment,h),C(v,h),a=!0)},o(h){w(e.$$.fragment,h),w(n.$$.fragment,h),w(i.$$.fragment,h),w(f.$$.fragment,h),w(v,h),a=!1},d(h){h&&(R(t),R(l),R(r),R(u),R(m)),le(e,h),le(n,h),le(i,h),le(f,h),c&&c.d(h),v&&v.d(h)}}}function gt(o){let e,t;return{c(){e=Le("img"),Pt(e.src,t=Go)||ye(e,"src",t),ye(e,"alt","Google logo"),ye(e,"class","svelte-81xaz8")},m(n,l){H(n,e,l)},d(n){n&&R(e)}}}function Uo(o){let e,t,n=o[5]&&dt(o);return{c(){n&&n.c(),e=Me()},m(l,i){n&&n.m(l,i),H(l,e,i),t=!0},p(l,i){l[5]?n?(n.p(l,i),i&32&&C(n,1)):(n=dt(l),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(be(),w(n,1,1,()=>{n=null}),_e())},i(l){t||(C(n),t=!0)},o(l){w(n),t=!1},d(l){l&&R(e),n&&n.d(l)}}}function Do(o){let e,t,n=o[4]&&mt(o);return{c(){e=Le("div"),n&&n.c(),ye(e,"class","map svelte-81xaz8")},m(l,i){H(l,e,i),n&&n.m(e,null),t=!0},p(l,[i]){l[4]?n?(n.p(l,i),i&16&&C(n,1)):(n=mt(l),n.c(),C(n,1),n.m(e,null)):n&&(be(),w(n,1,1,()=>{n=null}),_e())},i(l){t||(C(n),t=!0)},o(l){w(n),t=!1},d(l){l&&R(e),n&&n.d()}}}function No(o){console.error(`MapLibre error: ${o.detail.error}`)}function jo(o,e,t){let n,l;Z(o,xe,b=>t(5,n=b)),Z(o,Fe,b=>t(6,l=b));let{$$slots:i={},$$scope:r}=e,{style:f}=e,{startBounds:u=void 0}=e,m=null,a,c=!1;We("setCamera",!window.location.hash),window.location.hash&&(u=void 0),bt(async()=>{t(4,m=await pe(f))});async function _(b){t(4,m=await pe(f));let L=new URL(window.location.href);L.searchParams.set("style",b),window.history.replaceState(null,"",L.toString())}async function v(){f=="google"&&n&&Ae(Fe,l=await Rt(n),l)}function h(b){c=b,t(3,c)}function A(b){a=b,t(2,a)}return o.$$set=b=>{"style"in b&&t(1,f=b.style),"startBounds"in b&&t(0,u=b.startBounds),"$$scope"in b&&t(11,r=b.$$scope)},o.$$.update=()=>{o.$$.dirty&12&&c&&xe.set(a),o.$$.dirty&2&&_(f)},[u,f,a,c,m,n,l,v,i,h,A,r]}class en extends J{constructor(e){super(),X(this,e,jo,Do,j,{style:1,startBounds:0})}}export{Jo as F,Xo as G,$o as L,en as M,po as P,xo as a,to as b,Ze as c,_t as d,co as e,Ht as f,De as g,Yo as h,Po as i,Eo as j,Ho as k,Vo as l,qo as m,oo as r,Nt as u};
