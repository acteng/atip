import{an as xn,S as V,i as K,s as q,b as H,c as z,f as w,d as T,m as b,h as m,k as G,t as g,l as d,o as h,p as v,N as X,A as ee,ao as Kr,T as at,q as Xt,F as qr,a as Rt,e as P,g as W,u as ir,v as Yt,r as y,G as me,aP as de,Y as Ce,C as _e,w as te,aO as B,j as E,H as He,J as Fe,I as Ot,x as he,n as ge,Q as We,aQ as gt,P as Jt,aR as Fn,_ as Zr,Z as dt,E as Xr,a2 as Qt,aH as Yr,aI as Jr,aJ as Qr,aK as en,R as Bn,aS as lr,B as jn,aT as ar,a5 as tn,y as Rn,aE as Un}from"./MapLibreMap.svelte_svelte_type_style_lang-02c71d8f.js";import{e as Tt,C as xe,b as bt,d as Q,a as Hn,S as Wn,L as zn,M as Gn}from"./StreetViewController-56653a71.js";import{L as Vn,d as ur,c as rn,C as we,H as ne,B as Kn,Z as qn,I as Zn}from"./schemas-77f32b0a.js";import{I as Y,F as Xn}from"./InteractiveLayer-9dc975d1.js";const Yn={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var ue=Uint8Array,Xe=Uint16Array,nn=Uint32Array,on=new ue([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),sn=new ue([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Jn=new ue([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ln=function(t,e){for(var r=new Xe(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new nn(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},an=ln(on,2),un=an[0],Qn=an[1];un[28]=258,Qn[258]=28;var eo=ln(sn,0),to=eo[0],Ut=new Xe(32768);for(var Z=0;Z<32768;++Z){var je=(Z&43690)>>>1|(Z&21845)<<1;je=(je&52428)>>>2|(je&13107)<<2,je=(je&61680)>>>4|(je&3855)<<4,Ut[Z]=((je&65280)>>>8|(je&255)<<8)>>>1}var mt=function(t,e,r){for(var n=t.length,o=0,s=new Xe(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new Xe(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new Xe(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var u=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)f[Ut[c]>>>i]=u}else for(f=new Xe(n),o=0;o<n;++o)t[o]&&(f[o]=Ut[l[t[o]-1]++]>>>15-t[o]);return f},vt=new ue(288);for(var Z=0;Z<144;++Z)vt[Z]=8;for(var Z=144;Z<256;++Z)vt[Z]=9;for(var Z=256;Z<280;++Z)vt[Z]=7;for(var Z=280;Z<288;++Z)vt[Z]=8;var fn=new ue(32);for(var Z=0;Z<32;++Z)fn[Z]=5;var ro=mt(vt,9,1),no=mt(fn,5,1),Et=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},be=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Pt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},oo=function(t){return(t+7)/8|0},er=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?Xe:t.BYTES_PER_ELEMENT==4?nn:ue)(r-e);return n.set(t.subarray(e,r)),n},so=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ke=function(t,e,r){var n=new Error(e||so[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ke),!r)throw n;return n},io=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new ue(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new ue(n*3));var l=function(rt){var nt=e.length;if(rt>nt){var ct=new ue(Math.max(nt*2,rt));ct.set(e),e=ct}},f=r.f||0,i=r.p||0,u=r.b||0,a=r.l,c=r.d,p=r.m,$=r.n,_=n*8;do{if(!a){f=be(t,i,1);var C=be(t,i+1,3);if(i+=3,C)if(C==1)a=ro,c=no,p=9,$=5;else if(C==2){var M=be(t,i,31)+257,k=be(t,i+10,15)+4,D=M+be(t,i+5,31)+1;i+=14;for(var x=new ue(D),I=new ue(19),A=0;A<k;++A)I[Jn[A]]=be(t,i+A*3,7);i+=k*3;for(var F=Et(I),N=(1<<F)-1,j=mt(I,F,1),A=0;A<D;){var J=j[be(t,i,N)];i+=J&15;var S=J>>>4;if(S<16)x[A++]=S;else{var re=0,Le=0;for(S==16?(Le=3+be(t,i,3),i+=2,re=x[A-1]):S==17?(Le=3+be(t,i,7),i+=3):S==18&&(Le=11+be(t,i,127),i+=7);Le--;)x[A++]=re}}var pe=x.subarray(0,M),oe=x.subarray(M);p=Et(pe),$=Et(oe),a=mt(pe,p,1),c=mt(oe,$,1)}else ke(1);else{var S=oo(i)+4,L=t[S-4]|t[S-3]<<8,O=S+L;if(O>n){s&&ke(0);break}o&&l(u+L),e.set(t.subarray(S,O),u),r.b=u+=L,r.p=i=O*8,r.f=f;continue}if(i>_){s&&ke(0);break}}o&&l(u+131072);for(var ze=(1<<p)-1,le=(1<<$)-1,ft=i;;ft=i){var re=a[Pt(t,i)&ze],Be=re>>>4;if(i+=re&15,i>_){s&&ke(0);break}if(re||ke(2),Be<256)e[u++]=Be;else if(Be==256){ft=i,a=null;break}else{var Qe=Be-254;if(Be>264){var A=Be-257,$e=on[A];Qe=be(t,i,(1<<$e)-1)+un[A],i+=$e}var et=c[Pt(t,i)&le],Ie=et>>>4;et||ke(3),i+=et&15;var oe=to[Ie];if(Ie>3){var $e=sn[Ie];oe+=Pt(t,i)&(1<<$e)-1,i+=$e}if(i>_){s&&ke(0);break}o&&l(u+131072);for(var tt=u+Qe;u<tt;u+=4)e[u]=e[u-oe],e[u+1]=e[u+1-oe],e[u+2]=e[u+2-oe],e[u+3]=e[u+3-oe];u=tt}}r.l=a,r.p=ft,r.b=u,r.f=f,a&&(f=1,r.m=p,r.d=c,r.n=$)}while(!f);return u==e.length?e:er(e,0,u)},lo=new ue(0),Pe=function(t,e){return t[e]|t[e+1]<<8},Se=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Nt=function(t,e){return Se(t,e)+Se(t,e+4)*4294967296};function ao(t,e){return io(t,e)}var Ht=typeof TextDecoder<"u"&&new TextDecoder,uo=0;try{Ht.decode(lo,{stream:!0}),uo=1}catch{}var fo=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,er(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function cn(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Ht)return Ht.decode(t);var o=fo(t),s=o[0],l=o[1];return l.length&&ke(8),s}}var co=function(t,e){return e+30+Pe(t,e+26)+Pe(t,e+28)},po=function(t,e,r){var n=Pe(t,e+28),o=cn(t.subarray(e+46,e+46+n),!(Pe(t,e+8)&2048)),s=e+46+n,l=Se(t,e+20),f=r&&l==4294967295?$o(t,s):[l,Se(t,e+24),Se(t,e+42)],i=f[0],u=f[1],a=f[2];return[Pe(t,e+10),i,u,o,s+Pe(t,e+30)+Pe(t,e+32),a]},$o=function(t,e){for(;Pe(t,e)!=1;e+=4+Pe(t,e+2));return[Nt(t,e+12),Nt(t,e+4),Nt(t,e+20)]};function mo(t,e){for(var r={},n=t.length-22;Se(t,n)!=101010256;--n)(!n||t.length-n>65558)&&ke(13);var o=Pe(t,n+8);if(!o)return{};var s=Se(t,n+16),l=s==4294967295||o==65535;if(l){var f=Se(t,n-12);l=Se(t,f)==101075792,l&&(o=Se(t,f+32),s=Se(t,f+48))}for(var i=e&&e.filter,u=0;u<o;++u){var a=po(t,s,l),c=a[0],p=a[1],$=a[2],_=a[3],C=a[4],S=a[5],L=co(t,S);s=C,(!i||i({name:_,size:p,originalSize:$,compression:c}))&&(c?c==8?r[_]=ao(t.subarray(L,L+p),new ue($)):ke(14,"unknown compression type "+c):r[_]=er(t,L,L+p))}return r}function ho(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(It):It(t)}function It(t){var e=new Uint8Array(t),r=mo(e);return Promise.resolve(go(r))}function go(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=cn(t[o])}return e}function Ne(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&Je(n)===e)return n;r++}}function yt(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&Je(o)===e&&r.push(o),n++}return r}function At(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&Je(o)===e&&r(o,n):r(o,n),n++}}function _o(t,e,r){var n=[];return At(t,e,function(o,s){n.push(r(o,s))}),n}var wo=/.+\:/;function Je(t){return t.tagName.replace(wo,"")}function pn(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+Je(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=pn(t.childNodes[n]),n++;return e+="</"+Je(t)+">",e}function bo(t){var e=t.documentElement,r=Ne(e,"sheetData"),n=[];return At(r,"row",function(o){At(o,"c",function(s){n.push(s)})}),n}function vo(t,e){return Ne(e,"v")}function yo(t,e){if(e.firstChild&&Je(e.firstChild)==="is"&&e.firstChild.firstChild&&Je(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function ko(t){var e=t.documentElement,r=Ne(e,"dimension");if(r)return r.getAttribute("ref")}function So(t){var e=t.documentElement,r=Ne(e,"cellStyleXfs");return r?yt(r,"xf"):[]}function Co(t){var e=t.documentElement,r=Ne(e,"cellXfs");return r?yt(r,"xf"):[]}function Lo(t){var e=t.documentElement,r=Ne(e,"numFmts");return r?yt(r,"numFmt"):[]}function Oo(t){var e=t.documentElement;return _o(e,"si",function(r){var n=Ne(r,"t");if(n)return n.textContent;var o="";return At(r,"r",function(s){o+=Ne(s,"t").textContent}),o})}function To(t){var e=t.documentElement;return Ne(e,"workbookPr")}function Ao(t){var e=t.documentElement;return yt(e,"Relationship")}function Do(t){var e=t.documentElement,r=Ne(e,"sheets");return yt(r,"sheet")}function Eo(t,e){var r=e.createDocument(t),n={},o=To(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(f){f.getAttribute("name")&&n.sheets.push({id:f.getAttribute("sheetId"),name:f.getAttribute("name"),relationId:f.getAttribute("r:id")})};return Do(r).forEach(s),n}function Po(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var f=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=Mt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=Mt(f);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=Mt(f);break}};return Ao(r).forEach(o),n}function Mt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function fr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function cr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fr(Object(r),!0).forEach(function(n){No(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function No(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Io(t,e){if(!t)return{};var r=e.createDocument(t),n=So(r).map(xt),o=Lo(r).map(Mo).reduce(function(l,f){return l[f.id]=f,l},[]),s=function(f){return f.hasAttribute("xfId")?cr(cr({},n[f.xfId]),xt(f,o)):xt(f,o)};return Co(r).map(s)}function Mo(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function xt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function xo(t,e){return t?Oo(e.createDocument(t)):[]}function $n(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function Fo(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Bo(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bo(t,e){if(t){if(typeof t=="string")return pr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pr(t,e)}}function pr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jo(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(Ro.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&Wo(o.numberFormat.template))return!0}}var Ro=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],Uo=/^\[\$-414\]/,Ho=/;@$/;function Wo(t){t=t.toLowerCase(),t=t.replace(Uo,""),t=t.replace(Ho,"");for(var e=t.split(/\W+/),r=Fo(e),n;!(n=r()).done;){var o=n.value;if(zo.indexOf(o)<0)return!1}return!0}var zo=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function Go(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,l=r.styles,f=r.values,i=r.properties,u=r.options;switch(e||(e="n"),e){case"str":t=Ft(t,u);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Ft(t,u);break;case"s":var a=Number(t);if(isNaN(a))throw new Error('Invalid "shared" string index: '.concat(t));if(a>=f.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=f[a],t=Ft(t,u);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=Vo(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,jo(t,s(),l,u)&&(t=$n(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function Vo(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Ft(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var Ko=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function qo(t){var e=function(u,a){return u-a},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],l=n[0],f=n[n.length-1];return[{row:o,column:l},{row:s,column:f}]}function Zo(t){for(var e=0,r=0;r<t.length;)e*=26,e+=Ko.indexOf(t[r]),r++;return e}function mn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),Zo(t[0].trim())]}function Xo(t,e,r,n,o,s,l){var f=mn(t.getAttribute("r")),i=vo(e,t),u=i&&i.textContent,a;return t.hasAttribute("t")&&(a=t.getAttribute("t")),{row:f[0],column:f[1],value:Go(u,a,{getInlineStringValue:function(){return yo(e,t)},getInlineStringXml:function(){return pn(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function Yo(t,e,r,n,o,s){var l=bo(t);return l.length===0?[]:l.map(function(f){return Xo(f,t,e,r,n,o,s)})}function Jo(t,e){return rs(t)||ts(t,e)||es(t,e)||Qo()}function Qo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function es(t,e){if(t){if(typeof t=="string")return $r(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $r(t,e)}}function $r(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ts(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function rs(t){if(Array.isArray(t))return t}function ns(t){var e=ko(t);if(e)return e=e.split(":").map(mn).map(function(r){var n=Jo(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function os(t,e,r,n,o,s){var l=e.createDocument(t),f=Yo(l,e,r,n,o,s),i=ns(l)||qo(f);return{cells:f,dimensions:i}}function ss(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=is(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function is(t,e){if(t){if(typeof t=="string")return mr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mr(t,e)}}function mr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ls(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=t.length-1;l>=0;){for(var f=!0,i=ss(t[l]),u;!(u=i()).done;){var a=u.value;if(o(a)!==null){f=!1;break}}if(f)t.splice(l,1),r&&r.splice(l,1);else if(s)break;l--}return t}function as(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=us(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function us(t,e){if(t){if(typeof t=="string")return hr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hr(t,e)}}function hr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var l=!0,f=as(t),i;!(i=f()).done;){var u=i.value;if(n(u[s])!==null){l=!1;break}}if(l)for(var a=0;a<t.length;)t[a].splice(s,1),a++;else if(o)break;s--}return t}function cs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=hn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ps(t,e){return hs(t)||ms(t,e)||hn(t,e)||$s()}function $s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hn(t,e){if(t){if(typeof t=="string")return gr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gr(t,e)}}function gr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ms(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function hs(t){if(Array.isArray(t))return t}function gs(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=ps(r,2);o[0];for(var s=o[1],l=s.column,f=s.row,i=new Array(f),u=0;u<f;){i[u]=new Array(l);for(var a=0;a<l;)i[u][a]=null,a++;u++}for(var c=cs(n),p;!(p=c()).done;){var $=p.value,_=$.row-1,C=$.column-1;C<l&&_<f&&(i[_][C]=$.value)}var S=e.rowMap;if(S)for(var L=0;L<i.length;)S[L]=L,L++;return i=ls(fs(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:S}),e.transformData&&(i=e.transformData(i)),i}function ds(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=_s(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _s(t,e){if(t){if(typeof t=="string")return dr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dr(t,e)}}function dr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ws(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_r(Object(r),!0).forEach(function(n){bs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=ws({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=Po(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?xo(n(o.sharedStrings),e):[],l=o.styles?Io(n(o.styles),e):{},f=Eo(n("xl/workbook.xml"),e);if(r.getSheets)return f.sheets.map(function(c){var p=c.name;return{name:p}});var i=ys(r.sheet,f.sheets);if(!i||!o.sheets[i])throw ks(r.sheet,f.sheets);var u=os(n(o.sheets[i]),e,s,l,f,r),a=gs(u,r);return r.properties?{data:a,properties:f}:a}function ys(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=ds(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function ks(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function Wt(t){"@babel/helpers - typeof";return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(t)}function wr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ss(t,e,r){return e&&wr(t.prototype,e),r&&wr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ls(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}function Os(t){var e=gn();return function(){var n=wt(t),o;if(e){var s=wt(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Ts(this,o)}}function Ts(t,e){if(e&&(Wt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return As(t)}function As(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zt(t){var e=typeof Map=="function"?new Map:void 0;return zt=function(n){if(n===null||!Ds(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Ct(n,arguments,wt(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),_t(o,n)},zt(t)}function Ct(t,e,r){return gn()?Ct=Reflect.construct:Ct=function(o,s,l){var f=[null];f.push.apply(f,s);var i=Function.bind.apply(o,f),u=new i;return l&&_t(u,l.prototype),u},Ct.apply(null,arguments)}function gn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ds(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function _t(t,e){return _t=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},_t(t,e)}function wt(t){return wt=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},wt(t)}var fe=function(t){Ls(r,t);var e=Os(r);function r(n){var o;return Cs(this,r),o=e.call(this,"invalid"),o.reason=n,o}return Ss(r)}(zt(Error));function Es(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new fe("not_a_number")}if(typeof t!="number")throw new fe("not_a_number");if(isNaN(t))throw new fe("invalid_number");if(!isFinite(t))throw new fe("out_of_bounds");return t}function Ps(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new fe("invalid_number");if(!isFinite(t))throw new fe("out_of_bounds");return String(t)}throw new fe("not_a_string")}function Ns(t){if(typeof t=="boolean")return t;throw new fe("not_a_boolean")}function Is(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new fe("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new fe("invalid_number");if(!isFinite(t))throw new fe("out_of_bounds");var n=$n(t,r);if(isNaN(n.valueOf()))throw new fe("out_of_bounds");return n}throw new fe("not_a_date")}function Ms(t,e){return Bs(t)||Fs(t,e)||dn(t,e)||xs()}function xs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,l,f;try{for(r=r.call(t);!(o=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,f=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw f}}return n}}function Bs(t){if(Array.isArray(t))return t}function Gt(t){"@babel/helpers - typeof";return Gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(t)}function js(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=dn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dn(t,e){if(t){if(typeof t=="string")return br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(t,e)}}function br(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function yr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vr(Object(r),!0).forEach(function(n){Rs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Rs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kr={isColumnOriented:!1};function Us(t,e,r){r?r=yr(yr({},kr),r):r=kr;var n=r,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;Gs(e),o&&(t=zs(t));for(var f=t[0],i=[],u=[],a=1;a<t.length;a++){var c=_n(e,t[a],a,f,u,r);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=js(u),$;!($=p()).done;){var _=$.value;_.row=s[_.row-1]+1}return{rows:i,errors:u}}function _n(t,e,r,n,o,s){for(var l={},f=!0,i=function(){var p=a[u],$=t[p],_=Gt($.type)==="object"&&!Array.isArray($.type),C=e[n.indexOf(p)];C===void 0&&(C=null);var S=void 0,L=void 0,O=void 0;if(_)S=_n($.type,e,r,n,o,s);else if(C===null)S=null;else if(Array.isArray($.type)){var M=!1,k=Ws(C).map(function(x){var I=Sr(x,$,s);return I.error&&(S=x,L=I.error,O=I.reason),I.value!==null&&(M=!0),I.value});L||(S=M?k:null)}else{var D=Sr(C,$,s);L=D.error,O=D.reason,S=L?C:D.value}!L&&S===null&&$.required&&(L="required"),L?(L={error:L,row:r+1,column:p,value:S},O&&(L.reason=O),$.type&&(L.type=$.type),o.push(L)):(f&&S!==null&&(f=!1),(S!==null||s.includeNullValues)&&(l[$.prop]=S))},u=0,a=Object.keys(t);u<a.length;u++)i();return f?null:l}function Sr(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=st(t,e.parse):e.type?n=Hs(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function st(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function Hs(t,e,r){switch(e){case String:return st(t,Ps);case Number:return st(t,Es);case Date:return st(t,function(n){return Is(n,{properties:r.properties})});case Boolean:return st(t,Ns);default:if(typeof e=="function")return st(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function wn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var l=wn(t,'"',r+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function Ws(t){for(var e=[],r=0;r<t.length;){var n=wn(t,",",r),o=Ms(n,2),s=o[0],l=o[1];r+=l+1,e.push(s.trim())}return e}var zs=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function Gs(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function Vt(t){"@babel/helpers - typeof";return Vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vt(t)}function bn(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],l=void 0;Vt(s)==="object"&&(s=Object.keys(t[o])[0],l=bn(t[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var Vs=["schema","map"];function Cr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function St(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cr(Object(r),!0).forEach(function(n){Ks(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ks(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qs(t,e){if(t==null)return{};var r=Zs(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Zs(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Xs(t,e,r){var n=r.schema,o=r.map,s=qs(r,Vs);!n&&o&&(n=bn(o));var l=vs(t,e,St(St({},s),{},{properties:n||s.properties}));return n?Us(l.data,n,St(St({},s),{},{properties:l.properties})):l}function Ys(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ho(t).then(function(r){return Xs(r,Yn,e)})}function Js(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function Qs(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await Ys(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=xn(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const U={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},vn=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function ei(t){let e,r,n,o,s;function l(i){t[3](i)}let f={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(f.value=t[0]),e=new Tt({props:f}),H.push(()=>z(e,"value",l)),e.$on("change",t[2]),o=new Vn({props:{rows:t[1]}}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};!r&&u&1&&(r=!0,a.value=i[0],G(()=>r=!1)),e.$set(a);const c={};u&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}function ti(t,e,r){let n;X(t,ee,i=>r(4,n=i));let o="interventionType",s=ur("v1");function l(){let i;o=="interventionType"?(i=rn("v1"),r(1,s=ur("v1"))):(i=Kr(["get","funding_programme"],{ATF2:U.atf2,ATF3:U.atf3,ATF4:U.atf4},"grey"),r(1,s=[["ATF2",U.atf2],["ATF3",U.atf3],["ATF4",U.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function f(i){o=i,r(0,o)}return[o,s,l,f]}class ri extends V{constructor(e){super(),K(this,e,ti,ei,q,{})}}function ni(t){let e;return{c(){e=y("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function oi(t){let e,r,n,o,s,l;return n=new Rt({props:{$$slots:{default:[ni]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=P("input"),r=T(),w(n.$$.fragment),W(e,"type","text"),W(e,"class","govuk-input govuk-input--width-10"),W(e,"id","filterText")},m(f,i){m(f,e,i),ir(e,t[0]),m(f,r,i),b(n,f,i),o=!0,s||(l=Yt(e,"input",t[12]),s=!0)},p(f,i){i&1&&e.value!==f[0]&&ir(e,f[0]);const u={};i&131072&&(u.$$scope={dirty:i,ctx:f}),n.$set(u)},i(f){o||(g(n.$$.fragment,f),o=!0)},o(f){d(n.$$.fragment,f),o=!1},d(f){f&&(h(e),h(r)),v(n,f),s=!1,l()}}}function si(t){let e,r,n,o,s,l,f,i,u,a;function c(C){t[10](C)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Tt({props:p}),H.push(()=>z(e,"value",c));function $(C){t[11](C)}let _={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(_.value=t[3]),o=new Tt({props:_}),H.push(()=>z(o,"value",$)),f=new qr({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[oi]},$$scope:{ctx:t}}}),u=new ri({}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment),l=T(),w(f.$$.fragment),i=T(),w(u.$$.fragment)},m(C,S){b(e,C,S),m(C,n,S),b(o,C,S),m(C,l,S),b(f,C,S),m(C,i,S),b(u,C,S),a=!0},p(C,S){const L={};S&32&&(L.choices=C[5]),!r&&S&4&&(r=!0,L.value=C[2],G(()=>r=!1)),e.$set(L);const O={};S&64&&(O.choices=C[6]),!s&&S&8&&(s=!0,O.value=C[3],G(()=>s=!1)),o.$set(O);const M={};S&131073&&(M.$$scope={dirty:S,ctx:C}),f.$set(M)},i(C){a||(g(e.$$.fragment,C),g(o.$$.fragment,C),g(f.$$.fragment,C),g(u.$$.fragment,C),a=!0)},o(C){d(e.$$.fragment,C),d(o.$$.fragment,C),d(f.$$.fragment,C),d(u.$$.fragment,C),a=!1},d(C){C&&(h(n),h(l),h(i)),v(e,C),v(o,C),v(f,C),v(u,C)}}}function ii(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",l,f,i=t[7].area.toLocaleString()+"",u,a,c=t[7].crossing.toLocaleString()+"",p,$,_=t[7].other.toLocaleString()+"",C,S;return{c(){e=y("Showing "),n=y(r),o=y(" schemes ("),l=y(s),f=y(`
    routes, `),u=y(i),a=y(` areas,
    `),p=y(c),$=y(" crossings, "),C=y(_),S=y(`
    other)`)},m(L,O){m(L,e,O),m(L,n,O),m(L,o,O),m(L,l,O),m(L,f,O),m(L,u,O),m(L,a,O),m(L,p,O),m(L,$,O),m(L,C,O),m(L,S,O)},p(L,O){O&2&&r!==(r=L[1].size.toLocaleString()+"")&&me(n,r),O&128&&s!==(s=L[7].route.toLocaleString()+"")&&me(l,s),O&128&&i!==(i=L[7].area.toLocaleString()+"")&&me(u,i),O&128&&c!==(c=L[7].crossing.toLocaleString()+"")&&me(p,c),O&128&&_!==(_=L[7].other.toLocaleString()+"")&&me(C,_)},d(L){L&&(h(e),h(n),h(o),h(l),h(f),h(u),h(a),h(p),h($),h(C),h(S))}}}function li(t){let e,r,n;function o(l){t[14](l)}let s={id:"show-schemes",$$slots:{default:[ii]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new Q({props:s}),H.push(()=>z(e,"checked",o)),{c(){w(e.$$.fragment)},m(l,f){b(e,l,f),n=!0},p(l,f){const i={};f&131202&&(i.$$scope={dirty:f,ctx:l}),!r&&f&16&&(r=!0,i.checked=l[4],G(()=>r=!1)),e.$set(i)},i(l){n||(g(e.$$.fragment,l),n=!0)},o(l){d(e.$$.fragment,l),n=!1},d(l){v(e,l)}}}function ai(t){let e,r,n,o;return e=new xe({props:{label:"Filters",$$slots:{default:[si]},$$scope:{ctx:t}}}),n=new bt({props:{small:!0,$$slots:{default:[li]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment)},m(s,l){b(e,s,l),m(s,r,l),b(n,s,l),o=!0},p(s,[l]){const f={};l&131181&&(f.$$scope={dirty:l,ctx:s}),e.$set(f);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),v(e,s),v(n,s)}}}function ui(t,e,r){let n,o;X(t,at,k=>r(15,n=k)),X(t,ee,k=>r(9,o=k));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:f=""}=e,i=[],u="",a=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;Xt(()=>{let k=new Set,D=new Set;for(let x of s.values())x.authority_or_region&&k.add(x.authority_or_region),x.funding_programme&&D.add(x.funding_programme);r(5,i=Array.from(k.entries())),i.sort(),r(6,a=Array.from(D.entries())),a.sort()});function _(k,D,x){let I=k.toLowerCase(),A=N=>{var j,J;if(I&&!((j=N.properties.name)!=null&&j.toLowerCase().includes(I))&&!((J=N.properties.description)!=null&&J.toLowerCase().includes(I)))return!1;if(D||x){let re=s.get(N.properties.scheme_reference);if(D&&re.authority_or_region!=D||x&&re.funding_programme!=x)return!1}return!0};r(1,l=new Set(n.features.filter(A).map(N=>N.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let F=N=>{var j,J;return!(!l.has(N.properties.scheme_reference)||I&&!((j=N.properties.name)!=null&&j.toLowerCase().includes(I))&&!((J=N.properties.description)!=null&&J.toLowerCase().includes(I)))};at.update(N=>{for(let j of N.features)F(j)?(delete j.properties.hide_while_editing,r(7,p[j.properties.intervention_type]++,p)):j.properties.hide_while_editing=!0;return N}),r(7,p)}function C(k){u=k,r(2,u)}function S(k){c=k,r(3,c)}function L(){f=this.value,r(0,f)}const O=()=>r(0,f="");function M(k){$=k,r(4,$)}return t.$$set=k=>{"schemes"in k&&r(8,s=k.schemes),"schemesToBeShown"in k&&r(1,l=k.schemesToBeShown),"filterText"in k&&r(0,f=k.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let k of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(k)&&o.setLayoutProperty(k,"visibility",$?"visible":"none");t.$$.dirty&13&&_(f,u,c)},[f,l,u,c,$,i,a,p,s,o,C,S,L,O,M]}class fi extends V{constructor(e){super(),K(this,e,ui,ai,q,{schemes:8,schemesToBeShown:1,filterText:0})}}function ci(t){let e,r,n;return e=new we({props:{color:U.bus_route_with_lane}}),{c(){w(e.$$.fragment),r=y(`
  Bus routes`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function pi(t){let e;return{c(){e=y(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $i(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function mi(t){let e,r,n,o,s,l,f,i,u,a,c;return s=new B({props:{href:"https://gtfs.org",$$slots:{default:[pi]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[$i]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=T(),n=P("p"),o=y("Note this data is from OpenStreetMap (as of 9 August 2023), not "),w(s.$$.fragment),l=y(`, and doesn't include which routes are run or the
        frequency of service.`),f=T(),i=P("p"),u=y("License: "),w(a.$$.fragment)},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),E(n,o),b(s,n,null),E(n,l),m(p,f,$),m(p,i,$),E(i,u),b(a,i,null),c=!0},p(p,$){const _={};$&8&&(_.$$scope={dirty:$,ctx:p}),s.$set(_);const C={};$&8&&(C.$$scope={dirty:$,ctx:p}),a.$set(C)},i(p){c||(g(s.$$.fragment,p),g(a.$$.fragment,p),c=!0)},o(p){d(s.$$.fragment,p),d(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(f),h(i)),v(s),v(a)}}}function hi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[mi]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function gi(t){let e,r,n,o,s;function l(i){t[1](i)}let f={id:Ge,$$slots:{right:[hi],default:[ci]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:Ge,tooltip:di,show:t[0],clickable:!1}}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&8&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ge="bus_routes";function di(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function _i(t,e,r){let n;X(t,ee,l=>r(2,n=l)),de(n,Ge,`https://atip.uk/layers/v1/${Ge}.pmtiles`),Ce(n,{id:Ge,source:Ge,sourceLayer:Ge,color:["case",["boolean",["get","has_bus_lane"],!1],U.bus_route_with_lane,U.bus_route_without_lane],width:5,opacity:_e(.5,1)});let o=!1;function s(l){o=l,r(0,o)}return[o,s]}class wi extends V{constructor(e){super(),K(this,e,_i,gi,q,{})}}function Lr(t,e,r){const n=t.slice();return n[2]=e[r],n}function Or(t,e,r){const n=t.slice();return n[5]=e[r],n}function Tr(t){let e,r;return{c(){e=P("span"),r=y(` 
    `),Fe(e,"background",t[5]),Fe(e,"width","100%"),Fe(e,"border","1px solid black")},m(n,o){m(n,e,o),E(e,r)},p(n,o){o&1&&Fe(e,"background",n[5])},d(n){n&&h(e)}}}function Ar(t){let e,r=t[2]+"",n;return{c(){e=P("span"),n=y(r)},m(o,s){m(o,e,s),E(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&me(n,r)},d(o){o&&h(e)}}}function bi(t){let e,r,n,o=He(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Tr(Or(t,o,i));let l=He(t[1]),f=[];for(let i=0;i<l.length;i+=1)f[i]=Ar(Lr(t,l,i));return{c(){e=P("div");for(let i=0;i<s.length;i+=1)s[i].c();r=T(),n=P("div");for(let i=0;i<f.length;i+=1)f[i].c();Fe(e,"display","flex"),Fe(n,"display","flex"),Fe(n,"justify-content","space-between")},m(i,u){m(i,e,u);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);m(i,r,u),m(i,n,u);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(n,null)},p(i,[u]){if(u&1){o=He(i[0]);let a;for(a=0;a<o.length;a+=1){const c=Or(i,o,a);s[a]?s[a].p(c,u):(s[a]=Tr(c),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=o.length}if(u&2){l=He(i[1]);let a;for(a=0;a<l.length;a+=1){const c=Lr(i,l,a);f[a]?f[a].p(c,u):(f[a]=Ar(c),f[a].c(),f[a].m(n,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=l.length}},i:te,o:te,d(i){i&&(h(e),h(r),h(n)),Ot(s,i),Ot(f,i)}}}function vi(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class ut extends V{constructor(e){super(),K(this,e,vi,bi,q,{colorScale:0,limits:1})}}function yi(t){let e;return{c(){e=y("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ki(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Si(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ci(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Li(t){let e,r,n,o,s,l,f,i,u,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[ki]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Si]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ci]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Car/van availability data is from the 2021 census, via "),w(n.$$.fragment),o=y(". Output area boundaries from "),w(s.$$.fragment),l=y("."),f=T(),i=P("p"),u=y("License: "),w(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,_){m($,e,_),E(e,r),b(n,e,null),E(e,o),b(s,e,null),E(e,l),m($,f,_),m($,i,_),E(i,u),b(a,i,null),E(i,c),p=!0},p($,_){const C={};_&65536&&(C.$$scope={dirty:_,ctx:$}),n.$set(C);const S={};_&65536&&(S.$$scope={dirty:_,ctx:$}),s.$set(S);const L={};_&65536&&(L.$$scope={dirty:_,ctx:$}),a.$set(L)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(f),h(i)),v(n),v(s),v(a)}}}function Oi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Li]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Dr(t){let e,r;return e=new ut({props:{colorScale:t[4],limits:t[7]()}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:te,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Ti(t){let e;return{c(){e=y("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ai(t){let e;return{c(){e=y(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Di(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ei(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pi(t){let e,r,n,o,s,l,f,i,u,a,c,p,$,_;return s=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ai]},$$scope:{ctx:t}}}),f=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Di]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ei]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=T(),n=P("p"),o=y("Car/van availability data is from the 2021 census, via "),w(s.$$.fragment),l=y(". Output area boundaries from "),w(f.$$.fragment),i=y("."),u=T(),a=P("p"),c=y("License: "),w(p.$$.fragment),$=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(C,S){m(C,e,S),m(C,r,S),m(C,n,S),E(n,o),b(s,n,null),E(n,l),b(f,n,null),E(n,i),m(C,u,S),m(C,a,S),E(a,c),b(p,a,null),E(a,$),_=!0},p(C,S){const L={};S&65536&&(L.$$scope={dirty:S,ctx:C}),s.$set(L);const O={};S&65536&&(O.$$scope={dirty:S,ctx:C}),f.$set(O);const M={};S&65536&&(M.$$scope={dirty:S,ctx:C}),p.$set(M)},i(C){_||(g(s.$$.fragment,C),g(f.$$.fragment,C),g(p.$$.fragment,C),_=!0)},o(C){d(s.$$.fragment,C),d(f.$$.fragment,C),d(p.$$.fragment,C),_=!1},d(C){C&&(h(e),h(r),h(n),h(u),h(a)),v(s),v(f),v(p)}}}function Ni(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Pi]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Er(t){let e,r;return e=new ut({props:{colorScale:t[4],limits:t[7]()}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:te,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Ii(t){let e;return{c(){e=y("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Mi(t){let e;return{c(){e=y(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xi(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fi(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bi(t){let e,r,n,o,s,l,f,i,u,a,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Mi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[xi]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Fi]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Population density data is from the 2021 census, via "),w(n.$$.fragment),o=y(". Output area boundaries from "),w(s.$$.fragment),l=y("."),f=T(),i=P("p"),u=y("License: "),w(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,_){m($,e,_),E(e,r),b(n,e,null),E(e,o),b(s,e,null),E(e,l),m($,f,_),m($,i,_),E(i,u),b(a,i,null),E(i,c),p=!0},p($,_){const C={};_&65536&&(C.$$scope={dirty:_,ctx:$}),n.$set(C);const S={};_&65536&&(S.$$scope={dirty:_,ctx:$}),s.$set(S);const L={};_&65536&&(L.$$scope={dirty:_,ctx:$}),a.$set(L)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(f),h(i)),v(n),v(s),v(a)}}}function ji(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Bi]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Pr(t){let e,r,n,o;return n=new ut({props:{colorScale:t[4],limits:t[7]().map(Ui)}}),{c(){e=P("p"),e.textContent="(people per square kilometres)",r=T(),w(n.$$.fragment)},m(s,l){m(s,e,l),m(s,r,l),b(n,s,l),o=!0},p:te,i(s){o||(g(n.$$.fragment,s),o=!0)},o(s){d(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),v(n,s)}}}function Ri(t){let e,r,n,o,s,l,f,i,u,a,c,p,$,_;function C(A){t[9](A)}let S={id:"percent_households_with_car",$$slots:{right:[Oi],default:[yi]},$$scope:{ctx:t}};t[0]!==void 0&&(S.checked=t[0]),e=new Q({props:S}),H.push(()=>z(e,"checked",C)),e.$on("change",t[10]);let L=t[3]=="percent_households_with_car"&&Dr(t);function O(A){t[11](A)}let M={id:"average_cars_per_household",$$slots:{right:[Ni],default:[Ti]},$$scope:{ctx:t}};t[1]!==void 0&&(M.checked=t[1]),s=new Q({props:M}),H.push(()=>z(s,"checked",O)),s.$on("change",t[12]);let k=t[3]=="average_cars_per_household"&&Er(t);function D(A){t[13](A)}let x={id:"population_density",$$slots:{right:[ji],default:[Ii]},$$scope:{ctx:t}};t[2]!==void 0&&(x.checked=t[2]),u=new Q({props:x}),H.push(()=>z(u,"checked",D)),u.$on("change",t[14]);let I=t[3]=="population_density"&&Pr(t);return $=new Y({props:{layer:Oe,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){w(e.$$.fragment),n=T(),L&&L.c(),o=T(),w(s.$$.fragment),f=T(),k&&k.c(),i=T(),w(u.$$.fragment),c=T(),I&&I.c(),p=T(),w($.$$.fragment)},m(A,F){b(e,A,F),m(A,n,F),L&&L.m(A,F),m(A,o,F),b(s,A,F),m(A,f,F),k&&k.m(A,F),m(A,i,F),b(u,A,F),m(A,c,F),I&&I.m(A,F),m(A,p,F),b($,A,F),_=!0},p(A,[F]){const N={};F&65536&&(N.$$scope={dirty:F,ctx:A}),!r&&F&1&&(r=!0,N.checked=A[0],G(()=>r=!1)),e.$set(N),A[3]=="percent_households_with_car"?L?(L.p(A,F),F&8&&g(L,1)):(L=Dr(A),L.c(),g(L,1),L.m(o.parentNode,o)):L&&(he(),d(L,1,1,()=>{L=null}),ge());const j={};F&65536&&(j.$$scope={dirty:F,ctx:A}),!l&&F&2&&(l=!0,j.checked=A[1],G(()=>l=!1)),s.$set(j),A[3]=="average_cars_per_household"?k?(k.p(A,F),F&8&&g(k,1)):(k=Er(A),k.c(),g(k,1),k.m(i.parentNode,i)):k&&(he(),d(k,1,1,()=>{k=null}),ge());const J={};F&65536&&(J.$$scope={dirty:F,ctx:A}),!a&&F&4&&(a=!0,J.checked=A[2],G(()=>a=!1)),u.$set(J),A[3]=="population_density"?I?(I.p(A,F),F&8&&g(I,1)):(I=Pr(A),I.c(),g(I,1),I.m(p.parentNode,p)):I&&(he(),d(I,1,1,()=>{I=null}),ge());const re={};F&8&&(re.show=A[3]!=""),$.$set(re)},i(A){_||(g(e.$$.fragment,A),g(L),g(s.$$.fragment,A),g(k),g(u.$$.fragment,A),g(I),g($.$$.fragment,A),_=!0)},o(A){d(e.$$.fragment,A),d(L),d(s.$$.fragment,A),d(k),d(u.$$.fragment,A),d(I),d($.$$.fragment,A),_=!1},d(A){A&&(h(n),h(o),h(f),h(i),h(c),h(p)),v(e,A),L&&L.d(A),v(s,A),k&&k.d(A),v(u,A),I&&I.d(A),v($,A)}}}let Oe="census_output_areas";const Ui=t=>t.toLocaleString();function Hi(t,e,r){let n;X(t,ee,M=>r(8,n=M));let o=`${Oe}-outline`,s=U.sequential_low_to_high,l=!1,f=!1,i=!1,u="";de(n,Oe,`https://atip.uk/layers/v1/${Oe}.pmtiles`),We(n,{id:Oe,source:Oe,sourceLayer:Oe,color:"black",opacity:_e(.5,.7)}),Ce(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});function a(M){let k=M.properties.OA21CD,D=M.properties[u];return u=="percent_households_with_car"?`<p>${D}% of households in ${k} have 1 or more cars</p>`:u=="average_cars_per_household"?`<p>Households in ${k} have an average of ${D} cars</p>`:`<p>There are ${D.toLocaleString()} people per square kilometre in ${k}</p>`}function c(M){let k=M.detail.properties.OA21CD;u=="percent_households_with_car"||u=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${k}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${k}`,"_blank")}function p(){return u=="percent_households_with_car"?[0,20,40,60,80,100]:u=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(M){l=M,r(0,l)}const _=()=>{r(1,f=!1),r(2,i=!1)};function C(M){f=M,r(1,f)}const S=()=>{r(0,l=!1),r(2,i=!1)};function L(M){i=M,r(2,i)}const O=()=>{r(0,l=!1),r(1,f=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(l?r(3,u="percent_households_with_car"):f?r(3,u="average_cars_per_household"):i?r(3,u="population_density"):r(3,u=""),u?(n.setPaintProperty(Oe,"fill-color",gt(["get",u],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,f,i,u,s,a,c,p,n,$,_,C,S,L,O]}class Wi extends V{constructor(e){super(),K(this,e,Hi,Ri,q,{})}}function zi(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){w(e.$$.fragment),r=y(`
  Combined authorities`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function Gi(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vi(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ki(t){let e,r,n,o,s,l,f,i,u,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Gi]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Vi]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Data from "),w(n.$$.fragment),o=y(", as of December 2022."),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment),u=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),E(e,r),b(n,e,null),E(e,o),m(c,s,p),m(c,l,p),E(l,f),b(i,l,null),E(l,u),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const _={};p&32&&(_.$$scope={dirty:p,ctx:c}),i.$set(_)},i(c){a||(g(n.$$.fragment,c),g(i.$$.fragment,c),a=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),v(n),v(i)}}}function qi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ki]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Zi(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Re,$$slots:{right:[qi],default:[zi]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:Re,tooltip:Xi,show:t[0],clickable:!0}}),o.$on("click",Yi),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Re="combined_authorities";function Xi(t){return`<p>${t.properties.name}</p>`}function Yi(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function Ji(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=U.combined_authorities,s=`${Re}-outline`;Jt(n,Re,`https://atip.uk/layers/v1/${Re}.geojson`),We(n,{id:Re,source:Re,color:o,opacity:_e(.5,0)}),Ce(n,{id:s,source:Re,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Qi extends V{constructor(e){super(),K(this,e,Ji,Zi,q,{})}}function el(t){let e,r,n;return{c(){e=P("input"),W(e,"class","govuk-file-upload"),W(e,"id","load-criticals"),W(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=Yt(e,"change",t[4]),r=!0)},p:te,d(o){o&&h(e),t[7](null),r=!1,n()}}}function Nr(t){let e,r;return e=new bt({props:{small:!0,$$slots:{default:[rl]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function tl(t){let e,r,n=t[2].toLocaleString()+"",o,s,l;return e=new we({props:{color:Kt}}),{c(){w(e.$$.fragment),r=y(`
        Show `),o=y(n),s=y(" issues")},m(f,i){b(e,f,i),m(f,r,i),m(f,o,i),m(f,s,i),l=!0},p(f,i){(!l||i&4)&&n!==(n=f[2].toLocaleString()+"")&&me(o,n)},i(f){l||(g(e.$$.fragment,f),l=!0)},o(f){d(e.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o),h(s)),v(e,f)}}}function rl(t){let e,r,n;function o(l){t[8](l)}let s={id:"show-criticals",$$slots:{default:[tl]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new Q({props:s}),H.push(()=>z(e,"checked",o)),{c(){w(e.$$.fragment)},m(l,f){b(e,l,f),n=!0},p(l,f){const i={};f&516&&(i.$$scope={dirty:f,ctx:l}),!r&&f&1&&(r=!0,i.checked=l[0],G(()=>r=!1)),e.$set(i)},i(l){n||(g(e.$$.fragment,l),n=!0)},o(l){d(e.$$.fragment,l),n=!1},d(l){v(e,l)}}}function nl(t){let e,r,n,o,s,l;e=new qr({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[el]},$$scope:{ctx:t}}}),n=new Xr({props:{errorMessage:t[3]}});let f=t[2]>0&&Nr(t);return{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),o=T(),f&&f.c(),s=Qt()},m(i,u){b(e,i,u),m(i,r,u),b(n,i,u),m(i,o,u),f&&f.m(i,u),m(i,s,u),l=!0},p(i,u){const a={};u&514&&(a.$$scope={dirty:u,ctx:i}),e.$set(a);const c={};u&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?f?(f.p(i,u),u&4&&g(f,1)):(f=Nr(i),f.c(),g(f,1),f.m(s.parentNode,s)):f&&(he(),d(f,1,1,()=>{f=null}),ge())},i(i){l||(g(e.$$.fragment,i),g(n.$$.fragment,i),g(f),l=!0)},o(i){d(e.$$.fragment,i),d(n.$$.fragment,i),d(f),l=!1},d(i){i&&(h(r),h(o),h(s)),v(e,i),v(n,i),f&&f.d(i)}}}function ol(t){let e,r,n,o,s,l;return e=new xe({props:{label:"Critical Issues",$$slots:{default:[nl]},$$scope:{ctx:t}}}),n=new Y({props:{layer:se+"-points",tooltip:sl,show:t[0],clickable:!1}}),s=new Y({props:{layer:se+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[se+"-counts"]}}),s.$on("click",t[5]),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),o=T(),w(s.$$.fragment)},m(f,i){b(e,f,i),m(f,r,i),b(n,f,i),m(f,o,i),b(s,f,i),l=!0},p(f,[i]){const u={};i&527&&(u.$$scope={dirty:i,ctx:f}),e.$set(u);const a={};i&1&&(a.show=f[0]),n.$set(a);const c={};i&1&&(c.show=f[0]),s.$set(c)},i(f){l||(g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),l=!0)},o(f){d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),l=!1},d(f){f&&(h(r),h(o)),v(e,f),v(n,f),v(s,f)}}}let se="criticals",Kt="red";function sl(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function il(t,e,r){let n;X(t,ee,p=>r(6,n=p));let o,s=!0,l=0,f="";Fn(n,se),n.addSource(se,{type:"geojson",data:Zr(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),dt(n,{id:`${se}-clusters`,source:se,filter:["has","point_count"],color:Kt,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${se}-counts`,source:se,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),dt(n,{id:`${se}-points`,source:se,filter:["!",["has","point_count"]],color:Kt,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await Qs(o.files[0]);n.getSource(se).setData($),r(2,l=$.features.length),r(3,f="")}catch($){r(3,f=`The file you loaded is broken: ${$}`)}}function u(p){n.getSource(se).getClusterExpansionZoom(p.detail.properties.cluster_id,($,_)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:_})})}function a(p){H[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${se}-counts`)&&n.setLayoutProperty(`${se}-counts`,"visibility",s?"visible":"none")},[s,o,l,f,i,u,n,a,c]}class ll extends V{constructor(e){super(),K(this,e,il,ol,q,{})}}function al(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){w(e.$$.fragment),r=y(`
  Cycle parking`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function ul(t){let e;return{c(){e=y("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fl(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function cl(t){let e,r,n,o,s,l,f,i,u;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[ul]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[fl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Cycle parking, according to "),w(n.$$.fragment),o=y(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment)},m(a,c){m(a,e,c),E(e,r),b(n,e,null),E(e,o),m(a,s,c),m(a,l,c),E(l,f),b(i,l,null),u=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){u||(g(n.$$.fragment,a),g(i.$$.fragment,a),u=!0)},o(a){d(n.$$.fragment,a),d(i.$$.fragment,a),u=!1},d(a){a&&(h(e),h(s),h(l)),v(n),v(i)}}}function pl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[cl]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function $l(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:Ve,$$slots:{right:[pl],default:[al]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:Ve,tooltip:ml,show:t[0],clickable:!1}}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&16&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ve="cycle_parking";function ml(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function hl(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=U.cycle_parking;de(n,Ve,`https://atip.uk/layers/v1/${Ve}.pmtiles`),dt(n,{id:Ve,source:Ve,sourceLayer:Ve,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class gl extends V{constructor(e){super(),K(this,e,hl,$l,q,{})}}function Ir(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function dl(t){let e;return{c(){e=y("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _l(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wl(t){let e,r,n,o,s,l,f,i,u,a;return u=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[_l]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=T(),n=P("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=T(),s=P("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=T(),f=P("p"),i=y("License: "),w(u.$$.fragment)},m(c,p){m(c,e,p),m(c,r,p),m(c,n,p),m(c,o,p),m(c,s,p),m(c,l,p),m(c,f,p),E(f,i),b(u,f,null),a=!0},p(c,p){const $={};p&256&&($.$$scope={dirty:p,ctx:c}),u.$set($)},i(c){a||(g(u.$$.fragment,c),a=!0)},o(c){d(u.$$.fragment,c),a=!1},d(c){c&&(h(e),h(r),h(n),h(o),h(s),h(l),h(f)),v(u)}}}function bl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[wl]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Mr(t){let e,r,n=He(t[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=xr(Ir(t,n,l));const s=l=>d(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=Qt()},m(l,f){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,f);m(l,e,f),r=!0},p(l,f){if(f&2){n=He(l[1]);let i;for(i=0;i<n.length;i+=1){const u=Ir(l,n,i);o[i]?(o[i].p(u,f),g(o[i],1)):(o[i]=xr(u),o[i].c(),g(o[i],1),o[i].m(e.parentNode,e))}for(he(),i=n.length;i<o.length;i+=1)s(i);ge()}},i(l){if(!r){for(let f=0;f<n.length;f+=1)g(o[f]);r=!0}},o(l){o=o.filter(Boolean);for(let f=0;f<o.length;f+=1)d(o[f]);r=!1},d(l){l&&h(e),Ot(o,l)}}}function xr(t){let e,r,n,o=t[4]+"",s,l,f;return r=new we({props:{color:t[5]}}),{c(){e=P("div"),w(r.$$.fragment),n=T(),s=y(o),l=T()},m(i,u){m(i,e,u),b(r,e,null),E(e,n),E(e,s),E(e,l),f=!0},p:te,i(i){f||(g(r.$$.fragment,i),f=!0)},o(i){d(r.$$.fragment,i),f=!1},d(i){i&&h(e),v(r)}}}function vl(t){let e,r,n,o,s,l;function f(a){t[2](a)}let i={id:Ke,$$slots:{right:[bl],default:[dl]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new Q({props:i}),H.push(()=>z(e,"checked",f));let u=t[0]&&Mr(t);return s=new Y({props:{layer:Ke,tooltip:yl,show:t[0],clickable:!0}}),s.$on("click",kl),{c(){w(e.$$.fragment),n=T(),u&&u.c(),o=T(),w(s.$$.fragment)},m(a,c){b(e,a,c),m(a,n,c),u&&u.m(a,c),m(a,o,c),b(s,a,c),l=!0},p(a,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?u?(u.p(a,c),c&1&&g(u,1)):(u=Mr(a),u.c(),g(u,1),u.m(o.parentNode,o)):u&&(he(),d(u,1,1,()=>{u=null}),ge());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(g(e.$$.fragment,a),g(u),g(s.$$.fragment,a),l=!0)},o(a){d(e.$$.fragment,a),d(u),d(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),v(e,a),u&&u.d(a),v(s,a)}}}let Ke="cycle_paths";function yl(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function kl(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Sl(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=[["Separated tracks",U.cycle_paths.track],["Unprotected lanes",U.cycle_paths.lane],["Shared-use (segregated)",U.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",U.cycle_paths.shared_use_unsegregated]];de(n,Ke,`https://atip.uk/layers/v1/${Ke}.pmtiles`),Ce(n,{id:Ke,source:Ke,sourceLayer:Ke,color:Kr(["get","kind"],{track:U.cycle_paths.track,lane:U.cycle_paths.lane,shared_use_segregated:U.cycle_paths.shared_use_segregated,shared_use_unsegregated:U.cycle_paths.shared_use_unsegregated},"red"),width:vn,opacity:_e(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class Cl extends V{constructor(e){super(),K(this,e,Sl,vl,q,{})}}function Ll(t){let e,r,n,o;return e=new we({props:{color:t[3]}}),{c(){w(e.$$.fragment),r=T(),n=y(t[1])},m(s,l){b(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&me(n,s[1])},i(s){o||(g(e.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),v(e,s)}}}function Ol(t){let e;const r=t[6].default,n=Yr(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&Jr(n,r,o,o[8],e?en(r,o[8],s,null):Qr(o[8]),null)},i(o){e||(g(n,o),e=!0)},o(o){d(n,o),e=!1},d(o){n&&n.d(o)}}}function Tl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ol]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Al(t){let e,r,n,o,s;function l(i){t[7](i)}let f={id:t[0],$$slots:{right:[Tl],default:[Ll]},$$scope:{ctx:t}};return t[2]!==void 0&&(f.checked=t[2]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&1&&(a.id=i[0]),u&258&&(a.$$scope={dirty:u,ctx:i}),!r&&u&4&&(r=!0,a.checked=i[2],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.layer=i[0]),u&4&&(c.show=i[2]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}function Dl(t,e,r){let n;X(t,ee,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:f}=e,{pluralNoun:i}=e,u=U[l];de(n,l,`https://atip.uk/layers/v1/${l}.pmtiles`),We(n,{id:l,source:l,sourceLayer:l,color:u,opacity:_e(1,.7)});let a=!1;function c($){return`<p>${$.properties.name??`Unnamed ${f}`}</p>`}function p($){a=$,r(2,a)}return t.$$set=$=>{"name"in $&&r(0,l=$.name),"singularNoun"in $&&r(5,f=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[l,i,a,u,c,f,o,p,s]}class tr extends V{constructor(e){super(),K(this,e,Dl,Al,q,{name:0,singularNoun:5,pluralNoun:1})}}function El(t){let e;return{c(){e=y("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pl(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Nl(t){let e,r,n,o,s,l,f,i,u;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[El]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Pl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("This shows "),w(n.$$.fragment),o=y(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment)},m(a,c){m(a,e,c),E(e,r),b(n,e,null),E(e,o),m(a,s,c),m(a,l,c),E(l,f),b(i,l,null),u=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){u||(g(n.$$.fragment,a),g(i.$$.fragment,a),u=!0)},o(a){d(n.$$.fragment,a),d(i.$$.fragment,a),u=!1},d(a){a&&(h(e),h(s),h(l)),v(n),v(i)}}}function Il(t){let e,r;return e=new tr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Nl]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}class Ml extends V{constructor(e){super(),K(this,e,null,Il,q,{})}}function xl(t){let e;return{c(){e=y("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fl(t){let e;return{c(){e=y(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bl(t){let e;return{c(){e=y(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function jl(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Rl(t){let e,r,n,o,s,l,f,i,u,a,c,p;return n=new B({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Fl]},$$scope:{ctx:t}}}),s=new B({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Bl]},$$scope:{ctx:t}}}),a=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[jl]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("The 2019 English IMD scores come from "),w(n.$$.fragment),o=y(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),w(s.$$.fragment),l=y("."),f=T(),i=P("p"),u=y("License: "),w(a.$$.fragment),c=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,_){m($,e,_),E(e,r),b(n,e,null),E(e,o),b(s,e,null),E(e,l),m($,f,_),m($,i,_),E(i,u),b(a,i,null),E(i,c),p=!0},p($,_){const C={};_&64&&(C.$$scope={dirty:_,ctx:$}),n.$set(C);const S={};_&64&&(S.$$scope={dirty:_,ctx:$}),s.$set(S);const L={};_&64&&(L.$$scope={dirty:_,ctx:$}),a.$set(L)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(a.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(a.$$.fragment,$),p=!1},d($){$&&(h(e),h(f),h(i)),v(n),v(s),v(a)}}}function Ul(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Rl]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Fr(t){let e,r;return e=new ut({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:te,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Hl(t){let e,r,n,o,s,l;function f(a){t[3](a)}let i={id:Te,$$slots:{right:[Ul],default:[xl]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new Q({props:i}),H.push(()=>z(e,"checked",f));let u=t[0]&&Fr(t);return s=new Y({props:{layer:Te,tooltip:Wl,show:t[0],clickable:!1}}),{c(){w(e.$$.fragment),n=T(),u&&u.c(),o=T(),w(s.$$.fragment)},m(a,c){b(e,a,c),m(a,n,c),u&&u.m(a,c),m(a,o,c),b(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?u?(u.p(a,c),c&1&&g(u,1)):(u=Fr(a),u.c(),g(u,1),u.m(o.parentNode,o)):u&&(he(),d(u,1,1,()=>{u=null}),ge());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(g(e.$$.fragment,a),g(u),g(s.$$.fragment,a),l=!0)},o(a){d(e.$$.fragment,a),d(u),d(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),v(e,a),u&&u.d(a),v(s,a)}}}let Te="imd";function Wl(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function zl(t,e,r){let n;X(t,ee,u=>r(2,n=u));let o=`${Te}-outline`,s=U.sequential_low_to_high,l=[0,2,4,6,8,10];de(n,Te,`https://atip.uk/layers/v1/${Te}.pmtiles`),We(n,{id:Te,source:Te,sourceLayer:Te,color:gt(["-",10,["get","decile"]],l,s),opacity:_e(.5,.7)}),Ce(n,{id:o,source:Te,sourceLayer:Te,color:"black",width:.5});let f=!1;function i(u){f=u,r(0,f)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",f?"visible":"none")},[f,s,n,i]}class Gl extends V{constructor(e){super(),K(this,e,zl,Hl,q,{})}}function Vl(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){w(e.$$.fragment),r=y(`
  Local Authority Districts`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function Kl(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ql(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zl(t){let e,r,n,o,s,l,f,i,u,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Kl]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ql]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Data from "),w(n.$$.fragment),o=y(", as of May 2023."),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment),u=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),E(e,r),b(n,e,null),E(e,o),m(c,s,p),m(c,l,p),E(l,f),b(i,l,null),E(l,u),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const _={};p&32&&(_.$$scope={dirty:p,ctx:c}),i.$set(_)},i(c){a||(g(n.$$.fragment,c),g(i.$$.fragment,c),a=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),v(n),v(i)}}}function Xl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Zl]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Yl(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ue,$$slots:{right:[Xl],default:[Vl]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:Ue,tooltip:Jl,show:t[0],clickable:!0}}),o.$on("click",Ql),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ue="local_authority_districts";function Jl(t){return`<p>${t.properties.name}</p>`}function Ql(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function ea(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=U.local_authority_districts,s=`${Ue}-outline`;Jt(n,Ue,`https://atip.uk/layers/v1/${Ue}.geojson`),We(n,{id:Ue,source:Ue,color:o,opacity:_e(.5,0)}),Ce(n,{id:s,source:Ue,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class ta extends V{constructor(e){super(),K(this,e,ea,Yl,q,{})}}function ra(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){w(e.$$.fragment),r=y(`
  Local Planning Authorities`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function na(t){let e;return{c(){e=y(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function oa(t){let e;return{c(){e=y(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function sa(t){let e;return{c(){e=y(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ia(t){let e;return{c(){e=y("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function la(t){let e;return{c(){e=y(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function aa(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ua(t){let e,r,n,o,s,l,f,i,u,a,c,p,$,_,C,S,L,O,M,k,D,x,I,A,F;return n=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[na]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[oa]},$$scope:{ctx:t}}}),f=new B({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[sa]},$$scope:{ctx:t}}}),$=new B({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[ia]},$$scope:{ctx:t}}}),O=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[la]},$$scope:{ctx:t}}}),I=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[aa]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("LPAs may be a "),w(n.$$.fragment),o=y(", "),w(s.$$.fragment),l=y("y, or "),w(f.$$.fragment),i=y("."),u=T(),a=P("p"),c=P("strong"),p=y(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),w($.$$.fragment),_=y(" to get more details."),C=T(),S=P("p"),L=y("Data from ONS Geography via "),w(O.$$.fragment),M=y(", as of November 2022."),k=T(),D=P("p"),x=y("License: "),w(I.$$.fragment),A=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(N,j){m(N,e,j),E(e,r),b(n,e,null),E(e,o),b(s,e,null),E(e,l),b(f,e,null),E(e,i),m(N,u,j),m(N,a,j),E(a,c),E(c,p),b($,c,null),E(c,_),m(N,C,j),m(N,S,j),E(S,L),b(O,S,null),E(S,M),m(N,k,j),m(N,D,j),E(D,x),b(I,D,null),E(D,A),F=!0},p(N,j){const J={};j&32&&(J.$$scope={dirty:j,ctx:N}),n.$set(J);const re={};j&32&&(re.$$scope={dirty:j,ctx:N}),s.$set(re);const Le={};j&32&&(Le.$$scope={dirty:j,ctx:N}),f.$set(Le);const pe={};j&32&&(pe.$$scope={dirty:j,ctx:N}),$.$set(pe);const oe={};j&32&&(oe.$$scope={dirty:j,ctx:N}),O.$set(oe);const ze={};j&32&&(ze.$$scope={dirty:j,ctx:N}),I.$set(ze)},i(N){F||(g(n.$$.fragment,N),g(s.$$.fragment,N),g(f.$$.fragment,N),g($.$$.fragment,N),g(O.$$.fragment,N),g(I.$$.fragment,N),F=!0)},o(N){d(n.$$.fragment,N),d(s.$$.fragment,N),d(f.$$.fragment,N),d($.$$.fragment,N),d(O.$$.fragment,N),d(I.$$.fragment,N),F=!1},d(N){N&&(h(e),h(u),h(a),h(C),h(S),h(k),h(D)),v(n),v(s),v(f),v($),v(O),v(I)}}}function fa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ua]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function ca(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ae,$$slots:{right:[fa],default:[ra]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:Ae,tooltip:pa,show:t[0],clickable:!1}}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ae="local_planning_authorities";function pa(t){return`<p>${t.properties.name}</p>`}function $a(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=U.local_planning_authorities,s=`${Ae}-outline`;de(n,Ae,`https://atip.uk/layers/v1/${Ae}.pmtiles`),We(n,{id:Ae,source:Ae,sourceLayer:Ae,color:o,opacity:_e(.5,0)}),Ce(n,{id:s,source:Ae,sourceLayer:Ae,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class ma extends V{constructor(e){super(),K(this,e,$a,ca,q,{})}}function ha(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){w(e.$$.fragment),r=y(`
  Major Road Network`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function ga(t){let e;return{c(){e=y(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function da(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _a(t){let e,r,n,o,s,l,f,i,u;return n=new B({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[ga]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[da]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Data from the "),w(n.$$.fragment),o=y(", as of September 2021."),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment)},m(a,c){m(a,e,c),E(e,r),b(n,e,null),E(e,o),m(a,s,c),m(a,l,c),E(l,f),b(i,l,null),u=!0},p(a,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){u||(g(n.$$.fragment,a),g(i.$$.fragment,a),u=!0)},o(a){d(n.$$.fragment,a),d(i.$$.fragment,a),u=!1},d(a){a&&(h(e),h(s),h(l)),v(n),v(i)}}}function wa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[_a]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function ba(t){let e,r,n,o,s;function l(i){t[2](i)}let f={id:qe,$$slots:{right:[wa],default:[ha]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:qe,tooltip:va,show:t[0],clickable:!1}}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&16&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let qe="mrn";function va(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function ya(t,e,r){let n;X(t,ee,f=>r(3,n=f));let o=U.mrn;de(n,qe,`https://atip.uk/layers/v1/${qe}.pmtiles`),Ce(n,{id:qe,source:qe,sourceLayer:qe,color:o,width:7,opacity:_e(.5,1)});let s=!1;function l(f){s=f,r(0,s)}return[s,o,l]}class ka extends V{constructor(e){super(),K(this,e,ya,ba,q,{})}}function Sa(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){w(e.$$.fragment),r=y(`
  Parliamentary constituencies`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function Ca(t){let e;return{c(){e=y(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function La(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Oa(t){let e,r,n,o,s,l,f,i,u;return n=new B({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Ca]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[La]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Data from "),w(n.$$.fragment),o=y(", as of May 2023."),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment)},m(a,c){m(a,e,c),E(e,r),b(n,e,null),E(e,o),m(a,s,c),m(a,l,c),E(l,f),b(i,l,null),u=!0},p(a,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){u||(g(n.$$.fragment,a),g(i.$$.fragment,a),u=!0)},o(a){d(n.$$.fragment,a),d(i.$$.fragment,a),u=!1},d(a){a&&(h(e),h(s),h(l)),v(n),v(i)}}}function Ta(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Oa]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Aa(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:De,$$slots:{right:[Ta],default:[Sa]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:De,tooltip:Da,show:t[0],clickable:!0}}),o.$on("click",Ea),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let De="parliamentary_constituencies";function Da(t){return`<p>${t.properties.Name}</p>`}function Ea(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function Pa(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=U.parliamentary_constituencies,s=`${De}-outline`;de(n,De,`https://atip.uk/layers/v1/${De}.pmtiles`),We(n,{id:De,source:De,sourceLayer:De,color:o,opacity:_e(.5,0)}),Ce(n,{id:s,source:De,sourceLayer:De,color:o,width:5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Na extends V{constructor(e){super(),K(this,e,Pa,Aa,q,{})}}function Ia(t){let e;return{c(){e=y("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ma(t){let e;return{c(){e=y("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xa(t){let e;return{c(){e=y("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fa(t){let e,r,n,o,s,l,f,i,u;return s=new B({props:{href:"https://www.pct.bike",$$slots:{default:[Ma]},$$scope:{ctx:t}}}),f=new B({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[xa]},$$scope:{ctx:t}}}),{c(){e=P("p"),e.textContent=`The PCT shows major links on the transport network on which there is high
        latent demand for cycling under scenarios of change, based on the 'fastest'
        routes from CycleStreets. Counts approximate daily rush hour traffic levels.`,r=T(),n=P("p"),o=y("See "),w(s.$$.fragment),l=y(" and "),w(f.$$.fragment),i=y(" for details on methodology and data sources.")},m(a,c){m(a,e,c),m(a,r,c),m(a,n,c),E(n,o),b(s,n,null),E(n,l),b(f,n,null),E(n,i),u=!0},p(a,c){const p={};c&2048&&(p.$$scope={dirty:c,ctx:a}),s.$set(p);const $={};c&2048&&($.$$scope={dirty:c,ctx:a}),f.$set($)},i(a){u||(g(s.$$.fragment,a),g(f.$$.fragment,a),u=!0)},o(a){d(s.$$.fragment,a),d(f.$$.fragment,a),u=!1},d(a){a&&(h(e),h(r),h(n)),v(s),v(f)}}}function Ba(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Fa]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Br(t){let e,r,n,o,s,l,f,i;e=new ut({props:{colorScale:t[3],limits:t[4]}});function u($){t[8]($)}let a={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(a.value=t[0]),n=new Bn({props:a}),H.push(()=>z(n,"value",u)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),l=new Tt({props:p}),H.push(()=>z(l,"value",c)),l.$on("change",t[6]),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),s=T(),w(l.$$.fragment)},m($,_){b(e,$,_),m($,r,_),b(n,$,_),m($,s,_),b(l,$,_),i=!0},p($,_){const C={};!o&&_&1&&(o=!0,C.value=$[0],G(()=>o=!1)),n.$set(C);const S={};!f&&_&2&&(f=!0,S.value=$[1],G(()=>f=!1)),l.$set(S)},i($){i||(g(e.$$.fragment,$),g(n.$$.fragment,$),g(l.$$.fragment,$),i=!0)},o($){d(e.$$.fragment,$),d(n.$$.fragment,$),d(l.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),v(e,$),v(n,$),v(l,$)}}}function ja(t){let e,r,n,o,s,l,f,i;function u(p){t[7](p)}let a={id:Ye,$$slots:{right:[Ba],default:[Ia]},$$scope:{ctx:t}};t[2]!==void 0&&(a.checked=t[2]),e=new Q({props:a}),H.push(()=>z(e,"checked",u));let c=t[2]&&Br(t);return s=new Y({props:{layer:Ye,tooltip:t[5],show:t[2]&&t[0]==Ye,clickable:!1}}),f=new Y({props:{layer:Lt,tooltip:t[5],show:t[2]&&t[0]==Lt,clickable:!1}}),{c(){w(e.$$.fragment),n=T(),c&&c.c(),o=T(),w(s.$$.fragment),l=T(),w(f.$$.fragment)},m(p,$){b(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),b(s,p,$),m(p,l,$),b(f,p,$),i=!0},p(p,[$]){const _={};$&2048&&(_.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,_.checked=p[2],G(()=>r=!1)),e.$set(_),p[2]?c?(c.p(p,$),$&4&&g(c,1)):(c=Br(p),c.c(),g(c,1),c.m(o.parentNode,o)):c&&(he(),d(c,1,1,()=>{c=null}),ge());const C={};$&5&&(C.show=p[2]&&p[0]==Ye),s.$set(C);const S={};$&5&&(S.show=p[2]&&p[0]==Lt),f.$set(S)},i(p){i||(g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(f.$$.fragment,p),i=!0)},o(p){d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(f.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(l)),v(e,p),c&&c.d(p),v(s,p),v(f,p)}}}let Ye="pct_commute",Lt="pct_school";function Ra(t,e,r){let n;X(t,ee,_=>r(10,n=_));let o=U.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=Ye,f="baseline";for(let _ of[Ye,Lt])de(n,_,`https://atip.uk/layers/v1/${_}.pmtiles`),Ce(n,{id:_,source:_,sourceLayer:_,color:gt(["get",f],s,o),width:vn,opacity:_e(.5,1)});let i=!1;function u(_){let C=_.properties.baseline,S=_.properties.gov_target,L=_.properties.go_dutch,O=`<h2>Trip purpose: ${l==Ye?"commuting":"school"}</h2>`;if(O+=`<p>Baseline (2011): <b>${C.toLocaleString()}</b></p>`,C==0)O+=`<p>Government target (2025): <b>${S.toLocaleString()}</b></p>`,O+=`<p>Go Dutch: <b>${L.toLocaleString()}</b></p>`;else{let M=(S/C).toFixed(1),k=(L/C).toFixed(1);O+=`<p>Government target (2025): ${S.toLocaleString()} (<b>${M}x</b> of baseline)</p>`,O+=`<p>Go Dutch: ${L.toLocaleString()} (<b>${k}x</b> of baseline)</p>`}return O}function a(){n.setPaintProperty(l,"line-color",gt(["get",f],s,o))}function c(_){i=_,r(2,i)}function p(_){l=_,r(0,l)}function $(_){f=_,r(1,f)}return[l,f,i,o,s,u,a,c,p,$]}class Ua extends V{constructor(e){super(),K(this,e,Ra,ja,q,{})}}function Ha(t){let e,r,n,o;return e=new we({props:{color:t[3]}}),{c(){w(e.$$.fragment),r=T(),n=y(t[1])},m(s,l){b(e,s,l),m(s,r,l),m(s,n,l),o=!0},p(s,l){(!o||l&2)&&me(n,s[1])},i(s){o||(g(e.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),v(e,s)}}}function Wa(t){let e;const r=t[7].default,n=Yr(r,t,t[9],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&512)&&Jr(n,r,o,o[9],e?en(r,o[9],s,null):Qr(o[9]),null)},i(o){e||(g(n,o),e=!0)},o(o){d(n,o),e=!1},d(o){n&&n.d(o)}}}function za(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Wa]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&512&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Ga(t){let e,r,n,o,s;function l(i){t[8](i)}let f={id:t[0],$$slots:{right:[za],default:[Ha]},$$scope:{ctx:t}};return t[2]!==void 0&&(f.checked=t[2]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&1&&(a.id=i[0]),u&514&&(a.$$scope={dirty:u,ctx:i}),!r&&u&4&&(r=!0,a.checked=i[2],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.layer=i[0]),u&4&&(c.show=i[2]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}function Va(t,e,r){let n;X(t,ee,_=>r(10,n=_));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:f}=e,{pluralNoun:i}=e,{circleRadius:u}=e,a=U[l];Jt(n,l,`https://atip.uk/layers/v1/${l}.geojson`),dt(n,{id:l,source:l,color:a,radius:u/2});let c=!1;function p(_){return`<p>${_.properties.name??`Unnamed ${f}`}</p>`}function $(_){c=_,r(2,c)}return t.$$set=_=>{"name"in _&&r(0,l=_.name),"singularNoun"in _&&r(5,f=_.singularNoun),"pluralNoun"in _&&r(1,i=_.pluralNoun),"circleRadius"in _&&r(6,u=_.circleRadius),"$$scope"in _&&r(9,s=_.$$scope)},[l,i,c,a,p,f,u,o,$,s]}class Ka extends V{constructor(e){super(),K(this,e,Va,Ga,q,{name:0,singularNoun:5,pluralNoun:1,circleRadius:6})}}function qa(t){let e;return{c(){e=y("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Za(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xa(t){let e,r,n,o,s,l,f,i,u;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[qa]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Za]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("This shows "),w(n.$$.fragment),o=y(" data from OpenStreetMap (as of 9 August 2023)."),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment)},m(a,c){m(a,e,c),E(e,r),b(n,e,null),E(e,o),m(a,s,c),m(a,l,c),E(l,f),b(i,l,null),u=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){u||(g(n.$$.fragment,a),g(i.$$.fragment,a),u=!0)},o(a){d(n.$$.fragment,a),d(i.$$.fragment,a),u=!1},d(a){a&&(h(e),h(s),h(l)),v(n),v(i)}}}function Ya(t){let e,r;return e=new Ka({props:{name:Ja,singularNoun:"railway station",pluralNoun:"Railway stations",circleRadius:Hn,$$slots:{default:[Xa]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}const Ja="railway_stations";class Qa extends V{constructor(e){super(),K(this,e,null,Ya,q,{})}}function eu(t){let e;return{c(){e=y("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tu(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ru(t){let e,r,n,o,s,l,f,i,u;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[eu]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[tu]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("This shows "),w(n.$$.fragment),o=y(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment)},m(a,c){m(a,e,c),E(e,r),b(n,e,null),E(e,o),m(a,s,c),m(a,l,c),E(l,f),b(i,l,null),u=!0},p(a,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:a}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:a}),i.$set($)},i(a){u||(g(n.$$.fragment,a),g(i.$$.fragment,a),u=!0)},o(a){d(n.$$.fragment,a),d(i.$$.fragment,a),u=!1},d(a){a&&(h(e),h(s),h(l)),v(n),v(i)}}}function nu(t){let e,r;return e=new tr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[ru]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}class ou extends V{constructor(e){super(),K(this,e,null,nu,q,{})}}function su(t){let e;return{c(){e=y("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function iu(t){let e;return{c(){e=y("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function lu(t){let e;return{c(){e=y("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function au(t){let e,r,n,o,s,l,f,i,u,a,c;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[su]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[iu]},$$scope:{ctx:t}}}),a=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[lu]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("This shows "),w(n.$$.fragment),o=y(" and "),w(s.$$.fragment),l=y(" data from OpenStreetMap (as of 9 August 2023)."),f=T(),i=P("p"),u=y("License: "),w(a.$$.fragment)},m(p,$){m(p,e,$),E(e,r),b(n,e,null),E(e,o),b(s,e,null),E(e,l),m(p,f,$),m(p,i,$),E(i,u),b(a,i,null),c=!0},p(p,$){const _={};$&1&&(_.$$scope={dirty:$,ctx:p}),n.$set(_);const C={};$&1&&(C.$$scope={dirty:$,ctx:p}),s.$set(C);const S={};$&1&&(S.$$scope={dirty:$,ctx:p}),a.$set(S)},i(p){c||(g(n.$$.fragment,p),g(s.$$.fragment,p),g(a.$$.fragment,p),c=!0)},o(p){d(n.$$.fragment,p),d(s.$$.fragment,p),d(a.$$.fragment,p),c=!1},d(p){p&&(h(e),h(f),h(i)),v(n),v(s),v(a)}}}function uu(t){let e,r;return e=new tr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[au]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}class fu extends V{constructor(e){super(),K(this,e,null,uu,q,{})}}function cu(t){let e;return{c(){e=y("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pu(t){let e;return{c(){e=y(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $u(t){let e;return{c(){e=y("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function mu(t){let e;return{c(){e=y("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function hu(t){let e,r,n,o,s,l,f,i,u,a,c,p,$;return n=new B({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[pu]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[$u]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[mu]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("2022 AADF (annual average daily flow) data from "),w(n.$$.fragment),o=y(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),w(s.$$.fragment),l=y(" for details and caveats about the measurements."),f=T(),i=P("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,u=T(),a=P("p"),c=y("License: "),w(p.$$.fragment)},m(_,C){m(_,e,C),E(e,r),b(n,e,null),E(e,o),b(s,e,null),E(e,l),m(_,f,C),m(_,i,C),m(_,u,C),m(_,a,C),E(a,c),b(p,a,null),$=!0},p(_,C){const S={};C&64&&(S.$$scope={dirty:C,ctx:_}),n.$set(S);const L={};C&64&&(L.$$scope={dirty:C,ctx:_}),s.$set(L);const O={};C&64&&(O.$$scope={dirty:C,ctx:_}),p.$set(O)},i(_){$||(g(n.$$.fragment,_),g(s.$$.fragment,_),g(p.$$.fragment,_),$=!0)},o(_){d(n.$$.fragment,_),d(s.$$.fragment,_),d(p.$$.fragment,_),$=!1},d(_){_&&(h(e),h(f),h(i),h(u),h(a)),v(n),v(s),v(p)}}}function gu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[hu]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function jr(t){let e,r;return e=new ut({props:{colorScale:t[1],limits:t[2]}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p:te,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function du(t){let e,r,n,o,s,l;function f(a){t[3](a)}let i={id:Ze,$$slots:{right:[gu],default:[cu]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new Q({props:i}),H.push(()=>z(e,"checked",f));let u=t[0]&&jr(t);return s=new Y({props:{layer:Ze,tooltip:_u,show:t[0],clickable:!0}}),s.$on("click",wu),{c(){w(e.$$.fragment),n=T(),u&&u.c(),o=T(),w(s.$$.fragment)},m(a,c){b(e,a,c),m(a,n,c),u&&u.m(a,c),m(a,o,c),b(s,a,c),l=!0},p(a,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:a}),!r&&c&1&&(r=!0,p.checked=a[0],G(()=>r=!1)),e.$set(p),a[0]?u?(u.p(a,c),c&1&&g(u,1)):(u=jr(a),u.c(),g(u,1),u.m(o.parentNode,o)):u&&(he(),d(u,1,1,()=>{u=null}),ge());const $={};c&1&&($.show=a[0]),s.$set($)},i(a){l||(g(e.$$.fragment,a),g(u),g(s.$$.fragment,a),l=!0)},o(a){d(e.$$.fragment,a),d(u),d(s.$$.fragment,a),l=!1},d(a){a&&(h(n),h(o)),v(e,a),u&&u.d(a),v(s,a)}}}let Ze="vehicle_counts";function _u(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function wu(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function bu(t,e,r){let n;X(t,ee,u=>r(4,n=u));let o=U.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];de(n,Ze,`https://atip.uk/layers/v1/${Ze}.pmtiles`),dt(n,{id:Ze,source:Ze,sourceLayer:Ze,color:gt(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let f=!1;function i(u){f=u,r(0,f)}return[f,o,l,i]}class vu extends V{constructor(e){super(),K(this,e,bu,du,q,{})}}function yu(t){let e,r,n;return e=new we({props:{color:t[1]}}),{c(){w(e.$$.fragment),r=y(`
  Wards`)},m(o,s){b(e,o,s),m(o,r,s),n=!0},p:te,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),v(e,o)}}}function ku(t){let e;return{c(){e=y(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Su(t){let e;return{c(){e=y(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cu(t){let e,r,n,o,s,l,f,i,u,a;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[ku]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Su]},$$scope:{ctx:t}}}),{c(){e=P("p"),r=y("Data from "),w(n.$$.fragment),o=y(", as of May 2023."),s=T(),l=P("p"),f=y("License: "),w(i.$$.fragment),u=y(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),E(e,r),b(n,e,null),E(e,o),m(c,s,p),m(c,l,p),E(l,f),b(i,l,null),E(l,u),a=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const _={};p&32&&(_.$$scope={dirty:p,ctx:c}),i.$set(_)},i(c){a||(g(n.$$.fragment,c),g(i.$$.fragment,c),a=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),a=!1},d(c){c&&(h(e),h(s),h(l)),v(n),v(i)}}}function Lu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Cu]},$$scope:{ctx:t}}}),{c(){e=P("span"),w(r.$$.fragment),W(e,"slot","right")},m(o,s){m(o,e,s),b(r,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),r.$set(l)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),v(r)}}}function Ou(t){let e,r,n,o,s;function l(i){t[3](i)}let f={id:Ee,$$slots:{right:[Lu],default:[yu]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.checked=t[0]),e=new Q({props:f}),H.push(()=>z(e,"checked",l)),o=new Y({props:{layer:Ee,tooltip:Tu,show:t[0],clickable:!0}}),o.$on("click",Au),{c(){w(e.$$.fragment),n=T(),w(o.$$.fragment)},m(i,u){b(e,i,u),m(i,n,u),b(o,i,u),s=!0},p(i,[u]){const a={};u&32&&(a.$$scope={dirty:u,ctx:i}),!r&&u&1&&(r=!0,a.checked=i[0],G(()=>r=!1)),e.$set(a);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),v(e,i),v(o,i)}}}let Ee="wards";function Tu(t){return`<p>${t.properties.name}</p>`}function Au(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Du(t,e,r){let n;X(t,ee,i=>r(2,n=i));let o=U.wards,s=`${Ee}-outline`;de(n,Ee,`https://atip.uk/layers/v1/${Ee}.pmtiles`),We(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:_e(.5,0)}),Ce(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:2.5});let l=!1;function f(i){l=i,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,f]}class Eu extends V{constructor(e){super(),K(this,e,Du,Ou,q,{})}}function Pu(t){let e,r,n,o,s,l,f,i;return e=new ou({}),n=new Ml({}),s=new fu({}),f=new Qa({}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),o=T(),w(s.$$.fragment),l=T(),w(f.$$.fragment)},m(u,a){b(e,u,a),m(u,r,a),b(n,u,a),m(u,o,a),b(s,u,a),m(u,l,a),b(f,u,a),i=!0},i(u){i||(g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),g(f.$$.fragment,u),i=!0)},o(u){d(e.$$.fragment,u),d(n.$$.fragment,u),d(s.$$.fragment,u),d(f.$$.fragment,u),i=!1},d(u){u&&(h(r),h(o),h(l)),v(e,u),v(n,u),v(s,u),v(f,u)}}}function Nu(t){let e,r;return e=new bt({props:{small:!0,$$slots:{default:[Pu]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Iu(t){let e,r,n,o,s,l,f,i;return e=new Cl({}),n=new ka({}),s=new wi({}),f=new gl({}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),o=T(),w(s.$$.fragment),l=T(),w(f.$$.fragment)},m(u,a){b(e,u,a),m(u,r,a),b(n,u,a),m(u,o,a),b(s,u,a),m(u,l,a),b(f,u,a),i=!0},i(u){i||(g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),g(f.$$.fragment,u),i=!0)},o(u){d(e.$$.fragment,u),d(n.$$.fragment,u),d(s.$$.fragment,u),d(f.$$.fragment,u),i=!1},d(u){u&&(h(r),h(o),h(l)),v(e,u),v(n,u),v(s,u),v(f,u)}}}function Mu(t){let e,r;return e=new bt({props:{small:!0,$$slots:{default:[Iu]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function xu(t){let e,r,n,o,s,l,f,i,u,a;return e=new Na({}),n=new Eu({}),s=new Qi({}),f=new ta({}),u=new ma({}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),o=T(),w(s.$$.fragment),l=T(),w(f.$$.fragment),i=T(),w(u.$$.fragment)},m(c,p){b(e,c,p),m(c,r,p),b(n,c,p),m(c,o,p),b(s,c,p),m(c,l,p),b(f,c,p),m(c,i,p),b(u,c,p),a=!0},i(c){a||(g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(f.$$.fragment,c),g(u.$$.fragment,c),a=!0)},o(c){d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(f.$$.fragment,c),d(u.$$.fragment,c),a=!1},d(c){c&&(h(r),h(o),h(l),h(i)),v(e,c),v(n,c),v(s,c),v(f,c),v(u,c)}}}function Fu(t){let e,r;return e=new bt({props:{small:!0,$$slots:{default:[xu]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Bu(t){let e,r,n,o;return e=new Wi({}),n=new Gl({}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment)},m(s,l){b(e,s,l),m(s,r,l),b(n,s,l),o=!0},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),v(e,s),v(n,s)}}}function ju(t){let e,r,n,o;return e=new vu({}),n=new Ua({}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment)},m(s,l){b(e,s,l),m(s,r,l),b(n,s,l),o=!0},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),v(e,s),v(n,s)}}}function Ru(t){let e,r,n,o,s,l,f,i,u,a,c,p,$,_,C,S,L;e=new ll({}),n=new xe({props:{label:"Trip generators",$$slots:{default:[Nu]},$$scope:{ctx:t}}}),s=new xe({props:{label:"Existing infrastructure",$$slots:{default:[Mu]},$$scope:{ctx:t}}}),f=new xe({props:{label:"Boundaries",$$slots:{default:[Fu]},$$scope:{ctx:t}}}),u=new xe({props:{label:"Census",$$slots:{default:[Bu]},$$scope:{ctx:t}}}),c=new xe({props:{label:"Other",$$slots:{default:[ju]},$$scope:{ctx:t}}});function O(k){t[5](k)}let M={displayEnableButton:!0};return t[2]!==void 0&&(M.isInactive=t[2]),$=new Wn({props:M}),t[4]($),H.push(()=>z($,"isInactive",O)),S=new Kn({props:{style:t[0]}}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),o=T(),w(s.$$.fragment),l=T(),w(f.$$.fragment),i=T(),w(u.$$.fragment),a=T(),w(c.$$.fragment),p=T(),w($.$$.fragment),C=T(),w(S.$$.fragment)},m(k,D){b(e,k,D),m(k,r,D),b(n,k,D),m(k,o,D),b(s,k,D),m(k,l,D),b(f,k,D),m(k,i,D),b(u,k,D),m(k,a,D),b(c,k,D),m(k,p,D),b($,k,D),m(k,C,D),b(S,k,D),L=!0},p(k,D){const x={};D&64&&(x.$$scope={dirty:D,ctx:k}),n.$set(x);const I={};D&64&&(I.$$scope={dirty:D,ctx:k}),s.$set(I);const A={};D&64&&(A.$$scope={dirty:D,ctx:k}),f.$set(A);const F={};D&64&&(F.$$scope={dirty:D,ctx:k}),u.$set(F);const N={};D&64&&(N.$$scope={dirty:D,ctx:k}),c.$set(N);const j={};!_&&D&4&&(_=!0,j.isInactive=k[2],G(()=>_=!1)),$.$set(j);const J={};D&1&&(J.style=k[0]),S.$set(J)},i(k){L||(g(e.$$.fragment,k),g(n.$$.fragment,k),g(s.$$.fragment,k),g(f.$$.fragment,k),g(u.$$.fragment,k),g(c.$$.fragment,k),g($.$$.fragment,k),g(S.$$.fragment,k),L=!0)},o(k){d(e.$$.fragment,k),d(n.$$.fragment,k),d(s.$$.fragment,k),d(f.$$.fragment,k),d(u.$$.fragment,k),d(c.$$.fragment,k),d($.$$.fragment,k),d(S.$$.fragment,k),L=!1},d(k){k&&(h(r),h(o),h(l),h(i),h(a),h(p),h(C)),v(e,k),v(n,k),v(s,k),v(f,k),v(u,k),v(c,k),t[4](null),v($,k),v(S,k)}}}function Uu(t){let e,r,n,o;return e=new xe({props:{label:"Layers",open:!0,$$slots:{default:[Ru]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(s,l){b(e,s,l),r=!0,n||(o=Yt(window,"keydown",t[3]),n=!0)},p(s,[l]){const f={};l&71&&(f.$$scope={dirty:l,ctx:s}),e.$set(f)},i(s){r||(g(e.$$.fragment,s),r=!0)},o(s){d(e.$$.fragment,s),r=!1},d(s){v(e,s),n=!1,o()}}}function Hu(t,e,r){let n;X(t,lr,u=>r(2,n=u));let{style:o}=e,s;function l(u){!n&&u.key=="Escape"&&(s.disableStreetView(),u.preventDefault())}function f(u){H[u?"unshift":"push"](()=>{s=u,r(1,s)})}function i(u){n=u,lr.set(n)}return t.$$set=u=>{"style"in u&&r(0,o=u.style)},[o,s,n,l,f,i]}class Wu extends V{constructor(e){super(),K(this,e,Hu,Uu,q,{style:0})}}function zu(t){let e;return{c(){e=y("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gu(t){let e;return{c(){e=y("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vu(t){let e,r,n=t[0].authority_or_region+"",o,s,l,f,i=t[0].capital_scheme_id+"",u,a,c,p,$=t[0].funding_programme+"",_,C,S,L,O,M,k;return L=new Rt({props:{$$slots:{default:[zu]},$$scope:{ctx:t}}}),L.$on("click",t[3]),M=new Rt({props:{disabled:t[1],title:t[2],$$slots:{default:[Gu]},$$scope:{ctx:t}}}),M.$on("click",t[4]),{c(){e=P("p"),r=y("Authority or region: "),o=y(n),s=T(),l=P("p"),f=y("Capital scheme ID: "),u=y(i),a=T(),c=P("p"),p=y("Funding programme: "),_=y($),C=T(),S=P("div"),w(L.$$.fragment),O=T(),w(M.$$.fragment),W(S,"class","govuk-button-group")},m(D,x){m(D,e,x),E(e,r),E(e,o),m(D,s,x),m(D,l,x),E(l,f),E(l,u),m(D,a,x),m(D,c,x),E(c,p),E(c,_),m(D,C,x),m(D,S,x),b(L,S,null),E(S,O),b(M,S,null),k=!0},p(D,x){(!k||x&1)&&n!==(n=D[0].authority_or_region+"")&&me(o,n),(!k||x&1)&&i!==(i=D[0].capital_scheme_id+"")&&me(u,i),(!k||x&1)&&$!==($=D[0].funding_programme+"")&&me(_,$);const I={};x&256&&(I.$$scope={dirty:x,ctx:D}),L.$set(I);const A={};x&256&&(A.$$scope={dirty:x,ctx:D}),M.$set(A)},i(D){k||(g(L.$$.fragment,D),g(M.$$.fragment,D),k=!0)},o(D){d(L.$$.fragment,D),d(M.$$.fragment,D),k=!1},d(D){D&&(h(e),h(s),h(l),h(a),h(c),h(C),h(S)),v(L),v(M)}}}function Ku(t){let e,r;return e=new xe({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Vu]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function qu(t,e,r){let n,o;X(t,at,c=>r(6,n=c)),X(t,ee,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,f=!l.has(s.authority_or_region),i=f?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function u(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(jn(c),{padding:20,animate:!1})}function a(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,l=c.authorityNames)},[s,f,i,u,a,l]}class Zu extends V{constructor(e){super(),K(this,e,qu,Ku,q,{scheme:0,authorityNames:5})}}const Xu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ie=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{f(r.next(i))}catch(u){o(u)}},l=i=>{try{f(r.throw(i))}catch(u){o(u)}},f=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);f((r=r.apply(t,e)).next())}),ce=Uint8Array,it=Uint16Array,Yu=Int32Array,yn=new ce([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),kn=new ce([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ju=new ce([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Sn=function(t,e){for(var r=new it(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new Yu(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},Cn=Sn(yn,2),Ln=Cn.b,Qu=Cn.r;Ln[28]=258,Qu[258]=28;var ef=Sn(kn,0),tf=ef.b,qt=new it(32768);for(R=0;R<32768;++R)Me=(R&43690)>>1|(R&21845)<<1,Me=(Me&52428)>>2|(Me&13107)<<2,Me=(Me&61680)>>4|(Me&3855)<<4,qt[R]=((Me&65280)>>8|(Me&255)<<8)>>1;var Me,R,ht=function(t,e,r){for(var n=t.length,o=0,s=new it(e);o<n;++o)t[o]&&++s[t[o]-1];var l=new it(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var f;if(r){f=new it(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var u=o<<4|t[o],a=e-t[o],c=l[t[o]-1]++<<a,p=c|(1<<a)-1;c<=p;++c)f[qt[c]>>i]=u}else for(f=new it(n),o=0;o<n;++o)t[o]&&(f[o]=qt[l[t[o]-1]++]>>15-t[o]);return f},kt=new ce(288);for(R=0;R<144;++R)kt[R]=8;var R;for(R=144;R<256;++R)kt[R]=9;var R;for(R=256;R<280;++R)kt[R]=7;var R;for(R=280;R<288;++R)kt[R]=8;var R,On=new ce(32);for(R=0;R<32;++R)On[R]=5;var R,rf=ht(kt,9,1),nf=ht(On,5,1),Bt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},jt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},of=function(t){return(t+7)/8|0},sf=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new ce(r-e);return n.set(t.subarray(e,r)),n},lf=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ae=function(t,e,r){var n=new Error(e||lf[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ae),!r)throw n;return n},rr=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new ce(0);var l=!r||e.i!=2,f=e.i;r||(r=new ce(o*3));var i=function(nr){var or=r.length;if(nr>or){var sr=new ce(Math.max(or*2,nr));sr.set(r),r=sr}},u=e.f||0,a=e.p||0,c=e.b||0,p=e.l,$=e.d,_=e.m,C=e.n,S=o*8;do{if(!p){u=ve(t,a,1);var L=ve(t,a+1,3);if(a+=3,L)if(L==1)p=rf,$=nf,_=9,C=5;else if(L==2){var D=ve(t,a,31)+257,x=ve(t,a+10,15)+4,I=D+ve(t,a+5,31)+1;a+=14;for(var A=new ce(I),F=new ce(19),N=0;N<x;++N)F[Ju[N]]=ve(t,a+N*3,7);a+=x*3;for(var j=Bt(F),J=(1<<j)-1,re=ht(F,j,1),N=0;N<I;){var Le=re[ve(t,a,J)];a+=Le&15;var O=Le>>4;if(O<16)A[N++]=O;else{var pe=0,oe=0;for(O==16?(oe=3+ve(t,a,3),a+=2,pe=A[N-1]):O==17?(oe=3+ve(t,a,7),a+=3):O==18&&(oe=11+ve(t,a,127),a+=7);oe--;)A[N++]=pe}}var ze=A.subarray(0,D),le=A.subarray(D);_=Bt(ze),C=Bt(le),p=ht(ze,_,1),$=ht(le,C,1)}else ae(1);else{var O=of(a)+4,M=t[O-4]|t[O-3]<<8,k=O+M;if(k>o){f&&ae(0);break}l&&i(c+M),r.set(t.subarray(O,k),c),e.b=c+=M,e.p=a=k*8,e.f=u;continue}if(a>S){f&&ae(0);break}}l&&i(c+131072);for(var ft=(1<<_)-1,Be=(1<<C)-1,Qe=a;;Qe=a){var pe=p[jt(t,a)&ft],$e=pe>>4;if(a+=pe&15,a>S){f&&ae(0);break}if(pe||ae(2),$e<256)r[c++]=$e;else if($e==256){Qe=a,p=null;break}else{var et=$e-254;if($e>264){var N=$e-257,Ie=yn[N];et=ve(t,a,(1<<Ie)-1)+Ln[N],a+=Ie}var tt=$[jt(t,a)&Be],rt=tt>>4;tt||ae(3),a+=tt&15;var le=tf[rt];if(rt>3){var Ie=kn[rt];le+=jt(t,a)&(1<<Ie)-1,a+=Ie}if(a>S){f&&ae(0);break}l&&i(c+131072);var nt=c+et;if(c<le){var ct=s-le,Mn=Math.min(le,nt);for(ct+c<0&&ae(3);c<Mn;++c)r[c]=n[ct+c]}for(;c<nt;c+=4)r[c]=r[c-le],r[c+1]=r[c+1-le],r[c+2]=r[c+2-le],r[c+3]=r[c+3-le];c=nt}}e.l=p,e.p=Qe,e.b=c,e.f=u,p&&(u=1,e.m=_,e.d=$,e.n=C)}while(!u);return c==r.length?r:sf(r,0,c)},af=new ce(0),uf=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&ae(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},ff=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},cf=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ae(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&ae(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function pf(t,e){return rr(t,{i:2},e&&e.out,e&&e.dictionary)}function $f(t,e){var r=uf(t);return r+8>t.length&&ae(6,"invalid gzip data"),rr(t.subarray(r,-8),{i:2},e&&e.out||new ce(ff(t)),e&&e.dictionary)}function mf(t,e){return rr(t.subarray(cf(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Zt(t,e){return t[0]==31&&t[1]==139&&t[2]==8?$f(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?pf(t,e):mf(t,e)}var hf=typeof TextDecoder<"u"&&new TextDecoder,gf=0;try{hf.decode(af,{stream:!0}),gf=1}catch{}var Tn=(t,e)=>t*Math.pow(2,e),pt=(t,e)=>Math.floor(t/Math.pow(2,e)),Dt=(t,e)=>Tn(t.getUint16(e+1,!0),8)+t.getUint8(e),An=(t,e)=>Tn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),df=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Dt(n,o+1);if(e!=s)return e-s;const l=Dt(n,o+4);return r!=l?r-l:0},_f=(t,e,r,n)=>{const o=Dn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Rr=(t,e,r,n)=>{const o=Dn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},Dn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const l=s+o>>1,f=df(e,r,n,t,l*17);if(f>0)o=l+1;else if(f<0)s=l-1;else return[An(t,l*17+7),t.getUint32(l*17+13,!0)]}return null},wf=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,En=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Dt(t,e*17+1),y:Dt(t,e*17+4),offset:An(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Ur=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(En(r,n));return bf(e)},bf=t=>{t.sort(wf);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=pt(o.offset,8)&255,r[n*17+9]=pt(o.offset,16)&255,r[n*17+10]=pt(o.offset,24)&255,r[n*17+11]=pt(o.offset,32)&255,r[n*17+12]=pt(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},vf=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=En(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),f=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:f}}return null};function yf(t){return ie(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let f=0;l.compression==="gzip"&&(f=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let u=0;"maxzoom"in l&&(u=+l.maxzoom);let a=0,c=0,p=0,$=-180,_=-85,C=180,S=85;if(l.bounds){const O=l.bounds.split(",");$=+O[0],_=+O[1],C=+O[2],S=+O[3]}if(l.center){const O=l.center.split(",");a=+O[0],c=+O[1],p=+O[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:f,tileType:1,minZoom:i,maxZoom:u,minLon:$,minLat:_,maxLon:C,maxLat:S,centerZoom:p,centerLon:a,centerLat:c,etag:e.etag}})}function kf(t,e,r,n,o,s,l){return ie(this,null,function*(){let f=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(f=Ur(f));const i=Rr(new DataView(f),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=Zt(new Uint8Array(c))),{data:c}}const u=vf(new DataView(f),{z:n,x:o,y:s});if(u){const a=_f(new DataView(f),u.z,u.x,u.y);if(a){let c=yield r.getArrayBuffer(e,a.offset,a.length,t);t.specVersion===1&&(c=Ur(c));const p=Rr(new DataView(c),n,o,s);if(p){let _=(yield e.getBytes(p.offset,p.length,l)).data;const C=new DataView(_);return C.getUint8(0)==31&&C.getUint8(1)==139&&(_=Zt(new Uint8Array(_))),{data:_}}}}})}var Pn={getHeader:yf,getZxy:kf},Sf=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Hr(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new Hr(o),this.tiles.set(o,s));const l=n[2],f=n[3],i=n[4],u=new AbortController,a=u.signal;let c=()=>{u.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+f,+i,a).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function ot(t,e){return(e>>>0)*4294967296+(t>>>0)}function Cf(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return ot(t,n);throw new Error("Expected varint not more than 10 bytes")}function $t(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,Cf(r,t))}function Lf(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var Of=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Tf(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=Of[t],o=Math.pow(2,t);let s=0,l=0,f=0;const i=[e,r];let u=o/2;for(;u>0;)s=(i[0]&u)>0?1:0,l=(i[1]&u)>0?1:0,f+=u*u*(3*s^l),Lf(u,i,s,l),u=u/2;return n+f}function Nn(t,e){return ie(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Zt(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Af=127;function Df(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var Ef=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ie(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const f=o.headers.get("Content-Range");if(!f||!f.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+f.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ye(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Pf(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ye(r,8),rootDirectoryLength:ye(r,16),jsonMetadataOffset:ye(r,24),jsonMetadataLength:ye(r,32),leafDirectoryOffset:ye(r,40),leafDirectoryLength:ye(r,48),tileDataOffset:ye(r,56),tileDataLength:ye(r,64),numAddressedTiles:ye(r,72),numTileEntries:ye(r,80),numTileContents:ye(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function In(t){const e={buf:new Uint8Array(t),pos:0},r=$t(e),n=[];let o=0;for(let s=0;s<r;s++){const l=$t(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<r;s++)n[s].runLength=$t(e);for(let s=0;s<r;s++)n[s].length=$t(e);for(let s=0;s<r;s++){const l=$t(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function Nf(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var lt=class extends Error{};function If(t,e,r,n){return ie(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Nf(o.data)<3)return[yield Pn.getHeader(t)];const l=o.data.slice(0,Af);let f=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),f=void 0);const i=Pf(l,f);if(r){const u=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),a=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=In(yield e(u,i.internalCompression));return[i,[a,c.length,c]]}return[i,void 0]})}function Mf(t,e,r,n,o){return ie(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new lt(s.etag);const l=yield e(s.data,o.internalCompression),f=In(l);if(f.length===0)throw new Error("Empty directory is invalid");return f})}var xf=class{constructor(t=100,e=!0,r=Nn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ie(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{If(t,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{Mf(t,this.decompress,e,r,n).then(i=>{l(i),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,f)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new lt(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{f(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ie(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Hr=class{constructor(t,e,r){typeof t=="string"?this.source=new Ef(t):this.source=t,r?this.decompress=r:this.decompress=Nn,e?this.cache=e:this.cache=new xf}getHeader(){return ie(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ie(this,null,function*(){const o=Tf(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Pn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let l=s.rootDirectoryOffset,f=s.rootDirectoryLength;for(let i=0;i<=3;i++){const u=yield this.cache.getDirectory(this.source,l,f,s),a=Df(u,o);if(a)if(a.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+a.offset,a.length,n);if(s.etag&&s.etag!==c.etag)throw new lt(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+a.offset,f=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ie(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof lt)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ie(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new lt(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ie(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof lt)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function Ff(t){return Xt(()=>{let e=new Sf;ar.addProtocol("pmtiles",e.tile)}),tn(()=>{ar.removeProtocol("pmtiles")}),[]}class Bf extends V{constructor(e){super(),K(this,e,Ff,null,q,{})}}function Wr(t,e,r){const n=t.slice();return n[13]=e[r],n}function zr(t){let e,r,n,o;function s(i){t[9](i)}function l(i){t[10](i)}let f={schemes:t[1]};return t[2]!==void 0&&(f.schemesToBeShown=t[2]),t[3]!==void 0&&(f.filterText=t[3]),e=new fi({props:f}),H.push(()=>z(e,"schemesToBeShown",s)),H.push(()=>z(e,"filterText",l)),{c(){w(e.$$.fragment)},m(i,u){b(e,i,u),o=!0},p(i,u){const a={};u&2&&(a.schemes=i[1]),!r&&u&4&&(r=!0,a.schemesToBeShown=i[2],G(()=>r=!1)),!n&&u&8&&(n=!0,a.filterText=i[3],G(()=>n=!1)),e.$set(a)},i(i){o||(g(e.$$.fragment,i),o=!0)},o(i){d(e.$$.fragment,i),o=!1},d(i){v(e,i)}}}function Gr(t){let e,r;return e=new Zu({props:{scheme:t[13],authorityNames:t[5]}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Vr(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&Gr(t);return{c(){o&&o.c(),r=Qt()},m(s,l){o&&o.m(s,l),m(s,r,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&g(o,1)):(o=Gr(s),o.c(),g(o,1),o.m(r.parentNode,r)):o&&(he(),d(o,1,1,()=>{o=null}),ge())},i(s){n||(g(o),n=!0)},o(s){d(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function jf(t){let e,r,n,o,s,l,f,i,u,a,c,p,$,_;s=new qn({props:{boundaryGeojson:t[4]}});let C=!1;i=new Xn({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),a=new Xr({props:{errorMessage:t[0]}});let S=t[1].size>0&&zr(t),L=He(t[1].values()),O=[];for(let k=0;k<L.length;k+=1)O[k]=Vr(Wr(t,L,k));const M=k=>d(O[k],1,1,()=>{O[k]=null});return{c(){e=P("div"),r=P("div"),n=P("h1"),n.textContent="Browse schemes",o=T(),w(s.$$.fragment),l=T(),f=T(),w(i.$$.fragment),u=T(),w(a.$$.fragment),c=T(),S&&S.c(),p=T(),$=P("ul");for(let k=0;k<O.length;k+=1)O[k].c();Fe(r,"display","flex"),Fe(r,"justify-content","space-between"),W(e,"slot","sidebar"),W(e,"class","govuk-prose")},m(k,D){m(k,e,D),E(e,r),E(r,n),E(r,o),b(s,r,null),E(e,l),E(e,f),b(i,e,null),E(e,u),b(a,e,null),E(e,c),S&&S.m(e,null),E(e,p),E(e,$);for(let x=0;x<O.length;x+=1)O[x]&&O[x].m($,null);_=!0},p(k,D){const x={};D&16&&(x.boundaryGeojson=k[4]),s.$set(x);const I={};if(D&1&&(I.errorMessage=k[0]),a.$set(I),k[1].size>0?S?(S.p(k,D),D&2&&g(S,1)):(S=zr(k),S.c(),g(S,1),S.m(e,p)):S&&(he(),d(S,1,1,()=>{S=null}),ge()),D&38){L=He(k[1].values());let A;for(A=0;A<L.length;A+=1){const F=Wr(k,L,A);O[A]?(O[A].p(F,D),g(O[A],1)):(O[A]=Vr(F),O[A].c(),g(O[A],1),O[A].m($,null))}for(he(),A=L.length;A<O.length;A+=1)M(A);ge()}},i(k){if(!_){g(s.$$.fragment,k),g(C),g(i.$$.fragment,k),g(a.$$.fragment,k),g(S);for(let D=0;D<L.length;D+=1)g(O[D]);_=!0}},o(k){d(s.$$.fragment,k),d(C),d(i.$$.fragment,k),d(a.$$.fragment,k),d(S),O=O.filter(Boolean);for(let D=0;D<O.length;D+=1)d(O[D]);_=!1},d(k){k&&h(e),v(s),v(i),v(a),S&&S.d(),Ot(O,k)}}}function Rf(t){let e,r,n,o,s,l,f,i,u,a,c;return e=new Zn({props:{colorInterventions:rn("v1")}}),n=new Y({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new Y({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),f=new Y({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),a=new Wu({props:{style:t[6]}}),{c(){w(e.$$.fragment),r=T(),w(n.$$.fragment),o=T(),w(s.$$.fragment),l=T(),w(f.$$.fragment),i=T(),u=P("div"),w(a.$$.fragment),W(u,"class","top-right svelte-u44ed2")},m(p,$){b(e,p,$),m(p,r,$),b(n,p,$),m(p,o,$),b(s,p,$),m(p,l,$),b(f,p,$),m(p,i,$),m(p,u,$),b(a,u,null),c=!0},p:te,i(p){c||(g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(f.$$.fragment,p),g(a.$$.fragment,p),c=!0)},o(p){d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(f.$$.fragment,p),d(a.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(l),h(i),h(u)),v(e,p),v(n,p),v(s,p),v(f,p),v(a)}}}function Uf(t){let e,r,n,o,s;return r=new Bf({}),o=new Gn({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Rf]},$$scope:{ctx:t}}}),{c(){e=P("div"),w(r.$$.fragment),n=T(),w(o.$$.fragment),W(e,"slot","main")},m(l,f){m(l,e,f),b(r,e,null),E(e,n),b(o,e,null),s=!0},p(l,f){const i={};f&65536&&(i.$$scope={dirty:f,ctx:l}),o.$set(i)},i(l){s||(g(r.$$.fragment,l),g(o.$$.fragment,l),s=!0)},o(l){d(r.$$.fragment,l),d(o.$$.fragment,l),s=!1},d(l){l&&h(e),v(r),v(o)}}}function Hf(t){let e,r;return e=new zn({props:{$$slots:{main:[Uf],sidebar:[jf]},$$scope:{ctx:t}}}),{c(){w(e.$$.fragment)},m(n,o){b(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Wf(t,e,r){let n;X(t,at,S=>r(4,n=S));let o=new Set(Xu);Xt(()=>{Rn()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",f="",i=new Map,u=new Set,a="";tn(()=>{at.set(Zr())});function c(S){try{let L=JSON.parse(S);r(1,i=Js(L)),at.set(L),r(0,f="")}catch(L){r(0,f=`The file you loaded is broken: ${L}`)}}function p(S){let L=S.properties;var O='<div style="max-width: 30vw;">';return O+=`<h2>${$(L.name)} (${L.intervention_type})</h2>`,O+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(O+=`<p>Length: ${Un(L.length_meters)}</p>`),L.description&&(O+=`<p>${$(L.description)}</p>`),O+="</div>",O}function $(S){return a?S.replace(new RegExp(a,"gi"),L=>`<mark>${L}</mark>`):S}function _(S){u=S,r(2,u)}function C(S){a=S,r(3,a)}return[f,i,u,a,n,o,l,c,p,_,C]}class zf extends V{constructor(e){super(),K(this,e,Wf,Hf,q,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new zf({target:document.getElementById("app")});
