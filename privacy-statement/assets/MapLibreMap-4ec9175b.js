var Ct=Object.defineProperty;var vt=(o,e,t)=>e in o?Ct(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var Ye=(o,e,t)=>(vt(o,typeof e!="symbol"?e+"":e,t),t);import{S as Y,i as q,s as N,g as Me,k as ge,l as H,p as he,o as R,P as me,ai as ht,av as We,N as wt,aw as je,D as Le,t as A,A as _e,e as w,w as ke,aq as Ze,x as D,E as we,F as ve,G as ze,H as Oe,I as Te,J as Ie,b as Pe,a as He,c as ne,m as ie,d as Re,f as re,a3 as oe,ak as de,ax as St,aj as qe,a8 as Je,a1 as Mt,at as Lt,a2 as zt,j as Ce,ay as Ot,r as yt,az as Tt,h as It,n as Xe,am as Bt,ah as xe,ad as Et}from"./stores-65341194.js";import{c as bt,b as Pt,E as Gt}from"./index-f6ee48aa.js";const Ht=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Rt(o){let e;return{c(){e=Me("div"),e.innerHTML=`<p class="govuk-phase-banner__content"><strong class="govuk-tag govuk-phase-banner__content__tag">Alpha</strong> <span class="govuk-phase-banner__text">This is a new service. Contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      with any feedback.</span></p>`,ge(e,"class","govuk-phase-banner")},m(t,n){H(t,e,n)},p:he,i:he,o:he,d(t){t&&R(e)}}}class Yo extends Y{constructor(e){super(),q(this,e,null,Rt,N,{})}}const Fe=me(""),Ne=me(null);async function Ft(o){let e=ht(Ne);if(!o||!e)return"Google (attributions loading)";let[t,n]=e,r=o.getBounds(),i=`https://tile.googleapis.com/tile/v1/viewport?session=${n}&key=${t}&zoom=${Math.floor(o.getZoom())}&north=${r.getNorth()}&south=${r.getSouth()}&east=${r.getEast()}&west=${r.getWest()}`;return(await(await fetch(i)).json()).copyright}function qo(){let o=[];return bt()=="Private (development)"&&(o=o.concat([["google","Google satellite"],["Road","OS Road"],["Light","OS Light"],["Outdoor","OS Outdoor"],["bluesky","Bluesky Satellite (12.5cm)"]])),o.concat([["streets","MapTiler Streets"],["hybrid","MapTiler Satellite"],["dataviz","MapTiler Dataviz"],["uk-openzoomstack-light","OS Open Zoomstack"]])}async function pe(o){if(Ne.set(null),o=="streets"||o=="hybrid"||o=="dataviz"||o=="uk-openzoomstack-light")return Fe.set("&copy; MapTiler &copy; OpenStreetMap contributors"),`https://api.maptiler.com/maps/${o}/style.json?key=MZEJTanw3WpxRvt7qDfo`;let t=await(await fetch(`${Pt()}/api_keys.json`)).json(),n,r;if(o=="google"){let i=t.google,l=await Dt(i);n=`https://tile.googleapis.com/v1/2dtiles/{z}/{x}/{y}?session=${l}&key=${i}`,r="Google (attributions loading)",Ne.set([i,l])}else o=="bluesky"?(n=`https://ogc.apps.midgard.airbusds-cint.com/apgb/wmts/rest/apgb:AP-12CM5-GB-LATEST/default/EPSG-3857/EPSG:3857:{z}/{y}/{x}?GUID=${t.bluesky}&format=image/png&TRANSPARENT=FALSE,`,r="Bluesky"):(n=`https://api.os.uk/maps/raster/v1/zxy/${o}_3857/{z}/{x}/{y}.png?key=${t.ordnance_survey}`,r="Contains OS data &copy; Crown copyright and database rights 2023");return Fe.set(r),{version:8,sources:{"raster-tiles":{type:"raster",tiles:[n],tileSize:256,attribution:r}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:"https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=MZEJTanw3WpxRvt7qDfo"}}async function Dt(o){try{let t=await(await fetch(`https://tile.googleapis.com/v1/createSession?key=${o}`,{method:"POST",body:JSON.stringify({mapType:"satellite",language:"en-GB",region:"GB"})})).json();return"session"in t?t.session:(console.error(`Couldn't get Google tile session key: ${JSON.stringify(t)}`),"")}catch(e){return console.error(`Couldn't get Google tile session key: ${e}`),""}}let Zt=Date.now();function Ue(o){return`${o}-${Zt++}`}const Qe=Symbol.for("svelte-maplibre");function Be(){return wt(Qe)}function Ut(o){let e=new WeakMap;return t=>{var l;let n=e.get(t.originalEvent);if(n!==void 0)return n;let i=(l=t.target.queryRenderedFeatures(t.point).find(f=>{var u;return(u=o.get(f.layer.id))==null?void 0:u.interactive}))==null?void 0:l.layer.id;return e.set(t.originalEvent,i),i}}function jt(){let o=new Map;return We(Qe,{map:me(null),source:je(null),layer:je(null),popupTarget:je(null),cluster:me(),loadedImages:me(new Set),minzoom:me(0),maxzoom:me(24),layerEvent:me(null),layerInfo:o,eventTopMost:Ut(o),markerClickManager:new Kt})}function $e(o){return{subscribe:o.subscribe}}function Ke({key:o,setPopupTarget:e=!1,setCluster:t=!1,setMouseEvent:n=!1}){let r=Be(),i=me(null),l=$e(i),f={...r,[o]:$e(i)};if(e&&(f.popupTarget=l),n){let u=me(null);f.layerEvent=u,r.layerEvent=u}return t&&(f.cluster=me()),We(Qe,f),{...r,self:i}}function Nt(){return Ke({key:"source",setCluster:!0})}function Wt(o=!0){return Ke({key:"layer",setPopupTarget:o,setMouseEvent:o})}function Jo(){return Ke({key:"popupTarget",setPopupTarget:!0,setMouseEvent:!0})}function Qt(o){return"layerType"in o&&o.layerType==="deckgl"}class Kt{constructor(){Ye(this,"_handlers",new Set)}add(e){this._handlers.add(e)}remove(e){this._handlers.delete(e)}handleClick(e){for(const t of this._handlers)t(e)}}function et(o){let e;return t=>{if(t)for(let n in t){let r=e==null?void 0:e[n],i=t[n];r!==i&&o(n,i,r)}else if(e)for(let n in e)o(n,void 0,e[n]);e=t}}function Vt(o,...e){let t=[o];for(let n of e)if(n)Array.isArray(n)&&n[0]===o?t.push(...n.slice(1)):t.push(n);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Yt(o){return o===!0?["has","point_count"]:o===!1?["!",["has","point_count"]]:void 0}function Xo(o,e){return["case",["boolean",["feature-state","hover"],!1],e,o]}var De=qt;function qt(o){var e,t,n;if(o){if(Array.isArray(o)){for(e=[],t=o.length,n=0;n<t;n++){var r=o[n];r!=null&&e.push(r)}return e}if(typeof o=="object"){e={};var i=Object.keys(o);for(t=i.length,n=0;n<t;n++){var l=i[n],f=o[l];f!=null&&(e[l]=f)}return e}}}function tt(o){let e=o[0],t,n,r=ot(o);return{c(){r.c(),t=Le()},m(i,l){r.m(i,l),H(i,t,l),n=!0},p(i,l){l[0]&1&&N(e,e=i[0])?(_e(),w(r,1,1,he),ke(),r=ot(i),r.c(),A(r,1),r.m(t.parentNode,t)):r.p(i,l)},i(i){n||(A(r),n=!0)},o(i){w(r),n=!1},d(i){i&&R(t),r.d(i)}}}function ot(o){let e;const t=o[36].default,n=ze(t,o,o[35],null);return{c(){n&&n.c()},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i[1]&16)&&Oe(n,t,r,r[35],e?Ie(t,r[35],i,null):Te(r[35]),null)},i(r){e||(A(n,r),e=!0)},o(r){w(n,r),e=!1},d(r){n&&n.d(r)}}}function Jt(o){let e,t,n=o[0]&&tt(o);return{c(){n&&n.c(),e=Le()},m(r,i){n&&n.m(r,i),H(r,e,i),t=!0},p(r,i){r[0]?n?(n.p(r,i),i[0]&1&&A(n,1)):(n=tt(r),n.c(),A(n,1),n.m(e.parentNode,e)):n&&(_e(),w(n,1,1,()=>{n=null}),ke())},i(r){t||(A(n),t=!0)},o(r){w(n),t=!1},d(r){r&&R(e),n&&n.d(r)}}}function Xt(o,e,t){let n,r,i,l,f,u,m,a,c,_,S,h,{$$slots:C={},$$scope:b}=e,{id:L=Ue("layer")}=e,{source:P=void 0}=e,{sourceLayer:B=void 0}=e,{beforeId:Z=void 0}=e,{beforeLayerType:G=void 0}=e,{type:I}=e,{paint:E=void 0}=e,{layout:k=void 0}=e,{filter:T=void 0}=e,{applyToClusters:W=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:ye=void 0}=e,{manageHoverState:J=!1}=e,{hovered:x=null}=e,{interactive:p=!0}=e,{hoverCursor:$=void 0}=e,{eventsIfTopMost:le=!1}=e;const v=Ze(),{map:fe,source:Q,self:Ae,minzoom:ue,maxzoom:K,eventTopMost:U,layerInfo:be}=Wt();D(o,fe,y=>t(31,c=y)),D(o,Q,y=>t(32,_=y)),D(o,Ae,y=>t(0,a=y)),D(o,ue,y=>t(34,h=y)),D(o,K,y=>t(33,S=y)),we(()=>{a&&c&&(be.delete(a),c==null||c.removeLayer(a))});let O;function j(y){var g,X;if(!p||!a||!c||le&&U(y)!==a)return;let z=y.features??[],ce=(X=(g=z[0])==null?void 0:g.properties)==null?void 0:X.cluster_id,V={event:y,map:c,clusterId:ce,layer:a,source:f,features:z};v(y.type,V)}function se(y){var g,X;if(!p||!a||!c||le&&U(y)!==a)return;$&&(c.getCanvas().style.cursor=$);let z=y.features??[];t(6,x=z[0]??null);let ce=(X=(g=z[0])==null?void 0:g.properties)==null?void 0:X.cluster_id;v("mouseenter",{event:y,map:c,clusterId:ce,layer:a,source:f,features:z})}function ae(y){var g,X,s;if(!p||!c)return;if(le&&U(y)!==a){t(6,x=null),J&&O!==void 0&&(c==null||c.setFeatureState({source:f,sourceLayer:B,id:O},{hover:!1}),O=void 0);return}c.getCanvas().style.cursor=$;let z=y.features??[],ce=(X=(g=z[0])==null?void 0:g.properties)==null?void 0:X.cluster_id,V=(s=z[0])==null?void 0:s.id;V!==O&&(J&&(O!==void 0&&(c==null||c.setFeatureState({source:f,id:O,sourceLayer:B},{hover:!1})),c==null||c.setFeatureState({source:f,id:V,sourceLayer:B},{hover:!0})),O=V,t(6,x=z[0]??null)),v("mousemove",{event:y,map:c,clusterId:ce,layer:a,source:f,features:z})}function Se(y){if(!(!p||!a||!c)){if($&&(c.getCanvas().style.cursor=""),t(6,x=null),J&&O!==void 0){const z={source:f,id:O,sourceLayer:B};c==null||c.setFeatureState(z,{hover:!1}),O=void 0}v("mouseleave",{map:c,layer:a,source:f})}}let ee=!0;function te(y){c&&(c.off("click",y,j),c.off("dblclick",y,j),c.off("contextmenu",y,j),c.off("mouseenter",y,se),c.off("mousemove",y,ae),c.off("mouseleave",y,Se))}return we(()=>{c&&a&&te(a)}),o.$$set=y=>{"id"in y&&t(7,L=y.id),"source"in y&&t(8,P=y.source),"sourceLayer"in y&&t(9,B=y.sourceLayer),"beforeId"in y&&t(10,Z=y.beforeId),"beforeLayerType"in y&&t(11,G=y.beforeLayerType),"type"in y&&t(12,I=y.type),"paint"in y&&t(13,E=y.paint),"layout"in y&&t(14,k=y.layout),"filter"in y&&t(15,T=y.filter),"applyToClusters"in y&&t(16,W=y.applyToClusters),"minzoom"in y&&t(17,d=y.minzoom),"maxzoom"in y&&t(18,ye=y.maxzoom),"manageHoverState"in y&&t(19,J=y.manageHoverState),"hovered"in y&&t(6,x=y.hovered),"interactive"in y&&t(20,p=y.interactive),"hoverCursor"in y&&t(21,$=y.hoverCursor),"eventsIfTopMost"in y&&t(22,le=y.eventsIfTopMost),"$$scope"in y&&t(35,b=y.$$scope)},o.$$.update=()=>{if(o.$$.dirty[0]&65536&&t(30,n=Yt(W)),o.$$.dirty[0]&1073774592&&t(24,r=Vt("all",n,T)),o.$$.dirty[0]&131072|o.$$.dirty[1]&8&&t(26,i=d??h),o.$$.dirty[0]&262144|o.$$.dirty[1]&4&&t(25,l=ye??S),o.$$.dirty[0]&256|o.$$.dirty[1]&2&&t(29,f=P||_),o.$$.dirty[0]&654343809|o.$$.dirty[1]&1&&c&&a!==L&&f){a&&(te(a),be.delete(a));let y=Z;if(!Z&&G){let z=c.getStyle().layers,ce=typeof G=="function"?G:g=>g.type===G,V=z==null?void 0:z.find(ce);V&&(y=V.id)}ve(Ae,a=L,a),c.addLayer(De({id:a,type:I,source:f,"source-layer":B,filter:r,paint:E,layout:k,minzoom:i,maxzoom:l}),y),t(23,ee=!0),c.on("click",a,j),c.on("dblclick",a,j),c.on("contextmenu",a,j),c.on("mouseenter",a,se),c.on("mousemove",a,ae),c.on("mouseleave",a,Se)}o.$$.dirty[0]&1048577&&a&&be.set(a,{interactive:p}),o.$$.dirty[0]&1|o.$$.dirty[1]&1&&t(28,u=a?et((y,z)=>{c!=null&&c.style._loaded?c.setPaintProperty(a,y,z):c==null||c.once("styledata",()=>c==null?void 0:c.setPaintProperty(a,y,z))}):void 0),o.$$.dirty[0]&1|o.$$.dirty[1]&1&&t(27,m=a?et((y,z)=>{c!=null&&c.style._loaded?c.setLayoutProperty(a,y,z):c==null||c.once("styledata",()=>c==null?void 0:c.setLayoutProperty(a,y,z))}):void 0),o.$$.dirty[0]&268443648&&(u==null||u(E)),o.$$.dirty[0]&134234112&&(m==null||m(k)),o.$$.dirty[0]&100663297|o.$$.dirty[1]&1&&a&&(c==null||c.setLayerZoomRange(a,i,l)),o.$$.dirty[0]&25165825|o.$$.dirty[1]&1&&a&&(ee?t(23,ee=!1):c==null||c.setFilter(a,r))},[a,fe,Q,Ae,ue,K,x,L,P,B,Z,G,I,E,k,T,W,d,ye,J,p,$,le,ee,r,l,i,m,u,f,n,c,_,S,h,b,C]}class _t extends Y{constructor(e){super(),q(this,e,Xt,Jt,N,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function xt(o){let e;const t=o[15].default,n=ze(t,o,o[23],null);return{c(){n&&n.c()},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i&8388608)&&Oe(n,t,r,r[23],e?Ie(t,r[23],i,null):Te(r[23]),null)},i(r){e||(A(n,r),e=!0)},o(r){w(n,r),e=!1},d(r){n&&n.d(r)}}}function pt(o){let e,t,n;function r(l){o[16](l)}let i={id:o[1],type:"fill",source:o[2],sourceLayer:o[3],beforeId:o[4],beforeLayerType:o[5],paint:o[6],layout:o[7],filter:o[8],minzoom:o[9],maxzoom:o[10],hoverCursor:o[11],manageHoverState:o[12],eventsIfTopMost:o[13],interactive:o[14],$$slots:{default:[xt]},$$scope:{ctx:o}};return o[0]!==void 0&&(i.hovered=o[0]),e=new _t({props:i}),Pe.push(()=>He(e,"hovered",r)),e.$on("click",o[17]),e.$on("dblclick",o[18]),e.$on("contextmenu",o[19]),e.$on("mouseenter",o[20]),e.$on("mousemove",o[21]),e.$on("mouseleave",o[22]),{c(){ne(e.$$.fragment)},m(l,f){ie(e,l,f),n=!0},p(l,[f]){const u={};f&2&&(u.id=l[1]),f&4&&(u.source=l[2]),f&8&&(u.sourceLayer=l[3]),f&16&&(u.beforeId=l[4]),f&32&&(u.beforeLayerType=l[5]),f&64&&(u.paint=l[6]),f&128&&(u.layout=l[7]),f&256&&(u.filter=l[8]),f&512&&(u.minzoom=l[9]),f&1024&&(u.maxzoom=l[10]),f&2048&&(u.hoverCursor=l[11]),f&4096&&(u.manageHoverState=l[12]),f&8192&&(u.eventsIfTopMost=l[13]),f&16384&&(u.interactive=l[14]),f&8388608&&(u.$$scope={dirty:f,ctx:l}),!t&&f&1&&(t=!0,u.hovered=l[0],Re(()=>t=!1)),e.$set(u)},i(l){n||(A(e.$$.fragment,l),n=!0)},o(l){w(e.$$.fragment,l),n=!1},d(l){re(e,l)}}}function $t(o,e,t){let{$$slots:n={},$$scope:r}=e,{id:i=Ue("fill")}=e,{source:l=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:u=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:a}=e,{layout:c=void 0}=e,{filter:_=void 0}=e,{minzoom:S=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:b=!1}=e,{hovered:L=null}=e,{eventsIfTopMost:P=!1}=e,{interactive:B=!0}=e;function Z(d){L=d,t(0,L)}function G(d){oe.call(this,o,d)}function I(d){oe.call(this,o,d)}function E(d){oe.call(this,o,d)}function k(d){oe.call(this,o,d)}function T(d){oe.call(this,o,d)}function W(d){oe.call(this,o,d)}return o.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,l=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,u=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,a=d.paint),"layout"in d&&t(7,c=d.layout),"filter"in d&&t(8,_=d.filter),"minzoom"in d&&t(9,S=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,C=d.hoverCursor),"manageHoverState"in d&&t(12,b=d.manageHoverState),"hovered"in d&&t(0,L=d.hovered),"eventsIfTopMost"in d&&t(13,P=d.eventsIfTopMost),"interactive"in d&&t(14,B=d.interactive),"$$scope"in d&&t(23,r=d.$$scope)},[L,i,l,f,u,m,a,c,_,S,h,C,b,P,B,n,Z,G,I,E,k,T,W,r]}class xo extends Y{constructor(e){super(),q(this,e,$t,pt,N,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function eo(o,e,t){let n;const{map:r}=Be();D(o,r,u=>t(4,n=u));let{position:i="top-left"}=e,{container:l=void 0}=e,f=null;return we(()=>{n!=null&&n.loaded()&&f&&n.removeControl(f)}),o.$$set=u=>{"position"in u&&t(1,i=u.position),"container"in u&&t(2,l=u.container)},o.$$.update=()=>{if(o.$$.dirty&30&&n&&!f){let u;typeof l=="string"?u=document.querySelector(l)??void 0:u=l,t(3,f=new de.FullscreenControl({container:u})),n.addControl(f,i)}},[r,i,l,f,n]}class to extends Y{constructor(e){super(),q(this,e,eo,null,N,{position:1,container:2})}}function oo(o,e,t,n,r){let i=!1;o.getSource(e)&&(i=!0,o.removeSource(e));const l=()=>{n(e)&&(o.addSource(e,t),r())};if(i){const f=()=>{e&&(o.getSource(e)?setTimeout(f,1):l())};f()}else l()}function no(o,e,t){St().then(()=>{let n=ht(o);if(!n)return;n.getSource(e)===t&&n.removeSource(e)})}function nt(o){let e=o[0],t,n,r=it(o);return{c(){r.c(),t=Le()},m(i,l){r.m(i,l),H(i,t,l),n=!0},p(i,l){l&1&&N(e,e=i[0])?(_e(),w(r,1,1,he),ke(),r=it(i),r.c(),A(r,1),r.m(t.parentNode,t)):r.p(i,l)},i(i){n||(A(r),n=!0)},o(i){w(r),n=!1},d(i){i&&R(t),r.d(i)}}}function it(o){let e;const t=o[19].default,n=ze(t,o,o[18],null);return{c(){n&&n.c()},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i&262144)&&Oe(n,t,r,r[18],e?Ie(t,r[18],i,null):Te(r[18]),null)},i(r){e||(A(n,r),e=!0)},o(r){w(n,r),e=!1},d(r){n&&n.d(r)}}}function io(o){let e,t,n=o[0]&&nt(o);return{c(){n&&n.c(),e=Le()},m(r,i){n&&n.m(r,i),H(r,e,i),t=!0},p(r,[i]){r[0]?n?(n.p(r,i),i&1&&A(n,1)):(n=nt(r),n.c(),A(n,1),n.m(e.parentNode,e)):n&&(_e(),w(n,1,1,()=>{n=null}),ke())},i(r){t||(A(n),t=!0)},o(r){w(n),t=!1},d(r){r&&R(e),n&&n.d(r)}}}function ro(o,e,t){let n,r,i,{$$slots:l={},$$scope:f}=e,{id:u=Ue("geojson")}=e,{data:m}=e,{generateId:a=!1}=e,{promoteId:c=void 0}=e,{filter:_=void 0}=e,{lineMetrics:S=void 0}=e,{cluster:h=void 0}=e,{maxzoom:C=void 0}=e,{attribution:b=void 0}=e,{buffer:L=void 0}=e,{tolerance:P=void 0}=e;const{map:B,cluster:Z,self:G}=Nt();D(o,B,k=>t(17,r=k)),D(o,Z,k=>t(20,i=k)),D(o,G,k=>t(0,n=k));let I,E=!0;return we(()=>{n&&I&&r&&(no(B,n,I),ve(G,n=null,n),t(15,I=void 0))}),o.$$set=k=>{"id"in k&&t(4,u=k.id),"data"in k&&t(5,m=k.data),"generateId"in k&&t(6,a=k.generateId),"promoteId"in k&&t(7,c=k.promoteId),"filter"in k&&t(8,_=k.filter),"lineMetrics"in k&&t(9,S=k.lineMetrics),"cluster"in k&&t(10,h=k.cluster),"maxzoom"in k&&t(11,C=k.maxzoom),"attribution"in k&&t(12,b=k.attribution),"buffer"in k&&t(13,L=k.buffer),"tolerance"in k&&t(14,P=k.tolerance),"$$scope"in k&&t(18,f=k.$$scope)},o.$$.update=()=>{o.$$.dirty&1024&&ve(Z,i=h,i),o.$$.dirty&196593&&r&&n!==u&&(ve(G,n=u,n),oo(r,n,De({type:"geojson",data:m,filter:_,lineMetrics:S,generateId:a,promoteId:c,cluster:!!h,clusterMinPoints:h==null?void 0:h.minPoints,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius,clusterProperties:h==null?void 0:h.properties,maxzoom:C,attribution:b,buffer:L,tolerance:P}),k=>r&&k===n,()=>{n&&(t(15,I=r==null?void 0:r.getSource(n)),t(16,E=!0))})),o.$$.dirty&131088&&(r==null||r.on("style.load",()=>{t(15,I=r==null?void 0:r.getSource(u))})),o.$$.dirty&98336&&I&&(E?t(16,E=!1):I.setData(m)),o.$$.dirty&33792&&(I==null||I.setClusterOptions(De({cluster:!!h,clusterMaxZoom:h==null?void 0:h.maxZoom,clusterRadius:h==null?void 0:h.radius})))},[n,B,Z,G,u,m,a,c,_,S,h,C,b,L,P,I,E,r,f,l]}class po extends Y{constructor(e){super(),q(this,e,ro,io,N,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10,maxzoom:11,attribution:12,buffer:13,tolerance:14})}}function lo(o,e,t){let n;const{map:r}=Be();D(o,r,_=>t(8,n=_));let{position:i="top-left"}=e,{positionOptions:l=void 0}=e,{fitBoundsOptions:f=void 0}=e,{trackUserLocation:u=!1}=e,{showAccuracyCircle:m=!0}=e,{showUserLocation:a=!0}=e,{control:c=null}=e;return we(()=>{n!=null&&n.loaded()&&c&&n.removeControl(c)}),o.$$set=_=>{"position"in _&&t(2,i=_.position),"positionOptions"in _&&t(3,l=_.positionOptions),"fitBoundsOptions"in _&&t(4,f=_.fitBoundsOptions),"trackUserLocation"in _&&t(5,u=_.trackUserLocation),"showAccuracyCircle"in _&&t(6,m=_.showAccuracyCircle),"showUserLocation"in _&&t(7,a=_.showUserLocation),"control"in _&&t(1,c=_.control)},o.$$.update=()=>{o.$$.dirty&510&&n&&!c&&(t(1,c=new de.GeolocateControl({positionOptions:l,fitBoundsOptions:f,trackUserLocation:u,showAccuracyCircle:m,showUserLocation:a})),n.addControl(c,i))},[r,c,i,l,f,u,m,a,n]}class fo extends Y{constructor(e){super(),q(this,e,lo,null,N,{position:2,positionOptions:3,fitBoundsOptions:4,trackUserLocation:5,showAccuracyCircle:6,showUserLocation:7,control:1})}}function uo(o){let e;const t=o[15].default,n=ze(t,o,o[23],null);return{c(){n&&n.c()},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i&8388608)&&Oe(n,t,r,r[23],e?Ie(t,r[23],i,null):Te(r[23]),null)},i(r){e||(A(n,r),e=!0)},o(r){w(n,r),e=!1},d(r){n&&n.d(r)}}}function so(o){let e,t,n;function r(l){o[16](l)}let i={id:o[1],type:"line",source:o[2],sourceLayer:o[3],beforeId:o[4],beforeLayerType:o[5],paint:o[6],layout:o[7],filter:o[8],minzoom:o[9],maxzoom:o[10],hoverCursor:o[11],manageHoverState:o[12],eventsIfTopMost:o[13],interactive:o[14],$$slots:{default:[uo]},$$scope:{ctx:o}};return o[0]!==void 0&&(i.hovered=o[0]),e=new _t({props:i}),Pe.push(()=>He(e,"hovered",r)),e.$on("click",o[17]),e.$on("dblclick",o[18]),e.$on("contextmenu",o[19]),e.$on("mouseenter",o[20]),e.$on("mousemove",o[21]),e.$on("mouseleave",o[22]),{c(){ne(e.$$.fragment)},m(l,f){ie(e,l,f),n=!0},p(l,[f]){const u={};f&2&&(u.id=l[1]),f&4&&(u.source=l[2]),f&8&&(u.sourceLayer=l[3]),f&16&&(u.beforeId=l[4]),f&32&&(u.beforeLayerType=l[5]),f&64&&(u.paint=l[6]),f&128&&(u.layout=l[7]),f&256&&(u.filter=l[8]),f&512&&(u.minzoom=l[9]),f&1024&&(u.maxzoom=l[10]),f&2048&&(u.hoverCursor=l[11]),f&4096&&(u.manageHoverState=l[12]),f&8192&&(u.eventsIfTopMost=l[13]),f&16384&&(u.interactive=l[14]),f&8388608&&(u.$$scope={dirty:f,ctx:l}),!t&&f&1&&(t=!0,u.hovered=l[0],Re(()=>t=!1)),e.$set(u)},i(l){n||(A(e.$$.fragment,l),n=!0)},o(l){w(e.$$.fragment,l),n=!1},d(l){re(e,l)}}}function ao(o,e,t){let{$$slots:n={},$$scope:r}=e,{id:i=Ue("line")}=e,{source:l=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:u=void 0}=e,{beforeLayerType:m=void 0}=e,{paint:a}=e,{layout:c=void 0}=e,{filter:_=void 0}=e,{minzoom:S=void 0}=e,{maxzoom:h=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:b=!1}=e,{hovered:L=null}=e,{eventsIfTopMost:P=!1}=e,{interactive:B=!0}=e;function Z(d){L=d,t(0,L)}function G(d){oe.call(this,o,d)}function I(d){oe.call(this,o,d)}function E(d){oe.call(this,o,d)}function k(d){oe.call(this,o,d)}function T(d){oe.call(this,o,d)}function W(d){oe.call(this,o,d)}return o.$$set=d=>{"id"in d&&t(1,i=d.id),"source"in d&&t(2,l=d.source),"sourceLayer"in d&&t(3,f=d.sourceLayer),"beforeId"in d&&t(4,u=d.beforeId),"beforeLayerType"in d&&t(5,m=d.beforeLayerType),"paint"in d&&t(6,a=d.paint),"layout"in d&&t(7,c=d.layout),"filter"in d&&t(8,_=d.filter),"minzoom"in d&&t(9,S=d.minzoom),"maxzoom"in d&&t(10,h=d.maxzoom),"hoverCursor"in d&&t(11,C=d.hoverCursor),"manageHoverState"in d&&t(12,b=d.manageHoverState),"hovered"in d&&t(0,L=d.hovered),"eventsIfTopMost"in d&&t(13,P=d.eventsIfTopMost),"interactive"in d&&t(14,B=d.interactive),"$$scope"in d&&t(23,r=d.$$scope)},[L,i,l,f,u,m,a,c,_,S,h,C,b,P,B,n,Z,G,I,E,k,T,W,r]}class $o extends Y{constructor(e){super(),q(this,e,ao,so,N,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function co(o,e,t){let n;const r=Ze();let{layer:i=void 0}=e;const{map:l}=Be();D(o,l,a=>t(2,n=a));function f(a){r(a.type,{...a,map:l})}const u=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],m=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend"];return we(()=>{if(n)if(i)for(const a of u)n.off(a,i,f);else for(const a of m)n.off(a,f)}),o.$$set=a=>{"layer"in a&&t(1,i=a.layer)},o.$$.update=()=>{if(o.$$.dirty&6&&n)if(i)for(const a of u)n.on(a,i,f);else for(const a of m)n.on(a,f)},[l,i,n]}class mo extends Y{constructor(e){super(),q(this,e,co,null,N,{layer:1})}}function go(o){let e=o.getCenter(),t=Math.round(o.getZoom()*100)/100,n=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,n),i=Math.round(e.lat*r)/r,l=Math.round(e.lng*r)/r,f=`${t}/${i}/${l}`,u=o.getBearing(),m=o.getPitch();return(u||m)&&(f+=`/${Math.round(u*10)/10}`),m&&(f+=`/${Math.round(m)}`),`#${f}`}function ho(o){return o.replace("#","").split("/").map(parseFloat)}var Ee=Ve;function Ve(o,e){return o===e||o!==o&&e!==e?!0:typeof o!=typeof e||{}.toString.call(o)!={}.toString.call(e)||o!==Object(o)||!o?!1:Array.isArray(o)?rt(o,e):{}.toString.call(o)=="[object Set]"?rt(Array.from(o),Array.from(e)):{}.toString.call(o)=="[object Object]"?bo(o,e):yo(o,e)}function yo(o,e){return o.toString()===e.toString()}function rt(o,e){var t=o.length;if(t!=e.length)return!1;for(var n=0;n<t;n++)if(!Ve(o[n],e[n]))return!1;return!0}function bo(o,e){var t=Object.keys(o),n=t.length;if(n!=Object.keys(e).length)return!1;for(var r=0;r<n;r++){var i=t[r];if(!(e.hasOwnProperty(i)&&Ve(o[i],e[i])))return!1}return!0}function _o(o,e,t){let n;const{map:r}=Be();D(o,r,a=>t(6,n=a));let{position:i="top-left"}=e,{showCompass:l=!0}=e,{showZoom:f=!0}=e,{visualizePitch:u=!1}=e,m=null;return we(()=>{n!=null&&n.loaded()&&m&&n.removeControl(m)}),o.$$set=a=>{"position"in a&&t(1,i=a.position),"showCompass"in a&&t(2,l=a.showCompass),"showZoom"in a&&t(3,f=a.showZoom),"visualizePitch"in a&&t(4,u=a.visualizePitch)},o.$$.update=()=>{o.$$.dirty&126&&n&&!m&&(t(5,m=new de.NavigationControl({showCompass:l,showZoom:f,visualizePitch:u})),n.addControl(m,i))},[r,i,l,f,u,m,n]}class kt extends Y{constructor(e){super(),q(this,e,_o,null,N,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function ko(o,e,t){let n;const{map:r}=Be();D(o,r,m=>t(5,n=m));let{position:i="bottom-left"}=e,{maxWidth:l=void 0}=e,{unit:f="metric"}=e,u=null;return we(()=>{n!=null&&n.loaded()&&u&&n.removeControl(u)}),o.$$set=m=>{"position"in m&&t(1,i=m.position),"maxWidth"in m&&t(2,l=m.maxWidth),"unit"in m&&t(3,f=m.unit)},o.$$.update=()=>{o.$$.dirty&62&&n&&!u&&(t(4,u=new de.ScaleControl({maxWidth:l,unit:f})),n.addControl(u,i))},[r,i,l,f,u,n]}class At extends Y{constructor(e){super(),q(this,e,ko,null,N,{position:1,maxWidth:2,unit:3})}}const{window:Ao}=Ht,Co=o=>({map:o[0]&16,loadedImages:o[0]&32,allImagesLoaded:o[0]&64}),lt=o=>({map:o[4],loadedImages:o[5],allImagesLoaded:o[6]});function ft(o){let e,t,n=o[3]&&ut(o);const r=o[46].default,i=ze(r,o,o[45],lt);return{c(){n&&n.c(),e=Ce(),i&&i.c()},m(l,f){n&&n.m(l,f),H(l,e,f),i&&i.m(l,f),t=!0},p(l,f){l[3]?n?(n.p(l,f),f[0]&8&&A(n,1)):(n=ut(l),n.c(),A(n,1),n.m(e.parentNode,e)):n&&(_e(),w(n,1,1,()=>{n=null}),ke()),i&&i.p&&(!t||f[0]&112|f[1]&16384)&&Oe(i,r,l,l[45],t?Ie(r,l[45],f,Co):Te(l[45]),lt)},i(l){t||(A(n),A(i,l),t=!0)},o(l){w(n),w(i,l),t=!1},d(l){l&&R(e),n&&n.d(l),i&&i.d(l)}}}function ut(o){let e,t,n,r,i,l,f,u;return e=new kt({props:{position:o[7]}}),n=new fo({props:{position:o[7],fitBoundsOptions:{maxZoom:12}}}),i=new to({props:{position:o[7]}}),f=new At({props:{position:o[7]}}),{c(){ne(e.$$.fragment),t=Ce(),ne(n.$$.fragment),r=Ce(),ne(i.$$.fragment),l=Ce(),ne(f.$$.fragment)},m(m,a){ie(e,m,a),H(m,t,a),ie(n,m,a),H(m,r,a),ie(i,m,a),H(m,l,a),ie(f,m,a),u=!0},p(m,a){const c={};a[0]&128&&(c.position=m[7]),e.$set(c);const _={};a[0]&128&&(_.position=m[7]),n.$set(_);const S={};a[0]&128&&(S.position=m[7]),i.$set(S);const h={};a[0]&128&&(h.position=m[7]),f.$set(h)},i(m){u||(A(e.$$.fragment,m),A(n.$$.fragment,m),A(i.$$.fragment,m),A(f.$$.fragment,m),u=!0)},o(m){w(e.$$.fragment,m),w(n.$$.fragment,m),w(i.$$.fragment,m),w(f.$$.fragment,m),u=!1},d(m){m&&(R(t),R(r),R(l)),re(e,m),re(n,m),re(i,m),re(f,m)}}}function vo(o){let e,t,n,r,i,l=o[4]&&o[0]&&ft(o);return{c(){e=Me("div"),l&&l.c(),ge(e,"class",t=qe(o[2])+" svelte-p00lfq"),ge(e,"data-testid","map-container"),Je(e,"expand-map",!o[2])},m(f,u){H(f,e,u),l&&l.m(e,null),o[47](e),n=!0,r||(i=[Mt(Ao,"hashchange",o[11]),Lt(o[10].call(null,e))],r=!0)},p(f,u){f[4]&&f[0]?l?(l.p(f,u),u[0]&17&&A(l,1)):(l=ft(f),l.c(),A(l,1),l.m(e,null)):l&&(_e(),w(l,1,1,()=>{l=null}),ke()),(!n||u[0]&4&&t!==(t=qe(f[2])+" svelte-p00lfq"))&&ge(e,"class",t),(!n||u[0]&4)&&Je(e,"expand-map",!f[2])},i(f){n||(A(l),n=!0)},o(f){w(l),n=!1},d(f){f&&R(e),l&&l.d(),o[47](null),r=!1,zt(i)}}}function wo(o,e,t){let n,r,i,l,{$$slots:f={},$$scope:u}=e,{map:m=null}=e,{mapContainer:a=void 0}=e,{class:c=void 0}=e,{style:_}=e,{diffStyleUpdates:S=!1}=e,{center:h=void 0}=e,{zoom:C=void 0}=e,{pitch:b=0}=e,{bearing:L=0}=e,{bounds:P=void 0}=e,{hash:B=!1}=e,{updateHash:Z=s=>{window.history.replaceState(window.history.state,"",s)}}=e,{loaded:G=!1}=e,{minZoom:I=0}=e,{maxZoom:E=22}=e,{minPitch:k=0}=e,{maxPitch:T=60}=e,{renderWorldCopies:W=void 0}=e,{dragPan:d=void 0}=e,{dragRotate:ye=void 0}=e,{pitchWithRotate:J=void 0}=e,{antialias:x=void 0}=e,{zoomOnDoubleClick:p=!0}=e,{locale:$=void 0}=e,{interactive:le=!0}=e,{attributionControl:v=!0}=e,{cooperativeGestures:fe=!1}=e,{preserveDrawingBuffer:Q=!1}=e,{maxBounds:Ae=void 0}=e,{images:ue=[]}=e,{standardControls:K=!1}=e,{filterLayers:U=void 0}=e,{transformRequest:be=void 0}=e;const O=Ze(),{map:j,loadedImages:se}=jt();D(o,j,s=>t(4,i=s)),D(o,se,s=>t(5,l=s));let ae=new Set;async function Se(s,M=!1){if(i&&!(!i.loaded()&&!M))if("url"in s){ae.add(s.id);try{let F=await i.loadImage(s.url);i==null||i.addImage(s.id,F.data,s.options),l.add(s.id),se.set(l)}catch(F){O("error",F)}finally{ae.delete(s.id)}}else i.addImage(s.id,s.data,s.options),l.add(s.id),se.set(l)}let ee,te,y,z;function ce(s){return g(),ve(j,i=new de.Map(De({container:s,style:_,locale:$,center:h,zoom:C,pitch:b,bearing:L,minZoom:I,maxZoom:E,minPitch:k,maxPitch:T,renderWorldCopies:W,dragPan:d,dragRotate:ye,pitchWithRotate:J,antialias:x,interactive:le,preserveDrawingBuffer:Q,maxBounds:Ae,bounds:P,attributionControl:v,transformRequest:be,cooperativeGestures:fe})),i),i.on("load",M=>{M.target.getContainer().setAttribute("data-testid","map"),M.target.getCanvas().setAttribute("data-testid","map-canvas"),t(0,G=!0),O("load",i)}),i.on("error",M=>O("error",{...M,map:i})),i.on("movestart",M=>O("movestart",{...M,map:i})),i.on("moveend",M=>{if(t(12,h=M.target.getCenter()),t(13,C=M.target.getZoom()),t(14,b=M.target.getPitch()),t(15,L=M.target.getBearing()),t(16,P=M.target.getBounds()),O("moveend",{...M,map:i}),B){let F=new URL(window.location.href.replace(/(#.+)?$/,go(i)));Z(F)}}),i.on("click",M=>O("click",{...M,map:i})),i.on("dblclick",M=>O("dblclick",{...M,map:i})),i.on("contextmenu",M=>O("contextmenu",{...M,map:i})),i.on("zoomstart",M=>O("zoomstart",{...M,map:i})),i.on("zoom",M=>{O("zoom",{...M,map:i})}),i.on("zoomend",M=>{O("zoomend",{...M,map:i})}),i.on("style.load",()=>{if(i){const M=i.getStyle();if(t(42,ee=M.layers.map(F=>F.id)),t(43,te=Object.keys(M.sources)),z)for(const[F,Ge]of Object.entries(z))i.addSource(F,Ge);if(y)for(const F of y)i.addLayer(F);for(const F of ue)Se(F,!0)}}),i.on("styledata",M=>{if(i&&U){const F=i.getStyle().layers;if(F)for(let Ge of F)U(Ge)||i.setLayoutProperty(Ge.id,"visibility","none")}O("styledata",{...M,map:i})}),{destroy(){t(0,G=!1),i==null||i.remove(),ve(j,i=null,i)}}}let V=_;function g(){if(B){let s=ho(window.location.hash);s.length>=3&&(t(13,C=s[0]),t(12,h=[s[2],s[1]])),s.length==5&&(t(15,L=s[3]),t(14,b=s[4]))}}function X(s){Pe[s?"unshift":"push"](()=>{a=s,t(1,a)})}return o.$$set=s=>{"map"in s&&t(17,m=s.map),"mapContainer"in s&&t(1,a=s.mapContainer),"class"in s&&t(2,c=s.class),"style"in s&&t(18,_=s.style),"diffStyleUpdates"in s&&t(19,S=s.diffStyleUpdates),"center"in s&&t(12,h=s.center),"zoom"in s&&t(13,C=s.zoom),"pitch"in s&&t(14,b=s.pitch),"bearing"in s&&t(15,L=s.bearing),"bounds"in s&&t(16,P=s.bounds),"hash"in s&&t(20,B=s.hash),"updateHash"in s&&t(21,Z=s.updateHash),"loaded"in s&&t(0,G=s.loaded),"minZoom"in s&&t(22,I=s.minZoom),"maxZoom"in s&&t(23,E=s.maxZoom),"minPitch"in s&&t(24,k=s.minPitch),"maxPitch"in s&&t(25,T=s.maxPitch),"renderWorldCopies"in s&&t(26,W=s.renderWorldCopies),"dragPan"in s&&t(27,d=s.dragPan),"dragRotate"in s&&t(28,ye=s.dragRotate),"pitchWithRotate"in s&&t(29,J=s.pitchWithRotate),"antialias"in s&&t(30,x=s.antialias),"zoomOnDoubleClick"in s&&t(31,p=s.zoomOnDoubleClick),"locale"in s&&t(32,$=s.locale),"interactive"in s&&t(33,le=s.interactive),"attributionControl"in s&&t(34,v=s.attributionControl),"cooperativeGestures"in s&&t(35,fe=s.cooperativeGestures),"preserveDrawingBuffer"in s&&t(36,Q=s.preserveDrawingBuffer),"maxBounds"in s&&t(37,Ae=s.maxBounds),"images"in s&&t(38,ue=s.images),"standardControls"in s&&t(3,K=s.standardControls),"filterLayers"in s&&t(39,U=s.filterLayers),"transformRequest"in s&&t(40,be=s.transformRequest),"$$scope"in s&&t(45,u=s.$$scope)},o.$$.update=()=>{if(o.$$.dirty[0]&8&&t(7,n=typeof K=="boolean"?void 0:K),o.$$.dirty[0]&16&&t(17,m=i),o.$$.dirty[0]&786448|o.$$.dirty[1]&14336&&i&&!Ee(_,V)){const s=i.getStyle();if(ee&&(y=s.layers.filter(M=>!ee.includes(M.id))),te){const M=Object.keys(s.sources).filter(F=>!te.includes(F));z={};for(const F of M)z[F]=s.sources[F]}t(44,V=_),i.setStyle(_,{diff:S}),ve(se,l=new Set,l),t(41,ae=new Set)}if(o.$$.dirty[0]&49|o.$$.dirty[1]&1152&&G&&i!=null&&i.loaded())for(let s of ue)!l.has(s.id)&&!ae.has(s.id)&&!i.hasImage(s.id)&&Se(s);if(o.$$.dirty[0]&32|o.$$.dirty[1]&128&&t(6,r=ue.every(s=>l.has(s.id))),o.$$.dirty[0]&61456&&i){let s={};h!=null&&!Ee(h,i==null?void 0:i.getCenter())&&(s.center=h),C!=null&&!Ee(C,i==null?void 0:i.getZoom())&&(s.zoom=C),L!=null&&!Ee(L,i==null?void 0:i.getBearing())&&(s.bearing=L),b!=null&&!Ee(b,i==null?void 0:i.getPitch())&&(s.pitch=b),Object.keys(s).length&&i.easeTo(s)}o.$$.dirty[0]&65552&&P&&!Ee(P,i==null?void 0:i.getBounds())&&(i==null||i.fitBounds(P)),o.$$.dirty[0]&16|o.$$.dirty[1]&1&&(p?i==null||i.doubleClickZoom.enable():i==null||i.doubleClickZoom.disable())},[G,a,c,K,i,l,r,n,j,se,ce,g,h,C,b,L,P,m,_,S,B,Z,I,E,k,T,W,d,ye,J,x,p,$,le,v,fe,Q,Ae,ue,U,be,ae,ee,te,V,u,f,X]}class So extends Y{constructor(e){super(),q(this,e,wo,vo,N,{map:17,mapContainer:1,class:2,style:18,diffStyleUpdates:19,center:12,zoom:13,pitch:14,bearing:15,bounds:16,hash:20,updateHash:21,loaded:0,minZoom:22,maxZoom:23,minPitch:24,maxPitch:25,renderWorldCopies:26,dragPan:27,dragRotate:28,pitchWithRotate:29,antialias:30,zoomOnDoubleClick:31,locale:32,interactive:33,attributionControl:34,cooperativeGestures:35,preserveDrawingBuffer:36,maxBounds:37,images:38,standardControls:3,filterLayers:39,transformRequest:40},null,[-1,-1])}}const Mo=o=>({features:o[0]&16,data:o[0]&16,map:o[0]&4,close:o[0]&1}),st=o=>{var e;return{features:o[4],data:((e=o[4])==null?void 0:e[0])??null,map:o[2],close:o[31]}};function at(o){var r;let e,t,n=(((r=o[4])==null?void 0:r.length)||o[3]instanceof de.Marker)&&ct(o);return{c(){e=Me("div"),n&&n.c()},m(i,l){H(i,e,l),n&&n.m(e,null),o[32](e),t=!0},p(i,l){var f;(f=i[4])!=null&&f.length||i[3]instanceof de.Marker?n?(n.p(i,l),l[0]&24&&A(n,1)):(n=ct(i),n.c(),A(n,1),n.m(e,null)):n&&(_e(),w(n,1,1,()=>{n=null}),ke())},i(i){t||(A(n),t=!0)},o(i){w(n),t=!1},d(i){i&&R(e),n&&n.d(),o[32](null)}}}function ct(o){let e;const t=o[30].default,n=ze(t,o,o[29],st);return{c(){n&&n.c()},m(r,i){n&&n.m(r,i),e=!0},p(r,i){n&&n.p&&(!e||i[0]&536870933)&&Oe(n,t,r,r[29],e?Ie(t,r[29],i,Mo):Te(r[29]),st)},i(r){e||(A(n,r),e=!0)},o(r){w(n,r),e=!1},d(r){n&&n.d(r)}}}function Lo(o){let e,t,n=o[9].default&&at(o);return{c(){n&&n.c(),e=Le()},m(r,i){n&&n.m(r,i),H(r,e,i),t=!0},p(r,i){r[9].default?n?(n.p(r,i),i[0]&512&&A(n,1)):(n=at(r),n.c(),A(n,1),n.m(e.parentNode,e)):n&&(_e(),w(n,1,1,()=>{n=null}),ke())},i(r){t||(A(n),t=!0)},o(r){w(n),t=!1},d(r){r&&R(e),n&&n.d(r)}}}function zo(o,e,t){let n,r,i,l,f,u,{$$slots:m={},$$scope:a}=e;const c=Ot(m);let{closeButton:_=void 0}=e,{closeOnClickOutside:S=!0}=e,{closeOnClickInside:h=!1}=e,{closeOnMove:C=!1}=e,{openOn:b="click"}=e,{openIfTopMost:L=!0}=e,{focusAfterOpen:P=!0}=e,{anchor:B=void 0}=e,{offset:Z=void 0}=e,{popupClass:G=void 0}=e,{maxWidth:I=void 0}=e,{lngLat:E=void 0}=e,{html:k=void 0}=e,{open:T=!1}=e;const W=Ze(),{map:d,popupTarget:ye,layerEvent:J,layer:x,eventTopMost:p,markerClickManager:$}=Be();D(o,d,g=>t(2,i=g)),D(o,ye,g=>t(3,f=g)),D(o,J,g=>t(28,l=g)),D(o,x,g=>t(35,u=g));const le=["click","dblclick","contextmenu"];let v,fe=!1,Q;function Ae(){if(!v)return;let g=v.getElement();!g||g===Q||(Q=g,b==="hover"&&(Q.style.pointerEvents="none"),Q.addEventListener("mouseenter",()=>{t(24,fe=!0)},{passive:!0}),Q.addEventListener("mouseleave",()=>{t(24,fe=!1)},{passive:!0}),Q.addEventListener("click",()=>{h&&t(0,T=!1)},{passive:!0}))}yt(()=>{if(i)return i.on("click",te),i.on("contextmenu",te),$.add(y),typeof f=="string"&&(i.on("click",f,O),i.on("dblclick",f,O),i.on("contextmenu",f,O),i.on("mousemove",f,ee),i.on("mouseleave",f,Se),i.on("touchstart",f,se),i.on("touchend",f,ae)),()=>{i!=null&&i.loaded()&&(v==null||v.remove(),i.off("click",te),i.off("contextmenu",te),$.remove(y),f instanceof de.Marker?f.getPopup()===v&&f.setPopup(void 0):typeof f=="string"&&(i.off("click",f,O),i.off("dblclick",f,O),i.off("contextmenu",f,O),i.off("mousemove",f,ee),i.off("mouseleave",f,Se),i.off("touchstart",f,se),i.off("touchend",f,ae)))}});function ue(g){return L?!("marker"in g)&&!Qt(g)&&p(g)!==u:!1}let K=null,U="normal";function be(g){"layerType"in g&&g.layerType==="deckgl"?(t(10,E=g.coordinate),t(4,K=g.object?[g.object]:null)):(t(10,E=g.lngLat),t(4,K=g.features??[]))}function O(g){g.type!==b||ue(g)||(be(g),setTimeout(()=>t(0,T=!0)))}let j=null;function se(g){j=g.point}function ae(g){if(!j||b!=="hover")return;let X=j.dist(g.point);j=null,X<3&&(t(10,E=g.lngLat),t(4,K=g.features??[]),v.isOpen()?t(25,U="justOpened"):(t(25,U="opening"),t(0,T=!0)))}function Se(g){b!=="hover"||j||U!=="normal"||(t(0,T=!1),t(4,K=null))}function ee(g){if(!(b!=="hover"||j||U!=="normal")){if(ue(g)){t(0,T=!1),t(4,K=null);return}t(0,T=!0),t(4,K=g.features??[]),t(10,E=g.lngLat)}}function te(g){if(U==="justOpened"){t(25,U="normal");return}if(!S)return;let X=[Q,f instanceof de.Marker?f==null?void 0:f.getElement():null];T&&v.isOpen()&&!X.some(s=>s==null?void 0:s.contains(g.originalEvent.target))&&(g.type==="contextmenu"&&b==="contextmenu"||g.type!=="contextmenu")&&t(0,T=!1)}function y(g){S&&T&&v.isOpen()&&g.marker!==f&&t(0,T=!1)}we(()=>{i&&(v!=null&&v.isOpen())&&v.remove()});let z;const ce=()=>t(0,T=!1);function V(g){Pe[g?"unshift":"push"](()=>{z=g,t(1,z)})}return o.$$set=g=>{"closeButton"in g&&t(11,_=g.closeButton),"closeOnClickOutside"in g&&t(12,S=g.closeOnClickOutside),"closeOnClickInside"in g&&t(13,h=g.closeOnClickInside),"closeOnMove"in g&&t(14,C=g.closeOnMove),"openOn"in g&&t(15,b=g.openOn),"openIfTopMost"in g&&t(16,L=g.openIfTopMost),"focusAfterOpen"in g&&t(17,P=g.focusAfterOpen),"anchor"in g&&t(18,B=g.anchor),"offset"in g&&t(19,Z=g.offset),"popupClass"in g&&t(20,G=g.popupClass),"maxWidth"in g&&t(21,I=g.maxWidth),"lngLat"in g&&t(10,E=g.lngLat),"html"in g&&t(22,k=g.html),"open"in g&&t(0,T=g.open),"$$scope"in g&&t(29,a=g.$$scope)},o.$$.update=()=>{if(o.$$.dirty[0]&14336&&t(27,n=_??(!S&&!h)),o.$$.dirty[0]&146685952&&(v||(t(23,v=new de.Popup({closeButton:n,closeOnClick:!1,closeOnMove:C,focusAfterOpen:P,maxWidth:I,className:G,anchor:B,offset:Z})),Q=v.getElement(),v.on("open",()=>{t(0,T=!0),Ae(),W("open",v)}),v.on("close",()=>{t(0,T=!1),W("close",v)}),v.on("hover",()=>{W("hover",v)}))),o.$$.dirty[0]&8421384&&v&&f instanceof de.Marker&&(b==="click"?f.setPopup(v):f.getPopup()===v&&f.setPopup(void 0)),o.$$.dirty[0]&268468224&&le.includes(b)&&(l==null?void 0:l.type)===b&&(O(l),ve(J,l=null,l)),o.$$.dirty[0]&268468224&&t(26,r=b==="hover"&&((l==null?void 0:l.type)==="mousemove"||(l==null?void 0:l.type)==="mouseenter")),o.$$.dirty[0]&352354304&&b==="hover"&&J&&(r&&l&&be(l),t(0,T=(r||fe)??!1)),o.$$.dirty[0]&12582914&&(z?v.setDOMContent(z):k&&v.setHTML(k)),o.$$.dirty[0]&8389632&&E&&v.setLngLat(E),o.$$.dirty[0]&41943045&&i){let g=v.isOpen();T&&!g?(v.addTo(i),U==="opening"&&t(25,U="justOpened")):!T&&g&&v.remove()}},[T,z,i,f,K,d,ye,J,x,c,E,_,S,h,C,b,L,P,B,Z,G,I,k,v,fe,U,r,n,l,a,m,ce,V]}class en extends Y{constructor(e){super(),q(this,e,zo,Lo,N,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}function Oo(o){let e,t,n,r;const i=[Io,To],l=[];function f(u,m){return u[0]?0:1}return e=f(o),t=l[e]=i[e](o),{c(){t.c(),n=Le()},m(u,m){l[e].m(u,m),H(u,n,m),r=!0},p(u,m){t.p(u,m)},i(u){r||(A(t),r=!0)},o(u){w(t),r=!1},d(u){u&&R(n),l[e].d(u)}}}function To(o){let e,t;return e=new Gt({props:{errorMessage:"You shouldn't be able to view this app without being logged in!"}}),{c(){ne(e.$$.fragment)},m(n,r){ie(e,n,r),t=!0},p:he,i(n){t||(A(e.$$.fragment,n),t=!0)},o(n){w(e.$$.fragment,n),t=!1},d(n){re(e,n)}}}function Io(o){let e;return{c(){e=Me("p"),e.textContent=`Logged in as ${o[0]}`},m(t,n){H(t,e,n)},p:he,i:he,o:he,d(t){t&&R(e)}}}function Bo(o){let e=bt()=="Private (development)",t,n,r=e&&Oo(o);return{c(){r&&r.c(),t=Le()},m(i,l){r&&r.m(i,l),H(i,t,l),n=!0},p(i,[l]){e&&r.p(i,l)},i(i){n||(A(r),n=!0)},o(i){w(r),n=!1},d(i){i&&R(t),r&&r.d(i)}}}function Eo(o){return[Tt.get("email")]}class tn extends Y{constructor(e){super(),q(this,e,Eo,Bo,N,{})}}const Po="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAQAAAC1QeVaAAAAAmJLR0QA/4ePzL8AAACgSURBVBjTY2D4D4cvGHoY2BlQwH8U2I4pCQKsDHFg3VglGRjEgazvmJLlQNjIcAnIOobbztcM5piSHUBYzxDNwMfAgMtOGKjHJpnJ8IwhhcGFYREDM6ZkCMMqoPHXGC4zBKEa5cPwBKioAAiXMIQz/GZ4yuCFkHzC4MjgxPCNoZaBjeE+kOXEcB0h+RjIdWG4AGU7w9lg4A0UesBgj8oGAP6nSFElh0b7AAAAAElFTkSuQmCC",Go="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAm0lEQVRIS+2U0Q2AIAxEYQM30Q3UDXQy3UhHkE0cweuHHxKTXpuQaALJ/cE9eoXGUHjFwv6hAtSEPxFRh2su0Ayd6pWzDUwFO8700AGNVggDaGAqkNYDYQBStBvCAtwQC8AF8QA2kORlJWjQmm4BSB9M5lIyC3CZswC3OQu4PxqVef7TmYikoSs0aQ19GyMMwDp+HvsrQI3v/xFduXoiGbi1DtQAAAAASUVORK5CYII=",Ho="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC",Ro="/atip/privacy-statement/assets/google_on_non_white_hdpi-368415f0.png";function Fo(o){let e,t,n,r;return{c(){e=Me("div"),t=new Bt(!1),n=It(` |
  `),r=Me("a"),r.textContent="MapLibre",t.a=n,ge(r,"href","https://maplibre.org/"),ge(r,"target","_blank"),ge(e,"class","svelte-1yeu1m4")},m(i,l){H(i,e,l),t.m(o[0],e),Xe(e,n),Xe(e,r)},p(i,[l]){l&1&&t.p(i[0])},i:he,o:he,d(i){i&&R(e)}}}function Do(o,e,t){let{attribution:n}=e;return o.$$set=r=>{"attribution"in r&&t(0,n=r.attribution)},[n]}class Zo extends Y{constructor(e){super(),q(this,e,Do,Fo,N,{attribution:0})}}function mt(o){let e,t,n,r;function i(u){o[9](u)}function l(u){o[10](u)}let f={style:o[4],bounds:o[0],hash:!0,images:[{id:"chevron",url:Go},{id:"cycle_parking",url:Po},{id:"railway_station",url:Ho}],attributionControl:!1,$$slots:{default:[Uo]},$$scope:{ctx:o}};return o[3]!==void 0&&(f.loaded=o[3]),o[2]!==void 0&&(f.map=o[2]),e=new So({props:f}),Pe.push(()=>He(e,"loaded",i)),Pe.push(()=>He(e,"map",l)),e.$on("error",No),{c(){ne(e.$$.fragment)},m(u,m){ie(e,u,m),r=!0},p(u,m){const a={};m&16&&(a.style=u[4]),m&1&&(a.bounds=u[0]),m&2146&&(a.$$scope={dirty:m,ctx:u}),!t&&m&8&&(t=!0,a.loaded=u[3],Re(()=>t=!1)),!n&&m&4&&(n=!0,a.map=u[2],Re(()=>n=!1)),e.$set(a)},i(u){r||(A(e.$$.fragment,u),r=!0)},o(u){w(e.$$.fragment,u),r=!1},d(u){re(e,u)}}}function dt(o){let e,t,n,r,i,l,f,u,m,a;e=new mo({}),e.$on("zoomend",o[7]),e.$on("moveend",o[7]),n=new Zo({props:{attribution:o[6]}}),i=new At({}),f=new kt({props:{position:"bottom-left",visualizePitch:!0}});let c=o[1]=="google"&&gt();const _=o[8].default,S=ze(_,o,o[11],null);return{c(){ne(e.$$.fragment),t=Ce(),ne(n.$$.fragment),r=Ce(),ne(i.$$.fragment),l=Ce(),ne(f.$$.fragment),u=Ce(),c&&c.c(),m=Ce(),S&&S.c()},m(h,C){ie(e,h,C),H(h,t,C),ie(n,h,C),H(h,r,C),ie(i,h,C),H(h,l,C),ie(f,h,C),H(h,u,C),c&&c.m(h,C),H(h,m,C),S&&S.m(h,C),a=!0},p(h,C){const b={};C&64&&(b.attribution=h[6]),n.$set(b),h[1]=="google"?c||(c=gt(),c.c(),c.m(m.parentNode,m)):c&&(c.d(1),c=null),S&&S.p&&(!a||C&2048)&&Oe(S,_,h,h[11],a?Ie(_,h[11],C,null):Te(h[11]),null)},i(h){a||(A(e.$$.fragment,h),A(n.$$.fragment,h),A(i.$$.fragment,h),A(f.$$.fragment,h),A(S,h),a=!0)},o(h){w(e.$$.fragment,h),w(n.$$.fragment,h),w(i.$$.fragment,h),w(f.$$.fragment,h),w(S,h),a=!1},d(h){h&&(R(t),R(r),R(l),R(u),R(m)),re(e,h),re(n,h),re(i,h),re(f,h),c&&c.d(h),S&&S.d(h)}}}function gt(o){let e,t;return{c(){e=Me("img"),Et(e.src,t=Ro)||ge(e,"src",t),ge(e,"alt","Google logo"),ge(e,"class","svelte-81xaz8")},m(n,r){H(n,e,r)},d(n){n&&R(e)}}}function Uo(o){let e,t,n=o[5]&&dt(o);return{c(){n&&n.c(),e=Le()},m(r,i){n&&n.m(r,i),H(r,e,i),t=!0},p(r,i){r[5]?n?(n.p(r,i),i&32&&A(n,1)):(n=dt(r),n.c(),A(n,1),n.m(e.parentNode,e)):n&&(_e(),w(n,1,1,()=>{n=null}),ke())},i(r){t||(A(n),t=!0)},o(r){w(n),t=!1},d(r){r&&R(e),n&&n.d(r)}}}function jo(o){let e,t,n=o[4]&&mt(o);return{c(){e=Me("div"),n&&n.c(),ge(e,"class","map svelte-81xaz8")},m(r,i){H(r,e,i),n&&n.m(e,null),t=!0},p(r,[i]){r[4]?n?(n.p(r,i),i&16&&A(n,1)):(n=mt(r),n.c(),A(n,1),n.m(e,null)):n&&(_e(),w(n,1,1,()=>{n=null}),ke())},i(r){t||(A(n),t=!0)},o(r){w(n),t=!1},d(r){r&&R(e),n&&n.d()}}}function No(o){console.error(`MapLibre error: ${o.detail.error}`)}function Wo(o,e,t){let n,r;D(o,xe,b=>t(5,n=b)),D(o,Fe,b=>t(6,r=b));let{$$slots:i={},$$scope:l}=e,{style:f}=e,{startBounds:u=void 0}=e,m=null,a,c=!1;We("setCamera",!window.location.hash),window.location.hash&&(u=void 0),yt(async()=>{t(4,m=await pe(f))});async function _(b){t(4,m=await pe(f));let L=new URL(window.location.href);L.searchParams.set("style",b),window.history.replaceState(null,"",L.toString())}async function S(){f=="google"&&n&&ve(Fe,r=await Ft(n),r)}function h(b){c=b,t(3,c)}function C(b){a=b,t(2,a)}return o.$$set=b=>{"style"in b&&t(1,f=b.style),"startBounds"in b&&t(0,u=b.startBounds),"$$scope"in b&&t(11,l=b.$$scope)},o.$$.update=()=>{o.$$.dirty&12&&c&&xe.set(a),o.$$.dirty&2&&_(f)},[u,f,a,c,m,n,r,S,i,h,C,l]}class on extends Y{constructor(e){super(),q(this,e,Wo,jo,N,{style:1,startBounds:0})}}export{Yo as A,xo as F,po as G,tn as L,on as M,en as P,$o as a,oo as b,De as c,mo as d,_t as e,Go as f,Ue as g,Xo as h,Po as i,Ho as j,qo as k,Jo as l,Ht as m,no as r,Nt as u};
