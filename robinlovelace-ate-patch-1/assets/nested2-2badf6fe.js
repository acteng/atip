import{S as V,i as G,s as K,e as E,u as v,d as T,g as _,j as m,k as O,m as w,t as g,n as d,p as h,q as b,f as Zr,x as ee,aq as xn,b as W,c as q,l as Z,Q as Y,C as re,ar as Xr,W as ft,r as It,F as Yr,a as Wt,h as z,v as lr,w as Qt,I as Ce,aS as $e,$ as Le,G as we,aR as j,J as We,N as Fe,K as At,y as de,o as _e,V as ze,aT as wt,U as er,aU as Mn,a1 as Jr,a0 as ct,E as Qr,a5 as tr,aK as Fn,aL as Bn,aM as jn,aN as Un,R as Rn,aV as ur,D as Hn,aW as fr,a8 as en,L as Wn,z as zn,aH as Vn}from"./index-56221288.js";import{H as ne,L as Gn,d as cr,c as tn,C as me,B as Kn,Z as qn,I as Zn}from"./schemas-3abe3402.js";import{e as Dt,C as Me,b as yt,d as te,a as Xn,S as Yn,L as Jn,M as Qn}from"./StreetViewController-57b08800.js";import{I as Q,F as eo}from"./InteractiveLayer-a778680b.js";function to(t){let e;return{c(){e=E("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ro(t){let e,r,n,o,s=t[0]=="Test (on GCP)"&&to();return{c(){s&&s.c(),e=T(),r=E("p"),r.textContent="Note the ATF scheme data has not been validated.",n=T(),o=E("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(a,l){s&&s.m(a,l),m(a,e,l),m(a,r,l),m(a,n,l),m(a,o,l)},p:ee,d(a){a&&(h(e),h(r),h(n),h(o)),s&&s.d(a)}}}function no(t){let e,r,n,o,s,a;return s=new ne({props:{$$slots:{default:[ro]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("App version: "),n=v(t[0]),o=T(),_(s.$$.fragment)},m(l,i){m(l,e,i),O(e,r),O(e,n),O(e,o),w(s,e,null),a=!0},p(l,[i]){const f={};i&2&&(f.$$scope={dirty:i,ctx:l}),s.$set(f)},i(l){a||(g(s.$$.fragment,l),a=!0)},o(l){d(s.$$.fragment,l),a=!1},d(l){l&&h(e),b(s)}}}function oo(t){return[Zr()]}class so extends V{constructor(e){super(),G(this,e,oo,no,K,{})}}const io={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var fe=Uint8Array,Je=Uint16Array,rn=Uint32Array,nn=new fe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),on=new fe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ao=new fe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sn=function(t,e){for(var r=new Je(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new rn(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},an=sn(nn,2),ln=an[0],lo=an[1];ln[28]=258,lo[258]=28;var uo=sn(on,0),fo=uo[0],zt=new Je(32768);for(var X=0;X<32768;++X){var je=(X&43690)>>>1|(X&21845)<<1;je=(je&52428)>>>2|(je&13107)<<2,je=(je&61680)>>>4|(je&3855)<<4,zt[X]=((je&65280)>>>8|(je&255)<<8)>>>1}var dt=function(t,e,r){for(var n=t.length,o=0,s=new Je(e);o<n;++o)t[o]&&++s[t[o]-1];var a=new Je(e);for(o=0;o<e;++o)a[o]=a[o-1]+s[o-1]<<1;var l;if(r){l=new Je(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],u=e-t[o],c=a[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)l[zt[c]>>>i]=f}else for(l=new Je(n),o=0;o<n;++o)t[o]&&(l[o]=zt[a[t[o]-1]++]>>>15-t[o]);return l},kt=new fe(288);for(var X=0;X<144;++X)kt[X]=8;for(var X=144;X<256;++X)kt[X]=9;for(var X=256;X<280;++X)kt[X]=7;for(var X=280;X<288;++X)kt[X]=8;var un=new fe(32);for(var X=0;X<32;++X)un[X]=5;var co=dt(kt,9,1),po=dt(un,5,1),Nt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},be=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},xt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},$o=function(t){return(t+7)/8|0},rr=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?Je:t.BYTES_PER_ELEMENT==4?rn:fe)(r-e);return n.set(t.subarray(e,r)),n},mo=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ke=function(t,e,r){var n=new Error(e||mo[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ke),!r)throw n;return n},ho=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new fe(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new fe(n*3));var a=function(ot){var st=e.length;if(ot>st){var mt=new fe(Math.max(st*2,ot));mt.set(e),e=mt}},l=r.f||0,i=r.p||0,f=r.b||0,u=r.l,c=r.d,p=r.m,$=r.n,y=n*8;do{if(!u){l=be(t,i,1);var k=be(t,i+1,3);if(i+=3,k)if(k==1)u=co,c=po,p=9,$=5;else if(k==2){var M=be(t,i,31)+257,C=be(t,i+10,15)+4,A=M+be(t,i+5,31)+1;i+=14;for(var F=new fe(A),x=new fe(19),P=0;P<C;++P)x[ao[P]]=be(t,i+P*3,7);i+=C*3;for(var I=Nt(x),N=(1<<I)-1,B=dt(x,I,1),P=0;P<A;){var J=B[be(t,i,N)];i+=J&15;var S=J>>>4;if(S<16)F[P++]=S;else{var U=0,ae=0;for(S==16?(ae=3+be(t,i,3),i+=2,U=F[P-1]):S==17?(ae=3+be(t,i,7),i+=3):S==18&&(ae=11+be(t,i,127),i+=7);ae--;)F[P++]=U}}var he=F.subarray(0,M),oe=F.subarray(M);p=Nt(he),$=Nt(oe),u=dt(he,p,1),c=dt(oe,$,1)}else ke(1);else{var S=$o(i)+4,L=t[S-4]|t[S-3]<<8,D=S+L;if(D>n){s&&ke(0);break}o&&a(f+L),e.set(t.subarray(S,D),f),r.b=f+=L,r.p=i=D*8,r.f=l;continue}if(i>y){s&&ke(0);break}}o&&a(f+131072);for(var Ve=(1<<p)-1,le=(1<<$)-1,$t=i;;$t=i){var U=u[xt(t,i)&Ve],Be=U>>>4;if(i+=U&15,i>y){s&&ke(0);break}if(U||ke(2),Be<256)e[f++]=Be;else if(Be==256){$t=i,u=null;break}else{var tt=Be-254;if(Be>264){var P=Be-257,ge=nn[P];tt=be(t,i,(1<<ge)-1)+ln[P],i+=ge}var rt=c[xt(t,i)&le],Ne=rt>>>4;rt||ke(3),i+=rt&15;var oe=fo[Ne];if(Ne>3){var ge=on[Ne];oe+=xt(t,i)&(1<<ge)-1,i+=ge}if(i>y){s&&ke(0);break}o&&a(f+131072);for(var nt=f+tt;f<nt;f+=4)e[f]=e[f-oe],e[f+1]=e[f+1-oe],e[f+2]=e[f+2-oe],e[f+3]=e[f+3-oe];f=nt}}r.l=u,r.p=$t,r.b=f,r.f=l,u&&(l=1,r.m=p,r.d=c,r.n=$)}while(!l);return f==e.length?e:rr(e,0,f)},go=new fe(0),Pe=function(t,e){return t[e]|t[e+1]<<8},Se=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Mt=function(t,e){return Se(t,e)+Se(t,e+4)*4294967296};function _o(t,e){return ho(t,e)}var Vt=typeof TextDecoder<"u"&&new TextDecoder,wo=0;try{Vt.decode(go,{stream:!0}),wo=1}catch{}var bo=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,rr(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function fn(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Vt)return Vt.decode(t);var o=bo(t),s=o[0],a=o[1];return a.length&&ke(8),s}}var vo=function(t,e){return e+30+Pe(t,e+26)+Pe(t,e+28)},yo=function(t,e,r){var n=Pe(t,e+28),o=fn(t.subarray(e+46,e+46+n),!(Pe(t,e+8)&2048)),s=e+46+n,a=Se(t,e+20),l=r&&a==4294967295?ko(t,s):[a,Se(t,e+24),Se(t,e+42)],i=l[0],f=l[1],u=l[2];return[Pe(t,e+10),i,f,o,s+Pe(t,e+30)+Pe(t,e+32),u]},ko=function(t,e){for(;Pe(t,e)!=1;e+=4+Pe(t,e+2));return[Mt(t,e+12),Mt(t,e+4),Mt(t,e+20)]};function So(t,e){for(var r={},n=t.length-22;Se(t,n)!=101010256;--n)(!n||t.length-n>65558)&&ke(13);var o=Pe(t,n+8);if(!o)return{};var s=Se(t,n+16),a=s==4294967295||o==65535;if(a){var l=Se(t,n-12);a=Se(t,l)==101075792,a&&(o=Se(t,l+32),s=Se(t,l+48))}for(var i=e&&e.filter,f=0;f<o;++f){var u=yo(t,s,a),c=u[0],p=u[1],$=u[2],y=u[3],k=u[4],S=u[5],L=vo(t,S);s=k,(!i||i({name:y,size:p,originalSize:$,compression:c}))&&(c?c==8?r[y]=_o(t.subarray(L,L+p),new fe($)):ke(14,"unknown compression type "+c):r[y]=rr(t,L,L+p))}return r}function Co(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Ft):Ft(t)}function Ft(t){var e=new Uint8Array(t),r=So(e);return Promise.resolve(Lo(r))}function Lo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=fn(t[o])}return e}function Ie(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&et(n)===e)return n;r++}}function St(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&et(o)===e&&r.push(o),n++}return r}function Et(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&et(o)===e&&r(o,n):r(o,n),n++}}function To(t,e,r){var n=[];return Et(t,e,function(o,s){n.push(r(o,s))}),n}var Oo=/.+\:/;function et(t){return t.tagName.replace(Oo,"")}function cn(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+et(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=cn(t.childNodes[n]),n++;return e+="</"+et(t)+">",e}function Ao(t){var e=t.documentElement,r=Ie(e,"sheetData"),n=[];return Et(r,"row",function(o){Et(o,"c",function(s){n.push(s)})}),n}function Do(t,e){return Ie(e,"v")}function Eo(t,e){if(e.firstChild&&et(e.firstChild)==="is"&&e.firstChild.firstChild&&et(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function Po(t){var e=t.documentElement,r=Ie(e,"dimension");if(r)return r.getAttribute("ref")}function Io(t){var e=t.documentElement,r=Ie(e,"cellStyleXfs");return r?St(r,"xf"):[]}function No(t){var e=t.documentElement,r=Ie(e,"cellXfs");return r?St(r,"xf"):[]}function xo(t){var e=t.documentElement,r=Ie(e,"numFmts");return r?St(r,"numFmt"):[]}function Mo(t){var e=t.documentElement;return To(e,"si",function(r){var n=Ie(r,"t");if(n)return n.textContent;var o="";return Et(r,"r",function(s){o+=Ie(s,"t").textContent}),o})}function Fo(t){var e=t.documentElement;return Ie(e,"workbookPr")}function Bo(t){var e=t.documentElement;return St(e,"Relationship")}function jo(t){var e=t.documentElement,r=Ie(e,"sheets");return St(r,"sheet")}function Uo(t,e){var r=e.createDocument(t),n={},o=Fo(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(l){l.getAttribute("name")&&n.sheets.push({id:l.getAttribute("sheetId"),name:l.getAttribute("name"),relationId:l.getAttribute("r:id")})};return jo(r).forEach(s),n}function Ro(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(a){var l=a.getAttribute("Target"),i=a.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=Bt(l);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=Bt(l);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[a.getAttribute("Id")]=Bt(l);break}};return Bo(r).forEach(o),n}function Bt(t){return t[0]==="/"?t.slice(1):"xl/"+t}function pr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function $r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pr(Object(r),!0).forEach(function(n){Ho(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ho(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wo(t,e){if(!t)return{};var r=e.createDocument(t),n=Io(r).map(jt),o=xo(r).map(zo).reduce(function(a,l){return a[l.id]=l,a},[]),s=function(l){return l.hasAttribute("xfId")?$r($r({},n[l.xfId]),jt(l,o)):jt(l,o)};return No(r).map(s)}function zo(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function jt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function Vo(t,e){return t?Mo(e.createDocument(t)):[]}function pn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function Go(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ko(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ko(t,e){if(t){if(typeof t=="string")return mr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mr(t,e)}}function mr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qo(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(Zo.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&Jo(o.numberFormat.template))return!0}}var Zo=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],Xo=/^\[\$-414\]/,Yo=/;@$/;function Jo(t){t=t.toLowerCase(),t=t.replace(Xo,""),t=t.replace(Yo,"");for(var e=t.split(/\W+/),r=Go(e),n;!(n=r()).done;){var o=n.value;if(Qo.indexOf(o)<0)return!1}return!0}var Qo=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function es(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,a=r.styles,l=r.values,i=r.properties,f=r.options;switch(e||(e="n"),e){case"str":t=Ut(t,f);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=Ut(t,f);break;case"s":var u=Number(t);if(isNaN(u))throw new Error('Invalid "shared" string index: '.concat(t));if(u>=l.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=l[u],t=Ut(t,f);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=ts(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,qo(t,s(),a,f)&&(t=pn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function ts(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function Ut(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var rs=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function ns(t){var e=function(f,u){return f-u},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],a=n[0],l=n[n.length-1];return[{row:o,column:a},{row:s,column:l}]}function os(t){for(var e=0,r=0;r<t.length;)e*=26,e+=rs.indexOf(t[r]),r++;return e}function $n(t){return t=t.split(/(\d+)/),[parseInt(t[1]),os(t[0].trim())]}function ss(t,e,r,n,o,s,a){var l=$n(t.getAttribute("r")),i=Do(e,t),f=i&&i.textContent,u;return t.hasAttribute("t")&&(u=t.getAttribute("t")),{row:l[0],column:l[1],value:es(f,u,{getInlineStringValue:function(){return Eo(e,t)},getInlineStringXml:function(){return cn(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:a})}}function is(t,e,r,n,o,s){var a=Ao(t);return a.length===0?[]:a.map(function(l){return ss(l,t,e,r,n,o,s)})}function as(t,e){return cs(t)||fs(t,e)||us(t,e)||ls()}function ls(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function us(t,e){if(t){if(typeof t=="string")return hr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hr(t,e)}}function hr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,l;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,l=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function cs(t){if(Array.isArray(t))return t}function ps(t){var e=Po(t);if(e)return e=e.split(":").map($n).map(function(r){var n=as(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function $s(t,e,r,n,o,s){var a=e.createDocument(t),l=is(a,e,r,n,o,s),i=ps(a)||ns(l);return{cells:l,dimensions:i}}function ms(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=hs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hs(t,e){if(t){if(typeof t=="string")return gr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gr(t,e)}}function gr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,a=t.length-1;a>=0;){for(var l=!0,i=ms(t[a]),f;!(f=i()).done;){var u=f.value;if(o(u)!==null){l=!1;break}}if(l)t.splice(a,1),r&&r.splice(a,1);else if(s)break;a--}return t}function ds(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=_s(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _s(t,e){if(t){if(typeof t=="string")return dr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dr(t,e)}}function dr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ws(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var a=!0,l=ds(t),i;!(i=l()).done;){var f=i.value;if(n(f[s])!==null){a=!1;break}}if(a)for(var u=0;u<t.length;)t[u].splice(s,1),u++;else if(o)break;s--}return t}function bs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=mn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vs(t,e){return Ss(t)||ks(t,e)||mn(t,e)||ys()}function ys(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mn(t,e){if(t){if(typeof t=="string")return _r(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _r(t,e)}}function _r(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ks(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,l;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,l=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function Ss(t){if(Array.isArray(t))return t}function Cs(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=vs(r,2);o[0];for(var s=o[1],a=s.column,l=s.row,i=new Array(l),f=0;f<l;){i[f]=new Array(a);for(var u=0;u<a;)i[f][u]=null,u++;f++}for(var c=bs(n),p;!(p=c()).done;){var $=p.value,y=$.row-1,k=$.column-1;k<a&&y<l&&(i[y][k]=$.value)}var S=e.rowMap;if(S)for(var L=0;L<i.length;)S[L]=L,L++;return i=gs(ws(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:S}),e.transformData&&(i=e.transformData(i)),i}function Ls(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ts(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ts(t,e){if(t){if(typeof t=="string")return wr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(t,e)}}function wr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function br(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Os(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?br(Object(r),!0).forEach(function(n){As(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function As(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ds(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=Os({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=Ro(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?Vo(n(o.sharedStrings),e):[],a=o.styles?Wo(n(o.styles),e):{},l=Uo(n("xl/workbook.xml"),e);if(r.getSheets)return l.sheets.map(function(c){var p=c.name;return{name:p}});var i=Es(r.sheet,l.sheets);if(!i||!o.sheets[i])throw Ps(r.sheet,l.sheets);var f=$s(n(o.sheets[i]),e,s,a,l,r),u=Cs(f,r);return r.properties?{data:u,properties:l}:u}function Es(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Ls(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function Ps(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function Gt(t){"@babel/helpers - typeof";return Gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(t)}function vr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Is(t,e,r){return e&&vr(t.prototype,e),r&&vr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ns(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bt(t,e)}function Ms(t){var e=hn();return function(){var n=vt(t),o;if(e){var s=vt(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Fs(this,o)}}function Fs(t,e){if(e&&(Gt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bs(t)}function Bs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kt(t){var e=typeof Map=="function"?new Map:void 0;return Kt=function(n){if(n===null||!js(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Tt(n,arguments,vt(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),bt(o,n)},Kt(t)}function Tt(t,e,r){return hn()?Tt=Reflect.construct:Tt=function(o,s,a){var l=[null];l.push.apply(l,s);var i=Function.bind.apply(o,l),f=new i;return a&&bt(f,a.prototype),f},Tt.apply(null,arguments)}function hn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function js(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function bt(t,e){return bt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},bt(t,e)}function vt(t){return vt=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},vt(t)}var ce=function(t){xs(r,t);var e=Ms(r);function r(n){var o;return Ns(this,r),o=e.call(this,"invalid"),o.reason=n,o}return Is(r)}(Kt(Error));function Us(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new ce("not_a_number")}if(typeof t!="number")throw new ce("not_a_number");if(isNaN(t))throw new ce("invalid_number");if(!isFinite(t))throw new ce("out_of_bounds");return t}function Rs(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new ce("invalid_number");if(!isFinite(t))throw new ce("out_of_bounds");return String(t)}throw new ce("not_a_string")}function Hs(t){if(typeof t=="boolean")return t;throw new ce("not_a_boolean")}function Ws(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new ce("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new ce("invalid_number");if(!isFinite(t))throw new ce("out_of_bounds");var n=pn(t,r);if(isNaN(n.valueOf()))throw new ce("out_of_bounds");return n}throw new ce("not_a_date")}function zs(t,e){return Ks(t)||Gs(t,e)||gn(t,e)||Vs()}function Vs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,l;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,l=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function Ks(t){if(Array.isArray(t))return t}function qt(t){"@babel/helpers - typeof";return qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(t)}function qs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=gn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gn(t,e){if(t){if(typeof t=="string")return yr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(t,e)}}function yr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kr(Object(r),!0).forEach(function(n){Zs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Cr={isColumnOriented:!1};function Xs(t,e,r){r?r=Sr(Sr({},Cr),r):r=Cr;var n=r,o=n.isColumnOriented,s=n.rowMap,a=n.ignoreEmptyRows;ei(e),o&&(t=Qs(t));for(var l=t[0],i=[],f=[],u=1;u<t.length;u++){var c=dn(e,t[u],u,l,f,r);(c!==null||a===!1)&&i.push(c)}if(s)for(var p=qs(f),$;!($=p()).done;){var y=$.value;y.row=s[y.row-1]+1}return{rows:i,errors:f}}function dn(t,e,r,n,o,s){for(var a={},l=!0,i=function(){var p=u[f],$=t[p],y=qt($.type)==="object"&&!Array.isArray($.type),k=e[n.indexOf(p)];k===void 0&&(k=null);var S=void 0,L=void 0,D=void 0;if(y)S=dn($.type,e,r,n,o,s);else if(k===null)S=null;else if(Array.isArray($.type)){var M=!1,C=Js(k).map(function(F){var x=Lr(F,$,s);return x.error&&(S=F,L=x.error,D=x.reason),x.value!==null&&(M=!0),x.value});L||(S=M?C:null)}else{var A=Lr(k,$,s);L=A.error,D=A.reason,S=L?k:A.value}!L&&S===null&&$.required&&(L="required"),L?(L={error:L,row:r+1,column:p,value:S},D&&(L.reason=D),$.type&&(L.type=$.type),o.push(L)):(l&&S!==null&&(l=!1),(S!==null||s.includeNullValues)&&(a[$.prop]=S))},f=0,u=Object.keys(t);f<u.length;f++)i();return l?null:a}function Lr(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=at(t,e.parse):e.type?n=Ys(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function at(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function Ys(t,e,r){switch(e){case String:return at(t,Rs);case Number:return at(t,Us);case Date:return at(t,function(n){return Ws(n,{properties:r.properties})});case Boolean:return at(t,Hs);default:if(typeof e=="function")return at(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function _n(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var a=_n(t,'"',r+n+1);o+=a[0],n+=1+a[1]+1}else o+=s,n++}return[o,n]}function Js(t){for(var e=[],r=0;r<t.length;){var n=_n(t,",",r),o=zs(n,2),s=o[0],a=o[1];r+=a+1,e.push(s.trim())}return e}var Qs=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function ei(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function Zt(t){"@babel/helpers - typeof";return Zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zt(t)}function wn(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],a=void 0;Zt(s)==="object"&&(s=Object.keys(t[o])[0],a=wn(t[o][s])),e[o]={prop:s},a&&(e[o].type=a)}return e}var ti=["schema","map"];function Tr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Lt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tr(Object(r),!0).forEach(function(n){ri(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ri(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ni(t,e){if(t==null)return{};var r=oi(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function oi(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function si(t,e,r){var n=r.schema,o=r.map,s=ni(r,ti);!n&&o&&(n=wn(o));var a=Ds(t,e,Lt(Lt({},s),{},{properties:n||s.properties}));return n?Xs(a.data,n,Lt(Lt({},s),{},{properties:a.properties})):a}function ii(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Co(t).then(function(r){return si(r,io,e)})}function ai(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function li(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await ii(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=xn(o.lat_lon.split(",").map(parseFloat).reverse()),a=o;a.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:a,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const R={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},bn=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function ui(t){let e,r,n,o,s;function a(i){t[3](i)}let l={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(l.value=t[0]),e=new Dt({props:l}),W.push(()=>q(e,"value",a)),e.$on("change",t[2]),o=new Gn({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};!r&&f&1&&(r=!0,u.value=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function fi(t,e,r){let n;Y(t,re,i=>r(4,n=i));let o="interventionType",s=cr("v1");function a(){let i;o=="interventionType"?(i=tn("v1"),r(1,s=cr("v1"))):(i=Xr(["get","funding_programme"],{ATF2:R.atf2,ATF3:R.atf3,ATF4:R.atf4},"grey"),r(1,s=[["ATF2",R.atf2],["ATF3",R.atf3],["ATF4",R.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function l(i){o=i,r(0,o)}return[o,s,a,l]}class ci extends V{constructor(e){super(),G(this,e,fi,ui,K,{})}}function pi(t){let e;return{c(){e=v("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $i(t){let e,r,n,o,s,a;return n=new Wt({props:{$$slots:{default:[pi]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=E("input"),r=T(),_(n.$$.fragment),z(e,"type","text"),z(e,"class","govuk-input govuk-input--width-10"),z(e,"id","filterText")},m(l,i){m(l,e,i),lr(e,t[0]),m(l,r,i),w(n,l,i),o=!0,s||(a=Qt(e,"input",t[12]),s=!0)},p(l,i){i&1&&e.value!==l[0]&&lr(e,l[0]);const f={};i&131072&&(f.$$scope={dirty:i,ctx:l}),n.$set(f)},i(l){o||(g(n.$$.fragment,l),o=!0)},o(l){d(n.$$.fragment,l),o=!1},d(l){l&&(h(e),h(r)),b(n,l),s=!1,a()}}}function mi(t){let e,r,n,o,s,a,l,i,f,u;function c(k){t[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Dt({props:p}),W.push(()=>q(e,"value",c));function $(k){t[11](k)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(y.value=t[3]),o=new Dt({props:y}),W.push(()=>q(o,"value",$)),l=new Yr({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[$i]},$$scope:{ctx:t}}}),f=new ci({}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment),a=T(),_(l.$$.fragment),i=T(),_(f.$$.fragment)},m(k,S){w(e,k,S),m(k,n,S),w(o,k,S),m(k,a,S),w(l,k,S),m(k,i,S),w(f,k,S),u=!0},p(k,S){const L={};S&32&&(L.choices=k[5]),!r&&S&4&&(r=!0,L.value=k[2],Z(()=>r=!1)),e.$set(L);const D={};S&64&&(D.choices=k[6]),!s&&S&8&&(s=!0,D.value=k[3],Z(()=>s=!1)),o.$set(D);const M={};S&131073&&(M.$$scope={dirty:S,ctx:k}),l.$set(M)},i(k){u||(g(e.$$.fragment,k),g(o.$$.fragment,k),g(l.$$.fragment,k),g(f.$$.fragment,k),u=!0)},o(k){d(e.$$.fragment,k),d(o.$$.fragment,k),d(l.$$.fragment,k),d(f.$$.fragment,k),u=!1},d(k){k&&(h(n),h(a),h(i)),b(e,k),b(o,k),b(l,k),b(f,k)}}}function hi(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",a,l,i=t[7].area.toLocaleString()+"",f,u,c=t[7].crossing.toLocaleString()+"",p,$,y=t[7].other.toLocaleString()+"",k,S;return{c(){e=v("Showing "),n=v(r),o=v(" schemes ("),a=v(s),l=v(`
    routes, `),f=v(i),u=v(` areas,
    `),p=v(c),$=v(" crossings, "),k=v(y),S=v(`
    other)`)},m(L,D){m(L,e,D),m(L,n,D),m(L,o,D),m(L,a,D),m(L,l,D),m(L,f,D),m(L,u,D),m(L,p,D),m(L,$,D),m(L,k,D),m(L,S,D)},p(L,D){D&2&&r!==(r=L[1].size.toLocaleString()+"")&&Ce(n,r),D&128&&s!==(s=L[7].route.toLocaleString()+"")&&Ce(a,s),D&128&&i!==(i=L[7].area.toLocaleString()+"")&&Ce(f,i),D&128&&c!==(c=L[7].crossing.toLocaleString()+"")&&Ce(p,c),D&128&&y!==(y=L[7].other.toLocaleString()+"")&&Ce(k,y)},d(L){L&&(h(e),h(n),h(o),h(a),h(l),h(f),h(u),h(p),h($),h(k),h(S))}}}function gi(t){let e,r,n;function o(a){t[14](a)}let s={id:"show-schemes",$$slots:{default:[hi]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),W.push(()=>q(e,"checked",o)),{c(){_(e.$$.fragment)},m(a,l){w(e,a,l),n=!0},p(a,l){const i={};l&131202&&(i.$$scope={dirty:l,ctx:a}),!r&&l&16&&(r=!0,i.checked=a[4],Z(()=>r=!1)),e.$set(i)},i(a){n||(g(e.$$.fragment,a),n=!0)},o(a){d(e.$$.fragment,a),n=!1},d(a){b(e,a)}}}function di(t){let e,r,n,o;return e=new Me({props:{label:"Filters",$$slots:{default:[mi]},$$scope:{ctx:t}}}),n=new yt({props:{small:!0,$$slots:{default:[gi]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},p(s,[a]){const l={};a&131181&&(l.$$scope={dirty:a,ctx:s}),e.$set(l);const i={};a&131218&&(i.$$scope={dirty:a,ctx:s}),n.$set(i)},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function _i(t,e,r){let n,o;Y(t,ft,C=>r(15,n=C)),Y(t,re,C=>r(9,o=C));let{schemes:s}=e,{schemesToBeShown:a=new Set}=e,{filterText:l=""}=e,i=[],f="",u=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;It(()=>{let C=new Set,A=new Set;for(let F of s.values())F.authority_or_region&&C.add(F.authority_or_region),F.funding_programme&&A.add(F.funding_programme);r(5,i=Array.from(C.entries())),i.sort(),r(6,u=Array.from(A.entries())),u.sort()});function y(C,A,F){let x=C.toLowerCase(),P=N=>{var B,J;if(x&&!((B=N.properties.name)!=null&&B.toLowerCase().includes(x))&&!((J=N.properties.description)!=null&&J.toLowerCase().includes(x)))return!1;if(A||F){let U=s.get(N.properties.scheme_reference);if(A&&U.authority_or_region!=A||F&&U.funding_programme!=F)return!1}return!0};r(1,a=new Set(n.features.filter(P).map(N=>N.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let I=N=>{var B,J;return!(!a.has(N.properties.scheme_reference)||x&&!((B=N.properties.name)!=null&&B.toLowerCase().includes(x))&&!((J=N.properties.description)!=null&&J.toLowerCase().includes(x)))};ft.update(N=>{for(let B of N.features)I(B)?(delete B.properties.hide_while_editing,r(7,p[B.properties.intervention_type]++,p)):B.properties.hide_while_editing=!0;return N}),r(7,p)}function k(C){f=C,r(2,f)}function S(C){c=C,r(3,c)}function L(){l=this.value,r(0,l)}const D=()=>r(0,l="");function M(C){$=C,r(4,$)}return t.$$set=C=>{"schemes"in C&&r(8,s=C.schemes),"schemesToBeShown"in C&&r(1,a=C.schemesToBeShown),"filterText"in C&&r(0,l=C.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let C of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(C)&&o.setLayoutProperty(C,"visibility",$?"visible":"none");t.$$.dirty&13&&y(l,f,c)},[l,a,f,c,$,i,u,p,s,o,k,S,L,D,M]}class wi extends V{constructor(e){super(),G(this,e,_i,di,K,{schemes:8,schemesToBeShown:1,filterText:0})}}function bi(t){let e,r,n;return e=new me({props:{color:R.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=v(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function vi(t){let e;return{c(){e=v(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yi(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ki(t){let e,r,n,o,s,a,l,i,f,u,c;return s=new j({props:{href:"https://gtfs.org",$$slots:{default:[vi]},$$scope:{ctx:t}}}),u=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[yi]},$$scope:{ctx:t}}}),{c(){e=E("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=T(),n=E("p"),o=v("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),a=v(`, and doesn't include which routes are run or the
        frequency of service.`),l=T(),i=E("p"),f=v("License: "),_(u.$$.fragment)},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),O(n,o),w(s,n,null),O(n,a),m(p,l,$),m(p,i,$),O(i,f),w(u,i,null),c=!0},p(p,$){const y={};$&8&&(y.$$scope={dirty:$,ctx:p}),s.$set(y);const k={};$&8&&(k.$$scope={dirty:$,ctx:p}),u.$set(k)},i(p){c||(g(s.$$.fragment,p),g(u.$$.fragment,p),c=!0)},o(p){d(s.$$.fragment,p),d(u.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(l),h(i)),b(s),b(u)}}}function Si(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ki]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&8&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ci(t){let e,r,n,o,s;function a(i){t[1](i)}let l={id:Ge,$$slots:{right:[Si],default:[bi]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Ge,tooltip:Li,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&8&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ge="bus_routes";function Li(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Ti(t,e,r){let n;Y(t,re,a=>r(2,n=a)),$e(n,Ge,`https://atip.uk/layers/v1/${Ge}.pmtiles`),Le(n,{id:Ge,source:Ge,sourceLayer:Ge,color:["case",["boolean",["get","has_bus_lane"],!1],R.bus_route_with_lane,R.bus_route_without_lane],width:5,opacity:we(.5,1)});let o=!1;function s(a){o=a,r(0,o)}return[o,s]}class Oi extends V{constructor(e){super(),G(this,e,Ti,Ci,K,{})}}function Or(t,e,r){const n=t.slice();return n[2]=e[r],n}function Ar(t,e,r){const n=t.slice();return n[5]=e[r],n}function Dr(t){let e,r;return{c(){e=E("span"),r=v(` 
    `),Fe(e,"background",t[5]),Fe(e,"width","100%"),Fe(e,"border","1px solid black")},m(n,o){m(n,e,o),O(e,r)},p(n,o){o&1&&Fe(e,"background",n[5])},d(n){n&&h(e)}}}function Er(t){let e,r=t[2]+"",n;return{c(){e=E("span"),n=v(r)},m(o,s){m(o,e,s),O(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&Ce(n,r)},d(o){o&&h(e)}}}function Ai(t){let e,r,n,o=We(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Dr(Ar(t,o,i));let a=We(t[1]),l=[];for(let i=0;i<a.length;i+=1)l[i]=Er(Or(t,a,i));return{c(){e=E("div");for(let i=0;i<s.length;i+=1)s[i].c();r=T(),n=E("div");for(let i=0;i<l.length;i+=1)l[i].c();Fe(e,"display","flex"),Fe(n,"display","flex"),Fe(n,"justify-content","space-between")},m(i,f){m(i,e,f);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);m(i,r,f),m(i,n,f);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(n,null)},p(i,[f]){if(f&1){o=We(i[0]);let u;for(u=0;u<o.length;u+=1){const c=Ar(i,o,u);s[u]?s[u].p(c,f):(s[u]=Dr(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length}if(f&2){a=We(i[1]);let u;for(u=0;u<a.length;u+=1){const c=Or(i,a,u);l[u]?l[u].p(c,f):(l[u]=Er(c),l[u].c(),l[u].m(n,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=a.length}},i:ee,o:ee,d(i){i&&(h(e),h(r),h(n)),At(s,i),At(l,i)}}}function Di(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class pt extends V{constructor(e){super(),G(this,e,Di,Ai,K,{colorScale:0,limits:1})}}function Ei(t){let e;return{c(){e=v("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pi(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ii(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ni(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xi(t){let e,r,n,o,s,a,l,i,f,u,c,p;return n=new j({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Pi]},$$scope:{ctx:t}}}),s=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Ii]},$$scope:{ctx:t}}}),u=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ni]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),a=v("."),l=T(),i=E("p"),f=v("License: "),_(u.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),O(e,r),w(n,e,null),O(e,o),w(s,e,null),O(e,a),m($,l,y),m($,i,y),O(i,f),w(u,i,null),O(i,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&65536&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&65536&&(L.$$scope={dirty:y,ctx:$}),u.$set(L)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(u.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(l),h(i)),b(n),b(s),b(u)}}}function Mi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[xi]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Pr(t){let e,r;return e=new pt({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:ee,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Fi(t){let e;return{c(){e=v("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bi(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ji(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ui(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ri(t){let e,r,n,o,s,a,l,i,f,u,c,p,$,y;return s=new j({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Bi]},$$scope:{ctx:t}}}),l=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[ji]},$$scope:{ctx:t}}}),p=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ui]},$$scope:{ctx:t}}}),{c(){e=E("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=T(),n=E("p"),o=v("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),a=v(". Output area boundaries from "),_(l.$$.fragment),i=v("."),f=T(),u=E("p"),c=v("License: "),_(p.$$.fragment),$=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(k,S){m(k,e,S),m(k,r,S),m(k,n,S),O(n,o),w(s,n,null),O(n,a),w(l,n,null),O(n,i),m(k,f,S),m(k,u,S),O(u,c),w(p,u,null),O(u,$),y=!0},p(k,S){const L={};S&65536&&(L.$$scope={dirty:S,ctx:k}),s.$set(L);const D={};S&65536&&(D.$$scope={dirty:S,ctx:k}),l.$set(D);const M={};S&65536&&(M.$$scope={dirty:S,ctx:k}),p.$set(M)},i(k){y||(g(s.$$.fragment,k),g(l.$$.fragment,k),g(p.$$.fragment,k),y=!0)},o(k){d(s.$$.fragment,k),d(l.$$.fragment,k),d(p.$$.fragment,k),y=!1},d(k){k&&(h(e),h(r),h(n),h(f),h(u)),b(s),b(l),b(p)}}}function Hi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ri]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ir(t){let e,r;return e=new pt({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:ee,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Wi(t){let e;return{c(){e=v("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zi(t){let e;return{c(){e=v(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gi(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ki(t){let e,r,n,o,s,a,l,i,f,u,c,p;return n=new j({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[zi]},$$scope:{ctx:t}}}),s=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Vi]},$$scope:{ctx:t}}}),u=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Gi]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),a=v("."),l=T(),i=E("p"),f=v("License: "),_(u.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),O(e,r),w(n,e,null),O(e,o),w(s,e,null),O(e,a),m($,l,y),m($,i,y),O(i,f),w(u,i,null),O(i,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&65536&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&65536&&(L.$$scope={dirty:y,ctx:$}),u.$set(L)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(u.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(l),h(i)),b(n),b(s),b(u)}}}function qi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ki]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Nr(t){let e,r,n,o;return n=new pt({props:{colorScale:t[4],limits:t[7]().map(Xi)}}),{c(){e=E("p"),e.textContent="(people per square kilometres)",r=T(),_(n.$$.fragment)},m(s,a){m(s,e,a),m(s,r,a),w(n,s,a),o=!0},p:ee,i(s){o||(g(n.$$.fragment,s),o=!0)},o(s){d(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function Zi(t){let e,r,n,o,s,a,l,i,f,u,c,p,$,y;function k(P){t[9](P)}let S={id:"percent_households_with_car",$$slots:{right:[Mi],default:[Ei]},$$scope:{ctx:t}};t[0]!==void 0&&(S.checked=t[0]),e=new te({props:S}),W.push(()=>q(e,"checked",k)),e.$on("change",t[10]);let L=t[3]=="percent_households_with_car"&&Pr(t);function D(P){t[11](P)}let M={id:"average_cars_per_household",$$slots:{right:[Hi],default:[Fi]},$$scope:{ctx:t}};t[1]!==void 0&&(M.checked=t[1]),s=new te({props:M}),W.push(()=>q(s,"checked",D)),s.$on("change",t[12]);let C=t[3]=="average_cars_per_household"&&Ir(t);function A(P){t[13](P)}let F={id:"population_density",$$slots:{right:[qi],default:[Wi]},$$scope:{ctx:t}};t[2]!==void 0&&(F.checked=t[2]),f=new te({props:F}),W.push(()=>q(f,"checked",A)),f.$on("change",t[14]);let x=t[3]=="population_density"&&Nr(t);return $=new Q({props:{layer:Te,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=T(),L&&L.c(),o=T(),_(s.$$.fragment),l=T(),C&&C.c(),i=T(),_(f.$$.fragment),c=T(),x&&x.c(),p=T(),_($.$$.fragment)},m(P,I){w(e,P,I),m(P,n,I),L&&L.m(P,I),m(P,o,I),w(s,P,I),m(P,l,I),C&&C.m(P,I),m(P,i,I),w(f,P,I),m(P,c,I),x&&x.m(P,I),m(P,p,I),w($,P,I),y=!0},p(P,[I]){const N={};I&65536&&(N.$$scope={dirty:I,ctx:P}),!r&&I&1&&(r=!0,N.checked=P[0],Z(()=>r=!1)),e.$set(N),P[3]=="percent_households_with_car"?L?(L.p(P,I),I&8&&g(L,1)):(L=Pr(P),L.c(),g(L,1),L.m(o.parentNode,o)):L&&(de(),d(L,1,1,()=>{L=null}),_e());const B={};I&65536&&(B.$$scope={dirty:I,ctx:P}),!a&&I&2&&(a=!0,B.checked=P[1],Z(()=>a=!1)),s.$set(B),P[3]=="average_cars_per_household"?C?(C.p(P,I),I&8&&g(C,1)):(C=Ir(P),C.c(),g(C,1),C.m(i.parentNode,i)):C&&(de(),d(C,1,1,()=>{C=null}),_e());const J={};I&65536&&(J.$$scope={dirty:I,ctx:P}),!u&&I&4&&(u=!0,J.checked=P[2],Z(()=>u=!1)),f.$set(J),P[3]=="population_density"?x?(x.p(P,I),I&8&&g(x,1)):(x=Nr(P),x.c(),g(x,1),x.m(p.parentNode,p)):x&&(de(),d(x,1,1,()=>{x=null}),_e());const U={};I&8&&(U.show=P[3]!=""),$.$set(U)},i(P){y||(g(e.$$.fragment,P),g(L),g(s.$$.fragment,P),g(C),g(f.$$.fragment,P),g(x),g($.$$.fragment,P),y=!0)},o(P){d(e.$$.fragment,P),d(L),d(s.$$.fragment,P),d(C),d(f.$$.fragment,P),d(x),d($.$$.fragment,P),y=!1},d(P){P&&(h(n),h(o),h(l),h(i),h(c),h(p)),b(e,P),L&&L.d(P),b(s,P),C&&C.d(P),b(f,P),x&&x.d(P),b($,P)}}}let Te="census_output_areas";const Xi=t=>t.toLocaleString();function Yi(t,e,r){let n;Y(t,re,M=>r(8,n=M));let o=`${Te}-outline`,s=R.sequential_low_to_high,a=!1,l=!1,i=!1,f="";$e(n,Te,`https://atip.uk/layers/v1/${Te}.pmtiles`),ze(n,{id:Te,source:Te,sourceLayer:Te,color:"black",opacity:we(.5,.7)}),Le(n,{id:o,source:Te,sourceLayer:Te,color:"black",width:.5});function u(M){let C=M.properties.OA21CD,A=M.properties[f];return f=="percent_households_with_car"?`<p>${A}% of households in ${C} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${C} have an average of ${A} cars</p>`:`<p>There are ${A.toLocaleString()} people per square kilometre in ${C}</p>`}function c(M){let C=M.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${C}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${C}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(M){a=M,r(0,a)}const y=()=>{r(1,l=!1),r(2,i=!1)};function k(M){l=M,r(1,l)}const S=()=>{r(0,a=!1),r(2,i=!1)};function L(M){i=M,r(2,i)}const D=()=>{r(0,a=!1),r(1,l=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(a?r(3,f="percent_households_with_car"):l?r(3,f="average_cars_per_household"):i?r(3,f="population_density"):r(3,f=""),f?(n.setPaintProperty(Te,"fill-color",wt(["get",f],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[a,l,i,f,s,u,c,p,n,$,y,k,S,L,D]}class Ji extends V{constructor(e){super(),G(this,e,Yi,Zi,K,{})}}function Qi(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ea(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ta(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ra(t){let e,r,n,o,s,a,l,i,f,u;return n=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[ea]},$$scope:{ctx:t}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ta]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of December 2022."),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),O(e,r),w(n,e,null),O(e,o),m(c,s,p),m(c,a,p),O(a,l),w(i,a,null),O(a,f),u=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){u||(g(n.$$.fragment,c),g(i.$$.fragment,c),u=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),u=!1},d(c){c&&(h(e),h(s),h(a)),b(n),b(i)}}}function na(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ra]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function oa(t){let e,r,n,o,s;function a(i){t[3](i)}let l={id:Ue,$$slots:{right:[na],default:[Qi]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Ue,tooltip:sa,show:t[0],clickable:!0}}),o.$on("click",ia),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ue="combined_authorities";function sa(t){return`<p>${t.properties.name}</p>`}function ia(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function aa(t,e,r){let n;Y(t,re,i=>r(2,n=i));let o=R.combined_authorities,s=`${Ue}-outline`;er(n,Ue,`https://atip.uk/layers/v1/${Ue}.geojson`),ze(n,{id:Ue,source:Ue,color:o,opacity:we(.5,0)}),Le(n,{id:s,source:Ue,color:o,width:2.5});let a=!1;function l(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,l]}class la extends V{constructor(e){super(),G(this,e,aa,oa,K,{})}}function ua(t){let e,r,n;return{c(){e=E("input"),z(e,"class","govuk-file-upload"),z(e,"id","load-criticals"),z(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=Qt(e,"change",t[4]),r=!0)},p:ee,d(o){o&&h(e),t[7](null),r=!1,n()}}}function xr(t){let e,r;return e=new yt({props:{small:!0,$$slots:{default:[ca]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function fa(t){let e,r,n=t[2].toLocaleString()+"",o,s,a;return e=new me({props:{color:Xt}}),{c(){_(e.$$.fragment),r=v(`
        Show `),o=v(n),s=v(" issues")},m(l,i){w(e,l,i),m(l,r,i),m(l,o,i),m(l,s,i),a=!0},p(l,i){(!a||i&4)&&n!==(n=l[2].toLocaleString()+"")&&Ce(o,n)},i(l){a||(g(e.$$.fragment,l),a=!0)},o(l){d(e.$$.fragment,l),a=!1},d(l){l&&(h(r),h(o),h(s)),b(e,l)}}}function ca(t){let e,r,n;function o(a){t[8](a)}let s={id:"show-criticals",$$slots:{default:[fa]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),W.push(()=>q(e,"checked",o)),{c(){_(e.$$.fragment)},m(a,l){w(e,a,l),n=!0},p(a,l){const i={};l&516&&(i.$$scope={dirty:l,ctx:a}),!r&&l&1&&(r=!0,i.checked=a[0],Z(()=>r=!1)),e.$set(i)},i(a){n||(g(e.$$.fragment,a),n=!0)},o(a){d(e.$$.fragment,a),n=!1},d(a){b(e,a)}}}function pa(t){let e,r,n,o,s,a;e=new Yr({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[ua]},$$scope:{ctx:t}}}),n=new Qr({props:{errorMessage:t[3]}});let l=t[2]>0&&xr(t);return{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),o=T(),l&&l.c(),s=tr()},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),m(i,o,f),l&&l.m(i,f),m(i,s,f),a=!0},p(i,f){const u={};f&514&&(u.$$scope={dirty:f,ctx:i}),e.$set(u);const c={};f&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?l?(l.p(i,f),f&4&&g(l,1)):(l=xr(i),l.c(),g(l,1),l.m(s.parentNode,s)):l&&(de(),d(l,1,1,()=>{l=null}),_e())},i(i){a||(g(e.$$.fragment,i),g(n.$$.fragment,i),g(l),a=!0)},o(i){d(e.$$.fragment,i),d(n.$$.fragment,i),d(l),a=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),l&&l.d(i)}}}function $a(t){let e,r,n,o,s,a;return e=new Me({props:{label:"Critical Issues",$$slots:{default:[pa]},$$scope:{ctx:t}}}),n=new Q({props:{layer:se+"-points",tooltip:ma,show:t[0],clickable:!1}}),s=new Q({props:{layer:se+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[se+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),o=T(),_(s.$$.fragment)},m(l,i){w(e,l,i),m(l,r,i),w(n,l,i),m(l,o,i),w(s,l,i),a=!0},p(l,[i]){const f={};i&527&&(f.$$scope={dirty:i,ctx:l}),e.$set(f);const u={};i&1&&(u.show=l[0]),n.$set(u);const c={};i&1&&(c.show=l[0]),s.$set(c)},i(l){a||(g(e.$$.fragment,l),g(n.$$.fragment,l),g(s.$$.fragment,l),a=!0)},o(l){d(e.$$.fragment,l),d(n.$$.fragment,l),d(s.$$.fragment,l),a=!1},d(l){l&&(h(r),h(o)),b(e,l),b(n,l),b(s,l)}}}let se="criticals",Xt="red";function ma(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function ha(t,e,r){let n;Y(t,re,p=>r(6,n=p));let o,s=!0,a=0,l="";Mn(n,se),n.addSource(se,{type:"geojson",data:Jr(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),ct(n,{id:`${se}-clusters`,source:se,filter:["has","point_count"],color:Xt,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${se}-counts`,source:se,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),ct(n,{id:`${se}-points`,source:se,filter:["!",["has","point_count"]],color:Xt,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await li(o.files[0]);n.getSource(se).setData($),r(2,a=$.features.length),r(3,l="")}catch($){r(3,l=`The file you loaded is broken: ${$}`)}}function f(p){n.getSource(se).getClusterExpansionZoom(p.detail.properties.cluster_id,($,y)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:y})})}function u(p){W[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${se}-counts`)&&n.setLayoutProperty(`${se}-counts`,"visibility",s?"visible":"none")},[s,o,a,l,i,f,n,u,c]}class ga extends V{constructor(e){super(),G(this,e,ha,$a,K,{})}}function da(t){let e,r,n;return e=new me({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=v(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function _a(t){let e;return{c(){e=v("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function wa(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ba(t){let e,r,n,o,s,a,l,i,f;return n=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[_a]},$$scope:{ctx:t}}}),i=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[wa]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment)},m(u,c){m(u,e,c),O(e,r),w(n,e,null),O(e,o),m(u,s,c),m(u,a,c),O(a,l),w(i,a,null),f=!0},p(u,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:u}),i.$set($)},i(u){f||(g(n.$$.fragment,u),g(i.$$.fragment,u),f=!0)},o(u){d(n.$$.fragment,u),d(i.$$.fragment,u),f=!1},d(u){u&&(h(e),h(s),h(a)),b(n),b(i)}}}function va(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ba]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function ya(t){let e,r,n,o,s;function a(i){t[3](i)}let l={id:Re,$$slots:{right:[va],default:[da]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Re,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",ka),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Re="crossings";function ka(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function Sa(t,e,r){let n;Y(t,re,f=>r(4,n=f));let o=!1;function s(f){const u=f.properties.crossing;return`<p>${a.get(u)??`Crossing with unknown type (${u})`}. Click for details.</p>`}const a=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);$e(n,Re,`https://atip.uk/layers/v1/${Re}.pmtiles`);let l=R[Re];ct(n,{id:Re,source:Re,sourceLayer:Re,color:l,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(f){o=f,r(0,o)}return[o,s,l,i]}class Ca extends V{constructor(e){super(),G(this,e,Sa,ya,K,{})}}function La(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ta(t){let e;return{c(){e=v("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Oa(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Aa(t){let e,r,n,o,s,a,l,i,f;return n=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Ta]},$$scope:{ctx:t}}}),i=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Oa]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Cycle parking, according to "),_(n.$$.fragment),o=v(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment)},m(u,c){m(u,e,c),O(e,r),w(n,e,null),O(e,o),m(u,s,c),m(u,a,c),O(a,l),w(i,a,null),f=!0},p(u,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:u}),i.$set($)},i(u){f||(g(n.$$.fragment,u),g(i.$$.fragment,u),f=!0)},o(u){d(n.$$.fragment,u),d(i.$$.fragment,u),f=!1},d(u){u&&(h(e),h(s),h(a)),b(n),b(i)}}}function Da(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Aa]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ea(t){let e,r,n,o,s;function a(i){t[2](i)}let l={id:Ke,$$slots:{right:[Da],default:[La]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Ke,tooltip:Pa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&16&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ke="cycle_parking";function Pa(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function Ia(t,e,r){let n;Y(t,re,l=>r(3,n=l));let o=R.cycle_parking;$e(n,Ke,`https://atip.uk/layers/v1/${Ke}.pmtiles`),ct(n,{id:Ke,source:Ke,sourceLayer:Ke,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function a(l){s=l,r(0,s)}return[s,o,a]}class Na extends V{constructor(e){super(),G(this,e,Ia,Ea,K,{})}}function Mr(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function xa(t){let e;return{c(){e=v("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ma(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fa(t){let e,r,n,o,s,a,l,i,f,u;return f=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ma]},$$scope:{ctx:t}}}),{c(){e=E("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=T(),n=E("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=T(),s=E("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,a=T(),l=E("p"),i=v("License: "),_(f.$$.fragment)},m(c,p){m(c,e,p),m(c,r,p),m(c,n,p),m(c,o,p),m(c,s,p),m(c,a,p),m(c,l,p),O(l,i),w(f,l,null),u=!0},p(c,p){const $={};p&256&&($.$$scope={dirty:p,ctx:c}),f.$set($)},i(c){u||(g(f.$$.fragment,c),u=!0)},o(c){d(f.$$.fragment,c),u=!1},d(c){c&&(h(e),h(r),h(n),h(o),h(s),h(a),h(l)),b(f)}}}function Ba(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Fa]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Fr(t){let e,r,n=We(t[1]),o=[];for(let a=0;a<n.length;a+=1)o[a]=Br(Mr(t,n,a));const s=a=>d(o[a],1,1,()=>{o[a]=null});return{c(){for(let a=0;a<o.length;a+=1)o[a].c();e=tr()},m(a,l){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(a,l);m(a,e,l),r=!0},p(a,l){if(l&2){n=We(a[1]);let i;for(i=0;i<n.length;i+=1){const f=Mr(a,n,i);o[i]?(o[i].p(f,l),g(o[i],1)):(o[i]=Br(f),o[i].c(),g(o[i],1),o[i].m(e.parentNode,e))}for(de(),i=n.length;i<o.length;i+=1)s(i);_e()}},i(a){if(!r){for(let l=0;l<n.length;l+=1)g(o[l]);r=!0}},o(a){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)d(o[l]);r=!1},d(a){a&&h(e),At(o,a)}}}function Br(t){let e,r,n,o=t[4]+"",s,a,l;return r=new me({props:{color:t[5]}}),{c(){e=E("div"),_(r.$$.fragment),n=T(),s=v(o),a=T()},m(i,f){m(i,e,f),w(r,e,null),O(e,n),O(e,s),O(e,a),l=!0},p:ee,i(i){l||(g(r.$$.fragment,i),l=!0)},o(i){d(r.$$.fragment,i),l=!1},d(i){i&&h(e),b(r)}}}function ja(t){let e,r,n,o,s,a;function l(u){t[2](u)}let i={id:qe,$$slots:{right:[Ba],default:[xa]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),W.push(()=>q(e,"checked",l));let f=t[0]&&Fr(t);return s=new Q({props:{layer:qe,tooltip:Ua,show:t[0],clickable:!0}}),s.$on("click",Ra),{c(){_(e.$$.fragment),n=T(),f&&f.c(),o=T(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),f&&f.m(u,c),m(u,o,c),w(s,u,c),a=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],Z(()=>r=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&g(f,1)):(f=Fr(u),f.c(),g(f,1),f.m(o.parentNode,o)):f&&(de(),d(f,1,1,()=>{f=null}),_e());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){a||(g(e.$$.fragment,u),g(f),g(s.$$.fragment,u),a=!0)},o(u){d(e.$$.fragment,u),d(f),d(s.$$.fragment,u),a=!1},d(u){u&&(h(n),h(o)),b(e,u),f&&f.d(u),b(s,u)}}}let qe="cycle_paths";function Ua(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Ra(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Ha(t,e,r){let n;Y(t,re,l=>r(3,n=l));let o=[["Separated tracks",R.cycle_paths.track],["Unprotected lanes",R.cycle_paths.lane],["Shared-use (segregated)",R.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",R.cycle_paths.shared_use_unsegregated]];$e(n,qe,`https://atip.uk/layers/v1/${qe}.pmtiles`),Le(n,{id:qe,source:qe,sourceLayer:qe,color:Xr(["get","kind"],{track:R.cycle_paths.track,lane:R.cycle_paths.lane,shared_use_segregated:R.cycle_paths.shared_use_segregated,shared_use_unsegregated:R.cycle_paths.shared_use_unsegregated},"red"),width:bn,opacity:we(.5,1)});let s=!1;function a(l){s=l,r(0,s)}return[s,o,a]}class Wa extends V{constructor(e){super(),G(this,e,Ha,ja,K,{})}}function za(t){let e,r,n,o;return e=new me({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=T(),n=v(t[1])},m(s,a){w(e,s,a),m(s,r,a),m(s,n,a),o=!0},p(s,a){(!o||a&2)&&Ce(n,s[1])},i(s){o||(g(e.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function Va(t){let e;const r=t[6].default,n=Fn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&Bn(n,r,o,o[8],e?Un(r,o[8],s,null):jn(o[8]),null)},i(o){e||(g(n,o),e=!0)},o(o){d(n,o),e=!1},d(o){n&&n.d(o)}}}function Ga(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Va]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ka(t){let e,r,n,o,s;function a(i){t[7](i)}let l={id:t[0],$$slots:{right:[Ga],default:[za]},$$scope:{ctx:t}};return t[2]!==void 0&&(l.checked=t[2]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&1&&(u.id=i[0]),f&258&&(u.$$scope={dirty:f,ctx:i}),!r&&f&4&&(r=!0,u.checked=i[2],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.layer=i[0]),f&4&&(c.show=i[2]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function qa(t,e,r){let n;Y(t,re,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:a}=e,{singularNoun:l}=e,{pluralNoun:i}=e,f=R[a];$e(n,a,`https://atip.uk/layers/v1/${a}.pmtiles`),ze(n,{id:a,source:a,sourceLayer:a,color:f,opacity:we(1,.7)});let u=!1;function c($){return`<p>${$.properties.name??`Unnamed ${l}`}</p>`}function p($){u=$,r(2,u)}return t.$$set=$=>{"name"in $&&r(0,a=$.name),"singularNoun"in $&&r(5,l=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[a,i,u,f,c,l,o,p,s]}class nr extends V{constructor(e){super(),G(this,e,qa,Ka,K,{name:0,singularNoun:5,pluralNoun:1})}}function Za(t){let e;return{c(){e=v("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xa(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ya(t){let e,r,n,o,s,a,l,i,f;return n=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[Za]},$$scope:{ctx:t}}}),i=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Xa]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("This shows "),_(n.$$.fragment),o=v(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment)},m(u,c){m(u,e,c),O(e,r),w(n,e,null),O(e,o),m(u,s,c),m(u,a,c),O(a,l),w(i,a,null),f=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:u}),i.$set($)},i(u){f||(g(n.$$.fragment,u),g(i.$$.fragment,u),f=!0)},o(u){d(n.$$.fragment,u),d(i.$$.fragment,u),f=!1},d(u){u&&(h(e),h(s),h(a)),b(n),b(i)}}}function Ja(t){let e,r;return e=new nr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Ya]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Qa extends V{constructor(e){super(),G(this,e,null,Ja,K,{})}}function el(t){let e;return{c(){e=v("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tl(t){let e;return{c(){e=v(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rl(t){let e;return{c(){e=v(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function nl(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ol(t){let e,r,n,o,s,a,l,i,f,u,c,p;return n=new j({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[tl]},$$scope:{ctx:t}}}),s=new j({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[rl]},$$scope:{ctx:t}}}),u=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[nl]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("The 2019 English IMD scores come from "),_(n.$$.fragment),o=v(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),a=v("."),l=T(),i=E("p"),f=v("License: "),_(u.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),O(e,r),w(n,e,null),O(e,o),w(s,e,null),O(e,a),m($,l,y),m($,i,y),O(i,f),w(u,i,null),O(i,c),p=!0},p($,y){const k={};y&64&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&64&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&64&&(L.$$scope={dirty:y,ctx:$}),u.$set(L)},i($){p||(g(n.$$.fragment,$),g(s.$$.fragment,$),g(u.$$.fragment,$),p=!0)},o($){d(n.$$.fragment,$),d(s.$$.fragment,$),d(u.$$.fragment,$),p=!1},d($){$&&(h(e),h(l),h(i)),b(n),b(s),b(u)}}}function sl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[ol]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function jr(t){let e,r;return e=new pt({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:ee,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function il(t){let e,r,n,o,s,a;function l(u){t[3](u)}let i={id:Oe,$$slots:{right:[sl],default:[el]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),W.push(()=>q(e,"checked",l));let f=t[0]&&jr(t);return s=new Q({props:{layer:Oe,tooltip:al,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=T(),f&&f.c(),o=T(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),f&&f.m(u,c),m(u,o,c),w(s,u,c),a=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],Z(()=>r=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&g(f,1)):(f=jr(u),f.c(),g(f,1),f.m(o.parentNode,o)):f&&(de(),d(f,1,1,()=>{f=null}),_e());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){a||(g(e.$$.fragment,u),g(f),g(s.$$.fragment,u),a=!0)},o(u){d(e.$$.fragment,u),d(f),d(s.$$.fragment,u),a=!1},d(u){u&&(h(n),h(o)),b(e,u),f&&f.d(u),b(s,u)}}}let Oe="imd";function al(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function ll(t,e,r){let n;Y(t,re,f=>r(2,n=f));let o=`${Oe}-outline`,s=R.sequential_low_to_high,a=[0,2,4,6,8,10];$e(n,Oe,`https://atip.uk/layers/v1/${Oe}.pmtiles`),ze(n,{id:Oe,source:Oe,sourceLayer:Oe,color:wt(["-",10,["get","decile"]],a,s),opacity:we(.5,.7)}),Le(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});let l=!1;function i(f){l=f,r(0,l)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",l?"visible":"none")},[l,s,n,i]}class ul extends V{constructor(e){super(),G(this,e,ll,il,K,{})}}function fl(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function cl(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function pl(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function $l(t){let e,r,n,o,s,a,l,i,f,u;return n=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[cl]},$$scope:{ctx:t}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[pl]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),O(e,r),w(n,e,null),O(e,o),m(c,s,p),m(c,a,p),O(a,l),w(i,a,null),O(a,f),u=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){u||(g(n.$$.fragment,c),g(i.$$.fragment,c),u=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),u=!1},d(c){c&&(h(e),h(s),h(a)),b(n),b(i)}}}function ml(t){let e,r,n;return r=new ne({props:{$$slots:{default:[$l]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function hl(t){let e,r,n,o,s;function a(i){t[3](i)}let l={id:He,$$slots:{right:[ml],default:[fl]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:He,tooltip:gl,show:t[0],clickable:!0}}),o.$on("click",dl),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let He="local_authority_districts";function gl(t){return`<p>${t.properties.name}</p>`}function dl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function _l(t,e,r){let n;Y(t,re,i=>r(2,n=i));let o=R.local_authority_districts,s=`${He}-outline`;er(n,He,`https://atip.uk/layers/v1/${He}.geojson`),ze(n,{id:He,source:He,color:o,opacity:we(.5,0)}),Le(n,{id:s,source:He,color:o,width:2.5});let a=!1;function l(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,l]}class wl extends V{constructor(e){super(),G(this,e,_l,hl,K,{})}}function bl(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function vl(t){let e;return{c(){e=v(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yl(t){let e;return{c(){e=v(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function kl(t){let e;return{c(){e=v(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Sl(t){let e;return{c(){e=v("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Cl(t){let e;return{c(){e=v(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ll(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Tl(t){let e,r,n,o,s,a,l,i,f,u,c,p,$,y,k,S,L,D,M,C,A,F,x,P,I;return n=new j({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[vl]},$$scope:{ctx:t}}}),s=new j({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[yl]},$$scope:{ctx:t}}}),l=new j({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[kl]},$$scope:{ctx:t}}}),$=new j({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Sl]},$$scope:{ctx:t}}}),D=new j({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Cl]},$$scope:{ctx:t}}}),x=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ll]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("LPAs may be a "),_(n.$$.fragment),o=v(", "),_(s.$$.fragment),a=v("y, or "),_(l.$$.fragment),i=v("."),f=T(),u=E("p"),c=E("strong"),p=v(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),y=v(" to get more details."),k=T(),S=E("p"),L=v("Data from ONS Geography via "),_(D.$$.fragment),M=v(", as of November 2022."),C=T(),A=E("p"),F=v("License: "),_(x.$$.fragment),P=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(N,B){m(N,e,B),O(e,r),w(n,e,null),O(e,o),w(s,e,null),O(e,a),w(l,e,null),O(e,i),m(N,f,B),m(N,u,B),O(u,c),O(c,p),w($,c,null),O(c,y),m(N,k,B),m(N,S,B),O(S,L),w(D,S,null),O(S,M),m(N,C,B),m(N,A,B),O(A,F),w(x,A,null),O(A,P),I=!0},p(N,B){const J={};B&32&&(J.$$scope={dirty:B,ctx:N}),n.$set(J);const U={};B&32&&(U.$$scope={dirty:B,ctx:N}),s.$set(U);const ae={};B&32&&(ae.$$scope={dirty:B,ctx:N}),l.$set(ae);const he={};B&32&&(he.$$scope={dirty:B,ctx:N}),$.$set(he);const oe={};B&32&&(oe.$$scope={dirty:B,ctx:N}),D.$set(oe);const Ve={};B&32&&(Ve.$$scope={dirty:B,ctx:N}),x.$set(Ve)},i(N){I||(g(n.$$.fragment,N),g(s.$$.fragment,N),g(l.$$.fragment,N),g($.$$.fragment,N),g(D.$$.fragment,N),g(x.$$.fragment,N),I=!0)},o(N){d(n.$$.fragment,N),d(s.$$.fragment,N),d(l.$$.fragment,N),d($.$$.fragment,N),d(D.$$.fragment,N),d(x.$$.fragment,N),I=!1},d(N){N&&(h(e),h(f),h(u),h(k),h(S),h(C),h(A)),b(n),b(s),b(l),b($),b(D),b(x)}}}function Ol(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Tl]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Al(t){let e,r,n,o,s;function a(i){t[3](i)}let l={id:Ae,$$slots:{right:[Ol],default:[bl]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Ae,tooltip:Dl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ae="local_planning_authorities";function Dl(t){return`<p>${t.properties.name}</p>`}function El(t,e,r){let n;Y(t,re,i=>r(2,n=i));let o=R.local_planning_authorities,s=`${Ae}-outline`;$e(n,Ae,`https://atip.uk/layers/v1/${Ae}.pmtiles`),ze(n,{id:Ae,source:Ae,sourceLayer:Ae,color:o,opacity:we(.5,0)}),Le(n,{id:s,source:Ae,sourceLayer:Ae,color:o,width:2.5});let a=!1;function l(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,l]}class Pl extends V{constructor(e){super(),G(this,e,El,Al,K,{})}}function Il(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Nl(t){let e;return{c(){e=v(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function xl(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ml(t){let e,r,n,o,s,a,l,i,f;return n=new j({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Nl]},$$scope:{ctx:t}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[xl]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Data from the "),_(n.$$.fragment),o=v(", as of September 2021."),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment)},m(u,c){m(u,e,c),O(e,r),w(n,e,null),O(e,o),m(u,s,c),m(u,a,c),O(a,l),w(i,a,null),f=!0},p(u,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:u}),i.$set($)},i(u){f||(g(n.$$.fragment,u),g(i.$$.fragment,u),f=!0)},o(u){d(n.$$.fragment,u),d(i.$$.fragment,u),f=!1},d(u){u&&(h(e),h(s),h(a)),b(n),b(i)}}}function Fl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ml]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Bl(t){let e,r,n,o,s;function a(i){t[2](i)}let l={id:Ze,$$slots:{right:[Fl],default:[Il]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Ze,tooltip:jl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&16&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ze="mrn";function jl(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Ul(t,e,r){let n;Y(t,re,l=>r(3,n=l));let o=R.mrn;$e(n,Ze,`https://atip.uk/layers/v1/${Ze}.pmtiles`),Le(n,{id:Ze,source:Ze,sourceLayer:Ze,color:o,width:7,opacity:we(.5,1)});let s=!1;function a(l){s=l,r(0,s)}return[s,o,a]}class Rl extends V{constructor(e){super(),G(this,e,Ul,Bl,K,{})}}function Hl(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Wl(t){let e;return{c(){e=v(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zl(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vl(t){let e,r,n,o,s,a,l,i,f;return n=new j({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Wl]},$$scope:{ctx:t}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[zl]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment)},m(u,c){m(u,e,c),O(e,r),w(n,e,null),O(e,o),m(u,s,c),m(u,a,c),O(a,l),w(i,a,null),f=!0},p(u,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:u}),i.$set($)},i(u){f||(g(n.$$.fragment,u),g(i.$$.fragment,u),f=!0)},o(u){d(n.$$.fragment,u),d(i.$$.fragment,u),f=!1},d(u){u&&(h(e),h(s),h(a)),b(n),b(i)}}}function Gl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Vl]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kl(t){let e,r,n,o,s;function a(i){t[3](i)}let l={id:De,$$slots:{right:[Gl],default:[Hl]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:De,tooltip:ql,show:t[0],clickable:!0}}),o.$on("click",Zl),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="parliamentary_constituencies";function ql(t){return`<p>${t.properties.Name}</p>`}function Zl(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function Xl(t,e,r){let n;Y(t,re,i=>r(2,n=i));let o=R.parliamentary_constituencies,s=`${De}-outline`;$e(n,De,`https://atip.uk/layers/v1/${De}.pmtiles`),ze(n,{id:De,source:De,sourceLayer:De,color:o,opacity:we(.5,0)}),Le(n,{id:s,source:De,sourceLayer:De,color:o,width:5});let a=!1;function l(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,l]}class Yl extends V{constructor(e){super(),G(this,e,Xl,Kl,K,{})}}function Jl(t){let e;return{c(){e=v("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ql(t){let e;return{c(){e=v("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function eu(t){let e;return{c(){e=v("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tu(t){let e,r,n,o,s,a,l,i,f,u,c;return l=new j({props:{href:"https://www.pct.bike",$$slots:{default:[Ql]},$$scope:{ctx:t}}}),f=new j({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[eu]},$$scope:{ctx:t}}}),{c(){e=E("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=T(),n=E("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=T(),s=E("p"),a=v("See "),_(l.$$.fragment),i=v(" and "),_(f.$$.fragment),u=v(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),O(s,a),w(l,s,null),O(s,i),w(f,s,null),O(s,u),c=!0},p(p,$){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),l.$set(y);const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),f.$set(k)},i(p){c||(g(l.$$.fragment,p),g(f.$$.fragment,p),c=!0)},o(p){d(l.$$.fragment,p),d(f.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(l),b(f)}}}function ru(t){let e,r,n;return r=new ne({props:{$$slots:{default:[tu]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&2048&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ur(t){let e,r,n,o,s,a,l,i;e=new pt({props:{colorScale:t[3],limits:t[4]}});function f($){t[8]($)}let u={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(u.value=t[0]),n=new Rn({props:u}),W.push(()=>q(n,"value",f)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),a=new Dt({props:p}),W.push(()=>q(a,"value",c)),a.$on("change",t[6]),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),s=T(),_(a.$$.fragment)},m($,y){w(e,$,y),m($,r,y),w(n,$,y),m($,s,y),w(a,$,y),i=!0},p($,y){const k={};!o&&y&1&&(o=!0,k.value=$[0],Z(()=>o=!1)),n.$set(k);const S={};!l&&y&2&&(l=!0,S.value=$[1],Z(()=>l=!1)),a.$set(S)},i($){i||(g(e.$$.fragment,$),g(n.$$.fragment,$),g(a.$$.fragment,$),i=!0)},o($){d(e.$$.fragment,$),d(n.$$.fragment,$),d(a.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(a,$)}}}function nu(t){let e,r,n,o,s,a,l,i;function f(p){t[7](p)}let u={id:Qe,$$slots:{right:[ru],default:[Jl]},$$scope:{ctx:t}};t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),W.push(()=>q(e,"checked",f));let c=t[2]&&Ur(t);return s=new Q({props:{layer:Qe,tooltip:t[5],show:t[2]&&t[0]==Qe,clickable:!1}}),l=new Q({props:{layer:Ot,tooltip:t[5],show:t[2]&&t[0]==Ot,clickable:!1}}),{c(){_(e.$$.fragment),n=T(),c&&c.c(),o=T(),_(s.$$.fragment),a=T(),_(l.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,a,$),w(l,p,$),i=!0},p(p,[$]){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,y.checked=p[2],Z(()=>r=!1)),e.$set(y),p[2]?c?(c.p(p,$),$&4&&g(c,1)):(c=Ur(p),c.c(),g(c,1),c.m(o.parentNode,o)):c&&(de(),d(c,1,1,()=>{c=null}),_e());const k={};$&5&&(k.show=p[2]&&p[0]==Qe),s.$set(k);const S={};$&5&&(S.show=p[2]&&p[0]==Ot),l.$set(S)},i(p){i||(g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(l.$$.fragment,p),i=!0)},o(p){d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(l.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(a)),b(e,p),c&&c.d(p),b(s,p),b(l,p)}}}let Qe="pct_commute",Ot="pct_school";function ou(t,e,r){let n;Y(t,re,y=>r(10,n=y));let o=R.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],a=Qe,l="baseline";for(let y of[Qe,Ot])$e(n,y,`https://atip.uk/layers/v1/${y}.pmtiles`),Le(n,{id:y,source:y,sourceLayer:y,color:wt(["get",l],s,o),width:bn,opacity:we(.5,1)});let i=!1;function f(y){let k=y.properties.baseline,S=y.properties.gov_target,L=y.properties.go_dutch,D=`<h2>Trip purpose: ${a==Qe?"commuting":"school"}</h2>`;if(D+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)D+=`<p>Government target (2025): <b>${S.toLocaleString()}</b></p>`,D+=`<p>Go Dutch: <b>${L.toLocaleString()}</b></p>`;else{let M=(S/k).toFixed(1),C=(L/k).toFixed(1);D+=`<p>Government target (2025): ${S.toLocaleString()} (<b>${M}x</b> of baseline)</p>`,D+=`<p>Go Dutch: ${L.toLocaleString()} (<b>${C}x</b> of baseline)</p>`}return D}function u(){n.setPaintProperty(a,"line-color",wt(["get",l],s,o))}function c(y){i=y,r(2,i)}function p(y){a=y,r(0,a)}function $(y){l=y,r(1,l)}return[a,l,i,o,s,f,u,c,p,$]}class su extends V{constructor(e){super(),G(this,e,ou,nu,K,{})}}function iu(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function au(t){let e;return{c(){e=v("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function lu(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function uu(t){let e,r,n,o,s,a,l,i,f;return n=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[au]},$$scope:{ctx:t}}}),i=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[lu]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment)},m(u,c){m(u,e,c),O(e,r),w(n,e,null),O(e,o),m(u,s,c),m(u,a,c),O(a,l),w(i,a,null),f=!0},p(u,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:u}),i.$set($)},i(u){f||(g(n.$$.fragment,u),g(i.$$.fragment,u),f=!0)},o(u){d(n.$$.fragment,u),d(i.$$.fragment,u),f=!1},d(u){u&&(h(e),h(s),h(a)),b(n),b(i)}}}function fu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[uu]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function cu(t){let e,r,n,o,s;function a(i){t[2](i)}let l={id:Xe,$$slots:{right:[fu],default:[iu]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Xe,tooltip:pu,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Xe="railway_stations";function pu(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function $u(t,e,r){let n;Y(t,re,i=>r(3,n=i));const o=`https://atip.uk/layers/v1/${Xe}.geojson`;let s=!1;er(n,Xe,o);let a=R[Xe];ct(n,{id:Xe,source:Xe,color:a,radius:Xn/2});function l(i){s=i,r(0,s)}return[s,a,l]}class mu extends V{constructor(e){super(),G(this,e,$u,cu,K,{})}}function hu(t){let e;return{c(){e=v("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function gu(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function du(t){let e,r,n,o,s,a,l,i,f;return n=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[hu]},$$scope:{ctx:t}}}),i=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[gu]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("This shows "),_(n.$$.fragment),o=v(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment)},m(u,c){m(u,e,c),O(e,r),w(n,e,null),O(e,o),m(u,s,c),m(u,a,c),O(a,l),w(i,a,null),f=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:u}),i.$set($)},i(u){f||(g(n.$$.fragment,u),g(i.$$.fragment,u),f=!0)},o(u){d(n.$$.fragment,u),d(i.$$.fragment,u),f=!1},d(u){u&&(h(e),h(s),h(a)),b(n),b(i)}}}function _u(t){let e,r;return e=new nr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[du]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class wu extends V{constructor(e){super(),G(this,e,null,_u,K,{})}}function bu(t){let e;return{c(){e=v("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function vu(t){let e;return{c(){e=v("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yu(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ku(t){let e,r,n,o,s,a,l,i,f,u,c;return n=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[bu]},$$scope:{ctx:t}}}),s=new j({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[vu]},$$scope:{ctx:t}}}),u=new j({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[yu]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("This shows "),_(n.$$.fragment),o=v(" and "),_(s.$$.fragment),a=v(" data from OpenStreetMap (as of 9 August 2023)."),l=T(),i=E("p"),f=v("License: "),_(u.$$.fragment)},m(p,$){m(p,e,$),O(e,r),w(n,e,null),O(e,o),w(s,e,null),O(e,a),m(p,l,$),m(p,i,$),O(i,f),w(u,i,null),c=!0},p(p,$){const y={};$&1&&(y.$$scope={dirty:$,ctx:p}),n.$set(y);const k={};$&1&&(k.$$scope={dirty:$,ctx:p}),s.$set(k);const S={};$&1&&(S.$$scope={dirty:$,ctx:p}),u.$set(S)},i(p){c||(g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),c=!0)},o(p){d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),c=!1},d(p){p&&(h(e),h(l),h(i)),b(n),b(s),b(u)}}}function Su(t){let e,r;return e=new nr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[ku]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Cu extends V{constructor(e){super(),G(this,e,null,Su,K,{})}}function Lu(t){let e;return{c(){e=v("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Tu(t){let e;return{c(){e=v(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ou(t){let e;return{c(){e=v("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Au(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Du(t){let e,r,n,o,s,a,l,i,f,u,c,p,$;return n=new j({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[Tu]},$$scope:{ctx:t}}}),s=new j({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[Ou]},$$scope:{ctx:t}}}),p=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Au]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=v(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),a=v(" for details and caveats about the measurements."),l=T(),i=E("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=T(),u=E("p"),c=v("License: "),_(p.$$.fragment)},m(y,k){m(y,e,k),O(e,r),w(n,e,null),O(e,o),w(s,e,null),O(e,a),m(y,l,k),m(y,i,k),m(y,f,k),m(y,u,k),O(u,c),w(p,u,null),$=!0},p(y,k){const S={};k&64&&(S.$$scope={dirty:k,ctx:y}),n.$set(S);const L={};k&64&&(L.$$scope={dirty:k,ctx:y}),s.$set(L);const D={};k&64&&(D.$$scope={dirty:k,ctx:y}),p.$set(D)},i(y){$||(g(n.$$.fragment,y),g(s.$$.fragment,y),g(p.$$.fragment,y),$=!0)},o(y){d(n.$$.fragment,y),d(s.$$.fragment,y),d(p.$$.fragment,y),$=!1},d(y){y&&(h(e),h(l),h(i),h(f),h(u)),b(n),b(s),b(p)}}}function Eu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Du]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Rr(t){let e,r;return e=new pt({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:ee,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Pu(t){let e,r,n,o,s,a;function l(u){t[3](u)}let i={id:Ye,$$slots:{right:[Eu],default:[Lu]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),W.push(()=>q(e,"checked",l));let f=t[0]&&Rr(t);return s=new Q({props:{layer:Ye,tooltip:Iu,show:t[0],clickable:!0}}),s.$on("click",Nu),{c(){_(e.$$.fragment),n=T(),f&&f.c(),o=T(),_(s.$$.fragment)},m(u,c){w(e,u,c),m(u,n,c),f&&f.m(u,c),m(u,o,c),w(s,u,c),a=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],Z(()=>r=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&g(f,1)):(f=Rr(u),f.c(),g(f,1),f.m(o.parentNode,o)):f&&(de(),d(f,1,1,()=>{f=null}),_e());const $={};c&1&&($.show=u[0]),s.$set($)},i(u){a||(g(e.$$.fragment,u),g(f),g(s.$$.fragment,u),a=!0)},o(u){d(e.$$.fragment,u),d(f),d(s.$$.fragment,u),a=!1},d(u){u&&(h(n),h(o)),b(e,u),f&&f.d(u),b(s,u)}}}let Ye="vehicle_counts";function Iu(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function Nu(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function xu(t,e,r){let n;Y(t,re,f=>r(4,n=f));let o=R.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],a=["","40k","80k","120k","160k",""];$e(n,Ye,`https://atip.uk/layers/v1/${Ye}.pmtiles`),ct(n,{id:Ye,source:Ye,sourceLayer:Ye,color:wt(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let l=!1;function i(f){l=f,r(0,l)}return[l,o,a,i]}class Mu extends V{constructor(e){super(),G(this,e,xu,Pu,K,{})}}function Fu(t){let e,r,n;return e=new me({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:ee,i(o){n||(g(e.$$.fragment,o),n=!0)},o(o){d(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Bu(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ju(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Uu(t){let e,r,n,o,s,a,l,i,f,u;return n=new j({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[Bu]},$$scope:{ctx:t}}}),i=new j({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ju]},$$scope:{ctx:t}}}),{c(){e=E("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=T(),a=E("p"),l=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),O(e,r),w(n,e,null),O(e,o),m(c,s,p),m(c,a,p),O(a,l),w(i,a,null),O(a,f),u=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){u||(g(n.$$.fragment,c),g(i.$$.fragment,c),u=!0)},o(c){d(n.$$.fragment,c),d(i.$$.fragment,c),u=!1},d(c){c&&(h(e),h(s),h(a)),b(n),b(i)}}}function Ru(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Uu]},$$scope:{ctx:t}}}),{c(){e=E("span"),_(r.$$.fragment),z(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(g(r.$$.fragment,o),n=!0)},o(o){d(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Hu(t){let e,r,n,o,s;function a(i){t[3](i)}let l={id:Ee,$$slots:{right:[Ru],default:[Fu]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.checked=t[0]),e=new te({props:l}),W.push(()=>q(e,"checked",a)),o=new Q({props:{layer:Ee,tooltip:Wu,show:t[0],clickable:!0}}),o.$on("click",zu),{c(){_(e.$$.fragment),n=T(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,u.checked=i[0],Z(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(g(e.$$.fragment,i),g(o.$$.fragment,i),s=!0)},o(i){d(e.$$.fragment,i),d(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="wards";function Wu(t){return`<p>${t.properties.name}</p>`}function zu(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Vu(t,e,r){let n;Y(t,re,i=>r(2,n=i));let o=R.wards,s=`${Ee}-outline`;$e(n,Ee,`https://atip.uk/layers/v1/${Ee}.pmtiles`),ze(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:we(.5,0)}),Le(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:2.5});let a=!1;function l(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,l]}class Gu extends V{constructor(e){super(),G(this,e,Vu,Hu,K,{})}}function Ku(t){let e,r,n,o,s,a,l,i;return e=new wu({}),n=new Qa({}),s=new Cu({}),l=new mu({}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),o=T(),_(s.$$.fragment),a=T(),_(l.$$.fragment)},m(f,u){w(e,f,u),m(f,r,u),w(n,f,u),m(f,o,u),w(s,f,u),m(f,a,u),w(l,f,u),i=!0},i(f){i||(g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),g(l.$$.fragment,f),i=!0)},o(f){d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),d(l.$$.fragment,f),i=!1},d(f){f&&(h(r),h(o),h(a)),b(e,f),b(n,f),b(s,f),b(l,f)}}}function qu(t){let e,r;return e=new yt({props:{small:!0,$$slots:{default:[Ku]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Zu(t){let e,r,n,o,s,a,l,i,f,u;return e=new Wa({}),n=new Rl({}),s=new Oi({}),l=new Na({}),f=new Ca({}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),o=T(),_(s.$$.fragment),a=T(),_(l.$$.fragment),i=T(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,a,p),w(l,c,p),m(c,i,p),w(f,c,p),u=!0},i(c){u||(g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(l.$$.fragment,c),g(f.$$.fragment,c),u=!0)},o(c){d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(l.$$.fragment,c),d(f.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(a),h(i)),b(e,c),b(n,c),b(s,c),b(l,c),b(f,c)}}}function Xu(t){let e,r;return e=new yt({props:{small:!0,$$slots:{default:[Zu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Yu(t){let e,r,n,o,s,a,l,i,f,u;return e=new Yl({}),n=new Gu({}),s=new la({}),l=new wl({}),f=new Pl({}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),o=T(),_(s.$$.fragment),a=T(),_(l.$$.fragment),i=T(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,a,p),w(l,c,p),m(c,i,p),w(f,c,p),u=!0},i(c){u||(g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(l.$$.fragment,c),g(f.$$.fragment,c),u=!0)},o(c){d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(l.$$.fragment,c),d(f.$$.fragment,c),u=!1},d(c){c&&(h(r),h(o),h(a),h(i)),b(e,c),b(n,c),b(s,c),b(l,c),b(f,c)}}}function Ju(t){let e,r;return e=new yt({props:{small:!0,$$slots:{default:[Yu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Qu(t){let e,r,n,o;return e=new Ji({}),n=new ul({}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function ef(t){let e,r,n,o;return e=new Mu({}),n=new su({}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},i(s){o||(g(e.$$.fragment,s),g(n.$$.fragment,s),o=!0)},o(s){d(e.$$.fragment,s),d(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function tf(t){let e,r,n,o,s,a,l,i,f,u,c,p,$,y,k,S,L;e=new ga({}),n=new Me({props:{label:"Trip generators",$$slots:{default:[qu]},$$scope:{ctx:t}}}),s=new Me({props:{label:"Existing infrastructure",$$slots:{default:[Xu]},$$scope:{ctx:t}}}),l=new Me({props:{label:"Boundaries",$$slots:{default:[Ju]},$$scope:{ctx:t}}}),f=new Me({props:{label:"Census",$$slots:{default:[Qu]},$$scope:{ctx:t}}}),c=new Me({props:{label:"Other",$$slots:{default:[ef]},$$scope:{ctx:t}}});function D(C){t[5](C)}let M={displayEnableButton:!0};return t[2]!==void 0&&(M.isInactive=t[2]),$=new Yn({props:M}),t[4]($),W.push(()=>q($,"isInactive",D)),S=new Kn({props:{style:t[0]}}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),o=T(),_(s.$$.fragment),a=T(),_(l.$$.fragment),i=T(),_(f.$$.fragment),u=T(),_(c.$$.fragment),p=T(),_($.$$.fragment),k=T(),_(S.$$.fragment)},m(C,A){w(e,C,A),m(C,r,A),w(n,C,A),m(C,o,A),w(s,C,A),m(C,a,A),w(l,C,A),m(C,i,A),w(f,C,A),m(C,u,A),w(c,C,A),m(C,p,A),w($,C,A),m(C,k,A),w(S,C,A),L=!0},p(C,A){const F={};A&64&&(F.$$scope={dirty:A,ctx:C}),n.$set(F);const x={};A&64&&(x.$$scope={dirty:A,ctx:C}),s.$set(x);const P={};A&64&&(P.$$scope={dirty:A,ctx:C}),l.$set(P);const I={};A&64&&(I.$$scope={dirty:A,ctx:C}),f.$set(I);const N={};A&64&&(N.$$scope={dirty:A,ctx:C}),c.$set(N);const B={};!y&&A&4&&(y=!0,B.isInactive=C[2],Z(()=>y=!1)),$.$set(B);const J={};A&1&&(J.style=C[0]),S.$set(J)},i(C){L||(g(e.$$.fragment,C),g(n.$$.fragment,C),g(s.$$.fragment,C),g(l.$$.fragment,C),g(f.$$.fragment,C),g(c.$$.fragment,C),g($.$$.fragment,C),g(S.$$.fragment,C),L=!0)},o(C){d(e.$$.fragment,C),d(n.$$.fragment,C),d(s.$$.fragment,C),d(l.$$.fragment,C),d(f.$$.fragment,C),d(c.$$.fragment,C),d($.$$.fragment,C),d(S.$$.fragment,C),L=!1},d(C){C&&(h(r),h(o),h(a),h(i),h(u),h(p),h(k)),b(e,C),b(n,C),b(s,C),b(l,C),b(f,C),b(c,C),t[4](null),b($,C),b(S,C)}}}function rf(t){let e,r,n,o;return e=new Me({props:{label:"Layers",open:!0,$$slots:{default:[tf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,a){w(e,s,a),r=!0,n||(o=Qt(window,"keydown",t[3]),n=!0)},p(s,[a]){const l={};a&71&&(l.$$scope={dirty:a,ctx:s}),e.$set(l)},i(s){r||(g(e.$$.fragment,s),r=!0)},o(s){d(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function nf(t,e,r){let n;Y(t,ur,f=>r(2,n=f));let{style:o}=e,s;function a(f){!n&&f.key=="Escape"&&(s.disableStreetView(),f.preventDefault())}function l(f){W[f?"unshift":"push"](()=>{s=f,r(1,s)})}function i(f){n=f,ur.set(n)}return t.$$set=f=>{"style"in f&&r(0,o=f.style)},[o,s,n,a,l,i]}class of extends V{constructor(e){super(),G(this,e,nf,rf,K,{style:0})}}function sf(t,e,r){let{loadFile:n}=e;return It(async()=>{let s=await(await fetch("https://atip.uk/random_schemes.geojson")).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class af extends V{constructor(e){super(),G(this,e,sf,null,K,{loadFile:0})}}function lf(t){let e;return{c(){e=v("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function uf(t){let e;return{c(){e=v("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ff(t){let e,r,n=t[0].authority_or_region+"",o,s,a,l,i=t[0].capital_scheme_id+"",f,u,c,p,$=t[0].funding_programme+"",y,k,S,L,D,M,C;return L=new Wt({props:{$$slots:{default:[lf]},$$scope:{ctx:t}}}),L.$on("click",t[3]),M=new Wt({props:{disabled:t[1],title:t[2],$$slots:{default:[uf]},$$scope:{ctx:t}}}),M.$on("click",t[4]),{c(){e=E("p"),r=v("Authority or region: "),o=v(n),s=T(),a=E("p"),l=v("Capital scheme ID: "),f=v(i),u=T(),c=E("p"),p=v("Funding programme: "),y=v($),k=T(),S=E("div"),_(L.$$.fragment),D=T(),_(M.$$.fragment),z(S,"class","govuk-button-group")},m(A,F){m(A,e,F),O(e,r),O(e,o),m(A,s,F),m(A,a,F),O(a,l),O(a,f),m(A,u,F),m(A,c,F),O(c,p),O(c,y),m(A,k,F),m(A,S,F),w(L,S,null),O(S,D),w(M,S,null),C=!0},p(A,F){(!C||F&1)&&n!==(n=A[0].authority_or_region+"")&&Ce(o,n),(!C||F&1)&&i!==(i=A[0].capital_scheme_id+"")&&Ce(f,i),(!C||F&1)&&$!==($=A[0].funding_programme+"")&&Ce(y,$);const x={};F&256&&(x.$$scope={dirty:F,ctx:A}),L.$set(x);const P={};F&256&&(P.$$scope={dirty:F,ctx:A}),M.$set(P)},i(A){C||(g(L.$$.fragment,A),g(M.$$.fragment,A),C=!0)},o(A){d(L.$$.fragment,A),d(M.$$.fragment,A),C=!1},d(A){A&&(h(e),h(s),h(a),h(u),h(c),h(k),h(S)),b(L),b(M)}}}function cf(t){let e,r;return e=new Me({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[ff]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function pf(t,e,r){let n,o;Y(t,ft,c=>r(6,n=c)),Y(t,re,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:a}=e,l=!a.has(s.authority_or_region),i=l?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(Hn(c),{padding:20,animate:!1})}function u(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,a=c.authorityNames)},[s,l,i,f,u,a]}class $f extends V{constructor(e){super(),G(this,e,pf,cf,K,{scheme:0,authorityNames:5})}}const mf=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ie=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{l(r.next(i))}catch(f){o(f)}},a=i=>{try{l(r.throw(i))}catch(f){o(f)}},l=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,a);l((r=r.apply(t,e)).next())}),pe=Uint8Array,lt=Uint16Array,hf=Int32Array,vn=new pe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yn=new pe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gf=new pe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kn=function(t,e){for(var r=new lt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new hf(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},Sn=kn(vn,2),Cn=Sn.b,df=Sn.r;Cn[28]=258,df[258]=28;var _f=kn(yn,0),wf=_f.b,Yt=new lt(32768);for(H=0;H<32768;++H)xe=(H&43690)>>1|(H&21845)<<1,xe=(xe&52428)>>2|(xe&13107)<<2,xe=(xe&61680)>>4|(xe&3855)<<4,Yt[H]=((xe&65280)>>8|(xe&255)<<8)>>1;var xe,H,_t=function(t,e,r){for(var n=t.length,o=0,s=new lt(e);o<n;++o)t[o]&&++s[t[o]-1];var a=new lt(e);for(o=1;o<e;++o)a[o]=a[o-1]+s[o-1]<<1;var l;if(r){l=new lt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],u=e-t[o],c=a[t[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)l[Yt[c]>>i]=f}else for(l=new lt(n),o=0;o<n;++o)t[o]&&(l[o]=Yt[a[t[o]-1]++]>>15-t[o]);return l},Ct=new pe(288);for(H=0;H<144;++H)Ct[H]=8;var H;for(H=144;H<256;++H)Ct[H]=9;var H;for(H=256;H<280;++H)Ct[H]=7;var H;for(H=280;H<288;++H)Ct[H]=8;var H,Ln=new pe(32);for(H=0;H<32;++H)Ln[H]=5;var H,bf=_t(Ct,9,1),vf=_t(Ln,5,1),Rt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Ht=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},yf=function(t){return(t+7)/8|0},kf=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new pe(r-e);return n.set(t.subarray(e,r)),n},Sf=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ue=function(t,e,r){var n=new Error(e||Sf[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ue),!r)throw n;return n},or=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new pe(0);var a=!r||e.i!=2,l=e.i;r||(r=new pe(o*3));var i=function(sr){var ir=r.length;if(sr>ir){var ar=new pe(Math.max(ir*2,sr));ar.set(r),r=ar}},f=e.f||0,u=e.p||0,c=e.b||0,p=e.l,$=e.d,y=e.m,k=e.n,S=o*8;do{if(!p){f=ve(t,u,1);var L=ve(t,u+1,3);if(u+=3,L)if(L==1)p=bf,$=vf,y=9,k=5;else if(L==2){var A=ve(t,u,31)+257,F=ve(t,u+10,15)+4,x=A+ve(t,u+5,31)+1;u+=14;for(var P=new pe(x),I=new pe(19),N=0;N<F;++N)I[gf[N]]=ve(t,u+N*3,7);u+=F*3;for(var B=Rt(I),J=(1<<B)-1,U=_t(I,B,1),N=0;N<x;){var ae=U[ve(t,u,J)];u+=ae&15;var D=ae>>4;if(D<16)P[N++]=D;else{var he=0,oe=0;for(D==16?(oe=3+ve(t,u,3),u+=2,he=P[N-1]):D==17?(oe=3+ve(t,u,7),u+=3):D==18&&(oe=11+ve(t,u,127),u+=7);oe--;)P[N++]=he}}var Ve=P.subarray(0,A),le=P.subarray(A);y=Rt(Ve),k=Rt(le),p=_t(Ve,y,1),$=_t(le,k,1)}else ue(1);else{var D=yf(u)+4,M=t[D-4]|t[D-3]<<8,C=D+M;if(C>o){l&&ue(0);break}a&&i(c+M),r.set(t.subarray(D,C),c),e.b=c+=M,e.p=u=C*8,e.f=f;continue}if(u>S){l&&ue(0);break}}a&&i(c+131072);for(var $t=(1<<y)-1,Be=(1<<k)-1,tt=u;;tt=u){var he=p[Ht(t,u)&$t],ge=he>>4;if(u+=he&15,u>S){l&&ue(0);break}if(he||ue(2),ge<256)r[c++]=ge;else if(ge==256){tt=u,p=null;break}else{var rt=ge-254;if(ge>264){var N=ge-257,Ne=vn[N];rt=ve(t,u,(1<<Ne)-1)+Cn[N],u+=Ne}var nt=$[Ht(t,u)&Be],ot=nt>>4;nt||ue(3),u+=nt&15;var le=wf[ot];if(ot>3){var Ne=yn[ot];le+=Ht(t,u)&(1<<Ne)-1,u+=Ne}if(u>S){l&&ue(0);break}a&&i(c+131072);var st=c+rt;if(c<le){var mt=s-le,Nn=Math.min(le,st);for(mt+c<0&&ue(3);c<Nn;++c)r[c]=n[mt+c]}for(;c<st;c+=4)r[c]=r[c-le],r[c+1]=r[c+1-le],r[c+2]=r[c+2-le],r[c+3]=r[c+3-le];c=st}}e.l=p,e.p=tt,e.b=c,e.f=f,p&&(f=1,e.m=y,e.d=$,e.n=k)}while(!f);return c==r.length?r:kf(r,0,c)},Cf=new pe(0),Lf=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&ue(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},Tf=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Of=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ue(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&ue(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Af(t,e){return or(t,{i:2},e&&e.out,e&&e.dictionary)}function Df(t,e){var r=Lf(t);return r+8>t.length&&ue(6,"invalid gzip data"),or(t.subarray(r,-8),{i:2},e&&e.out||new pe(Tf(t)),e&&e.dictionary)}function Ef(t,e){return or(t.subarray(Of(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Jt(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Df(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Af(t,e):Ef(t,e)}var Pf=typeof TextDecoder<"u"&&new TextDecoder,If=0;try{Pf.decode(Cf,{stream:!0}),If=1}catch{}var Tn=(t,e)=>t*Math.pow(2,e),ht=(t,e)=>Math.floor(t/Math.pow(2,e)),Pt=(t,e)=>Tn(t.getUint16(e+1,!0),8)+t.getUint8(e),On=(t,e)=>Tn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),Nf=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=Pt(n,o+1);if(e!=s)return e-s;const a=Pt(n,o+4);return r!=a?r-a:0},xf=(t,e,r,n)=>{const o=An(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Hr=(t,e,r,n)=>{const o=An(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},An=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const a=s+o>>1,l=Nf(e,r,n,t,a*17);if(l>0)o=a+1;else if(l<0)s=a-1;else return[On(t,a*17+7),t.getUint32(a*17+13,!0)]}return null},Mf=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,Dn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:Pt(t,e*17+1),y:Pt(t,e*17+4),offset:On(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Wr=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(Dn(r,n));return Ff(e)},Ff=t=>{t.sort(Mf);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=ht(o.offset,8)&255,r[n*17+9]=ht(o.offset,16)&255,r[n*17+10]=ht(o.offset,24)&255,r[n*17+11]=ht(o.offset,32)&255,r[n*17+12]=ht(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},Bf=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=Dn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,a=Math.trunc(e.x/(1<<s)),l=Math.trunc(e.y/(1<<s));return{z:o,x:a,y:l}}return null};function jf(t){return ie(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),a=JSON.parse(s.decode(new DataView(e.data,10,n)));let l=0;a.compression==="gzip"&&(l=2);let i=0;"minzoom"in a&&(i=+a.minzoom);let f=0;"maxzoom"in a&&(f=+a.maxzoom);let u=0,c=0,p=0,$=-180,y=-85,k=180,S=85;if(a.bounds){const D=a.bounds.split(",");$=+D[0],y=+D[1],k=+D[2],S=+D[3]}if(a.center){const D=a.center.split(",");u=+D[0],c=+D[1],p=+D[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:l,tileType:1,minZoom:i,maxZoom:f,minLon:$,minLat:y,maxLon:k,maxLat:S,centerZoom:p,centerLon:u,centerLat:c,etag:e.etag}})}function Uf(t,e,r,n,o,s,a){return ie(this,null,function*(){let l=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(l=Wr(l));const i=Hr(new DataView(l),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,a)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=Jt(new Uint8Array(c))),{data:c}}const f=Bf(new DataView(l),{z:n,x:o,y:s});if(f){const u=xf(new DataView(l),f.z,f.x,f.y);if(u){let c=yield r.getArrayBuffer(e,u.offset,u.length,t);t.specVersion===1&&(c=Wr(c));const p=Hr(new DataView(c),n,o,s);if(p){let y=(yield e.getBytes(p.offset,p.length,a)).data;const k=new DataView(y);return k.getUint8(0)==31&&k.getUint8(1)==139&&(y=Jt(new Uint8Array(y))),{data:y}}}}})}var En={getHeader:jf,getZxy:Uf},Rf=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new zr(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new zr(o),this.tiles.set(o,s));const a=n[2],l=n[3],i=n[4],f=new AbortController,u=f.signal;let c=()=>{f.abort()};return s.getHeader().then(p=>{s.getZxy(+a,+l,+i,u).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function it(t,e){return(e>>>0)*4294967296+(t>>>0)}function Hf(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return it(t,n);throw new Error("Expected varint not more than 10 bytes")}function gt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,Hf(r,t))}function Wf(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var zf=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Vf(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=zf[t],o=Math.pow(2,t);let s=0,a=0,l=0;const i=[e,r];let f=o/2;for(;f>0;)s=(i[0]&f)>0?1:0,a=(i[1]&f)>0?1:0,l+=f*f*(3*s^a),Wf(f,i,s,a),f=f/2;return n+l}function Pn(t,e){return ie(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Jt(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var Gf=127;function Kf(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var qf=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ie(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const l=o.headers.get("Content-Range");if(!l||!l.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+l.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ye(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function Zf(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ye(r,8),rootDirectoryLength:ye(r,16),jsonMetadataOffset:ye(r,24),jsonMetadataLength:ye(r,32),leafDirectoryOffset:ye(r,40),leafDirectoryLength:ye(r,48),tileDataOffset:ye(r,56),tileDataLength:ye(r,64),numAddressedTiles:ye(r,72),numTileEntries:ye(r,80),numTileContents:ye(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function In(t){const e={buf:new Uint8Array(t),pos:0},r=gt(e),n=[];let o=0;for(let s=0;s<r;s++){const a=gt(e);n.push({tileId:o+a,offset:0,length:0,runLength:1}),o+=a}for(let s=0;s<r;s++)n[s].runLength=gt(e);for(let s=0;s<r;s++)n[s].length=gt(e);for(let s=0;s<r;s++){const a=gt(e);a===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=a-1}return n}function Xf(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ut=class extends Error{};function Yf(t,e,r,n){return ie(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Xf(o.data)<3)return[yield En.getHeader(t)];const a=o.data.slice(0,Gf);let l=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),l=void 0);const i=Zf(a,l);if(r){const f=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),u=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=In(yield e(f,i.internalCompression));return[i,[u,c.length,c]]}return[i,void 0]})}function Jf(t,e,r,n,o){return ie(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new ut(s.etag);const a=yield e(s.data,o.internalCompression),l=In(a);if(l.length===0)throw new Error("Empty directory is invalid");return l})}var Qf=class{constructor(t=100,e=!0,r=Pn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ie(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{Yf(t,this.decompress,this.prefetch,e).then(a=>{a[1]&&this.cache.set(a[1][0],{lastUsed:this.counter++,data:Promise.resolve(a[1][2])}),o(a[0]),this.prune()}).catch(a=>{s(a)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((a,l)=>{Jf(t,this.decompress,e,r,n).then(i=>{a(i),this.prune()}).catch(i=>{l(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((a,l)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new ut(i.etag);a(i.data),this.cache.has(o),this.prune()}).catch(i=>{l(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ie(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},zr=class{constructor(t,e,r){typeof t=="string"?this.source=new qf(t):this.source=t,r?this.decompress=r:this.decompress=Pn,e?this.cache=e:this.cache=new Qf}getHeader(){return ie(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ie(this,null,function*(){const o=Vf(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return En.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let a=s.rootDirectoryOffset,l=s.rootDirectoryLength;for(let i=0;i<=3;i++){const f=yield this.cache.getDirectory(this.source,a,l,s),u=Kf(f,o);if(u)if(u.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+u.offset,u.length,n);if(s.etag&&s.etag!==c.etag)throw new ut(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else a=s.leafDirectoryOffset+u.offset,l=u.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ie(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof ut)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ie(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new ut(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ie(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof ut)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function ec(t){return It(()=>{let e=new Rf;fr.addProtocol("pmtiles",e.tile)}),en(()=>{fr.removeProtocol("pmtiles")}),[]}class tc extends V{constructor(e){super(),G(this,e,ec,null,K,{})}}function Vr(t,e,r){const n=t.slice();return n[13]=e[r],n}function rc(t){let e,r;return e=new af({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:ee,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Gr(t){let e,r,n,o;function s(i){t[9](i)}function a(i){t[10](i)}let l={schemes:t[1]};return t[2]!==void 0&&(l.schemesToBeShown=t[2]),t[3]!==void 0&&(l.filterText=t[3]),e=new wi({props:l}),W.push(()=>q(e,"schemesToBeShown",s)),W.push(()=>q(e,"filterText",a)),{c(){_(e.$$.fragment)},m(i,f){w(e,i,f),o=!0},p(i,f){const u={};f&2&&(u.schemes=i[1]),!r&&f&4&&(r=!0,u.schemesToBeShown=i[2],Z(()=>r=!1)),!n&&f&8&&(n=!0,u.filterText=i[3],Z(()=>n=!1)),e.$set(u)},i(i){o||(g(e.$$.fragment,i),o=!0)},o(i){d(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function Kr(t){let e,r;return e=new $f({props:{scheme:t[13],authorityNames:t[5]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function qr(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&Kr(t);return{c(){o&&o.c(),r=tr()},m(s,a){o&&o.m(s,a),m(s,r,a),n=!0},p(s,a){a&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,a),a&6&&g(o,1)):(o=Kr(s),o.c(),g(o,1),o.m(r.parentNode,r)):o&&(de(),d(o,1,1,()=>{o=null}),_e())},i(s){n||(g(o),n=!0)},o(s){d(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function nc(t){let e,r,n,o,s,a,l,i,f,u,c=Zr()=="Test (on GCP)",p,$,y,k,S,L,D,M;s=new qn({props:{boundaryGeojson:t[4]}}),l=new so({}),f=new Wn({});let C=c&&rc(t);$=new eo({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),k=new Qr({props:{errorMessage:t[0]}});let A=t[1].size>0&&Gr(t),F=We(t[1].values()),x=[];for(let I=0;I<F.length;I+=1)x[I]=qr(Vr(t,F,I));const P=I=>d(x[I],1,1,()=>{x[I]=null});return{c(){e=E("div"),r=E("div"),n=E("h1"),n.textContent="Browse schemes",o=T(),_(s.$$.fragment),a=T(),_(l.$$.fragment),i=T(),_(f.$$.fragment),u=T(),C&&C.c(),p=T(),_($.$$.fragment),y=T(),_(k.$$.fragment),S=T(),A&&A.c(),L=T(),D=E("ul");for(let I=0;I<x.length;I+=1)x[I].c();Fe(r,"display","flex"),Fe(r,"justify-content","space-between"),z(e,"slot","sidebar"),z(e,"class","govuk-prose")},m(I,N){m(I,e,N),O(e,r),O(r,n),O(r,o),w(s,r,null),O(e,a),w(l,e,null),O(e,i),w(f,e,null),O(e,u),C&&C.m(e,null),O(e,p),w($,e,null),O(e,y),w(k,e,null),O(e,S),A&&A.m(e,null),O(e,L),O(e,D);for(let B=0;B<x.length;B+=1)x[B]&&x[B].m(D,null);M=!0},p(I,N){const B={};N&16&&(B.boundaryGeojson=I[4]),s.$set(B),c&&C.p(I,N);const J={};if(N&1&&(J.errorMessage=I[0]),k.$set(J),I[1].size>0?A?(A.p(I,N),N&2&&g(A,1)):(A=Gr(I),A.c(),g(A,1),A.m(e,L)):A&&(de(),d(A,1,1,()=>{A=null}),_e()),N&38){F=We(I[1].values());let U;for(U=0;U<F.length;U+=1){const ae=Vr(I,F,U);x[U]?(x[U].p(ae,N),g(x[U],1)):(x[U]=qr(ae),x[U].c(),g(x[U],1),x[U].m(D,null))}for(de(),U=F.length;U<x.length;U+=1)P(U);_e()}},i(I){if(!M){g(s.$$.fragment,I),g(l.$$.fragment,I),g(f.$$.fragment,I),g(C),g($.$$.fragment,I),g(k.$$.fragment,I),g(A);for(let N=0;N<F.length;N+=1)g(x[N]);M=!0}},o(I){d(s.$$.fragment,I),d(l.$$.fragment,I),d(f.$$.fragment,I),d(C),d($.$$.fragment,I),d(k.$$.fragment,I),d(A),x=x.filter(Boolean);for(let N=0;N<x.length;N+=1)d(x[N]);M=!1},d(I){I&&h(e),b(s),b(l),b(f),C&&C.d(),b($),b(k),A&&A.d(),At(x,I)}}}function oc(t){let e,r,n,o,s,a,l,i,f,u,c;return e=new Zn({props:{colorInterventions:tn("v1")}}),n=new Q({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new Q({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),l=new Q({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),u=new of({props:{style:t[6]}}),{c(){_(e.$$.fragment),r=T(),_(n.$$.fragment),o=T(),_(s.$$.fragment),a=T(),_(l.$$.fragment),i=T(),f=E("div"),_(u.$$.fragment),z(f,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,a,$),w(l,p,$),m(p,i,$),m(p,f,$),w(u,f,null),c=!0},p:ee,i(p){c||(g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(l.$$.fragment,p),g(u.$$.fragment,p),c=!0)},o(p){d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(l.$$.fragment,p),d(u.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(a),h(i),h(f)),b(e,p),b(n,p),b(s,p),b(l,p),b(u)}}}function sc(t){let e,r,n,o,s;return r=new tc({}),o=new Qn({props:{style:t[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[oc]},$$scope:{ctx:t}}}),{c(){e=E("div"),_(r.$$.fragment),n=T(),_(o.$$.fragment),z(e,"slot","main")},m(a,l){m(a,e,l),w(r,e,null),O(e,n),w(o,e,null),s=!0},p(a,l){const i={};l&65536&&(i.$$scope={dirty:l,ctx:a}),o.$set(i)},i(a){s||(g(r.$$.fragment,a),g(o.$$.fragment,a),s=!0)},o(a){d(r.$$.fragment,a),d(o.$$.fragment,a),s=!1},d(a){a&&h(e),b(r),b(o)}}}function ic(t){let e,r;return e=new Jn({props:{$$slots:{main:[sc],sidebar:[nc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){d(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function ac(t,e,r){let n;Y(t,ft,S=>r(4,n=S));let o=new Set(mf);It(()=>{zn()});let a=new URLSearchParams(window.location.search).get("style")||"dataviz",l="",i=new Map,f=new Set,u="";en(()=>{ft.set(Jr())});function c(S){try{let L=JSON.parse(S);r(1,i=ai(L)),ft.set(L),r(0,l="")}catch(L){r(0,l=`The file you loaded is broken: ${L}`)}}function p(S){let L=S.properties;var D='<div style="max-width: 30vw;">';return D+=`<h2>${$(L.name)} (${L.intervention_type})</h2>`,D+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(D+=`<p>Length: ${Vn(L.length_meters)}</p>`),L.description&&(D+=`<p>${$(L.description)}</p>`),D+="</div>",D}function $(S){return u?S.replace(new RegExp(u,"gi"),L=>`<mark>${L}</mark>`):S}function y(S){f=S,r(2,f)}function k(S){u=S,r(3,u)}return[l,i,f,u,n,o,a,c,p,y,k]}class lc extends V{constructor(e){super(),G(this,e,ac,ic,K,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new lc({target:document.getElementById("app")});
