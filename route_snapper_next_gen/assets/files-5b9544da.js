import{a4 as ae,h as I,t as N,S as j,i as $,s as x,D as kt,f as F,q as Se,j as L,e as E,a as G,l as U,d as P,g as _,z as V,c as me,m as pe,k as we,a3 as J,r as Et,G as ve,H as be,I as _e,J as Pe,aa as C,b as ee,y as Mt,a1 as St,a2 as Ae,a5 as oe,O as ge,ak as Ce,P as At,al as Oe,ay as Ct,A as Ot,v as Ft}from"./stores-700842c6.js";function Fe(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Hr(e,t){I(e,1,1,()=>{t.delete(e.key)})}function Kr(e,t,r,n,i,o,l,u,a,s,c,f){let d=e.length,h=o.length,g=d;const y={};for(;g--;)y[e[g].key]=g;const b=[],m=new Map,p=new Map,w=[];for(g=h;g--;){const M=f(i,o,g),q=r(M);let R=l.get(q);R?n&&w.push(()=>R.p(M,t)):(R=s(q,M),R.c()),m.set(q,b[g]=R),q in y&&p.set(q,Math.abs(g-y[q]))}const k=new Set,v=new Set;function K(M){N(M,1),M.m(u,c),l.set(M.key,M),c=M.first,h--}for(;d&&h;){const M=b[h-1],q=e[d-1],R=M.key,ne=q.key;M===q?(c=M.first,d--,h--):m.has(ne)?!l.has(R)||k.has(R)?K(M):v.has(ne)?d--:p.get(R)>p.get(ne)?(v.add(R),K(M)):(k.add(ne),d--):(a(q,l),d--)}for(;d--;){const M=e[d];m.has(M.key)||a(M,l)}for(;h;)K(b[h-1]);return ae(w),b}let ie;const Lt=new Uint8Array(16);function Bt(){if(!ie&&(ie=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ie))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ie(Lt)}const S=[];for(let e=0;e<256;++e)S.push((e+256).toString(16).slice(1));function Gt(e,t=0){return S[e[t+0]]+S[e[t+1]]+S[e[t+2]]+S[e[t+3]]+"-"+S[e[t+4]]+S[e[t+5]]+"-"+S[e[t+6]]+S[e[t+7]]+"-"+S[e[t+8]]+S[e[t+9]]+"-"+S[e[t+10]]+S[e[t+11]]+S[e[t+12]]+S[e[t+13]]+S[e[t+14]]+S[e[t+15]]}const qt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Le={randomUUID:qt};function ze(e,t,r){if(Le.randomUUID&&!t&&!e)return Le.randomUUID();e=e||{};const n=e.random||(e.rng||Bt)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let i=0;i<16;++i)t[r+i]=n[i];return t}return Gt(n)}function Be(e){let t,r,n,i;return{c(){t=E("div"),r=E("span"),r.textContent="Error:",n=G(),i=U(e[0]),P(r,"class","govuk-visually-hidden"),P(t,"class","govuk-error-message")},m(o,l){F(o,t,l),_(t,r),_(t,n),_(t,i)},p(o,l){l&1&&V(i,o[0])},d(o){o&&L(t)}}}function Rt(e){let t,r=e[0]&&Be(e);return{c(){r&&r.c(),t=kt()},m(n,i){r&&r.m(n,i),F(n,t,i)},p(n,[i]){n[0]?r?r.p(n,i):(r=Be(n),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:Se,o:Se,d(n){n&&L(t),r&&r.d(n)}}}function Nt(e,t,r){let{errorMessage:n}=t;return e.$$set=i=>{"errorMessage"in i&&r(0,n=i.errorMessage)},[n]}class It extends j{constructor(t){super(),$(this,t,Nt,Rt,x,{errorMessage:0})}}function Ut(e){let t,r,n;return{c(){t=E("input"),t.disabled=e[1],P(t,"class","govuk-file-upload"),P(t,"id",e[4]),P(t,"type","file")},m(i,o){F(i,t,o),e[6](t),r||(n=J(t,"change",e[3]),r=!0)},p(i,o){o&2&&(t.disabled=i[1])},d(i){i&&L(t),e[6](null),r=!1,n()}}}function Jt(e){let t,r;return t=new zt({props:{label:e[0],id:e[4],$$slots:{default:[Ut]},$$scope:{ctx:e}}}),{c(){me(t.$$.fragment)},m(n,i){pe(t,n,i),r=!0},p(n,[i]){const o={};i&1&&(o.label=n[0]),i&134&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(N(t.$$.fragment,n),r=!0)},o(n){I(t.$$.fragment,n),r=!1},d(n){we(t,n)}}}function Tt(e,t,r){let{label:n}=t,{onLoad:i}=t,{disabled:o=!1}=t,l;async function u(c){let f=l.files[0].name,d=await l.files[0].text();i(f,d)}let a=ze();function s(c){Et[c?"unshift":"push"](()=>{l=c,r(2,l)})}return e.$$set=c=>{"label"in c&&r(0,n=c.label),"onLoad"in c&&r(5,i=c.onLoad),"disabled"in c&&r(1,o=c.disabled)},[n,o,l,u,a,i,s]}class Wr extends j{constructor(t){super(),$(this,t,Tt,Jt,x,{label:0,onLoad:5,disabled:1})}}function Vt(e){let t,r,n,i,o;const l=e[3].default,u=ve(l,e,e[2],null);return{c(){t=E("div"),r=E("label"),n=U(e[0]),i=G(),u&&u.c(),P(r,"class","govuk-label govuk-label--s"),P(r,"for",e[1]),P(t,"class","govuk-form-group")},m(a,s){F(a,t,s),_(t,r),_(r,n),_(t,i),u&&u.m(t,null),o=!0},p(a,[s]){(!o||s&1)&&V(n,a[0]),(!o||s&2)&&P(r,"for",a[1]),u&&u.p&&(!o||s&4)&&be(u,l,a,a[2],o?Pe(l,a[2],s,null):_e(a[2]),null)},i(a){o||(N(u,a),o=!0)},o(a){I(u,a),o=!1},d(a){a&&L(t),u&&u.d(a)}}}function Dt(e,t,r){let{$$slots:n={},$$scope:i}=t,{label:o}=t,{id:l}=t;return e.$$set=u=>{"label"in u&&r(0,o=u.label),"id"in u&&r(1,l=u.id),"$$scope"in u&&r(2,i=u.$$scope)},[o,l,i,n]}class zt extends j{constructor(t){super(),$(this,t,Dt,Vt,x,{label:0,id:1})}}function Ge(e,t,r){const n=e.slice();return n[14]=t[r][0],n[15]=t[r][1],n}function qe(e){let t,r;return{c(){t=E("legend"),r=U(e[1]),P(t,"class","govuk-fieldset__legend govuk-fieldset__legend--s"),ee(t,"margin-right","8px")},m(n,i){F(n,t,i),_(t,r)},p(n,i){i&2&&V(r,n[1])},d(n){n&&L(t)}}}function Re(e){let t,r;return{c(){t=E("legend"),r=U(e[1]),P(t,"class","govuk-fieldset__legend govuk-fieldset__legend--s")},m(n,i){F(n,t,i),_(t,r)},p(n,i){i&2&&V(r,n[1])},d(n){n&&L(t)}}}function Ne(e){let t,r;return{c(){t=E("div"),r=U(e[2]),P(t,"class","govuk-hint")},m(n,i){F(n,t,i),_(t,r)},p(n,i){i&4&&V(r,n[2])},d(n){n&&L(t)}}}function Ie(e){let t,r;return{c(){t=E("legend"),r=U(e[1]),P(t,"class","govuk-fieldset__legend govuk-fieldset__legend--s"),ee(t,"margin-right","8px")},m(n,i){F(n,t,i),_(t,r)},p(n,i){i&2&&V(r,n[1])},d(n){n&&L(t)}}}function Ue(e){let t,r,n,i,o=!1,l,u,a=e[15]+"",s,c,f,d,h,g;return d=St(e[13][0]),{c(){t=E("div"),r=E("input"),l=G(),u=E("label"),s=U(a),f=G(),P(r,"class","govuk-radios__input"),P(r,"id",n=e[9]+e[14]),P(r,"type","radio"),r.__value=i=e[14],Ae(r,r.__value),P(u,"class","govuk-label govuk-radios__label"),P(u,"for",c=e[9]+e[14]),P(t,"class","govuk-radios__item"),d.p(r)},m(y,b){F(y,t,b),_(t,r),r.checked=r.__value===e[0],_(t,l),_(t,u),_(u,s),_(t,f),h||(g=[J(r,"change",e[12]),J(r,"change",e[11])],h=!0)},p(y,b){b&8&&n!==(n=y[9]+y[14])&&P(r,"id",n),b&8&&i!==(i=y[14])&&(r.__value=i,Ae(r,r.__value),o=!0),(o||b&9)&&(r.checked=r.__value===y[0]),b&8&&a!==(a=y[15]+"")&&V(s,a),b&8&&c!==(c=y[9]+y[14])&&P(u,"for",c)},d(y){y&&L(t),d.r(),h=!1,ae(g)}}}function Ht(e){let t,r,n,i,o,l,u,a,s,c,f,d=e[7]&&!e[4]&&qe(e),h=!e[7]&&Re(e);l=new It({props:{errorMessage:e[8]}});let g=e[2]&&Ne(e),y=e[7]&&e[4]&&Ie(e),b=Fe(e[3]),m=[];for(let p=0;p<b.length;p+=1)m[p]=Ue(Ge(e,b,p));return{c(){t=E("div"),d&&d.c(),r=G(),n=E("div"),i=E("fieldset"),h&&h.c(),o=G(),me(l.$$.fragment),u=G(),g&&g.c(),a=G(),s=E("div"),y&&y.c(),c=G();for(let p=0;p<m.length;p+=1)m[p].c();P(s,"class","govuk-radios svelte-1i6hs1"),P(s,"data-module","govuk-radios"),C(s,"govuk-radios--inline",e[4]),C(s,"govuk-radios--small",e[4]),C(s,"nowrap",e[5]),C(s,"no-bottom-margin",e[6]),P(i,"class","govuk-fieldset"),P(n,"class","govuk-form-group"),ee(t,"display","flex")},m(p,w){F(p,t,w),d&&d.m(t,null),_(t,r),_(t,n),_(n,i),h&&h.m(i,null),_(i,o),pe(l,i,null),_(i,u),g&&g.m(i,null),_(i,a),_(i,s),y&&y.m(s,null),_(s,c);for(let k=0;k<m.length;k+=1)m[k]&&m[k].m(s,null);f=!0},p(p,[w]){p[7]&&!p[4]?d?d.p(p,w):(d=qe(p),d.c(),d.m(t,r)):d&&(d.d(1),d=null),p[7]?h&&(h.d(1),h=null):h?h.p(p,w):(h=Re(p),h.c(),h.m(i,o));const k={};if(w&256&&(k.errorMessage=p[8]),l.$set(k),p[2]?g?g.p(p,w):(g=Ne(p),g.c(),g.m(i,a)):g&&(g.d(1),g=null),p[7]&&p[4]?y?y.p(p,w):(y=Ie(p),y.c(),y.m(s,c)):y&&(y.d(1),y=null),w&521){b=Fe(p[3]);let v;for(v=0;v<b.length;v+=1){const K=Ge(p,b,v);m[v]?m[v].p(K,w):(m[v]=Ue(K),m[v].c(),m[v].m(s,null))}for(;v<m.length;v+=1)m[v].d(1);m.length=b.length}(!f||w&16)&&C(s,"govuk-radios--inline",p[4]),(!f||w&16)&&C(s,"govuk-radios--small",p[4]),(!f||w&32)&&C(s,"nowrap",p[5]),(!f||w&64)&&C(s,"no-bottom-margin",p[6])},i(p){f||(N(l.$$.fragment,p),f=!0)},o(p){I(l.$$.fragment,p),f=!1},d(p){p&&L(t),d&&d.d(),h&&h.d(),we(l),g&&g.d(),y&&y.d(),Mt(m,p)}}}function Kt(e,t,r){let n,{label:i}=t,{hint:o=""}=t,{choices:l}=t,{inlineSmall:u=!1}=t,{nowrap:a=!1}=t,{noBottomMargin:s=!1}=t,{leftLabel:c=!1}=t,{required:f=!1}=t,{value:d}=t,h=ze();const g=[[]];function y(m){oe.call(this,e,m)}function b(){d=this.__value,r(0,d)}return e.$$set=m=>{"label"in m&&r(1,i=m.label),"hint"in m&&r(2,o=m.hint),"choices"in m&&r(3,l=m.choices),"inlineSmall"in m&&r(4,u=m.inlineSmall),"nowrap"in m&&r(5,a=m.nowrap),"noBottomMargin"in m&&r(6,s=m.noBottomMargin),"leftLabel"in m&&r(7,c=m.leftLabel),"required"in m&&r(10,f=m.required),"value"in m&&r(0,d=m.value)},e.$$.update=()=>{e.$$.dirty&1025&&r(8,n=f&&d==""?"Required":"")},[d,i,o,l,u,a,s,c,n,h,f,y,b,g]}class Xr extends j{constructor(t){super(),$(this,t,Kt,Ht,x,{label:1,hint:2,choices:3,inlineSmall:4,nowrap:5,noBottomMargin:6,leftLabel:7,required:10,value:0})}}function Wt(e){let t,r,n,i;const o=e[3].default,l=ve(o,e,e[2],null);let u=[{type:"button"},{class:"govuk-button govuk-button--secondary"},{"data-module":"govuk-button"},e[1]],a={};for(let s=0;s<u.length;s+=1)a=ge(a,u[s]);return{c(){t=E("button"),l&&l.c(),Ce(t,a),C(t,"no-bottom-margin",e[0]),C(t,"svelte-m0sq6k",!0)},m(s,c){F(s,t,c),l&&l.m(t,null),t.autofocus&&t.focus(),r=!0,n||(i=[J(t,"click",e[4]),J(t,"mouseenter",e[5]),J(t,"mouseleave",e[6])],n=!0)},p(s,[c]){l&&l.p&&(!r||c&4)&&be(l,o,s,s[2],r?Pe(o,s[2],c,null):_e(s[2]),null),Ce(t,a=At(u,[{type:"button"},{class:"govuk-button govuk-button--secondary"},{"data-module":"govuk-button"},c&2&&s[1]])),C(t,"no-bottom-margin",s[0]),C(t,"svelte-m0sq6k",!0)},i(s){r||(N(l,s),r=!0)},o(s){I(l,s),r=!1},d(s){s&&L(t),l&&l.d(s),n=!1,ae(i)}}}function Xt(e,t,r){let{$$slots:n={},$$scope:i}=t,{noBottomMargin:o=!1}=t;function l(s){oe.call(this,e,s)}function u(s){oe.call(this,e,s)}function a(s){oe.call(this,e,s)}return e.$$set=s=>{r(1,t=ge(ge({},t),Oe(s))),"noBottomMargin"in s&&r(0,o=s.noBottomMargin),"$$scope"in s&&r(2,i=s.$$scope)},t=Oe(t),[o,t,i,n,l,u,a]}class Yt extends j{constructor(t){super(),$(this,t,Xt,Wt,x,{noBottomMargin:0})}}var O=63710088e-1,He={centimeters:O*100,centimetres:O*100,degrees:360/(2*Math.PI),feet:O*3.28084,inches:O*39.37,kilometers:O/1e3,kilometres:O/1e3,meters:O,metres:O,miles:O/1609.344,millimeters:O*1e3,millimetres:O*1e3,nauticalmiles:O/1852,radians:1,yards:O*1.0936};function Y(e,t,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function W(e,t,r={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!T(e[0])||!T(e[1]))throw new Error("coordinates must contain numbers");return Y({type:"Point",coordinates:e},t,r)}function Yr(e,t,r={}){for(const i of e){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return Y({type:"Polygon",coordinates:e},t,r)}function X(e,t,r={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return Y({type:"LineString",coordinates:e},t,r)}function Qr(e,t={}){const r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function Zr(e,t,r={}){return Y({type:"MultiPolygon",coordinates:e},t,r)}function jr(e,t="kilometers"){const r=He[t];if(!r)throw new Error(t+" units is invalid");return e*r}function $r(e,t="kilometers"){const r=He[t];if(!r)throw new Error(t+" units is invalid");return e/r}function xr(e){return e%(2*Math.PI)*180/Math.PI}function en(e){return e%360*Math.PI/180}function T(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function Ke(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var Qt=Object.defineProperty,A=(e,t)=>Qt(e,"name",{value:t,configurable:!0});function te(e,t,r){if(e!==null)for(var n,i,o,l,u,a,s,c=0,f=0,d,h=e.type,g=h==="FeatureCollection",y=h==="Feature",b=g?e.features.length:1,m=0;m<b;m++){s=g?e.features[m].geometry:y?e.geometry:e,d=s?s.type==="GeometryCollection":!1,u=d?s.geometries.length:1;for(var p=0;p<u;p++){var w=0,k=0;if(l=d?s.geometries[p]:s,l!==null){a=l.coordinates;var v=l.type;switch(c=r&&(v==="Polygon"||v==="MultiPolygon")?1:0,v){case null:break;case"Point":if(t(a,f,m,w,k)===!1)return!1;f++,w++;break;case"LineString":case"MultiPoint":for(n=0;n<a.length;n++){if(t(a[n],f,m,w,k)===!1)return!1;f++,v==="MultiPoint"&&w++}v==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(n=0;n<a.length;n++){for(i=0;i<a[n].length-c;i++){if(t(a[n][i],f,m,w,k)===!1)return!1;f++}v==="MultiLineString"&&w++,v==="Polygon"&&k++}v==="Polygon"&&w++;break;case"MultiPolygon":for(n=0;n<a.length;n++){for(k=0,i=0;i<a[n].length;i++){for(o=0;o<a[n][i].length-c;o++){if(t(a[n][i][o],f,m,w,k)===!1)return!1;f++}k++}w++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(te(l.geometries[n],t,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}A(te,"coordEach");function Zt(e,t,r,n){var i=r;return te(e,function(o,l,u,a,s){l===0&&r===void 0?i=o:i=t(i,o,l,u,a,s)},n),i}A(Zt,"coordReduce");function We(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&t(e.features[r].properties,r)!==!1;r++);break;case"Feature":t(e.properties,0);break}}A(We,"propEach");function jt(e,t,r){var n=r;return We(e,function(i,o){o===0&&r===void 0?n=i:n=t(n,i,o)}),n}A(jt,"propReduce");function Xe(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var r=0;r<e.features.length&&t(e.features[r],r)!==!1;r++);}A(Xe,"featureEach");function $t(e,t,r){var n=r;return Xe(e,function(i,o){o===0&&r===void 0?n=i:n=t(n,i,o)}),n}A($t,"featureReduce");function xt(e){var t=[];return te(e,function(r){t.push(r)}),t}A(xt,"coordAll");function ke(e,t){var r,n,i,o,l,u,a,s,c,f,d=0,h=e.type==="FeatureCollection",g=e.type==="Feature",y=h?e.features.length:1;for(r=0;r<y;r++){for(u=h?e.features[r].geometry:g?e.geometry:e,s=h?e.features[r].properties:g?e.properties:{},c=h?e.features[r].bbox:g?e.bbox:void 0,f=h?e.features[r].id:g?e.id:void 0,a=u?u.type==="GeometryCollection":!1,l=a?u.geometries.length:1,i=0;i<l;i++){if(o=a?u.geometries[i]:u,o===null){if(t(null,d,s,c,f)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(o,d,s,c,f)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<o.geometries.length;n++)if(t(o.geometries[n],d,s,c,f)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}A(ke,"geomEach");function Ye(e,t,r){var n=r;return ke(e,function(i,o,l,u,a){o===0&&r===void 0?n=i:n=t(n,i,o,l,u,a)}),n}A(Ye,"geomReduce");function se(e,t){ke(e,function(r,n,i,o,l){var u=r===null?null:r.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return t(Y(r,i,{bbox:o,id:l}),n,0)===!1?!1:void 0}var a;switch(u){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon";break}for(var s=0;s<r.coordinates.length;s++){var c=r.coordinates[s],f={type:a,coordinates:c};if(t(Y(f,i),n,s)===!1)return!1}})}A(se,"flattenEach");function er(e,t,r){var n=r;return se(e,function(i,o,l){o===0&&l===0&&r===void 0?n=i:n=t(n,i,o,l)}),n}A(er,"flattenReduce");function Qe(e,t){se(e,function(r,n,i){var o=0;if(r.geometry){var l=r.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var u,a=0,s=0,c=0;if(te(r,function(f,d,h,g,y){if(u===void 0||n>a||g>s||y>c){u=f,a=n,s=g,c=y,o=0;return}var b=X([u,f],r.properties);if(t(b,n,i,y,o)===!1)return!1;o++,u=f})===!1)return!1}}})}A(Qe,"segmentEach");function tr(e,t,r){var n=r,i=!1;return Qe(e,function(o,l,u,a,s){i===!1&&r===void 0?n=o:n=t(n,o,l,u,a,s),i=!0}),n}A(tr,"segmentReduce");function Ze(e,t){if(!e)throw new Error("geojson is required");se(e,function(r,n,i){if(r.geometry!==null){var o=r.geometry.type,l=r.geometry.coordinates;switch(o){case"LineString":if(t(r,n,i,0,0)===!1)return!1;break;case"Polygon":for(var u=0;u<l.length;u++)if(t(X(l[u],r.properties),n,i,u)===!1)return!1;break}}})}A(Ze,"lineEach");function rr(e,t,r){var n=r;return Ze(e,function(i,o,l,u){o===0&&r===void 0?n=i:n=t(n,i,o,l,u)}),n}A(rr,"lineReduce");function nr(e,t){if(t=t||{},!Ke(t))throw new Error("options is invalid");var r=t.featureIndex||0,n=t.multiFeatureIndex||0,i=t.geometryIndex||0,o=t.segmentIndex||0,l=t.properties,u;switch(e.type){case"FeatureCollection":r<0&&(r=e.features.length+r),l=l||e.features[r].properties,u=e.features[r].geometry;break;case"Feature":l=l||e.properties,u=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=e;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var a=u.coordinates;switch(u.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=a.length+o-1),X([a[o],a[o+1]],l,t);case"Polygon":return i<0&&(i=a.length+i),o<0&&(o=a[i].length+o-1),X([a[i][o],a[i][o+1]],l,t);case"MultiLineString":return n<0&&(n=a.length+n),o<0&&(o=a[n].length+o-1),X([a[n][o],a[n][o+1]],l,t);case"MultiPolygon":return n<0&&(n=a.length+n),i<0&&(i=a[n].length+i),o<0&&(o=a[n][i].length-o-1),X([a[n][i][o],a[n][i][o+1]],l,t)}throw new Error("geojson is invalid")}A(nr,"findSegment");function ir(e,t){if(t=t||{},!Ke(t))throw new Error("options is invalid");var r=t.featureIndex||0,n=t.multiFeatureIndex||0,i=t.geometryIndex||0,o=t.coordIndex||0,l=t.properties,u;switch(e.type){case"FeatureCollection":r<0&&(r=e.features.length+r),l=l||e.features[r].properties,u=e.features[r].geometry;break;case"Feature":l=l||e.properties,u=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=e;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var a=u.coordinates;switch(u.type){case"Point":return W(a,l,t);case"MultiPoint":return n<0&&(n=a.length+n),W(a[n],l,t);case"LineString":return o<0&&(o=a.length+o),W(a[o],l,t);case"Polygon":return i<0&&(i=a.length+i),o<0&&(o=a[i].length+o),W(a[i][o],l,t);case"MultiLineString":return n<0&&(n=a.length+n),o<0&&(o=a[n].length+o),W(a[n][o],l,t);case"MultiPolygon":return n<0&&(n=a.length+n),i<0&&(i=a[n].length+i),o<0&&(o=a[n][i].length-o),W(a[n][i][o],l,t)}throw new Error("geojson is invalid")}A(ir,"findPoint");var or=Object.defineProperty,ue=(e,t)=>or(e,"name",{value:t,configurable:!0});function je(e){return Ye(e,(t,r)=>t+$e(r),0)}ue(je,"area");function $e(e){let t=0,r;switch(e.type){case"Polygon":return he(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)t+=he(e.coordinates[r]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}ue($e,"calculateArea");function he(e){let t=0;if(e&&e.length>0){t+=Math.abs(de(e[0]));for(let r=1;r<e.length;r++)t-=Math.abs(de(e[r]))}return t}ue(he,"polygonArea");var lr=O*O/2,ce=Math.PI/180;function de(e){const t=e.length;if(t<=2)return 0;let r=0,n=0;for(;n<t;){const i=e[n],o=e[n+1===t?0:n+1],l=e[n+2>=t?(n+2)%t:n+2],u=i[0]*ce,a=o[1]*ce,s=l[0]*ce;r+=(s-u)*Math.sin(a),n++}return r*lr}ue(de,"ringArea");var Je=je;function xe(e,t,r){if(e!==null)for(var n,i,o,l,u,a,s,c=0,f=0,d,h=e.type,g=h==="FeatureCollection",y=h==="Feature",b=g?e.features.length:1,m=0;m<b;m++){s=g?e.features[m].geometry:y?e.geometry:e,d=s?s.type==="GeometryCollection":!1,u=d?s.geometries.length:1;for(var p=0;p<u;p++){var w=0,k=0;if(l=d?s.geometries[p]:s,l!==null){a=l.coordinates;var v=l.type;switch(c=r&&(v==="Polygon"||v==="MultiPolygon")?1:0,v){case null:break;case"Point":if(t(a,f,m,w,k)===!1)return!1;f++,w++;break;case"LineString":case"MultiPoint":for(n=0;n<a.length;n++){if(t(a[n],f,m,w,k)===!1)return!1;f++,v==="MultiPoint"&&w++}v==="LineString"&&w++;break;case"Polygon":case"MultiLineString":for(n=0;n<a.length;n++){for(i=0;i<a[n].length-c;i++){if(t(a[n][i],f,m,w,k)===!1)return!1;f++}v==="MultiLineString"&&w++,v==="Polygon"&&k++}v==="Polygon"&&w++;break;case"MultiPolygon":for(n=0;n<a.length;n++){for(k=0,i=0;i<a[n].length;i++){for(o=0;o<a[n][i].length-c;o++){if(t(a[n][i][o],f,m,w,k)===!1)return!1;f++}k++}w++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(xe(l.geometries[n],t,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Q(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const r=[1/0,1/0,-1/0,-1/0];return xe(e,n=>{r[0]>n[0]&&(r[0]=n[0]),r[1]>n[1]&&(r[1]=n[1]),r[2]<n[0]&&(r[2]=n[0]),r[3]<n[1]&&(r[3]=n[1])}),r}var ar=Q;const tn=Object.freeze(Object.defineProperty({__proto__:null,bbox:Q,default:ar},Symbol.toStringTag,{value:"Module"}));function sr(e,t){var r=0,n=0,i=0,o=0,l=0,u=0,a=0,s=0,c=null,f=null,d=e[0],h=e[1],g=t.length;for(r;r<g;r++){n=0;var y=t[r].length-1,b=t[r];if(c=b[0],c[0]!==b[y][0]&&c[1]!==b[y][1])throw new Error("First and last coordinates in a ring must be the same");for(l=c[0]-d,u=c[1]-h,n;n<y;n++){if(f=b[n+1],s=f[1]-h,u<0&&s<0||u>0&&s>0){c=f,u=s,l=c[0]-d;continue}if(a=f[0]-e[0],s>0&&u<=0){if(o=l*s-a*u,o>0)i=i+1;else if(o===0)return 0}else if(u>0&&s<=0){if(o=l*s-a*u,o<0)i=i+1;else if(o===0)return 0}else if(s===0&&u<0){if(o=l*s-a*u,o===0)return 0}else if(u===0&&s<0){if(o=l*s-a*u,o===0)return 0}else if(u===0&&s===0){if(a<=0&&l>=0)return 0;if(l<=0&&a>=0)return 0}c=f,u=s,l=a}}return i%2!==0}var ur=Object.defineProperty,D=(e,t)=>ur(e,"name",{value:t,configurable:!0});function et(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}D(et,"getCoord");function fr(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}D(fr,"getCoords");function tt(e){if(e.length>1&&T(e[0])&&T(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return tt(e[0]);throw new Error("coordinates must only contain numbers")}D(tt,"containsNumber");function cr(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}D(cr,"geojsonType");function gr(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}D(gr,"featureOf");function hr(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of e.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+n.geometry.type)}}D(hr,"collectionOf");function rt(e){return e.type==="Feature"?e.geometry:e}D(rt,"getGeom");function dr(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}D(dr,"getType");var yr=Object.defineProperty,nt=(e,t)=>yr(e,"name",{value:t,configurable:!0});function re(e,t,r={}){if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");const n=et(e),i=rt(t),o=i.type,l=t.bbox;let u=i.coordinates;if(l&&it(n,l)===!1)return!1;o==="Polygon"&&(u=[u]);let a=!1;for(var s=0;s<u.length;++s){const c=sr(n,u[s]);if(c===0)return!r.ignoreBoundary;c&&(a=!0)}return a}nt(re,"booleanPointInPolygon");function it(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}nt(it,"inBBox");var mr=Object.defineProperty,z=(e,t)=>mr(e,"name",{value:t,configurable:!0});function ot(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}z(ot,"getCoord");function lt(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}z(lt,"getCoords");function at(e){if(e.length>1&&T(e[0])&&T(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return at(e[0]);throw new Error("coordinates must only contain numbers")}z(at,"containsNumber");function pr(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}z(pr,"geojsonType");function wr(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}z(wr,"featureOf");function vr(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of e.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+n.geometry.type)}}z(vr,"collectionOf");function br(e){return e.type==="Feature"?e.geometry:e}z(br,"getGeom");function _r(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}z(_r,"getType");var Pr=Object.defineProperty,st=(e,t)=>Pr(e,"name",{value:t,configurable:!0});function Z(e,t,r={}){const n=ot(e),i=lt(t);for(let o=0;o<i.length-1;o++){let l=!1;if(r.ignoreEndVertices&&(o===0&&(l="start"),o===i.length-2&&(l="end"),o===0&&o+1===i.length-1&&(l="both")),ut(i[o],i[o+1],n,l,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}st(Z,"booleanPointOnLine");function ut(e,t,r,n,i){const o=r[0],l=r[1],u=e[0],a=e[1],s=t[0],c=t[1],f=r[0]-u,d=r[1]-a,h=s-u,g=c-a,y=f*g-d*h;if(i!==null){if(Math.abs(y)>i)return!1}else if(y!==0)return!1;if(n){if(n==="start")return Math.abs(h)>=Math.abs(g)?h>0?u<o&&o<=s:s<=o&&o<u:g>0?a<l&&l<=c:c<=l&&l<a;if(n==="end")return Math.abs(h)>=Math.abs(g)?h>0?u<=o&&o<s:s<o&&o<=u:g>0?a<=l&&l<c:c<l&&l<=a;if(n==="both")return Math.abs(h)>=Math.abs(g)?h>0?u<o&&o<s:s<o&&o<u:g>0?a<l&&l<c:c<l&&l<a}else return Math.abs(h)>=Math.abs(g)?h>0?u<=o&&o<=s:s<=o&&o<=u:g>0?a<=l&&l<=c:c<=l&&l<=a;return!1}st(ut,"isPointOnLineSegment");var kr=Object.defineProperty,H=(e,t)=>kr(e,"name",{value:t,configurable:!0});function Er(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}H(Er,"getCoord");function Mr(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}H(Mr,"getCoords");function ft(e){if(e.length>1&&T(e[0])&&T(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return ft(e[0]);throw new Error("coordinates must only contain numbers")}H(ft,"containsNumber");function Sr(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)}H(Sr,"geojsonType");function Ar(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)}H(Ar,"featureOf");function Cr(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||e.type!=="FeatureCollection")throw new Error("Invalid input to "+r+", FeatureCollection required");for(const n of e.features){if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!n.geometry||n.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+n.geometry.type)}}H(Cr,"collectionOf");function le(e){return e.type==="Feature"?e.geometry:e}H(le,"getGeom");function Or(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}H(Or,"getType");var Fr=Object.defineProperty,B=(e,t)=>Fr(e,"name",{value:t,configurable:!0});function ct(e,t){const r=le(e),n=le(t),i=r.type,o=n.type,l=r.coordinates,u=n.coordinates;switch(i){case"Point":switch(o){case"Point":return fe(l,u);default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"Point":return ht(r,n);case"MultiPoint":return dt(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"Point":return Z(n,r,{ignoreEndVertices:!0});case"LineString":return pt(r,n);case"MultiPoint":return yt(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Point":return re(n,r,{ignoreBoundary:!0});case"LineString":return wt(r,n);case"Polygon":return Ee(r,n);case"MultiPoint":return mt(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPolygon":switch(o){case"Polygon":return gt(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}B(ct,"booleanContains");function gt(e,t){return e.coordinates.some(r=>Ee({type:"Polygon",coordinates:r},t))}B(gt,"isPolygonInMultiPolygon");function ht(e,t){let r,n=!1;for(r=0;r<e.coordinates.length;r++)if(fe(e.coordinates[r],t.coordinates)){n=!0;break}return n}B(ht,"isPointInMultiPoint");function dt(e,t){for(const r of t.coordinates){let n=!1;for(const i of e.coordinates)if(fe(r,i)){n=!0;break}if(!n)return!1}return!0}B(dt,"isMultiPointInMultiPoint");function yt(e,t){let r=!1;for(const n of t.coordinates)if(Z(n,e,{ignoreEndVertices:!0})&&(r=!0),!Z(n,e))return!1;return!!r}B(yt,"isMultiPointOnLine");function mt(e,t){for(const r of t.coordinates)if(!re(r,e,{ignoreBoundary:!0}))return!1;return!0}B(mt,"isMultiPointInPoly");function pt(e,t){let r=!1;for(const n of t.coordinates)if(Z({type:"Point",coordinates:n},e,{ignoreEndVertices:!0})&&(r=!0),!Z({type:"Point",coordinates:n},e,{ignoreEndVertices:!1}))return!1;return r}B(pt,"isLineOnLine");function wt(e,t){let r=!1,n=0;const i=Q(e),o=Q(t);if(!Me(i,o))return!1;for(n;n<t.coordinates.length-1;n++){const l=vt(t.coordinates[n],t.coordinates[n+1]);if(re({type:"Point",coordinates:l},e,{ignoreBoundary:!0})){r=!0;break}}return r}B(wt,"isLineInPoly");function Ee(e,t){if(e.type==="Feature"&&e.geometry===null||t.type==="Feature"&&t.geometry===null)return!1;const r=Q(e),n=Q(t);if(!Me(r,n))return!1;const i=le(t).coordinates;for(const o of i)for(const l of o)if(!re(l,e))return!1;return!0}B(Ee,"isPolyInPoly");function Me(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}B(Me,"doBBoxOverlap");function fe(e,t){return e[0]===t[0]&&e[1]===t[1]}B(fe,"compareCoords");function vt(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}B(vt,"getMidpoint");var Te=ct;function Lr(e){for(let t of e.features)t.properties.full_name=`${t.properties.level}_${t.properties.name}`;return e.features.sort((t,r)=>Je(t)-Je(r)),e}function Br(e,t){let r=t.features.find(n=>Gr(e,n));return r?r.properties.full_name:null}function Gr(e,t){let r=t.geometry;r.type=="MultiPolygon"&&(r={type:"Polygon",coordinates:r.coordinates[0]});for(let n of e)if(n.geometry.type=="MultiLineString"){for(let i of n.geometry.coordinates)if(!Te(r,{type:"LineString",coordinates:i}))return!1}else if(!Te(r,n))return!1;return!0}const qr="/atip/route_snapper_next_gen/assets/authorities-7624c8c2.geojson";function Ve(e){let t,r;return t=new Yt({props:{$$slots:{default:[Rr]},$$scope:{ctx:e}}}),t.$on("click",e[5]),{c(){me(t.$$.fragment)},m(n,i){pe(t,n,i),r=!0},p(n,i){const o={};i&128&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(N(t.$$.fragment,n),r=!0)},o(n){I(t.$$.fragment,n),r=!1},d(n){we(t,n)}}}function Rr(e){let t;return{c(){t=U("X")},m(r,n){F(r,t,n)},d(r){r&&L(t)}}}function Nr(e){let t,r,n,i,o,l,u,a,s,c,f=e[2]&&Ve(e);const d=e[4].default,h=ve(d,e,e[7],null);return{c(){t=E("div"),r=E("div"),n=E("div"),i=E("h1"),o=U(e[1]),l=G(),f&&f.c(),u=G(),h&&h.c(),P(i,"class","govuk-heading-l"),ee(n,"display","flex"),ee(n,"justify-content","space-between"),P(r,"class","content centered-fullscreen svelte-1st8ub0"),P(t,"class","background svelte-1st8ub0"),C(t,"open",e[0]),C(t,"closed",!e[0])},m(g,y){F(g,t,y),_(t,r),_(r,n),_(n,i),_(i,o),_(n,l),f&&f.m(n,null),_(r,u),h&&h.m(r,null),a=!0,s||(c=[J(r,"click",Ct(Ir)),J(t,"click",e[6])],s=!0)},p(g,[y]){(!a||y&2)&&V(o,g[1]),g[2]?f?(f.p(g,y),y&4&&N(f,1)):(f=Ve(g),f.c(),N(f,1),f.m(n,null)):f&&(Ot(),I(f,1,1,()=>{f=null}),Ft()),h&&h.p&&(!a||y&128)&&be(h,d,g,g[7],a?Pe(d,g[7],y,null):_e(g[7]),null),(!a||y&1)&&C(t,"open",g[0]),(!a||y&1)&&C(t,"closed",!g[0])},i(g){a||(N(f),N(h,g),a=!0)},o(g){I(f),I(h,g),a=!1},d(g){g&&L(t),f&&f.d(),h&&h.d(g),s=!1,ae(c)}}}const Ir=()=>null;function Ur(e,t,r){let{$$slots:n={},$$scope:i}=t,{title:o}=t,{open:l=!1}=t,{displayEscapeButton:u=!0}=t,{canCloseByClickingBackground:a=!0}=t;const s=()=>r(0,l=!1),c=()=>{a&&r(0,l=!1)};return e.$$set=f=>{"title"in f&&r(1,o=f.title),"open"in f&&r(0,l=f.open),"displayEscapeButton"in f&&r(2,u=f.displayEscapeButton),"canCloseByClickingBackground"in f&&r(3,a=f.canCloseByClickingBackground),"$$scope"in f&&r(7,i=f.$$scope)},[l,o,u,a,n,s,c,i]}class rn extends j{constructor(t){super(),$(this,t,Ur,Nr,x,{title:1,open:0,displayEscapeButton:2,canCloseByClickingBackground:3})}}async function nn(){let t=await(await fetch(qr)).json();return Lr(t)}function on(){if(window.location.hostname=="localhost")return"Local development";if(window.location.hostname=="acteng.github.io"){let e=window.location.pathname.split("/");if(e.length==3&&e[0]==""&&e[1]=="atip")return"Public (development)";if(e.length==4&&e[0]==""&&e[1]=="atip")return`Public (dev branch: ${e[2]})`}else if(window.location.hostname.endsWith(".appspot.com"))return"Private (development)";return"Unknown"}async function ln(e,t){let r=await fetch(e),n=r.body.getReader(),i=r.headers.get("Content-Length");if(!i)throw new Error(`No Content-Length header from ${e}`);let o=parseInt(i),l=0,u=[];for(;;){let{done:c,value:f}=await n.read();if(c)break;f&&(u.push(f),l+=f.length,t(100*l/o))}let a=new Uint8Array(l),s=0;for(let c of u)a.set(c,s),s+=c.length;return a}function an(e){let t=e.split("_");if(t.length==2){if(t[0]=="LAD")return`${t[1]} (LAD)`;if(t[0]=="TA")return`${t[1]} (Transport Authority)`}return e}function sn(){return"https://atip.uk/layers"}function un(){return"https://atip.uk/private_layers"}function ye(e,t){return`sketch/${e}/${t}`}function bt(e,t){try{window.localStorage.setItem(e,t)}catch(r){console.log(`Couldn't set local storage for ${e}: ${r}`),window.alert("Your changes couldn't be saved because you've run out of local storage. Please fix this problem on the next page and try again."),window.location.href="local_storage.html"}}function Jr(e,t,r){return`scheme.html?authority=${e}&schema=${r}&file=${t}`}function fn(e){let t=`sketch/${e}/`,r=[];for(let n=0;n<window.localStorage.length;n++){let i=window.localStorage.key(n);if(i.startsWith(t)){let o="v1";try{o=Pt(JSON.parse(window.localStorage.getItem(i)))}catch{}r.push([i.slice(t.length),o])}}return r.sort(),r}function cn(){let e=new Map;for(let r=0;r<window.localStorage.length;r++){let i=window.localStorage.key(r).split("/");if(i.length==3&&i[0]=="sketch"){let o=i[1],l=e.has(o)?e.get(o):0;e.set(o,l+1)}}let t=[...e.entries()];return t.sort((r,n)=>n[1]-r[1]),t}function Tr(e,t){let r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)}function gn(e){let t=[];for(let r=0;r<window.localStorage.length;r++){let n=window.localStorage.key(r);n==e?t.push([n,ye(e,"v1 sketch")]):n==`${e}_pipeline`&&t.push([n,ye(e,"pipeline sketch")])}for(let[r,n]of t){console.log(`Renaming ${r} to ${n}`);try{let i=window.localStorage.getItem(r);bt(n,i),window.localStorage.removeItem(r)}catch(i){console.error(`Couldn't importOldFiles: ${i}`)}}}function _t(e,t){var n;let r=JSON.parse(JSON.stringify(t));for(let i of r.features)(n=i.properties)==null||delete n.hide_while_editing;return r.authority=e,r.origin="atip-v2",r}function hn(e,t,r){let n=_t(e,r);Tr(`${e}_${t}.geojson`,JSON.stringify(n,null,"  "))}function Pt(e){try{let t=Object.values(e.schemes)[0];if(t&&Object.hasOwn(t,"pipeline"))return"pipeline";if(t&&Object.hasOwn(t,"v2"))return"v2"}catch{}return"v1"}function dn(e,t,r){let n=JSON.parse(t),i=Br(n.features,r);if(!i)throw new Error("Can't figure out the authority boundary that fully contains this scheme");n.authority=i;let o=Pt(n),l=Vr(n.authority,e);return bt(ye(n.authority,l),JSON.stringify(_t(n.authority,n))),Jr(n.authority,l,o)}function Vr(e,t){let r=De(De(t,".json"),".geojson");return Dr(r,`${e}_`)}function Dr(e,t){return e.startsWith(t)?e.slice(t.length):e}function De(e,t){return e.endsWith(t)?e.slice(0,-t.length):e}export{Ke as A,Kr as B,Hr as C,ze as D,It as E,Wr as F,sn as G,un as H,ln as I,on as J,ar as K,rn as M,Xr as R,Yt as S,dn as a,Tr as b,cn as c,an as d,Fe as e,_t as f,nn as g,ye as h,gn as i,Jr as j,hn as k,fn as l,tn as m,Zr as n,zt as o,Yr as p,T as q,en as r,bt as s,xr as t,jr as u,$r as v,W as w,Y as x,Qr as y,X as z};
