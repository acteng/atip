import{S as ve,i as be,s as we,e as A,l as ke,a as g,b as B,c as k,n as Y,d as y,A as ye,L as Le,E as me,D as Ce,R as Me,f as Z,g as x,F as Be,M as Te,h as d,j as Ee,k as Ie,m as u,o as _,t as p,p as $,q as Oe,r as ee,u as h,v as He,w as Fe,x as ce,y as Ge,z as H,G as Je,B as Ne,C as Pe,H as je,I as De,J as Re,K as ge,N as qe,O as Ue,P as Ve,Q as ze,T as de}from"./index-a2375654.js";import{A as Ke,P as Qe}from"./Popup-f4c3384c.js";import{B as We,A as Xe}from"./About-71d232f8.js";function Ye(s){let t,r,n;return{c(){t=A("div"),t.innerHTML=`<img src="${ke}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,r=g(),n=A("div"),B(t,"class","black-bar svelte-13flgp1"),B(n,"class","green-bar svelte-13flgp1")},m(l,e){k(l,t,e),k(l,r,e),k(l,n,e)},p:Y,i:Y,o:Y,d(l){l&&(y(t),y(r),y(n))}}}class Ze extends ve{constructor(t){super(),be(this,t,null,Ye,we,{})}}function xe(s){let t;return{c(){t=H("About")},m(r,n){k(r,t,n)},d(r){r&&y(t)}}}function et(s){let t;return{c(){t=H("Open Scheme Browser")},m(r,n){k(r,t,n)},d(r){r&&y(t)}}}function tt(s){let t,r,n,l;return t=new ce({props:{$$slots:{default:[xe]},$$scope:{ctx:s}}}),t.$on("click",s[8]),n=new ce({props:{$$slots:{default:[et]},$$scope:{ctx:s}}}),n.$on("click",Ge),{c(){d(t.$$.fragment),r=g(),d(n.$$.fragment)},m(e,a){_(t,e,a),k(e,r,a),_(n,e,a),l=!0},p(e,a){const m={};a&262144&&(m.$$scope={dirty:a,ctx:e}),t.$set(m);const i={};a&262144&&(i.$$scope={dirty:a,ctx:e}),n.$set(i)},i(e){l||(p(t.$$.fragment,e),p(n.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),$(n.$$.fragment,e),l=!1},d(e){e&&y(r),h(t,e),h(n,e)}}}function _e(s){let t,r,n;function l(a){s[9](a)}let e={label:"Select Transport Authority or Local Authority District",options:s[1].features.map(he)};return s[0]!==void 0&&(e.value=s[0]),t=new Ke({props:e}),Z.push(()=>x(t,"value",l)),{c(){d(t.$$.fragment)},m(a,m){_(t,a,m),n=!0},p(a,m){const i={};m&2&&(i.options=a[1].features.map(he)),!r&&m&1&&(r=!0,i.value=a[0],ee(()=>r=!1)),t.$set(i)},i(a){n||(p(t.$$.fragment,a),n=!0)},o(a){$(t.$$.fragment,a),n=!1},d(a){h(t,a)}}}function nt(s){let t;return{c(){t=H("Start")},m(r,n){k(r,t,n)},d(r){r&&y(t)}}}function rt(s){let t,r=s[17].name+"",n,l,e=s[17].level+"",a,m;return{c(){t=A("p"),n=H(r),l=H(" ("),a=H(e),m=H(")")},m(i,v){k(i,t,v),u(t,n),u(t,l),u(t,a),u(t,m)},p(i,v){v&131072&&r!==(r=i[17].name+"")&&de(n,r),v&131072&&e!==(e=i[17].level+"")&&de(a,e)},d(i){i&&y(t)}}}function st(s){let t,r;return t=new Qe({props:{$$slots:{default:[rt,({props:n})=>({17:n}),({props:n})=>n?131072:0]},$$scope:{ctx:s}}}),{c(){d(t.$$.fragment)},m(n,l){_(t,n,l),r=!0},p(n,l){const e={};l&393216&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){r||(p(t.$$.fragment,n),r=!0)},o(n){$(t.$$.fragment,n),r=!1},d(n){h(t,n)}}}function at(s){let t,r,n,l;return t=new qe({props:{id:"boundaries",filter:["==",["get","level"],s[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":Ue(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[st]},$$scope:{ctx:s}}}),t.$on("click",s[7]),n=new Ve({props:{id:"boundaries-outline",filter:["==",["get","level"],s[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){d(t.$$.fragment),r=g(),d(n.$$.fragment)},m(e,a){_(t,e,a),k(e,r,a),_(n,e,a),l=!0},p(e,a){const m={};a&16&&(m.filter=["==",["get","level"],e[4]]),a&262144&&(m.$$scope={dirty:a,ctx:e}),t.$set(m);const i={};a&16&&(i.filter=["==",["get","level"],e[4]]),n.$set(i)},i(e){l||(p(t.$$.fragment,e),p(n.$$.fragment,e),l=!0)},o(e){$(t.$$.fragment,e),$(n.$$.fragment,e),l=!1},d(e){e&&y(r),h(t,e),h(n,e)}}}function ot(s){let t,r;return t=new Je({props:{data:s[1],generateId:!0,$$slots:{default:[at]},$$scope:{ctx:s}}}),{c(){d(t.$$.fragment)},m(n,l){_(t,n,l),r=!0},p(n,l){const e={};l&2&&(e.data=n[1]),l&262160&&(e.$$scope={dirty:l,ctx:n}),t.$set(e)},i(n){r||(p(t.$$.fragment,n),r=!0)},o(n){$(t.$$.fragment,n),r=!1},d(n){h(t,n)}}}function lt(s){let t,r,n,l,e,a,m,i,v,J,T,R,N,q,L,U,C,V,P,f,E,w,j,S,I,te,ne,re,F,se,G,ae,z,D,O,Q,M,W,K;n=new Ze({}),a=new ye({}),v=new Le({}),L=new We({props:{$$slots:{default:[tt]},$$scope:{ctx:s}}}),C=new me({props:{errorMessage:s[3]}});let c=s[1].features.length>0&&_e(s);f=new Ce({props:{disabled:!s[5],$$slots:{default:[nt]},$$scope:{ctx:s}}}),f.$on("click",s[10]);function Ae(o){s[11](o)}let oe={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};s[4]!==void 0&&(oe.value=s[4]),S=new Me({props:oe}),Z.push(()=>x(S,"value",Ae)),F=new me({props:{errorMessage:ut}}),G=new Be({props:{label:"Or upload an ATIP GeoJSON file",onLoad:s[6]}}),O=new Te({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[ot]},$$scope:{ctx:s}}});function Se(o){s[12](o)}let le={};return s[2]!==void 0&&(le.open=s[2]),M=new Xe({props:le}),Z.push(()=>x(M,"open",Se)),{c(){t=A("div"),r=A("div"),d(n.$$.fragment),l=g(),e=A("div"),d(a.$$.fragment),m=g(),i=A("div"),d(v.$$.fragment),J=g(),T=A("p"),T.textContent=`App version: ${Ee()}`,R=g(),N=A("h1"),N.textContent="Scheme Sketcher",q=g(),d(L.$$.fragment),U=g(),d(C.$$.fragment),V=g(),c&&c.c(),P=g(),d(f.$$.fragment),E=g(),w=A("hr"),j=g(),d(S.$$.fragment),te=g(),ne=A("hr"),re=g(),d(F.$$.fragment),se=g(),d(G.$$.fragment),ae=g(),z=A("div"),D=A("div"),d(O.$$.fragment),Q=g(),d(M.$$.fragment),Ie(i,"border-bottom","1px solid #b1b4b6"),B(e,"class","left svelte-lyn11h"),B(r,"class","govuk-grid-column-one-half govuk-prose"),B(D,"id","map"),B(D,"class","svelte-lyn11h"),B(z,"class","govuk-grid-column-one-half"),B(t,"class","govuk-grid-row")},m(o,b){k(o,t,b),u(t,r),_(n,r,null),u(r,l),u(r,e),_(a,e,null),u(e,m),u(e,i),_(v,i,null),u(i,J),u(i,T),u(e,R),u(e,N),u(e,q),_(L,e,null),u(e,U),_(C,e,null),u(e,V),c&&c.m(e,null),u(e,P),_(f,e,null),u(e,E),u(e,w),u(e,j),_(S,e,null),u(e,te),u(e,ne),u(e,re),_(F,e,null),u(e,se),_(G,e,null),u(t,ae),u(t,z),u(z,D),_(O,D,null),k(o,Q,b),_(M,o,b),K=!0},p(o,[b]){const ue={};b&262148&&(ue.$$scope={dirty:b,ctx:o}),L.$set(ue);const ie={};b&8&&(ie.errorMessage=o[3]),C.$set(ie),o[1].features.length>0?c?(c.p(o,b),b&2&&p(c,1)):(c=_e(o),c.c(),p(c,1),c.m(e,P)):c&&(Ne(),$(c,1,1,()=>{c=null}),Oe());const X={};b&32&&(X.disabled=!o[5]),b&262144&&(X.$$scope={dirty:b,ctx:o}),f.$set(X);const fe={};!I&&b&16&&(I=!0,fe.value=o[4],ee(()=>I=!1)),S.$set(fe);const pe={};b&262162&&(pe.$$scope={dirty:b,ctx:o}),O.$set(pe);const $e={};!W&&b&4&&(W=!0,$e.open=o[2],ee(()=>W=!1)),M.$set($e)},i(o){K||(p(n.$$.fragment,o),p(a.$$.fragment,o),p(v.$$.fragment,o),p(L.$$.fragment,o),p(C.$$.fragment,o),p(c),p(f.$$.fragment,o),p(S.$$.fragment,o),p(F.$$.fragment,o),p(G.$$.fragment,o),p(O.$$.fragment,o),p(M.$$.fragment,o),K=!0)},o(o){$(n.$$.fragment,o),$(a.$$.fragment,o),$(v.$$.fragment,o),$(L.$$.fragment,o),$(C.$$.fragment,o),$(c),$(f.$$.fragment,o),$(S.$$.fragment,o),$(F.$$.fragment,o),$(G.$$.fragment,o),$(O.$$.fragment,o),$(M.$$.fragment,o),K=!1},d(o){o&&(y(t),y(Q)),h(n),h(a),h(v),h(L),h(C),c&&c.d(),h(f),h(S),h(F),h(G),h(O),h(M,o)}}}let ut="";const he=s=>[s.properties.full_name,`${s.properties.name} (${s.properties.level})`];function it(s,t,r){let n,l;He(s,ze,f=>r(13,l=f));let e={type:"FeatureCollection",features:[]},a=!1,i=new URLSearchParams(window.location.search).get("error")||"",v,J=new Set,T="TA";Fe(async()=>{Pe(),r(1,e=await je());for(let f of e.features)J.add(f.properties.full_name)});function R(f,E){try{let w=JSON.parse(E),j=De(w.features,e);if(!j)throw new Error("Can't figure out the authority boundary that fully contains this scheme");w.authority=j;let S=w.authority,I=N(w);I!="v1"&&(S+=`_${I}`),Re(S,JSON.stringify(w)),window.location.href=`scheme.html?authority=${w.authority}&schema=${I}`}catch(w){r(3,i=`Couldn't load scheme from a file: ${w}`)}}function N(f){if(f.features.length>0){let E=f.features[0].properties;for(let w of["pipeline"])if(E&&w in E)return w}return l}function q(f){ge(f.detail.features[0].properties.full_name)}const L=()=>r(2,a=!a);function U(f){v=f,r(0,v)}const C=()=>ge(v);function V(f){T=f,r(4,T)}function P(f){a=f,r(2,a)}return s.$$.update=()=>{s.$$.dirty&1&&r(5,n=J.has(v))},[v,e,a,i,T,n,R,q,L,U,C,V,P]}class ft extends ve{constructor(t){super(),be(this,t,it,lt,we,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new ft({target:document.getElementById("app")});
