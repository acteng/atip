import{S as Se,i as ke,s as ye,e as A,l as Me,a as g,b as M,c as L,n as x,d as C,A as Te,L as Ee,f as _e,o as Be,E as he,D as Ie,R as Oe,g as ee,h as te,F as He,M as Fe,j as _,k as Je,m as Ne,p as u,q as h,t as p,r as $,u as Pe,v as ne,w as v,x as je,y as De,z as F,G as Ge,B as Re,C as qe,H as Ue,I as Ve,J as ze,K as ve,N as Ke,O as Qe,P as We,Q as Xe,T as be}from"./index-ee681ccd.js";import{A as Ye,P as Ze}from"./Popup-cce14d71.js";import{A as xe}from"./About-5c95b584.js";function et(a){let e,r,n;return{c(){e=A("div"),e.innerHTML=`<img src="${Me}" alt="Active Travel England logo" class="svelte-13flgp1"/>`,r=g(),n=A("div"),M(e,"class","black-bar svelte-13flgp1"),M(n,"class","green-bar svelte-13flgp1")},m(l,t){L(l,e,t),L(l,r,t),L(l,n,t)},p:x,i:x,o:x,d(l){l&&(C(e),C(r),C(n))}}}class tt extends Se{constructor(e){super(),ke(this,e,null,et,ye,{})}}function nt(a){let e;return{c(){e=F("About")},m(r,n){L(r,e,n)},d(r){r&&C(e)}}}function rt(a){let e;return{c(){e=F("Open Scheme Browser")},m(r,n){L(r,e,n)},d(r){r&&C(e)}}}function we(a){let e,r,n;function l(o){a[9](o)}let t={label:"Select Transport Authority or Local Authority District",options:a[1].features.map(Ae)};return a[0]!==void 0&&(t.value=a[0]),e=new Ye({props:t}),ee.push(()=>te(e,"value",l)),{c(){_(e.$$.fragment)},m(o,b){h(e,o,b),n=!0},p(o,b){const i={};b&2&&(i.options=o[1].features.map(Ae)),!r&&b&1&&(r=!0,i.value=o[0],ne(()=>r=!1)),e.$set(i)},i(o){n||(p(e.$$.fragment,o),n=!0)},o(o){$(e.$$.fragment,o),n=!1},d(o){v(e,o)}}}function at(a){let e;return{c(){e=F("Start")},m(r,n){L(r,e,n)},d(r){r&&C(e)}}}function st(a){let e,r=a[17].name+"",n,l,t=a[17].level+"",o,b;return{c(){e=A("p"),n=F(r),l=F(" ("),o=F(t),b=F(")")},m(i,d){L(i,e,d),u(e,n),u(e,l),u(e,o),u(e,b)},p(i,d){d&131072&&r!==(r=i[17].name+"")&&be(n,r),d&131072&&t!==(t=i[17].level+"")&&be(o,t)},d(i){i&&C(e)}}}function ot(a){let e,r;return e=new Ze({props:{$$slots:{default:[st,({props:n})=>({17:n}),({props:n})=>n?131072:0]},$$scope:{ctx:a}}}),{c(){_(e.$$.fragment)},m(n,l){h(e,n,l),r=!0},p(n,l){const t={};l&393216&&(t.$$scope={dirty:l,ctx:n}),e.$set(t)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){$(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function lt(a){let e,r,n,l;return e=new Ke({props:{id:"boundaries",filter:["==",["get","level"],a[4]],paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":Qe(0,.5)},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[ot]},$$scope:{ctx:a}}}),e.$on("click",a[7]),n=new We({props:{id:"boundaries-outline",filter:["==",["get","level"],a[4]],paint:{"line-color":"rgb(200, 100, 240)","line-width":2.5},manageHoverState:!0}}),{c(){_(e.$$.fragment),r=g(),_(n.$$.fragment)},m(t,o){h(e,t,o),L(t,r,o),h(n,t,o),l=!0},p(t,o){const b={};o&16&&(b.filter=["==",["get","level"],t[4]]),o&262144&&(b.$$scope={dirty:o,ctx:t}),e.$set(b);const i={};o&16&&(i.filter=["==",["get","level"],t[4]]),n.$set(i)},i(t){l||(p(e.$$.fragment,t),p(n.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),$(n.$$.fragment,t),l=!1},d(t){t&&C(r),v(e,t),v(n,t)}}}function ut(a){let e,r;return e=new Ge({props:{data:a[1],generateId:!0,$$slots:{default:[lt]},$$scope:{ctx:a}}}),{c(){_(e.$$.fragment)},m(n,l){h(e,n,l),r=!0},p(n,l){const t={};l&2&&(t.data=n[1]),l&262160&&(t.$$scope={dirty:l,ctx:n}),e.$set(t)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){$(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function it(a){let e,r,n,l,t,o,b,i,d,j,I,q,D,U,T,k,V,y,z,f,O,w,S,G,J,re,E,W,ae,se,oe,N,le,P,ue,K,R,H,X,B,Y,Q;n=new tt({}),o=new Te({}),d=new Ee({}),k=new _e({props:{$$slots:{default:[nt]},$$scope:{ctx:a}}}),k.$on("click",a[8]),y=new _e({props:{$$slots:{default:[rt]},$$scope:{ctx:a}}}),y.$on("click",Be),f=new he({props:{errorMessage:a[3]}});let m=a[1].features.length>0&&we(a);S=new Ie({props:{disabled:!a[5],$$slots:{default:[at]},$$scope:{ctx:a}}}),S.$on("click",a[10]);function Le(s){a[11](s)}let ie={label:"Or pick from the map",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};a[4]!==void 0&&(ie.value=a[4]),E=new Oe({props:ie}),ee.push(()=>te(E,"value",Le)),N=new he({props:{errorMessage:ft}}),P=new He({props:{label:"Or upload an ATIP GeoJSON file",onLoad:a[6]}}),H=new Fe({props:{style:"streets",startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[ut]},$$scope:{ctx:a}}});function Ce(s){a[12](s)}let fe={};return a[2]!==void 0&&(fe.open=a[2]),B=new xe({props:fe}),ee.push(()=>te(B,"open",Ce)),{c(){e=A("div"),r=A("div"),_(n.$$.fragment),l=g(),t=A("div"),_(o.$$.fragment),b=g(),i=A("div"),_(d.$$.fragment),j=g(),I=A("p"),I.textContent=`App version: ${Je()}`,q=g(),D=A("h1"),D.textContent="Scheme Sketcher",U=g(),T=A("div"),_(k.$$.fragment),V=g(),_(y.$$.fragment),z=g(),_(f.$$.fragment),O=g(),m&&m.c(),w=g(),_(S.$$.fragment),G=g(),J=A("hr"),re=g(),_(E.$$.fragment),ae=g(),se=A("hr"),oe=g(),_(N.$$.fragment),le=g(),_(P.$$.fragment),ue=g(),K=A("div"),R=A("div"),_(H.$$.fragment),X=g(),_(B.$$.fragment),Ne(i,"border-bottom","1px solid #b1b4b6"),M(T,"class","govuk-button-group"),M(t,"class","left svelte-lyn11h"),M(r,"class","govuk-grid-column-one-half govuk-prose"),M(R,"id","map"),M(R,"class","svelte-lyn11h"),M(K,"class","govuk-grid-column-one-half"),M(e,"class","govuk-grid-row")},m(s,c){L(s,e,c),u(e,r),h(n,r,null),u(r,l),u(r,t),h(o,t,null),u(t,b),u(t,i),h(d,i,null),u(i,j),u(i,I),u(t,q),u(t,D),u(t,U),u(t,T),h(k,T,null),u(T,V),h(y,T,null),u(t,z),h(f,t,null),u(t,O),m&&m.m(t,null),u(t,w),h(S,t,null),u(t,G),u(t,J),u(t,re),h(E,t,null),u(t,ae),u(t,se),u(t,oe),h(N,t,null),u(t,le),h(P,t,null),u(e,ue),u(e,K),u(K,R),h(H,R,null),L(s,X,c),h(B,s,c),Q=!0},p(s,[c]){const pe={};c&262144&&(pe.$$scope={dirty:c,ctx:s}),k.$set(pe);const $e={};c&262144&&($e.$$scope={dirty:c,ctx:s}),y.$set($e);const me={};c&8&&(me.errorMessage=s[3]),f.$set(me),s[1].features.length>0?m?(m.p(s,c),c&2&&p(m,1)):(m=we(s),m.c(),p(m,1),m.m(t,w)):m&&(Re(),$(m,1,1,()=>{m=null}),Pe());const Z={};c&32&&(Z.disabled=!s[5]),c&262144&&(Z.$$scope={dirty:c,ctx:s}),S.$set(Z);const ce={};!W&&c&16&&(W=!0,ce.value=s[4],ne(()=>W=!1)),E.$set(ce);const ge={};c&262162&&(ge.$$scope={dirty:c,ctx:s}),H.$set(ge);const de={};!Y&&c&4&&(Y=!0,de.open=s[2],ne(()=>Y=!1)),B.$set(de)},i(s){Q||(p(n.$$.fragment,s),p(o.$$.fragment,s),p(d.$$.fragment,s),p(k.$$.fragment,s),p(y.$$.fragment,s),p(f.$$.fragment,s),p(m),p(S.$$.fragment,s),p(E.$$.fragment,s),p(N.$$.fragment,s),p(P.$$.fragment,s),p(H.$$.fragment,s),p(B.$$.fragment,s),Q=!0)},o(s){$(n.$$.fragment,s),$(o.$$.fragment,s),$(d.$$.fragment,s),$(k.$$.fragment,s),$(y.$$.fragment,s),$(f.$$.fragment,s),$(m),$(S.$$.fragment,s),$(E.$$.fragment,s),$(N.$$.fragment,s),$(P.$$.fragment,s),$(H.$$.fragment,s),$(B.$$.fragment,s),Q=!1},d(s){s&&(C(e),C(X)),v(n),v(o),v(d),v(k),v(y),v(f),m&&m.d(),v(S),v(E),v(N),v(P),v(H),v(B,s)}}}let ft="";const Ae=a=>[a.properties.full_name,`${a.properties.name} (${a.properties.level})`];function pt(a,e,r){let n,l;je(a,Xe,f=>r(13,l=f));let t={type:"FeatureCollection",features:[]},o=!1,i=new URLSearchParams(window.location.search).get("error")||"",d,j=new Set,I="TA";De(async()=>{qe(),r(1,t=await Ue());for(let f of t.features)j.add(f.properties.full_name)});function q(f,O){try{let w=JSON.parse(O),S=Ve(w.features,t);if(!S)throw new Error("Can't figure out the authority boundary that fully contains this scheme");w.authority=S;let G=w.authority,J=D(w);J!="v1"&&(G+=`_${J}`),ze(G,JSON.stringify(w)),window.location.href=`scheme.html?authority=${w.authority}&schema=${J}`}catch(w){r(3,i=`Couldn't load scheme from a file: ${w}`)}}function D(f){if(f.features.length>0){let O=f.features[0].properties;for(let w of["pipeline"])if(O&&w in O)return w}return l}function U(f){ve(f.detail.features[0].properties.full_name)}const T=()=>r(2,o=!o);function k(f){d=f,r(0,d)}const V=()=>ve(d);function y(f){I=f,r(4,I)}function z(f){o=f,r(2,o)}return a.$$.update=()=>{a.$$.dirty&1&&r(5,n=j.has(d))},[d,t,o,i,I,n,q,U,T,k,V,y,z]}class $t extends Se{constructor(e){super(),ke(this,e,pt,it,ye,{})}}document.body.className+=" js-enabled"+("noModule"in HTMLScriptElement.prototype?" govuk-frontend-supported":"");new $t({target:document.getElementById("app")});
