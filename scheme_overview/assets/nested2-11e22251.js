import{S as M,i as N,s as T,d as S,m as C,n as h,o as g,q as k,e as _,f as L,g as F,h as m,l as E,E as J,p as I,c as w,U as G,V as H,L as P,t as b,A as O}from"./maplibre_helpers-a0686a8c.js";import{L as R,F as U,h as V,g as z,C as D,I as K,M as Q}from"./InterventionLayer-62805ef7.js";function q(o,e,l){const t=o.slice();return t[4]=e[l],t}function W(o){let e,l,t,n;return{c(){e=_("div"),l=_("button"),l.textContent="Home",L(l,"type","button"),L(e,"slot","nav")},m(r,f){F(r,e,f),m(e,l),t||(n=E(l,"click",o[2]),t=!0)},p:J,d(r){r&&I(e),t=!1,n()}}}function X(o){let e,l,t,n=o[4].file_name+"",r,f,p,u,s=o[4].scheme_priority+"",$,a,c,i,v=o[4].authority_code+"",j,B;return{c(){e=_("ul"),l=_("li"),t=b("Filename: "),r=b(n),f=w(),p=_("li"),u=b("Priority: "),$=b(s),a=w(),c=_("li"),i=b("Authority code: "),j=b(v),B=w()},m(d,y){F(d,e,y),m(e,l),m(l,t),m(l,r),m(e,f),m(e,p),m(p,u),m(p,$),m(e,a),m(e,c),m(c,i),m(c,j),F(d,B,y)},p(d,y){y&1&&n!==(n=d[4].file_name+"")&&O(r,n),y&1&&s!==(s=d[4].scheme_priority+"")&&O($,s),y&1&&v!==(v=d[4].authority_code+"")&&O(j,v)},d(d){d&&I(e),d&&I(B)}}}function A(o){let e,l;return e=new D({props:{label:`${o[4].internal_scheme_id}: ${o[4].num_features} features`,$$slots:{default:[X]},$$scope:{ctx:o}}}),{c(){S(e.$$.fragment)},m(t,n){C(e,t,n),l=!0},p(t,n){const r={};n&1&&(r.label=`${t[4].internal_scheme_id}: ${t[4].num_features} features`),n&129&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){l||(h(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){k(e,t)}}}function Y(o){let e,l,t,n,r,f,p;n=new U({props:{label:"Load from GeoJSON",uniqueId:"load_geojson",loadFile:o[1]}});let u=o[0],s=[];for(let a=0;a<u.length;a+=1)s[a]=A(q(o,u,a));const $=a=>g(s[a],1,1,()=>{s[a]=null});return{c(){e=_("div"),l=_("h1"),l.textContent="Browse schemes",t=w(),S(n.$$.fragment),r=w(),f=_("ul");for(let a=0;a<s.length;a+=1)s[a].c();L(e,"slot","sidebar")},m(a,c){F(a,e,c),m(e,l),m(e,t),C(n,e,null),m(e,r),m(e,f);for(let i=0;i<s.length;i+=1)s[i].m(f,null);p=!0},p(a,c){if(c&1){u=a[0];let i;for(i=0;i<u.length;i+=1){const v=q(a,u,i);s[i]?(s[i].p(v,c),h(s[i],1)):(s[i]=A(v),s[i].c(),h(s[i],1),s[i].m(f,null))}for(G(),i=u.length;i<s.length;i+=1)$(i);H()}},i(a){if(!p){h(n.$$.fragment,a);for(let c=0;c<u.length;c+=1)h(s[c]);p=!0}},o(a){g(n.$$.fragment,a),s=s.filter(Boolean);for(let c=0;c<s.length;c+=1)g(s[c]);p=!1},d(a){a&&I(e),k(n),P(s,a)}}}function Z(o){let e,l,t,n;return e=new K({props:{schema:"v1"}}),t=new Q({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:te}}),{c(){S(e.$$.fragment),l=w(),S(t.$$.fragment)},m(r,f){C(e,r,f),F(r,l,f),C(t,r,f),n=!0},p:J,i(r){n||(h(e.$$.fragment,r),h(t.$$.fragment,r),n=!0)},o(r){g(e.$$.fragment,r),g(t.$$.fragment,r),n=!1},d(r){k(e,r),r&&I(l),k(t,r)}}}function x(o){let e,l,t;return l=new V({props:{style:"streets",$$slots:{default:[Z]},$$scope:{ctx:o}}}),{c(){e=_("div"),S(l.$$.fragment),L(e,"slot","main")},m(n,r){F(n,e,r),C(l,e,null),t=!0},p(n,r){const f={};r&128&&(f.$$scope={dirty:r,ctx:n}),l.$set(f)},i(n){t||(h(l.$$.fragment,n),t=!0)},o(n){g(l.$$.fragment,n),t=!1},d(n){n&&I(e),k(l)}}}function ee(o){let e,l;return e=new R({props:{$$slots:{main:[x],sidebar:[Y],nav:[W]},$$scope:{ctx:o}}}),{c(){S(e.$$.fragment)},m(t,n){C(e,t,n),l=!0},p(t,[n]){const r={};n&129&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){l||(h(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){k(e,t)}}}function te(o){return JSON.stringify(o)}function ne(o,e,l){let t=[];function n(p){const u=new FileReader;u.onload=$=>{try{let a=JSON.parse($.target.result);z.set(a),r(a)}catch(a){window.alert(`Couldn't load schemes from a file: ${a}`)}};let s=p.target.files;u.readAsText(s[0])}function r(p){var s;let u={};for(let $ of p.features){let a=$.properties;u[s=a.atip_file_name]||(u[s]={file_name:a.atip_file_name,authority_code:a.authority_code,internal_scheme_id:a.internal_scheme_id,scheme_priority:a.scheme_priority,num_features:0}),u[a.atip_file_name].num_features++}l(0,t=Object.values(u))}return[t,n,()=>window.open("index.html")]}class le extends M{constructor(e){super(),N(this,e,ne,ee,T,{})}}new le({target:document.getElementById("app")});
