import{S as M,i as G,s as T,d as S,m as C,n as d,o as h,q as k,e as _,f as j,g as B,h as m,l as A,G as J,p as I,F as E,c as w,V as H,W as P,N as V,t as b,B as N}from"./FileInput-ddab9480.js";import{L as W,h as z,g as D,C as K,I as Q,M as R}from"./InterventionLayer-20c61f5b.js";function O(s,e,l){const t=s.slice();return t[4]=e[l],t}function U(s){let e,l,t,n;return{c(){e=_("div"),l=_("button"),l.textContent="Home",j(l,"type","button"),j(e,"slot","nav")},m(r,f){B(r,e,f),m(e,l),t||(n=A(l,"click",s[2]),t=!0)},p:J,d(r){r&&I(e),t=!1,n()}}}function X(s){let e,l,t,n=s[4].file_name+"",r,f,p,u,a=s[4].scheme_priority+"",g,o,c,i,v=s[4].authority_code+"",F,L;return{c(){e=_("ul"),l=_("li"),t=b("Filename: "),r=b(n),f=w(),p=_("li"),u=b("Priority: "),g=b(a),o=w(),c=_("li"),i=b("Authority code: "),F=b(v),L=w()},m($,y){B($,e,y),m(e,l),m(l,t),m(l,r),m(e,f),m(e,p),m(p,u),m(p,g),m(e,o),m(e,c),m(c,i),m(c,F),B($,L,y)},p($,y){y&1&&n!==(n=$[4].file_name+"")&&N(r,n),y&1&&a!==(a=$[4].scheme_priority+"")&&N(g,a),y&1&&v!==(v=$[4].authority_code+"")&&N(F,v)},d($){$&&I(e),$&&I(L)}}}function q(s){let e,l;return e=new K({props:{label:`${s[4].internal_scheme_id}: ${s[4].num_features} features`,$$slots:{default:[X]},$$scope:{ctx:s}}}),{c(){S(e.$$.fragment)},m(t,n){C(e,t,n),l=!0},p(t,n){const r={};n&1&&(r.label=`${t[4].internal_scheme_id}: ${t[4].num_features} features`),n&129&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){l||(d(e.$$.fragment,t),l=!0)},o(t){h(e.$$.fragment,t),l=!1},d(t){k(e,t)}}}function Y(s){let e,l,t,n,r,f,p;n=new E({props:{label:"Load from GeoJSON",uniqueId:"load_geojson",loadFile:s[1]}});let u=s[0],a=[];for(let o=0;o<u.length;o+=1)a[o]=q(O(s,u,o));const g=o=>h(a[o],1,1,()=>{a[o]=null});return{c(){e=_("div"),l=_("h1"),l.textContent="Browse schemes",t=w(),S(n.$$.fragment),r=w(),f=_("ul");for(let o=0;o<a.length;o+=1)a[o].c();j(e,"slot","sidebar")},m(o,c){B(o,e,c),m(e,l),m(e,t),C(n,e,null),m(e,r),m(e,f);for(let i=0;i<a.length;i+=1)a[i].m(f,null);p=!0},p(o,c){if(c&1){u=o[0];let i;for(i=0;i<u.length;i+=1){const v=O(o,u,i);a[i]?(a[i].p(v,c),d(a[i],1)):(a[i]=q(v),a[i].c(),d(a[i],1),a[i].m(f,null))}for(H(),i=u.length;i<a.length;i+=1)g(i);P()}},i(o){if(!p){d(n.$$.fragment,o);for(let c=0;c<u.length;c+=1)d(a[c]);p=!0}},o(o){h(n.$$.fragment,o),a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)h(a[c]);p=!1},d(o){o&&I(e),k(n),V(a,o)}}}function Z(s){let e,l,t,n;return e=new Q({props:{schema:"v1"}}),t=new R({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:te}}),{c(){S(e.$$.fragment),l=w(),S(t.$$.fragment)},m(r,f){C(e,r,f),B(r,l,f),C(t,r,f),n=!0},p:J,i(r){n||(d(e.$$.fragment,r),d(t.$$.fragment,r),n=!0)},o(r){h(e.$$.fragment,r),h(t.$$.fragment,r),n=!1},d(r){k(e,r),r&&I(l),k(t,r)}}}function x(s){let e,l,t;return l=new z({props:{style:"streets",$$slots:{default:[Z]},$$scope:{ctx:s}}}),{c(){e=_("div"),S(l.$$.fragment),j(e,"slot","main")},m(n,r){B(n,e,r),C(l,e,null),t=!0},p(n,r){const f={};r&128&&(f.$$scope={dirty:r,ctx:n}),l.$set(f)},i(n){t||(d(l.$$.fragment,n),t=!0)},o(n){h(l.$$.fragment,n),t=!1},d(n){n&&I(e),k(l)}}}function ee(s){let e,l;return e=new W({props:{$$slots:{main:[x],sidebar:[Y],nav:[U]},$$scope:{ctx:s}}}),{c(){S(e.$$.fragment)},m(t,n){C(e,t,n),l=!0},p(t,[n]){const r={};n&129&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){l||(d(e.$$.fragment,t),l=!0)},o(t){h(e.$$.fragment,t),l=!1},d(t){k(e,t)}}}function te(s){return JSON.stringify(s)}function ne(s,e,l){let t=[];function n(p){try{let u=JSON.parse(p);D.set(u),r(u)}catch(u){window.alert(`Couldn't load schemes from a file: ${u}`)}}function r(p){var a;let u={};for(let g of p.features){let o=g.properties;u[a=o.atip_file_name]||(u[a]={file_name:o.atip_file_name,authority_code:o.authority_code,internal_scheme_id:o.internal_scheme_id,scheme_priority:o.scheme_priority,num_features:0}),u[o.atip_file_name].num_features++}l(0,t=Object.values(u))}return[t,n,()=>window.open("index.html")]}class le extends M{constructor(e){super(),G(this,e,ne,ee,T,{})}}new le({target:document.getElementById("app")});
