import{S as I,i as N,s as E,d as C,m as k,n as h,o as v,q as F,H,e as d,f as B,g as S,h as u,l as R,E as A,p as L,c as w,U as G,V as K,L as U,J as V,K as W,O as z,a6 as D,a9 as Q,a8 as X,a7 as Y,t as b,A as P}from"./maplibre_helpers-8102a46e.js";import{L as Z,F as x,h as ee,C as te,M as ne,m as le,l as re,e as ae}from"./CollapsibleCard-49a92dc5.js";function j(s,e,n){const t=s.slice();return t[6]=e[n],t}function oe(s){let e,n,t,l;return{c(){e=d("div"),n=d("button"),n.textContent="Home",B(n,"type","button"),B(e,"slot","nav")},m(i,f){S(i,e,f),u(e,n),t||(l=R(n,"click",s[2]),t=!0)},p:A,d(i){i&&L(e),t=!1,l()}}}function se(s){let e,n,t,l=s[6].file_name+"",i,f,p,_,r=s[6].scheme_priority+"",m,o,c,a,g=s[6].authority_code+"",J,M;return{c(){e=d("ul"),n=d("li"),t=b("Filename: "),i=b(l),f=w(),p=d("li"),_=b("Priority: "),m=b(r),o=w(),c=d("li"),a=b("Authority code: "),J=b(g),M=w()},m($,y){S($,e,y),u(e,n),u(n,t),u(n,i),u(e,f),u(e,p),u(p,_),u(p,m),u(e,o),u(e,c),u(c,a),u(c,J),S($,M,y)},p($,y){y&1&&l!==(l=$[6].file_name+"")&&P(i,l),y&1&&r!==(r=$[6].scheme_priority+"")&&P(m,r),y&1&&g!==(g=$[6].authority_code+"")&&P(J,g)},d($){$&&L(e),$&&L(M)}}}function q(s){let e,n;return e=new te({props:{label:`${s[6].internal_scheme_id}: ${s[6].num_features} features`,$$slots:{default:[se]},$$scope:{ctx:s}}}),{c(){C(e.$$.fragment)},m(t,l){k(e,t,l),n=!0},p(t,l){const i={};l&1&&(i.label=`${t[6].internal_scheme_id}: ${t[6].num_features} features`),l&513&&(i.$$scope={dirty:l,ctx:t}),e.$set(i)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ie(s){let e,n,t,l,i,f,p;l=new x({props:{label:"Load from GeoJSON",uniqueId:"load_geojson",loadFile:s[1]}});let _=s[0],r=[];for(let o=0;o<_.length;o+=1)r[o]=q(j(s,_,o));const m=o=>v(r[o],1,1,()=>{r[o]=null});return{c(){e=d("div"),n=d("h1"),n.textContent="Browse schemes",t=w(),C(l.$$.fragment),i=w(),f=d("ul");for(let o=0;o<r.length;o+=1)r[o].c();B(e,"slot","sidebar")},m(o,c){S(o,e,c),u(e,n),u(e,t),k(l,e,null),u(e,i),u(e,f);for(let a=0;a<r.length;a+=1)r[a].m(f,null);p=!0},p(o,c){if(c&1){_=o[0];let a;for(a=0;a<_.length;a+=1){const g=j(o,_,a);r[a]?(r[a].p(g,c),h(r[a],1)):(r[a]=q(g),r[a].c(),h(r[a],1),r[a].m(f,null))}for(G(),a=_.length;a<r.length;a+=1)m(a);K()}},i(o){if(!p){h(l.$$.fragment,o);for(let c=0;c<_.length;c+=1)h(r[c]);p=!0}},o(o){v(l.$$.fragment,o),r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)v(r[c]);p=!1},d(o){o&&L(e),F(l),U(r,o)}}}function ce(s){let e,n;return e=new ne({props:{layers:["interventions-points","interventions-lines","interventions-polygons"],contents:me}}),{c(){C(e.$$.fragment)},m(t,l){k(e,t,l),n=!0},p:A,i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ue(s){let e,n,t;return n=new ee({props:{style:"streets",$$slots:{default:[ce]},$$scope:{ctx:s}}}),{c(){e=d("div"),C(n.$$.fragment),B(e,"slot","main")},m(l,i){S(l,e,i),k(n,e,null),t=!0},p(l,i){const f={};i&512&&(f.$$scope={dirty:i,ctx:l}),n.$set(f)},i(l){t||(h(n.$$.fragment,l),t=!0)},o(l){v(n.$$.fragment,l),t=!1},d(l){l&&L(e),F(n)}}}function fe(s){let e,n;return e=new Z({props:{$$slots:{main:[ue],sidebar:[ie],nav:[oe]},$$scope:{ctx:s}}}),{c(){C(e.$$.fragment)},m(t,l){k(e,t,l),n=!0},p(t,[l]){const i={};l&513&&(i.$$scope={dirty:l,ctx:t}),e.$set(i)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}const O="all-schemes",T="black";function me(s){return JSON.stringify(s)}function pe(s,e,n){let t;H(s,le,r=>n(3,t=r));let l=[];function i(r){const m=new FileReader;m.onload=c=>{try{let a=JSON.parse(c.target.result);f(a),p(a)}catch(a){window.alert(`Couldn't load schemes from a file: ${a}`)}};let o=r.target.files;m.readAsText(o[0])}function f(r){V(t,O,r),W(t,{id:"interventions-polygons",source:O,filter:Q,color:T,opacity:.5}),z(t,{id:"interventions-lines",source:O,filter:X,color:T,width:re}),D(t,{id:"interventions-points",source:O,filter:Y,color:T,radius:ae})}function p(r){var o;let m={};for(let c of r.features){let a=c.properties;m[o=a.atip_file_name]||(m[o]={file_name:a.atip_file_name,authority_code:a.authority_code,internal_scheme_id:a.internal_scheme_id,scheme_priority:a.scheme_priority,num_features:0}),m[a.atip_file_name].num_features++}n(0,l=Object.values(m))}return[l,i,()=>window.open("index.html")]}class _e extends I{constructor(e){super(),N(this,e,pe,fe,E,{})}}new _e({target:document.getElementById("app")});
