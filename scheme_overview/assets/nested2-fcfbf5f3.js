import{S as J,i as N,s as E,d as C,m as k,n as h,o as y,q as F,H,e as _,f as P,g as S,h as u,l as R,E as I,p as L,c as v,W,X as G,M as X,a8 as z,L as D,a7 as K,P as Q,a5 as U,a6 as V,t as w,A as O}from"./maplibre_helpers-79179479.js";import{L as Y,F as Z,h as x,C as ee,M as te,m as le,l as ae,e as ne}from"./CollapsibleCard-79efbdf3.js";function q(s,e,l){const t=s.slice();return t[6]=e[l],t}function oe(s){let e,l,t,a;return{c(){e=_("div"),l=_("button"),l.textContent="Home",P(l,"type","button"),P(e,"slot","nav")},m(i,f){S(i,e,f),u(e,l),t||(a=R(l,"click",s[2]),t=!0)},p:I,d(i){i&&L(e),t=!1,a()}}}function re(s){let e,l,t,a=s[6].file_name+"",i,f,p,d,n=s[6].scheme_priority+"",m,r,c,o,g=s[6].authority_code+"",j,B;return{c(){e=_("ul"),l=_("li"),t=w("Filename: "),i=w(a),f=v(),p=_("li"),d=w("Priority: "),m=w(n),r=v(),c=_("li"),o=w("Authority code: "),j=w(g),B=v()},m($,b){S($,e,b),u(e,l),u(l,t),u(l,i),u(e,f),u(e,p),u(p,d),u(p,m),u(e,r),u(e,c),u(c,o),u(c,j),S($,B,b)},p($,b){b&1&&a!==(a=$[6].file_name+"")&&O(i,a),b&1&&n!==(n=$[6].scheme_priority+"")&&O(m,n),b&1&&g!==(g=$[6].authority_code+"")&&O(j,g)},d($){$&&L(e),$&&L(B)}}}function A(s){let e,l;return e=new ee({props:{label:`${s[6].internal_scheme_id}: ${s[6].num_features} features`,$$slots:{default:[re]},$$scope:{ctx:s}}}),{c(){C(e.$$.fragment)},m(t,a){k(e,t,a),l=!0},p(t,a){const i={};a&1&&(i.label=`${t[6].internal_scheme_id}: ${t[6].num_features} features`),a&513&&(i.$$scope={dirty:a,ctx:t}),e.$set(i)},i(t){l||(h(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){F(e,t)}}}function se(s){let e,l,t,a,i,f,p;a=new Z({props:{label:"Load from GeoJSON",uniqueId:"load_geojson",loadFile:s[1]}});let d=s[0],n=[];for(let r=0;r<d.length;r+=1)n[r]=A(q(s,d,r));const m=r=>y(n[r],1,1,()=>{n[r]=null});return{c(){e=_("div"),l=_("h1"),l.textContent="Browse schemes",t=v(),C(a.$$.fragment),i=v(),f=_("ul");for(let r=0;r<n.length;r+=1)n[r].c();P(e,"slot","sidebar")},m(r,c){S(r,e,c),u(e,l),u(e,t),k(a,e,null),u(e,i),u(e,f);for(let o=0;o<n.length;o+=1)n[o].m(f,null);p=!0},p(r,c){if(c&1){d=r[0];let o;for(o=0;o<d.length;o+=1){const g=q(r,d,o);n[o]?(n[o].p(g,c),h(n[o],1)):(n[o]=A(g),n[o].c(),h(n[o],1),n[o].m(f,null))}for(W(),o=d.length;o<n.length;o+=1)m(o);G()}},i(r){if(!p){h(a.$$.fragment,r);for(let c=0;c<d.length;c+=1)h(n[c]);p=!0}},o(r){y(a.$$.fragment,r),n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)y(n[c]);p=!1},d(r){r&&L(e),F(a),X(n,r)}}}function ie(s){let e,l;return e=new te({props:{layers:["points","lines","polygons"],contents:fe}}),{c(){C(e.$$.fragment)},m(t,a){k(e,t,a),l=!0},p:I,i(t){l||(h(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){F(e,t)}}}function ce(s){let e,l,t;return l=new x({props:{style:"streets",$$slots:{default:[ie]},$$scope:{ctx:s}}}),{c(){e=_("div"),C(l.$$.fragment),P(e,"slot","main")},m(a,i){S(a,e,i),k(l,e,null),t=!0},p(a,i){const f={};i&512&&(f.$$scope={dirty:i,ctx:a}),l.$set(f)},i(a){t||(h(l.$$.fragment,a),t=!0)},o(a){y(l.$$.fragment,a),t=!1},d(a){a&&L(e),F(l)}}}function ue(s){let e,l;return e=new Y({props:{$$slots:{main:[ce],sidebar:[se],nav:[oe]},$$scope:{ctx:s}}}),{c(){C(e.$$.fragment)},m(t,a){k(e,t,a),l=!0},p(t,[a]){const i={};a&513&&(i.$$scope={dirty:a,ctx:t}),e.$set(i)},i(t){l||(h(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){F(e,t)}}}const M="all-schemes",T="black";function fe(s){return JSON.stringify(s)}function me(s,e,l){let t;H(s,le,n=>l(3,t=n));let a=[];function i(n){const m=new FileReader;m.onload=c=>{try{let o=JSON.parse(c.target.result);f(o),p(o)}catch(o){window.alert(`Couldn't load schemes from a file: ${o}`)}};let r=n.target.files;m.readAsText(r[0])}function f(n){t.addSource(M,{type:"geojson",data:n}),t.addLayer({id:"polygons",source:M,filter:z,...D(T,.5)}),t.addLayer({id:"lines",source:M,filter:K,...Q(T,ae)}),t.addLayer({id:"points",source:M,filter:U,...V(T,ne)})}function p(n){var r;let m={};for(let c of n.features){let o=c.properties;m[r=o.atip_file_name]||(m[r]={file_name:o.atip_file_name,authority_code:o.authority_code,internal_scheme_id:o.internal_scheme_id,scheme_priority:o.scheme_priority,num_features:0}),m[o.atip_file_name].num_features++}l(0,a=Object.values(m))}return[a,i,()=>window.open("index.html")]}class pe extends J{constructor(e){super(),N(this,e,me,ue,E,{})}}new pe({target:document.getElementById("app")});
