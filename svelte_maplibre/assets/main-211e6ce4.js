import{s as Ke,w as re,r as Se,g as xe,S as ie,i as le,a as te,e as ge,b as P,t as y,c as fe,d as C,f as ue,h as j,j as Xe,k as H,o as me,l as ae,n as Qe,m as Ce,u as ke,p as ve,q as Le,v as ce,x as _e,y as J,z as V,A as he,B as W,C as we,D as ye,E as $e,F as oe,G as ee,H as Oe,I as Me,J as et,K as q,L as tt,M as ot,N as nt,O as D,P as rt,Q as Ie,R as it,T as Ne,U as lt,V as ft,W as ut,X as st}from"./stores-880f1ada.js";import{a as at,D as ct,R as mt,A as dt}from"./About-5d271526.js";let _t=Date.now();function Te(n){return`${n}-${_t++}`}const Ze=Symbol.for("svelte-maplibre");function be(){return xe(Ze)}function ht(){return Ke(Ze,{map:re(null),source:Se(null),layer:Se(null),popupTarget:Se(null),cluster:re(),loadedImages:re(new Set),minzoom:re(0),maxzoom:re(24),layerEvent:re(null)})}function Fe(n){return{subscribe:n.subscribe}}function Ye({key:n,setPopupTarget:e=!1,setCluster:o=!1,setMouseEvent:t=!1}){let i=be(),r=re(null),l=Fe(r),f={...i,[n]:Fe(r)};if(e&&(f.popupTarget=l),t){let s=re(null);f.layerEvent=s,i.layerEvent=s}return o&&(f.cluster=re()),Ke(Ze,f),{...i,self:r}}function gt(){return Ye({key:"source",setCluster:!0})}function yt(){return Ye({key:"layer",setPopupTarget:!0,setMouseEvent:!0})}function Ee(n){let e;return o=>{if(o)for(let t in o){let i=e==null?void 0:e[t],r=o[t];i!==r&&n(t,r,i)}else if(e)for(let t in e)n(t,void 0,e[t]);e=o}}function bt(n,...e){let o=[n];for(let t of e)if(t)Array.isArray(t)&&t[0]===n?o.push(...t.slice(1)):o.push(t);else continue;if(o.length!==1)return o.length===2?o[1]:o}function wt(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function Ct(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}var Ae=kt;function kt(n){var e,o,t;if(n){if(Array.isArray(n)){for(e=[],o=n.length,t=0;t<o;t++){var i=n[t];i!=null&&e.push(i)}return e}if(typeof n=="object"){e={};var r=Object.keys(n);for(o=r.length,t=0;t<o;t++){var l=r[t],f=n[l];f!=null&&(e[l]=f)}return e}}}function Pe(n){let e=n[0],o,t,i=je(n);return{c(){i.c(),o=ge()},m(r,l){i.m(r,l),P(r,o,l),t=!0},p(r,l){l[0]&1&&te(e,e=r[0])?(fe(),C(i,1,1,Qe),ue(),i=je(r),i.c(),y(i,1),i.m(o.parentNode,o)):i.p(r,l)},i(r){t||(y(i),t=!0)},o(r){C(i),t=!1},d(r){r&&j(o),i.d(r)}}}function je(n){let e;const o=n[34].default,t=Ce(o,n,n[33],null);return{c(){t&&t.c()},m(i,r){t&&t.m(i,r),e=!0},p(i,r){t&&t.p&&(!e||r[1]&4)&&ke(t,o,i,i[33],e?Le(o,i[33],r,null):ve(i[33]),null)},i(i){e||(y(t,i),e=!0)},o(i){C(t,i),e=!1},d(i){t&&t.d(i)}}}function vt(n){let e,o,t=n[0]&&Pe(n);return{c(){t&&t.c(),e=ge()},m(i,r){t&&t.m(i,r),P(i,e,r),o=!0},p(i,r){i[0]?t?(t.p(i,r),r[0]&1&&y(t,1)):(t=Pe(i),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(fe(),C(t,1,1,()=>{t=null}),ue())},i(i){o||(y(t),o=!0)},o(i){C(t),o=!1},d(i){i&&j(e),t&&t.d(i)}}}function Lt(n,e,o){let t,i,r,l,f,s,c,a,m,g,k,_,{$$slots:Z={},$$scope:A}=e,{id:I=Te("layer")}=e,{source:T=void 0}=e,{sourceLayer:F=void 0}=e,{beforeId:b=void 0}=e,{beforeLayerType:O=void 0}=e,{type:h}=e,{paint:U=void 0}=e,{layout:N=void 0}=e,{filter:L=void 0}=e,{applyToClusters:z=void 0}=e,{minzoom:B=void 0}=e,{maxzoom:M=void 0}=e,{manageHoverState:G=!0}=e,{hovered:v=null}=e,{hoverCursor:X=void 0}=e;const ne=Xe(),{map:E,source:d,self:S,minzoom:Q,maxzoom:se}=yt();H(n,E,u=>o(29,m=u)),H(n,d,u=>o(30,g=u)),H(n,S,u=>o(0,a=u)),H(n,Q,u=>o(32,_=u)),H(n,se,u=>o(31,k=u)),me(()=>{a&&m&&(m==null||m.removeLayer(a))});let Y;return n.$$set=u=>{"id"in u&&o(7,I=u.id),"source"in u&&o(8,T=u.source),"sourceLayer"in u&&o(9,F=u.sourceLayer),"beforeId"in u&&o(10,b=u.beforeId),"beforeLayerType"in u&&o(11,O=u.beforeLayerType),"type"in u&&o(12,h=u.type),"paint"in u&&o(13,U=u.paint),"layout"in u&&o(14,N=u.layout),"filter"in u&&o(15,L=u.filter),"applyToClusters"in u&&o(16,z=u.applyToClusters),"minzoom"in u&&o(17,B=u.minzoom),"maxzoom"in u&&o(18,M=u.maxzoom),"manageHoverState"in u&&o(19,G=u.manageHoverState),"hovered"in u&&o(6,v=u.hovered),"hoverCursor"in u&&o(20,X=u.hoverCursor),"$$scope"in u&&o(33,A=u.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&65536&&o(28,t=wt(z)),n.$$.dirty[0]&268468224&&o(27,i=bt("all",t,L)),n.$$.dirty[0]&131072|n.$$.dirty[1]&2&&o(23,r=B??_),n.$$.dirty[0]&262144|n.$$.dirty[1]&1&&o(22,l=M??k),n.$$.dirty[0]&1073742080&&o(26,f=T||g),n.$$.dirty[0]&754482817&&m&&a!==I&&f){let u=b;if(!b&&O){let w=m.getStyle().layers,R=typeof O=="function"?O:x=>x.type===O,p=w==null?void 0:w.find(R);p&&(u=p.id)}ae(S,a=I,a),m.addLayer(Ae({id:a,type:h,source:f,"source-layer":F,filter:i,paint:U,layout:N,minzoom:r,maxzoom:l}),u),m.on("click",a,w=>{var $,K;if(!a||!m)return;let R=w.features??[],p=(K=($=R[0])==null?void 0:$.properties)==null?void 0:K.cluster_id;ne("click",{event:w,map:m,clusterId:p,layer:a,source:f,features:R})}),m.on("mouseenter",a,w=>{var $,K;if(!a||!m)return;X&&(m.getCanvas().style.cursor=X);let R=w.features??[];o(6,v=R[0]??null);let p=(K=($=R[0])==null?void 0:$.properties)==null?void 0:K.cluster_id;ne("mouseenter",{event:w,map:m,clusterId:p,layer:a,source:f,features:R})}),m.on("mousemove",a,w=>{var $,K,de;let R=w.features??[],p=(K=($=R[0])==null?void 0:$.properties)==null?void 0:K.cluster_id,x=(de=R[0])==null?void 0:de.id;x!==Y&&(G&&(Y!==void 0&&(m==null||m.setFeatureState({source:f,id:Y},{hover:!1})),m==null||m.setFeatureState({source:f,id:x},{hover:!0})),o(21,Y=x),o(6,v=R[0]??null)),ne("mousemove",{event:w,map:m,clusterId:p,layer:a,source:f,features:R})}),m.on("mouseleave",a,()=>{!a||!m||(X&&(m.getCanvas().style.cursor=""),o(6,v=null),G&&Y!==void 0&&(m==null||m.setFeatureState({source:f,id:Y},{hover:!1}),o(21,Y=void 0)),ne("mouseleave",{map:m,layer:a,source:f}))})}n.$$.dirty[0]&536870913&&o(25,s=a?Ee((u,w)=>m==null?void 0:m.setPaintProperty(a,u,w)):void 0),n.$$.dirty[0]&536870913&&o(24,c=a?Ee((u,w)=>m==null?void 0:m.setLayoutProperty(a,u,w)):void 0),n.$$.dirty[0]&33562624&&(s==null||s(U)),n.$$.dirty[0]&16793600&&(c==null||c(N)),n.$$.dirty[0]&549453825&&a&&(m==null||m.setLayerZoomRange(a,r,l))},[a,E,d,S,Q,se,v,I,T,F,b,O,h,U,N,L,z,B,M,G,X,Y,l,r,c,s,f,i,t,m,g,k,_,A,Z]}class St extends ie{constructor(e){super(),le(this,e,Lt,vt,te,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,hoverCursor:20},null,[-1,-1])}}function zt(n){let e;const o=n[12].default,t=Ce(o,n,n[18],null);return{c(){t&&t.c()},m(i,r){t&&t.m(i,r),e=!0},p(i,r){t&&t.p&&(!e||r&262144)&&ke(t,o,i,i[18],e?Le(o,i[18],r,null):ve(i[18]),null)},i(i){e||(y(t,i),e=!0)},o(i){C(t,i),e=!1},d(i){t&&t.d(i)}}}function At(n){let e,o,t;function i(l){n[13](l)}let r={id:n[1],type:"fill",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],$$slots:{default:[zt]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.hovered=n[0]),e=new St({props:r}),ce.push(()=>_e(e,"hovered",i)),e.$on("click",n[14]),e.$on("mouseenter",n[15]),e.$on("mousemove",n[16]),e.$on("mouseleave",n[17]),{c(){J(e.$$.fragment)},m(l,f){V(e,l,f),t=!0},p(l,[f]){const s={};f&2&&(s.id=l[1]),f&4&&(s.source=l[2]),f&8&&(s.sourceLayer=l[3]),f&16&&(s.beforeId=l[4]),f&32&&(s.beforeLayerType=l[5]),f&64&&(s.paint=l[6]),f&128&&(s.layout=l[7]),f&256&&(s.filter=l[8]),f&512&&(s.minzoom=l[9]),f&1024&&(s.maxzoom=l[10]),f&2048&&(s.hoverCursor=l[11]),f&262144&&(s.$$scope={dirty:f,ctx:l}),!o&&f&1&&(o=!0,s.hovered=l[0],he(()=>o=!1)),e.$set(s)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function It(n,e,o){let{$$slots:t={},$$scope:i}=e,{id:r=Te("fill")}=e,{source:l=void 0}=e,{sourceLayer:f=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:c=void 0}=e,{paint:a}=e,{layout:m=void 0}=e,{filter:g=void 0}=e,{minzoom:k=void 0}=e,{maxzoom:_=void 0}=e,{hoverCursor:Z=void 0}=e,{hovered:A=null}=e;function I(h){A=h,o(0,A)}function T(h){we.call(this,n,h)}function F(h){we.call(this,n,h)}function b(h){we.call(this,n,h)}function O(h){we.call(this,n,h)}return n.$$set=h=>{"id"in h&&o(1,r=h.id),"source"in h&&o(2,l=h.source),"sourceLayer"in h&&o(3,f=h.sourceLayer),"beforeId"in h&&o(4,s=h.beforeId),"beforeLayerType"in h&&o(5,c=h.beforeLayerType),"paint"in h&&o(6,a=h.paint),"layout"in h&&o(7,m=h.layout),"filter"in h&&o(8,g=h.filter),"minzoom"in h&&o(9,k=h.minzoom),"maxzoom"in h&&o(10,_=h.maxzoom),"hoverCursor"in h&&o(11,Z=h.hoverCursor),"hovered"in h&&o(0,A=h.hovered),"$$scope"in h&&o(18,i=h.$$scope)},[A,r,l,f,s,c,a,m,g,k,_,Z,t,I,T,F,b,O,i]}class Tt extends ie{constructor(e){super(),le(this,e,It,At,te,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,hovered:0})}}function Zt(n,e,o){let t;const{map:i}=be();H(n,i,s=>o(4,t=s));let{position:r="top-left"}=e,{container:l=void 0}=e,f=null;return me(()=>{t!=null&&t.loaded()&&f&&t.removeControl(f)}),n.$$set=s=>{"position"in s&&o(1,r=s.position),"container"in s&&o(2,l=s.container)},n.$$.update=()=>{if(n.$$.dirty&30&&t&&!f){let s;typeof l=="string"?s=document.querySelector(l)??void 0:s=l,o(3,f=new ye.FullscreenControl({container:s})),t.addControl(f,r)}},[i,r,l,f,t]}class Bt extends ie{constructor(e){super(),le(this,e,Zt,null,te,{position:1,container:2})}}function De(n){let e=n[0],o,t,i=qe(n);return{c(){i.c(),o=ge()},m(r,l){i.m(r,l),P(r,o,l),t=!0},p(r,l){l&1&&te(e,e=r[0])?(fe(),C(i,1,1,Qe),ue(),i=qe(r),i.c(),y(i,1),i.m(o.parentNode,o)):i.p(r,l)},i(r){t||(y(i),t=!0)},o(r){C(i),t=!1},d(r){r&&j(o),i.d(r)}}}function qe(n){let e;const o=n[15].default,t=Ce(o,n,n[14],null);return{c(){t&&t.c()},m(i,r){t&&t.m(i,r),e=!0},p(i,r){t&&t.p&&(!e||r&16384)&&ke(t,o,i,i[14],e?Le(o,i[14],r,null):ve(i[14]),null)},i(i){e||(y(t,i),e=!0)},o(i){C(t,i),e=!1},d(i){t&&t.d(i)}}}function Ot(n){let e,o,t=n[0]&&De(n);return{c(){t&&t.c(),e=ge()},m(i,r){t&&t.m(i,r),P(i,e,r),o=!0},p(i,[r]){i[0]?t?(t.p(i,r),r&1&&y(t,1)):(t=De(i),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(fe(),C(t,1,1,()=>{t=null}),ue())},i(i){o||(y(t),o=!0)},o(i){C(t),o=!1},d(i){i&&j(e),t&&t.d(i)}}}function Mt(n,e,o){let t,i,r,{$$slots:l={},$$scope:f}=e,{id:s=Te("geojson")}=e,{data:c}=e,{generateId:a=!1}=e,{promoteId:m=void 0}=e,{filter:g=void 0}=e,{lineMetrics:k=void 0}=e,{cluster:_=void 0}=e;const{map:Z,cluster:A,self:I}=gt();H(n,Z,b=>o(13,t=b)),H(n,A,b=>o(16,r=b)),H(n,I,b=>o(0,i=b));let T,F=!0;return me(()=>{if(i){let b=i;ae(I,i=null,i),o(11,T=void 0),$e().then(()=>{t!=null&&t.loaded()&&(t==null||t.removeSource(b))})}}),n.$$set=b=>{"id"in b&&o(4,s=b.id),"data"in b&&o(5,c=b.data),"generateId"in b&&o(6,a=b.generateId),"promoteId"in b&&o(7,m=b.promoteId),"filter"in b&&o(8,g=b.filter),"lineMetrics"in b&&o(9,k=b.lineMetrics),"cluster"in b&&o(10,_=b.cluster),"$$scope"in b&&o(14,f=b.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&ae(A,r=_,r),n.$$.dirty&10225&&t&&i!==s&&(i&&t.removeSource(i),ae(I,i=s,i),t.addSource(i,Ae({type:"geojson",data:c,filter:g,lineMetrics:k,generateId:a,promoteId:m,cluster:!!_,clusterMinPoints:_==null?void 0:_.minPoints,clusterMaxZoom:_==null?void 0:_.maxZoom,clusterRadius:_==null?void 0:_.radius,clusterProperties:_==null?void 0:_.properties})),o(11,T=t.getSource(i)),o(12,F=!0)),n.$$.dirty&6176&&T&&(F?o(12,F=!1):T.setData(c)),n.$$.dirty&3072&&(T==null||T.setClusterOptions(Ae({cluster:!!_,clusterMaxZoom:_==null?void 0:_.maxZoom,clusterRadius:_==null?void 0:_.radius})))},[i,Z,A,I,s,c,a,m,g,k,_,T,F,t,f,l]}class Nt extends ie{constructor(e){super(),le(this,e,Mt,Ot,te,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Ft(n,e,o){let t;const{map:i}=be();H(n,i,g=>o(8,t=g));let{position:r="top-left"}=e,{positionOptions:l=void 0}=e,{fitBoundsOptions:f=void 0}=e,{trackUserLocation:s=!1}=e,{showAccuracyCircle:c=!0}=e,{showUserLocation:a=!0}=e,m=null;return me(()=>{t!=null&&t.loaded()&&m&&t.removeControl(m)}),n.$$set=g=>{"position"in g&&o(1,r=g.position),"positionOptions"in g&&o(2,l=g.positionOptions),"fitBoundsOptions"in g&&o(3,f=g.fitBoundsOptions),"trackUserLocation"in g&&o(4,s=g.trackUserLocation),"showAccuracyCircle"in g&&o(5,c=g.showAccuracyCircle),"showUserLocation"in g&&o(6,a=g.showUserLocation)},n.$$.update=()=>{n.$$.dirty&510&&t&&!m&&(o(7,m=new ye.GeolocateControl({positionOptions:l,fitBoundsOptions:f,trackUserLocation:s,showAccuracyCircle:c,showUserLocation:a})),t.addControl(m,r))},[i,r,l,f,s,c,a,m,t]}class Et extends ie{constructor(e){super(),le(this,e,Ft,null,te,{position:1,positionOptions:2,fitBoundsOptions:3,trackUserLocation:4,showAccuracyCircle:5,showUserLocation:6})}}var ze=Be;function Be(n,e){return n===e||n!==n&&e!==e?!0:typeof n!=typeof e||{}.toString.call(n)!={}.toString.call(e)||n!==Object(n)||!n?!1:Array.isArray(n)?Re(n,e):{}.toString.call(n)=="[object Set]"?Re(Array.from(n),Array.from(e)):{}.toString.call(n)=="[object Object]"?jt(n,e):Pt(n,e)}function Pt(n,e){return n.toString()===e.toString()}function Re(n,e){var o=n.length;if(o!=e.length)return!1;for(var t=0;t<o;t++)if(!Be(n[t],e[t]))return!1;return!0}function jt(n,e){var o=Object.keys(n),t=o.length;if(t!=Object.keys(e).length)return!1;for(var i=0;i<t;i++){var r=o[i];if(!(e.hasOwnProperty(r)&&Be(n[r],e[r])))return!1}return!0}function Dt(n,e,o){let t;const{map:i}=be();H(n,i,a=>o(6,t=a));let{position:r="top-left"}=e,{showCompass:l=!0}=e,{showZoom:f=!0}=e,{visualizePitch:s=!1}=e,c=null;return me(()=>{t!=null&&t.loaded()&&c&&t.removeControl(c)}),n.$$set=a=>{"position"in a&&o(1,r=a.position),"showCompass"in a&&o(2,l=a.showCompass),"showZoom"in a&&o(3,f=a.showZoom),"visualizePitch"in a&&o(4,s=a.visualizePitch)},n.$$.update=()=>{n.$$.dirty&126&&t&&!c&&(o(5,c=new ye.NavigationControl({showCompass:l,showZoom:f,visualizePitch:s})),t.addControl(c,r))},[i,r,l,f,s,c,t]}class qt extends ie{constructor(e){super(),le(this,e,Dt,null,te,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function Rt(n,e,o){let t;const{map:i}=be();H(n,i,c=>o(5,t=c));let{position:r="bottom-left"}=e,{maxWidth:l=void 0}=e,{unit:f="metric"}=e,s=null;return me(()=>{t!=null&&t.loaded()&&s&&t.removeControl(s)}),n.$$set=c=>{"position"in c&&o(1,r=c.position),"maxWidth"in c&&o(2,l=c.maxWidth),"unit"in c&&o(3,f=c.unit)},n.$$.update=()=>{n.$$.dirty&62&&t&&!s&&(o(4,s=new ye.ScaleControl({maxWidth:l,unit:f})),t.addControl(s,r))},[i,r,l,f,s,t]}class Ut extends ie{constructor(e){super(),le(this,e,Rt,null,te,{position:1,maxWidth:2,unit:3})}}const Jt=n=>({map:n&8,loadedImages:n&16,allImagesLoaded:n&32}),Ue=n=>({map:n[3],loadedImages:n[4],allImagesLoaded:n[5]});function Je(n){let e,o,t=n[2]&&Ve(n);const i=n[27].default,r=Ce(i,n,n[26],Ue);return{c(){t&&t.c(),e=q(),r&&r.c()},m(l,f){t&&t.m(l,f),P(l,e,f),r&&r.m(l,f),o=!0},p(l,f){l[2]?t?(t.p(l,f),f&4&&y(t,1)):(t=Ve(l),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(fe(),C(t,1,1,()=>{t=null}),ue()),r&&r.p&&(!o||f&67108920)&&ke(r,i,l,l[26],o?Le(i,l[26],f,Jt):ve(l[26]),Ue)},i(l){o||(y(t),y(r,l),o=!0)},o(l){C(t),C(r,l),o=!1},d(l){l&&j(e),t&&t.d(l),r&&r.d(l)}}}function Ve(n){let e,o,t,i,r,l,f,s;return e=new qt({props:{position:n[6]}}),t=new Et({props:{position:n[6],fitBoundsOptions:{maxZoom:12}}}),r=new Bt({props:{position:n[6]}}),f=new Ut({props:{position:n[6]}}),{c(){J(e.$$.fragment),o=q(),J(t.$$.fragment),i=q(),J(r.$$.fragment),l=q(),J(f.$$.fragment)},m(c,a){V(e,c,a),P(c,o,a),V(t,c,a),P(c,i,a),V(r,c,a),P(c,l,a),V(f,c,a),s=!0},p(c,a){const m={};a&64&&(m.position=c[6]),e.$set(m);const g={};a&64&&(g.position=c[6]),t.$set(g);const k={};a&64&&(k.position=c[6]),r.$set(k);const _={};a&64&&(_.position=c[6]),f.$set(_)},i(c){s||(y(e.$$.fragment,c),y(t.$$.fragment,c),y(r.$$.fragment,c),y(f.$$.fragment,c),s=!0)},o(c){C(e.$$.fragment,c),C(t.$$.fragment,c),C(r.$$.fragment,c),C(f.$$.fragment,c),s=!1},d(c){c&&(j(o),j(i),j(l)),W(e,c),W(t,c),W(r,c),W(f,c)}}}function Vt(n){let e,o,t,i,r,l=n[3]&&n[0]&&Je(n);return{c(){e=oe("div"),l&&l.c(),ee(e,"class",o=Oe(n[1])+" svelte-p00lfq"),Me(e,"expand-map",!n[1])},m(f,s){P(f,e,s),l&&l.m(e,null),t=!0,i||(r=et(n[9].call(null,e)),i=!0)},p(f,[s]){f[3]&&f[0]?l?(l.p(f,s),s&9&&y(l,1)):(l=Je(f),l.c(),y(l,1),l.m(e,null)):l&&(fe(),C(l,1,1,()=>{l=null}),ue()),(!t||s&2&&o!==(o=Oe(f[1])+" svelte-p00lfq"))&&ee(e,"class",o),(!t||s&2)&&Me(e,"expand-map",!f[1])},i(f){t||(y(l),t=!0)},o(f){C(l),t=!1},d(f){f&&j(e),l&&l.d(),i=!1,r()}}}function Wt(n,e,o){let t,i,r,l,{$$slots:f={},$$scope:s}=e,{map:c=null}=e,{class:a=void 0}=e,{style:m}=e,{center:g=[0,0]}=e,{zoom:k=1}=e,{pitch:_=0}=e,{bearing:Z=0}=e,{bounds:A=void 0}=e,{loaded:I=!1}=e,{minZoom:T=0}=e,{maxZoom:F=22}=e,{interactive:b=!0}=e,{attributionControl:O=!0}=e,{preserveDrawingBuffer:h=!1}=e,{maxBounds:U=void 0}=e,{images:N=[]}=e,{standardControls:L=!1}=e,{filterLayers:z=void 0}=e,{transformRequest:B=void 0}=e;const M=Xe(),{map:G,loadedImages:v}=ht();H(n,G,d=>o(3,r=d)),H(n,v,d=>o(4,l=d));let X=new Set;function ne(d){r!=null&&r.loaded()&&("url"in d?(X.add(d.id),r.loadImage(d.url,(S,Q)=>{X.delete(d.id),S?M("error",S):Q&&(r==null||r.addImage(d.id,Q,d.options),l.add(d.id),v.set(l))})):(r.addImage(d.id,d.data,d.options),l.add(d.id),v.set(l)))}function E(d){return ae(G,r=new ye.Map({container:d,style:m,center:g,zoom:k,pitch:_,bearing:Z,minZoom:T,maxZoom:F,interactive:b,preserveDrawingBuffer:h,maxBounds:U,bounds:A,attributionControl:O,transformRequest:B}),r),r.on("load",S=>{o(0,I=!0),M("load",r)}),r.on("error",S=>M("error",{...S,map:r})),r.on("movestart",S=>M("movestart",{...S,map:r})),r.on("moveend",S=>{o(10,g=S.target.getCenter()),o(11,k=S.target.getZoom()),o(12,A=S.target.getBounds()),M("moveend",{...S,map:r})}),r.on("zoomstart",S=>M("zoomstart",{...S,map:r})),r.on("zoom",S=>{o(11,k=S.target.getZoom()),M("zoom",{...S,map:r})}),r.on("zoomend",S=>{o(11,k=S.target.getZoom()),M("zoomend",{...S,map:r})}),r.on("styledata",S=>{if(r&&z){const Q=r.getStyle().layers;if(Q)for(let se of Q)z(se)||r.setLayoutProperty(se.id,"visibility","none")}M("styledata",{...S,map:r})}),{destroy(){o(0,I=!1),r==null||r.remove(),ae(G,r=null,r)}}}return n.$$set=d=>{"map"in d&&o(13,c=d.map),"class"in d&&o(1,a=d.class),"style"in d&&o(14,m=d.style),"center"in d&&o(10,g=d.center),"zoom"in d&&o(11,k=d.zoom),"pitch"in d&&o(15,_=d.pitch),"bearing"in d&&o(16,Z=d.bearing),"bounds"in d&&o(12,A=d.bounds),"loaded"in d&&o(0,I=d.loaded),"minZoom"in d&&o(17,T=d.minZoom),"maxZoom"in d&&o(18,F=d.maxZoom),"interactive"in d&&o(19,b=d.interactive),"attributionControl"in d&&o(20,O=d.attributionControl),"preserveDrawingBuffer"in d&&o(21,h=d.preserveDrawingBuffer),"maxBounds"in d&&o(22,U=d.maxBounds),"images"in d&&o(23,N=d.images),"standardControls"in d&&o(2,L=d.standardControls),"filterLayers"in d&&o(24,z=d.filterLayers),"transformRequest"in d&&o(25,B=d.transformRequest),"$$scope"in d&&o(26,s=d.$$scope)},n.$$.update=()=>{if(n.$$.dirty&4&&o(6,t=typeof L=="boolean"?void 0:L),n.$$.dirty&8&&o(13,c=r),n.$$.dirty&8388617&&I&&r!=null&&r.loaded())for(let d of N)!X.has(d.id)&&!r.hasImage(d.id)&&ne(d);n.$$.dirty&8388624&&o(5,i=N.every(d=>l.has(d.id))),n.$$.dirty&1032&&g&&!ze(g,r==null?void 0:r.getCenter())&&(r==null||r.panTo(g)),n.$$.dirty&2056&&k&&!ze(k,r==null?void 0:r.getZoom())&&(r==null||r.zoomTo(k)),n.$$.dirty&4104&&A&&!ze(A,r==null?void 0:r.getBounds())&&(r==null||r.fitBounds(A))},[I,a,L,r,l,i,t,G,v,E,g,k,A,c,m,_,Z,T,F,b,O,h,U,N,z,B,s,f]}class Gt extends ie{constructor(e){super(),le(this,e,Wt,Vt,te,{map:13,class:1,style:14,center:10,zoom:11,pitch:15,bearing:16,bounds:12,loaded:0,minZoom:17,maxZoom:18,interactive:19,attributionControl:20,preserveDrawingBuffer:21,maxBounds:22,images:23,standardControls:2,filterLayers:24,transformRequest:25})}}async function Ht(){const e=await(await fetch(at)).text();return JSON.parse(e)}function Kt(n){let e;return{c(){e=Ie("About")},m(o,t){P(o,e,t)},d(o){o&&j(e)}}}function We(n){let e,o;return e=new it({props:{errorMessage:n[5]}}),{c(){J(e.$$.fragment)},m(t,i){V(e,t,i),o=!0},p(t,i){const r={};i&32&&(r.errorMessage=t[5]),e.$set(r)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){C(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Xt(n){let e,o,t,i,r;return{c(){e=oe("input"),o=q(),t=oe("datalist"),ee(e,"class","govuk-input govuk-input--width-20"),ee(e,"id","inputValue"),ee(e,"data-testid","transport-authority"),ee(e,"list","authorities-list"),ee(t,"id","authorities-list")},m(l,f){P(l,e,f),Ne(e,n[0]),P(l,o,f),P(l,t,f),n[15](t),i||(r=lt(e,"input",n[14]),i=!0)},p(l,f){f&1&&e.value!==l[0]&&Ne(e,l[0])},d(l){l&&(j(e),j(o),j(t)),n[15](null),i=!1,r()}}}function Qt(n){let e;return{c(){e=Ie("Start")},m(o,t){P(o,e,t)},d(o){o&&j(e)}}}function Ge(n){let e,o;return{c(){e=oe("i"),o=Ie(n[8])},m(t,i){P(t,e,i),D(e,o)},p(t,i){i&256&&ft(o,t[8])},d(t){t&&j(e)}}}function He(n){let e,o;return e=new Nt({props:{id:"authorities",data:n[2],generateId:!0,$$slots:{default:[Yt]},$$scope:{ctx:n}}}),{c(){J(e.$$.fragment)},m(t,i){V(e,t,i),o=!0},p(t,i){const r={};i&4&&(r.data=t[2]),i&4194440&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){C(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Yt(n){let e,o,t;function i(l){n[17](l)}let r={id:pe,paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":Ct(.4,.8)},filter:["==",["get","level"],n[7]]};return n[3]!==void 0&&(r.hovered=n[3]),e=new Tt({props:r}),ce.push(()=>_e(e,"hovered",i)),e.$on("click",eo),{c(){J(e.$$.fragment)},m(l,f){V(e,l,f),t=!0},p(l,f){const s={};f&128&&(s.filter=["==",["get","level"],l[7]]),!o&&f&8&&(o=!0,s.hovered=l[3],he(()=>o=!1)),e.$set(s)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function pt(n){let e,o,t=n[2]&&He(n);return{c(){t&&t.c(),e=ge()},m(i,r){t&&t.m(i,r),P(i,e,r),o=!0},p(i,r){i[2]?t?(t.p(i,r),r&4&&y(t,1)):(t=He(i),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(fe(),C(t,1,1,()=>{t=null}),ue())},i(i){o||(y(t),o=!0)},o(i){C(t),o=!1},d(i){i&&j(e),t&&t.d(i)}}}function xt(n){let e,o,t,i,r,l,f,s,c,a,m,g,k,_,Z,A,I,T,F,b,O,h,U,N,L,z,B,M,G;r=new tt({props:{$$slots:{default:[Kt]},$$scope:{ctx:n}}}),r.$on("click",n[13]);let v=n[5]&&We(n);s=new ot({props:{label:"Select Transport Authority or Local Authority District",id:"inputValue",$$slots:{default:[Xt]},$$scope:{ctx:n}}}),a=new ct({props:{disabled:!n[9],$$slots:{default:[Qt]},$$scope:{ctx:n}}}),a.$on("click",n[12]);function X(u){n[16](u)}let ne={legend:"Or pick from the map",id:"showBoundaries",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};n[7]!==void 0&&(ne.value=n[7]),_=new mt({props:ne}),ce.push(()=>_e(_,"value",X)),_.$on("change",n[10]);let E=n[8]&&Ge(n),d=$t;O=new nt({props:{label:"Or upload an ATIP GeoJSON file",loadFile:n[11],id:"load-geojson"}});function S(u){n[18](u)}let Q={style:"https://api.maptiler.com/maps/streets/style.json?key=MZEJTanw3WpxRvt7qDfo",$$slots:{default:[pt]},$$scope:{ctx:n}};n[1]!==void 0&&(Q.map=n[1]),N=new Gt({props:Q}),ce.push(()=>_e(N,"map",S));function se(u){n[19](u)}let Y={};return n[4]!==void 0&&(Y.open=n[4]),B=new dt({props:Y}),ce.push(()=>_e(B,"open",se)),{c(){e=oe("div"),o=oe("div"),t=oe("h1"),t.textContent="Welcome to ATIP v2",i=q(),J(r.$$.fragment),l=q(),v&&v.c(),f=q(),J(s.$$.fragment),c=q(),J(a.$$.fragment),m=q(),g=oe("hr"),k=q(),J(_.$$.fragment),A=q(),E&&E.c(),I=q(),T=oe("hr"),F=q(),b=q(),J(O.$$.fragment),h=q(),U=oe("div"),J(N.$$.fragment),z=q(),J(B.$$.fragment),ee(t,"class","govuk-heading-l"),ee(o,"class","govuk-grid-column-one-half left svelte-1qrinac"),ee(U,"class","govuk-grid-column-one-half map svelte-1qrinac"),ee(e,"class","govuk-grid-row")},m(u,w){P(u,e,w),D(e,o),D(o,t),D(o,i),V(r,o,null),D(o,l),v&&v.m(o,null),D(o,f),V(s,o,null),D(o,c),V(a,o,null),D(o,m),D(o,g),D(o,k),V(_,o,null),D(o,A),E&&E.m(o,null),D(o,I),D(o,T),D(o,F),D(o,b),V(O,o,null),D(e,h),D(e,U),V(N,U,null),P(u,z,w),V(B,u,w),G=!0},p(u,[w]){const R={};w&4194304&&(R.$$scope={dirty:w,ctx:u}),r.$set(R),u[5]?v?(v.p(u,w),w&32&&y(v,1)):(v=We(u),v.c(),y(v,1),v.m(o,f)):v&&(fe(),C(v,1,1,()=>{v=null}),ue());const p={};w&4194369&&(p.$$scope={dirty:w,ctx:u}),s.$set(p);const x={};w&512&&(x.disabled=!u[9]),w&4194304&&(x.$$scope={dirty:w,ctx:u}),a.$set(x);const $={};!Z&&w&128&&(Z=!0,$.value=u[7],he(()=>Z=!1)),_.$set($),u[8]?E?E.p(u,w):(E=Ge(u),E.c(),E.m(o,I)):E&&(E.d(1),E=null);const K={};w&4194444&&(K.$$scope={dirty:w,ctx:u}),!L&&w&2&&(L=!0,K.map=u[1],he(()=>L=!1)),N.$set(K);const de={};!M&&w&16&&(M=!0,de.open=u[4],he(()=>M=!1)),B.$set(de)},i(u){G||(y(r.$$.fragment,u),y(v),y(s.$$.fragment,u),y(a.$$.fragment,u),y(_.$$.fragment,u),y(d),y(O.$$.fragment,u),y(N.$$.fragment,u),y(B.$$.fragment,u),G=!0)},o(u){C(r.$$.fragment,u),C(v),C(s.$$.fragment,u),C(a.$$.fragment,u),C(_.$$.fragment,u),C(d),C(O.$$.fragment,u),C(N.$$.fragment,u),C(B.$$.fragment,u),G=!1},d(u){u&&(j(e),j(z)),W(r),v&&v.d(),W(s),W(a),W(_),E&&E.d(),W(O),W(N),W(B,u)}}}let $t="",pe="authorities-layer";function eo(n){let e=n.detail.features[0].properties.name;window.location.href=`scheme.html?authority=${e}`}function to(n){if(n.features.length>0){let e=n.features[0].properties;for(let o of["planning","v2","criticals"])if(e&&o in e)return o}return"v1"}function oo(n,e,o){let t,i,r=!1,f=new URLSearchParams(window.location.search).get("error")||"",s,c,a=new Set,m=null,g=null,k="TA";function _(){m==null||m.setFilter(pe,["==",["get","level"],k])}let Z=null;rt(async()=>{ut();const L=await Ht();for(let z of L.features){let B=document.createElement("option");B.value=z.properties.name,c.appendChild(B),a.add(z.properties.name)}o(2,g=L)});function A(L){try{let z=JSON.parse(L);if(!z.authority)throw new Error("File doesn't have an authority set; is it an ATIP file?");if(!a.has(z.authority))throw new Error(`Unknown authority ${z.authority}`);let B=z.authority,M=to(z);M!="v1"&&(B+=`_${M}`),window.localStorage.setItem(B,JSON.stringify(z)),window.location.href=`scheme.html?authority=${z.authority}&schema=${M}`}catch(z){o(5,f=`Couldn't load scheme from a file: ${z}`)}}function I(){window.location.href=`scheme.html?authority=${s}`}const T=()=>o(4,r=!r);function F(){s=this.value,o(0,s)}function b(L){ce[L?"unshift":"push"](()=>{c=L,o(6,c)})}function O(L){k=L,o(7,k)}function h(L){Z=L,o(3,Z)}function U(L){m=L,o(1,m)}function N(L){r=L,o(4,r)}return n.$$.update=()=>{n.$$.dirty&1&&o(9,t=a.has(s)),n.$$.dirty&8&&o(8,i=Z==null?void 0:Z.properties.name),n.$$.dirty&6&&m&&g&&m.fitBounds(st(g),{padding:20,animate:!1})},[s,m,g,Z,r,f,c,k,i,t,_,A,I,T,F,b,O,h,U,N]}class no extends ie{constructor(e){super(),le(this,e,oo,xt,te,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new no({target:document.getElementById("app")});
