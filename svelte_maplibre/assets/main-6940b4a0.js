import{s as Ye,w as ae,r as Oe,g as tt,S as le,i as fe,a as oe,e as de,b as q,t as y,c as ue,d as L,f as se,h as R,j as Qe,k as J,o as he,l as ce,n as pe,m as ge,u as ye,p as be,q as ke,v as me,x as we,y as K,z as X,A as Le,B as Y,C as Ce,D as re,E as ot,F as ne,G as te,H as Be,I as Ze,J as nt,K as G,L as rt,M as xe,N as it,O as lt,P as ft,Q as V,R as Ae,T as ut,U as Ee,V as st,W as at,X as ct,Y as mt}from"./stores-d88eef21.js";import{a as dt,D as ht,R as _t,A as gt}from"./About-3f55289d.js";let yt=Date.now();function Me(n){return`${n}-${yt++}`}const Te=Symbol.for("svelte-maplibre");function _e(){return tt(Te)}function bt(){return Ye(Te,{map:ae(null),source:Oe(null),layer:Oe(null),popupTarget:Oe(null),cluster:ae(),loadedImages:ae(new Set),minzoom:ae(0),maxzoom:ae(24),layerEvent:ae(null)})}function Pe(n){return{subscribe:n.subscribe}}function $e({key:n,setPopupTarget:o=!1,setCluster:t=!1,setMouseEvent:e=!1}){let i=_e(),r=ae(null),l=Pe(r),f={...i,[n]:Pe(r)};if(o&&(f.popupTarget=l),e){let u=ae(null);f.layerEvent=u,i.layerEvent=u}return t&&(f.cluster=ae()),Ye(Te,f),{...i,self:r}}function kt(){return $e({key:"source",setCluster:!0})}function Ct(){return $e({key:"layer",setPopupTarget:!0,setMouseEvent:!0})}function je(n){let o;return t=>{if(t)for(let e in t){let i=o==null?void 0:o[e],r=t[e];i!==r&&n(e,r,i)}else if(o)for(let e in o)n(e,void 0,o[e]);o=t}}function wt(n,...o){let t=[n];for(let e of o)if(e)Array.isArray(e)&&e[0]===n?t.push(...e.slice(1)):t.push(e);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Lt(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function Ot(n,o){return["case",["boolean",["feature-state","hover"],!1],o,n]}var ze=St;function St(n){var o,t,e;if(n){if(Array.isArray(n)){for(o=[],t=n.length,e=0;e<t;e++){var i=n[e];i!=null&&o.push(i)}return o}if(typeof n=="object"){o={};var r=Object.keys(n);for(t=r.length,e=0;e<t;e++){var l=r[e],f=n[l];f!=null&&(o[l]=f)}return o}}}function Ne(n){let o=n[0],t,e,i=Fe(n);return{c(){i.c(),t=de()},m(r,l){i.m(r,l),q(r,t,l),e=!0},p(r,l){l[0]&1&&oe(o,o=r[0])?(ue(),L(i,1,1,pe),se(),i=Fe(r),i.c(),y(i,1),i.m(t.parentNode,t)):i.p(r,l)},i(r){e||(y(i),e=!0)},o(r){L(i),e=!1},d(r){r&&R(t),i.d(r)}}}function Fe(n){let o;const t=n[34].default,e=ge(t,n,n[33],null);return{c(){e&&e.c()},m(i,r){e&&e.m(i,r),o=!0},p(i,r){e&&e.p&&(!o||r[1]&4)&&ye(e,t,i,i[33],o?ke(t,i[33],r,null):be(i[33]),null)},i(i){o||(y(e,i),o=!0)},o(i){L(e,i),o=!1},d(i){e&&e.d(i)}}}function zt(n){let o,t,e=n[0]&&Ne(n);return{c(){e&&e.c(),o=de()},m(i,r){e&&e.m(i,r),q(i,o,r),t=!0},p(i,r){i[0]?e?(e.p(i,r),r[0]&1&&y(e,1)):(e=Ne(i),e.c(),y(e,1),e.m(o.parentNode,o)):e&&(ue(),L(e,1,1,()=>{e=null}),se())},i(i){t||(y(e),t=!0)},o(i){L(e),t=!1},d(i){i&&R(o),e&&e.d(i)}}}function At(n,o,t){let e,i,r,l,f,u,m,s,d,b,z,g,{$$slots:T={},$$scope:I}=o,{id:Z=Me("layer")}=o,{source:B=void 0}=o,{sourceLayer:P=void 0}=o,{beforeId:C=void 0}=o,{beforeLayerType:v=void 0}=o,{type:h}=o,{paint:w=void 0}=o,{layout:N=void 0}=o,{filter:U=void 0}=o,{applyToClusters:F=void 0}=o,{minzoom:S=void 0}=o,{maxzoom:j=void 0}=o,{manageHoverState:O=!0}=o,{hovered:p=null}=o,{hoverCursor:D=void 0}=o;const W=Qe(),{map:ie,source:c,self:A,minzoom:x,maxzoom:k}=Ct();J(n,ie,_=>t(29,d=_)),J(n,c,_=>t(30,b=_)),J(n,A,_=>t(0,s=_)),J(n,x,_=>t(32,g=_)),J(n,k,_=>t(31,z=_)),he(()=>{s&&d&&(d==null||d.removeLayer(s))});let M;return n.$$set=_=>{"id"in _&&t(7,Z=_.id),"source"in _&&t(8,B=_.source),"sourceLayer"in _&&t(9,P=_.sourceLayer),"beforeId"in _&&t(10,C=_.beforeId),"beforeLayerType"in _&&t(11,v=_.beforeLayerType),"type"in _&&t(12,h=_.type),"paint"in _&&t(13,w=_.paint),"layout"in _&&t(14,N=_.layout),"filter"in _&&t(15,U=_.filter),"applyToClusters"in _&&t(16,F=_.applyToClusters),"minzoom"in _&&t(17,S=_.minzoom),"maxzoom"in _&&t(18,j=_.maxzoom),"manageHoverState"in _&&t(19,O=_.manageHoverState),"hovered"in _&&t(6,p=_.hovered),"hoverCursor"in _&&t(20,D=_.hoverCursor),"$$scope"in _&&t(33,I=_.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&65536&&t(28,e=Lt(F)),n.$$.dirty[0]&268468224&&t(27,i=wt("all",e,U)),n.$$.dirty[0]&131072|n.$$.dirty[1]&2&&t(23,r=S??g),n.$$.dirty[0]&262144|n.$$.dirty[1]&1&&t(22,l=j??z),n.$$.dirty[0]&1073742080&&t(26,f=B||b),n.$$.dirty[0]&754482817&&d&&s!==Z&&f){let _=C;if(!C&&v){let E=d.getStyle().layers,H=typeof v=="function"?v:a=>a.type===v,$=E==null?void 0:E.find(H);$&&(_=$.id)}ce(A,s=Z,s),d.addLayer(ze({id:s,type:h,source:f,"source-layer":P,filter:i,paint:w,layout:N,minzoom:r,maxzoom:l}),_),d.on("click",s,E=>{var Q,ee;if(!s||!d)return;let H=E.features??[],$=(ee=(Q=H[0])==null?void 0:Q.properties)==null?void 0:ee.cluster_id;W("click",{event:E,map:d,clusterId:$,layer:s,source:f,features:H})}),d.on("mouseenter",s,E=>{var Q,ee;if(!s||!d)return;D&&(d.getCanvas().style.cursor=D);let H=E.features??[];t(6,p=H[0]??null);let $=(ee=(Q=H[0])==null?void 0:Q.properties)==null?void 0:ee.cluster_id;W("mouseenter",{event:E,map:d,clusterId:$,layer:s,source:f,features:H})}),d.on("mousemove",s,E=>{var Q,ee,Ie;let H=E.features??[],$=(ee=(Q=H[0])==null?void 0:Q.properties)==null?void 0:ee.cluster_id,a=(Ie=H[0])==null?void 0:Ie.id;a!==M&&(O&&(M!==void 0&&(d==null||d.setFeatureState({source:f,id:M},{hover:!1})),d==null||d.setFeatureState({source:f,id:a},{hover:!0})),t(21,M=a),t(6,p=H[0]??null)),W("mousemove",{event:E,map:d,clusterId:$,layer:s,source:f,features:H})}),d.on("mouseleave",s,()=>{!s||!d||(D&&(d.getCanvas().style.cursor=""),t(6,p=null),O&&M!==void 0&&(d==null||d.setFeatureState({source:f,id:M},{hover:!1}),t(21,M=void 0)),W("mouseleave",{map:d,layer:s,source:f}))})}n.$$.dirty[0]&536870913&&t(25,u=s?je((_,E)=>d==null?void 0:d.setPaintProperty(s,_,E)):void 0),n.$$.dirty[0]&536870913&&t(24,m=s?je((_,E)=>d==null?void 0:d.setLayoutProperty(s,_,E)):void 0),n.$$.dirty[0]&33562624&&(u==null||u(w)),n.$$.dirty[0]&16793600&&(m==null||m(N)),n.$$.dirty[0]&549453825&&s&&(d==null||d.setLayerZoomRange(s,r,l))},[s,ie,c,A,x,k,p,Z,B,P,C,v,h,w,N,U,F,S,j,O,D,M,l,r,m,u,f,i,e,d,b,z,g,I,T]}class Mt extends le{constructor(o){super(),fe(this,o,At,zt,oe,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,hoverCursor:20},null,[-1,-1])}}function Tt(n){let o;const t=n[12].default,e=ge(t,n,n[18],null);return{c(){e&&e.c()},m(i,r){e&&e.m(i,r),o=!0},p(i,r){e&&e.p&&(!o||r&262144)&&ye(e,t,i,i[18],o?ke(t,i[18],r,null):be(i[18]),null)},i(i){o||(y(e,i),o=!0)},o(i){L(e,i),o=!1},d(i){e&&e.d(i)}}}function vt(n){let o,t,e;function i(l){n[13](l)}let r={id:n[1],type:"fill",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],$$slots:{default:[Tt]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.hovered=n[0]),o=new Mt({props:r}),me.push(()=>we(o,"hovered",i)),o.$on("click",n[14]),o.$on("mouseenter",n[15]),o.$on("mousemove",n[16]),o.$on("mouseleave",n[17]),{c(){K(o.$$.fragment)},m(l,f){X(o,l,f),e=!0},p(l,[f]){const u={};f&2&&(u.id=l[1]),f&4&&(u.source=l[2]),f&8&&(u.sourceLayer=l[3]),f&16&&(u.beforeId=l[4]),f&32&&(u.beforeLayerType=l[5]),f&64&&(u.paint=l[6]),f&128&&(u.layout=l[7]),f&256&&(u.filter=l[8]),f&512&&(u.minzoom=l[9]),f&1024&&(u.maxzoom=l[10]),f&2048&&(u.hoverCursor=l[11]),f&262144&&(u.$$scope={dirty:f,ctx:l}),!t&&f&1&&(t=!0,u.hovered=l[0],Le(()=>t=!1)),o.$set(u)},i(l){e||(y(o.$$.fragment,l),e=!0)},o(l){L(o.$$.fragment,l),e=!1},d(l){Y(o,l)}}}function It(n,o,t){let{$$slots:e={},$$scope:i}=o,{id:r=Me("fill")}=o,{source:l=void 0}=o,{sourceLayer:f=void 0}=o,{beforeId:u=void 0}=o,{beforeLayerType:m=void 0}=o,{paint:s}=o,{layout:d=void 0}=o,{filter:b=void 0}=o,{minzoom:z=void 0}=o,{maxzoom:g=void 0}=o,{hoverCursor:T=void 0}=o,{hovered:I=null}=o;function Z(h){I=h,t(0,I)}function B(h){Ce.call(this,n,h)}function P(h){Ce.call(this,n,h)}function C(h){Ce.call(this,n,h)}function v(h){Ce.call(this,n,h)}return n.$$set=h=>{"id"in h&&t(1,r=h.id),"source"in h&&t(2,l=h.source),"sourceLayer"in h&&t(3,f=h.sourceLayer),"beforeId"in h&&t(4,u=h.beforeId),"beforeLayerType"in h&&t(5,m=h.beforeLayerType),"paint"in h&&t(6,s=h.paint),"layout"in h&&t(7,d=h.layout),"filter"in h&&t(8,b=h.filter),"minzoom"in h&&t(9,z=h.minzoom),"maxzoom"in h&&t(10,g=h.maxzoom),"hoverCursor"in h&&t(11,T=h.hoverCursor),"hovered"in h&&t(0,I=h.hovered),"$$scope"in h&&t(18,i=h.$$scope)},[I,r,l,f,u,m,s,d,b,z,g,T,e,Z,B,P,C,v,i]}class Bt extends le{constructor(o){super(),fe(this,o,It,vt,oe,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,hovered:0})}}function Zt(n,o,t){let e;const{map:i}=_e();J(n,i,u=>t(4,e=u));let{position:r="top-left"}=o,{container:l=void 0}=o,f=null;return he(()=>{e!=null&&e.loaded()&&f&&e.removeControl(f)}),n.$$set=u=>{"position"in u&&t(1,r=u.position),"container"in u&&t(2,l=u.container)},n.$$.update=()=>{if(n.$$.dirty&30&&e&&!f){let u;typeof l=="string"?u=document.querySelector(l)??void 0:u=l,t(3,f=new re.FullscreenControl({container:u})),e.addControl(f,r)}},[i,r,l,f,e]}class Et extends le{constructor(o){super(),fe(this,o,Zt,null,oe,{position:1,container:2})}}function De(n){let o=n[0],t,e,i=qe(n);return{c(){i.c(),t=de()},m(r,l){i.m(r,l),q(r,t,l),e=!0},p(r,l){l&1&&oe(o,o=r[0])?(ue(),L(i,1,1,pe),se(),i=qe(r),i.c(),y(i,1),i.m(t.parentNode,t)):i.p(r,l)},i(r){e||(y(i),e=!0)},o(r){L(i),e=!1},d(r){r&&R(t),i.d(r)}}}function qe(n){let o;const t=n[15].default,e=ge(t,n,n[14],null);return{c(){e&&e.c()},m(i,r){e&&e.m(i,r),o=!0},p(i,r){e&&e.p&&(!o||r&16384)&&ye(e,t,i,i[14],o?ke(t,i[14],r,null):be(i[14]),null)},i(i){o||(y(e,i),o=!0)},o(i){L(e,i),o=!1},d(i){e&&e.d(i)}}}function Pt(n){let o,t,e=n[0]&&De(n);return{c(){e&&e.c(),o=de()},m(i,r){e&&e.m(i,r),q(i,o,r),t=!0},p(i,[r]){i[0]?e?(e.p(i,r),r&1&&y(e,1)):(e=De(i),e.c(),y(e,1),e.m(o.parentNode,o)):e&&(ue(),L(e,1,1,()=>{e=null}),se())},i(i){t||(y(e),t=!0)},o(i){L(e),t=!1},d(i){i&&R(o),e&&e.d(i)}}}function jt(n,o,t){let e,i,r,{$$slots:l={},$$scope:f}=o,{id:u=Me("geojson")}=o,{data:m}=o,{generateId:s=!1}=o,{promoteId:d=void 0}=o,{filter:b=void 0}=o,{lineMetrics:z=void 0}=o,{cluster:g=void 0}=o;const{map:T,cluster:I,self:Z}=kt();J(n,T,C=>t(13,e=C)),J(n,I,C=>t(16,r=C)),J(n,Z,C=>t(0,i=C));let B,P=!0;return he(()=>{if(i){let C=i;ce(Z,i=null,i),t(11,B=void 0),ot().then(()=>{e!=null&&e.loaded()&&(e==null||e.removeSource(C))})}}),n.$$set=C=>{"id"in C&&t(4,u=C.id),"data"in C&&t(5,m=C.data),"generateId"in C&&t(6,s=C.generateId),"promoteId"in C&&t(7,d=C.promoteId),"filter"in C&&t(8,b=C.filter),"lineMetrics"in C&&t(9,z=C.lineMetrics),"cluster"in C&&t(10,g=C.cluster),"$$scope"in C&&t(14,f=C.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&ce(I,r=g,r),n.$$.dirty&10225&&e&&i!==u&&(i&&e.removeSource(i),ce(Z,i=u,i),e.addSource(i,ze({type:"geojson",data:m,filter:b,lineMetrics:z,generateId:s,promoteId:d,cluster:!!g,clusterMinPoints:g==null?void 0:g.minPoints,clusterMaxZoom:g==null?void 0:g.maxZoom,clusterRadius:g==null?void 0:g.radius,clusterProperties:g==null?void 0:g.properties})),t(11,B=e.getSource(i)),t(12,P=!0)),n.$$.dirty&6176&&B&&(P?t(12,P=!1):B.setData(m)),n.$$.dirty&3072&&(B==null||B.setClusterOptions(ze({cluster:!!g,clusterMaxZoom:g==null?void 0:g.maxZoom,clusterRadius:g==null?void 0:g.radius})))},[i,T,I,Z,u,m,s,d,b,z,g,B,P,e,f,l]}class Nt extends le{constructor(o){super(),fe(this,o,jt,Pt,oe,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Ft(n,o,t){let e;const{map:i}=_e();J(n,i,b=>t(8,e=b));let{position:r="top-left"}=o,{positionOptions:l=void 0}=o,{fitBoundsOptions:f=void 0}=o,{trackUserLocation:u=!1}=o,{showAccuracyCircle:m=!0}=o,{showUserLocation:s=!0}=o,d=null;return he(()=>{e!=null&&e.loaded()&&d&&e.removeControl(d)}),n.$$set=b=>{"position"in b&&t(1,r=b.position),"positionOptions"in b&&t(2,l=b.positionOptions),"fitBoundsOptions"in b&&t(3,f=b.fitBoundsOptions),"trackUserLocation"in b&&t(4,u=b.trackUserLocation),"showAccuracyCircle"in b&&t(5,m=b.showAccuracyCircle),"showUserLocation"in b&&t(6,s=b.showUserLocation)},n.$$.update=()=>{n.$$.dirty&510&&e&&!d&&(t(7,d=new re.GeolocateControl({positionOptions:l,fitBoundsOptions:f,trackUserLocation:u,showAccuracyCircle:m,showUserLocation:s})),e.addControl(d,r))},[i,r,l,f,u,m,s,d,e]}class Dt extends le{constructor(o){super(),fe(this,o,Ft,null,oe,{position:1,positionOptions:2,fitBoundsOptions:3,trackUserLocation:4,showAccuracyCircle:5,showUserLocation:6})}}var Se=ve;function ve(n,o){return n===o||n!==n&&o!==o?!0:typeof n!=typeof o||{}.toString.call(n)!={}.toString.call(o)||n!==Object(n)||!n?!1:Array.isArray(n)?Re(n,o):{}.toString.call(n)=="[object Set]"?Re(Array.from(n),Array.from(o)):{}.toString.call(n)=="[object Object]"?Rt(n,o):qt(n,o)}function qt(n,o){return n.toString()===o.toString()}function Re(n,o){var t=n.length;if(t!=o.length)return!1;for(var e=0;e<t;e++)if(!ve(n[e],o[e]))return!1;return!0}function Rt(n,o){var t=Object.keys(n),e=t.length;if(e!=Object.keys(o).length)return!1;for(var i=0;i<e;i++){var r=t[i];if(!(o.hasOwnProperty(r)&&ve(n[r],o[r])))return!1}return!0}function Ut(n,o,t){let e;const{map:i}=_e();J(n,i,s=>t(6,e=s));let{position:r="top-left"}=o,{showCompass:l=!0}=o,{showZoom:f=!0}=o,{visualizePitch:u=!1}=o,m=null;return he(()=>{e!=null&&e.loaded()&&m&&e.removeControl(m)}),n.$$set=s=>{"position"in s&&t(1,r=s.position),"showCompass"in s&&t(2,l=s.showCompass),"showZoom"in s&&t(3,f=s.showZoom),"visualizePitch"in s&&t(4,u=s.visualizePitch)},n.$$.update=()=>{n.$$.dirty&126&&e&&!m&&(t(5,m=new re.NavigationControl({showCompass:l,showZoom:f,visualizePitch:u})),e.addControl(m,r))},[i,r,l,f,u,m,e]}class Wt extends le{constructor(o){super(),fe(this,o,Ut,null,oe,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function Ht(n,o,t){let e;const{map:i}=_e();J(n,i,m=>t(5,e=m));let{position:r="bottom-left"}=o,{maxWidth:l=void 0}=o,{unit:f="metric"}=o,u=null;return he(()=>{e!=null&&e.loaded()&&u&&e.removeControl(u)}),n.$$set=m=>{"position"in m&&t(1,r=m.position),"maxWidth"in m&&t(2,l=m.maxWidth),"unit"in m&&t(3,f=m.unit)},n.$$.update=()=>{n.$$.dirty&62&&e&&!u&&(t(4,u=new re.ScaleControl({maxWidth:l,unit:f})),e.addControl(u,r))},[i,r,l,f,u,e]}class Jt extends le{constructor(o){super(),fe(this,o,Ht,null,oe,{position:1,maxWidth:2,unit:3})}}const Vt=n=>({map:n&8,loadedImages:n&16,allImagesLoaded:n&32}),Ue=n=>({map:n[3],loadedImages:n[4],allImagesLoaded:n[5]});function We(n){let o,t,e=n[2]&&He(n);const i=n[27].default,r=ge(i,n,n[26],Ue);return{c(){e&&e.c(),o=G(),r&&r.c()},m(l,f){e&&e.m(l,f),q(l,o,f),r&&r.m(l,f),t=!0},p(l,f){l[2]?e?(e.p(l,f),f&4&&y(e,1)):(e=He(l),e.c(),y(e,1),e.m(o.parentNode,o)):e&&(ue(),L(e,1,1,()=>{e=null}),se()),r&&r.p&&(!t||f&67108920)&&ye(r,i,l,l[26],t?ke(i,l[26],f,Vt):be(l[26]),Ue)},i(l){t||(y(e),y(r,l),t=!0)},o(l){L(e),L(r,l),t=!1},d(l){l&&R(o),e&&e.d(l),r&&r.d(l)}}}function He(n){let o,t,e,i,r,l,f,u;return o=new Wt({props:{position:n[6]}}),e=new Dt({props:{position:n[6],fitBoundsOptions:{maxZoom:12}}}),r=new Et({props:{position:n[6]}}),f=new Jt({props:{position:n[6]}}),{c(){K(o.$$.fragment),t=G(),K(e.$$.fragment),i=G(),K(r.$$.fragment),l=G(),K(f.$$.fragment)},m(m,s){X(o,m,s),q(m,t,s),X(e,m,s),q(m,i,s),X(r,m,s),q(m,l,s),X(f,m,s),u=!0},p(m,s){const d={};s&64&&(d.position=m[6]),o.$set(d);const b={};s&64&&(b.position=m[6]),e.$set(b);const z={};s&64&&(z.position=m[6]),r.$set(z);const g={};s&64&&(g.position=m[6]),f.$set(g)},i(m){u||(y(o.$$.fragment,m),y(e.$$.fragment,m),y(r.$$.fragment,m),y(f.$$.fragment,m),u=!0)},o(m){L(o.$$.fragment,m),L(e.$$.fragment,m),L(r.$$.fragment,m),L(f.$$.fragment,m),u=!1},d(m){m&&(R(t),R(i),R(l)),Y(o,m),Y(e,m),Y(r,m),Y(f,m)}}}function Gt(n){let o,t,e,i,r,l=n[3]&&n[0]&&We(n);return{c(){o=ne("div"),l&&l.c(),te(o,"class",t=Be(n[1])+" svelte-p00lfq"),Ze(o,"expand-map",!n[1])},m(f,u){q(f,o,u),l&&l.m(o,null),e=!0,i||(r=nt(n[9].call(null,o)),i=!0)},p(f,[u]){f[3]&&f[0]?l?(l.p(f,u),u&9&&y(l,1)):(l=We(f),l.c(),y(l,1),l.m(o,null)):l&&(ue(),L(l,1,1,()=>{l=null}),se()),(!e||u&2&&t!==(t=Be(f[1])+" svelte-p00lfq"))&&te(o,"class",t),(!e||u&2)&&Ze(o,"expand-map",!f[1])},i(f){e||(y(l),e=!0)},o(f){L(l),e=!1},d(f){f&&R(o),l&&l.d(),i=!1,r()}}}function Kt(n,o,t){let e,i,r,l,{$$slots:f={},$$scope:u}=o,{map:m=null}=o,{class:s=void 0}=o,{style:d}=o,{center:b=[0,0]}=o,{zoom:z=1}=o,{pitch:g=0}=o,{bearing:T=0}=o,{bounds:I=void 0}=o,{loaded:Z=!1}=o,{minZoom:B=0}=o,{maxZoom:P=22}=o,{interactive:C=!0}=o,{attributionControl:v=!0}=o,{preserveDrawingBuffer:h=!1}=o,{maxBounds:w=void 0}=o,{images:N=[]}=o,{standardControls:U=!1}=o,{filterLayers:F=void 0}=o,{transformRequest:S=void 0}=o;const j=Qe(),{map:O,loadedImages:p}=bt();J(n,O,c=>t(3,r=c)),J(n,p,c=>t(4,l=c));let D=new Set;function W(c){r!=null&&r.loaded()&&("url"in c?(D.add(c.id),r.loadImage(c.url,(A,x)=>{D.delete(c.id),A?j("error",A):x&&(r==null||r.addImage(c.id,x,c.options),l.add(c.id),p.set(l))})):(r.addImage(c.id,c.data,c.options),l.add(c.id),p.set(l)))}function ie(c){return ce(O,r=new re.Map({container:c,style:d,center:b,zoom:z,pitch:g,bearing:T,minZoom:B,maxZoom:P,interactive:C,preserveDrawingBuffer:h,maxBounds:w,bounds:I,attributionControl:v,transformRequest:S}),r),r.on("load",A=>{t(0,Z=!0),j("load",r)}),r.on("error",A=>j("error",{...A,map:r})),r.on("movestart",A=>j("movestart",{...A,map:r})),r.on("moveend",A=>{t(10,b=A.target.getCenter()),t(11,z=A.target.getZoom()),t(12,I=A.target.getBounds()),j("moveend",{...A,map:r})}),r.on("zoomstart",A=>j("zoomstart",{...A,map:r})),r.on("zoom",A=>{t(11,z=A.target.getZoom()),j("zoom",{...A,map:r})}),r.on("zoomend",A=>{t(11,z=A.target.getZoom()),j("zoomend",{...A,map:r})}),r.on("styledata",A=>{if(r&&F){const x=r.getStyle().layers;if(x)for(let k of x)F(k)||r.setLayoutProperty(k.id,"visibility","none")}j("styledata",{...A,map:r})}),{destroy(){t(0,Z=!1),r==null||r.remove(),ce(O,r=null,r)}}}return n.$$set=c=>{"map"in c&&t(13,m=c.map),"class"in c&&t(1,s=c.class),"style"in c&&t(14,d=c.style),"center"in c&&t(10,b=c.center),"zoom"in c&&t(11,z=c.zoom),"pitch"in c&&t(15,g=c.pitch),"bearing"in c&&t(16,T=c.bearing),"bounds"in c&&t(12,I=c.bounds),"loaded"in c&&t(0,Z=c.loaded),"minZoom"in c&&t(17,B=c.minZoom),"maxZoom"in c&&t(18,P=c.maxZoom),"interactive"in c&&t(19,C=c.interactive),"attributionControl"in c&&t(20,v=c.attributionControl),"preserveDrawingBuffer"in c&&t(21,h=c.preserveDrawingBuffer),"maxBounds"in c&&t(22,w=c.maxBounds),"images"in c&&t(23,N=c.images),"standardControls"in c&&t(2,U=c.standardControls),"filterLayers"in c&&t(24,F=c.filterLayers),"transformRequest"in c&&t(25,S=c.transformRequest),"$$scope"in c&&t(26,u=c.$$scope)},n.$$.update=()=>{if(n.$$.dirty&4&&t(6,e=typeof U=="boolean"?void 0:U),n.$$.dirty&8&&t(13,m=r),n.$$.dirty&8388617&&Z&&r!=null&&r.loaded())for(let c of N)!D.has(c.id)&&!r.hasImage(c.id)&&W(c);n.$$.dirty&8388624&&t(5,i=N.every(c=>l.has(c.id))),n.$$.dirty&1032&&b&&!Se(b,r==null?void 0:r.getCenter())&&(r==null||r.panTo(b)),n.$$.dirty&2056&&z&&!Se(z,r==null?void 0:r.getZoom())&&(r==null||r.zoomTo(z)),n.$$.dirty&4104&&I&&!Se(I,r==null?void 0:r.getBounds())&&(r==null||r.fitBounds(I))},[Z,s,U,r,l,i,e,O,p,ie,b,z,I,m,d,g,T,B,P,C,v,h,w,N,F,S,u,f]}class Xt extends le{constructor(o){super(),fe(this,o,Kt,Gt,oe,{map:13,class:1,style:14,center:10,zoom:11,pitch:15,bearing:16,bounds:12,loaded:0,minZoom:17,maxZoom:18,interactive:19,attributionControl:20,preserveDrawingBuffer:21,maxBounds:22,images:23,standardControls:2,filterLayers:24,transformRequest:25})}}const Yt=n=>({features:n[0]&16,data:n[0]&16,map:n[0]&4,close:n[0]&1}),Je=n=>{var o;return{features:n[4],data:(o=n[4])==null?void 0:o[0],map:n[2],close:n[29]}};function Ve(n){let o,t,e=(n[4]||n[3]instanceof re.Marker)&&Ge(n);return{c(){o=ne("div"),e&&e.c()},m(i,r){q(i,o,r),e&&e.m(o,null),n[30](o),t=!0},p(i,r){i[4]||i[3]instanceof re.Marker?e?(e.p(i,r),r[0]&24&&y(e,1)):(e=Ge(i),e.c(),y(e,1),e.m(o,null)):e&&(ue(),L(e,1,1,()=>{e=null}),se())},i(i){t||(y(e),t=!0)},o(i){L(e),t=!1},d(i){i&&R(o),e&&e.d(),n[30](null)}}}function Ge(n){let o;const t=n[28].default,e=ge(t,n,n[27],Je);return{c(){e&&e.c()},m(i,r){e&&e.m(i,r),o=!0},p(i,r){e&&e.p&&(!o||r[0]&134217749)&&ye(e,t,i,i[27],o?ke(t,i[27],r,Yt):be(i[27]),Je)},i(i){o||(y(e,i),o=!0)},o(i){L(e,i),o=!1},d(i){e&&e.d(i)}}}function Qt(n){let o,t,e=n[8].default&&Ve(n);return{c(){e&&e.c(),o=de()},m(i,r){e&&e.m(i,r),q(i,o,r),t=!0},p(i,r){i[8].default?e?(e.p(i,r),r[0]&256&&y(e,1)):(e=Ve(i),e.c(),y(e,1),e.m(o.parentNode,o)):e&&(ue(),L(e,1,1,()=>{e=null}),se())},i(i){t||(y(e),t=!0)},o(i){L(e),t=!1},d(i){i&&R(o),e&&e.d(i)}}}function pt(n,o,t){let e,i,r,l,f,{$$slots:u={},$$scope:m}=o;const s=rt(u);let{closeButton:d=void 0}=o,{closeOnClickOutside:b=!0}=o,{closeOnClickInside:z=!1}=o,{closeOnMove:g=!1}=o,{openOn:T="click"}=o,{focusAfterOpen:I=!0}=o,{anchor:Z=void 0}=o,{offset:B=void 0}=o,{popupClass:P=void 0}=o,{maxWidth:C=void 0}=o,{lngLat:v=void 0}=o,{html:h=void 0}=o,{open:w=!1}=o;const{map:N,popupTarget:U,layerEvent:F}=_e();J(n,N,a=>t(2,r=a)),J(n,U,a=>t(3,f=a)),J(n,F,a=>t(26,l=a));let S,j=!1,O;function p(){if(!S)return;let a=S.getElement();!a||a===O||(O=a,T==="hover"&&(O.style.pointerEvents="none"),O.addEventListener("mouseenter",()=>{t(22,j=!0)},{passive:!0}),O.addEventListener("mouseleave",()=>{t(22,j=!1)},{passive:!0}),O.addEventListener("click",()=>{z&&t(0,w=!1)},{passive:!0}))}xe(()=>{if(r)return r.on("click",_),typeof f=="string"&&(r.on("click",f,ie),r.on("mousemove",f,M),r.on("mouseleave",f,k),r.on("touchstart",f,A),r.on("touchend",f,x)),()=>{r!=null&&r.loaded()&&(S==null||S.remove(),r.off("click",_),f instanceof re.Marker?f.getPopup()===S&&f.setPopup(void 0):typeof f=="string"&&(r.off("click",f,ie),r.off("mousemove",f,M),r.off("mouseleave",f,k),r.off("touchstart",f,A),r.off("touchend",f,x)))}});let D=null,W="normal";function ie(a){T==="click"&&("layerType"in a?a.layerType==="deckgl"?(t(9,v=a.coordinate),t(4,D=a.object?[a.object]:null)):(t(9,v=a.lngLat),t(4,D=a.features??[])):(t(9,v=a.lngLat),t(4,D=a.features??[])),setTimeout(()=>t(0,w=!0)))}let c=null;function A(a){c=a.point}function x(a){if(!c||T!=="hover")return;let Q=c.dist(a.point);c=null,Q<3&&(t(9,v=a.lngLat),t(4,D=a.features??[]),S.isOpen()?t(23,W="justOpened"):(t(23,W="opening"),t(0,w=!0)))}function k(a){T!=="hover"||c||W!=="normal"||(t(0,w=!1),t(4,D=null))}function M(a){T!=="hover"||c||W!=="normal"||(t(0,w=!0),t(4,D=a.features??[]),t(9,v=a.lngLat))}function _(a){if(W==="justOpened"){t(23,W="normal");return}if(!b)return;let Q=[O,f instanceof re.Marker?f==null?void 0:f.getElement():null];w&&S.isOpen()&&!Q.some(ee=>ee==null?void 0:ee.contains(a.originalEvent.target))&&t(0,w=!1)}let E;const H=()=>t(0,w=!1);function $(a){me[a?"unshift":"push"](()=>{E=a,t(1,E)})}return n.$$set=a=>{"closeButton"in a&&t(10,d=a.closeButton),"closeOnClickOutside"in a&&t(11,b=a.closeOnClickOutside),"closeOnClickInside"in a&&t(12,z=a.closeOnClickInside),"closeOnMove"in a&&t(13,g=a.closeOnMove),"openOn"in a&&t(14,T=a.openOn),"focusAfterOpen"in a&&t(15,I=a.focusAfterOpen),"anchor"in a&&t(16,Z=a.anchor),"offset"in a&&t(17,B=a.offset),"popupClass"in a&&t(18,P=a.popupClass),"maxWidth"in a&&t(19,C=a.maxWidth),"lngLat"in a&&t(9,v=a.lngLat),"html"in a&&t(20,h=a.html),"open"in a&&t(0,w=a.open),"$$scope"in a&&t(27,m=a.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&7168&&t(25,e=d??(!b&&!z)),n.$$.dirty[0]&36675584&&(S||(t(21,S=new re.Popup({closeButton:e,closeOnClick:!1,closeOnMove:g,focusAfterOpen:I,maxWidth:C,className:P,anchor:Z,offset:B})),O=S.getElement(),S.on("open",()=>{t(0,w=!0),p()}),S.on("close",a=>{t(0,w=!1)}))),n.$$.dirty[0]&2113544&&S&&f instanceof re.Marker&&(T==="click"?f.setPopup(S):f.getPopup()===S&&f.setPopup(void 0)),n.$$.dirty[0]&67125248&&T==="click"&&(l==null?void 0:l.type)==="click"&&(ie(l),ce(F,l=null,l)),n.$$.dirty[0]&67125248&&t(24,i=T==="hover"&&((l==null?void 0:l.type)==="mousemove"||(l==null?void 0:l.type)==="mouseenter")),n.$$.dirty[0]&88096768&&T==="hover"&&F&&(i&&l&&(l.layerType==="deckgl"?(t(9,v=l.coordinate),t(4,D=l.object?[l.object]:null)):(t(9,v=l.lngLat),t(4,D=l.features??[]))),t(0,w=(i||j)??!1)),n.$$.dirty[0]&3145730&&(E?S.setDOMContent(E):h&&S.setHTML(h)),n.$$.dirty[0]&2097664&&v&&S.setLngLat(v),n.$$.dirty[0]&10485765&&r){let a=S.isOpen();w&&!a?(S.addTo(r),W==="opening"&&t(23,W="justOpened")):!w&&a&&S.remove()}},[w,E,r,f,D,N,U,F,s,v,d,b,z,g,T,I,Z,B,P,C,h,S,j,W,i,e,l,m,u,H,$]}class xt extends le{constructor(o){super(),fe(this,o,pt,Qt,oe,{closeButton:10,closeOnClickOutside:11,closeOnClickInside:12,closeOnMove:13,openOn:14,focusAfterOpen:15,anchor:16,offset:17,popupClass:18,maxWidth:19,lngLat:9,html:20,open:0},null,[-1,-1])}}async function $t(){const o=await(await fetch(dt)).text();return JSON.parse(o)}function eo(n){let o;return{c(){o=Ae("About")},m(t,e){q(t,o,e)},d(t){t&&R(o)}}}function Ke(n){let o,t;return o=new ut({props:{errorMessage:n[4]}}),{c(){K(o.$$.fragment)},m(e,i){X(o,e,i),t=!0},p(e,i){const r={};i&16&&(r.errorMessage=e[4]),o.$set(r)},i(e){t||(y(o.$$.fragment,e),t=!0)},o(e){L(o.$$.fragment,e),t=!1},d(e){Y(o,e)}}}function to(n){let o,t,e,i,r;return{c(){o=ne("input"),t=G(),e=ne("datalist"),te(o,"class","govuk-input govuk-input--width-20"),te(o,"id","inputValue"),te(o,"data-testid","transport-authority"),te(o,"list","authorities-list"),te(e,"id","authorities-list")},m(l,f){q(l,o,f),Ee(o,n[0]),q(l,t,f),q(l,e,f),n[13](e),i||(r=st(o,"input",n[12]),i=!0)},p(l,f){f&1&&o.value!==l[0]&&Ee(o,l[0])},d(l){l&&(R(o),R(t),R(e)),n[13](null),i=!1,r()}}}function oo(n){let o;return{c(){o=Ae("Start")},m(t,e){q(t,o,e)},d(t){t&&R(o)}}}function Xe(n){let o,t;return o=new Nt({props:{id:"authorities",data:n[2],generateId:!0,$$slots:{default:[io]},$$scope:{ctx:n}}}),{c(){K(o.$$.fragment)},m(e,i){X(o,e,i),t=!0},p(e,i){const r={};i&4&&(r.data=e[2]),i&1048640&&(r.$$scope={dirty:i,ctx:e}),o.$set(r)},i(e){t||(y(o.$$.fragment,e),t=!0)},o(e){L(o.$$.fragment,e),t=!1},d(e){Y(o,e)}}}function no(n){let o,t=n[19][0].properties.name+"",e;return{c(){o=ne("span"),e=Ae(t),te(o,"class","govuk-body")},m(i,r){q(i,o,r),V(o,e)},p(i,r){r&524288&&t!==(t=i[19][0].properties.name+"")&&mt(e,t)},d(i){i&&R(o)}}}function ro(n){let o,t;return o=new xt({props:{openOn:"hover",$$slots:{default:[no,({features:e})=>({19:e}),({features:e})=>e?524288:0]},$$scope:{ctx:n}}}),{c(){K(o.$$.fragment)},m(e,i){X(o,e,i),t=!0},p(e,i){const r={};i&1572864&&(r.$$scope={dirty:i,ctx:e}),o.$set(r)},i(e){t||(y(o.$$.fragment,e),t=!0)},o(e){L(o.$$.fragment,e),t=!1},d(e){Y(o,e)}}}function io(n){let o,t;return o=new Bt({props:{id:et,paint:{"fill-color":"rgb(200, 100, 240)","fill-outline-color":"rgb(200, 100, 240)","fill-opacity":Ot(.4,.8)},filter:["==",["get","level"],n[6]],$$slots:{default:[ro]},$$scope:{ctx:n}}}),o.$on("click",so),{c(){K(o.$$.fragment)},m(e,i){X(o,e,i),t=!0},p(e,i){const r={};i&64&&(r.filter=["==",["get","level"],e[6]]),i&1048576&&(r.$$scope={dirty:i,ctx:e}),o.$set(r)},i(e){t||(y(o.$$.fragment,e),t=!0)},o(e){L(o.$$.fragment,e),t=!1},d(e){Y(o,e)}}}function lo(n){let o,t,e=n[2]&&Xe(n);return{c(){e&&e.c(),o=de()},m(i,r){e&&e.m(i,r),q(i,o,r),t=!0},p(i,r){i[2]?e?(e.p(i,r),r&4&&y(e,1)):(e=Xe(i),e.c(),y(e,1),e.m(o.parentNode,o)):e&&(ue(),L(e,1,1,()=>{e=null}),se())},i(i){t||(y(e),t=!0)},o(i){L(e),t=!1},d(i){i&&R(o),e&&e.d(i)}}}function fo(n){let o,t,e,i,r,l,f,u,m,s,d,b,z,g,T,I,Z,B,P,C,v,h,w,N,U,F,S,j;r=new it({props:{$$slots:{default:[eo]},$$scope:{ctx:n}}}),r.$on("click",n[11]);let O=n[4]&&Ke(n);u=new lt({props:{label:"Select Transport Authority or Local Authority District",id:"inputValue",$$slots:{default:[to]},$$scope:{ctx:n}}}),s=new ht({props:{disabled:!n[7],$$slots:{default:[oo]},$$scope:{ctx:n}}}),s.$on("click",n[10]);function p(k){n[14](k)}let D={legend:"Or pick from the map",id:"showBoundaries",choices:[["TA","Transport Authorities"],["LAD","Local Authority Districts"]],inlineSmall:!0};n[6]!==void 0&&(D.value=n[6]),g=new _t({props:D}),me.push(()=>we(g,"value",p)),g.$on("change",n[8]);let W=uo;C=new ft({props:{label:"Or upload an ATIP GeoJSON file",loadFile:n[9],id:"load-geojson"}});function ie(k){n[15](k)}let c={style:"https://api.maptiler.com/maps/streets/style.json?key=MZEJTanw3WpxRvt7qDfo",$$slots:{default:[lo]},$$scope:{ctx:n}};n[1]!==void 0&&(c.map=n[1]),w=new Xt({props:c}),me.push(()=>we(w,"map",ie));function A(k){n[16](k)}let x={};return n[3]!==void 0&&(x.open=n[3]),F=new gt({props:x}),me.push(()=>we(F,"open",A)),{c(){o=ne("div"),t=ne("div"),e=ne("h1"),e.textContent="Welcome to ATIP v2",i=G(),K(r.$$.fragment),l=G(),O&&O.c(),f=G(),K(u.$$.fragment),m=G(),K(s.$$.fragment),d=G(),b=ne("hr"),z=G(),K(g.$$.fragment),I=G(),Z=ne("hr"),B=G(),P=G(),K(C.$$.fragment),v=G(),h=ne("div"),K(w.$$.fragment),U=G(),K(F.$$.fragment),te(e,"class","govuk-heading-l"),te(t,"class","govuk-grid-column-one-half left svelte-1qrinac"),te(h,"class","govuk-grid-column-one-half map svelte-1qrinac"),te(o,"class","govuk-grid-row")},m(k,M){q(k,o,M),V(o,t),V(t,e),V(t,i),X(r,t,null),V(t,l),O&&O.m(t,null),V(t,f),X(u,t,null),V(t,m),X(s,t,null),V(t,d),V(t,b),V(t,z),X(g,t,null),V(t,I),V(t,Z),V(t,B),V(t,P),X(C,t,null),V(o,v),V(o,h),X(w,h,null),q(k,U,M),X(F,k,M),j=!0},p(k,[M]){const _={};M&1048576&&(_.$$scope={dirty:M,ctx:k}),r.$set(_),k[4]?O?(O.p(k,M),M&16&&y(O,1)):(O=Ke(k),O.c(),y(O,1),O.m(t,f)):O&&(ue(),L(O,1,1,()=>{O=null}),se());const E={};M&1048609&&(E.$$scope={dirty:M,ctx:k}),u.$set(E);const H={};M&128&&(H.disabled=!k[7]),M&1048576&&(H.$$scope={dirty:M,ctx:k}),s.$set(H);const $={};!T&&M&64&&(T=!0,$.value=k[6],Le(()=>T=!1)),g.$set($);const a={};M&1048644&&(a.$$scope={dirty:M,ctx:k}),!N&&M&2&&(N=!0,a.map=k[1],Le(()=>N=!1)),w.$set(a);const Q={};!S&&M&8&&(S=!0,Q.open=k[3],Le(()=>S=!1)),F.$set(Q)},i(k){j||(y(r.$$.fragment,k),y(O),y(u.$$.fragment,k),y(s.$$.fragment,k),y(g.$$.fragment,k),y(W),y(C.$$.fragment,k),y(w.$$.fragment,k),y(F.$$.fragment,k),j=!0)},o(k){L(r.$$.fragment,k),L(O),L(u.$$.fragment,k),L(s.$$.fragment,k),L(g.$$.fragment,k),L(W),L(C.$$.fragment,k),L(w.$$.fragment,k),L(F.$$.fragment,k),j=!1},d(k){k&&(R(o),R(U)),Y(r),O&&O.d(),Y(u),Y(s),Y(g),Y(C),Y(w),Y(F,k)}}}let uo="",et="authorities-layer";function so(n){let o=n.detail.features[0].properties.name;window.location.href=`scheme.html?authority=${o}`}function ao(n){if(n.features.length>0){let o=n.features[0].properties;for(let t of["planning","v2","criticals"])if(o&&t in o)return t}return"v1"}function co(n,o,t){let e,i=!1,l=new URLSearchParams(window.location.search).get("error")||"",f,u,m=new Set,s=null,d=null,b="TA";function z(){s==null||s.setFilter(et,["==",["get","level"],b])}xe(async()=>{at();const h=await $t();for(let w of h.features){let N=document.createElement("option");N.value=w.properties.name,u.appendChild(N),m.add(w.properties.name)}t(2,d=h)});function g(h){try{let w=JSON.parse(h);if(!w.authority)throw new Error("File doesn't have an authority set; is it an ATIP file?");if(!m.has(w.authority))throw new Error(`Unknown authority ${w.authority}`);let N=w.authority,U=ao(w);U!="v1"&&(N+=`_${U}`),window.localStorage.setItem(N,JSON.stringify(w)),window.location.href=`scheme.html?authority=${w.authority}&schema=${U}`}catch(w){t(4,l=`Couldn't load scheme from a file: ${w}`)}}function T(){window.location.href=`scheme.html?authority=${f}`}const I=()=>t(3,i=!i);function Z(){f=this.value,t(0,f)}function B(h){me[h?"unshift":"push"](()=>{u=h,t(5,u)})}function P(h){b=h,t(6,b)}function C(h){s=h,t(1,s)}function v(h){i=h,t(3,i)}return n.$$.update=()=>{n.$$.dirty&1&&t(7,e=m.has(f)),n.$$.dirty&6&&s&&d&&s.fitBounds(ct(d),{padding:20,animate:!1})},[f,s,d,i,l,u,b,e,z,g,T,I,Z,B,P,C,v]}class mo extends le{constructor(o){super(),fe(this,o,co,fo,oe,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new mo({target:document.getElementById("app")});
