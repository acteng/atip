import{S as Y,i as x,s as q,F as Fe,g as ke,m as Le,t as g,n as k,p as Se,e as Me,h as K,j as J,w as Ze,o as U,b as Ce,$ as p,as as $,at as ee,aU as re,D as He,ba as Ne,q as w,a3 as Te,aX as Q,aZ as ne,a0 as ze,aL as ue,aM as fe,aN as ae,aO as se,c as we,l as De,a$ as j,aW as Pe}from"./index-6aa6f154.js";function Ae(i){let e,o,t;return{c(){e=Me("input"),e.disabled=i[2],K(e,"class","govuk-file-upload"),K(e,"id",i[1]),K(e,"type","file")},m(l,n){J(l,e,n),i[6](e),o||(t=Ze(e,"change",i[4]),o=!0)},p(l,n){n&4&&(e.disabled=l[2]),n&2&&K(e,"id",l[1])},d(l){l&&U(e),i[6](null),o=!1,t()}}}function Re(i){let e,o;return e=new Fe({props:{label:i[0],id:i[1],$$slots:{default:[Ae]},$$scope:{ctx:i}}}),{c(){ke(e.$$.fragment)},m(t,l){Le(e,t,l),o=!0},p(t,[l]){const n={};l&1&&(n.label=t[0]),l&2&&(n.id=t[1]),l&142&&(n.$$scope={dirty:l,ctx:t}),e.$set(n)},i(t){o||(g(e.$$.fragment,t),o=!0)},o(t){k(e.$$.fragment,t),o=!1},d(t){Se(e,t)}}}function je(i,e,o){let{label:t}=e,{id:l}=e,{loadFile:n}=e,{disabled:f=!1}=e,c;function m(a){let r=new FileReader;r.onload=S=>{n(S.target.result)};let L=c.files;r.readAsText(L[0])}function h(a){Ce[a?"unshift":"push"](()=>{c=a,o(3,c)})}return i.$$set=a=>{"label"in a&&o(0,t=a.label),"id"in a&&o(1,l=a.id),"loadFile"in a&&o(5,n=a.loadFile),"disabled"in a&&o(2,f=a.disabled)},[t,l,f,c,m,n,h]}class Ye extends Y{constructor(e){super(),x(this,e,je,Re,q,{label:0,id:1,loadFile:5,disabled:2})}}function he(i){let e;return o=>{if(o)for(let t in o){let l=e==null?void 0:e[t],n=o[t];l!==n&&i(t,n,l)}else if(e)for(let t in e)i(t,void 0,e[t]);e=o}}function qe(i,...e){let o=[i];for(let t of e)if(t)Array.isArray(t)&&t[0]===i?o.push(...t.slice(1)):o.push(t);else continue;if(o.length!==1)return o.length===2?o[1]:o}function Ee(i){return i===!0?["has","point_count"]:i===!1?["!",["has","point_count"]]:void 0}function xe(i,e){return["case",["boolean",["feature-state","hover"],!1],e,i]}function be(i){let e=i[0],o,t,l=ge(i);return{c(){l.c(),o=p()},m(n,f){l.m(n,f),J(n,o,f),t=!0},p(n,f){f[0]&1&&q(e,e=n[0])?($(),k(l,1,1,ze),ee(),l=ge(n),l.c(),g(l,1),l.m(o.parentNode,o)):l.p(n,f)},i(n){t||(g(l),t=!0)},o(n){k(l),t=!1},d(n){n&&U(o),l.d(n)}}}function ge(i){let e;const o=i[35].default,t=ue(o,i,i[34],null);return{c(){t&&t.c()},m(l,n){t&&t.m(l,n),e=!0},p(l,n){t&&t.p&&(!e||n[1]&8)&&fe(t,o,l,l[34],e?se(o,l[34],n,null):ae(l[34]),null)},i(l){e||(g(t,l),e=!0)},o(l){k(t,l),e=!1},d(l){t&&t.d(l)}}}function Ge(i){let e,o,t=i[0]&&be(i);return{c(){t&&t.c(),e=p()},m(l,n){t&&t.m(l,n),J(l,e,n),o=!0},p(l,n){l[0]?t?(t.p(l,n),n[0]&1&&g(t,1)):(t=be(l),t.c(),g(t,1),t.m(e.parentNode,e)):t&&($(),k(t,1,1,()=>{t=null}),ee())},i(l){o||(g(t),o=!0)},o(l){k(t),o=!1},d(l){l&&U(e),t&&t.d(l)}}}function Oe(i,e,o){let t,l,n,f,c,m,h,a,r,L,S,y,{$$slots:D={},$$scope:z}=e,{id:v=re("layer")}=e,{source:b=void 0}=e,{sourceLayer:C=void 0}=e,{beforeId:d=void 0}=e,{beforeLayerType:T=void 0}=e,{type:E}=e,{paint:P=void 0}=e,{layout:A=void 0}=e,{filter:G=void 0}=e,{applyToClusters:s=void 0}=e,{minzoom:te=void 0}=e,{maxzoom:oe=void 0}=e,{manageHoverState:W=!1}=e,{hovered:O=null}=e,{hoverCursor:V=void 0}=e,{eventsIfTopMost:B=!1}=e;const X=He(),{map:ce,source:me,self:le,minzoom:de,maxzoom:ye,eventTopMost:ie}=Ne();w(i,ce,u=>o(30,r=u)),w(i,me,u=>o(31,L=u)),w(i,le,u=>o(0,a=u)),w(i,de,u=>o(33,y=u)),w(i,ye,u=>o(32,S=u)),Te(()=>{a&&r&&(r==null||r.removeLayer(a))});let F;return i.$$set=u=>{"id"in u&&o(7,v=u.id),"source"in u&&o(8,b=u.source),"sourceLayer"in u&&o(9,C=u.sourceLayer),"beforeId"in u&&o(10,d=u.beforeId),"beforeLayerType"in u&&o(11,T=u.beforeLayerType),"type"in u&&o(12,E=u.type),"paint"in u&&o(13,P=u.paint),"layout"in u&&o(14,A=u.layout),"filter"in u&&o(15,G=u.filter),"applyToClusters"in u&&o(16,s=u.applyToClusters),"minzoom"in u&&o(17,te=u.minzoom),"maxzoom"in u&&o(18,oe=u.maxzoom),"manageHoverState"in u&&o(19,W=u.manageHoverState),"hovered"in u&&o(6,O=u.hovered),"hoverCursor"in u&&o(20,V=u.hoverCursor),"eventsIfTopMost"in u&&o(21,B=u.eventsIfTopMost),"$$scope"in u&&o(34,z=u.$$scope)},i.$$.update=()=>{if(i.$$.dirty[0]&65536&&o(29,t=Ee(s)),i.$$.dirty[0]&536903680&&o(28,l=qe("all",t,G)),i.$$.dirty[0]&131072|i.$$.dirty[1]&4&&o(24,n=te??y),i.$$.dirty[0]&262144|i.$$.dirty[1]&2&&o(23,f=oe??S),i.$$.dirty[0]&256|i.$$.dirty[1]&1&&o(27,c=b||L),i.$$.dirty[0]&1509457537&&r&&a!==v&&c){let u=function(_){var H,N;if(!a||!r||B&&ie(_)!==a)return;let I=_.features??[],M=(N=(H=I[0])==null?void 0:H.properties)==null?void 0:N.cluster_id,Z={event:_,map:r,clusterId:M,layer:a,source:c,features:I};X(_.type,Z)},R=d;if(!d&&T){let _=r.getStyle().layers,I=typeof T=="function"?T:Z=>Z.type===T,M=_==null?void 0:_.find(I);M&&(R=M.id)}Q(le,a=v,a),r.addLayer(ne({id:a,type:E,source:c,"source-layer":C,filter:l,paint:P,layout:A,minzoom:n,maxzoom:f}),R),r.on("click",a,u),r.on("dblclick",a,u),r.on("contextmenu",a,u),r.on("mouseenter",a,_=>{var H,N;if(!a||!r||B&&ie(_)!==a)return;V&&(r.getCanvas().style.cursor=V);let I=_.features??[];o(6,O=I[0]??null);let M=(N=(H=I[0])==null?void 0:H.properties)==null?void 0:N.cluster_id;X("mouseenter",{event:_,map:r,clusterId:M,layer:a,source:c,features:I})}),r.on("mousemove",a,_=>{var H,N,_e;if(B&&ie(_)!==a)return;let I=_.features??[],M=(N=(H=I[0])==null?void 0:H.properties)==null?void 0:N.cluster_id,Z=(_e=I[0])==null?void 0:_e.id;Z!==F&&(W&&(F!==void 0&&(r==null||r.setFeatureState({source:c,id:F},{hover:!1})),r==null||r.setFeatureState({source:c,id:Z},{hover:!0})),o(22,F=Z),o(6,O=I[0]??null)),X("mousemove",{event:_,map:r,clusterId:M,layer:a,source:c,features:I})}),r.on("mouseleave",a,_=>{!a||!r||(V&&(r.getCanvas().style.cursor=""),o(6,O=null),W&&F!==void 0&&(r==null||r.setFeatureState({source:c,id:F},{hover:!1}),o(22,F=void 0)),X("mouseleave",{map:r,layer:a,source:c}))})}i.$$.dirty[0]&1073741825&&o(26,m=a?he((u,R)=>r==null?void 0:r.setPaintProperty(a,u,R)):void 0),i.$$.dirty[0]&1073741825&&o(25,h=a?he((u,R)=>r==null?void 0:r.setLayoutProperty(a,u,R)):void 0),i.$$.dirty[0]&67117056&&(m==null||m(P)),i.$$.dirty[0]&33570816&&(h==null||h(A)),i.$$.dirty[0]&1098907649&&a&&(r==null||r.setLayerZoomRange(a,n,f))},[a,ce,me,le,de,ye,O,v,b,C,d,T,E,P,A,G,s,te,oe,W,V,B,F,f,n,h,m,c,l,t,r,L,S,y,z,D]}class Ve extends Y{constructor(e){super(),x(this,e,Oe,Ge,q,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,hoverCursor:20,eventsIfTopMost:21},null,[-1,-1])}}function Be(i){let e;const o=i[14].default,t=ue(o,i,i[22],null);return{c(){t&&t.c()},m(l,n){t&&t.m(l,n),e=!0},p(l,n){t&&t.p&&(!e||n&4194304)&&fe(t,o,l,l[22],e?se(o,l[22],n,null):ae(l[22]),null)},i(l){e||(g(t,l),e=!0)},o(l){k(t,l),e=!1},d(l){t&&t.d(l)}}}function Je(i){let e,o,t;function l(f){i[15](f)}let n={id:i[1],type:"fill",source:i[2],sourceLayer:i[3],beforeId:i[4],beforeLayerType:i[5],paint:i[6],layout:i[7],filter:i[8],minzoom:i[9],maxzoom:i[10],hoverCursor:i[11],manageHoverState:i[12],eventsIfTopMost:i[13],$$slots:{default:[Be]},$$scope:{ctx:i}};return i[0]!==void 0&&(n.hovered=i[0]),e=new Ve({props:n}),Ce.push(()=>we(e,"hovered",l)),e.$on("click",i[16]),e.$on("dblclick",i[17]),e.$on("contextmenu",i[18]),e.$on("mouseenter",i[19]),e.$on("mousemove",i[20]),e.$on("mouseleave",i[21]),{c(){ke(e.$$.fragment)},m(f,c){Le(e,f,c),t=!0},p(f,[c]){const m={};c&2&&(m.id=f[1]),c&4&&(m.source=f[2]),c&8&&(m.sourceLayer=f[3]),c&16&&(m.beforeId=f[4]),c&32&&(m.beforeLayerType=f[5]),c&64&&(m.paint=f[6]),c&128&&(m.layout=f[7]),c&256&&(m.filter=f[8]),c&512&&(m.minzoom=f[9]),c&1024&&(m.maxzoom=f[10]),c&2048&&(m.hoverCursor=f[11]),c&4096&&(m.manageHoverState=f[12]),c&8192&&(m.eventsIfTopMost=f[13]),c&4194304&&(m.$$scope={dirty:c,ctx:f}),!o&&c&1&&(o=!0,m.hovered=f[0],De(()=>o=!1)),e.$set(m)},i(f){t||(g(e.$$.fragment,f),t=!0)},o(f){k(e.$$.fragment,f),t=!1},d(f){Se(e,f)}}}function Ue(i,e,o){let{$$slots:t={},$$scope:l}=e,{id:n=re("fill")}=e,{source:f=void 0}=e,{sourceLayer:c=void 0}=e,{beforeId:m=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:a}=e,{layout:r=void 0}=e,{filter:L=void 0}=e,{minzoom:S=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:D=void 0}=e,{manageHoverState:z=!1}=e,{hovered:v=null}=e,{eventsIfTopMost:b=!1}=e;function C(s){v=s,o(0,v)}function d(s){j.call(this,i,s)}function T(s){j.call(this,i,s)}function E(s){j.call(this,i,s)}function P(s){j.call(this,i,s)}function A(s){j.call(this,i,s)}function G(s){j.call(this,i,s)}return i.$$set=s=>{"id"in s&&o(1,n=s.id),"source"in s&&o(2,f=s.source),"sourceLayer"in s&&o(3,c=s.sourceLayer),"beforeId"in s&&o(4,m=s.beforeId),"beforeLayerType"in s&&o(5,h=s.beforeLayerType),"paint"in s&&o(6,a=s.paint),"layout"in s&&o(7,r=s.layout),"filter"in s&&o(8,L=s.filter),"minzoom"in s&&o(9,S=s.minzoom),"maxzoom"in s&&o(10,y=s.maxzoom),"hoverCursor"in s&&o(11,D=s.hoverCursor),"manageHoverState"in s&&o(12,z=s.manageHoverState),"hovered"in s&&o(0,v=s.hovered),"eventsIfTopMost"in s&&o(13,b=s.eventsIfTopMost),"$$scope"in s&&o(22,l=s.$$scope)},[v,n,f,c,m,h,a,r,L,S,y,D,z,b,t,C,d,T,E,P,A,G,l]}class pe extends Y{constructor(e){super(),x(this,e,Ue,Je,q,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}function ve(i){let e=i[0],o,t,l=Ie(i);return{c(){l.c(),o=p()},m(n,f){l.m(n,f),J(n,o,f),t=!0},p(n,f){f&1&&q(e,e=n[0])?($(),k(l,1,1,ze),ee(),l=Ie(n),l.c(),g(l,1),l.m(o.parentNode,o)):l.p(n,f)},i(n){t||(g(l),t=!0)},o(n){k(l),t=!1},d(n){n&&U(o),l.d(n)}}}function Ie(i){let e;const o=i[15].default,t=ue(o,i,i[14],null);return{c(){t&&t.c()},m(l,n){t&&t.m(l,n),e=!0},p(l,n){t&&t.p&&(!e||n&16384)&&fe(t,o,l,l[14],e?se(o,l[14],n,null):ae(l[14]),null)},i(l){e||(g(t,l),e=!0)},o(l){k(t,l),e=!1},d(l){t&&t.d(l)}}}function We(i){let e,o,t=i[0]&&ve(i);return{c(){t&&t.c(),e=p()},m(l,n){t&&t.m(l,n),J(l,e,n),o=!0},p(l,[n]){l[0]?t?(t.p(l,n),n&1&&g(t,1)):(t=ve(l),t.c(),g(t,1),t.m(e.parentNode,e)):t&&($(),k(t,1,1,()=>{t=null}),ee())},i(l){o||(g(t),o=!0)},o(l){k(t),o=!1},d(l){l&&U(e),t&&t.d(l)}}}function Xe(i,e){if(i.getSource(e)){let o=[];for(let t of i.getStyle().layers)"source"in t&&t.source==e&&o.push(t.id);for(let t of o)console.log(`had to remove ${t} first`),i.removeLayer(t);i.removeSource(e)}}function Ke(i,e,o){let t,l,n,{$$slots:f={},$$scope:c}=e,{id:m=re("geojson")}=e,{data:h}=e,{generateId:a=!1}=e,{promoteId:r=void 0}=e,{filter:L=void 0}=e,{lineMetrics:S=void 0}=e,{cluster:y=void 0}=e;const{map:D,cluster:z,self:v}=Pe();w(i,D,d=>o(13,t=d)),w(i,z,d=>o(16,n=d)),w(i,v,d=>o(0,l=d));let b,C=!0;return Te(()=>{if(console.log("gj source getting torn down"),l){let d=l;if(console.log(`... will be removing ${d}`),Q(v,l=null,l),o(11,b=void 0),t!=null&&t.loaded()){console.log(`... actually removed ${d}`),Xe(t,d);let T=t.getSource(d);console.log(`its gone, right? ${T}`)}}}),i.$$set=d=>{"id"in d&&o(4,m=d.id),"data"in d&&o(5,h=d.data),"generateId"in d&&o(6,a=d.generateId),"promoteId"in d&&o(7,r=d.promoteId),"filter"in d&&o(8,L=d.filter),"lineMetrics"in d&&o(9,S=d.lineMetrics),"cluster"in d&&o(10,y=d.cluster),"$$scope"in d&&o(14,c=d.$$scope)},i.$$.update=()=>{i.$$.dirty&1024&&Q(z,n=y,n),i.$$.dirty&10225&&t&&l!==m&&(console.log(`$source is ${l}, id is ${m}`),l&&(console.log(`removing existing $source ${l}`),t.removeSource(l)),Q(v,l=m,l),console.log(`just set $source to ${m}. adding source now.`),t.addSource(l,ne({type:"geojson",data:h,filter:L,lineMetrics:S,generateId:a,promoteId:r,cluster:!!y,clusterMinPoints:y==null?void 0:y.minPoints,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius,clusterProperties:y==null?void 0:y.properties})),o(11,b=t.getSource(l)),o(12,C=!0)),i.$$.dirty&6176&&b&&(C?o(12,C=!1):b.setData(h)),i.$$.dirty&3072&&(b==null||b.setClusterOptions(ne({cluster:!!y,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius})))},[l,D,z,v,m,h,a,r,L,S,y,b,C,t,c,f]}class $e extends Y{constructor(e){super(),x(this,e,Ke,We,q,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}export{Ye as F,$e as G,Ve as L,pe as a,xe as h};
