import{S as k,i as w,s as C,F as H,g as I,m as E,t as S,n as T,q,e as D,h as b,j as B,w as O,p as P,b as R,Q as _,C as j,b0 as A,H as G,B as Q,r as W,a8 as z}from"./index-73f03f95.js";function J(a){let e,i,t;return{c(){e=D("input"),e.disabled=a[2],b(e,"class","govuk-file-upload"),b(e,"id",a[1]),b(e,"type","file")},m(l,o){B(l,e,o),a[6](e),i||(t=O(e,"change",a[4]),i=!0)},p(l,o){o&4&&(e.disabled=l[2]),o&2&&b(e,"id",l[1])},d(l){l&&P(e),a[6](null),i=!1,t()}}}function K(a){let e,i;return e=new H({props:{label:a[0],id:a[1],$$slots:{default:[J]},$$scope:{ctx:a}}}),{c(){I(e.$$.fragment)},m(t,l){E(e,t,l),i=!0},p(t,[l]){const o={};l&1&&(o.label=t[0]),l&2&&(o.id=t[1]),l&142&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){i||(S(e.$$.fragment,t),i=!0)},o(t){T(e.$$.fragment,t),i=!1},d(t){q(e,t)}}}function N(a,e,i){let{label:t}=e,{id:l}=e,{loadFile:o}=e,{disabled:s=!1}=e,f;function d(r){let u=new FileReader;u.onload=h=>{o(h.target.result)};let m=f.files;u.readAsText(m[0])}function g(r){R[r?"unshift":"push"](()=>{f=r,i(3,f)})}return a.$$set=r=>{"label"in r&&i(0,t=r.label),"id"in r&&i(1,l=r.id),"loadFile"in r&&i(5,o=r.loadFile),"disabled"in r&&i(2,s=r.disabled)},[t,l,s,f,d,o,g]}class X extends k{constructor(e){super(),w(this,e,N,K,C,{label:0,id:1,loadFile:5,disabled:2})}}function U(a,e,i){let t,l;_(a,j,n=>i(6,t=n)),_(a,A,n=>i(7,l=n));const o=G();let{layer:s}=e,{clickable:f}=e,{tooltip:d=null}=e,{show:g=!0}=e,{ignoreHigherLayers:r=[]}=e,{hoveredFeature:u=null}=e,m=new Q.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});W(()=>{t.on("mousemove",s,h),t.on("mouseleave",s,y),f&&t.on("click",s,F)}),z(()=>{t.off("mousemove",s,h),t.off("mouseleave",s,y),f&&t.off("click",s,F),L(),m.remove()});function h(n){if(!l)return;let c=n.features??[];if(c.length!=0){if(c[0].id||console.log(`Features in the ${s} layer don't have IDs; InteractiveLayer won't work`),v(n)){y();return}if((u==null?void 0:u.id)!=c[0].id){if(L(),i(0,u=c[0]),t.setFeatureState(u,{hover:!0}),d){let M=`<div class="govuk-prose">${d(u)}</div>`;m.setLngLat(n.lngLat).setHTML(M).addTo(t)}f&&(t.getCanvas().style.cursor="pointer")}else d&&m.setLngLat(n.lngLat)}}function y(){l&&(L(),i(0,u=null),m.remove(),f&&(t.getCanvas().style.cursor="inherit"))}function L(){u&&t.setFeatureState(u,{hover:!1})}function F(n){if(!l)return;let c=n.features??[];if(c.length>0){if(v(n))return;o("click",c[0])}}function v(n){for(let c of t.queryRenderedFeatures(n.point)){if(c.layer.id==s)return!1;if(!r.includes(c.layer.id))return!0}return!1}return a.$$set=n=>{"layer"in n&&i(1,s=n.layer),"clickable"in n&&i(2,f=n.clickable),"tooltip"in n&&i(3,d=n.tooltip),"show"in n&&i(4,g=n.show),"ignoreHigherLayers"in n&&i(5,r=n.ignoreHigherLayers),"hoveredFeature"in n&&i(0,u=n.hoveredFeature)},a.$$.update=()=>{a.$$.dirty&82&&t.getLayer(s)&&t.setLayoutProperty(s,"visibility",g?"visible":"none")},[u,s,f,d,g,r,t]}class Y extends k{constructor(e){super(),w(this,e,U,null,C,{layer:1,clickable:2,tooltip:3,show:4,ignoreHigherLayers:5,hoveredFeature:0})}}export{X as F,Y as I};
