import{S as J,i as B,s as G,e as de,h as be,an as Fe,j as P,x as te,p as j,g as A,m as Z,t as v,n as b,q as N,ax as Ae,y as ne,o as oe,ay as Ke,d as U,u as Xe,k as ve,I as Ye,_ as ye,H as Qe,N as R,a1 as We,aR as me,aH as re,aI as ie,aJ as le,aK as ae,b as Le,c as Te,l as Ce,aV as S,a as Ue,C as pe,av as xe,D as $e,P as et,Z as tt,Y as nt,X as Ze,ao as Ne,a3 as ce,a$ as ot,b0 as rt}from"./index-f4bce88c.js";import{C as it,g as ue,f as lt,u as at,a as Pe,l as ee,c as z}from"./StreetViewController-4d87452d.js";function ut(t){let e;return{c(){e=de("span"),be(e,"class","svelte-kzgqtg"),Fe(e,"background",t[0])},m(o,n){P(o,e,n)},p(o,[n]){n&1&&Fe(e,"background",o[0])},i:te,o:te,d(o){o&&j(e)}}}function ft(t,e,o){let{color:n}=e;return t.$$set=r=>{"color"in r&&o(0,n=r.color)},[n]}class st extends J{constructor(e){super(),B(this,e,ft,ut,G,{color:0})}}function je(t,e,o){const n=t.slice();return n[1]=e[o][0],n[2]=e[o][1],n}function Ge(t){let e,o,n,r=t[1]+"",l,i,u;return o=new st({props:{color:t[2]}}),{c(){e=de("li"),A(o.$$.fragment),n=U(),l=Xe(r),i=U()},m(a,h){P(a,e,h),Z(o,e,null),ve(e,n),ve(e,l),ve(e,i),u=!0},p(a,h){const m={};h&1&&(m.color=a[2]),o.$set(m),(!u||h&1)&&r!==(r=a[1]+"")&&Ye(l,r)},i(a){u||(v(o.$$.fragment,a),u=!0)},o(a){b(o.$$.fragment,a),u=!1},d(a){a&&j(e),N(o)}}}function ct(t){let e,o,n=Ae(t[0]),r=[];for(let i=0;i<n.length;i+=1)r[i]=Ge(je(t,n,i));const l=i=>b(r[i],1,1,()=>{r[i]=null});return{c(){e=de("ul");for(let i=0;i<r.length;i+=1)r[i].c()},m(i,u){P(i,e,u);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);o=!0},p(i,u){if(u&1){n=Ae(i[0]);let a;for(a=0;a<n.length;a+=1){const h=je(i,n,a);r[a]?(r[a].p(h,u),v(r[a],1)):(r[a]=Ge(h),r[a].c(),v(r[a],1),r[a].m(e,null))}for(ne(),a=n.length;a<r.length;a+=1)l(a);oe()}},i(i){if(!o){for(let u=0;u<n.length;u+=1)v(r[u]);o=!0}},o(i){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)b(r[u]);o=!1},d(i){i&&j(e),Ke(r,i)}}}function mt(t){let e,o;return e=new it({props:{label:"Legend",$$slots:{default:[ct]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment)},m(n,r){Z(e,n,r),o=!0},p(n,[r]){const l={};r&33&&(l.$$scope={dirty:r,ctx:n}),e.$set(l)},i(n){o||(v(e.$$.fragment,n),o=!0)},o(n){b(e.$$.fragment,n),o=!1},d(n){N(e,n)}}}function dt(t,e,o){let{rows:n}=e;return t.$$set=r=>{"rows"in r&&o(0,n=r.rows)},[n]}class Vt extends J{constructor(e){super(),B(this,e,dt,mt,G,{rows:0})}}function Ee(t){let e;return o=>{if(o)for(let n in o){let r=e==null?void 0:e[n],l=o[n];r!==l&&t(n,l,r)}else if(e)for(let n in e)t(n,void 0,e[n]);e=o}}function yt(t,...e){let o=[t];for(let n of e)if(n)Array.isArray(n)&&n[0]===t?o.push(...n.slice(1)):o.push(n);else continue;if(o.length!==1)return o.length===2?o[1]:o}function ht(t){return t===!0?["has","point_count"]:t===!1?["!",["has","point_count"]]:void 0}function Wt(t,e){return["case",["boolean",["feature-state","hover"],!1],e,t]}var Ie=gt;function gt(t){var e,o,n;if(t){if(Array.isArray(t)){for(e=[],o=t.length,n=0;n<o;n++){var r=t[n];r!=null&&e.push(r)}return e}if(typeof t=="object"){e={};var l=Object.keys(t);for(o=l.length,n=0;n<o;n++){var i=l[n],u=t[i];u!=null&&(e[i]=u)}return e}}}function Oe(t){let e=t[0],o,n,r=Re(t);return{c(){r.c(),o=ye()},m(l,i){r.m(l,i),P(l,o,i),n=!0},p(l,i){i[0]&1&&G(e,e=l[0])?(ne(),b(r,1,1,te),oe(),r=Re(l),r.c(),v(r,1),r.m(o.parentNode,o)):r.p(l,i)},i(l){n||(v(r),n=!0)},o(l){b(r),n=!1},d(l){l&&j(o),r.d(l)}}}function Re(t){let e;const o=t[35].default,n=re(o,t,t[34],null);return{c(){n&&n.c()},m(r,l){n&&n.m(r,l),e=!0},p(r,l){n&&n.p&&(!e||l[1]&8)&&ie(n,o,r,r[34],e?ae(o,r[34],l,null):le(r[34]),null)},i(r){e||(v(n,r),e=!0)},o(r){b(n,r),e=!1},d(r){n&&n.d(r)}}}function _t(t){let e,o,n=t[0]&&Oe(t);return{c(){n&&n.c(),e=ye()},m(r,l){n&&n.m(r,l),P(r,e,l),o=!0},p(r,l){r[0]?n?(n.p(r,l),l[0]&1&&v(n,1)):(n=Oe(r),n.c(),v(n,1),n.m(e.parentNode,e)):n&&(ne(),b(n,1,1,()=>{n=null}),oe())},i(r){o||(v(n),o=!0)},o(r){b(n),o=!1},d(r){r&&j(e),n&&n.d(r)}}}function vt(t,e,o){let n,r,l,i,u,a,h,m,s,_,T,y,{$$slots:M={},$$scope:C}=e,{id:L=ue("layer")}=e,{source:I=void 0}=e,{sourceLayer:w=void 0}=e,{beforeId:g=void 0}=e,{beforeLayerType:H=void 0}=e,{type:D}=e,{paint:E=void 0}=e,{layout:O=void 0}=e,{filter:q=void 0}=e,{applyToClusters:f=void 0}=e,{minzoom:d=void 0}=e,{maxzoom:he=void 0}=e,{manageHoverState:fe=!1}=e,{hovered:p=null}=e,{hoverCursor:x=void 0}=e,{eventsIfTopMost:$=!1}=e;const se=Qe(),{map:ke,source:ze,self:ge,minzoom:Me,maxzoom:we,eventTopMost:_e}=lt();R(t,ke,c=>o(30,s=c)),R(t,ze,c=>o(31,_=c)),R(t,ge,c=>o(0,m=c)),R(t,Me,c=>o(33,y=c)),R(t,we,c=>o(32,T=c)),We(()=>{m&&s&&(s==null||s.removeLayer(m))});let V;return t.$$set=c=>{"id"in c&&o(7,L=c.id),"source"in c&&o(8,I=c.source),"sourceLayer"in c&&o(9,w=c.sourceLayer),"beforeId"in c&&o(10,g=c.beforeId),"beforeLayerType"in c&&o(11,H=c.beforeLayerType),"type"in c&&o(12,D=c.type),"paint"in c&&o(13,E=c.paint),"layout"in c&&o(14,O=c.layout),"filter"in c&&o(15,q=c.filter),"applyToClusters"in c&&o(16,f=c.applyToClusters),"minzoom"in c&&o(17,d=c.minzoom),"maxzoom"in c&&o(18,he=c.maxzoom),"manageHoverState"in c&&o(19,fe=c.manageHoverState),"hovered"in c&&o(6,p=c.hovered),"hoverCursor"in c&&o(20,x=c.hoverCursor),"eventsIfTopMost"in c&&o(21,$=c.eventsIfTopMost),"$$scope"in c&&o(34,C=c.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&65536&&o(29,n=ht(f)),t.$$.dirty[0]&536903680&&o(28,r=yt("all",n,q)),t.$$.dirty[0]&131072|t.$$.dirty[1]&4&&o(24,l=d??y),t.$$.dirty[0]&262144|t.$$.dirty[1]&2&&o(23,i=he??T),t.$$.dirty[0]&256|t.$$.dirty[1]&1&&o(27,u=I||_),t.$$.dirty[0]&1509457537&&s&&m!==L&&u){let c=function(k){var X,Y;if(!m||!s||$&&_e(k)!==m)return;let F=k.features??[],W=(Y=(X=F[0])==null?void 0:X.properties)==null?void 0:Y.cluster_id,K={event:k,map:s,clusterId:W,layer:m,source:u,features:F};se(k.type,K)},Q=g;if(!g&&H){let k=s.getStyle().layers,F=typeof H=="function"?H:K=>K.type===H,W=k==null?void 0:k.find(F);W&&(Q=W.id)}me(ge,m=L,m),s.addLayer(Ie({id:m,type:D,source:u,"source-layer":w,filter:r,paint:E,layout:O,minzoom:l,maxzoom:i}),Q),s.on("click",m,c),s.on("dblclick",m,c),s.on("contextmenu",m,c),s.on("mouseenter",m,k=>{var X,Y;if(!m||!s||$&&_e(k)!==m)return;x&&(s.getCanvas().style.cursor=x);let F=k.features??[];o(6,p=F[0]??null);let W=(Y=(X=F[0])==null?void 0:X.properties)==null?void 0:Y.cluster_id;se("mouseenter",{event:k,map:s,clusterId:W,layer:m,source:u,features:F})}),s.on("mousemove",m,k=>{var X,Y,He;if($&&_e(k)!==m)return;let F=k.features??[],W=(Y=(X=F[0])==null?void 0:X.properties)==null?void 0:Y.cluster_id,K=(He=F[0])==null?void 0:He.id;K!==V&&(fe&&(V!==void 0&&(s==null||s.setFeatureState({source:u,id:V},{hover:!1})),s==null||s.setFeatureState({source:u,id:K},{hover:!0})),o(22,V=K),o(6,p=F[0]??null)),se("mousemove",{event:k,map:s,clusterId:W,layer:m,source:u,features:F})}),s.on("mouseleave",m,k=>{!m||!s||(x&&(s.getCanvas().style.cursor=""),o(6,p=null),fe&&V!==void 0&&(s==null||s.setFeatureState({source:u,id:V},{hover:!1}),o(22,V=void 0)),se("mouseleave",{map:s,layer:m,source:u}))})}t.$$.dirty[0]&1073741825&&o(26,a=m?Ee((c,Q)=>s==null?void 0:s.setPaintProperty(m,c,Q)):void 0),t.$$.dirty[0]&1073741825&&o(25,h=m?Ee((c,Q)=>s==null?void 0:s.setLayoutProperty(m,c,Q)):void 0),t.$$.dirty[0]&67117056&&(a==null||a(E)),t.$$.dirty[0]&33570816&&(h==null||h(O)),t.$$.dirty[0]&1098907649&&m&&(s==null||s.setLayerZoomRange(m,l,i))},[m,ke,ze,ge,Me,we,p,L,I,w,g,H,D,E,O,q,f,d,he,fe,x,$,V,i,l,h,a,u,r,n,s,_,T,y,C,M]}class Se extends J{constructor(e){super(),B(this,e,vt,_t,G,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,hoverCursor:20,eventsIfTopMost:21},null,[-1,-1])}}function bt(t){let e;const o=t[15].default,n=re(o,t,t[23],null);return{c(){n&&n.c()},m(r,l){n&&n.m(r,l),e=!0},p(r,l){n&&n.p&&(!e||l&8388608)&&ie(n,o,r,r[23],e?ae(o,r[23],l,null):le(r[23]),null)},i(r){e||(v(n,r),e=!0)},o(r){b(n,r),e=!1},d(r){n&&n.d(r)}}}function It(t){let e,o,n;function r(i){t[16](i)}let l={id:t[1],type:"circle",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],$$slots:{default:[bt]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.hovered=t[0]),e=new Se({props:l}),Le.push(()=>Te(e,"hovered",r)),e.$on("click",t[17]),e.$on("dblclick",t[18]),e.$on("contextmenu",t[19]),e.$on("mouseenter",t[20]),e.$on("mousemove",t[21]),e.$on("mouseleave",t[22]),{c(){A(e.$$.fragment)},m(i,u){Z(e,i,u),n=!0},p(i,[u]){const a={};u&2&&(a.id=i[1]),u&4&&(a.source=i[2]),u&8&&(a.sourceLayer=i[3]),u&16&&(a.beforeId=i[4]),u&32&&(a.beforeLayerType=i[5]),u&64&&(a.paint=i[6]),u&128&&(a.layout=i[7]),u&256&&(a.filter=i[8]),u&512&&(a.applyToClusters=i[9]),u&1024&&(a.minzoom=i[10]),u&2048&&(a.maxzoom=i[11]),u&4096&&(a.hoverCursor=i[12]),u&8192&&(a.manageHoverState=i[13]),u&16384&&(a.eventsIfTopMost=i[14]),u&8388608&&(a.$$scope={dirty:u,ctx:i}),!o&&u&1&&(o=!0,a.hovered=i[0],Ce(()=>o=!1)),e.$set(a)},i(i){n||(v(e.$$.fragment,i),n=!0)},o(i){b(e.$$.fragment,i),n=!1},d(i){N(e,i)}}}function Lt(t,e,o){let{$$slots:n={},$$scope:r}=e,{id:l=ue("circle")}=e,{source:i=void 0}=e,{sourceLayer:u=void 0}=e,{beforeId:a=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:m}=e,{layout:s=void 0}=e,{filter:_=void 0}=e,{applyToClusters:T=void 0}=e,{minzoom:y=void 0}=e,{maxzoom:M=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:L=!1}=e,{hovered:I=null}=e,{eventsIfTopMost:w=!1}=e;function g(d){I=d,o(0,I)}function H(d){S.call(this,t,d)}function D(d){S.call(this,t,d)}function E(d){S.call(this,t,d)}function O(d){S.call(this,t,d)}function q(d){S.call(this,t,d)}function f(d){S.call(this,t,d)}return t.$$set=d=>{"id"in d&&o(1,l=d.id),"source"in d&&o(2,i=d.source),"sourceLayer"in d&&o(3,u=d.sourceLayer),"beforeId"in d&&o(4,a=d.beforeId),"beforeLayerType"in d&&o(5,h=d.beforeLayerType),"paint"in d&&o(6,m=d.paint),"layout"in d&&o(7,s=d.layout),"filter"in d&&o(8,_=d.filter),"applyToClusters"in d&&o(9,T=d.applyToClusters),"minzoom"in d&&o(10,y=d.minzoom),"maxzoom"in d&&o(11,M=d.maxzoom),"hoverCursor"in d&&o(12,C=d.hoverCursor),"manageHoverState"in d&&o(13,L=d.manageHoverState),"hovered"in d&&o(0,I=d.hovered),"eventsIfTopMost"in d&&o(14,w=d.eventsIfTopMost),"$$scope"in d&&o(23,r=d.$$scope)},[I,l,i,u,a,h,m,s,_,T,y,M,C,L,w,n,g,H,D,E,O,q,f,r]}class De extends J{constructor(e){super(),B(this,e,Lt,It,G,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14})}}function Tt(t){let e;const o=t[14].default,n=re(o,t,t[22],null);return{c(){n&&n.c()},m(r,l){n&&n.m(r,l),e=!0},p(r,l){n&&n.p&&(!e||l&4194304)&&ie(n,o,r,r[22],e?ae(o,r[22],l,null):le(r[22]),null)},i(r){e||(v(n,r),e=!0)},o(r){b(n,r),e=!1},d(r){n&&n.d(r)}}}function Ct(t){let e,o,n;function r(i){t[15](i)}let l={id:t[1],type:"fill",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],minzoom:t[9],maxzoom:t[10],hoverCursor:t[11],manageHoverState:t[12],eventsIfTopMost:t[13],$$slots:{default:[Tt]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.hovered=t[0]),e=new Se({props:l}),Le.push(()=>Te(e,"hovered",r)),e.$on("click",t[16]),e.$on("dblclick",t[17]),e.$on("contextmenu",t[18]),e.$on("mouseenter",t[19]),e.$on("mousemove",t[20]),e.$on("mouseleave",t[21]),{c(){A(e.$$.fragment)},m(i,u){Z(e,i,u),n=!0},p(i,[u]){const a={};u&2&&(a.id=i[1]),u&4&&(a.source=i[2]),u&8&&(a.sourceLayer=i[3]),u&16&&(a.beforeId=i[4]),u&32&&(a.beforeLayerType=i[5]),u&64&&(a.paint=i[6]),u&128&&(a.layout=i[7]),u&256&&(a.filter=i[8]),u&512&&(a.minzoom=i[9]),u&1024&&(a.maxzoom=i[10]),u&2048&&(a.hoverCursor=i[11]),u&4096&&(a.manageHoverState=i[12]),u&8192&&(a.eventsIfTopMost=i[13]),u&4194304&&(a.$$scope={dirty:u,ctx:i}),!o&&u&1&&(o=!0,a.hovered=i[0],Ce(()=>o=!1)),e.$set(a)},i(i){n||(v(e.$$.fragment,i),n=!0)},o(i){b(e.$$.fragment,i),n=!1},d(i){N(e,i)}}}function St(t,e,o){let{$$slots:n={},$$scope:r}=e,{id:l=ue("fill")}=e,{source:i=void 0}=e,{sourceLayer:u=void 0}=e,{beforeId:a=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:m}=e,{layout:s=void 0}=e,{filter:_=void 0}=e,{minzoom:T=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:M=void 0}=e,{manageHoverState:C=!1}=e,{hovered:L=null}=e,{eventsIfTopMost:I=!1}=e;function w(f){L=f,o(0,L)}function g(f){S.call(this,t,f)}function H(f){S.call(this,t,f)}function D(f){S.call(this,t,f)}function E(f){S.call(this,t,f)}function O(f){S.call(this,t,f)}function q(f){S.call(this,t,f)}return t.$$set=f=>{"id"in f&&o(1,l=f.id),"source"in f&&o(2,i=f.source),"sourceLayer"in f&&o(3,u=f.sourceLayer),"beforeId"in f&&o(4,a=f.beforeId),"beforeLayerType"in f&&o(5,h=f.beforeLayerType),"paint"in f&&o(6,m=f.paint),"layout"in f&&o(7,s=f.layout),"filter"in f&&o(8,_=f.filter),"minzoom"in f&&o(9,T=f.minzoom),"maxzoom"in f&&o(10,y=f.maxzoom),"hoverCursor"in f&&o(11,M=f.hoverCursor),"manageHoverState"in f&&o(12,C=f.manageHoverState),"hovered"in f&&o(0,L=f.hovered),"eventsIfTopMost"in f&&o(13,I=f.eventsIfTopMost),"$$scope"in f&&o(22,r=f.$$scope)},[L,l,i,u,a,h,m,s,_,T,y,M,C,I,n,w,g,H,D,E,O,q,r]}class kt extends J{constructor(e){super(),B(this,e,St,Ct,G,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}function qe(t){let e=t[0],o,n,r=Je(t);return{c(){r.c(),o=ye()},m(l,i){r.m(l,i),P(l,o,i),n=!0},p(l,i){i&1&&G(e,e=l[0])?(ne(),b(r,1,1,te),oe(),r=Je(l),r.c(),v(r,1),r.m(o.parentNode,o)):r.p(l,i)},i(l){n||(v(r),n=!0)},o(l){b(r),n=!1},d(l){l&&j(o),r.d(l)}}}function Je(t){let e;const o=t[15].default,n=re(o,t,t[14],null);return{c(){n&&n.c()},m(r,l){n&&n.m(r,l),e=!0},p(r,l){n&&n.p&&(!e||l&16384)&&ie(n,o,r,r[14],e?ae(o,r[14],l,null):le(r[14]),null)},i(r){e||(v(n,r),e=!0)},o(r){b(n,r),e=!1},d(r){n&&n.d(r)}}}function zt(t){let e,o,n=t[0]&&qe(t);return{c(){n&&n.c(),e=ye()},m(r,l){n&&n.m(r,l),P(r,e,l),o=!0},p(r,[l]){r[0]?n?(n.p(r,l),l&1&&v(n,1)):(n=qe(r),n.c(),v(n,1),n.m(e.parentNode,e)):n&&(ne(),b(n,1,1,()=>{n=null}),oe())},i(r){o||(v(n),o=!0)},o(r){b(n),o=!1},d(r){r&&j(e),n&&n.d(r)}}}function Mt(t,e){if(t.getSource(e)){let o=[];for(let n of t.getStyle().layers)"source"in n&&n.source==e&&o.push(n.id);for(let n of o)console.log(`had to remove ${n} first`),t.removeLayer(n);t.removeSource(e)}}function wt(t,e,o){let n,r,l,{$$slots:i={},$$scope:u}=e,{id:a=ue("geojson")}=e,{data:h}=e,{generateId:m=!1}=e,{promoteId:s=void 0}=e,{filter:_=void 0}=e,{lineMetrics:T=void 0}=e,{cluster:y=void 0}=e;const{map:M,cluster:C,self:L}=at();R(t,M,g=>o(13,n=g)),R(t,C,g=>o(16,l=g)),R(t,L,g=>o(0,r=g));let I,w=!0;return We(()=>{if(console.log("gj source getting torn down"),r){let g=r;if(console.log(`... will be removing ${g}`),me(L,r=null,r),o(11,I=void 0),n!=null&&n.loaded()){console.log(`... actually removed ${g}`),Mt(n,g);let H=n.getSource(g);console.log(`its gone, right? ${H}`)}}}),t.$$set=g=>{"id"in g&&o(4,a=g.id),"data"in g&&o(5,h=g.data),"generateId"in g&&o(6,m=g.generateId),"promoteId"in g&&o(7,s=g.promoteId),"filter"in g&&o(8,_=g.filter),"lineMetrics"in g&&o(9,T=g.lineMetrics),"cluster"in g&&o(10,y=g.cluster),"$$scope"in g&&o(14,u=g.$$scope)},t.$$.update=()=>{t.$$.dirty&1024&&me(C,l=y,l),t.$$.dirty&10225&&n&&r!==a&&(console.log(`$source is ${r}, id is ${a}`),r&&(console.log(`removing existing $source ${r}`),n.removeSource(r)),me(L,r=a,r),console.log(`just set $source to ${a}. adding source now.`),n.addSource(r,Ie({type:"geojson",data:h,filter:_,lineMetrics:T,generateId:m,promoteId:s,cluster:!!y,clusterMinPoints:y==null?void 0:y.minPoints,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius,clusterProperties:y==null?void 0:y.properties})),o(11,I=n.getSource(r)),o(12,w=!0)),t.$$.dirty&6176&&I&&(w?o(12,w=!1):I.setData(h)),t.$$.dirty&3072&&(I==null||I.setClusterOptions(Ie({cluster:!!y,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius})))},[r,M,C,L,a,h,m,s,_,T,y,I,w,n,u,i]}class Ht extends J{constructor(e){super(),B(this,e,wt,zt,G,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Ft(t){let e;const o=t[14].default,n=re(o,t,t[22],null);return{c(){n&&n.c()},m(r,l){n&&n.m(r,l),e=!0},p(r,l){n&&n.p&&(!e||l&4194304)&&ie(n,o,r,r[22],e?ae(o,r[22],l,null):le(r[22]),null)},i(r){e||(v(n,r),e=!0)},o(r){b(n,r),e=!1},d(r){n&&n.d(r)}}}function At(t){let e,o,n;function r(i){t[15](i)}let l={id:t[1],type:"line",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],minzoom:t[9],maxzoom:t[10],hoverCursor:t[11],manageHoverState:t[12],eventsIfTopMost:t[13],$$slots:{default:[Ft]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.hovered=t[0]),e=new Se({props:l}),Le.push(()=>Te(e,"hovered",r)),e.$on("click",t[16]),e.$on("dblclick",t[17]),e.$on("contextmenu",t[18]),e.$on("mouseenter",t[19]),e.$on("mousemove",t[20]),e.$on("mouseleave",t[21]),{c(){A(e.$$.fragment)},m(i,u){Z(e,i,u),n=!0},p(i,[u]){const a={};u&2&&(a.id=i[1]),u&4&&(a.source=i[2]),u&8&&(a.sourceLayer=i[3]),u&16&&(a.beforeId=i[4]),u&32&&(a.beforeLayerType=i[5]),u&64&&(a.paint=i[6]),u&128&&(a.layout=i[7]),u&256&&(a.filter=i[8]),u&512&&(a.minzoom=i[9]),u&1024&&(a.maxzoom=i[10]),u&2048&&(a.hoverCursor=i[11]),u&4096&&(a.manageHoverState=i[12]),u&8192&&(a.eventsIfTopMost=i[13]),u&4194304&&(a.$$scope={dirty:u,ctx:i}),!o&&u&1&&(o=!0,a.hovered=i[0],Ce(()=>o=!1)),e.$set(a)},i(i){n||(v(e.$$.fragment,i),n=!0)},o(i){b(e.$$.fragment,i),n=!1},d(i){N(e,i)}}}function Zt(t,e,o){let{$$slots:n={},$$scope:r}=e,{id:l=ue("line")}=e,{source:i=void 0}=e,{sourceLayer:u=void 0}=e,{beforeId:a=void 0}=e,{beforeLayerType:h=void 0}=e,{paint:m}=e,{layout:s=void 0}=e,{filter:_=void 0}=e,{minzoom:T=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:M=void 0}=e,{manageHoverState:C=!1}=e,{hovered:L=null}=e,{eventsIfTopMost:I=!1}=e;function w(f){L=f,o(0,L)}function g(f){S.call(this,t,f)}function H(f){S.call(this,t,f)}function D(f){S.call(this,t,f)}function E(f){S.call(this,t,f)}function O(f){S.call(this,t,f)}function q(f){S.call(this,t,f)}return t.$$set=f=>{"id"in f&&o(1,l=f.id),"source"in f&&o(2,i=f.source),"sourceLayer"in f&&o(3,u=f.sourceLayer),"beforeId"in f&&o(4,a=f.beforeId),"beforeLayerType"in f&&o(5,h=f.beforeLayerType),"paint"in f&&o(6,m=f.paint),"layout"in f&&o(7,s=f.layout),"filter"in f&&o(8,_=f.filter),"minzoom"in f&&o(9,T=f.minzoom),"maxzoom"in f&&o(10,y=f.maxzoom),"hoverCursor"in f&&o(11,M=f.hoverCursor),"manageHoverState"in f&&o(12,C=f.manageHoverState),"hovered"in f&&o(0,L=f.hovered),"eventsIfTopMost"in f&&o(13,I=f.eventsIfTopMost),"$$scope"in f&&o(22,r=f.$$scope)},[L,l,i,u,a,h,m,s,_,T,y,M,C,I,n,w,g,H,D,E,O,q,r]}class Be extends J{constructor(e){super(),B(this,e,Zt,At,G,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}const Nt="/atip/svelte_maplibre_v2/assets/zoom_out_map-b2e1091a.svg";function Pt(t){let e,o;return{c(){e=de("img"),xe(e.src,o=Nt)||be(e,"src",o),be(e,"alt","Zoom to show entire boundary")},m(n,r){P(n,e,r)},p:te,d(n){n&&j(e)}}}function jt(t){let e,o;return e=new Ue({props:{title:"Zoom to show entire boundary",$$slots:{default:[Pt]},$$scope:{ctx:t}}}),e.$on("click",t[0]),{c(){A(e.$$.fragment)},m(n,r){Z(e,n,r),o=!0},p(n,[r]){const l={};r&8&&(l.$$scope={dirty:r,ctx:n}),e.$set(l)},i(n){o||(v(e.$$.fragment,n),o=!0)},o(n){b(e.$$.fragment,n),o=!1},d(n){N(e,n)}}}function Gt(t,e,o){let n;R(t,pe,i=>o(2,n=i));let{boundaryGeojson:r}=e;function l(){n.fitBounds($e(r),{padding:20,animate:!0,duration:500})}return t.$$set=i=>{"boundaryGeojson"in i&&o(1,r=i.boundaryGeojson)},[l,r]}class Kt extends J{constructor(e){super(),B(this,e,Gt,jt,G,{boundaryGeojson:1})}}function Et(t){let e,o,n,r,l,i,u,a,h,m;return e=new De({props:{id:"interventions-points",filter:["all",tt,t[2],t[3]],paint:{"circle-color":t[0],"circle-radius":Pe}}}),n=new Be({props:{id:"interventions-lines",filter:["all",nt,t[2]],paint:{"line-color":t[0],"line-width":ee}}}),l=new De({props:{id:"interventions-lines-endpoints",filter:["==","endpoint",!0],paint:{"circle-radius":.5*ee,"circle-opacity":0,"circle-stroke-color":z.lineEndpointColor,"circle-stroke-width":2}}}),u=new kt({props:{id:"interventions-polygons",filter:["all",Ze,t[2]],paint:{"fill-color":t[0],"fill-opacity":.2}}}),h=new Be({props:{id:"interventions-polygons-outlines",filter:["all",Ze,t[2]],paint:{"line-color":t[0],"line-opacity":.5,"line-width":.7*ee}}}),{c(){A(e.$$.fragment),o=U(),A(n.$$.fragment),r=U(),A(l.$$.fragment),i=U(),A(u.$$.fragment),a=U(),A(h.$$.fragment)},m(s,_){Z(e,s,_),P(s,o,_),Z(n,s,_),P(s,r,_),Z(l,s,_),P(s,i,_),Z(u,s,_),P(s,a,_),Z(h,s,_),m=!0},p(s,_){const T={};_&1&&(T.paint={"circle-color":s[0],"circle-radius":Pe}),e.$set(T);const y={};_&1&&(y.paint={"line-color":s[0],"line-width":ee}),n.$set(y);const M={};_&1&&(M.paint={"fill-color":s[0],"fill-opacity":.2}),u.$set(M);const C={};_&1&&(C.paint={"line-color":s[0],"line-opacity":.5,"line-width":.7*ee}),h.$set(C)},i(s){m||(v(e.$$.fragment,s),v(n.$$.fragment,s),v(l.$$.fragment,s),v(u.$$.fragment,s),v(h.$$.fragment,s),m=!0)},o(s){b(e.$$.fragment,s),b(n.$$.fragment,s),b(l.$$.fragment,s),b(u.$$.fragment,s),b(h.$$.fragment,s),m=!1},d(s){s&&(j(o),j(r),j(i),j(a)),N(e,s),N(n,s),N(l,s),N(u,s),N(h,s)}}}function Ot(t){let e,o;return e=new Ht({props:{data:t[1],$$slots:{default:[Et]},$$scope:{ctx:t}}}),{c(){A(e.$$.fragment)},m(n,r){Z(e,n,r),o=!0},p(n,[r]){const l={};r&2&&(l.data=n[1]),r&33&&(l.$$scope={dirty:r,ctx:n}),e.$set(l)},i(n){o||(v(e.$$.fragment,n),o=!0)},o(n){b(e.$$.fragment,n),o=!1},d(n){N(e,n)}}}function Rt(t){let e=JSON.parse(JSON.stringify(t)),o=[];for(let n of e.features)if(n.geometry.type=="LineString"&&!n.properties.hide_while_editing)for(let r of[n.geometry.coordinates[0],n.geometry.coordinates[n.geometry.coordinates.length-1]])o.push({type:"Feature",properties:{endpoint:!0},geometry:{type:"Point",coordinates:r}});return e.features=e.features.concat(o),e}function Dt(t,e,o){let n,r;R(t,et,a=>o(4,r=a));let{colorInterventions:l}=e;const i=["!=","hide_while_editing",!0],u=["!=","endpoint",!0];return t.$$set=a=>{"colorInterventions"in a&&o(0,l=a.colorInterventions)},t.$$.update=()=>{t.$$.dirty&16&&o(1,n=Rt(r))},[l,n,i,u,r]}class Xt extends J{constructor(e){super(),B(this,e,Dt,Ot,G,{colorInterventions:0})}}function Yt(t){return{v1:"Scheme Design",v2:"Experimental Scheme Design",planning:"Development Planning",criticals:"Critical Issues",atf4:"ATF4 Scheme"}[t]}function Qt(t){return{v1:"an intervention",v2:"an intervention",planning:"a development",criticals:"a critical issue",atf4:"an intervention"}[t]}function Ut(t){return{v1:"interventions",v2:"interventions",planning:"developments",criticals:"critical issues",atf4:"interventions"}[t]}function pt(t){return t=="planning"?Ne(["get","reference_type",["get","planning"]],{preapp:z.preapp,outline:z.outline,"reserved matters":z["reserved matters"],"local plan":z["local plan"]},"black"):Ne(["get","intervention_type"],{area:z.area,route:z.route,crossing:z.crossing,other:z.other},"white")}function xt(t){return t=="planning"?[["Preapp",z.preapp],["Outline",z.outline],["Reserved matters",z["reserved matters"]],["Local plan",z["local plan"]]]:[["Areas",z.area],["Routes",z.route],["Crossings",z.crossing],["Other",z.other]]}function Ve(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function $t(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function en(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function qt(t,e,o){o===void 0&&(o={});var n=Ve(t),r=Ve(e),l=ce(r[1]-n[1]),i=ce(r[0]-n[0]),u=ce(n[1]),a=ce(r[1]),h=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(u)*Math.cos(a);return ot(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),o.units)}function tn(t,e){return e===void 0&&(e={}),rt(t,function(o,n){var r=n.geometry.coordinates;return o+qt(r[0],r[1],e)},0)}export{De as C,kt as F,Ht as G,Xt as I,Be as L,Kt as Z,$t as a,en as b,Ut as c,qt as d,Yt as e,pt as f,Ve as g,Vt as h,xt as i,Ie as j,Se as k,tn as l,Wt as m,st as n,Qt as s};
