import{S as U,i as G,s as z,M as Un,b as q,c as Z,e as N,d as T,g as _,av as Gn,h as K,j as d,k as M,m as b,w as wt,l as Y,t as m,n as h,p as g,q as w,aH as Re,aI as We,aJ as ze,aK as Ue,a2 as ge,y as te,o as re,H as Vn,N as J,a5 as vt,aQ as ct,x,aR as fe,aS as Je,aT as qn,aU as Xn,aV as Kn,r as yt,u as S,f as ar,am as Zn,C as me,ao as bn,T as gt,F as wn,a as Tt,v as gr,I as ie,B as xt,aA as Yn,ax as Fe,aL as Jn,aM as Qn,ad as xn,_ as fr,P as eo,Y as xe,aP as X,an as He,ay as Bt,aW as Be,Q as vn,G as mt,aX as Qe,aY as ue,R as yn,aZ as ur,a_ as to,Z as Ot,E as kn,a$ as hr,D as ro,aO as _r,L as no,z as oo,aE as lo}from"./index-0cd9f703.js";import{g as kt,u as so,e as Sn,m as io,f as Ht,C as Ae,b as Pt,d as se,c as ao,a as fo,B as uo,S as co,L as po,M as mo}from"./StreetViewController-ff6dea13.js";import{L as $o,h as br,f as Cn,l as go,C as ve,Z as ho,I as _o}from"./index-365452eb.js";import{I as pe}from"./InteractiveLayer-26690d40.js";import{F as bo}from"./FileInput-309d7d97.js";const wo="/atip/svelte_maplibre_v2/assets/help-d011708a.svg";function vo(n){let e,r;const t=n[1].default,o=Re(t,n,n[4],null);return{c(){e=N("div"),o&&o.c(),K(e,"class","govuk-prose")},m(l,i){d(l,e,i),o&&o.m(e,null),r=!0},p(l,i){o&&o.p&&(!r||i&16)&&We(o,t,l,l[4],r?Ue(t,l[4],i,null):ze(l[4]),null)},i(l){r||(m(o,l),r=!0)},o(l){h(o,l),r=!1},d(l){l&&g(e),o&&o.d(l)}}}function yo(n){let e,r,t,o,l,i,a,s,f;function u(p){n[3](p)}let c={title:"Help",$$slots:{default:[vo]},$$scope:{ctx:n}};return n[0]!==void 0&&(c.open=n[0]),l=new Un({props:c}),q.push(()=>Z(l,"open",u)),{c(){e=N("button"),r=N("img"),o=T(),_(l.$$.fragment),Gn(r.src,t=wo)||K(r,"src",t),K(r,"title","Help"),K(r,"alt","Help"),K(e,"class","svelte-7d9d1l")},m(p,$){d(p,e,$),M(e,r),d(p,o,$),b(l,p,$),a=!0,s||(f=wt(e,"click",n[2]),s=!0)},p(p,[$]){const y={};$&16&&(y.$$scope={dirty:$,ctx:p}),!i&&$&1&&(i=!0,y.open=p[0],Y(()=>i=!1)),l.$set(y)},i(p){a||(m(l.$$.fragment,p),a=!0)},o(p){h(l.$$.fragment,p),a=!1},d(p){p&&(g(e),g(o)),w(l,p),s=!1,f()}}}function ko(n,e,r){let{$$slots:t={},$$scope:o}=e,l=!1;const i=()=>r(0,l=!0);function a(s){l=s,r(0,l)}return n.$$set=s=>{"$$scope"in s&&r(4,o=s.$$scope)},[l,t,i,a,o]}class ae extends U{constructor(e){super(),G(this,e,ko,yo,z,{})}}function wr(n){let e;return r=>{if(r)for(let t in r){let o=e==null?void 0:e[t],l=r[t];o!==l&&n(t,l,o)}else if(e)for(let t in e)n(t,void 0,e[t]);e=r}}function So(n,...e){let r=[n];for(let t of e)if(t)Array.isArray(t)&&t[0]===n?r.push(...t.slice(1)):r.push(t);else continue;if(r.length!==1)return r.length===2?r[1]:r}function Co(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function $t(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}var Rt=Lo;function Lo(n){var e,r,t;if(n){if(Array.isArray(n)){for(e=[],r=n.length,t=0;t<r;t++){var o=n[t];o!=null&&e.push(o)}return e}if(typeof n=="object"){e={};var l=Object.keys(n);for(r=l.length,t=0;t<r;t++){var i=l[t],a=n[i];a!=null&&(e[i]=a)}return e}}}function vr(n){let e=n[0],r,t,o=yr(n);return{c(){o.c(),r=ge()},m(l,i){o.m(l,i),d(l,r,i),t=!0},p(l,i){i[0]&1&&z(e,e=l[0])?(te(),h(o,1,1,x),re(),o=yr(l),o.c(),m(o,1),o.m(r.parentNode,r)):o.p(l,i)},i(l){t||(m(o),t=!0)},o(l){h(o),t=!1},d(l){l&&g(r),o.d(l)}}}function yr(n){let e;const r=n[35].default,t=Re(r,n,n[34],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l[1]&8)&&We(t,r,o,o[34],e?Ue(r,o[34],l,null):ze(o[34]),null)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function To(n){let e,r,t=n[0]&&vr(n);return{c(){t&&t.c(),e=ge()},m(o,l){t&&t.m(o,l),d(o,e,l),r=!0},p(o,l){o[0]?t?(t.p(o,l),l[0]&1&&m(t,1)):(t=vr(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(te(),h(t,1,1,()=>{t=null}),re())},i(o){r||(m(t),r=!0)},o(o){h(t),r=!1},d(o){o&&g(e),t&&t.d(o)}}}function Oo(n,e,r){let t,o,l,i,a,s,f,u,c,p,$,y,{$$slots:k={},$$scope:C}=e,{id:v=kt("layer")}=e,{source:A=void 0}=e,{sourceLayer:F=void 0}=e,{beforeId:O=void 0}=e,{beforeLayerType:E=void 0}=e,{type:H}=e,{paint:I=void 0}=e,{layout:P=void 0}=e,{filter:D=void 0}=e,{applyToClusters:L=void 0}=e,{minzoom:B=void 0}=e,{maxzoom:W=void 0}=e,{manageHoverState:V=!1}=e,{hovered:oe=null}=e,{hoverCursor:Pe=void 0}=e,{eventsIfTopMost:ne=!1}=e;const ce=Vn(),{map:ye,source:he,self:_e,minzoom:Ve,maxzoom:Ce,eventTopMost:Me}=so();J(n,ye,R=>r(30,c=R)),J(n,he,R=>r(31,p=R)),J(n,_e,R=>r(0,u=R)),J(n,Ve,R=>r(33,y=R)),J(n,Ce,R=>r(32,$=R)),vt(()=>{u&&c&&(c==null||c.removeLayer(u))});let $e;return n.$$set=R=>{"id"in R&&r(7,v=R.id),"source"in R&&r(8,A=R.source),"sourceLayer"in R&&r(9,F=R.sourceLayer),"beforeId"in R&&r(10,O=R.beforeId),"beforeLayerType"in R&&r(11,E=R.beforeLayerType),"type"in R&&r(12,H=R.type),"paint"in R&&r(13,I=R.paint),"layout"in R&&r(14,P=R.layout),"filter"in R&&r(15,D=R.filter),"applyToClusters"in R&&r(16,L=R.applyToClusters),"minzoom"in R&&r(17,B=R.minzoom),"maxzoom"in R&&r(18,W=R.maxzoom),"manageHoverState"in R&&r(19,V=R.manageHoverState),"hovered"in R&&r(6,oe=R.hovered),"hoverCursor"in R&&r(20,Pe=R.hoverCursor),"eventsIfTopMost"in R&&r(21,ne=R.eventsIfTopMost),"$$scope"in R&&r(34,C=R.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&65536&&r(29,t=Co(L)),n.$$.dirty[0]&536903680&&r(28,o=So("all",t,D)),n.$$.dirty[0]&131072|n.$$.dirty[1]&4&&r(24,l=B??y),n.$$.dirty[0]&262144|n.$$.dirty[1]&2&&r(23,i=W??$),n.$$.dirty[0]&256|n.$$.dirty[1]&1&&r(27,a=A||p),n.$$.dirty[0]&1509457537&&c&&u!==v&&a){let R=function(le){var qe,Xe;if(!u||!c||ne&&Me(le)!==u)return;let j=le.features??[],ke=(Xe=(qe=j[0])==null?void 0:qe.properties)==null?void 0:Xe.cluster_id,Se={event:le,map:c,clusterId:ke,layer:u,source:a,features:j};ce(le.type,Se)},Le=O;if(!O&&E){let le=c.getStyle().layers,j=typeof E=="function"?E:Se=>Se.type===E,ke=le==null?void 0:le.find(j);ke&&(Le=ke.id)}ct(_e,u=v,u),c.addLayer(Rt({id:u,type:H,source:a,"source-layer":F,filter:o,paint:I,layout:P,minzoom:l,maxzoom:i}),Le),c.on("click",u,R),c.on("dblclick",u,R),c.on("contextmenu",u,R),c.on("mouseenter",u,le=>{var qe,Xe;if(!u||!c||ne&&Me(le)!==u)return;Pe&&(c.getCanvas().style.cursor=Pe);let j=le.features??[];r(6,oe=j[0]??null);let ke=(Xe=(qe=j[0])==null?void 0:qe.properties)==null?void 0:Xe.cluster_id;ce("mouseenter",{event:le,map:c,clusterId:ke,layer:u,source:a,features:j})}),c.on("mousemove",u,le=>{var qe,Xe,dr;if(ne&&Me(le)!==u)return;let j=le.features??[],ke=(Xe=(qe=j[0])==null?void 0:qe.properties)==null?void 0:Xe.cluster_id,Se=(dr=j[0])==null?void 0:dr.id;Se!==$e&&(V&&($e!==void 0&&(c==null||c.setFeatureState({source:a,id:$e},{hover:!1})),c==null||c.setFeatureState({source:a,id:Se},{hover:!0})),r(22,$e=Se),r(6,oe=j[0]??null)),ce("mousemove",{event:le,map:c,clusterId:ke,layer:u,source:a,features:j})}),c.on("mouseleave",u,le=>{!u||!c||(Pe&&(c.getCanvas().style.cursor=""),r(6,oe=null),V&&$e!==void 0&&(c==null||c.setFeatureState({source:a,id:$e},{hover:!1}),r(22,$e=void 0)),ce("mouseleave",{map:c,layer:u,source:a}))})}n.$$.dirty[0]&1073741825&&r(26,s=u?wr((R,Le)=>c==null?void 0:c.setPaintProperty(u,R,Le)):void 0),n.$$.dirty[0]&1073741825&&r(25,f=u?wr((R,Le)=>c==null?void 0:c.setLayoutProperty(u,R,Le)):void 0),n.$$.dirty[0]&67117056&&(s==null||s(I)),n.$$.dirty[0]&33570816&&(f==null||f(P)),n.$$.dirty[0]&1098907649&&u&&(c==null||c.setLayerZoomRange(u,l,i))},[u,ye,he,_e,Ve,Ce,oe,v,A,F,O,E,H,I,P,D,L,B,W,V,Pe,ne,$e,i,l,f,s,a,o,t,c,p,$,y,C,k]}class cr extends U{constructor(e){super(),G(this,e,Oo,To,z,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,hoverCursor:20,eventsIfTopMost:21},null,[-1,-1])}}function Ao(n){let e;const r=n[15].default,t=Re(r,n,n[23],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&8388608)&&We(t,r,o,o[23],e?Ue(r,o[23],l,null):ze(o[23]),null)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function Io(n){let e,r,t;function o(i){n[16](i)}let l={id:n[1],type:"circle",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],applyToClusters:n[9],minzoom:n[10],maxzoom:n[11],hoverCursor:n[12],manageHoverState:n[13],eventsIfTopMost:n[14],$$slots:{default:[Ao]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.hovered=n[0]),e=new cr({props:l}),q.push(()=>Z(e,"hovered",o)),e.$on("click",n[17]),e.$on("dblclick",n[18]),e.$on("contextmenu",n[19]),e.$on("mouseenter",n[20]),e.$on("mousemove",n[21]),e.$on("mouseleave",n[22]),{c(){_(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&8388608&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.hovered=i[0],Y(()=>r=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){w(e,i)}}}function Po(n,e,r){let{$$slots:t={},$$scope:o}=e,{id:l=kt("circle")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:u}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{applyToClusters:$=void 0}=e,{minzoom:y=void 0}=e,{maxzoom:k=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:v=!1}=e,{hovered:A=null}=e,{eventsIfTopMost:F=!1}=e;function O(B){A=B,r(0,A)}function E(B){fe.call(this,n,B)}function H(B){fe.call(this,n,B)}function I(B){fe.call(this,n,B)}function P(B){fe.call(this,n,B)}function D(B){fe.call(this,n,B)}function L(B){fe.call(this,n,B)}return n.$$set=B=>{"id"in B&&r(1,l=B.id),"source"in B&&r(2,i=B.source),"sourceLayer"in B&&r(3,a=B.sourceLayer),"beforeId"in B&&r(4,s=B.beforeId),"beforeLayerType"in B&&r(5,f=B.beforeLayerType),"paint"in B&&r(6,u=B.paint),"layout"in B&&r(7,c=B.layout),"filter"in B&&r(8,p=B.filter),"applyToClusters"in B&&r(9,$=B.applyToClusters),"minzoom"in B&&r(10,y=B.minzoom),"maxzoom"in B&&r(11,k=B.maxzoom),"hoverCursor"in B&&r(12,C=B.hoverCursor),"manageHoverState"in B&&r(13,v=B.manageHoverState),"hovered"in B&&r(0,A=B.hovered),"eventsIfTopMost"in B&&r(14,F=B.eventsIfTopMost),"$$scope"in B&&r(23,o=B.$$scope)},[A,l,i,a,s,f,u,c,p,$,y,k,C,v,F,t,O,E,H,I,P,D,L,o]}class Mo extends U{constructor(e){super(),G(this,e,Po,Io,z,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14})}}function Eo(n){let e;const r=n[14].default,t=Re(r,n,n[22],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&4194304)&&We(t,r,o,o[22],e?Ue(r,o[22],l,null):ze(o[22]),null)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function No(n){let e,r,t;function o(i){n[15](i)}let l={id:n[1],type:"fill",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],$$slots:{default:[Eo]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.hovered=n[0]),e=new cr({props:l}),q.push(()=>Z(e,"hovered",o)),e.$on("click",n[16]),e.$on("dblclick",n[17]),e.$on("contextmenu",n[18]),e.$on("mouseenter",n[19]),e.$on("mousemove",n[20]),e.$on("mouseleave",n[21]),{c(){_(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.minzoom=i[9]),a&1024&&(s.maxzoom=i[10]),a&2048&&(s.hoverCursor=i[11]),a&4096&&(s.manageHoverState=i[12]),a&8192&&(s.eventsIfTopMost=i[13]),a&4194304&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.hovered=i[0],Y(()=>r=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){w(e,i)}}}function Do(n,e,r){let{$$slots:t={},$$scope:o}=e,{id:l=kt("fill")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:u}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{minzoom:$=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:k=void 0}=e,{manageHoverState:C=!1}=e,{hovered:v=null}=e,{eventsIfTopMost:A=!1}=e;function F(L){v=L,r(0,v)}function O(L){fe.call(this,n,L)}function E(L){fe.call(this,n,L)}function H(L){fe.call(this,n,L)}function I(L){fe.call(this,n,L)}function P(L){fe.call(this,n,L)}function D(L){fe.call(this,n,L)}return n.$$set=L=>{"id"in L&&r(1,l=L.id),"source"in L&&r(2,i=L.source),"sourceLayer"in L&&r(3,a=L.sourceLayer),"beforeId"in L&&r(4,s=L.beforeId),"beforeLayerType"in L&&r(5,f=L.beforeLayerType),"paint"in L&&r(6,u=L.paint),"layout"in L&&r(7,c=L.layout),"filter"in L&&r(8,p=L.filter),"minzoom"in L&&r(9,$=L.minzoom),"maxzoom"in L&&r(10,y=L.maxzoom),"hoverCursor"in L&&r(11,k=L.hoverCursor),"manageHoverState"in L&&r(12,C=L.manageHoverState),"hovered"in L&&r(0,v=L.hovered),"eventsIfTopMost"in L&&r(13,A=L.eventsIfTopMost),"$$scope"in L&&r(22,o=L.$$scope)},[v,l,i,a,s,f,u,c,p,$,y,k,C,A,t,F,O,E,H,I,P,D,o]}class St extends U{constructor(e){super(),G(this,e,Do,No,z,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}function kr(n){let e=n[0],r,t,o=Sr(n);return{c(){o.c(),r=ge()},m(l,i){o.m(l,i),d(l,r,i),t=!0},p(l,i){i&1&&z(e,e=l[0])?(te(),h(o,1,1,x),re(),o=Sr(l),o.c(),m(o,1),o.m(r.parentNode,r)):o.p(l,i)},i(l){t||(m(o),t=!0)},o(l){h(o),t=!1},d(l){l&&g(r),o.d(l)}}}function Sr(n){let e;const r=n[15].default,t=Re(r,n,n[14],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&16384)&&We(t,r,o,o[14],e?Ue(r,o[14],l,null):ze(o[14]),null)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function Fo(n){let e,r,t=n[0]&&kr(n);return{c(){t&&t.c(),e=ge()},m(o,l){t&&t.m(o,l),d(o,e,l),r=!0},p(o,[l]){o[0]?t?(t.p(o,l),l&1&&m(t,1)):(t=kr(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(te(),h(t,1,1,()=>{t=null}),re())},i(o){r||(m(t),r=!0)},o(o){h(t),r=!1},d(o){o&&g(e),t&&t.d(o)}}}function jo(n,e){if(n.getSource(e)){let r=[];for(let t of n.getStyle().layers)"source"in t&&t.source==e&&r.push(t.id);for(let t of r)console.log(`had to remove ${t} first`),n.removeLayer(t);n.removeSource(e)}}function Bo(n,e,r){let t,o,l,{$$slots:i={},$$scope:a}=e,{id:s=kt("geojson")}=e,{data:f}=e,{generateId:u=!1}=e,{promoteId:c=void 0}=e,{filter:p=void 0}=e,{lineMetrics:$=void 0}=e,{cluster:y=void 0}=e;const{map:k,cluster:C,self:v}=Sn();J(n,k,O=>r(13,t=O)),J(n,C,O=>r(16,l=O)),J(n,v,O=>r(0,o=O));let A,F=!0;return vt(()=>{if(console.log("gj source getting torn down"),o){let O=o;if(console.log(`... will be removing ${O}`),ct(v,o=null,o),r(11,A=void 0),t!=null&&t.loaded()){console.log(`... actually removed ${O}`),jo(t,O);let E=t.getSource(O);console.log(`its gone, right? ${E}`)}}}),n.$$set=O=>{"id"in O&&r(4,s=O.id),"data"in O&&r(5,f=O.data),"generateId"in O&&r(6,u=O.generateId),"promoteId"in O&&r(7,c=O.promoteId),"filter"in O&&r(8,p=O.filter),"lineMetrics"in O&&r(9,$=O.lineMetrics),"cluster"in O&&r(10,y=O.cluster),"$$scope"in O&&r(14,a=O.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&ct(C,l=y,l),n.$$.dirty&10225&&t&&o!==s&&(console.log(`$source is ${o}, id is ${s}`),o&&(console.log(`removing existing $source ${o}`),t.removeSource(o)),ct(v,o=s,o),console.log(`just set $source to ${s}. adding source now.`),t.addSource(o,Rt({type:"geojson",data:f,filter:p,lineMetrics:$,generateId:u,promoteId:c,cluster:!!y,clusterMinPoints:y==null?void 0:y.minPoints,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius,clusterProperties:y==null?void 0:y.properties})),r(11,A=t.getSource(o)),r(12,F=!0)),n.$$.dirty&6176&&A&&(F?r(12,F=!1):A.setData(f)),n.$$.dirty&3072&&(A==null||A.setClusterOptions(Rt({cluster:!!y,clusterMaxZoom:y==null?void 0:y.maxZoom,clusterRadius:y==null?void 0:y.radius})))},[o,k,C,v,s,f,u,c,p,$,y,A,F,t,a,i]}class pr extends U{constructor(e){super(),G(this,e,Bo,Fo,z,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Ho(n){let e;const r=n[14].default,t=Re(r,n,n[22],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&4194304)&&We(t,r,o,o[22],e?Ue(r,o[22],l,null):ze(o[22]),null)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function Ro(n){let e,r,t;function o(i){n[15](i)}let l={id:n[1],type:"line",source:n[2],sourceLayer:n[3],beforeId:n[4],beforeLayerType:n[5],paint:n[6],layout:n[7],filter:n[8],minzoom:n[9],maxzoom:n[10],hoverCursor:n[11],manageHoverState:n[12],eventsIfTopMost:n[13],$$slots:{default:[Ho]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.hovered=n[0]),e=new cr({props:l}),q.push(()=>Z(e,"hovered",o)),e.$on("click",n[16]),e.$on("dblclick",n[17]),e.$on("contextmenu",n[18]),e.$on("mouseenter",n[19]),e.$on("mousemove",n[20]),e.$on("mouseleave",n[21]),{c(){_(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.minzoom=i[9]),a&1024&&(s.maxzoom=i[10]),a&2048&&(s.hoverCursor=i[11]),a&4096&&(s.manageHoverState=i[12]),a&8192&&(s.eventsIfTopMost=i[13]),a&4194304&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.hovered=i[0],Y(()=>r=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){w(e,i)}}}function Wo(n,e,r){let{$$slots:t={},$$scope:o}=e,{id:l=kt("line")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:u}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{minzoom:$=void 0}=e,{maxzoom:y=void 0}=e,{hoverCursor:k=void 0}=e,{manageHoverState:C=!1}=e,{hovered:v=null}=e,{eventsIfTopMost:A=!1}=e;function F(L){v=L,r(0,v)}function O(L){fe.call(this,n,L)}function E(L){fe.call(this,n,L)}function H(L){fe.call(this,n,L)}function I(L){fe.call(this,n,L)}function P(L){fe.call(this,n,L)}function D(L){fe.call(this,n,L)}return n.$$set=L=>{"id"in L&&r(1,l=L.id),"source"in L&&r(2,i=L.source),"sourceLayer"in L&&r(3,a=L.sourceLayer),"beforeId"in L&&r(4,s=L.beforeId),"beforeLayerType"in L&&r(5,f=L.beforeLayerType),"paint"in L&&r(6,u=L.paint),"layout"in L&&r(7,c=L.layout),"filter"in L&&r(8,p=L.filter),"minzoom"in L&&r(9,$=L.minzoom),"maxzoom"in L&&r(10,y=L.maxzoom),"hoverCursor"in L&&r(11,k=L.hoverCursor),"manageHoverState"in L&&r(12,C=L.manageHoverState),"hovered"in L&&r(0,v=L.hovered),"eventsIfTopMost"in L&&r(13,A=L.eventsIfTopMost),"$$scope"in L&&r(22,o=L.$$scope)},[v,l,i,a,s,f,u,c,p,$,y,k,C,A,t,F,O,E,H,I,P,D,o]}class Ct extends U{constructor(e){super(),G(this,e,Wo,Ro,z,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}function Cr(n){let e=n[0],r,t,o=Lr(n);return{c(){o.c(),r=ge()},m(l,i){o.m(l,i),d(l,r,i),t=!0},p(l,i){i&1&&z(e,e=l[0])?(te(),h(o,1,1,x),re(),o=Lr(l),o.c(),m(o,1),o.m(r.parentNode,r)):o.p(l,i)},i(l){t||(m(o),t=!0)},o(l){h(o),t=!1},d(l){l&&g(r),o.d(l)}}}function Lr(n){let e;const r=n[8].default,t=Re(r,n,n[7],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&128)&&We(t,r,o,o[7],e?Ue(r,o[7],l,null):ze(o[7]),null)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function zo(n){let e,r,t=n[0]&&Cr(n);return{c(){t&&t.c(),e=ge()},m(o,l){t&&t.m(o,l),d(o,e,l),r=!0},p(o,[l]){o[0]?t?(t.p(o,l),l&1&&m(t,1)):(t=Cr(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(te(),h(t,1,1,()=>{t=null}),re())},i(o){r||(m(t),r=!0)},o(o){h(t),r=!1},d(o){o&&g(e),t&&t.d(o)}}}function Uo(n,e,r){let t,o,{$$slots:l={},$$scope:i}=e,{id:a=kt("vector")}=e,{url:s=null}=e,{tiles:f=null}=e;if(s&&s.includes("pmtiles://")&&!Je.config.REGISTERED_PROTOCOLS.hasOwnProperty("pmtiles")){let p=new Xn;Je.addProtocol("pmtiles",p.tile)}const{map:u,self:c}=Sn();return J(n,u,p=>r(6,t=p)),J(n,c,p=>r(0,o=p)),vt(()=>{if(o){let p=o;ct(c,o=null,o),qn().then(()=>{t!=null&&t.loaded()&&(t==null||t.removeSource(p))})}}),n.$$set=p=>{"id"in p&&r(3,a=p.id),"url"in p&&r(4,s=p.url),"tiles"in p&&r(5,f=p.tiles),"$$scope"in p&&r(7,i=p.$$scope)},n.$$.update=()=>{n.$$.dirty&121&&t&&o!==a&&(o&&t.removeSource(o),ct(c,o=a,o),t.addSource(o,Rt({type:"vector",url:s,tiles:f})))},[o,u,c,a,s,f,t,i,l]}class Mt extends U{constructor(e){super(),G(this,e,Uo,zo,z,{id:3,url:4,tiles:5})}}const Go=n=>({features:n[0]&16,data:n[0]&16,map:n[0]&4,close:n[0]&1}),Tr=n=>{var e;return{features:n[4],data:(e=n[4])==null?void 0:e[0],map:n[2],close:n[29]}};function Or(n){let e,r,t=(n[4]||n[3]instanceof Je.Marker)&&Ar(n);return{c(){e=N("div"),t&&t.c()},m(o,l){d(o,e,l),t&&t.m(e,null),n[30](e),r=!0},p(o,l){o[4]||o[3]instanceof Je.Marker?t?(t.p(o,l),l[0]&24&&m(t,1)):(t=Ar(o),t.c(),m(t,1),t.m(e,null)):t&&(te(),h(t,1,1,()=>{t=null}),re())},i(o){r||(m(t),r=!0)},o(o){h(t),r=!1},d(o){o&&g(e),t&&t.d(),n[30](null)}}}function Ar(n){let e;const r=n[28].default,t=Re(r,n,n[27],Tr);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l[0]&134217749)&&We(t,r,o,o[27],e?Ue(r,o[27],l,Go):ze(o[27]),Tr)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function Vo(n){let e,r,t=n[8].default&&Or(n);return{c(){t&&t.c(),e=ge()},m(o,l){t&&t.m(o,l),d(o,e,l),r=!0},p(o,l){o[8].default?t?(t.p(o,l),l[0]&256&&m(t,1)):(t=Or(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(te(),h(t,1,1,()=>{t=null}),re())},i(o){r||(m(t),r=!0)},o(o){h(t),r=!1},d(o){o&&g(e),t&&t.d(o)}}}function qo(n,e,r){let t,o,l,i,a,{$$slots:s={},$$scope:f}=e;const u=Kn(s);let{closeButton:c=void 0}=e,{closeOnClickOutside:p=!0}=e,{closeOnClickInside:$=!1}=e,{closeOnMove:y=!1}=e,{openOn:k="click"}=e,{focusAfterOpen:C=!0}=e,{anchor:v=void 0}=e,{offset:A=void 0}=e,{popupClass:F=void 0}=e,{maxWidth:O=void 0}=e,{lngLat:E=void 0}=e,{html:H=void 0}=e,{open:I=!1}=e;const{map:P,popupTarget:D,layerEvent:L}=io();J(n,P,j=>r(2,l=j)),J(n,D,j=>r(3,a=j)),J(n,L,j=>r(26,i=j));const B=["click","dblclick","contextmenu"];let W,V=!1,oe;function Pe(){if(!W)return;let j=W.getElement();!j||j===oe||(oe=j,k==="hover"&&(oe.style.pointerEvents="none"),oe.addEventListener("mouseenter",()=>{r(22,V=!0)},{passive:!0}),oe.addEventListener("mouseleave",()=>{r(22,V=!1)},{passive:!0}),oe.addEventListener("click",()=>{$&&r(0,I=!1)},{passive:!0}))}yt(()=>{if(l)return l.on("click",$e),typeof a=="string"&&(l.on("click",a,ye),l.on("dblclick",a,ye),l.on("contextmenu",a,ye),l.on("mousemove",a,Me),l.on("mouseleave",a,Ce),l.on("touchstart",a,_e),l.on("touchend",a,Ve)),()=>{l!=null&&l.loaded()&&(W==null||W.remove(),l.off("click",$e),a instanceof Je.Marker?a.getPopup()===W&&a.setPopup(void 0):typeof a=="string"&&(l.off("click",a,ye),l.off("dblclick",a,ye),l.off("contextmenu",a,ye),l.off("mousemove",a,Me),l.off("mouseleave",a,Ce),l.off("touchstart",a,_e),l.off("touchend",a,Ve)))}});let ne=null,ce="normal";function ye(j){j.type===k&&("layerType"in j?j.layerType==="deckgl"?(r(9,E=j.coordinate),r(4,ne=j.object?[j.object]:null)):(r(9,E=j.lngLat),r(4,ne=j.features??[])):(r(9,E=j.lngLat),r(4,ne=j.features??[])),setTimeout(()=>r(0,I=!0)))}let he=null;function _e(j){he=j.point}function Ve(j){if(!he||k!=="hover")return;let ke=he.dist(j.point);he=null,ke<3&&(r(9,E=j.lngLat),r(4,ne=j.features??[]),W.isOpen()?r(23,ce="justOpened"):(r(23,ce="opening"),r(0,I=!0)))}function Ce(j){k!=="hover"||he||ce!=="normal"||(r(0,I=!1),r(4,ne=null))}function Me(j){k!=="hover"||he||ce!=="normal"||(r(0,I=!0),r(4,ne=j.features??[]),r(9,E=j.lngLat))}function $e(j){if(ce==="justOpened"){r(23,ce="normal");return}if(!p)return;let ke=[oe,a instanceof Je.Marker?a==null?void 0:a.getElement():null];I&&W.isOpen()&&!ke.some(Se=>Se==null?void 0:Se.contains(j.originalEvent.target))&&r(0,I=!1)}let R;const Le=()=>r(0,I=!1);function le(j){q[j?"unshift":"push"](()=>{R=j,r(1,R)})}return n.$$set=j=>{"closeButton"in j&&r(10,c=j.closeButton),"closeOnClickOutside"in j&&r(11,p=j.closeOnClickOutside),"closeOnClickInside"in j&&r(12,$=j.closeOnClickInside),"closeOnMove"in j&&r(13,y=j.closeOnMove),"openOn"in j&&r(14,k=j.openOn),"focusAfterOpen"in j&&r(15,C=j.focusAfterOpen),"anchor"in j&&r(16,v=j.anchor),"offset"in j&&r(17,A=j.offset),"popupClass"in j&&r(18,F=j.popupClass),"maxWidth"in j&&r(19,O=j.maxWidth),"lngLat"in j&&r(9,E=j.lngLat),"html"in j&&r(20,H=j.html),"open"in j&&r(0,I=j.open),"$$scope"in j&&r(27,f=j.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&7168&&r(25,t=c??(!p&&!$)),n.$$.dirty[0]&36675584&&(W||(r(21,W=new Je.Popup({closeButton:t,closeOnClick:!1,closeOnMove:y,focusAfterOpen:C,maxWidth:O,className:F,anchor:v,offset:A})),oe=W.getElement(),W.on("open",()=>{r(0,I=!0),Pe()}),W.on("close",j=>{r(0,I=!1)}))),n.$$.dirty[0]&2113544&&W&&a instanceof Je.Marker&&(k==="click"?a.setPopup(W):a.getPopup()===W&&a.setPopup(void 0)),n.$$.dirty[0]&67125248&&B.includes(k)&&(i==null?void 0:i.type)===k&&(ye(i),ct(L,i=null,i)),n.$$.dirty[0]&67125248&&r(24,o=k==="hover"&&((i==null?void 0:i.type)==="mousemove"||(i==null?void 0:i.type)==="mouseenter")),n.$$.dirty[0]&88096768&&k==="hover"&&L&&(o&&i&&(i.layerType==="deckgl"?(r(9,E=i.coordinate),r(4,ne=i.object?[i.object]:null)):(r(9,E=i.lngLat),r(4,ne=i.features??[]))),r(0,I=(o||V)??!1)),n.$$.dirty[0]&3145730&&(R?W.setDOMContent(R):H&&W.setHTML(H)),n.$$.dirty[0]&2097664&&E&&W.setLngLat(E),n.$$.dirty[0]&10485765&&l){let j=W.isOpen();I&&!j?(W.addTo(l),ce==="opening"&&r(23,ce="justOpened")):!I&&j&&W.remove()}},[I,R,l,a,ne,P,D,L,u,E,c,p,$,y,k,C,v,A,F,O,H,W,V,ce,o,t,i,f,s,Le,le]}class et extends U{constructor(e){super(),G(this,e,qo,Vo,z,{closeButton:10,closeOnClickOutside:11,closeOnClickInside:12,closeOnMove:13,openOn:14,focusAfterOpen:15,anchor:16,offset:17,popupClass:18,maxWidth:19,lngLat:9,html:20,open:0},null,[-1,-1])}}function Xo(n){let e;return{c(){e=N("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ko(n){let e,r,t,o,l=n[0]=="Private (development)"&&Xo();return{c(){l&&l.c(),e=T(),r=N("p"),r.textContent="Note the ATF scheme data has not been validated.",t=T(),o=N("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(i,a){l&&l.m(i,a),d(i,e,a),d(i,r,a),d(i,t,a),d(i,o,a)},p:x,d(i){i&&(g(e),g(r),g(t),g(o)),l&&l.d(i)}}}function Zo(n){let e,r,t,o,l,i;return l=new ae({props:{$$slots:{default:[Ko]},$$scope:{ctx:n}}}),{c(){e=N("p"),r=S("App version: "),t=S(n[0]),o=T(),_(l.$$.fragment)},m(a,s){d(a,e,s),M(e,r),M(e,t),M(e,o),b(l,e,null),i=!0},p(a,[s]){const f={};s&2&&(f.$$scope={dirty:s,ctx:a}),l.$set(f)},i(a){i||(m(l.$$.fragment,a),i=!0)},o(a){h(l.$$.fragment,a),i=!1},d(a){a&&g(e),w(l)}}}function Yo(n){return[ar()]}class Jo extends U{constructor(e){super(),G(this,e,Yo,Zo,z,{})}}const Qo={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var be=Uint8Array,ft=Uint16Array,Ln=Uint32Array,Tn=new be([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),On=new be([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),xo=new be([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),An=function(n,e){for(var r=new ft(31),t=0;t<31;++t)r[t]=e+=1<<n[t-1];for(var o=new Ln(r[30]),t=1;t<30;++t)for(var l=r[t];l<r[t+1];++l)o[l]=l-r[t]<<5|t;return[r,o]},In=An(Tn,2),Pn=In[0],el=In[1];Pn[28]=258,el[258]=28;var tl=An(On,0),rl=tl[0],er=new ft(32768);for(var ee=0;ee<32768;++ee){var Ke=(ee&43690)>>>1|(ee&21845)<<1;Ke=(Ke&52428)>>>2|(Ke&13107)<<2,Ke=(Ke&61680)>>>4|(Ke&3855)<<4,er[ee]=((Ke&65280)>>>8|(Ke&255)<<8)>>>1}var Lt=function(n,e,r){for(var t=n.length,o=0,l=new ft(e);o<t;++o)n[o]&&++l[n[o]-1];var i=new ft(e);for(o=0;o<e;++o)i[o]=i[o-1]+l[o-1]<<1;var a;if(r){a=new ft(1<<e);var s=15-e;for(o=0;o<t;++o)if(n[o])for(var f=o<<4|n[o],u=e-n[o],c=i[n[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)a[er[c]>>>s]=f}else for(a=new ft(t),o=0;o<t;++o)n[o]&&(a[o]=er[i[n[o]-1]++]>>>15-n[o]);return a},Et=new be(288);for(var ee=0;ee<144;++ee)Et[ee]=8;for(var ee=144;ee<256;++ee)Et[ee]=9;for(var ee=256;ee<280;++ee)Et[ee]=7;for(var ee=280;ee<288;++ee)Et[ee]=8;var Mn=new be(32);for(var ee=0;ee<32;++ee)Mn[ee]=5;var nl=Lt(Et,9,1),ol=Lt(Mn,5,1),qt=function(n){for(var e=n[0],r=1;r<n.length;++r)n[r]>e&&(e=n[r]);return e},Te=function(n,e,r){var t=e/8|0;return(n[t]|n[t+1]<<8)>>(e&7)&r},Xt=function(n,e){var r=e/8|0;return(n[r]|n[r+1]<<8|n[r+2]<<16)>>(e&7)},ll=function(n){return(n+7)/8|0},mr=function(n,e,r){(e==null||e<0)&&(e=0),(r==null||r>n.length)&&(r=n.length);var t=new(n.BYTES_PER_ELEMENT==2?ft:n.BYTES_PER_ELEMENT==4?Ln:be)(r-e);return t.set(n.subarray(e,r)),t},sl=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Oe=function(n,e,r){var t=new Error(e||sl[n]);if(t.code=n,Error.captureStackTrace&&Error.captureStackTrace(t,Oe),!r)throw t;return t},il=function(n,e,r){var t=n.length;if(!t||r&&r.f&&!r.l)return e||new be(0);var o=!e||r,l=!r||r.i;r||(r={}),e||(e=new be(t*3));var i=function(Le){var le=e.length;if(Le>le){var j=new be(Math.max(le*2,Le));j.set(e),e=j}},a=r.f||0,s=r.p||0,f=r.b||0,u=r.l,c=r.d,p=r.m,$=r.n,y=t*8;do{if(!u){a=Te(n,s,1);var k=Te(n,s+1,3);if(s+=3,k)if(k==1)u=nl,c=ol,p=9,$=5;else if(k==2){var F=Te(n,s,31)+257,O=Te(n,s+10,15)+4,E=F+Te(n,s+5,31)+1;s+=14;for(var H=new be(E),I=new be(19),P=0;P<O;++P)I[xo[P]]=Te(n,s+P*3,7);s+=O*3;for(var D=qt(I),L=(1<<D)-1,B=Lt(I,D,1),P=0;P<E;){var W=B[Te(n,s,L)];s+=W&15;var C=W>>>4;if(C<16)H[P++]=C;else{var V=0,oe=0;for(C==16?(oe=3+Te(n,s,3),s+=2,V=H[P-1]):C==17?(oe=3+Te(n,s,7),s+=3):C==18&&(oe=11+Te(n,s,127),s+=7);oe--;)H[P++]=V}}var Pe=H.subarray(0,F),ne=H.subarray(F);p=qt(Pe),$=qt(ne),u=Lt(Pe,p,1),c=Lt(ne,$,1)}else Oe(1);else{var C=ll(s)+4,v=n[C-4]|n[C-3]<<8,A=C+v;if(A>t){l&&Oe(0);break}o&&i(f+v),e.set(n.subarray(C,A),f),r.b=f+=v,r.p=s=A*8,r.f=a;continue}if(s>y){l&&Oe(0);break}}o&&i(f+131072);for(var ce=(1<<p)-1,ye=(1<<$)-1,he=s;;he=s){var V=u[Xt(n,s)&ce],_e=V>>>4;if(s+=V&15,s>y){l&&Oe(0);break}if(V||Oe(2),_e<256)e[f++]=_e;else if(_e==256){he=s,u=null;break}else{var Ve=_e-254;if(_e>264){var P=_e-257,Ce=Tn[P];Ve=Te(n,s,(1<<Ce)-1)+Pn[P],s+=Ce}var Me=c[Xt(n,s)&ye],$e=Me>>>4;Me||Oe(3),s+=Me&15;var ne=rl[$e];if($e>3){var Ce=On[$e];ne+=Xt(n,s)&(1<<Ce)-1,s+=Ce}if(s>y){l&&Oe(0);break}o&&i(f+131072);for(var R=f+Ve;f<R;f+=4)e[f]=e[f-ne],e[f+1]=e[f+1-ne],e[f+2]=e[f+2-ne],e[f+3]=e[f+3-ne];f=R}}r.l=u,r.p=he,r.b=f,r.f=a,u&&(a=1,r.m=p,r.d=c,r.n=$)}while(!a);return f==e.length?e:mr(e,0,f)},al=new be(0),De=function(n,e){return n[e]|n[e+1]<<8},Ie=function(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0},Kt=function(n,e){return Ie(n,e)+Ie(n,e+4)*4294967296};function fl(n,e){return il(n,e)}var tr=typeof TextDecoder<"u"&&new TextDecoder,ul=0;try{tr.decode(al,{stream:!0}),ul=1}catch{}var cl=function(n){for(var e="",r=0;;){var t=n[r++],o=(t>127)+(t>223)+(t>239);if(r+o>n.length)return[e,mr(n,r-1)];o?o==3?(t=((t&15)<<18|(n[r++]&63)<<12|(n[r++]&63)<<6|n[r++]&63)-65536,e+=String.fromCharCode(55296|t>>10,56320|t&1023)):o&1?e+=String.fromCharCode((t&31)<<6|n[r++]&63):e+=String.fromCharCode((t&15)<<12|(n[r++]&63)<<6|n[r++]&63):e+=String.fromCharCode(t)}};function En(n,e){if(e){for(var r="",t=0;t<n.length;t+=16384)r+=String.fromCharCode.apply(null,n.subarray(t,t+16384));return r}else{if(tr)return tr.decode(n);var o=cl(n),l=o[0],i=o[1];return i.length&&Oe(8),l}}var pl=function(n,e){return e+30+De(n,e+26)+De(n,e+28)},ml=function(n,e,r){var t=De(n,e+28),o=En(n.subarray(e+46,e+46+t),!(De(n,e+8)&2048)),l=e+46+t,i=Ie(n,e+20),a=r&&i==4294967295?$l(n,l):[i,Ie(n,e+24),Ie(n,e+42)],s=a[0],f=a[1],u=a[2];return[De(n,e+10),s,f,o,l+De(n,e+30)+De(n,e+32),u]},$l=function(n,e){for(;De(n,e)!=1;e+=4+De(n,e+2));return[Kt(n,e+12),Kt(n,e+4),Kt(n,e+20)]};function dl(n,e){for(var r={},t=n.length-22;Ie(n,t)!=101010256;--t)(!t||n.length-t>65558)&&Oe(13);var o=De(n,t+8);if(!o)return{};var l=Ie(n,t+16),i=l==4294967295||o==65535;if(i){var a=Ie(n,t-12);i=Ie(n,a)==101075792,i&&(o=Ie(n,a+32),l=Ie(n,a+48))}for(var s=e&&e.filter,f=0;f<o;++f){var u=ml(n,l,i),c=u[0],p=u[1],$=u[2],y=u[3],k=u[4],C=u[5],v=pl(n,C);l=k,(!s||s({name:y,size:p,originalSize:$,compression:c}))&&(c?c==8?r[y]=fl(n.subarray(v,v+p),new be($)):Oe(14,"unknown compression type "+c):r[y]=mr(n,v,v+p))}return r}function gl(n){return n instanceof File||n instanceof Blob?n.arrayBuffer().then(Zt):Zt(n)}function Zt(n){var e=new Uint8Array(n),r=dl(e);return Promise.resolve(hl(r))}function hl(n){for(var e=[],r=0,t=Object.keys(n);r<t.length;r++){var o=t[r];e[o]=En(n[o])}return e}function je(n,e){for(var r=0;r<n.childNodes.length;){var t=n.childNodes[r];if(t.nodeType===1&&pt(t)===e)return t;r++}}function Nt(n,e){for(var r=[],t=0;t<n.childNodes.length;){var o=n.childNodes[t];o.nodeType===1&&pt(o)===e&&r.push(o),t++}return r}function Wt(n,e,r){for(var t=0;t<n.childNodes.length;){var o=n.childNodes[t];e?o.nodeType===1&&pt(o)===e&&r(o,t):r(o,t),t++}}function _l(n,e,r){var t=[];return Wt(n,e,function(o,l){t.push(r(o,l))}),t}var bl=/.+\:/;function pt(n){return n.tagName.replace(bl,"")}function Nn(n){if(n.nodeType!==1)return n.textContent;for(var e="<"+pt(n),r=0;r<n.attributes.length;)e+=" "+n.attributes[r].name+'="'+n.attributes[r].value+'"',r++;e+=">";for(var t=0;t<n.childNodes.length;)e+=Nn(n.childNodes[t]),t++;return e+="</"+pt(n)+">",e}function wl(n){var e=n.documentElement,r=je(e,"sheetData"),t=[];return Wt(r,"row",function(o){Wt(o,"c",function(l){t.push(l)})}),t}function vl(n,e){return je(e,"v")}function yl(n,e){if(e.firstChild&&pt(e.firstChild)==="is"&&e.firstChild.firstChild&&pt(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function kl(n){var e=n.documentElement,r=je(e,"dimension");if(r)return r.getAttribute("ref")}function Sl(n){var e=n.documentElement,r=je(e,"cellStyleXfs");return r?Nt(r,"xf"):[]}function Cl(n){var e=n.documentElement,r=je(e,"cellXfs");return r?Nt(r,"xf"):[]}function Ll(n){var e=n.documentElement,r=je(e,"numFmts");return r?Nt(r,"numFmt"):[]}function Tl(n){var e=n.documentElement;return _l(e,"si",function(r){var t=je(r,"t");if(t)return t.textContent;var o="";return Wt(r,"r",function(l){o+=je(l,"t").textContent}),o})}function Ol(n){var e=n.documentElement;return je(e,"workbookPr")}function Al(n){var e=n.documentElement;return Nt(e,"Relationship")}function Il(n){var e=n.documentElement,r=je(e,"sheets");return Nt(r,"sheet")}function Pl(n,e){var r=e.createDocument(n),t={},o=Ol(r);o&&o.getAttribute("date1904")==="1"&&(t.epoch1904=!0),t.sheets=[];var l=function(a){a.getAttribute("name")&&t.sheets.push({id:a.getAttribute("sheetId"),name:a.getAttribute("name"),relationId:a.getAttribute("r:id")})};return Il(r).forEach(l),t}function Ml(n,e){var r=e.createDocument(n),t={sheets:{},sharedStrings:void 0,styles:void 0},o=function(i){var a=i.getAttribute("Target"),s=i.getAttribute("Type");switch(s){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":t.styles=Yt(a);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":t.sharedStrings=Yt(a);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":t.sheets[i.getAttribute("Id")]=Yt(a);break}};return Al(r).forEach(o),t}function Yt(n){return n[0]==="/"?n.slice(1):"xl/"+n}function Ir(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),r.push.apply(r,t)}return r}function Pr(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ir(Object(r),!0).forEach(function(t){El(n,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Ir(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})}return n}function El(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function Nl(n,e){if(!n)return{};var r=e.createDocument(n),t=Sl(r).map(Jt),o=Ll(r).map(Dl).reduce(function(i,a){return i[a.id]=a,i},[]),l=function(a){return a.hasAttribute("xfId")?Pr(Pr({},t[a.xfId]),Jt(a,o)):Jt(a,o)};return Cl(r).map(l)}function Dl(n){return{id:n.getAttribute("numFmtId"),template:n.getAttribute("formatCode")}}function Jt(n,e){var r={};if(n.hasAttribute("numFmtId")){var t=n.getAttribute("numFmtId");e[t]?r.numberFormat=e[t]:r.numberFormat={id:t}}return r}function Fl(n,e){return n?Tl(e.createDocument(n)):[]}function Dn(n,e){e&&e.epoch1904&&(n+=1462);var r=70*365+19,t=60*60*1e3;return new Date(Math.round((n-r)*24*t))}function jl(n,e){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r)return(r=r.call(n)).next.bind(r);if(Array.isArray(n)||(r=Bl(n))||e&&n&&typeof n.length=="number"){r&&(n=r);var t=0;return function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bl(n,e){if(n){if(typeof n=="string")return Mr(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mr(n,e)}}function Mr(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function Hl(n,e,r,t){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(Rl.indexOf(Number(o.numberFormat.id))>=0||t.dateFormat&&o.numberFormat.template===t.dateFormat||t.smartDateParser!==!1&&o.numberFormat.template&&Ul(o.numberFormat.template))return!0}}var Rl=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],Wl=/^\[\$-414\]/,zl=/;@$/;function Ul(n){n=n.toLowerCase(),n=n.replace(Wl,""),n=n.replace(zl,"");for(var e=n.split(/\W+/),r=jl(e),t;!(t=r()).done;){var o=t.value;if(Gl.indexOf(o)<0)return!1}return!0}var Gl=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function Vl(n,e,r){var t=r.getInlineStringValue,o=r.getInlineStringXml,l=r.getStyleId,i=r.styles,a=r.values,s=r.properties,f=r.options;switch(e||(e="n"),e){case"str":n=Qt(n,f);break;case"inlineStr":if(n=t(),n===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));n=Qt(n,f);break;case"s":var u=Number(n);if(isNaN(u))throw new Error('Invalid "shared" string index: '.concat(n));if(u>=a.length)throw new Error('An out-of-bounds "shared" string index: '.concat(n));n=a[u],n=Qt(n,f);break;case"b":if(n==="1")n=!0;else if(n==="0")n=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(n));break;case"z":n=void 0;break;case"e":n=ql(n);break;case"d":if(n===void 0)break;var c=new Date(n);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(n));n=c;break;case"n":if(n===void 0)break;var p=Number(n);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(n));n=p,Hl(n,l(),i,f)&&(n=Dn(n,s));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return n===void 0&&(n=null),n}function ql(n){switch(n){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(n)}}function Qt(n,e){return e.trim!==!1&&(n=n.trim()),n===""&&(n=void 0),n}var Xl=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Kl(n){var e=function(f,u){return f-u},r=n.map(function(s){return s.row}).sort(e),t=n.map(function(s){return s.column}).sort(e),o=r[0],l=r[r.length-1],i=t[0],a=t[t.length-1];return[{row:o,column:i},{row:l,column:a}]}function Zl(n){for(var e=0,r=0;r<n.length;)e*=26,e+=Xl.indexOf(n[r]),r++;return e}function Fn(n){return n=n.split(/(\d+)/),[parseInt(n[1]),Zl(n[0].trim())]}function Yl(n,e,r,t,o,l,i){var a=Fn(n.getAttribute("r")),s=vl(e,n),f=s&&s.textContent,u;return n.hasAttribute("t")&&(u=n.getAttribute("t")),{row:a[0],column:a[1],value:Vl(f,u,{getInlineStringValue:function(){return yl(e,n)},getInlineStringXml:function(){return Nn(n)},getStyleId:function(){return n.getAttribute("s")},styles:o,values:t,properties:l,options:i})}}function Jl(n,e,r,t,o,l){var i=wl(n);return i.length===0?[]:i.map(function(a){return Yl(a,n,e,r,t,o,l)})}function Ql(n,e){return rs(n)||ts(n,e)||es(n,e)||xl()}function xl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function es(n,e){if(n){if(typeof n=="string")return Er(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Er(n,e)}}function Er(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function ts(n,e){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var t=[],o=!0,l=!1,i,a;try{for(r=r.call(n);!(o=(i=r.next()).done)&&(t.push(i.value),!(e&&t.length===e));o=!0);}catch(s){l=!0,a=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(l)throw a}}return t}}function rs(n){if(Array.isArray(n))return n}function ns(n){var e=kl(n);if(e)return e=e.split(":").map(Fn).map(function(r){var t=Ql(r,2),o=t[0],l=t[1];return{row:o,column:l}}),e.length===1&&(e=[e[0],e[0]]),e}function os(n,e,r,t,o,l){var i=e.createDocument(n),a=Jl(i,e,r,t,o,l),s=ns(i)||Kl(a);return{cells:a,dimensions:s}}function ls(n,e){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r)return(r=r.call(n)).next.bind(r);if(Array.isArray(n)||(r=ss(n))||e&&n&&typeof n.length=="number"){r&&(n=r);var t=0;return function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ss(n,e){if(n){if(typeof n=="string")return Nr(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nr(n,e)}}function Nr(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function is(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,t=e.accessor,o=t===void 0?function(c){return c}:t,l=e.onlyTrimAtTheEnd,i=n.length-1;i>=0;){for(var a=!0,s=ls(n[i]),f;!(f=s()).done;){var u=f.value;if(o(u)!==null){a=!1;break}}if(a)n.splice(i,1),r&&r.splice(i,1);else if(l)break;i--}return n}function as(n,e){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r)return(r=r.call(n)).next.bind(r);if(Array.isArray(n)||(r=fs(n))||e&&n&&typeof n.length=="number"){r&&(n=r);var t=0;return function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fs(n,e){if(n){if(typeof n=="string")return Dr(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dr(n,e)}}function Dr(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function us(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,t=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,l=n[0].length-1;l>=0;){for(var i=!0,a=as(n),s;!(s=a()).done;){var f=s.value;if(t(f[l])!==null){i=!1;break}}if(i)for(var u=0;u<n.length;)n[u].splice(l,1),u++;else if(o)break;l--}return n}function cs(n,e){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r)return(r=r.call(n)).next.bind(r);if(Array.isArray(n)||(r=jn(n))||e&&n&&typeof n.length=="number"){r&&(n=r);var t=0;return function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ps(n,e){return ds(n)||$s(n,e)||jn(n,e)||ms()}function ms(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jn(n,e){if(n){if(typeof n=="string")return Fr(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fr(n,e)}}function Fr(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function $s(n,e){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var t=[],o=!0,l=!1,i,a;try{for(r=r.call(n);!(o=(i=r.next()).done)&&(t.push(i.value),!(e&&t.length===e));o=!0);}catch(s){l=!0,a=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(l)throw a}}return t}}function ds(n){if(Array.isArray(n))return n}function gs(n,e){var r=n.dimensions,t=n.cells;if(t.length===0)return[];var o=ps(r,2);o[0];for(var l=o[1],i=l.column,a=l.row,s=new Array(a),f=0;f<a;){s[f]=new Array(i);for(var u=0;u<i;)s[f][u]=null,u++;f++}for(var c=cs(t),p;!(p=c()).done;){var $=p.value,y=$.row-1,k=$.column-1;k<i&&y<a&&(s[y][k]=$.value)}var C=e.rowMap;if(C)for(var v=0;v<s.length;)C[v]=v,v++;return s=is(us(s,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:C}),e.transformData&&(s=e.transformData(s)),s}function hs(n,e){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r)return(r=r.call(n)).next.bind(r);if(Array.isArray(n)||(r=_s(n))||e&&n&&typeof n.length=="number"){r&&(n=r);var t=0;return function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _s(n,e){if(n){if(typeof n=="string")return jr(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jr(n,e)}}function jr(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function Br(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),r.push.apply(r,t)}return r}function bs(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Br(Object(r),!0).forEach(function(t){ws(n,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Br(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})}return n}function ws(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function vs(n,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=bs({sheet:1},r));var t=function(p){if(!n[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return n[p]},o=Ml(t("xl/_rels/workbook.xml.rels"),e),l=o.sharedStrings?Fl(t(o.sharedStrings),e):[],i=o.styles?Nl(t(o.styles),e):{},a=Pl(t("xl/workbook.xml"),e);if(r.getSheets)return a.sheets.map(function(c){var p=c.name;return{name:p}});var s=ys(r.sheet,a.sheets);if(!s||!o.sheets[s])throw ks(r.sheet,a.sheets);var f=os(t(o.sheets[s]),e,l,i,a,r),u=gs(f,r);return r.properties?{data:u,properties:a}:u}function ys(n,e){if(typeof n=="number"){var r=e[n-1];return r&&r.relationId}for(var t=hs(e),o;!(o=t()).done;){var l=o.value;if(l.name===n)return l.relationId}}function ks(n,e){var r=e&&e.map(function(t,o){return'"'.concat(t.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof n=="number"?"#"+n:'"'+n+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function rr(n){"@babel/helpers - typeof";return rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(n)}function Hr(n,e){for(var r=0;r<e.length;r++){var t=e[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function Ss(n,e,r){return e&&Hr(n.prototype,e),r&&Hr(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function Cs(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Ls(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&At(n,e)}function Ts(n){var e=Bn();return function(){var t=It(n),o;if(e){var l=It(this).constructor;o=Reflect.construct(t,arguments,l)}else o=t.apply(this,arguments);return Os(this,o)}}function Os(n,e){if(e&&(rr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return As(n)}function As(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function nr(n){var e=typeof Map=="function"?new Map:void 0;return nr=function(t){if(t===null||!Is(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return Ft(t,arguments,It(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),At(o,t)},nr(n)}function Ft(n,e,r){return Bn()?Ft=Reflect.construct:Ft=function(o,l,i){var a=[null];a.push.apply(a,l);var s=Function.bind.apply(o,a),f=new s;return i&&At(f,i.prototype),f},Ft.apply(null,arguments)}function Bn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Is(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function At(n,e){return At=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},At(n,e)}function It(n){return It=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},It(n)}var we=function(n){Ls(r,n);var e=Ts(r);function r(t){var o;return Cs(this,r),o=e.call(this,"invalid"),o.reason=t,o}return Ss(r)}(nr(Error));function Ps(n){if(typeof n=="string"){var e=n;if(n=Number(n),String(n)!==e)throw new we("not_a_number")}if(typeof n!="number")throw new we("not_a_number");if(isNaN(n))throw new we("invalid_number");if(!isFinite(n))throw new we("out_of_bounds");return n}function Ms(n){if(typeof n=="string")return n;if(typeof n=="number"){if(isNaN(n))throw new we("invalid_number");if(!isFinite(n))throw new we("out_of_bounds");return String(n)}throw new we("not_a_string")}function Es(n){if(typeof n=="boolean")return n;throw new we("not_a_boolean")}function Ns(n,e){var r=e.properties;if(n instanceof Date){if(isNaN(n.valueOf()))throw new we("out_of_bounds");return n}if(typeof n=="number"){if(isNaN(n))throw new we("invalid_number");if(!isFinite(n))throw new we("out_of_bounds");var t=Dn(n,r);if(isNaN(t.valueOf()))throw new we("out_of_bounds");return t}throw new we("not_a_date")}function Ds(n,e){return Bs(n)||js(n,e)||Hn(n,e)||Fs()}function Fs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function js(n,e){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var t=[],o=!0,l=!1,i,a;try{for(r=r.call(n);!(o=(i=r.next()).done)&&(t.push(i.value),!(e&&t.length===e));o=!0);}catch(s){l=!0,a=s}finally{try{!o&&r.return!=null&&r.return()}finally{if(l)throw a}}return t}}function Bs(n){if(Array.isArray(n))return n}function or(n){"@babel/helpers - typeof";return or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},or(n)}function Hs(n,e){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r)return(r=r.call(n)).next.bind(r);if(Array.isArray(n)||(r=Hn(n))||e&&n&&typeof n.length=="number"){r&&(n=r);var t=0;return function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hn(n,e){if(n){if(typeof n=="string")return Rr(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rr(n,e)}}function Rr(n,e){(e==null||e>n.length)&&(e=n.length);for(var r=0,t=new Array(e);r<e;r++)t[r]=n[r];return t}function Wr(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),r.push.apply(r,t)}return r}function zr(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wr(Object(r),!0).forEach(function(t){Rs(n,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Wr(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})}return n}function Rs(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}var Ur={isColumnOriented:!1};function Ws(n,e,r){r?r=zr(zr({},Ur),r):r=Ur;var t=r,o=t.isColumnOriented,l=t.rowMap,i=t.ignoreEmptyRows;Vs(e),o&&(n=Gs(n));for(var a=n[0],s=[],f=[],u=1;u<n.length;u++){var c=Rn(e,n[u],u,a,f,r);(c!==null||i===!1)&&s.push(c)}if(l)for(var p=Hs(f),$;!($=p()).done;){var y=$.value;y.row=l[y.row-1]+1}return{rows:s,errors:f}}function Rn(n,e,r,t,o,l){for(var i={},a=!0,s=function(){var p=u[f],$=n[p],y=or($.type)==="object"&&!Array.isArray($.type),k=e[t.indexOf(p)];k===void 0&&(k=null);var C=void 0,v=void 0,A=void 0;if(y)C=Rn($.type,e,r,t,o,l);else if(k===null)C=null;else if(Array.isArray($.type)){var F=!1,O=Us(k).map(function(H){var I=Gr(H,$,l);return I.error&&(C=H,v=I.error,A=I.reason),I.value!==null&&(F=!0),I.value});v||(C=F?O:null)}else{var E=Gr(k,$,l);v=E.error,A=E.reason,C=v?k:E.value}!v&&C===null&&$.required&&(v="required"),v?(v={error:v,row:r+1,column:p,value:C},A&&(v.reason=A),$.type&&(v.type=$.type),o.push(v)):(a&&C!==null&&(a=!1),(C!==null||l.includeNullValues)&&(i[$.prop]=C))},f=0,u=Object.keys(n);f<u.length;f++)s();return a?null:i}function Gr(n,e,r){if(n===null)return{value:null};var t;if(e.parse?t=dt(n,e.parse):e.type?t=zs(n,Array.isArray(e.type)?e.type[0]:e.type,r):t={value:n},t.error)return t;if(t.value!==null){if(e.oneOf&&e.oneOf.indexOf(t.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(t.value)}catch(o){return{error:o.message}}}return t}function dt(n,e){try{return n=e(n),n===void 0?{value:null}:{value:n}}catch(t){var r={error:t.message};return t.reason&&(r.reason=t.reason),r}}function zs(n,e,r){switch(e){case String:return dt(n,Ms);case Number:return dt(n,Ps);case Date:return dt(n,function(t){return Ns(t,{properties:r.properties})});case Boolean:return dt(n,Es);default:if(typeof e=="function")return dt(n,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Wn(n,e,r){for(var t=0,o="";r+t<n.length;){var l=n[r+t];if(l===e)return[o,t];if(l==='"'){var i=Wn(n,'"',r+t+1);o+=i[0],t+=1+i[1]+1}else o+=l,t++}return[o,t]}function Us(n){for(var e=[],r=0;r<n.length;){var t=Wn(n,",",r),o=Ds(t,2),l=o[0],i=o[1];r+=i+1,e.push(l.trim())}return e}var Gs=function(e){return e[0].map(function(r,t){return e.map(function(o){return o[t]})})};function Vs(n){for(var e=0,r=Object.keys(n);e<r.length;e++){var t=r[e],o=n[t];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(t,'".'))}}function lr(n){"@babel/helpers - typeof";return lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lr(n)}function zn(n){for(var e={},r=0,t=Object.keys(n);r<t.length;r++){var o=t[r],l=n[o],i=void 0;lr(l)==="object"&&(l=Object.keys(n[o])[0],i=zn(n[o][l])),e[o]={prop:l},i&&(e[o].type=i)}return e}var qs=["schema","map"];function Vr(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),r.push.apply(r,t)}return r}function Dt(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vr(Object(r),!0).forEach(function(t){Xs(n,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Vr(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})}return n}function Xs(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function Ks(n,e){if(n==null)return{};var r=Zs(n,e),t,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);for(o=0;o<l.length;o++)t=l[o],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function Zs(n,e){if(n==null)return{};var r={},t=Object.keys(n),o,l;for(l=0;l<t.length;l++)o=t[l],!(e.indexOf(o)>=0)&&(r[o]=n[o]);return r}function Ys(n,e,r){var t=r.schema,o=r.map,l=Ks(r,qs);!t&&o&&(t=zn(o));var i=vs(n,e,Dt(Dt({},l),{},{properties:t||l.properties}));return t?Ws(i.data,t,Dt(Dt({},l),{},{properties:i.properties})):i}function Js(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return gl(n).then(function(r){return Ys(r,Qo,e)})}function Qs(n){let e=new Map;for(let[t,o]of Object.entries(n.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let t of n.features){let o=e.get(t.properties.scheme_reference);o.num_features++,t.properties.funding_programme=o.funding_programme,t.id=r++}return e}async function xs(n){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await Js(n,{map:e,sheet:"Form Input"}),t={type:"FeatureCollection",features:[]};for(let o of r){let l=Zn(o.lat_lon.split(",").map(parseFloat).reverse()),i=o;i.submission_time=o.submission_time.toLocaleString(),t.features.push({type:"Feature",properties:i,geometry:{type:"Point",coordinates:l},id:t.features.length+1})}return t}const Q={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Vt=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function ei(n){let e,r,t,o,l;function i(s){n[3](s)}let a={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return n[0]!==void 0&&(a.value=n[0]),e=new Ht({props:a}),q.push(()=>Z(e,"value",i)),e.$on("change",n[2]),o=new $o({props:{rows:n[1]}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};!r&&f&1&&(r=!0,u.value=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&2&&(c.rows=s[1]),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}function ti(n,e,r){let t;J(n,me,s=>r(4,t=s));let o="interventionType",l=br("v1");function i(){let s;o=="interventionType"?(s=Cn("v1"),r(1,l=br("v1"))):(s=bn(["get","funding_programme"],{ATF2:Q.atf2,ATF3:Q.atf3,ATF4:Q.atf4},"grey"),r(1,l=[["ATF2",Q.atf2],["ATF3",Q.atf3],["ATF4",Q.atf4]])),t.setPaintProperty("interventions-points","circle-color",s),t.setPaintProperty("interventions-lines","line-color",s),t.setPaintProperty("interventions-polygons","fill-color",s),t.setPaintProperty("interventions-polygon-outlines","line-color",s)}function a(s){o=s,r(0,o)}return[o,l,i,a]}class ri extends U{constructor(e){super(),G(this,e,ti,ei,z,{})}}function ni(n){let e;return{c(){e=S("Clear")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function oi(n){let e,r,t,o,l,i;return t=new Tt({props:{$$slots:{default:[ni]},$$scope:{ctx:n}}}),t.$on("click",n[13]),{c(){e=N("input"),r=T(),_(t.$$.fragment),K(e,"type","text"),K(e,"class","govuk-input govuk-input--width-10"),K(e,"id","filterText")},m(a,s){d(a,e,s),gr(e,n[0]),d(a,r,s),b(t,a,s),o=!0,l||(i=wt(e,"input",n[12]),l=!0)},p(a,s){s&1&&e.value!==a[0]&&gr(e,a[0]);const f={};s&131072&&(f.$$scope={dirty:s,ctx:a}),t.$set(f)},i(a){o||(m(t.$$.fragment,a),o=!0)},o(a){h(t.$$.fragment,a),o=!1},d(a){a&&(g(e),g(r)),w(t,a),l=!1,i()}}}function li(n){let e,r,t,o,l,i,a,s,f,u;function c(k){n[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:n[5],emptyOption:!0};n[2]!==void 0&&(p.value=n[2]),e=new Ht({props:p}),q.push(()=>Z(e,"value",c));function $(k){n[11](k)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:n[6],emptyOption:!0};return n[3]!==void 0&&(y.value=n[3]),o=new Ht({props:y}),q.push(()=>Z(o,"value",$)),a=new wn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[oi]},$$scope:{ctx:n}}}),f=new ri({}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment),i=T(),_(a.$$.fragment),s=T(),_(f.$$.fragment)},m(k,C){b(e,k,C),d(k,t,C),b(o,k,C),d(k,i,C),b(a,k,C),d(k,s,C),b(f,k,C),u=!0},p(k,C){const v={};C&32&&(v.choices=k[5]),!r&&C&4&&(r=!0,v.value=k[2],Y(()=>r=!1)),e.$set(v);const A={};C&64&&(A.choices=k[6]),!l&&C&8&&(l=!0,A.value=k[3],Y(()=>l=!1)),o.$set(A);const F={};C&131073&&(F.$$scope={dirty:C,ctx:k}),a.$set(F)},i(k){u||(m(e.$$.fragment,k),m(o.$$.fragment,k),m(a.$$.fragment,k),m(f.$$.fragment,k),u=!0)},o(k){h(e.$$.fragment,k),h(o.$$.fragment,k),h(a.$$.fragment,k),h(f.$$.fragment,k),u=!1},d(k){k&&(g(t),g(i),g(s)),w(e,k),w(o,k),w(a,k),w(f,k)}}}function si(n){let e,r=n[1].size.toLocaleString()+"",t,o,l=n[7].route.toLocaleString()+"",i,a,s=n[7].area.toLocaleString()+"",f,u,c=n[7].crossing.toLocaleString()+"",p,$,y=n[7].other.toLocaleString()+"",k,C;return{c(){e=S("Showing "),t=S(r),o=S(" schemes ("),i=S(l),a=S(`
    routes, `),f=S(s),u=S(` areas,
    `),p=S(c),$=S(" crossings, "),k=S(y),C=S(`
    other)`)},m(v,A){d(v,e,A),d(v,t,A),d(v,o,A),d(v,i,A),d(v,a,A),d(v,f,A),d(v,u,A),d(v,p,A),d(v,$,A),d(v,k,A),d(v,C,A)},p(v,A){A&2&&r!==(r=v[1].size.toLocaleString()+"")&&ie(t,r),A&128&&l!==(l=v[7].route.toLocaleString()+"")&&ie(i,l),A&128&&s!==(s=v[7].area.toLocaleString()+"")&&ie(f,s),A&128&&c!==(c=v[7].crossing.toLocaleString()+"")&&ie(p,c),A&128&&y!==(y=v[7].other.toLocaleString()+"")&&ie(k,y)},d(v){v&&(g(e),g(t),g(o),g(i),g(a),g(f),g(u),g(p),g($),g(k),g(C))}}}function ii(n){let e,r,t;function o(i){n[14](i)}let l={id:"show-schemes",$$slots:{default:[si]},$$scope:{ctx:n}};return n[4]!==void 0&&(l.checked=n[4]),e=new se({props:l}),q.push(()=>Z(e,"checked",o)),{c(){_(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,a){const s={};a&131202&&(s.$$scope={dirty:a,ctx:i}),!r&&a&16&&(r=!0,s.checked=i[4],Y(()=>r=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){w(e,i)}}}function ai(n){let e,r,t,o;return e=new Ae({props:{label:"Filters",$$slots:{default:[li]},$$scope:{ctx:n}}}),t=new Pt({props:{small:!0,$$slots:{default:[ii]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},p(l,[i]){const a={};i&131181&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&131218&&(s.$$scope={dirty:i,ctx:l}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function fi(n,e,r){let t,o;J(n,gt,O=>r(15,t=O)),J(n,me,O=>r(9,o=O));let{schemes:l}=e,{schemesToBeShown:i=new Set}=e,{filterText:a=""}=e,s=[],f="",u=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;yt(()=>{let O=new Set,E=new Set;for(let H of l.values())H.authority_or_region&&O.add(H.authority_or_region),H.funding_programme&&E.add(H.funding_programme);r(5,s=Array.from(O.entries())),s.sort(),r(6,u=Array.from(E.entries())),u.sort()});function y(O,E,H){let I=O.toLowerCase(),P=L=>{var B,W;if(I&&!((B=L.properties.name)!=null&&B.toLowerCase().includes(I))&&!((W=L.properties.description)!=null&&W.toLowerCase().includes(I)))return!1;if(E||H){let V=l.get(L.properties.scheme_reference);if(E&&V.authority_or_region!=E||H&&V.funding_programme!=H)return!1}return!0};r(1,i=new Set(t.features.filter(P).map(L=>L.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let D=L=>{var B,W;return!(!i.has(L.properties.scheme_reference)||I&&!((B=L.properties.name)!=null&&B.toLowerCase().includes(I))&&!((W=L.properties.description)!=null&&W.toLowerCase().includes(I)))};gt.update(L=>{for(let B of L.features)D(B)?(delete B.properties.hide_while_editing,r(7,p[B.properties.intervention_type]++,p)):B.properties.hide_while_editing=!0;return L}),r(7,p)}function k(O){f=O,r(2,f)}function C(O){c=O,r(3,c)}function v(){a=this.value,r(0,a)}const A=()=>r(0,a="");function F(O){$=O,r(4,$)}return n.$$set=O=>{"schemes"in O&&r(8,l=O.schemes),"schemesToBeShown"in O&&r(1,i=O.schemesToBeShown),"filterText"in O&&r(0,a=O.filterText)},n.$$.update=()=>{if(n.$$.dirty&528&&o)for(let O of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(O)&&o.setLayoutProperty(O,"visibility",$?"visible":"none");n.$$.dirty&13&&y(a,f,c)},[a,i,f,c,$,s,u,p,l,o,k,C,v,A,F]}class ui extends U{constructor(e){super(),G(this,e,fi,ai,z,{schemes:8,schemesToBeShown:1,filterText:0})}}function ci(n,e,r){let t;J(n,me,a=>r(3,t=a));let o=null,{markerPosition:l}=e,{markerPositionUpdated:i}=e;return yt(()=>{o=new xt.Marker({draggable:!0}).setLngLat(l).addTo(t),o.on("dragstart",()=>{t.getCanvas().style.cursor="grabbing"}),o.on("drag",()=>{r(0,l=o.getLngLat()),i()}),o.on("dragend",()=>{t.getCanvas().style.cursor="inherit"})}),vt(()=>{o&&o.remove()}),n.$$set=a=>{"markerPosition"in a&&r(0,l=a.markerPosition),"markerPositionUpdated"in a&&r(1,i=a.markerPositionUpdated)},[l,i]}class pi extends U{constructor(e){super(),G(this,e,ci,null,z,{markerPosition:0,markerPositionUpdated:1})}}function qr(n,e,r){const t=n.slice();return t[16]=e[r],t[17]=e,t[18]=r,t}function mi(n){let e,r;return e=new Tt({props:{$$slots:{default:[di]},$$scope:{ctx:n}}}),e.$on("click",n[4]),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&524288&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function $i(n){let e,r;return e=new Tt({props:{$$slots:{default:[gi]},$$scope:{ctx:n}}}),e.$on("click",n[3]),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&524288&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function di(n){let e;return{c(){e=S("Disable Line Measurement Tool")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function gi(n){let e;return{c(){e=S("Enable Line Measurement Tool")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Xr(n){var c;let e,r,t,o=[],l=new Map,i,a,s=n[2]&&((c=n[2].properties)==null?void 0:c.length)&&Kr(n);r=new Ae({props:{label:"Help",$$slots:{default:[hi]},$$scope:{ctx:n}}});let f=Fe(n[1]);const u=p=>p[16].id;for(let p=0;p<f.length;p+=1){let $=qr(n,f,p),y=u($);l.set(y,o[p]=Zr(y,$))}return{c(){s&&s.c(),e=T(),_(r.$$.fragment),t=T();for(let p=0;p<o.length;p+=1)o[p].c();i=ge()},m(p,$){s&&s.m(p,$),d(p,e,$),b(r,p,$),d(p,t,$);for(let y=0;y<o.length;y+=1)o[y]&&o[y].m(p,$);d(p,i,$),a=!0},p(p,$){var k;p[2]&&((k=p[2].properties)!=null&&k.length)?s?s.p(p,$):(s=Kr(p),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null);const y={};$&524288&&(y.$$scope={dirty:$,ctx:p}),r.$set(y),$&130&&(f=Fe(p[1]),te(),o=Jn(o,$,u,1,p,f,l,i.parentNode,Qn,Zr,i,qr),re())},i(p){if(!a){m(r.$$.fragment,p);for(let $=0;$<f.length;$+=1)m(o[$]);a=!0}},o(p){h(r.$$.fragment,p);for(let $=0;$<o.length;$+=1)h(o[$]);a=!1},d(p){p&&(g(e),g(t),g(i)),s&&s.d(p),w(r,p);for(let $=0;$<o.length;$+=1)o[$].d(p)}}}function Kr(n){var i;let e,r,t=((i=n[2].properties)==null?void 0:i.length)+"",o,l;return{c(){e=N("p"),r=S("Length: "),o=S(t),l=S("m")},m(a,s){d(a,e,s),M(e,r),M(e,o),M(e,l)},p(a,s){var f;s&4&&t!==(t=((f=a[2].properties)==null?void 0:f.length)+"")&&ie(o,t)},d(a){a&&g(e)}}}function hi(n){let e;return{c(){e=N("ul"),e.innerHTML=`<li><b>Click</b>
        on the map to place a new waypoint</li> <li><b>Click and Drag</b>
        an existing waypoint to move it</li> <li><b>Hold shift and click on</b>
        an existing waypoint to delete it</li> <li>Press <b>Escape</b>
        to exit this mode</li>`},m(r,t){d(r,e,t)},p:x,d(r){r&&g(e)}}}function Zr(n,e){let r,t,o,l;function i(s){e[8](s,e[16])}let a={markerPositionUpdated:e[7]};return e[16].lngLat!==void 0&&(a.markerPosition=e[16].lngLat),t=new pi({props:a}),q.push(()=>Z(t,"markerPosition",i)),{key:n,first:null,c(){r=ge(),_(t.$$.fragment),this.first=r},m(s,f){d(s,r,f),b(t,s,f),l=!0},p(s,f){e=s;const u={};!o&&f&2&&(o=!0,u.markerPosition=e[16].lngLat,Y(()=>o=!1)),t.$set(u)},i(s){l||(m(t.$$.fragment,s),l=!0)},o(s){h(t.$$.fragment,s),l=!1},d(s){s&&g(r),w(t,s)}}}function _i(n){let e,r,t,o,l,i,a;const s=[$i,mi],f=[];function u(p,$){return p[0]?0:1}e=u(n),r=f[e]=s[e](n);let c=!n[0]&&Xr(n);return{c(){r.c(),t=T(),c&&c.c(),o=ge()},m(p,$){f[e].m(p,$),d(p,t,$),c&&c.m(p,$),d(p,o,$),l=!0,i||(a=[wt(window,"keydown",n[5]),wt(window,"keyup",n[6])],i=!0)},p(p,[$]){let y=e;e=u(p),e===y?f[e].p(p,$):(te(),h(f[y],1,1,()=>{f[y]=null}),re(),r=f[e],r?r.p(p,$):(r=f[e]=s[e](p),r.c()),m(r,1),r.m(t.parentNode,t)),p[0]?c&&(te(),h(c,1,1,()=>{c=null}),re()):c?(c.p(p,$),$&1&&m(c,1)):(c=Xr(p),c.c(),m(c,1),c.m(o.parentNode,o))},i(p){l||(m(r),m(c),l=!0)},o(p){h(r),h(c),l=!1},d(p){p&&(g(t),g(o)),f[e].d(p),c&&c.d(p),i=!1,Yn(a)}}}const nt="measurement-line";function bi(n,e,r){let t;J(n,me,F=>r(11,t=F));let o=!0,l=[],i,a=!1,s=0;function f(F){o||(a||(l.push({id:s++,lngLat:F.lngLat}),r(1,l),k()),a&&l.length>0&&(u(F.lngLat),k()))}function u(F){let E=new xt.LngLat(0,-90).distanceTo(new xt.LngLat(0,90)),H;l.forEach(I=>{const P=I.lngLat;E>=F.distanceTo(P)&&(H=P,E=F.distanceTo(P))}),H&&r(1,l=l.filter(I=>{const P=I.lngLat;return P.lng!=(H==null?void 0:H.lng)||P.lat!=(H==null?void 0:H.lat)}))}function c(){r(0,o=!1)}function p(){r(0,o=!0),r(1,l=[]),C()}function $(F){F.key==="Shift"&&(a=!0),F.key==="Escape"&&p()}function y(F){F.key==="Shift"&&(a=!1)}function k(){if(l.length<2){C();return}const F=l.map(O=>[O.lngLat.lng,O.lngLat.lat]);r(2,i=xn(F,{})),i.properties&&r(2,i.properties.length=(go(i)*1e3).toFixed(2),i),v()}function C(){t.getSource(nt)&&(t.getSource(nt).setData(fr()),r(2,i=void 0))}function v(){t.getSource(nt)?t.getSource(nt).setData(i):(eo(t,nt,i),xe(t,{id:nt,source:nt,color:ao.measuringLine,width:5}))}yt(()=>{t.on("click",f)}),vt(()=>{t.off("click",f)});function A(F,O){n.$$.not_equal(O.lngLat,F)&&(O.lngLat=F,r(1,l))}return[o,l,i,c,p,$,y,k,A]}class wi extends U{constructor(e){super(),G(this,e,bi,_i,z,{})}}function vi(n){let e;return{c(){e=S(`Open Government License
  `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function yi(n){let e,r,t,o,l;return t=new X({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[vi]},$$scope:{ctx:n}}}),{c(){e=N("p"),r=S("License: "),_(t.$$.fragment),o=S(`. Contains OS data  Crown copyright and database right
  2023.`)},m(i,a){d(i,e,a),M(e,r),b(t,e,null),M(e,o),l=!0},p(i,[a]){const s={};a&1&&(s.$$scope={dirty:a,ctx:i}),t.$set(s)},i(i){l||(m(t.$$.fragment,i),l=!0)},o(i){h(t.$$.fragment,i),l=!1},d(i){i&&g(e),w(t)}}}class Ge extends U{constructor(e){super(),G(this,e,null,yi,z,{})}}function Yr(n,e,r){const t=n.slice();return t[2]=e[r],t}function Jr(n,e,r){const t=n.slice();return t[5]=e[r],t}function Qr(n){let e,r;return{c(){e=N("span"),r=S(`
    `),He(e,"background",n[5]),He(e,"width","100%"),He(e,"border","1px solid black")},m(t,o){d(t,e,o),M(e,r)},p(t,o){o&1&&He(e,"background",t[5])},d(t){t&&g(e)}}}function xr(n){let e,r=n[2]+"",t;return{c(){e=N("span"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&2&&r!==(r=o[2]+"")&&ie(t,r)},d(o){o&&g(e)}}}function ki(n){let e,r,t,o=Fe(n[0]),l=[];for(let s=0;s<o.length;s+=1)l[s]=Qr(Jr(n,o,s));let i=Fe(n[1]),a=[];for(let s=0;s<i.length;s+=1)a[s]=xr(Yr(n,i,s));return{c(){e=N("div");for(let s=0;s<l.length;s+=1)l[s].c();r=T(),t=N("div");for(let s=0;s<a.length;s+=1)a[s].c();He(e,"display","flex"),He(t,"display","flex"),He(t,"justify-content","space-between")},m(s,f){d(s,e,f);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(e,null);d(s,r,f),d(s,t,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(t,null)},p(s,[f]){if(f&1){o=Fe(s[0]);let u;for(u=0;u<o.length;u+=1){const c=Jr(s,o,u);l[u]?l[u].p(c,f):(l[u]=Qr(c),l[u].c(),l[u].m(e,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=o.length}if(f&2){i=Fe(s[1]);let u;for(u=0;u<i.length;u+=1){const c=Yr(s,i,u);a[u]?a[u].p(c,f):(a[u]=xr(c),a[u].c(),a[u].m(t,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}},i:x,o:x,d(s){s&&(g(e),g(r),g(t)),Bt(l,s),Bt(a,s)}}}function Si(n,e,r){let{colorScale:t}=e,{limits:o}=e;return n.$$set=l=>{"colorScale"in l&&r(0,t=l.colorScale),"limits"in l&&r(1,o=l.limits)},[t,o]}class tt extends U{constructor(e){super(),G(this,e,Si,ki,z,{colorScale:0,limits:1})}}function Ci(n){let e;return{c(){e=S("Percent of households with a car")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Li(n){let e;return{c(){e=S(`NOMIS TS045
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ti(n){let e;return{c(){e=S(`ONS Geography
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Oi(n){let e;return{c(){e=S(`Open Government License
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ai(n){let e,r,t,o,l,i,a,s,f,u,c,p;return t=new X({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Li]},$$scope:{ctx:n}}}),l=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Ti]},$$scope:{ctx:n}}}),u=new X({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Oi]},$$scope:{ctx:n}}}),{c(){e=N("p"),r=S("Car/van availability data is from the 2021 census, via "),_(t.$$.fragment),o=S(". Output area boundaries from "),_(l.$$.fragment),i=S("."),a=T(),s=N("p"),f=S("License: "),_(u.$$.fragment),c=S(`. Contains OS data  Crown copyright and database
        right 2023.`)},m($,y){d($,e,y),M(e,r),b(t,e,null),M(e,o),b(l,e,null),M(e,i),d($,a,y),d($,s,y),M(s,f),b(u,s,null),M(s,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),t.$set(k);const C={};y&65536&&(C.$$scope={dirty:y,ctx:$}),l.$set(C);const v={};y&65536&&(v.$$scope={dirty:y,ctx:$}),u.$set(v)},i($){p||(m(t.$$.fragment,$),m(l.$$.fragment,$),m(u.$$.fragment,$),p=!0)},o($){h(t.$$.fragment,$),h(l.$$.fragment,$),h(u.$$.fragment,$),p=!1},d($){$&&(g(e),g(a),g(s)),w(t),w(l),w(u)}}}function Ii(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Ai]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&65536&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function en(n){let e,r;return e=new tt({props:{colorScale:n[4],limits:n[7]()}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p:x,i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Pi(n){let e;return{c(){e=S("Average cars per household")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Mi(n){let e;return{c(){e=S(`NOMIS TS045
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ei(n){let e;return{c(){e=S(`ONS Geography
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ni(n){let e;return{c(){e=S(`Open Government License
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Di(n){let e,r,t,o,l,i,a,s,f,u,c,p,$,y;return l=new X({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Mi]},$$scope:{ctx:n}}}),a=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Ei]},$$scope:{ctx:n}}}),p=new X({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ni]},$$scope:{ctx:n}}}),{c(){e=N("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=T(),t=N("p"),o=S("Car/van availability data is from the 2021 census, via "),_(l.$$.fragment),i=S(". Output area boundaries from "),_(a.$$.fragment),s=S("."),f=T(),u=N("p"),c=S("License: "),_(p.$$.fragment),$=S(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(k,C){d(k,e,C),d(k,r,C),d(k,t,C),M(t,o),b(l,t,null),M(t,i),b(a,t,null),M(t,s),d(k,f,C),d(k,u,C),M(u,c),b(p,u,null),M(u,$),y=!0},p(k,C){const v={};C&65536&&(v.$$scope={dirty:C,ctx:k}),l.$set(v);const A={};C&65536&&(A.$$scope={dirty:C,ctx:k}),a.$set(A);const F={};C&65536&&(F.$$scope={dirty:C,ctx:k}),p.$set(F)},i(k){y||(m(l.$$.fragment,k),m(a.$$.fragment,k),m(p.$$.fragment,k),y=!0)},o(k){h(l.$$.fragment,k),h(a.$$.fragment,k),h(p.$$.fragment,k),y=!1},d(k){k&&(g(e),g(r),g(t),g(f),g(u)),w(l),w(a),w(p)}}}function Fi(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Di]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&65536&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function tn(n){let e,r;return e=new tt({props:{colorScale:n[4],limits:n[7]()}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p:x,i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function ji(n){let e;return{c(){e=S("Population density")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Bi(n){let e;return{c(){e=S(`NOMIS TS006
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Hi(n){let e;return{c(){e=S(`ONS Geography
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ri(n){let e,r,t,o,l,i,a,s,f;return t=new X({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Bi]},$$scope:{ctx:n}}}),l=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Hi]},$$scope:{ctx:n}}}),s=new Ge({}),{c(){e=N("p"),r=S("Population density data is from the 2021 census, via "),_(t.$$.fragment),o=S(". Output area boundaries from "),_(l.$$.fragment),i=S("."),a=T(),_(s.$$.fragment)},m(u,c){d(u,e,c),M(e,r),b(t,e,null),M(e,o),b(l,e,null),M(e,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&65536&&(p.$$scope={dirty:c,ctx:u}),t.$set(p);const $={};c&65536&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){f||(m(t.$$.fragment,u),m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){h(t.$$.fragment,u),h(l.$$.fragment,u),h(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(a)),w(t),w(l),w(s,u)}}}function Wi(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Ri]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&65536&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function rn(n){let e,r,t,o;return t=new tt({props:{colorScale:n[4],limits:n[7]().map(Ui)}}),{c(){e=N("p"),e.textContent="(people per square kilometres)",r=T(),_(t.$$.fragment)},m(l,i){d(l,e,i),d(l,r,i),b(t,l,i),o=!0},p:x,i(l){o||(m(t.$$.fragment,l),o=!0)},o(l){h(t.$$.fragment,l),o=!1},d(l){l&&(g(e),g(r)),w(t,l)}}}function zi(n){let e,r,t,o,l,i,a,s,f,u,c,p,$,y;function k(P){n[9](P)}let C={id:"percent_households_with_car",$$slots:{right:[Ii],default:[Ci]},$$scope:{ctx:n}};n[0]!==void 0&&(C.checked=n[0]),e=new se({props:C}),q.push(()=>Z(e,"checked",k)),e.$on("change",n[10]);let v=n[3]=="percent_households_with_car"&&en(n);function A(P){n[11](P)}let F={id:"average_cars_per_household",$$slots:{right:[Fi],default:[Pi]},$$scope:{ctx:n}};n[1]!==void 0&&(F.checked=n[1]),l=new se({props:F}),q.push(()=>Z(l,"checked",A)),l.$on("change",n[12]);let O=n[3]=="average_cars_per_household"&&tn(n);function E(P){n[13](P)}let H={id:"population_density",$$slots:{right:[Wi],default:[ji]},$$scope:{ctx:n}};n[2]!==void 0&&(H.checked=n[2]),f=new se({props:H}),q.push(()=>Z(f,"checked",E)),f.$on("change",n[14]);let I=n[3]=="population_density"&&rn(n);return $=new pe({props:{layer:Ee,tooltip:n[5],show:n[3]!="",clickable:!0}}),$.$on("click",n[6]),{c(){_(e.$$.fragment),t=T(),v&&v.c(),o=T(),_(l.$$.fragment),a=T(),O&&O.c(),s=T(),_(f.$$.fragment),c=T(),I&&I.c(),p=T(),_($.$$.fragment)},m(P,D){b(e,P,D),d(P,t,D),v&&v.m(P,D),d(P,o,D),b(l,P,D),d(P,a,D),O&&O.m(P,D),d(P,s,D),b(f,P,D),d(P,c,D),I&&I.m(P,D),d(P,p,D),b($,P,D),y=!0},p(P,[D]){const L={};D&65536&&(L.$$scope={dirty:D,ctx:P}),!r&&D&1&&(r=!0,L.checked=P[0],Y(()=>r=!1)),e.$set(L),P[3]=="percent_households_with_car"?v?(v.p(P,D),D&8&&m(v,1)):(v=en(P),v.c(),m(v,1),v.m(o.parentNode,o)):v&&(te(),h(v,1,1,()=>{v=null}),re());const B={};D&65536&&(B.$$scope={dirty:D,ctx:P}),!i&&D&2&&(i=!0,B.checked=P[1],Y(()=>i=!1)),l.$set(B),P[3]=="average_cars_per_household"?O?(O.p(P,D),D&8&&m(O,1)):(O=tn(P),O.c(),m(O,1),O.m(s.parentNode,s)):O&&(te(),h(O,1,1,()=>{O=null}),re());const W={};D&65536&&(W.$$scope={dirty:D,ctx:P}),!u&&D&4&&(u=!0,W.checked=P[2],Y(()=>u=!1)),f.$set(W),P[3]=="population_density"?I?(I.p(P,D),D&8&&m(I,1)):(I=rn(P),I.c(),m(I,1),I.m(p.parentNode,p)):I&&(te(),h(I,1,1,()=>{I=null}),re());const V={};D&8&&(V.show=P[3]!=""),$.$set(V)},i(P){y||(m(e.$$.fragment,P),m(v),m(l.$$.fragment,P),m(O),m(f.$$.fragment,P),m(I),m($.$$.fragment,P),y=!0)},o(P){h(e.$$.fragment,P),h(v),h(l.$$.fragment,P),h(O),h(f.$$.fragment,P),h(I),h($.$$.fragment,P),y=!1},d(P){P&&(g(t),g(o),g(a),g(s),g(c),g(p)),w(e,P),v&&v.d(P),w(l,P),O&&O.d(P),w(f,P),I&&I.d(P),w($,P)}}}let Ee="census_output_areas";const Ui=n=>n.toLocaleString();function Gi(n,e,r){let t;J(n,me,F=>r(8,t=F));let o=`${Ee}-outline`,l=Q.sequential_low_to_high,i=!1,a=!1,s=!1,f="";Be(t,Ee,`${ue()}/v1/${Ee}.pmtiles`),vn(t,{id:Ee,source:Ee,sourceLayer:Ee,color:"black",opacity:mt(.5,.7)}),xe(t,{id:o,source:Ee,sourceLayer:Ee,color:"black",width:.5});function u(F){let O=F.properties.OA21CD,E=F.properties[f];return f=="percent_households_with_car"?`<p>${E}% of households in ${O} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${O} have an average of ${E} cars</p>`:`<p>There are ${E.toLocaleString()} people per square kilometre in ${O}</p>`}function c(F){let O=F.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${O}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${O}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(F){i=F,r(0,i)}const y=()=>{r(1,a=!1),r(2,s=!1)};function k(F){a=F,r(1,a)}const C=()=>{r(0,i=!1),r(2,s=!1)};function v(F){s=F,r(2,s)}const A=()=>{r(0,i=!1),r(1,a=!1)};return n.$$.update=()=>{n.$$.dirty&271&&(i?r(3,f="percent_households_with_car"):a?r(3,f="average_cars_per_household"):s?r(3,f="population_density"):r(3,f=""),f?(t.setPaintProperty(Ee,"fill-color",Qe(["get",f],p(),l)),t.setLayoutProperty(o,"visibility","visible")):t.setLayoutProperty(o,"visibility","none"))},[i,a,s,f,l,u,c,p,t,$,y,k,C,v,A]}class Vi extends U{constructor(e){super(),G(this,e,Gi,zi,z,{})}}function qi(n){let e,r,t;return e=new ve({props:{color:n[2]}}),{c(){_(e.$$.fragment),r=S(`
  Combined authorities`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function Xi(n){let e;return{c(){e=S(`ONS Geography
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ki(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Xi]},$$scope:{ctx:n}}}),i=new Ge({}),{c(){e=N("p"),r=S("Data from "),_(t.$$.fragment),o=S(", as of December 2022."),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function Zi(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Ki]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Yi(n){let e,r=n[5][0].properties.name+"",t;return{c(){e=N("p"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&32&&r!==(r=o[5][0].properties.name+"")&&ie(t,r)},d(o){o&&g(e)}}}function Ji(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[Yi,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Qi(n){let e,r,t,o;return e=new St({props:{id:zt,paint:{"fill-color":n[2],"fill-opacity":$t(0,.5)},layout:{visibility:n[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[Ji]},$$scope:{ctx:n}}}),e.$on("click",ea),t=new Ct({props:{id:n[3],paint:{"line-color":n[2],"line-width":2.5},layout:{visibility:n[1]}}}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function xi(n){let e,r,t,o,l;function i(s){n[4](s)}let a={id:zt,$$slots:{right:[Zi],default:[qi]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new pr({props:{data:`${ue()}/v1/${zt}.geojson`,$$slots:{default:[Qi]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let zt="combined_authorities";function ea(n){window.open(`https://www.ons.gov.uk/visualisations/areas/${n.detail.features[0].properties.CAUTH22CD}`,"_blank")}function ta(n,e,r){let t,o=Q.combined_authorities,l=`${zt}-outline`,i=!1;function a(s){i=s,r(0,i)}return n.$$.update=()=>{n.$$.dirty&1&&r(1,t=i?"visible":"none")},[i,t,o,l,a]}class ra extends U{constructor(e){super(),G(this,e,ta,xi,z,{})}}function na(n){let e;return{c(){e=S("Indices of Multiple Deprivation")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function oa(n){let e;return{c(){e=S(`DLUCH GIS
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function la(n){let e;return{c(){e=S(`here
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function sa(n){let e,r,t,o,l,i,a,s,f;return t=new X({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[oa]},$$scope:{ctx:n}}}),l=new X({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[la]},$$scope:{ctx:n}}}),s=new Ge({}),{c(){e=N("p"),r=S("The 2019 English IMD scores come from "),_(t.$$.fragment),o=S(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(l.$$.fragment),i=S("."),a=T(),_(s.$$.fragment)},m(u,c){d(u,e,c),M(e,r),b(t,e,null),M(e,o),b(l,e,null),M(e,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),t.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){f||(m(t.$$.fragment,u),m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){h(t.$$.fragment,u),h(l.$$.fragment,u),h(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(a)),w(t),w(l),w(s,u)}}}function ia(n){let e,r,t;return r=new ae({props:{$$slots:{default:[sa]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function nn(n){let e,r;return e=new tt({props:{colorScale:n[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p:x,i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function aa(n){let e,r,t,o,l,i;function a(u){n[3](u)}let s={id:Ne,$$slots:{right:[ia],default:[na]},$$scope:{ctx:n}};n[0]!==void 0&&(s.checked=n[0]),e=new se({props:s}),q.push(()=>Z(e,"checked",a));let f=n[0]&&nn(n);return l=new pe({props:{layer:Ne,tooltip:fa,show:n[0],clickable:!1}}),{c(){_(e.$$.fragment),t=T(),f&&f.c(),o=T(),_(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],Y(()=>r=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=nn(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(te(),h(f,1,1,()=>{f=null}),re());const $={};c&1&&($.show=u[0]),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){h(e.$$.fragment,u),h(f),h(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),w(e,u),f&&f.d(u),w(l,u)}}}let Ne="imd";function fa(n){return`<p>${n.properties.LSOA11CD} has an IMD score of <b>${n.properties.score}</b></p><p>Rank: <b>${n.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function ua(n,e,r){let t;J(n,me,f=>r(2,t=f));let o=`${Ne}-outline`,l=Q.sequential_low_to_high,i=[0,2,4,6,8,10];Be(t,Ne,`${ue()}/v1/${Ne}.pmtiles`),vn(t,{id:Ne,source:Ne,sourceLayer:Ne,color:Qe(["-",10,["get","decile"]],i,l),opacity:mt(.5,.7)}),xe(t,{id:o,source:Ne,sourceLayer:Ne,color:"black",width:.5});let a=!1;function s(f){a=f,r(0,a)}return n.$$.update=()=>{n.$$.dirty&5&&t.getLayer(o)&&t.setLayoutProperty(o,"visibility",a?"visible":"none")},[a,l,t,s]}class ca extends U{constructor(e){super(),G(this,e,ua,aa,z,{})}}function pa(n){let e,r,t;return e=new ve({props:{color:n[2]}}),{c(){_(e.$$.fragment),r=S(`
  Local Authority Districts`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function ma(n){let e;return{c(){e=S(`ONS Geography
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function $a(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[ma]},$$scope:{ctx:n}}}),i=new Ge({}),{c(){e=N("p"),r=S("Data from "),_(t.$$.fragment),o=S(", as of May 2023."),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function da(n){let e,r,t;return r=new ae({props:{$$slots:{default:[$a]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function ga(n){let e,r=n[5][0].properties.name+"",t;return{c(){e=N("p"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&32&&r!==(r=o[5][0].properties.name+"")&&ie(t,r)},d(o){o&&g(e)}}}function ha(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[ga,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function _a(n){let e,r,t,o;return e=new St({props:{id:Ut,paint:{"fill-color":n[2],"fill-opacity":$t(0,.5)},layout:{visibility:n[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[ha]},$$scope:{ctx:n}}}),e.$on("click",wa),t=new Ct({props:{id:n[3],paint:{"line-color":n[2],"line-width":2.5},layout:{visibility:n[1]}}}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function ba(n){let e,r,t,o,l;function i(s){n[4](s)}let a={id:Ut,$$slots:{right:[da],default:[pa]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new pr({props:{data:`${ue()}/v1/${Ut}.geojson`,$$slots:{default:[_a]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let Ut="local_authority_districts";function wa(n){window.open(`https://www.ons.gov.uk/visualisations/areas/${n.detail.features[0].properties.LAD23CD}`,"_blank")}function va(n,e,r){let t,o=Q.local_authority_districts,l=`${Ut}-outline`,i=!1;function a(s){i=s,r(0,i)}return n.$$.update=()=>{n.$$.dirty&1&&r(1,t=i?"visible":"none")},[i,t,o,l,a]}class ya extends U{constructor(e){super(),G(this,e,va,ba,z,{})}}function ka(n){let e,r,t;return e=new ve({props:{color:n[2]}}),{c(){_(e.$$.fragment),r=S(`
  Local Planning Authorities`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function Sa(n){let e;return{c(){e=S(`local authority
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ca(n){let e;return{c(){e=S(`national park authorit
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function La(n){let e;return{c(){e=S(`development corporation
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ta(n){let e;return{c(){e=S("this map")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Oa(n){let e;return{c(){e=S(`planning.data.gov.uk
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Aa(n){let e,r,t,o,l,i,a,s,f,u,c,p,$,y,k,C,v,A,F,O,E,H;return t=new X({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Sa]},$$scope:{ctx:n}}}),l=new X({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Ca]},$$scope:{ctx:n}}}),a=new X({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[La]},$$scope:{ctx:n}}}),$=new X({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Ta]},$$scope:{ctx:n}}}),A=new X({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Oa]},$$scope:{ctx:n}}}),E=new Ge({}),{c(){e=N("p"),r=S("LPAs may be a "),_(t.$$.fragment),o=S(", "),_(l.$$.fragment),i=S("y, or "),_(a.$$.fragment),s=S("."),f=T(),u=N("p"),c=N("strong"),p=S(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),y=S(" to get more details."),k=T(),C=N("p"),v=S("Data from ONS Geography via "),_(A.$$.fragment),F=S(", as of November 2022."),O=T(),_(E.$$.fragment)},m(I,P){d(I,e,P),M(e,r),b(t,e,null),M(e,o),b(l,e,null),M(e,i),b(a,e,null),M(e,s),d(I,f,P),d(I,u,P),M(u,c),M(c,p),b($,c,null),M(c,y),d(I,k,P),d(I,C,P),M(C,v),b(A,C,null),M(C,F),d(I,O,P),b(E,I,P),H=!0},p(I,P){const D={};P&64&&(D.$$scope={dirty:P,ctx:I}),t.$set(D);const L={};P&64&&(L.$$scope={dirty:P,ctx:I}),l.$set(L);const B={};P&64&&(B.$$scope={dirty:P,ctx:I}),a.$set(B);const W={};P&64&&(W.$$scope={dirty:P,ctx:I}),$.$set(W);const V={};P&64&&(V.$$scope={dirty:P,ctx:I}),A.$set(V)},i(I){H||(m(t.$$.fragment,I),m(l.$$.fragment,I),m(a.$$.fragment,I),m($.$$.fragment,I),m(A.$$.fragment,I),m(E.$$.fragment,I),H=!0)},o(I){h(t.$$.fragment,I),h(l.$$.fragment,I),h(a.$$.fragment,I),h($.$$.fragment,I),h(A.$$.fragment,I),h(E.$$.fragment,I),H=!1},d(I){I&&(g(e),g(f),g(u),g(k),g(C),g(O)),w(t),w(l),w(a),w($),w(A),w(E,I)}}}function Ia(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Aa]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Pa(n){let e,r=n[5][0].properties.name+"",t;return{c(){e=N("p"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&32&&r!==(r=o[5][0].properties.name+"")&&ie(t,r)},d(o){o&&g(e)}}}function Ma(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[Pa,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Ea(n){let e,r,t,o;return e=new St({props:{id:ht,sourceLayer:ht,paint:{"fill-color":n[2],"fill-opacity":$t(0,.5)},layout:{visibility:n[1]},manageHoverState:!0,$$slots:{default:[Ma]},$$scope:{ctx:n}}}),t=new Ct({props:{id:n[3],sourceLayer:ht,paint:{"line-color":n[2],"line-width":2.5},layout:{visibility:n[1]}}}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function Na(n){let e,r,t,o,l;function i(s){n[4](s)}let a={id:ht,$$slots:{right:[Ia],default:[ka]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new Mt({props:{url:`pmtiles://${ue()}/v1/${ht}.pmtiles`,$$slots:{default:[Ea]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let ht="local_planning_authorities";function Da(n,e,r){let t,o=Q.local_planning_authorities,l=`${ht}-outline`,i=!1;function a(s){i=s,r(0,i)}return n.$$.update=()=>{n.$$.dirty&1&&r(1,t=i?"visible":"none")},[i,t,o,l,a]}class Fa extends U{constructor(e){super(),G(this,e,Da,Na,z,{})}}function ja(n){let e,r,t;return e=new ve({props:{color:n[2]}}),{c(){_(e.$$.fragment),r=S(`
  Parliamentary constituencies`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function Ba(n){let e;return{c(){e=S(`Ordnance Survey Boundary-Line
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ha(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Ba]},$$scope:{ctx:n}}}),i=new Ge({}),{c(){e=N("p"),r=S("Data from "),_(t.$$.fragment),o=S(", as of May 2023."),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function Ra(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Ha]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Wa(n){let e,r=n[5][0].properties.Name+"",t;return{c(){e=N("p"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&32&&r!==(r=o[5][0].properties.Name+"")&&ie(t,r)},d(o){o&&g(e)}}}function za(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[Wa,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Ua(n){let e,r,t,o;return e=new St({props:{id:_t,sourceLayer:_t,paint:{"fill-color":n[2],"fill-opacity":$t(0,.5)},layout:{visibility:n[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[za]},$$scope:{ctx:n}}}),e.$on("click",Va),t=new Ct({props:{id:n[3],sourceLayer:_t,paint:{"line-color":n[2],"line-width":5},layout:{visibility:n[1]}}}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function Ga(n){let e,r,t,o,l;function i(s){n[4](s)}let a={id:_t,$$slots:{right:[Ra],default:[ja]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new Mt({props:{url:`pmtiles://${ue()}/v1/${_t}.pmtiles`,$$slots:{default:[Ua]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let _t="parliamentary_constituencies";function Va(n){let e=n.detail.features[0].properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function qa(n,e,r){let t,o=Q.parliamentary_constituencies,l=`${_t}-outline`,i=!1;function a(s){i=s,r(0,i)}return n.$$.update=()=>{n.$$.dirty&1&&r(1,t=i?"visible":"none")},[i,t,o,l,a]}class Xa extends U{constructor(e){super(),G(this,e,qa,Ga,z,{})}}function Ka(n){let e,r,t;return e=new ve({props:{color:n[2]}}),{c(){_(e.$$.fragment),r=S(`
  Wards`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function Za(n){let e;return{c(){e=S(`ONS Geography
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ya(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[Za]},$$scope:{ctx:n}}}),i=new Ge({}),{c(){e=N("p"),r=S("Data from "),_(t.$$.fragment),o=S(", as of May 2023."),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function Ja(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Ya]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Qa(n){let e,r=n[5][0].properties.name+"",t;return{c(){e=N("p"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&32&&r!==(r=o[5][0].properties.name+"")&&ie(t,r)},d(o){o&&g(e)}}}function xa(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[Qa,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function ef(n){let e,r,t,o;return e=new St({props:{id:bt,sourceLayer:bt,paint:{"fill-color":n[2],"fill-opacity":$t(0,.5)},layout:{visibility:n[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[xa]},$$scope:{ctx:n}}}),e.$on("click",rf),t=new Ct({props:{id:n[3],sourceLayer:bt,paint:{"line-color":n[2],"line-width":2.5},layout:{visibility:n[1]}}}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function tf(n){let e,r,t,o,l;function i(s){n[4](s)}let a={id:bt,$$slots:{right:[Ja],default:[Ka]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new Mt({props:{url:`pmtiles://${ue()}/v1/${bt}.pmtiles`,$$slots:{default:[ef]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let bt="wards";function rf(n){let e=encodeURIComponent(n.detail.features[0].properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function nf(n,e,r){let t,o=Q.wards,l=`${bt}-outline`,i=!1;function a(s){i=s,r(0,i)}return n.$$.update=()=>{n.$$.dirty&1&&r(1,t=i?"visible":"none")},[i,t,o,l,a]}class of extends U{constructor(e){super(),G(this,e,nf,tf,z,{})}}function lf(n){let e;return{c(){e=S("Open Data Commons Open Database License")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function sf(n){let e,r,t,o;return t=new X({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[lf]},$$scope:{ctx:n}}}),{c(){e=N("p"),r=S("License: "),_(t.$$.fragment)},m(l,i){d(l,e,i),M(e,r),b(t,e,null),o=!0},p(l,[i]){const a={};i&1&&(a.$$scope={dirty:i,ctx:l}),t.$set(a)},i(l){o||(m(t.$$.fragment,l),o=!0)},o(l){h(t.$$.fragment,l),o=!1},d(l){l&&g(e),w(t)}}}class rt extends U{constructor(e){super(),G(this,e,null,sf,z,{})}}function af(n){let e,r,t;return e=new ve({props:{color:Q.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=S(`
  Bus routes`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function ff(n){let e;return{c(){e=S(`GTFS
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function uf(n){let e,r,t,o,l,i,a,s,f;return l=new X({props:{href:"https://gtfs.org",$$slots:{default:[ff]},$$scope:{ctx:n}}}),s=new rt({}),{c(){e=N("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=T(),t=N("p"),o=S("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(l.$$.fragment),i=S(`, and doesn't include which routes are run or the
        frequency of service.`),a=T(),_(s.$$.fragment)},m(u,c){d(u,e,c),d(u,r,c),d(u,t,c),M(t,o),b(l,t,null),M(t,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&8&&(p.$$scope={dirty:c,ctx:u}),l.$set(p)},i(u){f||(m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){h(l.$$.fragment,u),h(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(r),g(t),g(a)),w(l),w(s,u)}}}function cf(n){let e,r,t;return r=new ae({props:{$$slots:{default:[uf]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&8&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function pf(n){let e,r,t,o,l;function i(s){n[1](s)}let a={id:ot,$$slots:{right:[cf],default:[af]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new pe({props:{layer:ot,tooltip:mf,show:n[0],clickable:!1}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&8&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=s[0]),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let ot="bus_routes";function mf(n){return n.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function $f(n,e,r){let t;J(n,me,i=>r(2,t=i)),Be(t,ot,`${ue()}/v1/${ot}.pmtiles`),xe(t,{id:ot,source:ot,sourceLayer:ot,color:["case",["boolean",["get","has_bus_lane"],!1],Q.bus_route_with_lane,Q.bus_route_without_lane],width:5,opacity:mt(.5,1)});let o=!1;function l(i){o=i,r(0,o)}return[o,l]}class df extends U{constructor(e){super(),G(this,e,$f,pf,z,{})}}function on(n){const e=kf(n[4][0]);n[5]=e[0],n[6]=e[1],n[7]=e[2]}function ln(n,e,r){const t=n.slice();return t[8]=e[r][0],t[9]=e[r][1],t}function gf(n){let e;return{c(){e=S("Cycle paths")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function hf(n){let e,r,t,o,l,i,a,s;return a=new rt({}),{c(){e=N("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=T(),t=N("ul"),t.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=T(),l=N("p"),l.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,i=T(),_(a.$$.fragment)},m(f,u){d(f,e,u),d(f,r,u),d(f,t,u),d(f,o,u),d(f,l,u),d(f,i,u),b(a,f,u),s=!0},p:x,i(f){s||(m(a.$$.fragment,f),s=!0)},o(f){h(a.$$.fragment,f),s=!1},d(f){f&&(g(e),g(r),g(t),g(o),g(l),g(i)),w(a,f)}}}function _f(n){let e,r,t;return r=new ae({props:{$$slots:{default:[hf]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&4096&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function sn(n){let e,r,t=Fe(n[2]),o=[];for(let i=0;i<t.length;i+=1)o[i]=an(ln(n,t,i));const l=i=>h(o[i],1,1,()=>{o[i]=null});return{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=ge()},m(i,a){for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(i,a);d(i,e,a),r=!0},p(i,a){if(a&4){t=Fe(i[2]);let s;for(s=0;s<t.length;s+=1){const f=ln(i,t,s);o[s]?(o[s].p(f,a),m(o[s],1)):(o[s]=an(f),o[s].c(),m(o[s],1),o[s].m(e.parentNode,e))}for(te(),s=t.length;s<o.length;s+=1)l(s);re()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(o[a]);r=!0}},o(i){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)h(o[a]);r=!1},d(i){i&&g(e),Bt(o,i)}}}function an(n){let e,r,t,o=n[8]+"",l,i,a;return r=new ve({props:{color:n[9]}}),{c(){e=N("div"),_(r.$$.fragment),t=T(),l=S(o),i=T()},m(s,f){d(s,e,f),b(r,e,null),M(e,t),M(e,l),M(e,i),a=!0},p:x,i(s){a||(m(r.$$.fragment,s),a=!0)},o(s){h(r.$$.fragment,s),a=!1},d(s){s&&g(e),w(r)}}}function bf(n){on(n);let e,r=n[5]+"",t,o,l,i,a,s=n[6]+"",f,u,c,p,$=n[7]+"",y;return{c(){e=N("h2"),t=S(r),o=T(),l=N("p"),i=S("Direction: "),a=N("b"),f=T(),u=N("p"),c=S("Width: "),p=N("b"),y=S($)},m(k,C){d(k,e,C),M(e,t),d(k,o,C),d(k,l,C),M(l,i),M(l,a),a.innerHTML=s,d(k,f,C),d(k,u,C),M(u,c),M(u,p),M(p,y)},p(k,C){on(k),C&16&&r!==(r=k[5]+"")&&ie(t,r),C&16&&s!==(s=k[6]+"")&&(a.innerHTML=s),C&16&&$!==($=k[7]+"")&&ie(y,$)},d(k){k&&(g(e),g(o),g(l),g(f),g(u))}}}function wf(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[bf,({features:t})=>({4:t}),({features:t})=>t?16:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&4112&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function vf(n){let e,r;return e=new Ct({props:{id:Gt,sourceLayer:Gt,paint:{"line-color":bn(["get","kind"],{track:Q.cycle_paths.track,lane:Q.cycle_paths.lane,shared_use_segregated:Q.cycle_paths.shared_use_segregated,shared_use_unsegregated:Q.cycle_paths.shared_use_unsegregated},"red"),"line-width":Vt,"line-opacity":$t(1,.5)},layout:{visibility:n[1]},hoverCursor:"pointer",$$slots:{default:[wf]},$$scope:{ctx:n}}}),e.$on("click",Sf),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&4096&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function yf(n){let e,r,t,o,l,i;function a(u){n[3](u)}let s={id:Gt,$$slots:{right:[_f],default:[gf]},$$scope:{ctx:n}};n[0]!==void 0&&(s.checked=n[0]),e=new se({props:s}),q.push(()=>Z(e,"checked",a));let f=n[0]&&sn(n);return l=new Mt({props:{url:`pmtiles://${ue()}/v1/${Gt}.pmtiles`,$$slots:{default:[vf]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),f&&f.c(),o=T(),_(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&4096&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],Y(()=>r=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=sn(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(te(),h(f,1,1,()=>{f=null}),re());const $={};c&4098&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){h(e.$$.fragment,u),h(f),h(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),w(e,u),f&&f.d(u),w(l,u)}}}let Gt="cycle_paths";function kf(n){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[n.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[n.properties.direction],t=n.properties.width=="unknown"?"unknown":`${n.properties.width} meters`;return[e,`${r} ${n.properties.direction}`,t]}function Sf(n){window.open(`http://openstreetmap.org/way/${n.detail.features[0].properties.osm_id}`,"_blank")}function Cf(n,e,r){let t,o=[["Separated tracks",Q.cycle_paths.track],["Unprotected lanes",Q.cycle_paths.lane],["Shared-use (segregated)",Q.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",Q.cycle_paths.shared_use_unsegregated]],l=!1;function i(a){l=a,r(0,l)}return n.$$.update=()=>{n.$$.dirty&1&&r(1,t=l?"visible":"none")},[l,t,o,i]}class Lf extends U{constructor(e){super(),G(this,e,Cf,yf,z,{})}}function Tf(n){let e,r,t;return e=new ve({props:{color:n[1]}}),{c(){_(e.$$.fragment),r=S(`
  Major Road Network`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function Of(n){let e;return{c(){e=S(`Major Road Network
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Af(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Of]},$$scope:{ctx:n}}}),i=new Ge({}),{c(){e=N("p"),r=S("Data from the "),_(t.$$.fragment),o=S(", as of September 2021."),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&16&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function If(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Af]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&16&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Pf(n){let e,r,t,o,l;function i(s){n[2](s)}let a={id:lt,$$slots:{right:[If],default:[Tf]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new pe({props:{layer:lt,tooltip:Mf,show:n[0],clickable:!1}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&16&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=s[0]),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let lt="mrn";function Mf(n){return`<p>${n.properties.name??"Unknown MRN road"}</p>`}function Ef(n,e,r){let t;J(n,me,a=>r(3,t=a));let o=Q.mrn;Be(t,lt,`${ue()}/v1/${lt}.pmtiles`),xe(t,{id:lt,source:lt,sourceLayer:lt,color:o,width:7,opacity:mt(.5,1)});let l=!1;function i(a){l=a,r(0,l)}return[l,o,i]}class Nf extends U{constructor(e){super(),G(this,e,Ef,Pf,z,{})}}function Df(n){let e;return{c(){e=S("Propensity to Cycle Tool")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Ff(n){let e;return{c(){e=S("the PCT website")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function jf(n){let e;return{c(){e=S("2017 journal article")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Bf(n){let e,r,t,o,l,i,a,s,f,u,c;return a=new X({props:{href:"https://www.pct.bike",$$slots:{default:[Ff]},$$scope:{ctx:n}}}),f=new X({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[jf]},$$scope:{ctx:n}}}),{c(){e=N("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=T(),t=N("p"),t.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=T(),l=N("p"),i=S("See "),_(a.$$.fragment),s=S(" and "),_(f.$$.fragment),u=S(" for details on methodology and data sources.")},m(p,$){d(p,e,$),d(p,r,$),d(p,t,$),d(p,o,$),d(p,l,$),M(l,i),b(a,l,null),M(l,s),b(f,l,null),M(l,u),c=!0},p(p,$){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),a.$set(y);const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),f.$set(k)},i(p){c||(m(a.$$.fragment,p),m(f.$$.fragment,p),c=!0)},o(p){h(a.$$.fragment,p),h(f.$$.fragment,p),c=!1},d(p){p&&(g(e),g(r),g(t),g(o),g(l)),w(a),w(f)}}}function Hf(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Bf]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&2048&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function fn(n){let e,r,t,o,l,i,a,s;e=new tt({props:{colorScale:n[3],limits:n[4]}});function f($){n[8]($)}let u={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};n[0]!==void 0&&(u.value=n[0]),t=new yn({props:u}),q.push(()=>Z(t,"value",f)),t.$on("change",n[6]);function c($){n[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return n[1]!==void 0&&(p.value=n[1]),i=new Ht({props:p}),q.push(()=>Z(i,"value",c)),i.$on("change",n[6]),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),l=T(),_(i.$$.fragment)},m($,y){b(e,$,y),d($,r,y),b(t,$,y),d($,l,y),b(i,$,y),s=!0},p($,y){const k={};!o&&y&1&&(o=!0,k.value=$[0],Y(()=>o=!1)),t.$set(k);const C={};!a&&y&2&&(a=!0,C.value=$[1],Y(()=>a=!1)),i.$set(C)},i($){s||(m(e.$$.fragment,$),m(t.$$.fragment,$),m(i.$$.fragment,$),s=!0)},o($){h(e.$$.fragment,$),h(t.$$.fragment,$),h(i.$$.fragment,$),s=!1},d($){$&&(g(r),g(l)),w(e,$),w(t,$),w(i,$)}}}function Rf(n){let e,r,t,o,l,i,a,s;function f(p){n[7](p)}let u={id:ut,$$slots:{right:[Hf],default:[Df]},$$scope:{ctx:n}};n[2]!==void 0&&(u.checked=n[2]),e=new se({props:u}),q.push(()=>Z(e,"checked",f));let c=n[2]&&fn(n);return l=new pe({props:{layer:ut,tooltip:n[5],show:n[2]&&n[0]==ut,clickable:!1}}),a=new pe({props:{layer:jt,tooltip:n[5],show:n[2]&&n[0]==jt,clickable:!1}}),{c(){_(e.$$.fragment),t=T(),c&&c.c(),o=T(),_(l.$$.fragment),i=T(),_(a.$$.fragment)},m(p,$){b(e,p,$),d(p,t,$),c&&c.m(p,$),d(p,o,$),b(l,p,$),d(p,i,$),b(a,p,$),s=!0},p(p,[$]){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,y.checked=p[2],Y(()=>r=!1)),e.$set(y),p[2]?c?(c.p(p,$),$&4&&m(c,1)):(c=fn(p),c.c(),m(c,1),c.m(o.parentNode,o)):c&&(te(),h(c,1,1,()=>{c=null}),re());const k={};$&5&&(k.show=p[2]&&p[0]==ut),l.$set(k);const C={};$&5&&(C.show=p[2]&&p[0]==jt),a.$set(C)},i(p){s||(m(e.$$.fragment,p),m(c),m(l.$$.fragment,p),m(a.$$.fragment,p),s=!0)},o(p){h(e.$$.fragment,p),h(c),h(l.$$.fragment,p),h(a.$$.fragment,p),s=!1},d(p){p&&(g(t),g(o),g(i)),w(e,p),c&&c.d(p),w(l,p),w(a,p)}}}let ut="pct_commute",jt="pct_school";function Wf(n,e,r){let t;J(n,me,y=>r(10,t=y));let o=Q.sequential_low_to_high,l=[0,50,100,500,1e3,2e3],i=ut,a="baseline";for(let y of[ut,jt])Be(t,y,`${ue()}/v1/${y}.pmtiles`),xe(t,{id:y,source:y,sourceLayer:y,color:Qe(["get",a],l,o),width:Vt,opacity:mt(.5,1)});let s=!1;function f(y){let k=y.properties.baseline,C=y.properties.gov_target,v=y.properties.go_dutch,A=`<h2>Trip purpose: ${i==ut?"commuting":"school"}</h2>`;if(A+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)A+=`<p>Government target (2025): <b>${C.toLocaleString()}</b></p>`,A+=`<p>Go Dutch: <b>${v.toLocaleString()}</b></p>`;else{let F=(C/k).toFixed(1),O=(v/k).toFixed(1);A+=`<p>Government target (2025): ${C.toLocaleString()} (<b>${F}x</b> of baseline)</p>`,A+=`<p>Go Dutch: ${v.toLocaleString()} (<b>${O}x</b> of baseline)</p>`}return A}function u(){t.setPaintProperty(i,"line-color",Qe(["get",a],l,o))}function c(y){s=y,r(2,s)}function p(y){i=y,r(0,i)}function $(y){a=y,r(1,a)}return[i,a,s,o,l,f,u,c,p,$]}class zf extends U{constructor(e){super(),G(this,e,Wf,Rf,z,{})}}function Uf(n){let e;return{c(){e=S("OS Speeds")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Gf(n){let e;return{c(){e=S("Basemap")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Vf(n){let e;return{c(){e=S(`Public Sector Geospatial Agreement
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function qf(n){let e,r,t,o,l,i,a,s,f,u,c,p;return t=new X({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[Gf]},$$scope:{ctx:n}}}),u=new X({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Vf]},$$scope:{ctx:n}}}),{c(){e=N("p"),r=S("The average speed data is collected over a six-month period by "),_(t.$$.fragment),o=S(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),l=T(),i=N("p"),i.textContent="Data valid as of 1 September, 2023",a=T(),s=N("p"),f=S(`License: Contains OS data  Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),c=S(".")},m($,y){d($,e,y),M(e,r),b(t,e,null),M(e,o),d($,l,y),d($,i,y),d($,a,y),d($,s,y),M(s,f),b(u,s,null),M(s,c),p=!0},p($,y){const k={};y&256&&(k.$$scope={dirty:y,ctx:$}),t.$set(k);const C={};y&256&&(C.$$scope={dirty:y,ctx:$}),u.$set(C)},i($){p||(m(t.$$.fragment,$),m(u.$$.fragment,$),p=!0)},o($){h(t.$$.fragment,$),h(u.$$.fragment,$),p=!1},d($){$&&(g(e),g(l),g(i),g(a),g(s)),w(t),w(u)}}}function Xf(n){let e,r,t;return r=new ae({props:{$$slots:{default:[qf]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&256&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function un(n){let e,r,t,o,l;e=new tt({props:{colorScale:n[2],limits:n[3]}});function i(s){n[6](s)}let a={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return n[0]!==void 0&&(a.value=n[0]),t=new yn({props:a}),q.push(()=>Z(t,"value",i)),t.$on("change",n[4]),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(s,f){b(e,s,f),d(s,r,f),b(t,s,f),l=!0},p(s,f){const u={};!o&&f&1&&(o=!0,u.value=s[0],Y(()=>o=!1)),t.$set(u)},i(s){l||(m(e.$$.fragment,s),m(t.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(t.$$.fragment,s),l=!1},d(s){s&&g(r),w(e,s),w(t,s)}}}function Kf(n){let e,r,t,o,l,i;function a(u){n[5](u)}let s={id:Ze,$$slots:{right:[Xf],default:[Uf]},$$scope:{ctx:n}};n[1]!==void 0&&(s.checked=n[1]),e=new se({props:s}),q.push(()=>Z(e,"checked",a));let f=n[1]&&un(n);return l=new pe({props:{layer:Ze,tooltip:Zf,show:n[1],clickable:!1}}),{c(){_(e.$$.fragment),t=T(),f&&f.c(),o=T(),_(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!r&&c&2&&(r=!0,p.checked=u[1],Y(()=>r=!1)),e.$set(p),u[1]?f?(f.p(u,c),c&2&&m(f,1)):(f=un(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(te(),h(f,1,1,()=>{f=null}),re());const $={};c&2&&($.show=u[1]),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){h(e.$$.fragment,u),h(f),h(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),w(e,u),f&&f.d(u),w(l,u)}}}let Ze="road_speeds";function Zf(n){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[n.properties.highest_description],r=`<p>Posted speed limit: ${n.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${n.properties.highest_mph} mph (during ${e})</p>`,r}function Yf(n,e,r){let t;J(n,me,c=>r(7,t=c));let o=Q.sequential_low_to_high,l=[0,20,30,40,50,90],i="indicative_mph";Be(t,Ze,`${ur()}/v1/${Ze}.pmtiles`),xe(t,{id:Ze,source:Ze,sourceLayer:Ze,color:Qe(["get",i],l,o),width:Vt,opacity:mt(.5,1)});let a=!1;function s(){t.setPaintProperty(Ze,"line-color",Qe(["get",i],l,o))}function f(c){a=c,r(1,a)}function u(c){i=c,r(0,i)}return[i,a,o,l,s,f,u]}class Jf extends U{constructor(e){super(),G(this,e,Yf,Kf,z,{})}}function Qf(n){let e;return{c(){e=S("OS Road widths")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function xf(n){let e;return{c(){e=S(`Public Sector Geospatial Agreement
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function eu(n){let e,r,t,o,l,i,a,s,f;return a=new X({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[xf]},$$scope:{ctx:n}}}),{c(){e=N("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=T(),t=N("p"),t.textContent="Data valid as of 1 September, 2023",o=T(),l=N("p"),i=S(`License: Contains OS data  Crown copyright and database right
        2023. Made available under the `),_(a.$$.fragment),s=S(".")},m(u,c){d(u,e,c),d(u,r,c),d(u,t,c),d(u,o,c),d(u,l,c),M(l,i),b(a,l,null),M(l,s),f=!0},p(u,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),a.$set(p)},i(u){f||(m(a.$$.fragment,u),f=!0)},o(u){h(a.$$.fragment,u),f=!1},d(u){u&&(g(e),g(r),g(t),g(o),g(l)),w(a)}}}function tu(n){let e,r,t;return r=new ae({props:{$$slots:{default:[eu]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&32&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function cn(n){let e,r;return e=new tt({props:{colorScale:n[1],limits:n[2]}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p:x,i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function ru(n){let e,r,t,o,l,i;function a(u){n[3](u)}let s={id:st,$$slots:{right:[tu],default:[Qf]},$$scope:{ctx:n}};n[0]!==void 0&&(s.checked=n[0]),e=new se({props:s}),q.push(()=>Z(e,"checked",a));let f=n[0]&&cn(n);return l=new pe({props:{layer:st,tooltip:nu,show:n[0],clickable:!1}}),{c(){_(e.$$.fragment),t=T(),f&&f.c(),o=T(),_(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],Y(()=>r=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=cn(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(te(),h(f,1,1,()=>{f=null}),re());const $={};c&1&&($.show=u[0]),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){h(e.$$.fragment,u),h(f),h(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),w(e,u),f&&f.d(u),w(l,u)}}}let st="road_widths";function nu(n){let e=`<p>Average width: ${n.properties.average} meters</p>`;return e+=`<p>Minimum width: ${n.properties.minimum} meters</p>`,e}function ou(n,e,r){let t;J(n,me,s=>r(4,t=s));let o=Q.sequential_low_to_high,l=[0,5,10,15,20,100];Be(t,st,`${ur()}/v1/${st}.pmtiles`),xe(t,{id:st,source:st,sourceLayer:st,color:Qe(["get","average"],l,o),width:Vt,opacity:mt(.5,1)});let i=!1;function a(s){i=s,r(0,i)}return[i,o,l,a]}class lu extends U{constructor(e){super(),G(this,e,ou,ru,z,{})}}function su(n){let e,r,t;return{c(){e=N("input"),K(e,"class","govuk-file-upload"),K(e,"id","load-criticals"),K(e,"type","file")},m(o,l){d(o,e,l),n[7](e),r||(t=wt(e,"change",n[4]),r=!0)},p:x,d(o){o&&g(e),n[7](null),r=!1,t()}}}function pn(n){let e,r;return e=new Pt({props:{small:!0,$$slots:{default:[au]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&517&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function iu(n){let e,r,t=n[2].toLocaleString()+"",o,l,i;return e=new ve({props:{color:sr}}),{c(){_(e.$$.fragment),r=S(`
        Show `),o=S(t),l=S(" issues")},m(a,s){b(e,a,s),d(a,r,s),d(a,o,s),d(a,l,s),i=!0},p(a,s){(!i||s&4)&&t!==(t=a[2].toLocaleString()+"")&&ie(o,t)},i(a){i||(m(e.$$.fragment,a),i=!0)},o(a){h(e.$$.fragment,a),i=!1},d(a){a&&(g(r),g(o),g(l)),w(e,a)}}}function au(n){let e,r,t;function o(i){n[8](i)}let l={id:"show-criticals",$$slots:{default:[iu]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.checked=n[0]),e=new se({props:l}),q.push(()=>Z(e,"checked",o)),{c(){_(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,a){const s={};a&516&&(s.$$scope={dirty:a,ctx:i}),!r&&a&1&&(r=!0,s.checked=i[0],Y(()=>r=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){w(e,i)}}}function fu(n){let e,r,t,o,l,i;e=new wn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[su]},$$scope:{ctx:n}}}),t=new kn({props:{errorMessage:n[3]}});let a=n[2]>0&&pn(n);return{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),a&&a.c(),l=ge()},m(s,f){b(e,s,f),d(s,r,f),b(t,s,f),d(s,o,f),a&&a.m(s,f),d(s,l,f),i=!0},p(s,f){const u={};f&514&&(u.$$scope={dirty:f,ctx:s}),e.$set(u);const c={};f&8&&(c.errorMessage=s[3]),t.$set(c),s[2]>0?a?(a.p(s,f),f&4&&m(a,1)):(a=pn(s),a.c(),m(a,1),a.m(l.parentNode,l)):a&&(te(),h(a,1,1,()=>{a=null}),re())},i(s){i||(m(e.$$.fragment,s),m(t.$$.fragment,s),m(a),i=!0)},o(s){h(e.$$.fragment,s),h(t.$$.fragment,s),h(a),i=!1},d(s){s&&(g(r),g(o),g(l)),w(e,s),w(t,s),a&&a.d(s)}}}function uu(n){let e,r,t,o,l,i;return e=new Ae({props:{label:"Critical Issues",$$slots:{default:[fu]},$$scope:{ctx:n}}}),t=new pe({props:{layer:de+"-points",tooltip:cu,show:n[0],clickable:!1}}),l=new pe({props:{layer:de+"-clusters",show:n[0],clickable:!0,ignoreHigherLayers:[de+"-counts"]}}),l.$on("click",n[5]),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),_(l.$$.fragment)},m(a,s){b(e,a,s),d(a,r,s),b(t,a,s),d(a,o,s),b(l,a,s),i=!0},p(a,[s]){const f={};s&527&&(f.$$scope={dirty:s,ctx:a}),e.$set(f);const u={};s&1&&(u.show=a[0]),t.$set(u);const c={};s&1&&(c.show=a[0]),l.$set(c)},i(a){i||(m(e.$$.fragment,a),m(t.$$.fragment,a),m(l.$$.fragment,a),i=!0)},o(a){h(e.$$.fragment,a),h(t.$$.fragment,a),h(l.$$.fragment,a),i=!1},d(a){a&&(g(r),g(o)),w(e,a),w(t,a),w(l,a)}}}let de="criticals",sr="red";function cu(n){let e='<div style="max-width: 30vw;">';return e+=`<h2>${n.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${n.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${n.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${n.properties.id}</b></p>`,e+=`<p>Submitted by <b>${n.properties.inspector??"???"}</b> at <b>${n.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${n.properties.scheme_reference}</b> in stage <b>${n.properties.current_design_stage}</b></p>`,e+="</div>",e}function pu(n,e,r){let t;J(n,me,p=>r(6,t=p));let o,l=!0,i=0,a="";to(t,de),t.addSource(de,{type:"geojson",data:fr(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),Ot(t,{id:`${de}-clusters`,source:de,filter:["has","point_count"],color:sr,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),t.addLayer({id:`${de}-counts`,source:de,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),Ot(t,{id:`${de}-points`,source:de,filter:["!",["has","point_count"]],color:sr,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function s(p){try{let $=await xs(o.files[0]);t.getSource(de).setData($),r(2,i=$.features.length),r(3,a="")}catch($){r(3,a=`The file you loaded is broken: ${$}`)}}function f(p){t.getSource(de).getClusterExpansionZoom(p.detail.properties.cluster_id,($,y)=>{$||t.easeTo({center:p.detail.geometry.coordinates,zoom:y})})}function u(p){q[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){l=p,r(0,l)}return n.$$.update=()=>{n.$$.dirty&65&&t.getLayer(`${de}-counts`)&&t.setLayoutProperty(`${de}-counts`,"visibility",l?"visible":"none")},[l,o,i,a,s,f,t,u,c]}class mu extends U{constructor(e){super(),G(this,e,pu,uu,z,{})}}function $u(n){let e,r,t;return e=new ve({props:{color:n[2]}}),{c(){_(e.$$.fragment),r=S(`
  Crossings`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function du(n){let e;return{c(){e=S("crossing")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function gu(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[du]},$$scope:{ctx:n}}}),i=new rt({}),{c(){e=N("p"),r=S("This shows "),_(t.$$.fragment),o=S(" data from OpenStreetMap (as of 9 August 2023)."),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function hu(n){let e,r,t;return r=new ae({props:{$$slots:{default:[gu]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function _u(n){let e,r,t,o,l;function i(s){n[3](s)}let a={id:Ye,$$slots:{right:[hu],default:[$u]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new pe({props:{layer:Ye,tooltip:n[1],show:n[0],clickable:!0}}),o.$on("click",bu),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=s[0]),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}const Ye="crossings";function bu(n){window.open(`http://openstreetmap.org/node/${n.detail.properties.osm_id}`,"_blank")}function wu(n,e,r){let t;J(n,me,f=>r(4,t=f));let o=!1;function l(f){const u=f.properties.crossing;return`<p>${i.get(u)??`Crossing with unknown type (${u})`}. Click for details.</p>`}const i=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);Be(t,Ye,`${ue()}/v1/${Ye}.pmtiles`);let a=Q[Ye];Ot(t,{id:Ye,source:Ye,sourceLayer:Ye,color:a,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function s(f){o=f,r(0,o)}return[o,l,a,s]}class vu extends U{constructor(e){super(),G(this,e,wu,_u,z,{})}}function yu(n){let e,r,t;return e=new ve({props:{color:n[1]}}),{c(){_(e.$$.fragment),r=S(`
  Cycle parking`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function ku(n){let e;return{c(){e=S("OpenStreetMap")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Su(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[ku]},$$scope:{ctx:n}}}),i=new rt({}),{c(){e=N("p"),r=S("Cycle parking, according to "),_(t.$$.fragment),o=S(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&16&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function Cu(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Su]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&16&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Lu(n){let e,r,t,o,l;function i(s){n[2](s)}let a={id:it,$$slots:{right:[Cu],default:[yu]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new pe({props:{layer:it,tooltip:Tu,show:n[0],clickable:!1}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&16&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&1&&(c.show=s[0]),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let it="cycle_parking";function Tu(n){return`<p>Capacity: ${n.properties.capacity??"unknown"}</p>`}function Ou(n,e,r){let t;J(n,me,a=>r(3,t=a));let o=Q.cycle_parking;Be(t,it,`${ue()}/v1/${it}.pmtiles`),Ot(t,{id:it,source:it,sourceLayer:it,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let l=!1;function i(a){l=a,r(0,l)}return[l,o,i]}class Au extends U{constructor(e){super(),G(this,e,Ou,Lu,z,{})}}function Iu(n){let e,r,t,o;return e=new ve({props:{color:n[4]}}),{c(){_(e.$$.fragment),r=T(),t=S(n[1])},m(l,i){b(e,l,i),d(l,r,i),d(l,t,i),o=!0},p(l,i){(!o||i&2)&&ie(t,l[1])},i(l){o||(m(e.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),o=!1},d(l){l&&(g(r),g(t)),w(e,l)}}}function Pu(n){let e;const r=n[7].default,t=Re(r,n,n[9],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&512)&&We(t,r,o,o[9],e?Ue(r,o[9],l,null):ze(o[9]),null)},i(o){e||(m(t,o),e=!0)},o(o){h(t,o),e=!1},d(o){t&&t.d(o)}}}function Mu(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Pu]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&512&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Eu(n){let e,r=n[5](n[10][0])+"",t;return{c(){e=N("p"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&1024&&r!==(r=o[5](o[10][0])+"")&&ie(t,r)},d(o){o&&g(e)}}}function Nu(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[Eu,({features:t})=>({10:t}),({features:t})=>t?1024:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&1536&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Du(n){let e,r;return e=new St({props:{id:n[0],sourceLayer:n[0],paint:{"fill-color":n[4],"fill-opacity":$t(.7,1)},layout:{visibility:n[3]},manageHoverState:!0,$$slots:{default:[Nu]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&1&&(l.id=t[0]),o&1&&(l.sourceLayer=t[0]),o&8&&(l.layout={visibility:t[3]}),o&512&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Fu(n){let e,r,t,o,l;function i(s){n[8](s)}let a={id:n[0],$$slots:{right:[Mu],default:[Iu]},$$scope:{ctx:n}};return n[2]!==void 0&&(a.checked=n[2]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new Mt({props:{url:`pmtiles://${ue()}/v1/${n[0]}.pmtiles`,$$slots:{default:[Du]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&1&&(u.id=s[0]),f&514&&(u.$$scope={dirty:f,ctx:s}),!r&&f&4&&(r=!0,u.checked=s[2],Y(()=>r=!1)),e.$set(u);const c={};f&1&&(c.url=`pmtiles://${ue()}/v1/${s[0]}.pmtiles`),f&521&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}function ju(n,e,r){let t,{$$slots:o={},$$scope:l}=e,{name:i}=e,{singularNoun:a}=e,{pluralNoun:s}=e,f=Q[i],u=!1;function c($){return $.properties.name??`Unnamed ${a}`}function p($){u=$,r(2,u)}return n.$$set=$=>{"name"in $&&r(0,i=$.name),"singularNoun"in $&&r(6,a=$.singularNoun),"pluralNoun"in $&&r(1,s=$.pluralNoun),"$$scope"in $&&r(9,l=$.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&r(3,t=u?"visible":"none")},[i,s,u,t,f,c,a,o,p,l]}class $r extends U{constructor(e){super(),G(this,e,ju,Fu,z,{name:0,singularNoun:6,pluralNoun:1})}}function Bu(n){let e;return{c(){e=S("hospital")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Hu(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[Bu]},$$scope:{ctx:n}}}),i=new rt({}),{c(){e=N("p"),r=S("This shows "),_(t.$$.fragment),o=S(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&1&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function Ru(n){let e,r;return e=new $r({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Hu]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,[o]){const l={};o&1&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}class Wu extends U{constructor(e){super(),G(this,e,null,Ru,z,{})}}function zu(n){let e,r,t;return e=new ve({props:{color:n[2]}}),{c(){_(e.$$.fragment),r=S(`
  Railway Stations`)},m(o,l){b(e,o,l),d(o,r,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){o&&g(r),w(e,o)}}}function Uu(n){let e;return{c(){e=S("railway station")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Gu(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[Uu]},$$scope:{ctx:n}}}),i=new rt({}),{c(){e=N("p"),r=S("This shows "),_(t.$$.fragment),o=S(" data from OpenStreetMap (as of 9 August 2023)."),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function Vu(n){let e,r,t;return r=new ae({props:{$$slots:{default:[Gu]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&32&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function qu(n){let e,r=mn(n[4][0])+"",t;return{c(){e=N("p"),t=S(r)},m(o,l){d(o,e,l),M(e,t)},p(o,l){l&16&&r!==(r=mn(o[4][0])+"")&&ie(t,r)},d(o){o&&g(e)}}}function Xu(n){let e,r;return e=new et({props:{openOn:"hover",$$slots:{default:[qu,({features:t})=>({4:t}),({features:t})=>t?16:0]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&48&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Ku(n){let e,r;return e=new Mo({props:{id:ir,paint:{"circle-color":n[2],"circle-radius":fo/2},layout:{visibility:n[1]},$$slots:{default:[Xu]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Zu(n){let e,r,t,o,l;function i(s){n[3](s)}let a={id:ir,$$slots:{right:[Vu],default:[zu]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.checked=n[0]),e=new se({props:a}),q.push(()=>Z(e,"checked",i)),o=new pr({props:{data:`${ue()}/v1/${ir}.geojson`,$$slots:{default:[Ku]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),!r&&f&1&&(r=!0,u.checked=s[0],Y(()=>r=!1)),e.$set(u);const c={};f&34&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),w(e,s),w(o,s)}}}let ir="railway_stations";function mn(n){return n.properties.name??"Unnamed railway station"}function Yu(n,e,r){let t,o=Q.railway_stations,l=!1;function i(a){l=a,r(0,l)}return n.$$.update=()=>{n.$$.dirty&1&&r(1,t=l?"visible":"none")},[l,t,o,i]}class Ju extends U{constructor(e){super(),G(this,e,Yu,Zu,z,{})}}function Qu(n){let e;return{c(){e=S("primary and secondary schools")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function xu(n){let e,r,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Qu]},$$scope:{ctx:n}}}),i=new rt({}),{c(){e=N("p"),r=S("This shows "),_(t.$$.fragment),o=S(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),l=T(),_(i.$$.fragment)},m(s,f){d(s,e,f),M(e,r),b(t,e,null),M(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&1&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){h(t.$$.fragment,s),h(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),w(t),w(i,s)}}}function ec(n){let e,r;return e=new $r({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[xu]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,[o]){const l={};o&1&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}class tc extends U{constructor(e){super(),G(this,e,null,ec,z,{})}}function rc(n){let e;return{c(){e=S("sports pitches")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function nc(n){let e;return{c(){e=S("sports centres")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function oc(n){let e,r,t,o,l,i,a,s,f;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[rc]},$$scope:{ctx:n}}}),l=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[nc]},$$scope:{ctx:n}}}),s=new rt({}),{c(){e=N("p"),r=S("This shows "),_(t.$$.fragment),o=S(" and "),_(l.$$.fragment),i=S(" data from OpenStreetMap (as of 9 August 2023)."),a=T(),_(s.$$.fragment)},m(u,c){d(u,e,c),M(e,r),b(t,e,null),M(e,o),b(l,e,null),M(e,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),t.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){f||(m(t.$$.fragment,u),m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){h(t.$$.fragment,u),h(l.$$.fragment,u),h(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(a)),w(t),w(l),w(s,u)}}}function lc(n){let e,r;return e=new $r({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[oc]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,[o]){const l={};o&1&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}class sc extends U{constructor(e){super(),G(this,e,null,lc,z,{})}}function ic(n){let e;return{c(){e=S("Vehicle counts")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function ac(n){let e;return{c(){e=S(`DfT road statistics
        `)},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function fc(n){let e;return{c(){e=S("methodology")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function uc(n){let e,r,t,o,l,i,a,s,f,u,c;return t=new X({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[ac]},$$scope:{ctx:n}}}),l=new X({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[fc]},$$scope:{ctx:n}}}),u=new Ge({}),{c(){e=N("p"),r=S("2022 AADF (annual average daily flow) data from "),_(t.$$.fragment),o=S(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(l.$$.fragment),i=S(" for details and caveats about the measurements."),a=T(),s=N("p"),s.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=T(),_(u.$$.fragment)},m(p,$){d(p,e,$),M(e,r),b(t,e,null),M(e,o),b(l,e,null),M(e,i),d(p,a,$),d(p,s,$),d(p,f,$),b(u,p,$),c=!0},p(p,$){const y={};$&64&&(y.$$scope={dirty:$,ctx:p}),t.$set(y);const k={};$&64&&(k.$$scope={dirty:$,ctx:p}),l.$set(k)},i(p){c||(m(t.$$.fragment,p),m(l.$$.fragment,p),m(u.$$.fragment,p),c=!0)},o(p){h(t.$$.fragment,p),h(l.$$.fragment,p),h(u.$$.fragment,p),c=!1},d(p){p&&(g(e),g(a),g(s),g(f)),w(t),w(l),w(u,p)}}}function cc(n){let e,r,t;return r=new ae({props:{$$slots:{default:[uc]},$$scope:{ctx:n}}}),{c(){e=N("span"),_(r.$$.fragment),K(e,"slot","right")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function $n(n){let e,r;return e=new tt({props:{colorScale:n[1],limits:n[2]}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p:x,i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function pc(n){let e,r,t,o,l,i;function a(u){n[3](u)}let s={id:at,$$slots:{right:[cc],default:[ic]},$$scope:{ctx:n}};n[0]!==void 0&&(s.checked=n[0]),e=new se({props:s}),q.push(()=>Z(e,"checked",a));let f=n[0]&&$n(n);return l=new pe({props:{layer:at,tooltip:mc,show:n[0],clickable:!0}}),l.$on("click",$c),{c(){_(e.$$.fragment),t=T(),f&&f.c(),o=T(),_(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!r&&c&1&&(r=!0,p.checked=u[0],Y(()=>r=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=$n(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(te(),h(f,1,1,()=>{f=null}),re());const $={};c&1&&($.show=u[0]),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){h(e.$$.fragment,u),h(f),h(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),w(e,u),f&&f.d(u),w(l,u)}}}let at="vehicle_counts";function mc(n){let e=`<h2>${n.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${n.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${n.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${n.properties.method}</b></p>`,e}function $c(n){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${n.detail.properties.count_point}`,"_blank")}function dc(n,e,r){let t;J(n,me,f=>r(4,t=f));let o=Q.sequential_low_to_high,l=[0,4e4,8e4,12e4,16e4,205e3],i=["","40k","80k","120k","160k",""];Be(t,at,`${ue()}/v1/${at}.pmtiles`),Ot(t,{id:at,source:at,sourceLayer:at,color:Qe(["get","motor_vehicles_2022"],l,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let a=!1;function s(f){a=f,r(0,a)}return[a,o,i,s]}class gc extends U{constructor(e){super(),G(this,e,dc,pc,z,{})}}function hc(n){let e,r,t,o,l,i,a,s;return e=new tc({}),t=new Wu({}),l=new sc({}),a=new Ju({}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),_(l.$$.fragment),i=T(),_(a.$$.fragment)},m(f,u){b(e,f,u),d(f,r,u),b(t,f,u),d(f,o,u),b(l,f,u),d(f,i,u),b(a,f,u),s=!0},i(f){s||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(l.$$.fragment,f),m(a.$$.fragment,f),s=!0)},o(f){h(e.$$.fragment,f),h(t.$$.fragment,f),h(l.$$.fragment,f),h(a.$$.fragment,f),s=!1},d(f){f&&(g(r),g(o),g(i)),w(e,f),w(t,f),w(l,f),w(a,f)}}}function _c(n){let e,r;return e=new Pt({props:{small:!0,$$slots:{default:[hc]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function bc(n){let e,r,t,o,l,i,a,s,f,u;return e=new Lf({}),t=new Nf({}),l=new df({}),a=new Au({}),f=new vu({}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),_(l.$$.fragment),i=T(),_(a.$$.fragment),s=T(),_(f.$$.fragment)},m(c,p){b(e,c,p),d(c,r,p),b(t,c,p),d(c,o,p),b(l,c,p),d(c,i,p),b(a,c,p),d(c,s,p),b(f,c,p),u=!0},i(c){u||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(l.$$.fragment,c),m(a.$$.fragment,c),m(f.$$.fragment,c),u=!0)},o(c){h(e.$$.fragment,c),h(t.$$.fragment,c),h(l.$$.fragment,c),h(a.$$.fragment,c),h(f.$$.fragment,c),u=!1},d(c){c&&(g(r),g(o),g(i),g(s)),w(e,c),w(t,c),w(l,c),w(a,c),w(f,c)}}}function wc(n){let e,r;return e=new Pt({props:{small:!0,$$slots:{default:[bc]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function vc(n){let e,r,t,o,l,i,a,s,f,u;return e=new Xa({}),t=new of({}),l=new ra({}),a=new ya({}),f=new Fa({}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),_(l.$$.fragment),i=T(),_(a.$$.fragment),s=T(),_(f.$$.fragment)},m(c,p){b(e,c,p),d(c,r,p),b(t,c,p),d(c,o,p),b(l,c,p),d(c,i,p),b(a,c,p),d(c,s,p),b(f,c,p),u=!0},i(c){u||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(l.$$.fragment,c),m(a.$$.fragment,c),m(f.$$.fragment,c),u=!0)},o(c){h(e.$$.fragment,c),h(t.$$.fragment,c),h(l.$$.fragment,c),h(a.$$.fragment,c),h(f.$$.fragment,c),u=!1},d(c){c&&(g(r),g(o),g(i),g(s)),w(e,c),w(t,c),w(l,c),w(a,c),w(f,c)}}}function yc(n){let e,r;return e=new Pt({props:{small:!0,$$slots:{default:[vc]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function kc(n){let e,r,t,o;return e=new Vi({}),t=new ca({}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function Sc(n){let e,r,t,o;return e=new lu({}),t=new Jf({}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment)},m(l,i){b(e,l,i),d(l,r,i),b(t,l,i),o=!0},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){h(e.$$.fragment,l),h(t.$$.fragment,l),o=!1},d(l){l&&g(r),w(e,l),w(t,l)}}}function Cc(n){let e,r,t,o,l=ar()=="Private (development)",i,a;e=new gc({}),t=new zf({});let s=l&&Sc();return{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),s&&s.c(),i=ge()},m(f,u){b(e,f,u),d(f,r,u),b(t,f,u),d(f,o,u),s&&s.m(f,u),d(f,i,u),a=!0},p:x,i(f){a||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(s),a=!0)},o(f){h(e.$$.fragment,f),h(t.$$.fragment,f),h(s),a=!1},d(f){f&&(g(r),g(o),g(i)),w(e,f),w(t,f),s&&s.d(f)}}}function Lc(n){let e,r,t,o,l;function i(s){n[4](s)}let a={displayEnableButton:!0};return n[1]!==void 0&&(a.isInactive=n[1]),e=new co({props:a}),n[3](e),q.push(()=>Z(e,"isInactive",i)),o=new wi({}),{c(){_(e.$$.fragment),t=T(),_(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,f){const u={};!r&&f&2&&(r=!0,u.isInactive=s[1],Y(()=>r=!1)),e.$set(u)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){h(e.$$.fragment,s),h(o.$$.fragment,s),l=!1},d(s){s&&g(t),n[3](null),w(e,s),w(o,s)}}}function Tc(n){let e,r,t,o,l,i,a,s,f,u,c,p,$,y,k,C;return e=new mu({}),t=new Ae({props:{label:"Trip generators",$$slots:{default:[_c]},$$scope:{ctx:n}}}),l=new Ae({props:{label:"Existing infrastructure",$$slots:{default:[wc]},$$scope:{ctx:n}}}),a=new Ae({props:{label:"Boundaries",$$slots:{default:[yc]},$$scope:{ctx:n}}}),f=new Ae({props:{label:"Census",$$slots:{default:[kc]},$$scope:{ctx:n}}}),c=new Ae({props:{label:"Other",$$slots:{default:[Cc]},$$scope:{ctx:n}}}),$=new Ae({props:{label:"Tools",$$slots:{default:[Lc]},$$scope:{ctx:n}}}),k=new uo({props:{disabled:!n[1]}}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),_(l.$$.fragment),i=T(),_(a.$$.fragment),s=T(),_(f.$$.fragment),u=T(),_(c.$$.fragment),p=T(),_($.$$.fragment),y=T(),_(k.$$.fragment)},m(v,A){b(e,v,A),d(v,r,A),b(t,v,A),d(v,o,A),b(l,v,A),d(v,i,A),b(a,v,A),d(v,s,A),b(f,v,A),d(v,u,A),b(c,v,A),d(v,p,A),b($,v,A),d(v,y,A),b(k,v,A),C=!0},p(v,A){const F={};A&32&&(F.$$scope={dirty:A,ctx:v}),t.$set(F);const O={};A&32&&(O.$$scope={dirty:A,ctx:v}),l.$set(O);const E={};A&32&&(E.$$scope={dirty:A,ctx:v}),a.$set(E);const H={};A&32&&(H.$$scope={dirty:A,ctx:v}),f.$set(H);const I={};A&32&&(I.$$scope={dirty:A,ctx:v}),c.$set(I);const P={};A&35&&(P.$$scope={dirty:A,ctx:v}),$.$set(P);const D={};A&2&&(D.disabled=!v[1]),k.$set(D)},i(v){C||(m(e.$$.fragment,v),m(t.$$.fragment,v),m(l.$$.fragment,v),m(a.$$.fragment,v),m(f.$$.fragment,v),m(c.$$.fragment,v),m($.$$.fragment,v),m(k.$$.fragment,v),C=!0)},o(v){h(e.$$.fragment,v),h(t.$$.fragment,v),h(l.$$.fragment,v),h(a.$$.fragment,v),h(f.$$.fragment,v),h(c.$$.fragment,v),h($.$$.fragment,v),h(k.$$.fragment,v),C=!1},d(v){v&&(g(r),g(o),g(i),g(s),g(u),g(p),g(y)),w(e,v),w(t,v),w(l,v),w(a,v),w(f,v),w(c,v),w($,v),w(k,v)}}}function Oc(n){let e,r,t,o;return e=new Ae({props:{label:"Layers",open:!0,$$slots:{default:[Tc]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(l,i){b(e,l,i),r=!0,t||(o=wt(window,"keydown",n[2]),t=!0)},p(l,[i]){const a={};i&35&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){r||(m(e.$$.fragment,l),r=!0)},o(l){h(e.$$.fragment,l),r=!1},d(l){w(e,l),t=!1,o()}}}function Ac(n,e,r){let t;J(n,hr,s=>r(1,t=s));let o;function l(s){!t&&s.key=="Escape"&&(o.disableStreetView(),s.preventDefault())}function i(s){q[s?"unshift":"push"](()=>{o=s,r(0,o)})}function a(s){t=s,hr.set(t)}return[o,t,l,i,a]}class Ic extends U{constructor(e){super(),G(this,e,Ac,Oc,z,{})}}function Pc(n,e,r){let{loadFile:t}=e;return yt(async()=>{let l=await(await fetch(`${ur()}/v1/random_schemes.geojson`)).text();t(l)}),n.$$set=o=>{"loadFile"in o&&r(0,t=o.loadFile)},[t]}class Mc extends U{constructor(e){super(),G(this,e,Pc,null,z,{loadFile:0})}}function Ec(n){let e;return{c(){e=S("Show on map")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Nc(n){let e;return{c(){e=S("Edit scheme locally")},m(r,t){d(r,e,t)},d(r){r&&g(e)}}}function Dc(n){let e,r,t=n[0].authority_or_region+"",o,l,i,a,s=n[0].capital_scheme_id+"",f,u,c,p,$=n[0].funding_programme+"",y,k,C,v,A,F,O;return v=new Tt({props:{$$slots:{default:[Ec]},$$scope:{ctx:n}}}),v.$on("click",n[3]),F=new Tt({props:{disabled:n[1],title:n[2],$$slots:{default:[Nc]},$$scope:{ctx:n}}}),F.$on("click",n[4]),{c(){e=N("p"),r=S("Authority or region: "),o=S(t),l=T(),i=N("p"),a=S("Capital scheme ID: "),f=S(s),u=T(),c=N("p"),p=S("Funding programme: "),y=S($),k=T(),C=N("div"),_(v.$$.fragment),A=T(),_(F.$$.fragment),K(C,"class","govuk-button-group")},m(E,H){d(E,e,H),M(e,r),M(e,o),d(E,l,H),d(E,i,H),M(i,a),M(i,f),d(E,u,H),d(E,c,H),M(c,p),M(c,y),d(E,k,H),d(E,C,H),b(v,C,null),M(C,A),b(F,C,null),O=!0},p(E,H){(!O||H&1)&&t!==(t=E[0].authority_or_region+"")&&ie(o,t),(!O||H&1)&&s!==(s=E[0].capital_scheme_id+"")&&ie(f,s),(!O||H&1)&&$!==($=E[0].funding_programme+"")&&ie(y,$);const I={};H&256&&(I.$$scope={dirty:H,ctx:E}),v.$set(I);const P={};H&256&&(P.$$scope={dirty:H,ctx:E}),F.$set(P)},i(E){O||(m(v.$$.fragment,E),m(F.$$.fragment,E),O=!0)},o(E){h(v.$$.fragment,E),h(F.$$.fragment,E),O=!1},d(E){E&&(g(e),g(l),g(i),g(u),g(c),g(k),g(C)),w(v),w(F)}}}function Fc(n){let e,r;return e=new Ae({props:{label:`${n[0].scheme_reference}: ${n[0].num_features} features`,$$slots:{default:[Dc]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,[o]){const l={};o&1&&(l.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),o&257&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function jc(n,e,r){let t,o;J(n,gt,c=>r(6,t=c)),J(n,me,c=>r(7,o=c));let{scheme:l}=e,{authorityNames:i}=e,a=!i.has(l.authority_or_region),s=a?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==l.scheme_reference)};o==null||o.fitBounds(ro(c),{padding:20,animate:!1})}function u(){let c={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==l.scheme_reference)},p=l.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${l.authority_or_region}`,"_blank")}return n.$$set=c=>{"scheme"in c&&r(0,l=c.scheme),"authorityNames"in c&&r(5,i=c.authorityNames)},[l,a,s,f,u,i]}class Bc extends U{constructor(e){super(),G(this,e,jc,Fc,z,{scheme:0,authorityNames:5})}}const Hc=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];function dn(n,e,r){const t=n.slice();return t[13]=e[r],t}function Rc(n){let e,r;return e=new Mc({props:{loadFile:n[7]}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p:x,i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function gn(n){let e,r,t,o;function l(s){n[9](s)}function i(s){n[10](s)}let a={schemes:n[1]};return n[2]!==void 0&&(a.schemesToBeShown=n[2]),n[3]!==void 0&&(a.filterText=n[3]),e=new ui({props:a}),q.push(()=>Z(e,"schemesToBeShown",l)),q.push(()=>Z(e,"filterText",i)),{c(){_(e.$$.fragment)},m(s,f){b(e,s,f),o=!0},p(s,f){const u={};f&2&&(u.schemes=s[1]),!r&&f&4&&(r=!0,u.schemesToBeShown=s[2],Y(()=>r=!1)),!t&&f&8&&(t=!0,u.filterText=s[3],Y(()=>t=!1)),e.$set(u)},i(s){o||(m(e.$$.fragment,s),o=!0)},o(s){h(e.$$.fragment,s),o=!1},d(s){w(e,s)}}}function hn(n){let e,r;return e=new Bc({props:{scheme:n[13],authorityNames:n[6]}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,o){const l={};o&2&&(l.scheme=t[13]),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function _n(n){let e=n[2].has(n[13].scheme_reference),r,t,o=e&&hn(n);return{c(){o&&o.c(),r=ge()},m(l,i){o&&o.m(l,i),d(l,r,i),t=!0},p(l,i){i&6&&(e=l[2].has(l[13].scheme_reference)),e?o?(o.p(l,i),i&6&&m(o,1)):(o=hn(l),o.c(),m(o,1),o.m(r.parentNode,r)):o&&(te(),h(o,1,1,()=>{o=null}),re())},i(l){t||(m(o),t=!0)},o(l){h(o),t=!1},d(l){l&&g(r),o&&o.d(l)}}}function Wc(n){let e,r,t,o,l,i,a,s,f,u,c=ar()=="Private (development)",p,$,y,k,C,v,A,F;l=new ho({props:{boundaryGeojson:n[5]}}),a=new Jo({}),f=new no({});let O=c&&Rc(n);$=new bo({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:n[7]}}),k=new kn({props:{errorMessage:n[0]}});let E=n[1].size>0&&gn(n),H=Fe(n[1].values()),I=[];for(let D=0;D<H.length;D+=1)I[D]=_n(dn(n,H,D));const P=D=>h(I[D],1,1,()=>{I[D]=null});return{c(){e=N("div"),r=N("div"),t=N("h1"),t.textContent="Browse schemes",o=T(),_(l.$$.fragment),i=T(),_(a.$$.fragment),s=T(),_(f.$$.fragment),u=T(),O&&O.c(),p=T(),_($.$$.fragment),y=T(),_(k.$$.fragment),C=T(),E&&E.c(),v=T(),A=N("ul");for(let D=0;D<I.length;D+=1)I[D].c();He(r,"display","flex"),He(r,"justify-content","space-between"),K(e,"slot","sidebar"),K(e,"class","govuk-prose")},m(D,L){d(D,e,L),M(e,r),M(r,t),M(r,o),b(l,r,null),M(e,i),b(a,e,null),M(e,s),b(f,e,null),M(e,u),O&&O.m(e,null),M(e,p),b($,e,null),M(e,y),b(k,e,null),M(e,C),E&&E.m(e,null),M(e,v),M(e,A);for(let B=0;B<I.length;B+=1)I[B]&&I[B].m(A,null);F=!0},p(D,L){const B={};L&32&&(B.boundaryGeojson=D[5]),l.$set(B),c&&O.p(D,L);const W={};if(L&1&&(W.errorMessage=D[0]),k.$set(W),D[1].size>0?E?(E.p(D,L),L&2&&m(E,1)):(E=gn(D),E.c(),m(E,1),E.m(e,v)):E&&(te(),h(E,1,1,()=>{E=null}),re()),L&70){H=Fe(D[1].values());let V;for(V=0;V<H.length;V+=1){const oe=dn(D,H,V);I[V]?(I[V].p(oe,L),m(I[V],1)):(I[V]=_n(oe),I[V].c(),m(I[V],1),I[V].m(A,null))}for(te(),V=H.length;V<I.length;V+=1)P(V);re()}},i(D){if(!F){m(l.$$.fragment,D),m(a.$$.fragment,D),m(f.$$.fragment,D),m(O),m($.$$.fragment,D),m(k.$$.fragment,D),m(E);for(let L=0;L<H.length;L+=1)m(I[L]);F=!0}},o(D){h(l.$$.fragment,D),h(a.$$.fragment,D),h(f.$$.fragment,D),h(O),h($.$$.fragment,D),h(k.$$.fragment,D),h(E),I=I.filter(Boolean);for(let L=0;L<I.length;L+=1)h(I[L]);F=!1},d(D){D&&g(e),w(l),w(a),w(f),O&&O.d(),w($),w(k),E&&E.d(),Bt(I,D)}}}function zc(n){let e,r,t,o,l,i,a,s,f,u,c;return e=new _o({props:{colorInterventions:Cn("v1")}}),t=new pe({props:{layer:"interventions-points",tooltip:n[8],clickable:!1}}),l=new pe({props:{layer:"interventions-lines",tooltip:n[8],clickable:!1}}),a=new pe({props:{layer:"interventions-polygons",tooltip:n[8],clickable:!1}}),u=new Ic({}),{c(){_(e.$$.fragment),r=T(),_(t.$$.fragment),o=T(),_(l.$$.fragment),i=T(),_(a.$$.fragment),s=T(),f=N("div"),_(u.$$.fragment),K(f,"class","top-right svelte-u44ed2")},m(p,$){b(e,p,$),d(p,r,$),b(t,p,$),d(p,o,$),b(l,p,$),d(p,i,$),b(a,p,$),d(p,s,$),d(p,f,$),b(u,f,null),c=!0},p:x,i(p){c||(m(e.$$.fragment,p),m(t.$$.fragment,p),m(l.$$.fragment,p),m(a.$$.fragment,p),m(u.$$.fragment,p),c=!0)},o(p){h(e.$$.fragment,p),h(t.$$.fragment,p),h(l.$$.fragment,p),h(a.$$.fragment,p),h(u.$$.fragment,p),c=!1},d(p){p&&(g(r),g(o),g(i),g(s),g(f)),w(e,p),w(t,p),w(l,p),w(a,p),w(u)}}}function Uc(n){let e,r,t;return r=new mo({props:{style:n[4],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[zc]},$$scope:{ctx:n}}}),{c(){e=N("div"),_(r.$$.fragment),K(e,"slot","main")},m(o,l){d(o,e,l),b(r,e,null),t=!0},p(o,l){const i={};l&16&&(i.style=o[4]),l&65536&&(i.$$scope={dirty:l,ctx:o}),r.$set(i)},i(o){t||(m(r.$$.fragment,o),t=!0)},o(o){h(r.$$.fragment,o),t=!1},d(o){o&&g(e),w(r)}}}function Gc(n){let e,r;return e=new po({props:{$$slots:{main:[Uc],sidebar:[Wc]},$$scope:{ctx:n}}}),{c(){_(e.$$.fragment)},m(t,o){b(e,t,o),r=!0},p(t,[o]){const l={};o&65599&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){w(e,t)}}}function Vc(n,e,r){let t,o;J(n,_r,C=>r(4,t=C)),J(n,gt,C=>r(5,o=C));let l=new Set(Hc);yt(()=>{oo()});const i=new URLSearchParams(window.location.search);_r.set(i.get("style")||"dataviz");let a="",s=new Map,f=new Set,u="";vt(()=>{gt.set(fr())});function c(C){try{let v=JSON.parse(C);r(1,s=Qs(v)),gt.set(v),r(0,a="")}catch(v){r(0,a=`The file you loaded is broken: ${v}`)}}function p(C){let v=C.properties;var A='<div style="max-width: 30vw;">';return A+=`<h2>${$(v.name)} (${v.intervention_type})</h2>`,A+=`<p>Scheme reference: ${v.scheme_reference}</p>`,v.length_meters&&(A+=`<p>Length: ${lo(v.length_meters)}</p>`),v.description&&(A+=`<p>${$(v.description)}</p>`),A+="</div>",A}function $(C){return u?C.replace(new RegExp(u,"gi"),v=>`<mark>${v}</mark>`):C}function y(C){f=C,r(2,f)}function k(C){u=C,r(3,u)}return[a,s,f,u,t,o,l,c,p,y,k]}class qc extends U{constructor(e){super(),G(this,e,Vc,Gc,z,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new qc({target:document.getElementById("app")});
