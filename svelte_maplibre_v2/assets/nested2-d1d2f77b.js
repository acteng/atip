import{S as Z,i as K,s as x,a5 as Qe,j as h,t as $,y as me,n as g,o as he,p as d,H as io,Q as V,a8 as qt,aS as Et,x as ne,aK as Ct,aL as Lt,aM as Tt,aN as Ot,b as G,c as X,g as b,m as w,l as Y,q as y,aT as Me,aU as lo,aV as ao,r as Bt,aW as ot,e as N,u as v,d as D,k as I,f as _r,aq as fo,C as ue,ar as vn,W as kt,F as kn,a as lr,h as ee,v as Cr,w as br,I as Pe,aX as ke,aY as $e,$ as Ne,G as De,aR as H,J as st,N as Je,K as Vt,V as _t,aZ as it,a_ as uo,a1 as Sn,a0 as St,E as Cn,U as Ln,R as Tn,a$ as wr,b0 as Lr,D as co,L as po,z as mo,aH as ho}from"./index-73f03f95.js";import{H as ce,L as $o,d as Tr,c as On,C as Ee,B as go,Z as _o,I as bo}from"./schemas-4bcfaebb.js";import{g as Xt,u as wo,f as yo,m as vo,e as Gt,C as Ye,b as jt,d as ae,a as ko,S as So,L as Co,M as Lo}from"./StreetViewController-2cbb0f4e.js";import{I as ie,F as To}from"./InteractiveLayer-e40bdd0d.js";function Or(r){let e;return t=>{if(t)for(let n in t){let o=e==null?void 0:e[n],s=t[n];o!==s&&r(n,s,o)}else if(e)for(let n in e)r(n,void 0,e[n]);e=t}}function Oo(r,...e){let t=[r];for(let n of e)if(n)Array.isArray(n)&&n[0]===r?t.push(...n.slice(1)):t.push(n);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Ao(r){return r===!0?["has","point_count"]:r===!1?["!",["has","point_count"]]:void 0}function Do(r,e){return["case",["boolean",["feature-state","hover"],!1],e,r]}var ar=Eo;function Eo(r){var e,t,n;if(r){if(Array.isArray(r)){for(e=[],t=r.length,n=0;n<t;n++){var o=r[n];o!=null&&e.push(o)}return e}if(typeof r=="object"){e={};var s=Object.keys(r);for(t=s.length,n=0;n<t;n++){var l=s[n],a=r[l];a!=null&&(e[l]=a)}return e}}}function Ar(r){let e=r[0],t,n,o=Dr(r);return{c(){o.c(),t=Qe()},m(s,l){o.m(s,l),h(s,t,l),n=!0},p(s,l){l[0]&1&&x(e,e=s[0])?(me(),g(o,1,1,ne),he(),o=Dr(s),o.c(),$(o,1),o.m(t.parentNode,t)):o.p(s,l)},i(s){n||($(o),n=!0)},o(s){g(o),n=!1},d(s){s&&d(t),o.d(s)}}}function Dr(r){let e;const t=r[35].default,n=Ct(t,r,r[34],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s[1]&8)&&Lt(n,t,o,o[34],e?Ot(t,o[34],s,null):Tt(o[34]),null)},i(o){e||($(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Io(r){let e,t,n=r[0]&&Ar(r);return{c(){n&&n.c(),e=Qe()},m(o,s){n&&n.m(o,s),h(o,e,s),t=!0},p(o,s){o[0]?n?(n.p(o,s),s[0]&1&&$(n,1)):(n=Ar(o),n.c(),$(n,1),n.m(e.parentNode,e)):n&&(me(),g(n,1,1,()=>{n=null}),he())},i(o){t||($(n),t=!0)},o(o){g(n),t=!1},d(o){o&&d(e),n&&n.d(o)}}}function Mo(r,e,t){let n,o,s,l,a,i,u,f,c,p,m,_,{$$slots:k={},$$scope:C}=e,{id:L=Xt("layer")}=e,{source:E=void 0}=e,{sourceLayer:B=void 0}=e,{beforeId:S=void 0}=e,{beforeLayerType:A=void 0}=e,{type:j}=e,{paint:M=void 0}=e,{layout:P=void 0}=e,{filter:T=void 0}=e,{applyToClusters:O=void 0}=e,{minzoom:U=void 0}=e,{maxzoom:z=void 0}=e,{manageHoverState:W=!0}=e,{hovered:te=null}=e,{hoverCursor:pe=void 0}=e,{eventsIfTopMost:J=!1}=e;const le=io(),{map:se,source:ge,self:_e,minzoom:Ie,maxzoom:de,eventTopMost:Ce}=wo();V(r,se,R=>t(30,c=R)),V(r,ge,R=>t(31,p=R)),V(r,_e,R=>t(0,f=R)),V(r,Ie,R=>t(33,_=R)),V(r,de,R=>t(32,m=R)),qt(()=>{f&&c&&(c==null||c.removeLayer(f))});let fe;return r.$$set=R=>{"id"in R&&t(7,L=R.id),"source"in R&&t(8,E=R.source),"sourceLayer"in R&&t(9,B=R.sourceLayer),"beforeId"in R&&t(10,S=R.beforeId),"beforeLayerType"in R&&t(11,A=R.beforeLayerType),"type"in R&&t(12,j=R.type),"paint"in R&&t(13,M=R.paint),"layout"in R&&t(14,P=R.layout),"filter"in R&&t(15,T=R.filter),"applyToClusters"in R&&t(16,O=R.applyToClusters),"minzoom"in R&&t(17,U=R.minzoom),"maxzoom"in R&&t(18,z=R.maxzoom),"manageHoverState"in R&&t(19,W=R.manageHoverState),"hovered"in R&&t(6,te=R.hovered),"hoverCursor"in R&&t(20,pe=R.hoverCursor),"eventsIfTopMost"in R&&t(21,J=R.eventsIfTopMost),"$$scope"in R&&t(34,C=R.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&65536&&t(29,n=Ao(O)),r.$$.dirty[0]&536903680&&t(28,o=Oo("all",n,T)),r.$$.dirty[0]&131072|r.$$.dirty[1]&4&&t(24,s=U??_),r.$$.dirty[0]&262144|r.$$.dirty[1]&2&&t(23,l=z??m),r.$$.dirty[0]&256|r.$$.dirty[1]&1&&t(27,a=E||p),r.$$.dirty[0]&1509457537&&c&&f!==L&&a){let R=function(re){var Fe,Be;if(!f||!c||J&&Ce(re)!==f)return;let F=re.features??[],Se=(Be=(Fe=F[0])==null?void 0:Fe.properties)==null?void 0:Be.cluster_id,we={event:re,map:c,clusterId:Se,layer:f,source:a,features:F};le(re.type,we)},be=S;if(!S&&A){let re=c.getStyle().layers,F=typeof A=="function"?A:we=>we.type===A,Se=re==null?void 0:re.find(F);Se&&(be=Se.id)}Et(_e,f=L,f),c.addLayer(ar({id:f,type:j,source:a,"source-layer":B,filter:o,paint:M,layout:P,minzoom:s,maxzoom:l}),be),c.on("click",f,R),c.on("dblclick",f,R),c.on("contextmenu",f,R),c.on("mouseenter",f,re=>{var Fe,Be;if(!f||!c||J&&Ce(re)!==f)return;pe&&(c.getCanvas().style.cursor=pe);let F=re.features??[];t(6,te=F[0]??null);let Se=(Be=(Fe=F[0])==null?void 0:Fe.properties)==null?void 0:Be.cluster_id;le("mouseenter",{event:re,map:c,clusterId:Se,layer:f,source:a,features:F})}),c.on("mousemove",f,re=>{var Fe,Be,Sr;if(J&&Ce(re)!==f)return;let F=re.features??[],Se=(Be=(Fe=F[0])==null?void 0:Fe.properties)==null?void 0:Be.cluster_id,we=(Sr=F[0])==null?void 0:Sr.id;we!==fe&&(W&&(fe!==void 0&&(c==null||c.setFeatureState({source:a,id:fe},{hover:!1})),c==null||c.setFeatureState({source:a,id:we},{hover:!0})),t(22,fe=we),t(6,te=F[0]??null)),le("mousemove",{event:re,map:c,clusterId:Se,layer:f,source:a,features:F})}),c.on("mouseleave",f,re=>{!f||!c||(pe&&(c.getCanvas().style.cursor=""),t(6,te=null),W&&fe!==void 0&&(c==null||c.setFeatureState({source:a,id:fe},{hover:!1}),t(22,fe=void 0)),le("mouseleave",{map:c,layer:f,source:a}))})}r.$$.dirty[0]&1073741825&&t(26,i=f?Or((R,be)=>c==null?void 0:c.setPaintProperty(f,R,be)):void 0),r.$$.dirty[0]&1073741825&&t(25,u=f?Or((R,be)=>c==null?void 0:c.setLayoutProperty(f,R,be)):void 0),r.$$.dirty[0]&67117056&&(i==null||i(M)),r.$$.dirty[0]&33570816&&(u==null||u(P)),r.$$.dirty[0]&1098907649&&f&&(c==null||c.setLayerZoomRange(f,s,l))},[f,se,ge,_e,Ie,de,te,L,E,B,S,A,j,M,P,T,O,U,z,W,pe,J,fe,l,s,u,i,a,o,n,c,p,m,_,C,k]}class An extends Z{constructor(e){super(),K(this,e,Mo,Io,x,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,hoverCursor:20,eventsIfTopMost:21},null,[-1,-1])}}function Po(r){let e;const t=r[13].default,n=Ct(t,r,r[21],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&2097152)&&Lt(n,t,o,o[21],e?Ot(t,o[21],s,null):Tt(o[21]),null)},i(o){e||($(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function No(r){let e,t,n;function o(l){r[14](l)}let s={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],eventsIfTopMost:r[12],$$slots:{default:[Po]},$$scope:{ctx:r}};return r[0]!==void 0&&(s.hovered=r[0]),e=new An({props:s}),G.push(()=>X(e,"hovered",o)),e.$on("click",r[15]),e.$on("dblclick",r[16]),e.$on("contextmenu",r[17]),e.$on("mouseenter",r[18]),e.$on("mousemove",r[19]),e.$on("mouseleave",r[20]),{c(){b(e.$$.fragment)},m(l,a){w(e,l,a),n=!0},p(l,[a]){const i={};a&2&&(i.id=l[1]),a&4&&(i.source=l[2]),a&8&&(i.sourceLayer=l[3]),a&16&&(i.beforeId=l[4]),a&32&&(i.beforeLayerType=l[5]),a&64&&(i.paint=l[6]),a&128&&(i.layout=l[7]),a&256&&(i.filter=l[8]),a&512&&(i.minzoom=l[9]),a&1024&&(i.maxzoom=l[10]),a&2048&&(i.hoverCursor=l[11]),a&4096&&(i.eventsIfTopMost=l[12]),a&2097152&&(i.$$scope={dirty:a,ctx:l}),!t&&a&1&&(t=!0,i.hovered=l[0],Y(()=>t=!1)),e.$set(i)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){y(e,l)}}}function Fo(r,e,t){let{$$slots:n={},$$scope:o}=e,{id:s=Xt("fill")}=e,{source:l=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:i=void 0}=e,{beforeLayerType:u=void 0}=e,{paint:f}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{minzoom:m=void 0}=e,{maxzoom:_=void 0}=e,{hoverCursor:k=void 0}=e,{hovered:C=null}=e,{eventsIfTopMost:L=!1}=e;function E(T){C=T,t(0,C)}function B(T){Me.call(this,r,T)}function S(T){Me.call(this,r,T)}function A(T){Me.call(this,r,T)}function j(T){Me.call(this,r,T)}function M(T){Me.call(this,r,T)}function P(T){Me.call(this,r,T)}return r.$$set=T=>{"id"in T&&t(1,s=T.id),"source"in T&&t(2,l=T.source),"sourceLayer"in T&&t(3,a=T.sourceLayer),"beforeId"in T&&t(4,i=T.beforeId),"beforeLayerType"in T&&t(5,u=T.beforeLayerType),"paint"in T&&t(6,f=T.paint),"layout"in T&&t(7,c=T.layout),"filter"in T&&t(8,p=T.filter),"minzoom"in T&&t(9,m=T.minzoom),"maxzoom"in T&&t(10,_=T.maxzoom),"hoverCursor"in T&&t(11,k=T.hoverCursor),"hovered"in T&&t(0,C=T.hovered),"eventsIfTopMost"in T&&t(12,L=T.eventsIfTopMost),"$$scope"in T&&t(21,o=T.$$scope)},[C,s,l,a,i,u,f,c,p,m,_,k,L,n,E,B,S,A,j,M,P,o]}class Bo extends Z{constructor(e){super(),K(this,e,Fo,No,x,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,hovered:0,eventsIfTopMost:12})}}function Er(r){let e=r[0],t,n,o=Ir(r);return{c(){o.c(),t=Qe()},m(s,l){o.m(s,l),h(s,t,l),n=!0},p(s,l){l&1&&x(e,e=s[0])?(me(),g(o,1,1,ne),he(),o=Ir(s),o.c(),$(o,1),o.m(t.parentNode,t)):o.p(s,l)},i(s){n||($(o),n=!0)},o(s){g(o),n=!1},d(s){s&&d(t),o.d(s)}}}function Ir(r){let e;const t=r[15].default,n=Ct(t,r,r[14],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&16384)&&Lt(n,t,o,o[14],e?Ot(t,o[14],s,null):Tt(o[14]),null)},i(o){e||($(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function jo(r){let e,t,n=r[0]&&Er(r);return{c(){n&&n.c(),e=Qe()},m(o,s){n&&n.m(o,s),h(o,e,s),t=!0},p(o,[s]){o[0]?n?(n.p(o,s),s&1&&$(n,1)):(n=Er(o),n.c(),$(n,1),n.m(e.parentNode,e)):n&&(me(),g(n,1,1,()=>{n=null}),he())},i(o){t||($(n),t=!0)},o(o){g(n),t=!1},d(o){o&&d(e),n&&n.d(o)}}}function Ro(r,e,t){let n,o,s,{$$slots:l={},$$scope:a}=e,{id:i=Xt("geojson")}=e,{data:u}=e,{generateId:f=!1}=e,{promoteId:c=void 0}=e,{filter:p=void 0}=e,{lineMetrics:m=void 0}=e,{cluster:_=void 0}=e;const{map:k,cluster:C,self:L}=yo();V(r,k,S=>t(13,n=S)),V(r,C,S=>t(16,s=S)),V(r,L,S=>t(0,o=S));let E,B=!0;return qt(()=>{if(o){let S=o;Et(L,o=null,o),t(11,E=void 0),lo().then(()=>{n!=null&&n.loaded()&&(n==null||n.removeSource(S))})}}),r.$$set=S=>{"id"in S&&t(4,i=S.id),"data"in S&&t(5,u=S.data),"generateId"in S&&t(6,f=S.generateId),"promoteId"in S&&t(7,c=S.promoteId),"filter"in S&&t(8,p=S.filter),"lineMetrics"in S&&t(9,m=S.lineMetrics),"cluster"in S&&t(10,_=S.cluster),"$$scope"in S&&t(14,a=S.$$scope)},r.$$.update=()=>{r.$$.dirty&1024&&Et(C,s=_,s),r.$$.dirty&10225&&n&&o!==i&&(o&&n.removeSource(o),Et(L,o=i,o),n.addSource(o,ar({type:"geojson",data:u,filter:p,lineMetrics:m,generateId:f,promoteId:c,cluster:!!_,clusterMinPoints:_==null?void 0:_.minPoints,clusterMaxZoom:_==null?void 0:_.maxZoom,clusterRadius:_==null?void 0:_.radius,clusterProperties:_==null?void 0:_.properties})),t(11,E=n.getSource(o)),t(12,B=!0)),r.$$.dirty&6176&&E&&(B?t(12,B=!1):E.setData(u)),r.$$.dirty&3072&&(E==null||E.setClusterOptions(ar({cluster:!!_,clusterMaxZoom:_==null?void 0:_.maxZoom,clusterRadius:_==null?void 0:_.radius})))},[o,k,C,L,i,u,f,c,p,m,_,E,B,n,a,l]}class Uo extends Z{constructor(e){super(),K(this,e,Ro,jo,x,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Ho(r){let e;const t=r[14].default,n=Ct(t,r,r[22],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&4194304)&&Lt(n,t,o,o[22],e?Ot(t,o[22],s,null):Tt(o[22]),null)},i(o){e||($(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function zo(r){let e,t,n;function o(l){r[15](l)}let s={id:r[1],type:"line",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],$$slots:{default:[Ho]},$$scope:{ctx:r}};return r[0]!==void 0&&(s.hovered=r[0]),e=new An({props:s}),G.push(()=>X(e,"hovered",o)),e.$on("click",r[16]),e.$on("dblclick",r[17]),e.$on("contextmenu",r[18]),e.$on("mouseenter",r[19]),e.$on("mousemove",r[20]),e.$on("mouseleave",r[21]),{c(){b(e.$$.fragment)},m(l,a){w(e,l,a),n=!0},p(l,[a]){const i={};a&2&&(i.id=l[1]),a&4&&(i.source=l[2]),a&8&&(i.sourceLayer=l[3]),a&16&&(i.beforeId=l[4]),a&32&&(i.beforeLayerType=l[5]),a&64&&(i.paint=l[6]),a&128&&(i.layout=l[7]),a&256&&(i.filter=l[8]),a&512&&(i.minzoom=l[9]),a&1024&&(i.maxzoom=l[10]),a&2048&&(i.hoverCursor=l[11]),a&4096&&(i.manageHoverState=l[12]),a&8192&&(i.eventsIfTopMost=l[13]),a&4194304&&(i.$$scope={dirty:a,ctx:l}),!t&&a&1&&(t=!0,i.hovered=l[0],Y(()=>t=!1)),e.$set(i)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){y(e,l)}}}function Wo(r,e,t){let{$$slots:n={},$$scope:o}=e,{id:s=Xt("line")}=e,{source:l=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:i=void 0}=e,{beforeLayerType:u=void 0}=e,{paint:f}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{minzoom:m=void 0}=e,{maxzoom:_=void 0}=e,{hoverCursor:k=void 0}=e,{manageHoverState:C=!1}=e,{hovered:L=null}=e,{eventsIfTopMost:E=!1}=e;function B(O){L=O,t(0,L)}function S(O){Me.call(this,r,O)}function A(O){Me.call(this,r,O)}function j(O){Me.call(this,r,O)}function M(O){Me.call(this,r,O)}function P(O){Me.call(this,r,O)}function T(O){Me.call(this,r,O)}return r.$$set=O=>{"id"in O&&t(1,s=O.id),"source"in O&&t(2,l=O.source),"sourceLayer"in O&&t(3,a=O.sourceLayer),"beforeId"in O&&t(4,i=O.beforeId),"beforeLayerType"in O&&t(5,u=O.beforeLayerType),"paint"in O&&t(6,f=O.paint),"layout"in O&&t(7,c=O.layout),"filter"in O&&t(8,p=O.filter),"minzoom"in O&&t(9,m=O.minzoom),"maxzoom"in O&&t(10,_=O.maxzoom),"hoverCursor"in O&&t(11,k=O.hoverCursor),"manageHoverState"in O&&t(12,C=O.manageHoverState),"hovered"in O&&t(0,L=O.hovered),"eventsIfTopMost"in O&&t(13,E=O.eventsIfTopMost),"$$scope"in O&&t(22,o=O.$$scope)},[L,s,l,a,i,u,f,c,p,m,_,k,C,E,n,B,S,A,j,M,P,T,o]}class xo extends Z{constructor(e){super(),K(this,e,Wo,zo,x,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}const Vo=r=>({features:r[0]&16,data:r[0]&16,map:r[0]&4,close:r[0]&1}),Mr=r=>{var e;return{features:r[4],data:(e=r[4])==null?void 0:e[0],map:r[2],close:r[29]}};function Pr(r){let e,t,n=(r[4]||r[3]instanceof ot.Marker)&&Nr(r);return{c(){e=N("div"),n&&n.c()},m(o,s){h(o,e,s),n&&n.m(e,null),r[30](e),t=!0},p(o,s){o[4]||o[3]instanceof ot.Marker?n?(n.p(o,s),s[0]&24&&$(n,1)):(n=Nr(o),n.c(),$(n,1),n.m(e,null)):n&&(me(),g(n,1,1,()=>{n=null}),he())},i(o){t||($(n),t=!0)},o(o){g(n),t=!1},d(o){o&&d(e),n&&n.d(),r[30](null)}}}function Nr(r){let e;const t=r[28].default,n=Ct(t,r,r[27],Mr);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s[0]&134217749)&&Lt(n,t,o,o[27],e?Ot(t,o[27],s,Vo):Tt(o[27]),Mr)},i(o){e||($(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Go(r){let e,t,n=r[8].default&&Pr(r);return{c(){n&&n.c(),e=Qe()},m(o,s){n&&n.m(o,s),h(o,e,s),t=!0},p(o,s){o[8].default?n?(n.p(o,s),s[0]&256&&$(n,1)):(n=Pr(o),n.c(),$(n,1),n.m(e.parentNode,e)):n&&(me(),g(n,1,1,()=>{n=null}),he())},i(o){t||($(n),t=!0)},o(o){g(n),t=!1},d(o){o&&d(e),n&&n.d(o)}}}function Zo(r,e,t){let n,o,s,l,a,{$$slots:i={},$$scope:u}=e;const f=ao(i);let{closeButton:c=void 0}=e,{closeOnClickOutside:p=!0}=e,{closeOnClickInside:m=!1}=e,{closeOnMove:_=!1}=e,{openOn:k="click"}=e,{focusAfterOpen:C=!0}=e,{anchor:L=void 0}=e,{offset:E=void 0}=e,{popupClass:B=void 0}=e,{maxWidth:S=void 0}=e,{lngLat:A=void 0}=e,{html:j=void 0}=e,{open:M=!1}=e;const{map:P,popupTarget:T,layerEvent:O}=vo();V(r,P,F=>t(2,s=F)),V(r,T,F=>t(3,a=F)),V(r,O,F=>t(26,l=F));const U=["click","dblclick","contextmenu"];let z,W=!1,te;function pe(){if(!z)return;let F=z.getElement();!F||F===te||(te=F,k==="hover"&&(te.style.pointerEvents="none"),te.addEventListener("mouseenter",()=>{t(22,W=!0)},{passive:!0}),te.addEventListener("mouseleave",()=>{t(22,W=!1)},{passive:!0}),te.addEventListener("click",()=>{m&&t(0,M=!1)},{passive:!0}))}Bt(()=>{if(s)return s.on("click",fe),typeof a=="string"&&(s.on("click",a,se),s.on("dblclick",a,se),s.on("contextmenu",a,se),s.on("mousemove",a,Ce),s.on("mouseleave",a,de),s.on("touchstart",a,_e),s.on("touchend",a,Ie)),()=>{s!=null&&s.loaded()&&(z==null||z.remove(),s.off("click",fe),a instanceof ot.Marker?a.getPopup()===z&&a.setPopup(void 0):typeof a=="string"&&(s.off("click",a,se),s.off("dblclick",a,se),s.off("contextmenu",a,se),s.off("mousemove",a,Ce),s.off("mouseleave",a,de),s.off("touchstart",a,_e),s.off("touchend",a,Ie)))}});let J=null,le="normal";function se(F){F.type===k&&("layerType"in F?F.layerType==="deckgl"?(t(9,A=F.coordinate),t(4,J=F.object?[F.object]:null)):(t(9,A=F.lngLat),t(4,J=F.features??[])):(t(9,A=F.lngLat),t(4,J=F.features??[])),setTimeout(()=>t(0,M=!0)))}let ge=null;function _e(F){ge=F.point}function Ie(F){if(!ge||k!=="hover")return;let Se=ge.dist(F.point);ge=null,Se<3&&(t(9,A=F.lngLat),t(4,J=F.features??[]),z.isOpen()?t(23,le="justOpened"):(t(23,le="opening"),t(0,M=!0)))}function de(F){k!=="hover"||ge||le!=="normal"||(t(0,M=!1),t(4,J=null))}function Ce(F){k!=="hover"||ge||le!=="normal"||(t(0,M=!0),t(4,J=F.features??[]),t(9,A=F.lngLat))}function fe(F){if(le==="justOpened"){t(23,le="normal");return}if(!p)return;let Se=[te,a instanceof ot.Marker?a==null?void 0:a.getElement():null];M&&z.isOpen()&&!Se.some(we=>we==null?void 0:we.contains(F.originalEvent.target))&&t(0,M=!1)}let R;const be=()=>t(0,M=!1);function re(F){G[F?"unshift":"push"](()=>{R=F,t(1,R)})}return r.$$set=F=>{"closeButton"in F&&t(10,c=F.closeButton),"closeOnClickOutside"in F&&t(11,p=F.closeOnClickOutside),"closeOnClickInside"in F&&t(12,m=F.closeOnClickInside),"closeOnMove"in F&&t(13,_=F.closeOnMove),"openOn"in F&&t(14,k=F.openOn),"focusAfterOpen"in F&&t(15,C=F.focusAfterOpen),"anchor"in F&&t(16,L=F.anchor),"offset"in F&&t(17,E=F.offset),"popupClass"in F&&t(18,B=F.popupClass),"maxWidth"in F&&t(19,S=F.maxWidth),"lngLat"in F&&t(9,A=F.lngLat),"html"in F&&t(20,j=F.html),"open"in F&&t(0,M=F.open),"$$scope"in F&&t(27,u=F.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&7168&&t(25,n=c??(!p&&!m)),r.$$.dirty[0]&36675584&&(z||(t(21,z=new ot.Popup({closeButton:n,closeOnClick:!1,closeOnMove:_,focusAfterOpen:C,maxWidth:S,className:B,anchor:L,offset:E})),te=z.getElement(),z.on("open",()=>{t(0,M=!0),pe()}),z.on("close",F=>{t(0,M=!1)}))),r.$$.dirty[0]&2113544&&z&&a instanceof ot.Marker&&(k==="click"?a.setPopup(z):a.getPopup()===z&&a.setPopup(void 0)),r.$$.dirty[0]&67125248&&U.includes(k)&&(l==null?void 0:l.type)===k&&(se(l),Et(O,l=null,l)),r.$$.dirty[0]&67125248&&t(24,o=k==="hover"&&((l==null?void 0:l.type)==="mousemove"||(l==null?void 0:l.type)==="mouseenter")),r.$$.dirty[0]&88096768&&k==="hover"&&O&&(o&&l&&(l.layerType==="deckgl"?(t(9,A=l.coordinate),t(4,J=l.object?[l.object]:null)):(t(9,A=l.lngLat),t(4,J=l.features??[]))),t(0,M=(o||W)??!1)),r.$$.dirty[0]&3145730&&(R?z.setDOMContent(R):j&&z.setHTML(j)),r.$$.dirty[0]&2097664&&A&&z.setLngLat(A),r.$$.dirty[0]&10485765&&s){let F=z.isOpen();M&&!F?(z.addTo(s),le==="opening"&&t(23,le="justOpened")):!M&&F&&z.remove()}},[M,R,s,a,J,P,T,O,f,A,c,p,m,_,k,C,L,E,B,S,j,z,W,le,o,n,l,u,i,be,re]}class Ko extends Z{constructor(e){super(),K(this,e,Zo,Go,x,{closeButton:10,closeOnClickOutside:11,closeOnClickInside:12,closeOnMove:13,openOn:14,focusAfterOpen:15,anchor:16,offset:17,popupClass:18,maxWidth:19,lngLat:9,html:20,open:0},null,[-1,-1])}}function qo(r){let e;return{c(){e=N("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Xo(r){let e,t,n,o,s=r[0]=="Private (development)"&&qo();return{c(){s&&s.c(),e=D(),t=N("p"),t.textContent="Note the ATF scheme data has not been validated.",n=D(),o=N("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(l,a){s&&s.m(l,a),h(l,e,a),h(l,t,a),h(l,n,a),h(l,o,a)},p:ne,d(l){l&&(d(e),d(t),d(n),d(o)),s&&s.d(l)}}}function Yo(r){let e,t,n,o,s,l;return s=new ce({props:{$$slots:{default:[Xo]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("App version: "),n=v(r[0]),o=D(),b(s.$$.fragment)},m(a,i){h(a,e,i),I(e,t),I(e,n),I(e,o),w(s,e,null),l=!0},p(a,[i]){const u={};i&2&&(u.$$scope={dirty:i,ctx:a}),s.$set(u)},i(a){l||($(s.$$.fragment,a),l=!0)},o(a){g(s.$$.fragment,a),l=!1},d(a){a&&d(e),y(s)}}}function Jo(r){return[_r()]}class Qo extends Z{constructor(e){super(),K(this,e,Jo,Yo,x,{})}}const es={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var Te=Uint8Array,dt=Uint16Array,Dn=Uint32Array,En=new Te([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),In=new Te([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ts=new Te([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Mn=function(r,e){for(var t=new dt(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var o=new Dn(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)o[s]=s-t[n]<<5|n;return[t,o]},Pn=Mn(En,2),Nn=Pn[0],rs=Pn[1];Nn[28]=258,rs[258]=28;var ns=Mn(In,0),os=ns[0],fr=new dt(32768);for(var oe=0;oe<32768;++oe){var et=(oe&43690)>>>1|(oe&21845)<<1;et=(et&52428)>>>2|(et&13107)<<2,et=(et&61680)>>>4|(et&3855)<<4,fr[oe]=((et&65280)>>>8|(et&255)<<8)>>>1}var It=function(r,e,t){for(var n=r.length,o=0,s=new dt(e);o<n;++o)r[o]&&++s[r[o]-1];var l=new dt(e);for(o=0;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var a;if(t){a=new dt(1<<e);var i=15-e;for(o=0;o<n;++o)if(r[o])for(var u=o<<4|r[o],f=e-r[o],c=l[r[o]-1]++<<f,p=c|(1<<f)-1;c<=p;++c)a[fr[c]>>>i]=u}else for(a=new dt(n),o=0;o<n;++o)r[o]&&(a[o]=fr[l[r[o]-1]++]>>>15-r[o]);return a},Rt=new Te(288);for(var oe=0;oe<144;++oe)Rt[oe]=8;for(var oe=144;oe<256;++oe)Rt[oe]=9;for(var oe=256;oe<280;++oe)Rt[oe]=7;for(var oe=280;oe<288;++oe)Rt[oe]=8;var Fn=new Te(32);for(var oe=0;oe<32;++oe)Fn[oe]=5;var ss=It(Rt,9,1),is=It(Fn,5,1),Jt=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},je=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},Qt=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},ls=function(r){return(r+7)/8|0},yr=function(r,e,t){(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length);var n=new(r.BYTES_PER_ELEMENT==2?dt:r.BYTES_PER_ELEMENT==4?Dn:Te)(t-e);return n.set(r.subarray(e,t)),n},as=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],He=function(r,e,t){var n=new Error(e||as[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,He),!t)throw n;return n},fs=function(r,e,t){var n=r.length;if(!n||t&&t.f&&!t.l)return e||new Te(0);var o=!e||t,s=!t||t.i;t||(t={}),e||(e=new Te(n*3));var l=function(be){var re=e.length;if(be>re){var F=new Te(Math.max(re*2,be));F.set(e),e=F}},a=t.f||0,i=t.p||0,u=t.b||0,f=t.l,c=t.d,p=t.m,m=t.n,_=n*8;do{if(!f){a=je(r,i,1);var k=je(r,i+1,3);if(i+=3,k)if(k==1)f=ss,c=is,p=9,m=5;else if(k==2){var B=je(r,i,31)+257,S=je(r,i+10,15)+4,A=B+je(r,i+5,31)+1;i+=14;for(var j=new Te(A),M=new Te(19),P=0;P<S;++P)M[ts[P]]=je(r,i+P*3,7);i+=S*3;for(var T=Jt(M),O=(1<<T)-1,U=It(M,T,1),P=0;P<A;){var z=U[je(r,i,O)];i+=z&15;var C=z>>>4;if(C<16)j[P++]=C;else{var W=0,te=0;for(C==16?(te=3+je(r,i,3),i+=2,W=j[P-1]):C==17?(te=3+je(r,i,7),i+=3):C==18&&(te=11+je(r,i,127),i+=7);te--;)j[P++]=W}}var pe=j.subarray(0,B),J=j.subarray(B);p=Jt(pe),m=Jt(J),f=It(pe,p,1),c=It(J,m,1)}else He(1);else{var C=ls(i)+4,L=r[C-4]|r[C-3]<<8,E=C+L;if(E>n){s&&He(0);break}o&&l(u+L),e.set(r.subarray(C,E),u),t.b=u+=L,t.p=i=E*8,t.f=a;continue}if(i>_){s&&He(0);break}}o&&l(u+131072);for(var le=(1<<p)-1,se=(1<<m)-1,ge=i;;ge=i){var W=f[Qt(r,i)&le],_e=W>>>4;if(i+=W&15,i>_){s&&He(0);break}if(W||He(2),_e<256)e[u++]=_e;else if(_e==256){ge=i,f=null;break}else{var Ie=_e-254;if(_e>264){var P=_e-257,de=En[P];Ie=je(r,i,(1<<de)-1)+Nn[P],i+=de}var Ce=c[Qt(r,i)&se],fe=Ce>>>4;Ce||He(3),i+=Ce&15;var J=os[fe];if(fe>3){var de=In[fe];J+=Qt(r,i)&(1<<de)-1,i+=de}if(i>_){s&&He(0);break}o&&l(u+131072);for(var R=u+Ie;u<R;u+=4)e[u]=e[u-J],e[u+1]=e[u+1-J],e[u+2]=e[u+2-J],e[u+3]=e[u+3-J];u=R}}t.l=f,t.p=ge,t.b=u,t.f=a,f&&(a=1,t.m=p,t.d=c,t.n=m)}while(!a);return u==e.length?e:yr(e,0,u)},us=new Te(0),Ke=function(r,e){return r[e]|r[e+1]<<8},ze=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},er=function(r,e){return ze(r,e)+ze(r,e+4)*4294967296};function cs(r,e){return fs(r,e)}var ur=typeof TextDecoder<"u"&&new TextDecoder,ps=0;try{ur.decode(us,{stream:!0}),ps=1}catch{}var ms=function(r){for(var e="",t=0;;){var n=r[t++],o=(n>127)+(n>223)+(n>239);if(t+o>r.length)return[e,yr(r,t-1)];o?o==3?(n=((n&15)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|r[t++]&63):e+=String.fromCharCode((n&15)<<12|(r[t++]&63)<<6|r[t++]&63):e+=String.fromCharCode(n)}};function Bn(r,e){if(e){for(var t="",n=0;n<r.length;n+=16384)t+=String.fromCharCode.apply(null,r.subarray(n,n+16384));return t}else{if(ur)return ur.decode(r);var o=ms(r),s=o[0],l=o[1];return l.length&&He(8),s}}var hs=function(r,e){return e+30+Ke(r,e+26)+Ke(r,e+28)},ds=function(r,e,t){var n=Ke(r,e+28),o=Bn(r.subarray(e+46,e+46+n),!(Ke(r,e+8)&2048)),s=e+46+n,l=ze(r,e+20),a=t&&l==4294967295?$s(r,s):[l,ze(r,e+24),ze(r,e+42)],i=a[0],u=a[1],f=a[2];return[Ke(r,e+10),i,u,o,s+Ke(r,e+30)+Ke(r,e+32),f]},$s=function(r,e){for(;Ke(r,e)!=1;e+=4+Ke(r,e+2));return[er(r,e+12),er(r,e+4),er(r,e+20)]};function gs(r,e){for(var t={},n=r.length-22;ze(r,n)!=101010256;--n)(!n||r.length-n>65558)&&He(13);var o=Ke(r,n+8);if(!o)return{};var s=ze(r,n+16),l=s==4294967295||o==65535;if(l){var a=ze(r,n-12);l=ze(r,a)==101075792,l&&(o=ze(r,a+32),s=ze(r,a+48))}for(var i=e&&e.filter,u=0;u<o;++u){var f=ds(r,s,l),c=f[0],p=f[1],m=f[2],_=f[3],k=f[4],C=f[5],L=hs(r,C);s=k,(!i||i({name:_,size:p,originalSize:m,compression:c}))&&(c?c==8?t[_]=cs(r.subarray(L,L+p),new Te(m)):He(14,"unknown compression type "+c):t[_]=yr(r,L,L+p))}return t}function _s(r){return r instanceof File||r instanceof Blob?r.arrayBuffer().then(tr):tr(r)}function tr(r){var e=new Uint8Array(r),t=gs(e);return Promise.resolve(bs(t))}function bs(r){for(var e=[],t=0,n=Object.keys(r);t<n.length;t++){var o=n[t];e[o]=Bn(r[o])}return e}function qe(r,e){for(var t=0;t<r.childNodes.length;){var n=r.childNodes[t];if(n.nodeType===1&&gt(n)===e)return n;t++}}function Ut(r,e){for(var t=[],n=0;n<r.childNodes.length;){var o=r.childNodes[n];o.nodeType===1&&gt(o)===e&&t.push(o),n++}return t}function Zt(r,e,t){for(var n=0;n<r.childNodes.length;){var o=r.childNodes[n];e?o.nodeType===1&&gt(o)===e&&t(o,n):t(o,n),n++}}function ws(r,e,t){var n=[];return Zt(r,e,function(o,s){n.push(t(o,s))}),n}var ys=/.+\:/;function gt(r){return r.tagName.replace(ys,"")}function jn(r){if(r.nodeType!==1)return r.textContent;for(var e="<"+gt(r),t=0;t<r.attributes.length;)e+=" "+r.attributes[t].name+'="'+r.attributes[t].value+'"',t++;e+=">";for(var n=0;n<r.childNodes.length;)e+=jn(r.childNodes[n]),n++;return e+="</"+gt(r)+">",e}function vs(r){var e=r.documentElement,t=qe(e,"sheetData"),n=[];return Zt(t,"row",function(o){Zt(o,"c",function(s){n.push(s)})}),n}function ks(r,e){return qe(e,"v")}function Ss(r,e){if(e.firstChild&&gt(e.firstChild)==="is"&&e.firstChild.firstChild&&gt(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function Cs(r){var e=r.documentElement,t=qe(e,"dimension");if(t)return t.getAttribute("ref")}function Ls(r){var e=r.documentElement,t=qe(e,"cellStyleXfs");return t?Ut(t,"xf"):[]}function Ts(r){var e=r.documentElement,t=qe(e,"cellXfs");return t?Ut(t,"xf"):[]}function Os(r){var e=r.documentElement,t=qe(e,"numFmts");return t?Ut(t,"numFmt"):[]}function As(r){var e=r.documentElement;return ws(e,"si",function(t){var n=qe(t,"t");if(n)return n.textContent;var o="";return Zt(t,"r",function(s){o+=qe(s,"t").textContent}),o})}function Ds(r){var e=r.documentElement;return qe(e,"workbookPr")}function Es(r){var e=r.documentElement;return Ut(e,"Relationship")}function Is(r){var e=r.documentElement,t=qe(e,"sheets");return Ut(t,"sheet")}function Ms(r,e){var t=e.createDocument(r),n={},o=Ds(t);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(a){a.getAttribute("name")&&n.sheets.push({id:a.getAttribute("sheetId"),name:a.getAttribute("name"),relationId:a.getAttribute("r:id")})};return Is(t).forEach(s),n}function Ps(r,e){var t=e.createDocument(r),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(l){var a=l.getAttribute("Target"),i=l.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=rr(a);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=rr(a);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[l.getAttribute("Id")]=rr(a);break}};return Es(t).forEach(o),n}function rr(r){return r[0]==="/"?r.slice(1):"xl/"+r}function Fr(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function Br(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fr(Object(t),!0).forEach(function(n){Ns(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Fr(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Ns(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Fs(r,e){if(!r)return{};var t=e.createDocument(r),n=Ls(t).map(nr),o=Os(t).map(Bs).reduce(function(l,a){return l[a.id]=a,l},[]),s=function(a){return a.hasAttribute("xfId")?Br(Br({},n[a.xfId]),nr(a,o)):nr(a,o)};return Ts(t).map(s)}function Bs(r){return{id:r.getAttribute("numFmtId"),template:r.getAttribute("formatCode")}}function nr(r,e){var t={};if(r.hasAttribute("numFmtId")){var n=r.getAttribute("numFmtId");e[n]?t.numberFormat=e[n]:t.numberFormat={id:n}}return t}function js(r,e){return r?As(e.createDocument(r)):[]}function Rn(r,e){e&&e.epoch1904&&(r+=1462);var t=70*365+19,n=60*60*1e3;return new Date(Math.round((r-t)*24*n))}function Rs(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=Us(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Us(r,e){if(r){if(typeof r=="string")return jr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return jr(r,e)}}function jr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Hs(r,e,t,n){if(e){var o=t[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(zs.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&Vs(o.numberFormat.template))return!0}}var zs=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],Ws=/^\[\$-414\]/,xs=/;@$/;function Vs(r){r=r.toLowerCase(),r=r.replace(Ws,""),r=r.replace(xs,"");for(var e=r.split(/\W+/),t=Rs(e),n;!(n=t()).done;){var o=n.value;if(Gs.indexOf(o)<0)return!1}return!0}var Gs=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function Zs(r,e,t){var n=t.getInlineStringValue,o=t.getInlineStringXml,s=t.getStyleId,l=t.styles,a=t.values,i=t.properties,u=t.options;switch(e||(e="n"),e){case"str":r=or(r,u);break;case"inlineStr":if(r=n(),r===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));r=or(r,u);break;case"s":var f=Number(r);if(isNaN(f))throw new Error('Invalid "shared" string index: '.concat(r));if(f>=a.length)throw new Error('An out-of-bounds "shared" string index: '.concat(r));r=a[f],r=or(r,u);break;case"b":if(r==="1")r=!0;else if(r==="0")r=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(r));break;case"z":r=void 0;break;case"e":r=Ks(r);break;case"d":if(r===void 0)break;var c=new Date(r);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(r));r=c;break;case"n":if(r===void 0)break;var p=Number(r);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(r));r=p,Hs(r,s(),l,u)&&(r=Rn(r,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return r===void 0&&(r=null),r}function Ks(r){switch(r){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(r)}}function or(r,e){return e.trim!==!1&&(r=r.trim()),r===""&&(r=void 0),r}var qs=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Xs(r){var e=function(u,f){return u-f},t=r.map(function(i){return i.row}).sort(e),n=r.map(function(i){return i.column}).sort(e),o=t[0],s=t[t.length-1],l=n[0],a=n[n.length-1];return[{row:o,column:l},{row:s,column:a}]}function Ys(r){for(var e=0,t=0;t<r.length;)e*=26,e+=qs.indexOf(r[t]),t++;return e}function Un(r){return r=r.split(/(\d+)/),[parseInt(r[1]),Ys(r[0].trim())]}function Js(r,e,t,n,o,s,l){var a=Un(r.getAttribute("r")),i=ks(e,r),u=i&&i.textContent,f;return r.hasAttribute("t")&&(f=r.getAttribute("t")),{row:a[0],column:a[1],value:Zs(u,f,{getInlineStringValue:function(){return Ss(e,r)},getInlineStringXml:function(){return jn(r)},getStyleId:function(){return r.getAttribute("s")},styles:o,values:n,properties:s,options:l})}}function Qs(r,e,t,n,o,s){var l=vs(r);return l.length===0?[]:l.map(function(a){return Js(a,r,e,t,n,o,s)})}function ei(r,e){return oi(r)||ni(r,e)||ri(r,e)||ti()}function ti(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ri(r,e){if(r){if(typeof r=="string")return Rr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Rr(r,e)}}function Rr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function ni(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],o=!0,s=!1,l,a;try{for(t=t.call(r);!(o=(l=t.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,a=i}finally{try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}return n}}function oi(r){if(Array.isArray(r))return r}function si(r){var e=Cs(r);if(e)return e=e.split(":").map(Un).map(function(t){var n=ei(t,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function ii(r,e,t,n,o,s){var l=e.createDocument(r),a=Qs(l,e,t,n,o,s),i=si(l)||Xs(a);return{cells:a,dimensions:i}}function li(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=ai(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ai(r,e){if(r){if(typeof r=="string")return Ur(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ur(r,e)}}function Ur(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function fi(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,l=r.length-1;l>=0;){for(var a=!0,i=li(r[l]),u;!(u=i()).done;){var f=u.value;if(o(f)!==null){a=!1;break}}if(a)r.splice(l,1),t&&t.splice(l,1);else if(s)break;l--}return r}function ui(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=ci(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ci(r,e){if(r){if(typeof r=="string")return Hr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Hr(r,e)}}function Hr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function pi(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.accessor,n=t===void 0?function(c){return c}:t,o=e.onlyTrimAtTheEnd,s=r[0].length-1;s>=0;){for(var l=!0,a=ui(r),i;!(i=a()).done;){var u=i.value;if(n(u[s])!==null){l=!1;break}}if(l)for(var f=0;f<r.length;)r[f].splice(s,1),f++;else if(o)break;s--}return r}function mi(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=Hn(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hi(r,e){return gi(r)||$i(r,e)||Hn(r,e)||di()}function di(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hn(r,e){if(r){if(typeof r=="string")return zr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zr(r,e)}}function zr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function $i(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],o=!0,s=!1,l,a;try{for(t=t.call(r);!(o=(l=t.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,a=i}finally{try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}return n}}function gi(r){if(Array.isArray(r))return r}function _i(r,e){var t=r.dimensions,n=r.cells;if(n.length===0)return[];var o=hi(t,2);o[0];for(var s=o[1],l=s.column,a=s.row,i=new Array(a),u=0;u<a;){i[u]=new Array(l);for(var f=0;f<l;)i[u][f]=null,f++;u++}for(var c=mi(n),p;!(p=c()).done;){var m=p.value,_=m.row-1,k=m.column-1;k<l&&_<a&&(i[_][k]=m.value)}var C=e.rowMap;if(C)for(var L=0;L<i.length;)C[L]=L,L++;return i=fi(pi(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:C}),e.transformData&&(i=e.transformData(i)),i}function bi(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=wi(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wi(r,e){if(r){if(typeof r=="string")return Wr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Wr(r,e)}}function Wr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function xr(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function yi(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xr(Object(t),!0).forEach(function(n){vi(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):xr(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function vi(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ki(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};t.sheet||(t=yi({sheet:1},t));var n=function(p){if(!r[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return r[p]},o=Ps(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?js(n(o.sharedStrings),e):[],l=o.styles?Fs(n(o.styles),e):{},a=Ms(n("xl/workbook.xml"),e);if(t.getSheets)return a.sheets.map(function(c){var p=c.name;return{name:p}});var i=Si(t.sheet,a.sheets);if(!i||!o.sheets[i])throw Ci(t.sheet,a.sheets);var u=ii(n(o.sheets[i]),e,s,l,a,t),f=_i(u,t);return t.properties?{data:f,properties:a}:f}function Si(r,e){if(typeof r=="number"){var t=e[r-1];return t&&t.relationId}for(var n=bi(e),o;!(o=n()).done;){var s=o.value;if(s.name===r)return s.relationId}}function Ci(r,e){var t=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof r=="number"?"#"+r:'"'+r+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+t+".":""))}function cr(r){"@babel/helpers - typeof";return cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(r)}function Vr(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Li(r,e,t){return e&&Vr(r.prototype,e),t&&Vr(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ti(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Oi(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Nt(r,e)}function Ai(r){var e=zn();return function(){var n=Ft(r),o;if(e){var s=Ft(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Di(this,o)}}function Di(r,e){if(e&&(cr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ei(r)}function Ei(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function pr(r){var e=typeof Map=="function"?new Map:void 0;return pr=function(n){if(n===null||!Ii(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return Wt(n,arguments,Ft(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Nt(o,n)},pr(r)}function Wt(r,e,t){return zn()?Wt=Reflect.construct:Wt=function(o,s,l){var a=[null];a.push.apply(a,s);var i=Function.bind.apply(o,a),u=new i;return l&&Nt(u,l.prototype),u},Wt.apply(null,arguments)}function zn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ii(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function Nt(r,e){return Nt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},Nt(r,e)}function Ft(r){return Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(r)}var Oe=function(r){Oi(t,r);var e=Ai(t);function t(n){var o;return Ti(this,t),o=e.call(this,"invalid"),o.reason=n,o}return Li(t)}(pr(Error));function Mi(r){if(typeof r=="string"){var e=r;if(r=Number(r),String(r)!==e)throw new Oe("not_a_number")}if(typeof r!="number")throw new Oe("not_a_number");if(isNaN(r))throw new Oe("invalid_number");if(!isFinite(r))throw new Oe("out_of_bounds");return r}function Pi(r){if(typeof r=="string")return r;if(typeof r=="number"){if(isNaN(r))throw new Oe("invalid_number");if(!isFinite(r))throw new Oe("out_of_bounds");return String(r)}throw new Oe("not_a_string")}function Ni(r){if(typeof r=="boolean")return r;throw new Oe("not_a_boolean")}function Fi(r,e){var t=e.properties;if(r instanceof Date){if(isNaN(r.valueOf()))throw new Oe("out_of_bounds");return r}if(typeof r=="number"){if(isNaN(r))throw new Oe("invalid_number");if(!isFinite(r))throw new Oe("out_of_bounds");var n=Rn(r,t);if(isNaN(n.valueOf()))throw new Oe("out_of_bounds");return n}throw new Oe("not_a_date")}function Bi(r,e){return Ui(r)||Ri(r,e)||Wn(r,e)||ji()}function ji(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ri(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],o=!0,s=!1,l,a;try{for(t=t.call(r);!(o=(l=t.next()).done)&&(n.push(l.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,a=i}finally{try{!o&&t.return!=null&&t.return()}finally{if(s)throw a}}return n}}function Ui(r){if(Array.isArray(r))return r}function mr(r){"@babel/helpers - typeof";return mr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mr(r)}function Hi(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=Wn(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wn(r,e){if(r){if(typeof r=="string")return Gr(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Gr(r,e)}}function Gr(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Zr(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function Kr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Zr(Object(t),!0).forEach(function(n){zi(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Zr(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function zi(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var qr={isColumnOriented:!1};function Wi(r,e,t){t?t=Kr(Kr({},qr),t):t=qr;var n=t,o=n.isColumnOriented,s=n.rowMap,l=n.ignoreEmptyRows;Zi(e),o&&(r=Gi(r));for(var a=r[0],i=[],u=[],f=1;f<r.length;f++){var c=xn(e,r[f],f,a,u,t);(c!==null||l===!1)&&i.push(c)}if(s)for(var p=Hi(u),m;!(m=p()).done;){var _=m.value;_.row=s[_.row-1]+1}return{rows:i,errors:u}}function xn(r,e,t,n,o,s){for(var l={},a=!0,i=function(){var p=f[u],m=r[p],_=mr(m.type)==="object"&&!Array.isArray(m.type),k=e[n.indexOf(p)];k===void 0&&(k=null);var C=void 0,L=void 0,E=void 0;if(_)C=xn(m.type,e,t,n,o,s);else if(k===null)C=null;else if(Array.isArray(m.type)){var B=!1,S=Vi(k).map(function(j){var M=Xr(j,m,s);return M.error&&(C=j,L=M.error,E=M.reason),M.value!==null&&(B=!0),M.value});L||(C=B?S:null)}else{var A=Xr(k,m,s);L=A.error,E=A.reason,C=L?k:A.value}!L&&C===null&&m.required&&(L="required"),L?(L={error:L,row:t+1,column:p,value:C},E&&(L.reason=E),m.type&&(L.type=m.type),o.push(L)):(a&&C!==null&&(a=!1),(C!==null||s.includeNullValues)&&(l[m.prop]=C))},u=0,f=Object.keys(r);u<f.length;u++)i();return a?null:l}function Xr(r,e,t){if(r===null)return{value:null};var n;if(e.parse?n=wt(r,e.parse):e.type?n=xi(r,Array.isArray(e.type)?e.type[0]:e.type,t):n={value:r},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function wt(r,e){try{return r=e(r),r===void 0?{value:null}:{value:r}}catch(n){var t={error:n.message};return n.reason&&(t.reason=n.reason),t}}function xi(r,e,t){switch(e){case String:return wt(r,Pi);case Number:return wt(r,Mi);case Date:return wt(r,function(n){return Fi(n,{properties:t.properties})});case Boolean:return wt(r,Ni);default:if(typeof e=="function")return wt(r,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Vn(r,e,t){for(var n=0,o="";t+n<r.length;){var s=r[t+n];if(s===e)return[o,n];if(s==='"'){var l=Vn(r,'"',t+n+1);o+=l[0],n+=1+l[1]+1}else o+=s,n++}return[o,n]}function Vi(r){for(var e=[],t=0;t<r.length;){var n=Vn(r,",",t),o=Bi(n,2),s=o[0],l=o[1];t+=l+1,e.push(s.trim())}return e}var Gi=function(e){return e[0].map(function(t,n){return e.map(function(o){return o[n]})})};function Zi(r){for(var e=0,t=Object.keys(r);e<t.length;e++){var n=t[e],o=r[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function hr(r){"@babel/helpers - typeof";return hr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hr(r)}function Gn(r){for(var e={},t=0,n=Object.keys(r);t<n.length;t++){var o=n[t],s=r[o],l=void 0;hr(s)==="object"&&(s=Object.keys(r[o])[0],l=Gn(r[o][s])),e[o]={prop:s},l&&(e[o].type=l)}return e}var Ki=["schema","map"];function Yr(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function zt(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yr(Object(t),!0).forEach(function(n){qi(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Yr(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function qi(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Xi(r,e){if(r==null)return{};var t=Yi(r,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function Yi(r,e){if(r==null)return{};var t={},n=Object.keys(r),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(t[o]=r[o]);return t}function Ji(r,e,t){var n=t.schema,o=t.map,s=Xi(t,Ki);!n&&o&&(n=Gn(o));var l=ki(r,e,zt(zt({},s),{},{properties:n||s.properties}));return n?Wi(l.data,n,zt(zt({},s),{},{properties:l.properties})):l}function Qi(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _s(r).then(function(t){return Ji(t,es,e)})}function el(r){let e=new Map;for(let[n,o]of Object.entries(r.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let t=1;for(let n of r.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=t++}return e}async function tl(r){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:t}=await Qi(r,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of t){let s=fo(o.lat_lon.split(",").map(parseFloat).reverse()),l=o;l.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:l,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const q={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Yt=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function rl(r){let e,t,n,o,s;function l(i){r[3](i)}let a={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return r[0]!==void 0&&(a.value=r[0]),e=new Gt({props:a}),G.push(()=>X(e,"value",l)),e.$on("change",r[2]),o=new $o({props:{rows:r[1]}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};!t&&u&1&&(t=!0,f.value=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&2&&(c.rows=i[1]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}function nl(r,e,t){let n;V(r,ue,i=>t(4,n=i));let o="interventionType",s=Tr("v1");function l(){let i;o=="interventionType"?(i=On("v1"),t(1,s=Tr("v1"))):(i=vn(["get","funding_programme"],{ATF2:q.atf2,ATF3:q.atf3,ATF4:q.atf4},"grey"),t(1,s=[["ATF2",q.atf2],["ATF3",q.atf3],["ATF4",q.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function a(i){o=i,t(0,o)}return[o,s,l,a]}class ol extends Z{constructor(e){super(),K(this,e,nl,rl,x,{})}}function sl(r){let e;return{c(){e=v("Clear")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function il(r){let e,t,n,o,s,l;return n=new lr({props:{$$slots:{default:[sl]},$$scope:{ctx:r}}}),n.$on("click",r[13]),{c(){e=N("input"),t=D(),b(n.$$.fragment),ee(e,"type","text"),ee(e,"class","govuk-input govuk-input--width-10"),ee(e,"id","filterText")},m(a,i){h(a,e,i),Cr(e,r[0]),h(a,t,i),w(n,a,i),o=!0,s||(l=br(e,"input",r[12]),s=!0)},p(a,i){i&1&&e.value!==a[0]&&Cr(e,a[0]);const u={};i&131072&&(u.$$scope={dirty:i,ctx:a}),n.$set(u)},i(a){o||($(n.$$.fragment,a),o=!0)},o(a){g(n.$$.fragment,a),o=!1},d(a){a&&(d(e),d(t)),y(n,a),s=!1,l()}}}function ll(r){let e,t,n,o,s,l,a,i,u,f;function c(k){r[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:r[5],emptyOption:!0};r[2]!==void 0&&(p.value=r[2]),e=new Gt({props:p}),G.push(()=>X(e,"value",c));function m(k){r[11](k)}let _={label:"Funding programme",id:"filterFundingProgramme",choices:r[6],emptyOption:!0};return r[3]!==void 0&&(_.value=r[3]),o=new Gt({props:_}),G.push(()=>X(o,"value",m)),a=new kn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[il]},$$scope:{ctx:r}}}),u=new ol({}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment),l=D(),b(a.$$.fragment),i=D(),b(u.$$.fragment)},m(k,C){w(e,k,C),h(k,n,C),w(o,k,C),h(k,l,C),w(a,k,C),h(k,i,C),w(u,k,C),f=!0},p(k,C){const L={};C&32&&(L.choices=k[5]),!t&&C&4&&(t=!0,L.value=k[2],Y(()=>t=!1)),e.$set(L);const E={};C&64&&(E.choices=k[6]),!s&&C&8&&(s=!0,E.value=k[3],Y(()=>s=!1)),o.$set(E);const B={};C&131073&&(B.$$scope={dirty:C,ctx:k}),a.$set(B)},i(k){f||($(e.$$.fragment,k),$(o.$$.fragment,k),$(a.$$.fragment,k),$(u.$$.fragment,k),f=!0)},o(k){g(e.$$.fragment,k),g(o.$$.fragment,k),g(a.$$.fragment,k),g(u.$$.fragment,k),f=!1},d(k){k&&(d(n),d(l),d(i)),y(e,k),y(o,k),y(a,k),y(u,k)}}}function al(r){let e,t=r[1].size.toLocaleString()+"",n,o,s=r[7].route.toLocaleString()+"",l,a,i=r[7].area.toLocaleString()+"",u,f,c=r[7].crossing.toLocaleString()+"",p,m,_=r[7].other.toLocaleString()+"",k,C;return{c(){e=v("Showing "),n=v(t),o=v(" schemes ("),l=v(s),a=v(`
    routes, `),u=v(i),f=v(` areas,
    `),p=v(c),m=v(" crossings, "),k=v(_),C=v(`
    other)`)},m(L,E){h(L,e,E),h(L,n,E),h(L,o,E),h(L,l,E),h(L,a,E),h(L,u,E),h(L,f,E),h(L,p,E),h(L,m,E),h(L,k,E),h(L,C,E)},p(L,E){E&2&&t!==(t=L[1].size.toLocaleString()+"")&&Pe(n,t),E&128&&s!==(s=L[7].route.toLocaleString()+"")&&Pe(l,s),E&128&&i!==(i=L[7].area.toLocaleString()+"")&&Pe(u,i),E&128&&c!==(c=L[7].crossing.toLocaleString()+"")&&Pe(p,c),E&128&&_!==(_=L[7].other.toLocaleString()+"")&&Pe(k,_)},d(L){L&&(d(e),d(n),d(o),d(l),d(a),d(u),d(f),d(p),d(m),d(k),d(C))}}}function fl(r){let e,t,n;function o(l){r[14](l)}let s={id:"show-schemes",$$slots:{default:[al]},$$scope:{ctx:r}};return r[4]!==void 0&&(s.checked=r[4]),e=new ae({props:s}),G.push(()=>X(e,"checked",o)),{c(){b(e.$$.fragment)},m(l,a){w(e,l,a),n=!0},p(l,a){const i={};a&131202&&(i.$$scope={dirty:a,ctx:l}),!t&&a&16&&(t=!0,i.checked=l[4],Y(()=>t=!1)),e.$set(i)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){y(e,l)}}}function ul(r){let e,t,n,o;return e=new Ye({props:{label:"Filters",$$slots:{default:[ll]},$$scope:{ctx:r}}}),n=new jt({props:{small:!0,$$slots:{default:[fl]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment)},m(s,l){w(e,s,l),h(s,t,l),w(n,s,l),o=!0},p(s,[l]){const a={};l&131181&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const i={};l&131218&&(i.$$scope={dirty:l,ctx:s}),n.$set(i)},i(s){o||($(e.$$.fragment,s),$(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&d(t),y(e,s),y(n,s)}}}function cl(r,e,t){let n,o;V(r,kt,S=>t(15,n=S)),V(r,ue,S=>t(9,o=S));let{schemes:s}=e,{schemesToBeShown:l=new Set}=e,{filterText:a=""}=e,i=[],u="",f=[],c="",p={area:0,route:0,crossing:0,other:0},m=!0;Bt(()=>{let S=new Set,A=new Set;for(let j of s.values())j.authority_or_region&&S.add(j.authority_or_region),j.funding_programme&&A.add(j.funding_programme);t(5,i=Array.from(S.entries())),i.sort(),t(6,f=Array.from(A.entries())),f.sort()});function _(S,A,j){let M=S.toLowerCase(),P=O=>{var U,z;if(M&&!((U=O.properties.name)!=null&&U.toLowerCase().includes(M))&&!((z=O.properties.description)!=null&&z.toLowerCase().includes(M)))return!1;if(A||j){let W=s.get(O.properties.scheme_reference);if(A&&W.authority_or_region!=A||j&&W.funding_programme!=j)return!1}return!0};t(1,l=new Set(n.features.filter(P).map(O=>O.properties.scheme_reference))),t(7,p={area:0,route:0,crossing:0,other:0});let T=O=>{var U,z;return!(!l.has(O.properties.scheme_reference)||M&&!((U=O.properties.name)!=null&&U.toLowerCase().includes(M))&&!((z=O.properties.description)!=null&&z.toLowerCase().includes(M)))};kt.update(O=>{for(let U of O.features)T(U)?(delete U.properties.hide_while_editing,t(7,p[U.properties.intervention_type]++,p)):U.properties.hide_while_editing=!0;return O}),t(7,p)}function k(S){u=S,t(2,u)}function C(S){c=S,t(3,c)}function L(){a=this.value,t(0,a)}const E=()=>t(0,a="");function B(S){m=S,t(4,m)}return r.$$set=S=>{"schemes"in S&&t(8,s=S.schemes),"schemesToBeShown"in S&&t(1,l=S.schemesToBeShown),"filterText"in S&&t(0,a=S.filterText)},r.$$.update=()=>{if(r.$$.dirty&528&&o)for(let S of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(S)&&o.setLayoutProperty(S,"visibility",m?"visible":"none");r.$$.dirty&13&&_(a,u,c)},[a,l,u,c,m,i,f,p,s,o,k,C,L,E,B]}class pl extends Z{constructor(e){super(),K(this,e,cl,ul,x,{schemes:8,schemesToBeShown:1,filterText:0})}}function ml(r){let e,t,n;return e=new Ee({props:{color:q.bus_route_with_lane}}),{c(){b(e.$$.fragment),t=v(`
  Bus routes`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function hl(r){let e;return{c(){e=v(`GTFS
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function dl(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function $l(r){let e,t,n,o,s,l,a,i,u,f,c;return s=new H({props:{href:"https://gtfs.org",$$slots:{default:[hl]},$$scope:{ctx:r}}}),f=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[dl]},$$scope:{ctx:r}}}),{c(){e=N("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,t=D(),n=N("p"),o=v("Note this data is from OpenStreetMap (as of 9 August 2023), not "),b(s.$$.fragment),l=v(`, and doesn't include which routes are run or the
        frequency of service.`),a=D(),i=N("p"),u=v("License: "),b(f.$$.fragment)},m(p,m){h(p,e,m),h(p,t,m),h(p,n,m),I(n,o),w(s,n,null),I(n,l),h(p,a,m),h(p,i,m),I(i,u),w(f,i,null),c=!0},p(p,m){const _={};m&8&&(_.$$scope={dirty:m,ctx:p}),s.$set(_);const k={};m&8&&(k.$$scope={dirty:m,ctx:p}),f.$set(k)},i(p){c||($(s.$$.fragment,p),$(f.$$.fragment,p),c=!0)},o(p){g(s.$$.fragment,p),g(f.$$.fragment,p),c=!1},d(p){p&&(d(e),d(t),d(n),d(a),d(i)),y(s),y(f)}}}function gl(r){let e,t,n;return t=new ce({props:{$$slots:{default:[$l]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&8&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function _l(r){let e,t,n,o,s;function l(i){r[1](i)}let a={id:at,$$slots:{right:[gl],default:[ml]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:at,tooltip:bl,show:r[0],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&8&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let at="bus_routes";function bl(r){return r.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function wl(r,e,t){let n;V(r,ue,l=>t(2,n=l)),ke(n,at,`${$e()}/v1/${at}.pmtiles`),Ne(n,{id:at,source:at,sourceLayer:at,color:["case",["boolean",["get","has_bus_lane"],!1],q.bus_route_with_lane,q.bus_route_without_lane],width:5,opacity:De(.5,1)});let o=!1;function s(l){o=l,t(0,o)}return[o,s]}class yl extends Z{constructor(e){super(),K(this,e,wl,_l,x,{})}}function Jr(r,e,t){const n=r.slice();return n[2]=e[t],n}function Qr(r,e,t){const n=r.slice();return n[5]=e[t],n}function en(r){let e,t;return{c(){e=N("span"),t=v(`
    `),Je(e,"background",r[5]),Je(e,"width","100%"),Je(e,"border","1px solid black")},m(n,o){h(n,e,o),I(e,t)},p(n,o){o&1&&Je(e,"background",n[5])},d(n){n&&d(e)}}}function tn(r){let e,t=r[2]+"",n;return{c(){e=N("span"),n=v(t)},m(o,s){h(o,e,s),I(e,n)},p(o,s){s&2&&t!==(t=o[2]+"")&&Pe(n,t)},d(o){o&&d(e)}}}function vl(r){let e,t,n,o=st(r[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=en(Qr(r,o,i));let l=st(r[1]),a=[];for(let i=0;i<l.length;i+=1)a[i]=tn(Jr(r,l,i));return{c(){e=N("div");for(let i=0;i<s.length;i+=1)s[i].c();t=D(),n=N("div");for(let i=0;i<a.length;i+=1)a[i].c();Je(e,"display","flex"),Je(n,"display","flex"),Je(n,"justify-content","space-between")},m(i,u){h(i,e,u);for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(e,null);h(i,t,u),h(i,n,u);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(n,null)},p(i,[u]){if(u&1){o=st(i[0]);let f;for(f=0;f<o.length;f+=1){const c=Qr(i,o,f);s[f]?s[f].p(c,u):(s[f]=en(c),s[f].c(),s[f].m(e,null))}for(;f<s.length;f+=1)s[f].d(1);s.length=o.length}if(u&2){l=st(i[1]);let f;for(f=0;f<l.length;f+=1){const c=Jr(i,l,f);a[f]?a[f].p(c,u):(a[f]=tn(c),a[f].c(),a[f].m(n,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=l.length}},i:ne,o:ne,d(i){i&&(d(e),d(t),d(n)),Vt(s,i),Vt(a,i)}}}function kl(r,e,t){let{colorScale:n}=e,{limits:o}=e;return r.$$set=s=>{"colorScale"in s&&t(0,n=s.colorScale),"limits"in s&&t(1,o=s.limits)},[n,o]}class lt extends Z{constructor(e){super(),K(this,e,kl,vl,x,{colorScale:0,limits:1})}}function Sl(r){let e;return{c(){e=v("Percent of households with a car")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Cl(r){let e;return{c(){e=v(`NOMIS TS045
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ll(r){let e;return{c(){e=v(`ONS Geography
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Tl(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ol(r){let e,t,n,o,s,l,a,i,u,f,c,p;return n=new H({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Cl]},$$scope:{ctx:r}}}),s=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Ll]},$$scope:{ctx:r}}}),f=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Tl]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Car/van availability data is from the 2021 census, via "),b(n.$$.fragment),o=v(". Output area boundaries from "),b(s.$$.fragment),l=v("."),a=D(),i=N("p"),u=v("License: "),b(f.$$.fragment),c=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(m,_){h(m,e,_),I(e,t),w(n,e,null),I(e,o),w(s,e,null),I(e,l),h(m,a,_),h(m,i,_),I(i,u),w(f,i,null),I(i,c),p=!0},p(m,_){const k={};_&65536&&(k.$$scope={dirty:_,ctx:m}),n.$set(k);const C={};_&65536&&(C.$$scope={dirty:_,ctx:m}),s.$set(C);const L={};_&65536&&(L.$$scope={dirty:_,ctx:m}),f.$set(L)},i(m){p||($(n.$$.fragment,m),$(s.$$.fragment,m),$(f.$$.fragment,m),p=!0)},o(m){g(n.$$.fragment,m),g(s.$$.fragment,m),g(f.$$.fragment,m),p=!1},d(m){m&&(d(e),d(a),d(i)),y(n),y(s),y(f)}}}function Al(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Ol]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function rn(r){let e,t;return e=new lt({props:{colorScale:r[4],limits:r[7]()}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p:ne,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function Dl(r){let e;return{c(){e=v("Average cars per household")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function El(r){let e;return{c(){e=v(`NOMIS TS045
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Il(r){let e;return{c(){e=v(`ONS Geography
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ml(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Pl(r){let e,t,n,o,s,l,a,i,u,f,c,p,m,_;return s=new H({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[El]},$$scope:{ctx:r}}}),a=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Il]},$$scope:{ctx:r}}}),p=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ml]},$$scope:{ctx:r}}}),{c(){e=N("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,t=D(),n=N("p"),o=v("Car/van availability data is from the 2021 census, via "),b(s.$$.fragment),l=v(". Output area boundaries from "),b(a.$$.fragment),i=v("."),u=D(),f=N("p"),c=v("License: "),b(p.$$.fragment),m=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(k,C){h(k,e,C),h(k,t,C),h(k,n,C),I(n,o),w(s,n,null),I(n,l),w(a,n,null),I(n,i),h(k,u,C),h(k,f,C),I(f,c),w(p,f,null),I(f,m),_=!0},p(k,C){const L={};C&65536&&(L.$$scope={dirty:C,ctx:k}),s.$set(L);const E={};C&65536&&(E.$$scope={dirty:C,ctx:k}),a.$set(E);const B={};C&65536&&(B.$$scope={dirty:C,ctx:k}),p.$set(B)},i(k){_||($(s.$$.fragment,k),$(a.$$.fragment,k),$(p.$$.fragment,k),_=!0)},o(k){g(s.$$.fragment,k),g(a.$$.fragment,k),g(p.$$.fragment,k),_=!1},d(k){k&&(d(e),d(t),d(n),d(u),d(f)),y(s),y(a),y(p)}}}function Nl(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Pl]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function nn(r){let e,t;return e=new lt({props:{colorScale:r[4],limits:r[7]()}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p:ne,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function Fl(r){let e;return{c(){e=v("Population density")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Bl(r){let e;return{c(){e=v(`NOMIS TS006
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function jl(r){let e;return{c(){e=v(`ONS Geography
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Rl(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ul(r){let e,t,n,o,s,l,a,i,u,f,c,p;return n=new H({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Bl]},$$scope:{ctx:r}}}),s=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[jl]},$$scope:{ctx:r}}}),f=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Rl]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Population density data is from the 2021 census, via "),b(n.$$.fragment),o=v(". Output area boundaries from "),b(s.$$.fragment),l=v("."),a=D(),i=N("p"),u=v("License: "),b(f.$$.fragment),c=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(m,_){h(m,e,_),I(e,t),w(n,e,null),I(e,o),w(s,e,null),I(e,l),h(m,a,_),h(m,i,_),I(i,u),w(f,i,null),I(i,c),p=!0},p(m,_){const k={};_&65536&&(k.$$scope={dirty:_,ctx:m}),n.$set(k);const C={};_&65536&&(C.$$scope={dirty:_,ctx:m}),s.$set(C);const L={};_&65536&&(L.$$scope={dirty:_,ctx:m}),f.$set(L)},i(m){p||($(n.$$.fragment,m),$(s.$$.fragment,m),$(f.$$.fragment,m),p=!0)},o(m){g(n.$$.fragment,m),g(s.$$.fragment,m),g(f.$$.fragment,m),p=!1},d(m){m&&(d(e),d(a),d(i)),y(n),y(s),y(f)}}}function Hl(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Ul]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&65536&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function on(r){let e,t,n,o;return n=new lt({props:{colorScale:r[4],limits:r[7]().map(Wl)}}),{c(){e=N("p"),e.textContent="(people per square kilometres)",t=D(),b(n.$$.fragment)},m(s,l){h(s,e,l),h(s,t,l),w(n,s,l),o=!0},p:ne,i(s){o||($(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(d(e),d(t)),y(n,s)}}}function zl(r){let e,t,n,o,s,l,a,i,u,f,c,p,m,_;function k(P){r[9](P)}let C={id:"percent_households_with_car",$$slots:{right:[Al],default:[Sl]},$$scope:{ctx:r}};r[0]!==void 0&&(C.checked=r[0]),e=new ae({props:C}),G.push(()=>X(e,"checked",k)),e.$on("change",r[10]);let L=r[3]=="percent_households_with_car"&&rn(r);function E(P){r[11](P)}let B={id:"average_cars_per_household",$$slots:{right:[Nl],default:[Dl]},$$scope:{ctx:r}};r[1]!==void 0&&(B.checked=r[1]),s=new ae({props:B}),G.push(()=>X(s,"checked",E)),s.$on("change",r[12]);let S=r[3]=="average_cars_per_household"&&nn(r);function A(P){r[13](P)}let j={id:"population_density",$$slots:{right:[Hl],default:[Fl]},$$scope:{ctx:r}};r[2]!==void 0&&(j.checked=r[2]),u=new ae({props:j}),G.push(()=>X(u,"checked",A)),u.$on("change",r[14]);let M=r[3]=="population_density"&&on(r);return m=new ie({props:{layer:We,tooltip:r[5],show:r[3]!="",clickable:!0}}),m.$on("click",r[6]),{c(){b(e.$$.fragment),n=D(),L&&L.c(),o=D(),b(s.$$.fragment),a=D(),S&&S.c(),i=D(),b(u.$$.fragment),c=D(),M&&M.c(),p=D(),b(m.$$.fragment)},m(P,T){w(e,P,T),h(P,n,T),L&&L.m(P,T),h(P,o,T),w(s,P,T),h(P,a,T),S&&S.m(P,T),h(P,i,T),w(u,P,T),h(P,c,T),M&&M.m(P,T),h(P,p,T),w(m,P,T),_=!0},p(P,[T]){const O={};T&65536&&(O.$$scope={dirty:T,ctx:P}),!t&&T&1&&(t=!0,O.checked=P[0],Y(()=>t=!1)),e.$set(O),P[3]=="percent_households_with_car"?L?(L.p(P,T),T&8&&$(L,1)):(L=rn(P),L.c(),$(L,1),L.m(o.parentNode,o)):L&&(me(),g(L,1,1,()=>{L=null}),he());const U={};T&65536&&(U.$$scope={dirty:T,ctx:P}),!l&&T&2&&(l=!0,U.checked=P[1],Y(()=>l=!1)),s.$set(U),P[3]=="average_cars_per_household"?S?(S.p(P,T),T&8&&$(S,1)):(S=nn(P),S.c(),$(S,1),S.m(i.parentNode,i)):S&&(me(),g(S,1,1,()=>{S=null}),he());const z={};T&65536&&(z.$$scope={dirty:T,ctx:P}),!f&&T&4&&(f=!0,z.checked=P[2],Y(()=>f=!1)),u.$set(z),P[3]=="population_density"?M?(M.p(P,T),T&8&&$(M,1)):(M=on(P),M.c(),$(M,1),M.m(p.parentNode,p)):M&&(me(),g(M,1,1,()=>{M=null}),he());const W={};T&8&&(W.show=P[3]!=""),m.$set(W)},i(P){_||($(e.$$.fragment,P),$(L),$(s.$$.fragment,P),$(S),$(u.$$.fragment,P),$(M),$(m.$$.fragment,P),_=!0)},o(P){g(e.$$.fragment,P),g(L),g(s.$$.fragment,P),g(S),g(u.$$.fragment,P),g(M),g(m.$$.fragment,P),_=!1},d(P){P&&(d(n),d(o),d(a),d(i),d(c),d(p)),y(e,P),L&&L.d(P),y(s,P),S&&S.d(P),y(u,P),M&&M.d(P),y(m,P)}}}let We="census_output_areas";const Wl=r=>r.toLocaleString();function xl(r,e,t){let n;V(r,ue,B=>t(8,n=B));let o=`${We}-outline`,s=q.sequential_low_to_high,l=!1,a=!1,i=!1,u="";ke(n,We,`${$e()}/v1/${We}.pmtiles`),_t(n,{id:We,source:We,sourceLayer:We,color:"black",opacity:De(.5,.7)}),Ne(n,{id:o,source:We,sourceLayer:We,color:"black",width:.5});function f(B){let S=B.properties.OA21CD,A=B.properties[u];return u=="percent_households_with_car"?`<p>${A}% of households in ${S} have 1 or more cars</p>`:u=="average_cars_per_household"?`<p>Households in ${S} have an average of ${A} cars</p>`:`<p>There are ${A.toLocaleString()} people per square kilometre in ${S}</p>`}function c(B){let S=B.detail.properties.OA21CD;u=="percent_households_with_car"||u=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${S}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${S}`,"_blank")}function p(){return u=="percent_households_with_car"?[0,20,40,60,80,100]:u=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function m(B){l=B,t(0,l)}const _=()=>{t(1,a=!1),t(2,i=!1)};function k(B){a=B,t(1,a)}const C=()=>{t(0,l=!1),t(2,i=!1)};function L(B){i=B,t(2,i)}const E=()=>{t(0,l=!1),t(1,a=!1)};return r.$$.update=()=>{r.$$.dirty&271&&(l?t(3,u="percent_households_with_car"):a?t(3,u="average_cars_per_household"):i?t(3,u="population_density"):t(3,u=""),u?(n.setPaintProperty(We,"fill-color",it(["get",u],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[l,a,i,u,s,f,c,p,n,m,_,k,C,L,E]}class Vl extends Z{constructor(e){super(),K(this,e,xl,zl,x,{})}}function Gl(r){let e,t,n;return e=new Ee({props:{color:r[2]}}),{c(){b(e.$$.fragment),t=v(`
  Combined authorities`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function Zl(r){let e;return{c(){e=v(`ONS Geography
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Kl(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function ql(r){let e,t,n,o,s,l,a,i,u,f;return n=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Zl]},$$scope:{ctx:r}}}),i=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Kl]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Data from "),b(n.$$.fragment),o=v(", as of December 2022."),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment),u=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(c,p){h(c,e,p),I(e,t),w(n,e,null),I(e,o),h(c,s,p),h(c,l,p),I(l,a),w(i,l,null),I(l,u),f=!0},p(c,p){const m={};p&64&&(m.$$scope={dirty:p,ctx:c}),n.$set(m);const _={};p&64&&(_.$$scope={dirty:p,ctx:c}),i.$set(_)},i(c){f||($(n.$$.fragment,c),$(i.$$.fragment,c),f=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),f=!1},d(c){c&&(d(e),d(s),d(l)),y(n),y(i)}}}function Xl(r){let e,t,n;return t=new ce({props:{$$slots:{default:[ql]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function Yl(r){let e,t=r[5][0].properties.name+"",n;return{c(){e=N("p"),n=v(t)},m(o,s){h(o,e,s),I(e,n)},p(o,s){s&32&&t!==(t=o[5][0].properties.name+"")&&Pe(n,t)},d(o){o&&d(e)}}}function Jl(r){let e,t;return e=new Ko({props:{openOn:"hover",$$slots:{default:[Yl,({features:n})=>({5:n}),({features:n})=>n?32:0]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,o){const s={};o&96&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function Ql(r){let e,t,n,o;return e=new Bo({props:{id:Mt,paint:{"fill-color":r[2],"fill-opacity":Do(0,.5)},layout:{visibility:r[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[Jl]},$$scope:{ctx:r}}}),e.$on("click",ta),n=new xo({props:{id:r[3],paint:{"line-color":r[2],"line-width":2.5},layout:{visibility:r[1]}}}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment)},m(s,l){w(e,s,l),h(s,t,l),w(n,s,l),o=!0},p(s,l){const a={};l&2&&(a.layout={visibility:s[1]}),l&64&&(a.$$scope={dirty:l,ctx:s}),e.$set(a);const i={};l&2&&(i.layout={visibility:s[1]}),n.$set(i)},i(s){o||($(e.$$.fragment,s),$(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&d(t),y(e,s),y(n,s)}}}function ea(r){let e,t,n,o,s;function l(i){r[4](i)}let a={id:Mt,$$slots:{right:[Xl],default:[Gl]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new Uo({props:{id:Mt,data:`${$e()}/v1/${Mt}.geojson`,$$slots:{default:[Ql]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&64&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&66&&(c.$$scope={dirty:u,ctx:i}),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let Mt="combined_authorities";function ta(r){window.open(`https://www.ons.gov.uk/visualisations/areas/${r.detail.features[0].properties.CAUTH22CD}`,"_blank")}function ra(r,e,t){let n,o=q.combined_authorities,s=`${Mt}-outline`,l=!1;function a(i){l=i,t(0,l)}return r.$$.update=()=>{r.$$.dirty&1&&t(1,n=l?"visible":"none")},[l,n,o,s,a]}class na extends Z{constructor(e){super(),K(this,e,ra,ea,x,{})}}function oa(r){let e,t,n;return{c(){e=N("input"),ee(e,"class","govuk-file-upload"),ee(e,"id","load-criticals"),ee(e,"type","file")},m(o,s){h(o,e,s),r[7](e),t||(n=br(e,"change",r[4]),t=!0)},p:ne,d(o){o&&d(e),r[7](null),t=!1,n()}}}function sn(r){let e,t;return e=new jt({props:{small:!0,$$slots:{default:[ia]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function sa(r){let e,t,n=r[2].toLocaleString()+"",o,s,l;return e=new Ee({props:{color:dr}}),{c(){b(e.$$.fragment),t=v(`
        Show `),o=v(n),s=v(" issues")},m(a,i){w(e,a,i),h(a,t,i),h(a,o,i),h(a,s,i),l=!0},p(a,i){(!l||i&4)&&n!==(n=a[2].toLocaleString()+"")&&Pe(o,n)},i(a){l||($(e.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),l=!1},d(a){a&&(d(t),d(o),d(s)),y(e,a)}}}function ia(r){let e,t,n;function o(l){r[8](l)}let s={id:"show-criticals",$$slots:{default:[sa]},$$scope:{ctx:r}};return r[0]!==void 0&&(s.checked=r[0]),e=new ae({props:s}),G.push(()=>X(e,"checked",o)),{c(){b(e.$$.fragment)},m(l,a){w(e,l,a),n=!0},p(l,a){const i={};a&516&&(i.$$scope={dirty:a,ctx:l}),!t&&a&1&&(t=!0,i.checked=l[0],Y(()=>t=!1)),e.$set(i)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){g(e.$$.fragment,l),n=!1},d(l){y(e,l)}}}function la(r){let e,t,n,o,s,l;e=new kn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[oa]},$$scope:{ctx:r}}}),n=new Cn({props:{errorMessage:r[3]}});let a=r[2]>0&&sn(r);return{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),a&&a.c(),s=Qe()},m(i,u){w(e,i,u),h(i,t,u),w(n,i,u),h(i,o,u),a&&a.m(i,u),h(i,s,u),l=!0},p(i,u){const f={};u&514&&(f.$$scope={dirty:u,ctx:i}),e.$set(f);const c={};u&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?a?(a.p(i,u),u&4&&$(a,1)):(a=sn(i),a.c(),$(a,1),a.m(s.parentNode,s)):a&&(me(),g(a,1,1,()=>{a=null}),he())},i(i){l||($(e.$$.fragment,i),$(n.$$.fragment,i),$(a),l=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(a),l=!1},d(i){i&&(d(t),d(o),d(s)),y(e,i),y(n,i),a&&a.d(i)}}}function aa(r){let e,t,n,o,s,l;return e=new Ye({props:{label:"Critical Issues",$$slots:{default:[la]},$$scope:{ctx:r}}}),n=new ie({props:{layer:ye+"-points",tooltip:fa,show:r[0],clickable:!1}}),s=new ie({props:{layer:ye+"-clusters",show:r[0],clickable:!0,ignoreHigherLayers:[ye+"-counts"]}}),s.$on("click",r[5]),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),b(s.$$.fragment)},m(a,i){w(e,a,i),h(a,t,i),w(n,a,i),h(a,o,i),w(s,a,i),l=!0},p(a,[i]){const u={};i&527&&(u.$$scope={dirty:i,ctx:a}),e.$set(u);const f={};i&1&&(f.show=a[0]),n.$set(f);const c={};i&1&&(c.show=a[0]),s.$set(c)},i(a){l||($(e.$$.fragment,a),$(n.$$.fragment,a),$(s.$$.fragment,a),l=!0)},o(a){g(e.$$.fragment,a),g(n.$$.fragment,a),g(s.$$.fragment,a),l=!1},d(a){a&&(d(t),d(o)),y(e,a),y(n,a),y(s,a)}}}let ye="criticals",dr="red";function fa(r){let e='<div style="max-width: 30vw;">';return e+=`<h2>${r.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${r.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${r.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${r.properties.id}</b></p>`,e+=`<p>Submitted by <b>${r.properties.inspector??"???"}</b> at <b>${r.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${r.properties.scheme_reference}</b> in stage <b>${r.properties.current_design_stage}</b></p>`,e+="</div>",e}function ua(r,e,t){let n;V(r,ue,p=>t(6,n=p));let o,s=!0,l=0,a="";uo(n,ye),n.addSource(ye,{type:"geojson",data:Sn(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),St(n,{id:`${ye}-clusters`,source:ye,filter:["has","point_count"],color:dr,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${ye}-counts`,source:ye,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),St(n,{id:`${ye}-points`,source:ye,filter:["!",["has","point_count"]],color:dr,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let m=await tl(o.files[0]);n.getSource(ye).setData(m),t(2,l=m.features.length),t(3,a="")}catch(m){t(3,a=`The file you loaded is broken: ${m}`)}}function u(p){n.getSource(ye).getClusterExpansionZoom(p.detail.properties.cluster_id,(m,_)=>{m||n.easeTo({center:p.detail.geometry.coordinates,zoom:_})})}function f(p){G[p?"unshift":"push"](()=>{o=p,t(1,o)})}function c(p){s=p,t(0,s)}return r.$$.update=()=>{r.$$.dirty&65&&n.getLayer(`${ye}-counts`)&&n.setLayoutProperty(`${ye}-counts`,"visibility",s?"visible":"none")},[s,o,l,a,i,u,n,f,c]}class ca extends Z{constructor(e){super(),K(this,e,ua,aa,x,{})}}function pa(r){let e,t,n;return e=new Ee({props:{color:r[2]}}),{c(){b(e.$$.fragment),t=v(`
  Crossings`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function ma(r){let e;return{c(){e=v("crossing")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function ha(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function da(r){let e,t,n,o,s,l,a,i,u;return n=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[ma]},$$scope:{ctx:r}}}),i=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ha]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("This shows "),b(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment)},m(f,c){h(f,e,c),I(e,t),w(n,e,null),I(e,o),h(f,s,c),h(f,l,c),I(l,a),w(i,l,null),u=!0},p(f,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:f}),n.$set(p);const m={};c&64&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||($(n.$$.fragment,f),$(i.$$.fragment,f),u=!0)},o(f){g(n.$$.fragment,f),g(i.$$.fragment,f),u=!1},d(f){f&&(d(e),d(s),d(l)),y(n),y(i)}}}function $a(r){let e,t,n;return t=new ce({props:{$$slots:{default:[da]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function ga(r){let e,t,n,o,s;function l(i){r[3](i)}let a={id:tt,$$slots:{right:[$a],default:[pa]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:tt,tooltip:r[1],show:r[0],clickable:!0}}),o.$on("click",_a),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&64&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}const tt="crossings";function _a(r){window.open(`http://openstreetmap.org/node/${r.detail.properties.osm_id}`,"_blank")}function ba(r,e,t){let n;V(r,ue,u=>t(4,n=u));let o=!1;function s(u){const f=u.properties.crossing;return`<p>${l.get(f)??`Crossing with unknown type (${f})`}. Click for details.</p>`}const l=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);ke(n,tt,`${$e()}/v1/${tt}.pmtiles`);let a=q[tt];St(n,{id:tt,source:tt,sourceLayer:tt,color:a,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(u){o=u,t(0,o)}return[o,s,a,i]}class wa extends Z{constructor(e){super(),K(this,e,ba,ga,x,{})}}function ya(r){let e,t,n;return e=new Ee({props:{color:r[1]}}),{c(){b(e.$$.fragment),t=v(`
  Cycle parking`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function va(r){let e;return{c(){e=v("OpenStreetMap")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function ka(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Sa(r){let e,t,n,o,s,l,a,i,u;return n=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[va]},$$scope:{ctx:r}}}),i=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ka]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Cycle parking, according to "),b(n.$$.fragment),o=v(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment)},m(f,c){h(f,e,c),I(e,t),w(n,e,null),I(e,o),h(f,s,c),h(f,l,c),I(l,a),w(i,l,null),u=!0},p(f,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:f}),n.$set(p);const m={};c&16&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||($(n.$$.fragment,f),$(i.$$.fragment,f),u=!0)},o(f){g(n.$$.fragment,f),g(i.$$.fragment,f),u=!1},d(f){f&&(d(e),d(s),d(l)),y(n),y(i)}}}function Ca(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Sa]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function La(r){let e,t,n,o,s;function l(i){r[2](i)}let a={id:ft,$$slots:{right:[Ca],default:[ya]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:ft,tooltip:Ta,show:r[0],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&16&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let ft="cycle_parking";function Ta(r){return`<p>Capacity: ${r.properties.capacity??"unknown"}</p>`}function Oa(r,e,t){let n;V(r,ue,a=>t(3,n=a));let o=q.cycle_parking;ke(n,ft,`${$e()}/v1/${ft}.pmtiles`),St(n,{id:ft,source:ft,sourceLayer:ft,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function l(a){s=a,t(0,s)}return[s,o,l]}class Aa extends Z{constructor(e){super(),K(this,e,Oa,La,x,{})}}function ln(r,e,t){const n=r.slice();return n[4]=e[t][0],n[5]=e[t][1],n}function Da(r){let e;return{c(){e=v("Cycle paths")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ea(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ia(r){let e,t,n,o,s,l,a,i,u,f;return u=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ea]},$$scope:{ctx:r}}}),{c(){e=N("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,t=D(),n=N("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=D(),s=N("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,l=D(),a=N("p"),i=v("License: "),b(u.$$.fragment)},m(c,p){h(c,e,p),h(c,t,p),h(c,n,p),h(c,o,p),h(c,s,p),h(c,l,p),h(c,a,p),I(a,i),w(u,a,null),f=!0},p(c,p){const m={};p&256&&(m.$$scope={dirty:p,ctx:c}),u.$set(m)},i(c){f||($(u.$$.fragment,c),f=!0)},o(c){g(u.$$.fragment,c),f=!1},d(c){c&&(d(e),d(t),d(n),d(o),d(s),d(l),d(a)),y(u)}}}function Ma(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Ia]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function an(r){let e,t,n=st(r[1]),o=[];for(let l=0;l<n.length;l+=1)o[l]=fn(ln(r,n,l));const s=l=>g(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=Qe()},m(l,a){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,a);h(l,e,a),t=!0},p(l,a){if(a&2){n=st(l[1]);let i;for(i=0;i<n.length;i+=1){const u=ln(l,n,i);o[i]?(o[i].p(u,a),$(o[i],1)):(o[i]=fn(u),o[i].c(),$(o[i],1),o[i].m(e.parentNode,e))}for(me(),i=n.length;i<o.length;i+=1)s(i);he()}},i(l){if(!t){for(let a=0;a<n.length;a+=1)$(o[a]);t=!0}},o(l){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)g(o[a]);t=!1},d(l){l&&d(e),Vt(o,l)}}}function fn(r){let e,t,n,o=r[4]+"",s,l,a;return t=new Ee({props:{color:r[5]}}),{c(){e=N("div"),b(t.$$.fragment),n=D(),s=v(o),l=D()},m(i,u){h(i,e,u),w(t,e,null),I(e,n),I(e,s),I(e,l),a=!0},p:ne,i(i){a||($(t.$$.fragment,i),a=!0)},o(i){g(t.$$.fragment,i),a=!1},d(i){i&&d(e),y(t)}}}function Pa(r){let e,t,n,o,s,l;function a(f){r[2](f)}let i={id:ut,$$slots:{right:[Ma],default:[Da]},$$scope:{ctx:r}};r[0]!==void 0&&(i.checked=r[0]),e=new ae({props:i}),G.push(()=>X(e,"checked",a));let u=r[0]&&an(r);return s=new ie({props:{layer:ut,tooltip:Na,show:r[0],clickable:!0}}),s.$on("click",Fa),{c(){b(e.$$.fragment),n=D(),u&&u.c(),o=D(),b(s.$$.fragment)},m(f,c){w(e,f,c),h(f,n,c),u&&u.m(f,c),h(f,o,c),w(s,f,c),l=!0},p(f,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:f}),!t&&c&1&&(t=!0,p.checked=f[0],Y(()=>t=!1)),e.$set(p),f[0]?u?(u.p(f,c),c&1&&$(u,1)):(u=an(f),u.c(),$(u,1),u.m(o.parentNode,o)):u&&(me(),g(u,1,1,()=>{u=null}),he());const m={};c&1&&(m.show=f[0]),s.$set(m)},i(f){l||($(e.$$.fragment,f),$(u),$(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(u),g(s.$$.fragment,f),l=!1},d(f){f&&(d(n),d(o)),y(e,f),u&&u.d(f),y(s,f)}}}let ut="cycle_paths";function Na(r){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[r.properties.kind],t={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[r.properties.direction],n=r.properties.width=="unknown"?"unknown":`${r.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${t} ${r.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Fa(r){window.open(`http://openstreetmap.org/way/${r.detail.properties.osm_id}`,"_blank")}function Ba(r,e,t){let n;V(r,ue,a=>t(3,n=a));let o=[["Separated tracks",q.cycle_paths.track],["Unprotected lanes",q.cycle_paths.lane],["Shared-use (segregated)",q.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",q.cycle_paths.shared_use_unsegregated]];ke(n,ut,`${$e()}/v1/${ut}.pmtiles`),Ne(n,{id:ut,source:ut,sourceLayer:ut,color:vn(["get","kind"],{track:q.cycle_paths.track,lane:q.cycle_paths.lane,shared_use_segregated:q.cycle_paths.shared_use_segregated,shared_use_unsegregated:q.cycle_paths.shared_use_unsegregated},"red"),width:Yt,opacity:De(.5,1)});let s=!1;function l(a){s=a,t(0,s)}return[s,o,l]}class ja extends Z{constructor(e){super(),K(this,e,Ba,Pa,x,{})}}function Ra(r){let e,t,n,o;return e=new Ee({props:{color:r[3]}}),{c(){b(e.$$.fragment),t=D(),n=v(r[1])},m(s,l){w(e,s,l),h(s,t,l),h(s,n,l),o=!0},p(s,l){(!o||l&2)&&Pe(n,s[1])},i(s){o||($(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(d(t),d(n)),y(e,s)}}}function Ua(r){let e;const t=r[6].default,n=Ct(t,r,r[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&Lt(n,t,o,o[8],e?Ot(t,o[8],s,null):Tt(o[8]),null)},i(o){e||($(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Ha(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Ua]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function za(r){let e,t,n,o,s;function l(i){r[7](i)}let a={id:r[0],$$slots:{right:[Ha],default:[Ra]},$$scope:{ctx:r}};return r[2]!==void 0&&(a.checked=r[2]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:r[0],tooltip:r[4],show:r[2],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&1&&(f.id=i[0]),u&258&&(f.$$scope={dirty:u,ctx:i}),!t&&u&4&&(t=!0,f.checked=i[2],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.layer=i[0]),u&4&&(c.show=i[2]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}function Wa(r,e,t){let n;V(r,ue,m=>t(9,n=m));let{$$slots:o={},$$scope:s}=e,{name:l}=e,{singularNoun:a}=e,{pluralNoun:i}=e,u=q[l];ke(n,l,`${$e()}/v1/${l}.pmtiles`),_t(n,{id:l,source:l,sourceLayer:l,color:u,opacity:De(1,.7)});let f=!1;function c(m){return`<p>${m.properties.name??`Unnamed ${a}`}</p>`}function p(m){f=m,t(2,f)}return r.$$set=m=>{"name"in m&&t(0,l=m.name),"singularNoun"in m&&t(5,a=m.singularNoun),"pluralNoun"in m&&t(1,i=m.pluralNoun),"$$scope"in m&&t(8,s=m.$$scope)},[l,i,f,u,c,a,o,p,s]}class vr extends Z{constructor(e){super(),K(this,e,Wa,za,x,{name:0,singularNoun:5,pluralNoun:1})}}function xa(r){let e;return{c(){e=v("hospital")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Va(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ga(r){let e,t,n,o,s,l,a,i,u;return n=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[xa]},$$scope:{ctx:r}}}),i=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Va]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("This shows "),b(n.$$.fragment),o=v(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment)},m(f,c){h(f,e,c),I(e,t),w(n,e,null),I(e,o),h(f,s,c),h(f,l,c),I(l,a),w(i,l,null),u=!0},p(f,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:f}),n.$set(p);const m={};c&1&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||($(n.$$.fragment,f),$(i.$$.fragment,f),u=!0)},o(f){g(n.$$.fragment,f),g(i.$$.fragment,f),u=!1},d(f){f&&(d(e),d(s),d(l)),y(n),y(i)}}}function Za(r){let e,t;return e=new vr({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Ga]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}class Ka extends Z{constructor(e){super(),K(this,e,null,Za,x,{})}}function qa(r){let e;return{c(){e=v("Indices of Multiple Deprivation")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Xa(r){let e;return{c(){e=v(`DLUCH GIS
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ya(r){let e;return{c(){e=v(`here
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ja(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Qa(r){let e,t,n,o,s,l,a,i,u,f,c,p;return n=new H({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[Xa]},$$scope:{ctx:r}}}),s=new H({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[Ya]},$$scope:{ctx:r}}}),f=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ja]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("The 2019 English IMD scores come from "),b(n.$$.fragment),o=v(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),b(s.$$.fragment),l=v("."),a=D(),i=N("p"),u=v("License: "),b(f.$$.fragment),c=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(m,_){h(m,e,_),I(e,t),w(n,e,null),I(e,o),w(s,e,null),I(e,l),h(m,a,_),h(m,i,_),I(i,u),w(f,i,null),I(i,c),p=!0},p(m,_){const k={};_&64&&(k.$$scope={dirty:_,ctx:m}),n.$set(k);const C={};_&64&&(C.$$scope={dirty:_,ctx:m}),s.$set(C);const L={};_&64&&(L.$$scope={dirty:_,ctx:m}),f.$set(L)},i(m){p||($(n.$$.fragment,m),$(s.$$.fragment,m),$(f.$$.fragment,m),p=!0)},o(m){g(n.$$.fragment,m),g(s.$$.fragment,m),g(f.$$.fragment,m),p=!1},d(m){m&&(d(e),d(a),d(i)),y(n),y(s),y(f)}}}function ef(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Qa]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function un(r){let e,t;return e=new lt({props:{colorScale:r[1],limits:["Least deprived","Most deprived"]}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p:ne,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function tf(r){let e,t,n,o,s,l;function a(f){r[3](f)}let i={id:xe,$$slots:{right:[ef],default:[qa]},$$scope:{ctx:r}};r[0]!==void 0&&(i.checked=r[0]),e=new ae({props:i}),G.push(()=>X(e,"checked",a));let u=r[0]&&un(r);return s=new ie({props:{layer:xe,tooltip:rf,show:r[0],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),u&&u.c(),o=D(),b(s.$$.fragment)},m(f,c){w(e,f,c),h(f,n,c),u&&u.m(f,c),h(f,o,c),w(s,f,c),l=!0},p(f,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:f}),!t&&c&1&&(t=!0,p.checked=f[0],Y(()=>t=!1)),e.$set(p),f[0]?u?(u.p(f,c),c&1&&$(u,1)):(u=un(f),u.c(),$(u,1),u.m(o.parentNode,o)):u&&(me(),g(u,1,1,()=>{u=null}),he());const m={};c&1&&(m.show=f[0]),s.$set(m)},i(f){l||($(e.$$.fragment,f),$(u),$(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(u),g(s.$$.fragment,f),l=!1},d(f){f&&(d(n),d(o)),y(e,f),u&&u.d(f),y(s,f)}}}let xe="imd";function rf(r){return`<p>${r.properties.LSOA11CD} has an IMD score of <b>${r.properties.score}</b></p><p>Rank: <b>${r.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function nf(r,e,t){let n;V(r,ue,u=>t(2,n=u));let o=`${xe}-outline`,s=q.sequential_low_to_high,l=[0,2,4,6,8,10];ke(n,xe,`${$e()}/v1/${xe}.pmtiles`),_t(n,{id:xe,source:xe,sourceLayer:xe,color:it(["-",10,["get","decile"]],l,s),opacity:De(.5,.7)}),Ne(n,{id:o,source:xe,sourceLayer:xe,color:"black",width:.5});let a=!1;function i(u){a=u,t(0,a)}return r.$$.update=()=>{r.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",a?"visible":"none")},[a,s,n,i]}class of extends Z{constructor(e){super(),K(this,e,nf,tf,x,{})}}function sf(r){let e,t,n;return e=new Ee({props:{color:r[1]}}),{c(){b(e.$$.fragment),t=v(`
  Local Authority Districts`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function lf(r){let e;return{c(){e=v(`ONS Geography
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function af(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function ff(r){let e,t,n,o,s,l,a,i,u,f;return n=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[lf]},$$scope:{ctx:r}}}),i=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[af]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Data from "),b(n.$$.fragment),o=v(", as of May 2023."),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment),u=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(c,p){h(c,e,p),I(e,t),w(n,e,null),I(e,o),h(c,s,p),h(c,l,p),I(l,a),w(i,l,null),I(l,u),f=!0},p(c,p){const m={};p&32&&(m.$$scope={dirty:p,ctx:c}),n.$set(m);const _={};p&32&&(_.$$scope={dirty:p,ctx:c}),i.$set(_)},i(c){f||($(n.$$.fragment,c),$(i.$$.fragment,c),f=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),f=!1},d(c){c&&(d(e),d(s),d(l)),y(n),y(i)}}}function uf(r){let e,t,n;return t=new ce({props:{$$slots:{default:[ff]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function cf(r){let e,t,n,o,s;function l(i){r[3](i)}let a={id:rt,$$slots:{right:[uf],default:[sf]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:rt,tooltip:pf,show:r[0],clickable:!0}}),o.$on("click",mf),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&32&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let rt="local_authority_districts";function pf(r){return`<p>${r.properties.name}</p>`}function mf(r){window.open(`https://www.ons.gov.uk/visualisations/areas/${r.detail.properties.LAD23CD}`,"_blank")}function hf(r,e,t){let n;V(r,ue,i=>t(2,n=i));let o=q.local_authority_districts,s=`${rt}-outline`;Ln(n,rt,`${$e()}/v1/${rt}.geojson`),_t(n,{id:rt,source:rt,color:o,opacity:De(.5,0)}),Ne(n,{id:s,source:rt,color:o,width:2.5});let l=!1;function a(i){l=i,t(0,l)}return r.$$.update=()=>{r.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,a]}class df extends Z{constructor(e){super(),K(this,e,hf,cf,x,{})}}function $f(r){let e,t,n;return e=new Ee({props:{color:r[1]}}),{c(){b(e.$$.fragment),t=v(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function gf(r){let e;return{c(){e=v(`local authority
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function _f(r){let e;return{c(){e=v(`national park authorit
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function bf(r){let e;return{c(){e=v(`development corporation
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function wf(r){let e;return{c(){e=v("this map")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function yf(r){let e;return{c(){e=v(`planning.data.gov.uk
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function vf(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function kf(r){let e,t,n,o,s,l,a,i,u,f,c,p,m,_,k,C,L,E,B,S,A,j,M,P,T;return n=new H({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[gf]},$$scope:{ctx:r}}}),s=new H({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[_f]},$$scope:{ctx:r}}}),a=new H({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[bf]},$$scope:{ctx:r}}}),m=new H({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[wf]},$$scope:{ctx:r}}}),E=new H({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[yf]},$$scope:{ctx:r}}}),M=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[vf]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("LPAs may be a "),b(n.$$.fragment),o=v(", "),b(s.$$.fragment),l=v("y, or "),b(a.$$.fragment),i=v("."),u=D(),f=N("p"),c=N("strong"),p=v(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),b(m.$$.fragment),_=v(" to get more details."),k=D(),C=N("p"),L=v("Data from ONS Geography via "),b(E.$$.fragment),B=v(", as of November 2022."),S=D(),A=N("p"),j=v("License: "),b(M.$$.fragment),P=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(O,U){h(O,e,U),I(e,t),w(n,e,null),I(e,o),w(s,e,null),I(e,l),w(a,e,null),I(e,i),h(O,u,U),h(O,f,U),I(f,c),I(c,p),w(m,c,null),I(c,_),h(O,k,U),h(O,C,U),I(C,L),w(E,C,null),I(C,B),h(O,S,U),h(O,A,U),I(A,j),w(M,A,null),I(A,P),T=!0},p(O,U){const z={};U&32&&(z.$$scope={dirty:U,ctx:O}),n.$set(z);const W={};U&32&&(W.$$scope={dirty:U,ctx:O}),s.$set(W);const te={};U&32&&(te.$$scope={dirty:U,ctx:O}),a.$set(te);const pe={};U&32&&(pe.$$scope={dirty:U,ctx:O}),m.$set(pe);const J={};U&32&&(J.$$scope={dirty:U,ctx:O}),E.$set(J);const le={};U&32&&(le.$$scope={dirty:U,ctx:O}),M.$set(le)},i(O){T||($(n.$$.fragment,O),$(s.$$.fragment,O),$(a.$$.fragment,O),$(m.$$.fragment,O),$(E.$$.fragment,O),$(M.$$.fragment,O),T=!0)},o(O){g(n.$$.fragment,O),g(s.$$.fragment,O),g(a.$$.fragment,O),g(m.$$.fragment,O),g(E.$$.fragment,O),g(M.$$.fragment,O),T=!1},d(O){O&&(d(e),d(u),d(f),d(k),d(C),d(S),d(A)),y(n),y(s),y(a),y(m),y(E),y(M)}}}function Sf(r){let e,t,n;return t=new ce({props:{$$slots:{default:[kf]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function Cf(r){let e,t,n,o,s;function l(i){r[3](i)}let a={id:Ve,$$slots:{right:[Sf],default:[$f]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:Ve,tooltip:Lf,show:r[0],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&32&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let Ve="local_planning_authorities";function Lf(r){return`<p>${r.properties.name}</p>`}function Tf(r,e,t){let n;V(r,ue,i=>t(2,n=i));let o=q.local_planning_authorities,s=`${Ve}-outline`;ke(n,Ve,`${$e()}/v1/${Ve}.pmtiles`),_t(n,{id:Ve,source:Ve,sourceLayer:Ve,color:o,opacity:De(.5,0)}),Ne(n,{id:s,source:Ve,sourceLayer:Ve,color:o,width:2.5});let l=!1;function a(i){l=i,t(0,l)}return r.$$.update=()=>{r.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,a]}class Of extends Z{constructor(e){super(),K(this,e,Tf,Cf,x,{})}}function Af(r){let e,t,n;return e=new Ee({props:{color:r[1]}}),{c(){b(e.$$.fragment),t=v(`
  Major Road Network`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function Df(r){let e;return{c(){e=v(`Major Road Network
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ef(r){let e;return{c(){e=v("Open Government License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function If(r){let e,t,n,o,s,l,a,i,u;return n=new H({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Df]},$$scope:{ctx:r}}}),i=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ef]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Data from the "),b(n.$$.fragment),o=v(", as of September 2021."),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment)},m(f,c){h(f,e,c),I(e,t),w(n,e,null),I(e,o),h(f,s,c),h(f,l,c),I(l,a),w(i,l,null),u=!0},p(f,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:f}),n.$set(p);const m={};c&16&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||($(n.$$.fragment,f),$(i.$$.fragment,f),u=!0)},o(f){g(n.$$.fragment,f),g(i.$$.fragment,f),u=!1},d(f){f&&(d(e),d(s),d(l)),y(n),y(i)}}}function Mf(r){let e,t,n;return t=new ce({props:{$$slots:{default:[If]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&16&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function Pf(r){let e,t,n,o,s;function l(i){r[2](i)}let a={id:ct,$$slots:{right:[Mf],default:[Af]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:ct,tooltip:Nf,show:r[0],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&16&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let ct="mrn";function Nf(r){return`<p>${r.properties.name??"Unknown MRN road"}</p>`}function Ff(r,e,t){let n;V(r,ue,a=>t(3,n=a));let o=q.mrn;ke(n,ct,`${$e()}/v1/${ct}.pmtiles`),Ne(n,{id:ct,source:ct,sourceLayer:ct,color:o,width:7,opacity:De(.5,1)});let s=!1;function l(a){s=a,t(0,s)}return[s,o,l]}class Bf extends Z{constructor(e){super(),K(this,e,Ff,Pf,x,{})}}function jf(r){let e,t,n;return e=new Ee({props:{color:r[1]}}),{c(){b(e.$$.fragment),t=v(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function Rf(r){let e;return{c(){e=v(`Ordnance Survey Boundary-Line
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Uf(r){let e;return{c(){e=v("Open Government License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Hf(r){let e,t,n,o,s,l,a,i,u;return n=new H({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Rf]},$$scope:{ctx:r}}}),i=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Uf]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Data from "),b(n.$$.fragment),o=v(", as of May 2023."),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment)},m(f,c){h(f,e,c),I(e,t),w(n,e,null),I(e,o),h(f,s,c),h(f,l,c),I(l,a),w(i,l,null),u=!0},p(f,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:f}),n.$set(p);const m={};c&32&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||($(n.$$.fragment,f),$(i.$$.fragment,f),u=!0)},o(f){g(n.$$.fragment,f),g(i.$$.fragment,f),u=!1},d(f){f&&(d(e),d(s),d(l)),y(n),y(i)}}}function zf(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Hf]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function Wf(r){let e,t,n,o,s;function l(i){r[3](i)}let a={id:Ge,$$slots:{right:[zf],default:[jf]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:Ge,tooltip:xf,show:r[0],clickable:!0}}),o.$on("click",Vf),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&32&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let Ge="parliamentary_constituencies";function xf(r){return`<p>${r.properties.Name}</p>`}function Vf(r){let e=r.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function Gf(r,e,t){let n;V(r,ue,i=>t(2,n=i));let o=q.parliamentary_constituencies,s=`${Ge}-outline`;ke(n,Ge,`${$e()}/v1/${Ge}.pmtiles`),_t(n,{id:Ge,source:Ge,sourceLayer:Ge,color:o,opacity:De(.5,0)}),Ne(n,{id:s,source:Ge,sourceLayer:Ge,color:o,width:5});let l=!1;function a(i){l=i,t(0,l)}return r.$$.update=()=>{r.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,a]}class Zf extends Z{constructor(e){super(),K(this,e,Gf,Wf,x,{})}}function Kf(r){let e;return{c(){e=v("Propensity to Cycle Tool")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function qf(r){let e;return{c(){e=v("the PCT website")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Xf(r){let e;return{c(){e=v("2017 journal article")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Yf(r){let e,t,n,o,s,l,a,i,u,f,c;return a=new H({props:{href:"https://www.pct.bike",$$slots:{default:[qf]},$$scope:{ctx:r}}}),u=new H({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[Xf]},$$scope:{ctx:r}}}),{c(){e=N("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,t=D(),n=N("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=D(),s=N("p"),l=v("See "),b(a.$$.fragment),i=v(" and "),b(u.$$.fragment),f=v(" for details on methodology and data sources.")},m(p,m){h(p,e,m),h(p,t,m),h(p,n,m),h(p,o,m),h(p,s,m),I(s,l),w(a,s,null),I(s,i),w(u,s,null),I(s,f),c=!0},p(p,m){const _={};m&2048&&(_.$$scope={dirty:m,ctx:p}),a.$set(_);const k={};m&2048&&(k.$$scope={dirty:m,ctx:p}),u.$set(k)},i(p){c||($(a.$$.fragment,p),$(u.$$.fragment,p),c=!0)},o(p){g(a.$$.fragment,p),g(u.$$.fragment,p),c=!1},d(p){p&&(d(e),d(t),d(n),d(o),d(s)),y(a),y(u)}}}function Jf(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Yf]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&2048&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function cn(r){let e,t,n,o,s,l,a,i;e=new lt({props:{colorScale:r[3],limits:r[4]}});function u(m){r[8](m)}let f={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};r[0]!==void 0&&(f.value=r[0]),n=new Tn({props:f}),G.push(()=>X(n,"value",u)),n.$on("change",r[6]);function c(m){r[9](m)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return r[1]!==void 0&&(p.value=r[1]),l=new Gt({props:p}),G.push(()=>X(l,"value",c)),l.$on("change",r[6]),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),s=D(),b(l.$$.fragment)},m(m,_){w(e,m,_),h(m,t,_),w(n,m,_),h(m,s,_),w(l,m,_),i=!0},p(m,_){const k={};!o&&_&1&&(o=!0,k.value=m[0],Y(()=>o=!1)),n.$set(k);const C={};!a&&_&2&&(a=!0,C.value=m[1],Y(()=>a=!1)),l.$set(C)},i(m){i||($(e.$$.fragment,m),$(n.$$.fragment,m),$(l.$$.fragment,m),i=!0)},o(m){g(e.$$.fragment,m),g(n.$$.fragment,m),g(l.$$.fragment,m),i=!1},d(m){m&&(d(t),d(s)),y(e,m),y(n,m),y(l,m)}}}function Qf(r){let e,t,n,o,s,l,a,i;function u(p){r[7](p)}let f={id:$t,$$slots:{right:[Jf],default:[Kf]},$$scope:{ctx:r}};r[2]!==void 0&&(f.checked=r[2]),e=new ae({props:f}),G.push(()=>X(e,"checked",u));let c=r[2]&&cn(r);return s=new ie({props:{layer:$t,tooltip:r[5],show:r[2]&&r[0]==$t,clickable:!1}}),a=new ie({props:{layer:xt,tooltip:r[5],show:r[2]&&r[0]==xt,clickable:!1}}),{c(){b(e.$$.fragment),n=D(),c&&c.c(),o=D(),b(s.$$.fragment),l=D(),b(a.$$.fragment)},m(p,m){w(e,p,m),h(p,n,m),c&&c.m(p,m),h(p,o,m),w(s,p,m),h(p,l,m),w(a,p,m),i=!0},p(p,[m]){const _={};m&2048&&(_.$$scope={dirty:m,ctx:p}),!t&&m&4&&(t=!0,_.checked=p[2],Y(()=>t=!1)),e.$set(_),p[2]?c?(c.p(p,m),m&4&&$(c,1)):(c=cn(p),c.c(),$(c,1),c.m(o.parentNode,o)):c&&(me(),g(c,1,1,()=>{c=null}),he());const k={};m&5&&(k.show=p[2]&&p[0]==$t),s.$set(k);const C={};m&5&&(C.show=p[2]&&p[0]==xt),a.$set(C)},i(p){i||($(e.$$.fragment,p),$(c),$(s.$$.fragment,p),$(a.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(a.$$.fragment,p),i=!1},d(p){p&&(d(n),d(o),d(l)),y(e,p),c&&c.d(p),y(s,p),y(a,p)}}}let $t="pct_commute",xt="pct_school";function eu(r,e,t){let n;V(r,ue,_=>t(10,n=_));let o=q.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],l=$t,a="baseline";for(let _ of[$t,xt])ke(n,_,`${$e()}/v1/${_}.pmtiles`),Ne(n,{id:_,source:_,sourceLayer:_,color:it(["get",a],s,o),width:Yt,opacity:De(.5,1)});let i=!1;function u(_){let k=_.properties.baseline,C=_.properties.gov_target,L=_.properties.go_dutch,E=`<h2>Trip purpose: ${l==$t?"commuting":"school"}</h2>`;if(E+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)E+=`<p>Government target (2025): <b>${C.toLocaleString()}</b></p>`,E+=`<p>Go Dutch: <b>${L.toLocaleString()}</b></p>`;else{let B=(C/k).toFixed(1),S=(L/k).toFixed(1);E+=`<p>Government target (2025): ${C.toLocaleString()} (<b>${B}x</b> of baseline)</p>`,E+=`<p>Go Dutch: ${L.toLocaleString()} (<b>${S}x</b> of baseline)</p>`}return E}function f(){n.setPaintProperty(l,"line-color",it(["get",a],s,o))}function c(_){i=_,t(2,i)}function p(_){l=_,t(0,l)}function m(_){a=_,t(1,a)}return[l,a,i,o,s,u,f,c,p,m]}class tu extends Z{constructor(e){super(),K(this,e,eu,Qf,x,{})}}function ru(r){let e,t,n;return e=new Ee({props:{color:r[1]}}),{c(){b(e.$$.fragment),t=v(`
  Railway Stations`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function nu(r){let e;return{c(){e=v("railway station")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function ou(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function su(r){let e,t,n,o,s,l,a,i,u;return n=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[nu]},$$scope:{ctx:r}}}),i=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[ou]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("This shows "),b(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment)},m(f,c){h(f,e,c),I(e,t),w(n,e,null),I(e,o),h(f,s,c),h(f,l,c),I(l,a),w(i,l,null),u=!0},p(f,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:f}),n.$set(p);const m={};c&32&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||($(n.$$.fragment,f),$(i.$$.fragment,f),u=!0)},o(f){g(n.$$.fragment,f),g(i.$$.fragment,f),u=!1},d(f){f&&(d(e),d(s),d(l)),y(n),y(i)}}}function iu(r){let e,t,n;return t=new ce({props:{$$slots:{default:[su]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function lu(r){let e,t,n,o,s;function l(i){r[2](i)}let a={id:pt,$$slots:{right:[iu],default:[ru]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:pt,tooltip:au,show:r[0],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&32&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}const pt="railway_stations";function au(r){return`<p>${r.properties.name??"Unnamed railway station"}</p>`}function fu(r,e,t){let n;V(r,ue,i=>t(3,n=i));const o=`${$e()}/v1/${pt}.geojson`;let s=!1;Ln(n,pt,o);let l=q[pt];St(n,{id:pt,source:pt,color:l,radius:ko/2});function a(i){s=i,t(0,s)}return[s,l,a]}class uu extends Z{constructor(e){super(),K(this,e,fu,lu,x,{})}}function cu(r){let e;return{c(){e=v("OS Speeds")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function pu(r){let e;return{c(){e=v("Basemap")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function mu(r){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function hu(r){let e,t,n,o,s,l,a,i,u,f,c,p;return n=new H({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[pu]},$$scope:{ctx:r}}}),f=new H({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[mu]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("The average speed data is collected over a six-month period by "),b(n.$$.fragment),o=v(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=D(),l=N("p"),l.textContent="Data valid as of 1 September, 2023",a=D(),i=N("p"),u=v(`License: Contains OS data  Crown copyright and database right
        2023. Made available under the `),b(f.$$.fragment),c=v(".")},m(m,_){h(m,e,_),I(e,t),w(n,e,null),I(e,o),h(m,s,_),h(m,l,_),h(m,a,_),h(m,i,_),I(i,u),w(f,i,null),I(i,c),p=!0},p(m,_){const k={};_&256&&(k.$$scope={dirty:_,ctx:m}),n.$set(k);const C={};_&256&&(C.$$scope={dirty:_,ctx:m}),f.$set(C)},i(m){p||($(n.$$.fragment,m),$(f.$$.fragment,m),p=!0)},o(m){g(n.$$.fragment,m),g(f.$$.fragment,m),p=!1},d(m){m&&(d(e),d(s),d(l),d(a),d(i)),y(n),y(f)}}}function du(r){let e,t,n;return t=new ce({props:{$$slots:{default:[hu]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&256&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function pn(r){let e,t,n,o,s;e=new lt({props:{colorScale:r[2],limits:r[3]}});function l(i){r[6](i)}let a={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return r[0]!==void 0&&(a.value=r[0]),n=new Tn({props:a}),G.push(()=>X(n,"value",l)),n.$on("change",r[4]),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment)},m(i,u){w(e,i,u),h(i,t,u),w(n,i,u),s=!0},p(i,u){const f={};!o&&u&1&&(o=!0,f.value=i[0],Y(()=>o=!1)),n.$set(f)},i(i){s||($(e.$$.fragment,i),$(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&d(t),y(e,i),y(n,i)}}}function $u(r){let e,t,n,o,s,l;function a(f){r[5](f)}let i={id:nt,$$slots:{right:[du],default:[cu]},$$scope:{ctx:r}};r[1]!==void 0&&(i.checked=r[1]),e=new ae({props:i}),G.push(()=>X(e,"checked",a));let u=r[1]&&pn(r);return s=new ie({props:{layer:nt,tooltip:gu,show:r[1],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),u&&u.c(),o=D(),b(s.$$.fragment)},m(f,c){w(e,f,c),h(f,n,c),u&&u.m(f,c),h(f,o,c),w(s,f,c),l=!0},p(f,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:f}),!t&&c&2&&(t=!0,p.checked=f[1],Y(()=>t=!1)),e.$set(p),f[1]?u?(u.p(f,c),c&2&&$(u,1)):(u=pn(f),u.c(),$(u,1),u.m(o.parentNode,o)):u&&(me(),g(u,1,1,()=>{u=null}),he());const m={};c&2&&(m.show=f[1]),s.$set(m)},i(f){l||($(e.$$.fragment,f),$(u),$(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(u),g(s.$$.fragment,f),l=!1},d(f){f&&(d(n),d(o)),y(e,f),u&&u.d(f),y(s,f)}}}let nt="road_speeds";function gu(r){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[r.properties.highest_description],t=`<p>Posted speed limit: ${r.properties.indicative_mph} mph</p>`;return t+=`<p>Highest average speed: ${r.properties.highest_mph} mph (during ${e})</p>`,t}function _u(r,e,t){let n;V(r,ue,c=>t(7,n=c));let o=q.sequential_low_to_high,s=[0,20,30,40,50,90],l="indicative_mph";ke(n,nt,`${wr()}/v1/${nt}.pmtiles`),Ne(n,{id:nt,source:nt,sourceLayer:nt,color:it(["get",l],s,o),width:Yt,opacity:De(.5,1)});let a=!1;function i(){n.setPaintProperty(nt,"line-color",it(["get",l],s,o))}function u(c){a=c,t(1,a)}function f(c){l=c,t(0,l)}return[l,a,o,s,i,u,f]}class bu extends Z{constructor(e){super(),K(this,e,_u,$u,x,{})}}function wu(r){let e;return{c(){e=v("OS Road widths")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function yu(r){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function vu(r){let e,t,n,o,s,l,a,i,u;return a=new H({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[yu]},$$scope:{ctx:r}}}),{c(){e=N("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,t=D(),n=N("p"),n.textContent="Data valid as of 1 September, 2023",o=D(),s=N("p"),l=v(`License: Contains OS data  Crown copyright and database right
        2023. Made available under the `),b(a.$$.fragment),i=v(".")},m(f,c){h(f,e,c),h(f,t,c),h(f,n,c),h(f,o,c),h(f,s,c),I(s,l),w(a,s,null),I(s,i),u=!0},p(f,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:f}),a.$set(p)},i(f){u||($(a.$$.fragment,f),u=!0)},o(f){g(a.$$.fragment,f),u=!1},d(f){f&&(d(e),d(t),d(n),d(o),d(s)),y(a)}}}function ku(r){let e,t,n;return t=new ce({props:{$$slots:{default:[vu]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function mn(r){let e,t;return e=new lt({props:{colorScale:r[1],limits:r[2]}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p:ne,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function Su(r){let e,t,n,o,s,l;function a(f){r[3](f)}let i={id:mt,$$slots:{right:[ku],default:[wu]},$$scope:{ctx:r}};r[0]!==void 0&&(i.checked=r[0]),e=new ae({props:i}),G.push(()=>X(e,"checked",a));let u=r[0]&&mn(r);return s=new ie({props:{layer:mt,tooltip:Cu,show:r[0],clickable:!1}}),{c(){b(e.$$.fragment),n=D(),u&&u.c(),o=D(),b(s.$$.fragment)},m(f,c){w(e,f,c),h(f,n,c),u&&u.m(f,c),h(f,o,c),w(s,f,c),l=!0},p(f,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:f}),!t&&c&1&&(t=!0,p.checked=f[0],Y(()=>t=!1)),e.$set(p),f[0]?u?(u.p(f,c),c&1&&$(u,1)):(u=mn(f),u.c(),$(u,1),u.m(o.parentNode,o)):u&&(me(),g(u,1,1,()=>{u=null}),he());const m={};c&1&&(m.show=f[0]),s.$set(m)},i(f){l||($(e.$$.fragment,f),$(u),$(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(u),g(s.$$.fragment,f),l=!1},d(f){f&&(d(n),d(o)),y(e,f),u&&u.d(f),y(s,f)}}}let mt="road_widths";function Cu(r){let e=`<p>Average width: ${r.properties.average} meters</p>`;return e+=`<p>Minimum width: ${r.properties.minimum} meters</p>`,e}function Lu(r,e,t){let n;V(r,ue,i=>t(4,n=i));let o=q.sequential_low_to_high,s=[0,5,10,15,20,100];ke(n,mt,`${wr()}/v1/${mt}.pmtiles`),Ne(n,{id:mt,source:mt,sourceLayer:mt,color:it(["get","average"],s,o),width:Yt,opacity:De(.5,1)});let l=!1;function a(i){l=i,t(0,l)}return[l,o,s,a]}class Tu extends Z{constructor(e){super(),K(this,e,Lu,Su,x,{})}}function Ou(r){let e;return{c(){e=v("primary and secondary schools")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Au(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Du(r){let e,t,n,o,s,l,a,i,u;return n=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Ou]},$$scope:{ctx:r}}}),i=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Au]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("This shows "),b(n.$$.fragment),o=v(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment)},m(f,c){h(f,e,c),I(e,t),w(n,e,null),I(e,o),h(f,s,c),h(f,l,c),I(l,a),w(i,l,null),u=!0},p(f,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:f}),n.$set(p);const m={};c&1&&(m.$$scope={dirty:c,ctx:f}),i.$set(m)},i(f){u||($(n.$$.fragment,f),$(i.$$.fragment,f),u=!0)},o(f){g(n.$$.fragment,f),g(i.$$.fragment,f),u=!1},d(f){f&&(d(e),d(s),d(l)),y(n),y(i)}}}function Eu(r){let e,t;return e=new vr({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Du]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}class Iu extends Z{constructor(e){super(),K(this,e,null,Eu,x,{})}}function Mu(r){let e;return{c(){e=v("sports pitches")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Pu(r){let e;return{c(){e=v("sports centres")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Nu(r){let e;return{c(){e=v("Open Data Commons Open Database License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Fu(r){let e,t,n,o,s,l,a,i,u,f,c;return n=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[Mu]},$$scope:{ctx:r}}}),s=new H({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Pu]},$$scope:{ctx:r}}}),f=new H({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Nu]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("This shows "),b(n.$$.fragment),o=v(" and "),b(s.$$.fragment),l=v(" data from OpenStreetMap (as of 9 August 2023)."),a=D(),i=N("p"),u=v("License: "),b(f.$$.fragment)},m(p,m){h(p,e,m),I(e,t),w(n,e,null),I(e,o),w(s,e,null),I(e,l),h(p,a,m),h(p,i,m),I(i,u),w(f,i,null),c=!0},p(p,m){const _={};m&1&&(_.$$scope={dirty:m,ctx:p}),n.$set(_);const k={};m&1&&(k.$$scope={dirty:m,ctx:p}),s.$set(k);const C={};m&1&&(C.$$scope={dirty:m,ctx:p}),f.$set(C)},i(p){c||($(n.$$.fragment,p),$(s.$$.fragment,p),$(f.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(f.$$.fragment,p),c=!1},d(p){p&&(d(e),d(a),d(i)),y(n),y(s),y(f)}}}function Bu(r){let e,t;return e=new vr({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Fu]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}class ju extends Z{constructor(e){super(),K(this,e,null,Bu,x,{})}}function Ru(r){let e;return{c(){e=v("Vehicle counts")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Uu(r){let e;return{c(){e=v(`DfT road statistics
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Hu(r){let e;return{c(){e=v("methodology")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function zu(r){let e;return{c(){e=v("Open Government License")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Wu(r){let e,t,n,o,s,l,a,i,u,f,c,p,m;return n=new H({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[Uu]},$$scope:{ctx:r}}}),s=new H({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[Hu]},$$scope:{ctx:r}}}),p=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[zu]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("2022 AADF (annual average daily flow) data from "),b(n.$$.fragment),o=v(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),b(s.$$.fragment),l=v(" for details and caveats about the measurements."),a=D(),i=N("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,u=D(),f=N("p"),c=v("License: "),b(p.$$.fragment)},m(_,k){h(_,e,k),I(e,t),w(n,e,null),I(e,o),w(s,e,null),I(e,l),h(_,a,k),h(_,i,k),h(_,u,k),h(_,f,k),I(f,c),w(p,f,null),m=!0},p(_,k){const C={};k&64&&(C.$$scope={dirty:k,ctx:_}),n.$set(C);const L={};k&64&&(L.$$scope={dirty:k,ctx:_}),s.$set(L);const E={};k&64&&(E.$$scope={dirty:k,ctx:_}),p.$set(E)},i(_){m||($(n.$$.fragment,_),$(s.$$.fragment,_),$(p.$$.fragment,_),m=!0)},o(_){g(n.$$.fragment,_),g(s.$$.fragment,_),g(p.$$.fragment,_),m=!1},d(_){_&&(d(e),d(a),d(i),d(u),d(f)),y(n),y(s),y(p)}}}function xu(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Wu]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&64&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function hn(r){let e,t;return e=new lt({props:{colorScale:r[1],limits:r[2]}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p:ne,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function Vu(r){let e,t,n,o,s,l;function a(f){r[3](f)}let i={id:ht,$$slots:{right:[xu],default:[Ru]},$$scope:{ctx:r}};r[0]!==void 0&&(i.checked=r[0]),e=new ae({props:i}),G.push(()=>X(e,"checked",a));let u=r[0]&&hn(r);return s=new ie({props:{layer:ht,tooltip:Gu,show:r[0],clickable:!0}}),s.$on("click",Zu),{c(){b(e.$$.fragment),n=D(),u&&u.c(),o=D(),b(s.$$.fragment)},m(f,c){w(e,f,c),h(f,n,c),u&&u.m(f,c),h(f,o,c),w(s,f,c),l=!0},p(f,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:f}),!t&&c&1&&(t=!0,p.checked=f[0],Y(()=>t=!1)),e.$set(p),f[0]?u?(u.p(f,c),c&1&&$(u,1)):(u=hn(f),u.c(),$(u,1),u.m(o.parentNode,o)):u&&(me(),g(u,1,1,()=>{u=null}),he());const m={};c&1&&(m.show=f[0]),s.$set(m)},i(f){l||($(e.$$.fragment,f),$(u),$(s.$$.fragment,f),l=!0)},o(f){g(e.$$.fragment,f),g(u),g(s.$$.fragment,f),l=!1},d(f){f&&(d(n),d(o)),y(e,f),u&&u.d(f),y(s,f)}}}let ht="vehicle_counts";function Gu(r){let e=`<h2>${r.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${r.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${r.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${r.properties.method}</b></p>`,e}function Zu(r){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${r.detail.properties.count_point}`,"_blank")}function Ku(r,e,t){let n;V(r,ue,u=>t(4,n=u));let o=q.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],l=["","40k","80k","120k","160k",""];ke(n,ht,`${$e()}/v1/${ht}.pmtiles`),St(n,{id:ht,source:ht,sourceLayer:ht,color:it(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let a=!1;function i(u){a=u,t(0,a)}return[a,o,l,i]}class qu extends Z{constructor(e){super(),K(this,e,Ku,Vu,x,{})}}function Xu(r){let e,t,n;return e=new Ee({props:{color:r[1]}}),{c(){b(e.$$.fragment),t=v(`
  Wards`)},m(o,s){w(e,o,s),h(o,t,s),n=!0},p:ne,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&d(t),y(e,o)}}}function Yu(r){let e;return{c(){e=v(`ONS Geography
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Ju(r){let e;return{c(){e=v(`Open Government License
        `)},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function Qu(r){let e,t,n,o,s,l,a,i,u,f;return n=new H({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[Yu]},$$scope:{ctx:r}}}),i=new H({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ju]},$$scope:{ctx:r}}}),{c(){e=N("p"),t=v("Data from "),b(n.$$.fragment),o=v(", as of May 2023."),s=D(),l=N("p"),a=v("License: "),b(i.$$.fragment),u=v(`. Contains OS data  Crown copyright and database
        right 2023.`)},m(c,p){h(c,e,p),I(e,t),w(n,e,null),I(e,o),h(c,s,p),h(c,l,p),I(l,a),w(i,l,null),I(l,u),f=!0},p(c,p){const m={};p&32&&(m.$$scope={dirty:p,ctx:c}),n.$set(m);const _={};p&32&&(_.$$scope={dirty:p,ctx:c}),i.$set(_)},i(c){f||($(n.$$.fragment,c),$(i.$$.fragment,c),f=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),f=!1},d(c){c&&(d(e),d(s),d(l)),y(n),y(i)}}}function ec(r){let e,t,n;return t=new ce({props:{$$slots:{default:[Qu]},$$scope:{ctx:r}}}),{c(){e=N("span"),b(t.$$.fragment),ee(e,"slot","right")},m(o,s){h(o,e,s),w(t,e,null),n=!0},p(o,s){const l={};s&32&&(l.$$scope={dirty:s,ctx:o}),t.$set(l)},i(o){n||($(t.$$.fragment,o),n=!0)},o(o){g(t.$$.fragment,o),n=!1},d(o){o&&d(e),y(t)}}}function tc(r){let e,t,n,o,s;function l(i){r[3](i)}let a={id:Ze,$$slots:{right:[ec],default:[Xu]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ae({props:a}),G.push(()=>X(e,"checked",l)),o=new ie({props:{layer:Ze,tooltip:rc,show:r[0],clickable:!0}}),o.$on("click",nc),{c(){b(e.$$.fragment),n=D(),b(o.$$.fragment)},m(i,u){w(e,i,u),h(i,n,u),w(o,i,u),s=!0},p(i,[u]){const f={};u&32&&(f.$$scope={dirty:u,ctx:i}),!t&&u&1&&(t=!0,f.checked=i[0],Y(()=>t=!1)),e.$set(f);const c={};u&1&&(c.show=i[0]),o.$set(c)},i(i){s||($(e.$$.fragment,i),$(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&d(n),y(e,i),y(o,i)}}}let Ze="wards";function rc(r){return`<p>${r.properties.name}</p>`}function nc(r){let e=encodeURIComponent(r.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function oc(r,e,t){let n;V(r,ue,i=>t(2,n=i));let o=q.wards,s=`${Ze}-outline`;ke(n,Ze,`${$e()}/v1/${Ze}.pmtiles`),_t(n,{id:Ze,source:Ze,sourceLayer:Ze,color:o,opacity:De(.5,0)}),Ne(n,{id:s,source:Ze,sourceLayer:Ze,color:o,width:2.5});let l=!1;function a(i){l=i,t(0,l)}return r.$$.update=()=>{r.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",l?"visible":"none")},[l,o,n,a]}class sc extends Z{constructor(e){super(),K(this,e,oc,tc,x,{})}}function ic(r){let e,t,n,o,s,l,a,i;return e=new Iu({}),n=new Ka({}),s=new ju({}),a=new uu({}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),b(s.$$.fragment),l=D(),b(a.$$.fragment)},m(u,f){w(e,u,f),h(u,t,f),w(n,u,f),h(u,o,f),w(s,u,f),h(u,l,f),w(a,u,f),i=!0},i(u){i||($(e.$$.fragment,u),$(n.$$.fragment,u),$(s.$$.fragment,u),$(a.$$.fragment,u),i=!0)},o(u){g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),g(a.$$.fragment,u),i=!1},d(u){u&&(d(t),d(o),d(l)),y(e,u),y(n,u),y(s,u),y(a,u)}}}function lc(r){let e,t;return e=new jt({props:{small:!0,$$slots:{default:[ic]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function ac(r){let e,t,n,o,s,l,a,i,u,f;return e=new ja({}),n=new Bf({}),s=new yl({}),a=new Aa({}),u=new wa({}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),b(s.$$.fragment),l=D(),b(a.$$.fragment),i=D(),b(u.$$.fragment)},m(c,p){w(e,c,p),h(c,t,p),w(n,c,p),h(c,o,p),w(s,c,p),h(c,l,p),w(a,c,p),h(c,i,p),w(u,c,p),f=!0},i(c){f||($(e.$$.fragment,c),$(n.$$.fragment,c),$(s.$$.fragment,c),$(a.$$.fragment,c),$(u.$$.fragment,c),f=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(a.$$.fragment,c),g(u.$$.fragment,c),f=!1},d(c){c&&(d(t),d(o),d(l),d(i)),y(e,c),y(n,c),y(s,c),y(a,c),y(u,c)}}}function fc(r){let e,t;return e=new jt({props:{small:!0,$$slots:{default:[ac]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function uc(r){let e,t,n,o,s,l,a,i,u,f;return e=new Zf({}),n=new sc({}),s=new na({}),a=new df({}),u=new Of({}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),b(s.$$.fragment),l=D(),b(a.$$.fragment),i=D(),b(u.$$.fragment)},m(c,p){w(e,c,p),h(c,t,p),w(n,c,p),h(c,o,p),w(s,c,p),h(c,l,p),w(a,c,p),h(c,i,p),w(u,c,p),f=!0},i(c){f||($(e.$$.fragment,c),$(n.$$.fragment,c),$(s.$$.fragment,c),$(a.$$.fragment,c),$(u.$$.fragment,c),f=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(a.$$.fragment,c),g(u.$$.fragment,c),f=!1},d(c){c&&(d(t),d(o),d(l),d(i)),y(e,c),y(n,c),y(s,c),y(a,c),y(u,c)}}}function cc(r){let e,t;return e=new jt({props:{small:!0,$$slots:{default:[uc]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,o){const s={};o&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function pc(r){let e,t,n,o;return e=new Vl({}),n=new of({}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment)},m(s,l){w(e,s,l),h(s,t,l),w(n,s,l),o=!0},i(s){o||($(e.$$.fragment,s),$(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&d(t),y(e,s),y(n,s)}}}function mc(r){let e,t,n,o;return e=new Tu({}),n=new bu({}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment)},m(s,l){w(e,s,l),h(s,t,l),w(n,s,l),o=!0},i(s){o||($(e.$$.fragment,s),$(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&d(t),y(e,s),y(n,s)}}}function hc(r){let e,t,n,o,s=_r()=="Private (development)",l,a;e=new qu({}),n=new tu({});let i=s&&mc();return{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),i&&i.c(),l=Qe()},m(u,f){w(e,u,f),h(u,t,f),w(n,u,f),h(u,o,f),i&&i.m(u,f),h(u,l,f),a=!0},p:ne,i(u){a||($(e.$$.fragment,u),$(n.$$.fragment,u),$(i),a=!0)},o(u){g(e.$$.fragment,u),g(n.$$.fragment,u),g(i),a=!1},d(u){u&&(d(t),d(o),d(l)),y(e,u),y(n,u),i&&i.d(u)}}}function dc(r){let e,t,n,o,s,l,a,i,u,f,c,p,m,_,k,C,L;e=new ca({}),n=new Ye({props:{label:"Trip generators",$$slots:{default:[lc]},$$scope:{ctx:r}}}),s=new Ye({props:{label:"Existing infrastructure",$$slots:{default:[fc]},$$scope:{ctx:r}}}),a=new Ye({props:{label:"Boundaries",$$slots:{default:[cc]},$$scope:{ctx:r}}}),u=new Ye({props:{label:"Census",$$slots:{default:[pc]},$$scope:{ctx:r}}}),c=new Ye({props:{label:"Other",$$slots:{default:[hc]},$$scope:{ctx:r}}});function E(S){r[5](S)}let B={displayEnableButton:!0};return r[2]!==void 0&&(B.isInactive=r[2]),m=new So({props:B}),r[4](m),G.push(()=>X(m,"isInactive",E)),C=new go({props:{style:r[0]}}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),b(s.$$.fragment),l=D(),b(a.$$.fragment),i=D(),b(u.$$.fragment),f=D(),b(c.$$.fragment),p=D(),b(m.$$.fragment),k=D(),b(C.$$.fragment)},m(S,A){w(e,S,A),h(S,t,A),w(n,S,A),h(S,o,A),w(s,S,A),h(S,l,A),w(a,S,A),h(S,i,A),w(u,S,A),h(S,f,A),w(c,S,A),h(S,p,A),w(m,S,A),h(S,k,A),w(C,S,A),L=!0},p(S,A){const j={};A&64&&(j.$$scope={dirty:A,ctx:S}),n.$set(j);const M={};A&64&&(M.$$scope={dirty:A,ctx:S}),s.$set(M);const P={};A&64&&(P.$$scope={dirty:A,ctx:S}),a.$set(P);const T={};A&64&&(T.$$scope={dirty:A,ctx:S}),u.$set(T);const O={};A&64&&(O.$$scope={dirty:A,ctx:S}),c.$set(O);const U={};!_&&A&4&&(_=!0,U.isInactive=S[2],Y(()=>_=!1)),m.$set(U);const z={};A&1&&(z.style=S[0]),C.$set(z)},i(S){L||($(e.$$.fragment,S),$(n.$$.fragment,S),$(s.$$.fragment,S),$(a.$$.fragment,S),$(u.$$.fragment,S),$(c.$$.fragment,S),$(m.$$.fragment,S),$(C.$$.fragment,S),L=!0)},o(S){g(e.$$.fragment,S),g(n.$$.fragment,S),g(s.$$.fragment,S),g(a.$$.fragment,S),g(u.$$.fragment,S),g(c.$$.fragment,S),g(m.$$.fragment,S),g(C.$$.fragment,S),L=!1},d(S){S&&(d(t),d(o),d(l),d(i),d(f),d(p),d(k)),y(e,S),y(n,S),y(s,S),y(a,S),y(u,S),y(c,S),r[4](null),y(m,S),y(C,S)}}}function $c(r){let e,t,n,o;return e=new Ye({props:{label:"Layers",open:!0,$$slots:{default:[dc]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(s,l){w(e,s,l),t=!0,n||(o=br(window,"keydown",r[3]),n=!0)},p(s,[l]){const a={};l&71&&(a.$$scope={dirty:l,ctx:s}),e.$set(a)},i(s){t||($(e.$$.fragment,s),t=!0)},o(s){g(e.$$.fragment,s),t=!1},d(s){y(e,s),n=!1,o()}}}function gc(r,e,t){let n;V(r,Lr,u=>t(2,n=u));let{style:o}=e,s;function l(u){!n&&u.key=="Escape"&&(s.disableStreetView(),u.preventDefault())}function a(u){G[u?"unshift":"push"](()=>{s=u,t(1,s)})}function i(u){n=u,Lr.set(n)}return r.$$set=u=>{"style"in u&&t(0,o=u.style)},[o,s,n,l,a,i]}class _c extends Z{constructor(e){super(),K(this,e,gc,$c,x,{style:0})}}function bc(r,e,t){let{loadFile:n}=e;return Bt(async()=>{let s=await(await fetch(`${wr()}/v1/random_schemes.geojson`)).text();n(s)}),r.$$set=o=>{"loadFile"in o&&t(0,n=o.loadFile)},[n]}class wc extends Z{constructor(e){super(),K(this,e,bc,null,x,{loadFile:0})}}function yc(r){let e;return{c(){e=v("Show on map")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function vc(r){let e;return{c(){e=v("Edit scheme locally")},m(t,n){h(t,e,n)},d(t){t&&d(e)}}}function kc(r){let e,t,n=r[0].authority_or_region+"",o,s,l,a,i=r[0].capital_scheme_id+"",u,f,c,p,m=r[0].funding_programme+"",_,k,C,L,E,B,S;return L=new lr({props:{$$slots:{default:[yc]},$$scope:{ctx:r}}}),L.$on("click",r[3]),B=new lr({props:{disabled:r[1],title:r[2],$$slots:{default:[vc]},$$scope:{ctx:r}}}),B.$on("click",r[4]),{c(){e=N("p"),t=v("Authority or region: "),o=v(n),s=D(),l=N("p"),a=v("Capital scheme ID: "),u=v(i),f=D(),c=N("p"),p=v("Funding programme: "),_=v(m),k=D(),C=N("div"),b(L.$$.fragment),E=D(),b(B.$$.fragment),ee(C,"class","govuk-button-group")},m(A,j){h(A,e,j),I(e,t),I(e,o),h(A,s,j),h(A,l,j),I(l,a),I(l,u),h(A,f,j),h(A,c,j),I(c,p),I(c,_),h(A,k,j),h(A,C,j),w(L,C,null),I(C,E),w(B,C,null),S=!0},p(A,j){(!S||j&1)&&n!==(n=A[0].authority_or_region+"")&&Pe(o,n),(!S||j&1)&&i!==(i=A[0].capital_scheme_id+"")&&Pe(u,i),(!S||j&1)&&m!==(m=A[0].funding_programme+"")&&Pe(_,m);const M={};j&256&&(M.$$scope={dirty:j,ctx:A}),L.$set(M);const P={};j&256&&(P.$$scope={dirty:j,ctx:A}),B.$set(P)},i(A){S||($(L.$$.fragment,A),$(B.$$.fragment,A),S=!0)},o(A){g(L.$$.fragment,A),g(B.$$.fragment,A),S=!1},d(A){A&&(d(e),d(s),d(l),d(f),d(c),d(k),d(C)),y(L),y(B)}}}function Sc(r){let e,t;return e=new Ye({props:{label:`${r[0].scheme_reference}: ${r[0].num_features} features`,$$slots:{default:[kc]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function Cc(r,e,t){let n,o;V(r,kt,c=>t(6,n=c)),V(r,ue,c=>t(7,o=c));let{scheme:s}=e,{authorityNames:l}=e,a=!l.has(s.authority_or_region),i=a?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function u(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(co(c),{padding:20,animate:!1})}function f(){let c={type:"FeatureCollection",features:n.features.filter(m=>m.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return r.$$set=c=>{"scheme"in c&&t(0,s=c.scheme),"authorityNames"in c&&t(5,l=c.authorityNames)},[s,a,i,u,f,l]}class Lc extends Z{constructor(e){super(),K(this,e,Cc,Sc,x,{scheme:0,authorityNames:5})}}const Tc=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ve=(r,e,t)=>new Promise((n,o)=>{var s=i=>{try{a(t.next(i))}catch(u){o(u)}},l=i=>{try{a(t.throw(i))}catch(u){o(u)}},a=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,l);a((t=t.apply(r,e)).next())}),Ae=Uint8Array,yt=Uint16Array,Oc=Int32Array,Zn=new Ae([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Kn=new Ae([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ac=new Ae([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qn=function(r,e){for(var t=new yt(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var o=new Oc(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)o[s]=s-t[n]<<5|n;return{b:t,r:o}},Xn=qn(Zn,2),Yn=Xn.b,Dc=Xn.r;Yn[28]=258,Dc[258]=28;var Ec=qn(Kn,0),Ic=Ec.b,$r=new yt(32768);for(Q=0;Q<32768;++Q)Xe=(Q&43690)>>1|(Q&21845)<<1,Xe=(Xe&52428)>>2|(Xe&13107)<<2,Xe=(Xe&61680)>>4|(Xe&3855)<<4,$r[Q]=((Xe&65280)>>8|(Xe&255)<<8)>>1;var Xe,Q,Pt=function(r,e,t){for(var n=r.length,o=0,s=new yt(e);o<n;++o)r[o]&&++s[r[o]-1];var l=new yt(e);for(o=1;o<e;++o)l[o]=l[o-1]+s[o-1]<<1;var a;if(t){a=new yt(1<<e);var i=15-e;for(o=0;o<n;++o)if(r[o])for(var u=o<<4|r[o],f=e-r[o],c=l[r[o]-1]++<<f,p=c|(1<<f)-1;c<=p;++c)a[$r[c]>>i]=u}else for(a=new yt(n),o=0;o<n;++o)r[o]&&(a[o]=$r[l[r[o]-1]++]>>15-r[o]);return a},Ht=new Ae(288);for(Q=0;Q<144;++Q)Ht[Q]=8;var Q;for(Q=144;Q<256;++Q)Ht[Q]=9;var Q;for(Q=256;Q<280;++Q)Ht[Q]=7;var Q;for(Q=280;Q<288;++Q)Ht[Q]=8;var Q,Jn=new Ae(32);for(Q=0;Q<32;++Q)Jn[Q]=5;var Q,Mc=Pt(Ht,9,1),Pc=Pt(Jn,5,1),sr=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},Re=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},ir=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},Nc=function(r){return(r+7)/8|0},Fc=function(r,e,t){(e==null||e<0)&&(e=0),(t==null||t>r.length)&&(t=r.length);var n=new Ae(t-e);return n.set(r.subarray(e,t)),n},Bc=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Le=function(r,e,t){var n=new Error(e||Bc[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,Le),!t)throw n;return n},kr=function(r,e,t,n){var o=r.length,s=n?n.length:0;if(!o||e.f&&!e.l)return t||new Ae(0);var l=!t||e.i!=2,a=e.i;t||(t=new Ae(o*3));var i=function(we){var Fe=t.length;if(we>Fe){var Be=new Ae(Math.max(Fe*2,we));Be.set(t),t=Be}},u=e.f||0,f=e.p||0,c=e.b||0,p=e.l,m=e.d,_=e.m,k=e.n,C=o*8;do{if(!p){u=Re(r,f,1);var L=Re(r,f+1,3);if(f+=3,L)if(L==1)p=Mc,m=Pc,_=9,k=5;else if(L==2){var A=Re(r,f,31)+257,j=Re(r,f+10,15)+4,M=A+Re(r,f+5,31)+1;f+=14;for(var P=new Ae(M),T=new Ae(19),O=0;O<j;++O)T[Ac[O]]=Re(r,f+O*3,7);f+=j*3;for(var U=sr(T),z=(1<<U)-1,W=Pt(T,U,1),O=0;O<M;){var te=W[Re(r,f,z)];f+=te&15;var E=te>>4;if(E<16)P[O++]=E;else{var pe=0,J=0;for(E==16?(J=3+Re(r,f,3),f+=2,pe=P[O-1]):E==17?(J=3+Re(r,f,7),f+=3):E==18&&(J=11+Re(r,f,127),f+=7);J--;)P[O++]=pe}}var le=P.subarray(0,A),se=P.subarray(A);_=sr(le),k=sr(se),p=Pt(le,_,1),m=Pt(se,k,1)}else Le(1);else{var E=Nc(f)+4,B=r[E-4]|r[E-3]<<8,S=E+B;if(S>o){a&&Le(0);break}l&&i(c+B),t.set(r.subarray(E,S),c),e.b=c+=B,e.p=f=S*8,e.f=u;continue}if(f>C){a&&Le(0);break}}l&&i(c+131072);for(var ge=(1<<_)-1,_e=(1<<k)-1,Ie=f;;Ie=f){var pe=p[ir(r,f)&ge],de=pe>>4;if(f+=pe&15,f>C){a&&Le(0);break}if(pe||Le(2),de<256)t[c++]=de;else if(de==256){Ie=f,p=null;break}else{var Ce=de-254;if(de>264){var O=de-257,fe=Zn[O];Ce=Re(r,f,(1<<fe)-1)+Yn[O],f+=fe}var R=m[ir(r,f)&_e],be=R>>4;R||Le(3),f+=R&15;var se=Ic[be];if(be>3){var fe=Kn[be];se+=ir(r,f)&(1<<fe)-1,f+=fe}if(f>C){a&&Le(0);break}l&&i(c+131072);var re=c+Ce;if(c<se){var F=s-se,Se=Math.min(se,re);for(F+c<0&&Le(3);c<Se;++c)t[c]=n[F+c]}for(;c<re;c+=4)t[c]=t[c-se],t[c+1]=t[c+1-se],t[c+2]=t[c+2-se],t[c+3]=t[c+3-se];c=re}}e.l=p,e.p=Ie,e.b=c,e.f=u,p&&(u=1,e.m=_,e.d=m,e.n=k)}while(!u);return c==t.length?t:Fc(t,0,c)},jc=new Ae(0),Rc=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&Le(6,"invalid gzip data");var e=r[3],t=10;e&4&&(t+=(r[10]|r[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!r[t++]);return t+(e&2)},Uc=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},Hc=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&Le(6,"invalid zlib data"),(r[1]>>5&1)==+!e&&Le(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function zc(r,e){return kr(r,{i:2},e&&e.out,e&&e.dictionary)}function Wc(r,e){var t=Rc(r);return t+8>r.length&&Le(6,"invalid gzip data"),kr(r.subarray(t,-8),{i:2},e&&e.out||new Ae(Uc(r)),e&&e.dictionary)}function xc(r,e){return kr(r.subarray(Hc(r,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function gr(r,e){return r[0]==31&&r[1]==139&&r[2]==8?Wc(r,e):(r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31?zc(r,e):xc(r,e)}var Vc=typeof TextDecoder<"u"&&new TextDecoder,Gc=0;try{Vc.decode(jc,{stream:!0}),Gc=1}catch{}var Qn=(r,e)=>r*Math.pow(2,e),At=(r,e)=>Math.floor(r/Math.pow(2,e)),Kt=(r,e)=>Qn(r.getUint16(e+1,!0),8)+r.getUint8(e),eo=(r,e)=>Qn(r.getUint32(e+2,!0),16)+r.getUint16(e,!0),Zc=(r,e,t,n,o)=>{if(r!=n.getUint8(o))return r-n.getUint8(o);const s=Kt(n,o+1);if(e!=s)return e-s;const l=Kt(n,o+4);return t!=l?t-l:0},Kc=(r,e,t,n)=>{const o=to(r,e|128,t,n);return o?{z:e,x:t,y:n,offset:o[0],length:o[1],is_dir:!0}:null},dn=(r,e,t,n)=>{const o=to(r,e,t,n);return o?{z:e,x:t,y:n,offset:o[0],length:o[1],is_dir:!1}:null},to=(r,e,t,n)=>{let o=0,s=r.byteLength/17-1;for(;o<=s;){const l=s+o>>1,a=Zc(e,t,n,r,l*17);if(a>0)o=l+1;else if(a<0)s=l-1;else return[eo(r,l*17+7),r.getUint32(l*17+13,!0)]}return null},qc=(r,e)=>r.is_dir&&!e.is_dir?1:!r.is_dir&&e.is_dir?-1:r.z!==e.z?r.z-e.z:r.x!==e.x?r.x-e.x:r.y-e.y,ro=(r,e)=>{const t=r.getUint8(e*17);return{z:t&127,x:Kt(r,e*17+1),y:Kt(r,e*17+4),offset:eo(r,e*17+7),length:r.getUint32(e*17+13,!0),is_dir:t>>7===1}},$n=r=>{const e=[],t=new DataView(r);for(let n=0;n<t.byteLength/17;n++)e.push(ro(t,n));return Xc(e)},Xc=r=>{r.sort(qc);const e=new ArrayBuffer(17*r.length),t=new Uint8Array(e);for(let n=0;n<r.length;n++){const o=r[n];let s=o.z;o.is_dir&&(s=s|128),t[n*17]=s,t[n*17+1]=o.x&255,t[n*17+2]=o.x>>8&255,t[n*17+3]=o.x>>16&255,t[n*17+4]=o.y&255,t[n*17+5]=o.y>>8&255,t[n*17+6]=o.y>>16&255,t[n*17+7]=o.offset&255,t[n*17+8]=At(o.offset,8)&255,t[n*17+9]=At(o.offset,16)&255,t[n*17+10]=At(o.offset,24)&255,t[n*17+11]=At(o.offset,32)&255,t[n*17+12]=At(o.offset,48)&255,t[n*17+13]=o.length&255,t[n*17+14]=o.length>>8&255,t[n*17+15]=o.length>>16&255,t[n*17+16]=o.length>>24&255}return e},Yc=(r,e)=>{if(r.byteLength<17)return null;const t=r.byteLength/17,n=ro(r,t-1);if(n.is_dir){const o=n.z,s=e.z-o,l=Math.trunc(e.x/(1<<s)),a=Math.trunc(e.y/(1<<s));return{z:o,x:l,y:a}}return null};function Jc(r){return ve(this,null,function*(){const e=yield r.getBytes(0,512e3),t=new DataView(e.data),n=t.getUint32(4,!0),o=t.getUint16(8,!0),s=new TextDecoder("utf-8"),l=JSON.parse(s.decode(new DataView(e.data,10,n)));let a=0;l.compression==="gzip"&&(a=2);let i=0;"minzoom"in l&&(i=+l.minzoom);let u=0;"maxzoom"in l&&(u=+l.maxzoom);let f=0,c=0,p=0,m=-180,_=-85,k=180,C=85;if(l.bounds){const E=l.bounds.split(",");m=+E[0],_=+E[1],k=+E[2],C=+E[3]}if(l.center){const E=l.center.split(",");f=+E[0],c=+E[1],p=+E[2]}return{specVersion:t.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:a,tileType:1,minZoom:i,maxZoom:u,minLon:m,minLat:_,maxLon:k,maxLat:C,centerZoom:p,centerLon:f,centerLat:c,etag:e.etag}})}function Qc(r,e,t,n,o,s,l){return ve(this,null,function*(){let a=yield t.getArrayBuffer(e,r.rootDirectoryOffset,r.rootDirectoryLength,r);r.specVersion===1&&(a=$n(a));const i=dn(new DataView(a),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,l)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=gr(new Uint8Array(c))),{data:c}}const u=Yc(new DataView(a),{z:n,x:o,y:s});if(u){const f=Kc(new DataView(a),u.z,u.x,u.y);if(f){let c=yield t.getArrayBuffer(e,f.offset,f.length,r);r.specVersion===1&&(c=$n(c));const p=dn(new DataView(c),n,o,s);if(p){let _=(yield e.getBytes(p.offset,p.length,l)).data;const k=new DataView(_);return k.getUint8(0)==31&&k.getUint8(1)==139&&(_=gr(new Uint8Array(_))),{data:_}}}}})}var no={getHeader:Jc,getZxy:Qc},ep=class{constructor(){this.tile=(r,e)=>{if(r.type=="json"){const t=r.url.substr(10);let n=this.tiles.get(t);return n||(n=new gn(t),this.tiles.set(t,n)),n.getHeader().then(o=>{const s={tiles:[r.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const t=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=r.url.match(t);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new gn(o),this.tiles.set(o,s));const l=n[2],a=n[3],i=n[4],u=new AbortController,f=u.signal;let c=()=>{u.abort()};return s.getHeader().then(p=>{s.getZxy(+l,+a,+i,f).then(m=>{m?e(null,new Uint8Array(m.data),m.cacheControl,m.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(m=>{m.name!=="AbortError"&&e(m,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(r){this.tiles.set(r.source.getKey(),r)}get(r){return this.tiles.get(r)}};function bt(r,e){return(e>>>0)*4294967296+(r>>>0)}function tp(r,e){const t=e.buf;let n,o;if(o=t[e.pos++],n=(o&112)>>4,o<128||(o=t[e.pos++],n|=(o&127)<<3,o<128)||(o=t[e.pos++],n|=(o&127)<<10,o<128)||(o=t[e.pos++],n|=(o&127)<<17,o<128)||(o=t[e.pos++],n|=(o&127)<<24,o<128)||(o=t[e.pos++],n|=(o&1)<<31,o<128))return bt(r,n);throw new Error("Expected varint not more than 10 bytes")}function Dt(r){const e=r.buf;let t,n;return n=e[r.pos++],t=n&127,n<128||(n=e[r.pos++],t|=(n&127)<<7,n<128)||(n=e[r.pos++],t|=(n&127)<<14,n<128)||(n=e[r.pos++],t|=(n&127)<<21,n<128)?t:(n=e[r.pos],t|=(n&15)<<28,tp(t,r))}function rp(r,e,t,n){if(n==0){t==1&&(e[0]=r-1-e[0],e[1]=r-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var np=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function op(r,e,t){if(r>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,r)-1||t>Math.pow(2,r)-1)throw Error("tile x/y outside zoom level bounds");const n=np[r],o=Math.pow(2,r);let s=0,l=0,a=0;const i=[e,t];let u=o/2;for(;u>0;)s=(i[0]&u)>0?1:0,l=(i[1]&u)>0?1:0,a+=u*u*(3*s^l),rp(u,i,s,l),u=u/2;return n+a}function oo(r,e){return ve(this,null,function*(){if(e===1||e===0)return r;if(e===2){if(typeof globalThis.DecompressionStream>"u")return gr(new Uint8Array(r));{let n=new Response(r).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var sp=127;function ip(r,e){let t=0,n=r.length-1;for(;t<=n;){const o=n+t>>1,s=e-r[o].tileId;if(s>0)t=o+1;else if(s<0)n=o-1;else return r[o]}return n>=0&&(r[n].runLength===0||e-r[n].tileId<r[n].runLength)?r[n]:null}var lp=class{constructor(r){this.url=r}getKey(){return this.url}getBytes(r,e,t){return ve(this,null,function*(){let n;t||(n=new AbortController,t=n.signal);let o=yield fetch(this.url,{signal:t,headers:{Range:"bytes="+r+"-"+(r+e-1)}});if(o.status===416&&r===0){const a=o.headers.get("Content-Range");if(!a||!a.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+a.substr(8);o=yield fetch(this.url,{signal:t,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function Ue(r,e){const t=r.getUint32(e+4,!0),n=r.getUint32(e+0,!0);return t*Math.pow(2,32)+n}function ap(r,e){const t=new DataView(r),n=t.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:Ue(t,8),rootDirectoryLength:Ue(t,16),jsonMetadataOffset:Ue(t,24),jsonMetadataLength:Ue(t,32),leafDirectoryOffset:Ue(t,40),leafDirectoryLength:Ue(t,48),tileDataOffset:Ue(t,56),tileDataLength:Ue(t,64),numAddressedTiles:Ue(t,72),numTileEntries:Ue(t,80),numTileContents:Ue(t,88),clustered:t.getUint8(96)===1,internalCompression:t.getUint8(97),tileCompression:t.getUint8(98),tileType:t.getUint8(99),minZoom:t.getUint8(100),maxZoom:t.getUint8(101),minLon:t.getInt32(102,!0)/1e7,minLat:t.getInt32(106,!0)/1e7,maxLon:t.getInt32(110,!0)/1e7,maxLat:t.getInt32(114,!0)/1e7,centerZoom:t.getUint8(118),centerLon:t.getInt32(119,!0)/1e7,centerLat:t.getInt32(123,!0)/1e7,etag:e}}function so(r){const e={buf:new Uint8Array(r),pos:0},t=Dt(e),n=[];let o=0;for(let s=0;s<t;s++){const l=Dt(e);n.push({tileId:o+l,offset:0,length:0,runLength:1}),o+=l}for(let s=0;s<t;s++)n[s].runLength=Dt(e);for(let s=0;s<t;s++)n[s].length=Dt(e);for(let s=0;s<t;s++){const l=Dt(e);l===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=l-1}return n}function fp(r){const e=new DataView(r);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var vt=class extends Error{};function up(r,e,t,n){return ve(this,null,function*(){const o=yield r.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(fp(o.data)<3)return[yield no.getHeader(r)];const l=o.data.slice(0,sp);let a=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+r.getKey()),a=void 0);const i=ap(l,a);if(t){const u=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),f=r.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=so(yield e(u,i.internalCompression));return[i,[f,c.length,c]]}return[i,void 0]})}function cp(r,e,t,n,o){return ve(this,null,function*(){const s=yield r.getBytes(t,n);if(o.etag&&o.etag!==s.etag)throw new vt(s.etag);const l=yield e(s.data,o.internalCompression),a=so(l);if(a.length===0)throw new Error("Empty directory is invalid");return a})}var pp=class{constructor(r=100,e=!0,t=oo){this.cache=new Map,this.maxCacheEntries=r,this.counter=1,this.prefetch=e,this.decompress=t}getHeader(r,e){return ve(this,null,function*(){const t=r.getKey();if(this.cache.has(t))return this.cache.get(t).lastUsed=this.counter++,yield this.cache.get(t).data;const n=new Promise((o,s)=>{up(r,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),o(l[0]),this.prune()}).catch(l=>{s(l)})});return this.cache.set(t,{lastUsed:this.counter++,data:n}),n})}getDirectory(r,e,t,n){return ve(this,null,function*(){const o=r.getKey()+"|"+(n.etag||"")+"|"+e+"|"+t;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,a)=>{cp(r,this.decompress,e,t,n).then(i=>{l(i),this.prune()}).catch(i=>{a(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(r,e,t,n){return ve(this,null,function*(){const o=r.getKey()+"|"+(n.etag||"")+"|"+e+"|"+t;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((l,a)=>{r.getBytes(e,t).then(i=>{if(n.etag&&n.etag!==i.etag)throw new vt(i.etag);l(i.data),this.cache.has(o),this.prune()}).catch(i=>{a(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let r=1/0,e;this.cache.forEach((t,n)=>{t.lastUsed<r&&(r=t.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(r,e){return ve(this,null,function*(){this.cache.delete(r.getKey()),yield this.getHeader(r,e)})}},gn=class{constructor(r,e,t){typeof r=="string"?this.source=new lp(r):this.source=r,t?this.decompress=t:this.decompress=oo,e?this.cache=e:this.cache=new pp}getHeader(){return ve(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(r,e,t,n){return ve(this,null,function*(){const o=op(r,e,t),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return no.getZxy(s,this.source,this.cache,r,e,t,n);if(r<s.minZoom||r>s.maxZoom)return;let l=s.rootDirectoryOffset,a=s.rootDirectoryLength;for(let i=0;i<=3;i++){const u=yield this.cache.getDirectory(this.source,l,a,s),f=ip(u,o);if(f)if(f.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+f.offset,f.length,n);if(s.etag&&s.etag!==c.etag)throw new vt(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else l=s.leafDirectoryOffset+f.offset,a=f.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(r,e,t,n){return ve(this,null,function*(){try{return yield this.getZxyAttempt(r,e,t,n)}catch(o){if(o instanceof vt)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(r,e,t,n);throw o}})}getMetadataAttempt(){return ve(this,null,function*(){const r=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(r.jsonMetadataOffset,r.jsonMetadataLength);if(r.etag&&r.etag!==e.etag)throw new vt(e.etag);const t=yield this.decompress(e.data,r.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(t))})}getMetadata(){return ve(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(r){if(r instanceof vt)return this.cache.invalidate(this.source,r.message),yield this.getMetadataAttempt();throw r}})}};function mp(r){return Bt(()=>{let e=new ep;ot.addProtocol("pmtiles",e.tile)}),qt(()=>{ot.removeProtocol("pmtiles")}),[]}class hp extends Z{constructor(e){super(),K(this,e,mp,null,x,{})}}function _n(r,e,t){const n=r.slice();return n[13]=e[t],n}function dp(r){let e,t;return e=new wc({props:{loadFile:r[7]}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p:ne,i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function bn(r){let e,t,n,o;function s(i){r[9](i)}function l(i){r[10](i)}let a={schemes:r[1]};return r[2]!==void 0&&(a.schemesToBeShown=r[2]),r[3]!==void 0&&(a.filterText=r[3]),e=new pl({props:a}),G.push(()=>X(e,"schemesToBeShown",s)),G.push(()=>X(e,"filterText",l)),{c(){b(e.$$.fragment)},m(i,u){w(e,i,u),o=!0},p(i,u){const f={};u&2&&(f.schemes=i[1]),!t&&u&4&&(t=!0,f.schemesToBeShown=i[2],Y(()=>t=!1)),!n&&u&8&&(n=!0,f.filterText=i[3],Y(()=>n=!1)),e.$set(f)},i(i){o||($(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){y(e,i)}}}function wn(r){let e,t;return e=new Lc({props:{scheme:r[13],authorityNames:r[5]}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function yn(r){let e=r[2].has(r[13].scheme_reference),t,n,o=e&&wn(r);return{c(){o&&o.c(),t=Qe()},m(s,l){o&&o.m(s,l),h(s,t,l),n=!0},p(s,l){l&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,l),l&6&&$(o,1)):(o=wn(s),o.c(),$(o,1),o.m(t.parentNode,t)):o&&(me(),g(o,1,1,()=>{o=null}),he())},i(s){n||($(o),n=!0)},o(s){g(o),n=!1},d(s){s&&d(t),o&&o.d(s)}}}function $p(r){let e,t,n,o,s,l,a,i,u,f,c=_r()=="Private (development)",p,m,_,k,C,L,E,B;s=new _o({props:{boundaryGeojson:r[4]}}),a=new Qo({}),u=new po({});let S=c&&dp(r);m=new To({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:r[7]}}),k=new Cn({props:{errorMessage:r[0]}});let A=r[1].size>0&&bn(r),j=st(r[1].values()),M=[];for(let T=0;T<j.length;T+=1)M[T]=yn(_n(r,j,T));const P=T=>g(M[T],1,1,()=>{M[T]=null});return{c(){e=N("div"),t=N("div"),n=N("h1"),n.textContent="Browse schemes",o=D(),b(s.$$.fragment),l=D(),b(a.$$.fragment),i=D(),b(u.$$.fragment),f=D(),S&&S.c(),p=D(),b(m.$$.fragment),_=D(),b(k.$$.fragment),C=D(),A&&A.c(),L=D(),E=N("ul");for(let T=0;T<M.length;T+=1)M[T].c();Je(t,"display","flex"),Je(t,"justify-content","space-between"),ee(e,"slot","sidebar"),ee(e,"class","govuk-prose")},m(T,O){h(T,e,O),I(e,t),I(t,n),I(t,o),w(s,t,null),I(e,l),w(a,e,null),I(e,i),w(u,e,null),I(e,f),S&&S.m(e,null),I(e,p),w(m,e,null),I(e,_),w(k,e,null),I(e,C),A&&A.m(e,null),I(e,L),I(e,E);for(let U=0;U<M.length;U+=1)M[U]&&M[U].m(E,null);B=!0},p(T,O){const U={};O&16&&(U.boundaryGeojson=T[4]),s.$set(U),c&&S.p(T,O);const z={};if(O&1&&(z.errorMessage=T[0]),k.$set(z),T[1].size>0?A?(A.p(T,O),O&2&&$(A,1)):(A=bn(T),A.c(),$(A,1),A.m(e,L)):A&&(me(),g(A,1,1,()=>{A=null}),he()),O&38){j=st(T[1].values());let W;for(W=0;W<j.length;W+=1){const te=_n(T,j,W);M[W]?(M[W].p(te,O),$(M[W],1)):(M[W]=yn(te),M[W].c(),$(M[W],1),M[W].m(E,null))}for(me(),W=j.length;W<M.length;W+=1)P(W);he()}},i(T){if(!B){$(s.$$.fragment,T),$(a.$$.fragment,T),$(u.$$.fragment,T),$(S),$(m.$$.fragment,T),$(k.$$.fragment,T),$(A);for(let O=0;O<j.length;O+=1)$(M[O]);B=!0}},o(T){g(s.$$.fragment,T),g(a.$$.fragment,T),g(u.$$.fragment,T),g(S),g(m.$$.fragment,T),g(k.$$.fragment,T),g(A),M=M.filter(Boolean);for(let O=0;O<M.length;O+=1)g(M[O]);B=!1},d(T){T&&d(e),y(s),y(a),y(u),S&&S.d(),y(m),y(k),A&&A.d(),Vt(M,T)}}}function gp(r){let e,t,n,o,s,l,a,i,u,f,c;return e=new bo({props:{colorInterventions:On("v1")}}),n=new ie({props:{layer:"interventions-points",tooltip:r[8],clickable:!1}}),s=new ie({props:{layer:"interventions-lines",tooltip:r[8],clickable:!1}}),a=new ie({props:{layer:"interventions-polygons",tooltip:r[8],clickable:!1}}),f=new _c({props:{style:r[6]}}),{c(){b(e.$$.fragment),t=D(),b(n.$$.fragment),o=D(),b(s.$$.fragment),l=D(),b(a.$$.fragment),i=D(),u=N("div"),b(f.$$.fragment),ee(u,"class","top-right svelte-u44ed2")},m(p,m){w(e,p,m),h(p,t,m),w(n,p,m),h(p,o,m),w(s,p,m),h(p,l,m),w(a,p,m),h(p,i,m),h(p,u,m),w(f,u,null),c=!0},p:ne,i(p){c||($(e.$$.fragment,p),$(n.$$.fragment,p),$(s.$$.fragment,p),$(a.$$.fragment,p),$(f.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(a.$$.fragment,p),g(f.$$.fragment,p),c=!1},d(p){p&&(d(t),d(o),d(l),d(i),d(u)),y(e,p),y(n,p),y(s,p),y(a,p),y(f)}}}function _p(r){let e,t,n,o,s;return t=new hp({}),o=new Lo({props:{style:r[6],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[gp]},$$scope:{ctx:r}}}),{c(){e=N("div"),b(t.$$.fragment),n=D(),b(o.$$.fragment),ee(e,"slot","main")},m(l,a){h(l,e,a),w(t,e,null),I(e,n),w(o,e,null),s=!0},p(l,a){const i={};a&65536&&(i.$$scope={dirty:a,ctx:l}),o.$set(i)},i(l){s||($(t.$$.fragment,l),$(o.$$.fragment,l),s=!0)},o(l){g(t.$$.fragment,l),g(o.$$.fragment,l),s=!1},d(l){l&&d(e),y(t),y(o)}}}function bp(r){let e,t;return e=new Co({props:{$$slots:{main:[_p],sidebar:[$p]},$$scope:{ctx:r}}}),{c(){b(e.$$.fragment)},m(n,o){w(e,n,o),t=!0},p(n,[o]){const s={};o&65567&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){y(e,n)}}}function wp(r,e,t){let n;V(r,kt,C=>t(4,n=C));let o=new Set(Tc);Bt(()=>{mo()});let l=new URLSearchParams(window.location.search).get("style")||"dataviz",a="",i=new Map,u=new Set,f="";qt(()=>{kt.set(Sn())});function c(C){try{let L=JSON.parse(C);t(1,i=el(L)),kt.set(L),t(0,a="")}catch(L){t(0,a=`The file you loaded is broken: ${L}`)}}function p(C){let L=C.properties;var E='<div style="max-width: 30vw;">';return E+=`<h2>${m(L.name)} (${L.intervention_type})</h2>`,E+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(E+=`<p>Length: ${ho(L.length_meters)}</p>`),L.description&&(E+=`<p>${m(L.description)}</p>`),E+="</div>",E}function m(C){return f?C.replace(new RegExp(f,"gi"),L=>`<mark>${L}</mark>`):C}function _(C){u=C,t(2,u)}function k(C){f=C,t(3,f)}return[a,i,u,f,n,o,l,c,p,_,k]}class yp extends Z{constructor(e){super(),K(this,e,wp,bp,x,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new yp({target:document.getElementById("app")});
