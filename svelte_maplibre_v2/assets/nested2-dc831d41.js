import{S as U,i as G,s as z,M as Kr,b as q,c as Y,e as M,d as O,g as h,av as Zr,h as Z,j as d,k as L,m as b,w as pt,l as J,t as m,n as _,p as g,q as v,aH as Re,aI as We,aJ as ze,aK as Ue,a2 as de,y as ne,o as re,H as Yr,N as ee,a5 as mt,aQ as ot,x,aR as fe,aS as Ze,aT as Jr,aU as Qr,aV as xr,r as $t,u as S,f as ln,am as eo,C as Qe,ao as kr,T as at,F as Sr,a as _t,v as dn,I as K,B as Yt,aA as to,ax as je,aL as no,aM as ro,ad as oo,_ as sn,P as lo,Y as an,aP as X,an as He,ay as Ot,aW as Cr,Q as so,G as Lr,aX as Je,aY as ue,R as Tr,aZ as fn,a_ as io,Z as gn,E as Or,a$ as _n,D as ao,aO as hn,L as fo,z as uo,aE as co}from"./index-f49a6f3b.js";import{g as dt,u as po,e as Ar,m as mo,f as At,C as Ie,b as yt,d as ie,c as $o,a as go,B as _o,S as ho,L as bo,M as vo}from"./StreetViewController-ff292adf.js";import{L as wo,h as bn,f as Ir,l as yo,C as we,Z as ko,I as So}from"./index-eacc782b.js";import{I as Ye}from"./InteractiveLayer-c941219d.js";import{F as Co}from"./FileInput-5117677e.js";const Lo="/atip/svelte_maplibre_v2/assets/help-d011708a.svg";function To(r){let e,n;const t=r[1].default,o=Re(t,r,r[4],null);return{c(){e=M("div"),o&&o.c(),Z(e,"class","govuk-prose")},m(l,i){d(l,e,i),o&&o.m(e,null),n=!0},p(l,i){o&&o.p&&(!n||i&16)&&We(o,t,l,l[4],n?Ue(t,l[4],i,null):ze(l[4]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&g(e),o&&o.d(l)}}}function Oo(r){let e,n,t,o,l,i,a,s,f;function u(p){r[3](p)}let c={title:"Help",$$slots:{default:[To]},$$scope:{ctx:r}};return r[0]!==void 0&&(c.open=r[0]),l=new Kr({props:c}),q.push(()=>Y(l,"open",u)),{c(){e=M("button"),n=M("img"),o=O(),h(l.$$.fragment),Zr(n.src,t=Lo)||Z(n,"src",t),Z(n,"title","Help"),Z(n,"alt","Help"),Z(e,"class","svelte-7d9d1l")},m(p,$){d(p,e,$),L(e,n),d(p,o,$),b(l,p,$),a=!0,s||(f=pt(e,"click",r[2]),s=!0)},p(p,[$]){const k={};$&16&&(k.$$scope={dirty:$,ctx:p}),!i&&$&1&&(i=!0,k.open=p[0],J(()=>i=!1)),l.$set(k)},i(p){a||(m(l.$$.fragment,p),a=!0)},o(p){_(l.$$.fragment,p),a=!1},d(p){p&&(g(e),g(o)),v(l,p),s=!1,f()}}}function Ao(r,e,n){let{$$slots:t={},$$scope:o}=e,l=!1;const i=()=>n(0,l=!0);function a(s){l=s,n(0,l)}return r.$$set=s=>{"$$scope"in s&&n(4,o=s.$$scope)},[l,t,i,a,o]}class ae extends U{constructor(e){super(),G(this,e,Ao,Oo,z,{})}}function vn(r){let e;return n=>{if(n)for(let t in n){let o=e==null?void 0:e[t],l=n[t];o!==l&&r(t,l,o)}else if(e)for(let t in e)r(t,void 0,e[t]);e=n}}function Io(r,...e){let n=[r];for(let t of e)if(t)Array.isArray(t)&&t[0]===r?n.push(...t.slice(1)):n.push(t);else continue;if(n.length!==1)return n.length===2?n[1]:n}function Po(r){return r===!0?["has","point_count"]:r===!1?["!",["has","point_count"]]:void 0}function ve(r,e){return["case",["boolean",["feature-state","hover"],!1],e,r]}var It=Mo;function Mo(r){var e,n,t;if(r){if(Array.isArray(r)){for(e=[],n=r.length,t=0;t<n;t++){var o=r[t];o!=null&&e.push(o)}return e}if(typeof r=="object"){e={};var l=Object.keys(r);for(n=l.length,t=0;t<n;t++){var i=l[t],a=r[i];a!=null&&(e[i]=a)}return e}}}function wn(r){let e=r[0],n,t,o=yn(r);return{c(){o.c(),n=de()},m(l,i){o.m(l,i),d(l,n,i),t=!0},p(l,i){i[0]&1&&z(e,e=l[0])?(ne(),_(o,1,1,x),re(),o=yn(l),o.c(),m(o,1),o.m(n.parentNode,n)):o.p(l,i)},i(l){t||(m(o),t=!0)},o(l){_(o),t=!1},d(l){l&&g(n),o.d(l)}}}function yn(r){let e;const n=r[35].default,t=Re(n,r,r[34],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l[1]&8)&&We(t,n,o,o[34],e?Ue(n,o[34],l,null):ze(o[34]),null)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function Eo(r){let e,n,t=r[0]&&wn(r);return{c(){t&&t.c(),e=de()},m(o,l){t&&t.m(o,l),d(o,e,l),n=!0},p(o,l){o[0]?t?(t.p(o,l),l[0]&1&&m(t,1)):(t=wn(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(ne(),_(t,1,1,()=>{t=null}),re())},i(o){n||(m(t),n=!0)},o(o){_(t),n=!1},d(o){o&&g(e),t&&t.d(o)}}}function No(r,e,n){let t,o,l,i,a,s,f,u,c,p,$,k,{$$slots:w={},$$scope:C}=e,{id:y=dt("layer")}=e,{source:P=void 0}=e,{sourceLayer:D=void 0}=e,{beforeId:I=void 0}=e,{beforeLayerType:N=void 0}=e,{type:F}=e,{paint:A=void 0}=e,{layout:E=void 0}=e,{filter:j=void 0}=e,{applyToClusters:T=void 0}=e,{minzoom:H=void 0}=e,{maxzoom:W=void 0}=e,{manageHoverState:V=!1}=e,{hovered:le=null}=e,{hoverCursor:Ee=void 0}=e,{eventsIfTopMost:oe=!1}=e;const ce=Yr(),{map:ke,source:ge,self:_e,minzoom:Ve,maxzoom:Le,eventTopMost:Ne}=po();ee(r,ke,R=>n(30,c=R)),ee(r,ge,R=>n(31,p=R)),ee(r,_e,R=>n(0,u=R)),ee(r,Ve,R=>n(33,k=R)),ee(r,Le,R=>n(32,$=R)),mt(()=>{u&&c&&(c==null||c.removeLayer(u))});let me;return r.$$set=R=>{"id"in R&&n(7,y=R.id),"source"in R&&n(8,P=R.source),"sourceLayer"in R&&n(9,D=R.sourceLayer),"beforeId"in R&&n(10,I=R.beforeId),"beforeLayerType"in R&&n(11,N=R.beforeLayerType),"type"in R&&n(12,F=R.type),"paint"in R&&n(13,A=R.paint),"layout"in R&&n(14,E=R.layout),"filter"in R&&n(15,j=R.filter),"applyToClusters"in R&&n(16,T=R.applyToClusters),"minzoom"in R&&n(17,H=R.minzoom),"maxzoom"in R&&n(18,W=R.maxzoom),"manageHoverState"in R&&n(19,V=R.manageHoverState),"hovered"in R&&n(6,le=R.hovered),"hoverCursor"in R&&n(20,Ee=R.hoverCursor),"eventsIfTopMost"in R&&n(21,oe=R.eventsIfTopMost),"$$scope"in R&&n(34,C=R.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&65536&&n(29,t=Po(T)),r.$$.dirty[0]&536903680&&n(28,o=Io("all",t,j)),r.$$.dirty[0]&131072|r.$$.dirty[1]&4&&n(24,l=H??k),r.$$.dirty[0]&262144|r.$$.dirty[1]&2&&n(23,i=W??$),r.$$.dirty[0]&256|r.$$.dirty[1]&1&&n(27,a=P||p),r.$$.dirty[0]&1509457537&&c&&u!==y&&a){let R=function(se){var qe,Xe;if(!u||!c||oe&&Ne(se)!==u)return;let B=se.features??[],Se=(Xe=(qe=B[0])==null?void 0:qe.properties)==null?void 0:Xe.cluster_id,Ce={event:se,map:c,clusterId:Se,layer:u,source:a,features:B};ce(se.type,Ce)},Te=I;if(!I&&N){let se=c.getStyle().layers,B=typeof N=="function"?N:Ce=>Ce.type===N,Se=se==null?void 0:se.find(B);Se&&(Te=Se.id)}ot(_e,u=y,u),c.addLayer(It({id:u,type:F,source:a,"source-layer":D,filter:o,paint:A,layout:E,minzoom:l,maxzoom:i}),Te),c.on("click",u,R),c.on("dblclick",u,R),c.on("contextmenu",u,R),c.on("mouseenter",u,se=>{var qe,Xe;if(!u||!c||oe&&Ne(se)!==u)return;Ee&&(c.getCanvas().style.cursor=Ee);let B=se.features??[];n(6,le=B[0]??null);let Se=(Xe=(qe=B[0])==null?void 0:qe.properties)==null?void 0:Xe.cluster_id;ce("mouseenter",{event:se,map:c,clusterId:Se,layer:u,source:a,features:B})}),c.on("mousemove",u,se=>{var qe,Xe,$n;if(oe&&Ne(se)!==u)return;let B=se.features??[],Se=(Xe=(qe=B[0])==null?void 0:qe.properties)==null?void 0:Xe.cluster_id,Ce=($n=B[0])==null?void 0:$n.id;Ce!==me&&(V&&(me!==void 0&&(c==null||c.setFeatureState({source:a,id:me},{hover:!1})),c==null||c.setFeatureState({source:a,id:Ce},{hover:!0})),n(22,me=Ce),n(6,le=B[0]??null)),ce("mousemove",{event:se,map:c,clusterId:Se,layer:u,source:a,features:B})}),c.on("mouseleave",u,se=>{!u||!c||(Ee&&(c.getCanvas().style.cursor=""),n(6,le=null),V&&me!==void 0&&(c==null||c.setFeatureState({source:a,id:me},{hover:!1}),n(22,me=void 0)),ce("mouseleave",{map:c,layer:u,source:a}))})}r.$$.dirty[0]&1073741825&&n(26,s=u?vn((R,Te)=>c==null?void 0:c.setPaintProperty(u,R,Te)):void 0),r.$$.dirty[0]&1073741825&&n(25,f=u?vn((R,Te)=>c==null?void 0:c.setLayoutProperty(u,R,Te)):void 0),r.$$.dirty[0]&67117056&&(s==null||s(A)),r.$$.dirty[0]&33570816&&(f==null||f(E)),r.$$.dirty[0]&1098907649&&u&&(c==null||c.setLayerZoomRange(u,l,i))},[u,ke,ge,_e,Ve,Le,le,y,P,D,I,N,F,A,E,j,T,H,W,V,Ee,oe,me,i,l,f,s,a,o,t,c,p,$,k,C,w]}class un extends U{constructor(e){super(),G(this,e,No,Eo,z,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,hoverCursor:20,eventsIfTopMost:21},null,[-1,-1])}}function Do(r){let e;const n=r[15].default,t=Re(n,r,r[23],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&8388608)&&We(t,n,o,o[23],e?Ue(n,o[23],l,null):ze(o[23]),null)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function Fo(r){let e,n,t;function o(i){r[16](i)}let l={id:r[1],type:"circle",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],applyToClusters:r[9],minzoom:r[10],maxzoom:r[11],hoverCursor:r[12],manageHoverState:r[13],eventsIfTopMost:r[14],$$slots:{default:[Do]},$$scope:{ctx:r}};return r[0]!==void 0&&(l.hovered=r[0]),e=new un({props:l}),q.push(()=>Y(e,"hovered",o)),e.$on("click",r[17]),e.$on("dblclick",r[18]),e.$on("contextmenu",r[19]),e.$on("mouseenter",r[20]),e.$on("mousemove",r[21]),e.$on("mouseleave",r[22]),{c(){h(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.applyToClusters=i[9]),a&1024&&(s.minzoom=i[10]),a&2048&&(s.maxzoom=i[11]),a&4096&&(s.hoverCursor=i[12]),a&8192&&(s.manageHoverState=i[13]),a&16384&&(s.eventsIfTopMost=i[14]),a&8388608&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.hovered=i[0],J(()=>n=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){_(e.$$.fragment,i),t=!1},d(i){v(e,i)}}}function jo(r,e,n){let{$$slots:t={},$$scope:o}=e,{id:l=dt("circle")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:u}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{applyToClusters:$=void 0}=e,{minzoom:k=void 0}=e,{maxzoom:w=void 0}=e,{hoverCursor:C=void 0}=e,{manageHoverState:y=!1}=e,{hovered:P=null}=e,{eventsIfTopMost:D=!1}=e;function I(H){P=H,n(0,P)}function N(H){fe.call(this,r,H)}function F(H){fe.call(this,r,H)}function A(H){fe.call(this,r,H)}function E(H){fe.call(this,r,H)}function j(H){fe.call(this,r,H)}function T(H){fe.call(this,r,H)}return r.$$set=H=>{"id"in H&&n(1,l=H.id),"source"in H&&n(2,i=H.source),"sourceLayer"in H&&n(3,a=H.sourceLayer),"beforeId"in H&&n(4,s=H.beforeId),"beforeLayerType"in H&&n(5,f=H.beforeLayerType),"paint"in H&&n(6,u=H.paint),"layout"in H&&n(7,c=H.layout),"filter"in H&&n(8,p=H.filter),"applyToClusters"in H&&n(9,$=H.applyToClusters),"minzoom"in H&&n(10,k=H.minzoom),"maxzoom"in H&&n(11,w=H.maxzoom),"hoverCursor"in H&&n(12,C=H.hoverCursor),"manageHoverState"in H&&n(13,y=H.manageHoverState),"hovered"in H&&n(0,P=H.hovered),"eventsIfTopMost"in H&&n(14,D=H.eventsIfTopMost),"$$scope"in H&&n(23,o=H.$$scope)},[P,l,i,a,s,f,u,c,p,$,k,w,C,y,D,t,I,N,F,A,E,j,T,o]}class zt extends U{constructor(e){super(),G(this,e,jo,Fo,z,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14})}}function Bo(r){let e;const n=r[14].default,t=Re(n,r,r[22],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&4194304)&&We(t,n,o,o[22],e?Ue(n,o[22],l,null):ze(o[22]),null)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function Ho(r){let e,n,t;function o(i){r[15](i)}let l={id:r[1],type:"fill",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],$$slots:{default:[Bo]},$$scope:{ctx:r}};return r[0]!==void 0&&(l.hovered=r[0]),e=new un({props:l}),q.push(()=>Y(e,"hovered",o)),e.$on("click",r[16]),e.$on("dblclick",r[17]),e.$on("contextmenu",r[18]),e.$on("mouseenter",r[19]),e.$on("mousemove",r[20]),e.$on("mouseleave",r[21]),{c(){h(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.minzoom=i[9]),a&1024&&(s.maxzoom=i[10]),a&2048&&(s.hoverCursor=i[11]),a&4096&&(s.manageHoverState=i[12]),a&8192&&(s.eventsIfTopMost=i[13]),a&4194304&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.hovered=i[0],J(()=>n=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){_(e.$$.fragment,i),t=!1},d(i){v(e,i)}}}function Ro(r,e,n){let{$$slots:t={},$$scope:o}=e,{id:l=dt("fill")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:u}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{minzoom:$=void 0}=e,{maxzoom:k=void 0}=e,{hoverCursor:w=void 0}=e,{manageHoverState:C=!1}=e,{hovered:y=null}=e,{eventsIfTopMost:P=!1}=e;function D(T){y=T,n(0,y)}function I(T){fe.call(this,r,T)}function N(T){fe.call(this,r,T)}function F(T){fe.call(this,r,T)}function A(T){fe.call(this,r,T)}function E(T){fe.call(this,r,T)}function j(T){fe.call(this,r,T)}return r.$$set=T=>{"id"in T&&n(1,l=T.id),"source"in T&&n(2,i=T.source),"sourceLayer"in T&&n(3,a=T.sourceLayer),"beforeId"in T&&n(4,s=T.beforeId),"beforeLayerType"in T&&n(5,f=T.beforeLayerType),"paint"in T&&n(6,u=T.paint),"layout"in T&&n(7,c=T.layout),"filter"in T&&n(8,p=T.filter),"minzoom"in T&&n(9,$=T.minzoom),"maxzoom"in T&&n(10,k=T.maxzoom),"hoverCursor"in T&&n(11,w=T.hoverCursor),"manageHoverState"in T&&n(12,C=T.manageHoverState),"hovered"in T&&n(0,y=T.hovered),"eventsIfTopMost"in T&&n(13,P=T.eventsIfTopMost),"$$scope"in T&&n(22,o=T.$$scope)},[y,l,i,a,s,f,u,c,p,$,k,w,C,P,t,D,I,N,F,A,E,j,o]}class st extends U{constructor(e){super(),G(this,e,Ro,Ho,z,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}function kn(r){let e=r[0],n,t,o=Sn(r);return{c(){o.c(),n=de()},m(l,i){o.m(l,i),d(l,n,i),t=!0},p(l,i){i&1&&z(e,e=l[0])?(ne(),_(o,1,1,x),re(),o=Sn(l),o.c(),m(o,1),o.m(n.parentNode,n)):o.p(l,i)},i(l){t||(m(o),t=!0)},o(l){_(o),t=!1},d(l){l&&g(n),o.d(l)}}}function Sn(r){let e;const n=r[15].default,t=Re(n,r,r[14],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&16384)&&We(t,n,o,o[14],e?Ue(n,o[14],l,null):ze(o[14]),null)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function Wo(r){let e,n,t=r[0]&&kn(r);return{c(){t&&t.c(),e=de()},m(o,l){t&&t.m(o,l),d(o,e,l),n=!0},p(o,[l]){o[0]?t?(t.p(o,l),l&1&&m(t,1)):(t=kn(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(ne(),_(t,1,1,()=>{t=null}),re())},i(o){n||(m(t),n=!0)},o(o){_(t),n=!1},d(o){o&&g(e),t&&t.d(o)}}}function zo(r,e){if(r.getSource(e)){let n=[];for(let t of r.getStyle().layers)"source"in t&&t.source==e&&n.push(t.id);for(let t of n)console.log(`had to remove ${t} first`),r.removeLayer(t);r.removeSource(e)}}function Uo(r,e,n){let t,o,l,{$$slots:i={},$$scope:a}=e,{id:s=dt("geojson")}=e,{data:f}=e,{generateId:u=!1}=e,{promoteId:c=void 0}=e,{filter:p=void 0}=e,{lineMetrics:$=void 0}=e,{cluster:k=void 0}=e;const{map:w,cluster:C,self:y}=Ar();ee(r,w,I=>n(13,t=I)),ee(r,C,I=>n(16,l=I)),ee(r,y,I=>n(0,o=I));let P,D=!0;return mt(()=>{if(console.log("gj source getting torn down"),o){let I=o;if(console.log(`... will be removing ${I}`),ot(y,o=null,o),n(11,P=void 0),t!=null&&t.loaded()){console.log(`... actually removed ${I}`),zo(t,I);let N=t.getSource(I);console.log(`its gone, right? ${N}`)}}}),r.$$set=I=>{"id"in I&&n(4,s=I.id),"data"in I&&n(5,f=I.data),"generateId"in I&&n(6,u=I.generateId),"promoteId"in I&&n(7,c=I.promoteId),"filter"in I&&n(8,p=I.filter),"lineMetrics"in I&&n(9,$=I.lineMetrics),"cluster"in I&&n(10,k=I.cluster),"$$scope"in I&&n(14,a=I.$$scope)},r.$$.update=()=>{r.$$.dirty&1024&&ot(C,l=k,l),r.$$.dirty&10225&&t&&o!==s&&(console.log(`$source is ${o}, id is ${s}`),o&&(console.log(`removing existing $source ${o}`),t.removeSource(o)),ot(y,o=s,o),console.log(`just set $source to ${s}. adding source now.`),t.addSource(o,It({type:"geojson",data:f,filter:p,lineMetrics:$,generateId:u,promoteId:c,cluster:!!k,clusterMinPoints:k==null?void 0:k.minPoints,clusterMaxZoom:k==null?void 0:k.maxZoom,clusterRadius:k==null?void 0:k.radius,clusterProperties:k==null?void 0:k.properties})),n(11,P=t.getSource(o)),n(12,D=!0)),r.$$.dirty&6176&&P&&(D?n(12,D=!1):P.setData(f)),r.$$.dirty&3072&&(P==null||P.setClusterOptions(It({cluster:!!k,clusterMaxZoom:k==null?void 0:k.maxZoom,clusterRadius:k==null?void 0:k.radius})))},[o,w,C,y,s,f,u,c,p,$,k,P,D,t,a,i]}class cn extends U{constructor(e){super(),G(this,e,Uo,Wo,z,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function Go(r){let e;const n=r[14].default,t=Re(n,r,r[22],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&4194304)&&We(t,n,o,o[22],e?Ue(n,o[22],l,null):ze(o[22]),null)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function Vo(r){let e,n,t;function o(i){r[15](i)}let l={id:r[1],type:"line",source:r[2],sourceLayer:r[3],beforeId:r[4],beforeLayerType:r[5],paint:r[6],layout:r[7],filter:r[8],minzoom:r[9],maxzoom:r[10],hoverCursor:r[11],manageHoverState:r[12],eventsIfTopMost:r[13],$$slots:{default:[Go]},$$scope:{ctx:r}};return r[0]!==void 0&&(l.hovered=r[0]),e=new un({props:l}),q.push(()=>Y(e,"hovered",o)),e.$on("click",r[16]),e.$on("dblclick",r[17]),e.$on("contextmenu",r[18]),e.$on("mouseenter",r[19]),e.$on("mousemove",r[20]),e.$on("mouseleave",r[21]),{c(){h(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,[a]){const s={};a&2&&(s.id=i[1]),a&4&&(s.source=i[2]),a&8&&(s.sourceLayer=i[3]),a&16&&(s.beforeId=i[4]),a&32&&(s.beforeLayerType=i[5]),a&64&&(s.paint=i[6]),a&128&&(s.layout=i[7]),a&256&&(s.filter=i[8]),a&512&&(s.minzoom=i[9]),a&1024&&(s.maxzoom=i[10]),a&2048&&(s.hoverCursor=i[11]),a&4096&&(s.manageHoverState=i[12]),a&8192&&(s.eventsIfTopMost=i[13]),a&4194304&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.hovered=i[0],J(()=>n=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){_(e.$$.fragment,i),t=!1},d(i){v(e,i)}}}function qo(r,e,n){let{$$slots:t={},$$scope:o}=e,{id:l=dt("line")}=e,{source:i=void 0}=e,{sourceLayer:a=void 0}=e,{beforeId:s=void 0}=e,{beforeLayerType:f=void 0}=e,{paint:u}=e,{layout:c=void 0}=e,{filter:p=void 0}=e,{minzoom:$=void 0}=e,{maxzoom:k=void 0}=e,{hoverCursor:w=void 0}=e,{manageHoverState:C=!1}=e,{hovered:y=null}=e,{eventsIfTopMost:P=!1}=e;function D(T){y=T,n(0,y)}function I(T){fe.call(this,r,T)}function N(T){fe.call(this,r,T)}function F(T){fe.call(this,r,T)}function A(T){fe.call(this,r,T)}function E(T){fe.call(this,r,T)}function j(T){fe.call(this,r,T)}return r.$$set=T=>{"id"in T&&n(1,l=T.id),"source"in T&&n(2,i=T.source),"sourceLayer"in T&&n(3,a=T.sourceLayer),"beforeId"in T&&n(4,s=T.beforeId),"beforeLayerType"in T&&n(5,f=T.beforeLayerType),"paint"in T&&n(6,u=T.paint),"layout"in T&&n(7,c=T.layout),"filter"in T&&n(8,p=T.filter),"minzoom"in T&&n(9,$=T.minzoom),"maxzoom"in T&&n(10,k=T.maxzoom),"hoverCursor"in T&&n(11,w=T.hoverCursor),"manageHoverState"in T&&n(12,C=T.manageHoverState),"hovered"in T&&n(0,y=T.hovered),"eventsIfTopMost"in T&&n(13,P=T.eventsIfTopMost),"$$scope"in T&&n(22,o=T.$$scope)},[y,l,i,a,s,f,u,c,p,$,k,w,C,P,t,D,I,N,F,A,E,j,o]}class Me extends U{constructor(e){super(),G(this,e,qo,Vo,z,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13})}}function Cn(r){let e=r[0],n,t,o=Ln(r);return{c(){o.c(),n=de()},m(l,i){o.m(l,i),d(l,n,i),t=!0},p(l,i){i&1&&z(e,e=l[0])?(ne(),_(o,1,1,x),re(),o=Ln(l),o.c(),m(o,1),o.m(n.parentNode,n)):o.p(l,i)},i(l){t||(m(o),t=!0)},o(l){_(o),t=!1},d(l){l&&g(n),o.d(l)}}}function Ln(r){let e;const n=r[8].default,t=Re(n,r,r[7],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&128)&&We(t,n,o,o[7],e?Ue(n,o[7],l,null):ze(o[7]),null)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function Xo(r){let e,n,t=r[0]&&Cn(r);return{c(){t&&t.c(),e=de()},m(o,l){t&&t.m(o,l),d(o,e,l),n=!0},p(o,[l]){o[0]?t?(t.p(o,l),l&1&&m(t,1)):(t=Cn(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(ne(),_(t,1,1,()=>{t=null}),re())},i(o){n||(m(t),n=!0)},o(o){_(t),n=!1},d(o){o&&g(e),t&&t.d(o)}}}function Ko(r,e,n){let t,o,{$$slots:l={},$$scope:i}=e,{id:a=dt("vector")}=e,{url:s=null}=e,{tiles:f=null}=e;if(s&&s.includes("pmtiles://")&&!Ze.config.REGISTERED_PROTOCOLS.hasOwnProperty("pmtiles")){let p=new Qr;Ze.addProtocol("pmtiles",p.tile)}const{map:u,self:c}=Ar();return ee(r,u,p=>n(6,t=p)),ee(r,c,p=>n(0,o=p)),mt(()=>{if(o){let p=o;ot(c,o=null,o),Jr().then(()=>{t!=null&&t.loaded()&&(t==null||t.removeSource(p))})}}),r.$$set=p=>{"id"in p&&n(3,a=p.id),"url"in p&&n(4,s=p.url),"tiles"in p&&n(5,f=p.tiles),"$$scope"in p&&n(7,i=p.$$scope)},r.$$.update=()=>{r.$$.dirty&121&&t&&o!==a&&(o&&t.removeSource(o),ot(c,o=a,o),t.addSource(o,It({type:"vector",url:s,tiles:f})))},[o,u,c,a,s,f,t,i,l]}class ye extends U{constructor(e){super(),G(this,e,Ko,Xo,z,{id:3,url:4,tiles:5})}}const Zo=r=>({features:r[0]&16,data:r[0]&16,map:r[0]&4,close:r[0]&1}),Tn=r=>{var e;return{features:r[4],data:(e=r[4])==null?void 0:e[0],map:r[2],close:r[29]}};function On(r){let e,n,t=(r[4]||r[3]instanceof Ze.Marker)&&An(r);return{c(){e=M("div"),t&&t.c()},m(o,l){d(o,e,l),t&&t.m(e,null),r[30](e),n=!0},p(o,l){o[4]||o[3]instanceof Ze.Marker?t?(t.p(o,l),l[0]&24&&m(t,1)):(t=An(o),t.c(),m(t,1),t.m(e,null)):t&&(ne(),_(t,1,1,()=>{t=null}),re())},i(o){n||(m(t),n=!0)},o(o){_(t),n=!1},d(o){o&&g(e),t&&t.d(),r[30](null)}}}function An(r){let e;const n=r[28].default,t=Re(n,r,r[27],Tn);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l[0]&134217749)&&We(t,n,o,o[27],e?Ue(n,o[27],l,Zo):ze(o[27]),Tn)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function Yo(r){let e,n,t=r[8].default&&On(r);return{c(){t&&t.c(),e=de()},m(o,l){t&&t.m(o,l),d(o,e,l),n=!0},p(o,l){o[8].default?t?(t.p(o,l),l[0]&256&&m(t,1)):(t=On(o),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(ne(),_(t,1,1,()=>{t=null}),re())},i(o){n||(m(t),n=!0)},o(o){_(t),n=!1},d(o){o&&g(e),t&&t.d(o)}}}function Jo(r,e,n){let t,o,l,i,a,{$$slots:s={},$$scope:f}=e;const u=xr(s);let{closeButton:c=void 0}=e,{closeOnClickOutside:p=!0}=e,{closeOnClickInside:$=!1}=e,{closeOnMove:k=!1}=e,{openOn:w="click"}=e,{focusAfterOpen:C=!0}=e,{anchor:y=void 0}=e,{offset:P=void 0}=e,{popupClass:D=void 0}=e,{maxWidth:I=void 0}=e,{lngLat:N=void 0}=e,{html:F=void 0}=e,{open:A=!1}=e;const{map:E,popupTarget:j,layerEvent:T}=mo();ee(r,E,B=>n(2,l=B)),ee(r,j,B=>n(3,a=B)),ee(r,T,B=>n(26,i=B));const H=["click","dblclick","contextmenu"];let W,V=!1,le;function Ee(){if(!W)return;let B=W.getElement();!B||B===le||(le=B,w==="hover"&&(le.style.pointerEvents="none"),le.addEventListener("mouseenter",()=>{n(22,V=!0)},{passive:!0}),le.addEventListener("mouseleave",()=>{n(22,V=!1)},{passive:!0}),le.addEventListener("click",()=>{$&&n(0,A=!1)},{passive:!0}))}$t(()=>{if(l)return l.on("click",me),typeof a=="string"&&(l.on("click",a,ke),l.on("dblclick",a,ke),l.on("contextmenu",a,ke),l.on("mousemove",a,Ne),l.on("mouseleave",a,Le),l.on("touchstart",a,_e),l.on("touchend",a,Ve)),()=>{l!=null&&l.loaded()&&(W==null||W.remove(),l.off("click",me),a instanceof Ze.Marker?a.getPopup()===W&&a.setPopup(void 0):typeof a=="string"&&(l.off("click",a,ke),l.off("dblclick",a,ke),l.off("contextmenu",a,ke),l.off("mousemove",a,Ne),l.off("mouseleave",a,Le),l.off("touchstart",a,_e),l.off("touchend",a,Ve)))}});let oe=null,ce="normal";function ke(B){B.type===w&&("layerType"in B?B.layerType==="deckgl"?(n(9,N=B.coordinate),n(4,oe=B.object?[B.object]:null)):(n(9,N=B.lngLat),n(4,oe=B.features??[])):(n(9,N=B.lngLat),n(4,oe=B.features??[])),setTimeout(()=>n(0,A=!0)))}let ge=null;function _e(B){ge=B.point}function Ve(B){if(!ge||w!=="hover")return;let Se=ge.dist(B.point);ge=null,Se<3&&(n(9,N=B.lngLat),n(4,oe=B.features??[]),W.isOpen()?n(23,ce="justOpened"):(n(23,ce="opening"),n(0,A=!0)))}function Le(B){w!=="hover"||ge||ce!=="normal"||(n(0,A=!1),n(4,oe=null))}function Ne(B){w!=="hover"||ge||ce!=="normal"||(n(0,A=!0),n(4,oe=B.features??[]),n(9,N=B.lngLat))}function me(B){if(ce==="justOpened"){n(23,ce="normal");return}if(!p)return;let Se=[le,a instanceof Ze.Marker?a==null?void 0:a.getElement():null];A&&W.isOpen()&&!Se.some(Ce=>Ce==null?void 0:Ce.contains(B.originalEvent.target))&&n(0,A=!1)}let R;const Te=()=>n(0,A=!1);function se(B){q[B?"unshift":"push"](()=>{R=B,n(1,R)})}return r.$$set=B=>{"closeButton"in B&&n(10,c=B.closeButton),"closeOnClickOutside"in B&&n(11,p=B.closeOnClickOutside),"closeOnClickInside"in B&&n(12,$=B.closeOnClickInside),"closeOnMove"in B&&n(13,k=B.closeOnMove),"openOn"in B&&n(14,w=B.openOn),"focusAfterOpen"in B&&n(15,C=B.focusAfterOpen),"anchor"in B&&n(16,y=B.anchor),"offset"in B&&n(17,P=B.offset),"popupClass"in B&&n(18,D=B.popupClass),"maxWidth"in B&&n(19,I=B.maxWidth),"lngLat"in B&&n(9,N=B.lngLat),"html"in B&&n(20,F=B.html),"open"in B&&n(0,A=B.open),"$$scope"in B&&n(27,f=B.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&7168&&n(25,t=c??(!p&&!$)),r.$$.dirty[0]&36675584&&(W||(n(21,W=new Ze.Popup({closeButton:t,closeOnClick:!1,closeOnMove:k,focusAfterOpen:C,maxWidth:I,className:D,anchor:y,offset:P})),le=W.getElement(),W.on("open",()=>{n(0,A=!0),Ee()}),W.on("close",B=>{n(0,A=!1)}))),r.$$.dirty[0]&2113544&&W&&a instanceof Ze.Marker&&(w==="click"?a.setPopup(W):a.getPopup()===W&&a.setPopup(void 0)),r.$$.dirty[0]&67125248&&H.includes(w)&&(i==null?void 0:i.type)===w&&(ke(i),ot(T,i=null,i)),r.$$.dirty[0]&67125248&&n(24,o=w==="hover"&&((i==null?void 0:i.type)==="mousemove"||(i==null?void 0:i.type)==="mouseenter")),r.$$.dirty[0]&88096768&&w==="hover"&&T&&(o&&i&&(i.layerType==="deckgl"?(n(9,N=i.coordinate),n(4,oe=i.object?[i.object]:null)):(n(9,N=i.lngLat),n(4,oe=i.features??[]))),n(0,A=(o||V)??!1)),r.$$.dirty[0]&3145730&&(R?W.setDOMContent(R):F&&W.setHTML(F)),r.$$.dirty[0]&2097664&&N&&W.setLngLat(N),r.$$.dirty[0]&10485765&&l){let B=W.isOpen();A&&!B?(W.addTo(l),ce==="opening"&&n(23,ce="justOpened")):!A&&B&&W.remove()}},[A,R,l,a,oe,E,j,T,u,N,c,p,$,k,w,C,y,P,D,I,F,W,V,ce,o,t,i,f,s,Te,se]}class pe extends U{constructor(e){super(),G(this,e,Jo,Yo,z,{closeButton:10,closeOnClickOutside:11,closeOnClickInside:12,closeOnMove:13,openOn:14,focusAfterOpen:15,anchor:16,offset:17,popupClass:18,maxWidth:19,lngLat:9,html:20,open:0},null,[-1,-1])}}function Qo(r){let e;return{c(){e=M("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function xo(r){let e,n,t,o,l=r[0]=="Private (development)"&&Qo();return{c(){l&&l.c(),e=O(),n=M("p"),n.textContent="Note the ATF scheme data has not been validated.",t=O(),o=M("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(i,a){l&&l.m(i,a),d(i,e,a),d(i,n,a),d(i,t,a),d(i,o,a)},p:x,d(i){i&&(g(e),g(n),g(t),g(o)),l&&l.d(i)}}}function el(r){let e,n,t,o,l,i;return l=new ae({props:{$$slots:{default:[xo]},$$scope:{ctx:r}}}),{c(){e=M("p"),n=S("App version: "),t=S(r[0]),o=O(),h(l.$$.fragment)},m(a,s){d(a,e,s),L(e,n),L(e,t),L(e,o),b(l,e,null),i=!0},p(a,[s]){const f={};s&2&&(f.$$scope={dirty:s,ctx:a}),l.$set(f)},i(a){i||(m(l.$$.fragment,a),i=!0)},o(a){_(l.$$.fragment,a),i=!1},d(a){a&&g(e),v(l)}}}function tl(r){return[ln()]}class nl extends U{constructor(e){super(),G(this,e,tl,el,z,{})}}const rl={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var he=Uint8Array,nt=Uint16Array,Pr=Uint32Array,Mr=new he([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Er=new he([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ol=new he([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Nr=function(r,e){for(var n=new nt(31),t=0;t<31;++t)n[t]=e+=1<<r[t-1];for(var o=new Pr(n[30]),t=1;t<30;++t)for(var l=n[t];l<n[t+1];++l)o[l]=l-n[t]<<5|t;return[n,o]},Dr=Nr(Mr,2),Fr=Dr[0],ll=Dr[1];Fr[28]=258,ll[258]=28;var sl=Nr(Er,0),il=sl[0],Jt=new nt(32768);for(var te=0;te<32768;++te){var Ke=(te&43690)>>>1|(te&21845)<<1;Ke=(Ke&52428)>>>2|(Ke&13107)<<2,Ke=(Ke&61680)>>>4|(Ke&3855)<<4,Jt[te]=((Ke&65280)>>>8|(Ke&255)<<8)>>>1}var gt=function(r,e,n){for(var t=r.length,o=0,l=new nt(e);o<t;++o)r[o]&&++l[r[o]-1];var i=new nt(e);for(o=0;o<e;++o)i[o]=i[o-1]+l[o-1]<<1;var a;if(n){a=new nt(1<<e);var s=15-e;for(o=0;o<t;++o)if(r[o])for(var f=o<<4|r[o],u=e-r[o],c=i[r[o]-1]++<<u,p=c|(1<<u)-1;c<=p;++c)a[Jt[c]>>>s]=f}else for(a=new nt(t),o=0;o<t;++o)r[o]&&(a[o]=Jt[i[r[o]-1]++]>>>15-r[o]);return a},kt=new he(288);for(var te=0;te<144;++te)kt[te]=8;for(var te=144;te<256;++te)kt[te]=9;for(var te=256;te<280;++te)kt[te]=7;for(var te=280;te<288;++te)kt[te]=8;var jr=new he(32);for(var te=0;te<32;++te)jr[te]=5;var al=gt(kt,9,1),fl=gt(jr,5,1),Ut=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},Oe=function(r,e,n){var t=e/8|0;return(r[t]|r[t+1]<<8)>>(e&7)&n},Gt=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},ul=function(r){return(r+7)/8|0},pn=function(r,e,n){(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length);var t=new(r.BYTES_PER_ELEMENT==2?nt:r.BYTES_PER_ELEMENT==4?Pr:he)(n-e);return t.set(r.subarray(e,n)),t},cl=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ae=function(r,e,n){var t=new Error(e||cl[r]);if(t.code=r,Error.captureStackTrace&&Error.captureStackTrace(t,Ae),!n)throw t;return t},pl=function(r,e,n){var t=r.length;if(!t||n&&n.f&&!n.l)return e||new he(0);var o=!e||n,l=!n||n.i;n||(n={}),e||(e=new he(t*3));var i=function(Te){var se=e.length;if(Te>se){var B=new he(Math.max(se*2,Te));B.set(e),e=B}},a=n.f||0,s=n.p||0,f=n.b||0,u=n.l,c=n.d,p=n.m,$=n.n,k=t*8;do{if(!u){a=Oe(r,s,1);var w=Oe(r,s+1,3);if(s+=3,w)if(w==1)u=al,c=fl,p=9,$=5;else if(w==2){var D=Oe(r,s,31)+257,I=Oe(r,s+10,15)+4,N=D+Oe(r,s+5,31)+1;s+=14;for(var F=new he(N),A=new he(19),E=0;E<I;++E)A[ol[E]]=Oe(r,s+E*3,7);s+=I*3;for(var j=Ut(A),T=(1<<j)-1,H=gt(A,j,1),E=0;E<N;){var W=H[Oe(r,s,T)];s+=W&15;var C=W>>>4;if(C<16)F[E++]=C;else{var V=0,le=0;for(C==16?(le=3+Oe(r,s,3),s+=2,V=F[E-1]):C==17?(le=3+Oe(r,s,7),s+=3):C==18&&(le=11+Oe(r,s,127),s+=7);le--;)F[E++]=V}}var Ee=F.subarray(0,D),oe=F.subarray(D);p=Ut(Ee),$=Ut(oe),u=gt(Ee,p,1),c=gt(oe,$,1)}else Ae(1);else{var C=ul(s)+4,y=r[C-4]|r[C-3]<<8,P=C+y;if(P>t){l&&Ae(0);break}o&&i(f+y),e.set(r.subarray(C,P),f),n.b=f+=y,n.p=s=P*8,n.f=a;continue}if(s>k){l&&Ae(0);break}}o&&i(f+131072);for(var ce=(1<<p)-1,ke=(1<<$)-1,ge=s;;ge=s){var V=u[Gt(r,s)&ce],_e=V>>>4;if(s+=V&15,s>k){l&&Ae(0);break}if(V||Ae(2),_e<256)e[f++]=_e;else if(_e==256){ge=s,u=null;break}else{var Ve=_e-254;if(_e>264){var E=_e-257,Le=Mr[E];Ve=Oe(r,s,(1<<Le)-1)+Fr[E],s+=Le}var Ne=c[Gt(r,s)&ke],me=Ne>>>4;Ne||Ae(3),s+=Ne&15;var oe=il[me];if(me>3){var Le=Er[me];oe+=Gt(r,s)&(1<<Le)-1,s+=Le}if(s>k){l&&Ae(0);break}o&&i(f+131072);for(var R=f+Ve;f<R;f+=4)e[f]=e[f-oe],e[f+1]=e[f+1-oe],e[f+2]=e[f+2-oe],e[f+3]=e[f+3-oe];f=R}}n.l=u,n.p=ge,n.b=f,n.f=a,u&&(a=1,n.m=p,n.d=c,n.n=$)}while(!a);return f==e.length?e:pn(e,0,f)},ml=new he(0),Fe=function(r,e){return r[e]|r[e+1]<<8},Pe=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},Vt=function(r,e){return Pe(r,e)+Pe(r,e+4)*4294967296};function $l(r,e){return pl(r,e)}var Qt=typeof TextDecoder<"u"&&new TextDecoder,dl=0;try{Qt.decode(ml,{stream:!0}),dl=1}catch{}var gl=function(r){for(var e="",n=0;;){var t=r[n++],o=(t>127)+(t>223)+(t>239);if(n+o>r.length)return[e,pn(r,n-1)];o?o==3?(t=((t&15)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,e+=String.fromCharCode(55296|t>>10,56320|t&1023)):o&1?e+=String.fromCharCode((t&31)<<6|r[n++]&63):e+=String.fromCharCode((t&15)<<12|(r[n++]&63)<<6|r[n++]&63):e+=String.fromCharCode(t)}};function Br(r,e){if(e){for(var n="",t=0;t<r.length;t+=16384)n+=String.fromCharCode.apply(null,r.subarray(t,t+16384));return n}else{if(Qt)return Qt.decode(r);var o=gl(r),l=o[0],i=o[1];return i.length&&Ae(8),l}}var _l=function(r,e){return e+30+Fe(r,e+26)+Fe(r,e+28)},hl=function(r,e,n){var t=Fe(r,e+28),o=Br(r.subarray(e+46,e+46+t),!(Fe(r,e+8)&2048)),l=e+46+t,i=Pe(r,e+20),a=n&&i==4294967295?bl(r,l):[i,Pe(r,e+24),Pe(r,e+42)],s=a[0],f=a[1],u=a[2];return[Fe(r,e+10),s,f,o,l+Fe(r,e+30)+Fe(r,e+32),u]},bl=function(r,e){for(;Fe(r,e)!=1;e+=4+Fe(r,e+2));return[Vt(r,e+12),Vt(r,e+4),Vt(r,e+20)]};function vl(r,e){for(var n={},t=r.length-22;Pe(r,t)!=101010256;--t)(!t||r.length-t>65558)&&Ae(13);var o=Fe(r,t+8);if(!o)return{};var l=Pe(r,t+16),i=l==4294967295||o==65535;if(i){var a=Pe(r,t-12);i=Pe(r,a)==101075792,i&&(o=Pe(r,a+32),l=Pe(r,a+48))}for(var s=e&&e.filter,f=0;f<o;++f){var u=hl(r,l,i),c=u[0],p=u[1],$=u[2],k=u[3],w=u[4],C=u[5],y=_l(r,C);l=w,(!s||s({name:k,size:p,originalSize:$,compression:c}))&&(c?c==8?n[k]=$l(r.subarray(y,y+p),new he($)):Ae(14,"unknown compression type "+c):n[k]=pn(r,y,y+p))}return n}function wl(r){return r instanceof File||r instanceof Blob?r.arrayBuffer().then(qt):qt(r)}function qt(r){var e=new Uint8Array(r),n=vl(e);return Promise.resolve(yl(n))}function yl(r){for(var e=[],n=0,t=Object.keys(r);n<t.length;n++){var o=t[n];e[o]=Br(r[o])}return e}function Be(r,e){for(var n=0;n<r.childNodes.length;){var t=r.childNodes[n];if(t.nodeType===1&&lt(t)===e)return t;n++}}function St(r,e){for(var n=[],t=0;t<r.childNodes.length;){var o=r.childNodes[t];o.nodeType===1&&lt(o)===e&&n.push(o),t++}return n}function Pt(r,e,n){for(var t=0;t<r.childNodes.length;){var o=r.childNodes[t];e?o.nodeType===1&&lt(o)===e&&n(o,t):n(o,t),t++}}function kl(r,e,n){var t=[];return Pt(r,e,function(o,l){t.push(n(o,l))}),t}var Sl=/.+\:/;function lt(r){return r.tagName.replace(Sl,"")}function Hr(r){if(r.nodeType!==1)return r.textContent;for(var e="<"+lt(r),n=0;n<r.attributes.length;)e+=" "+r.attributes[n].name+'="'+r.attributes[n].value+'"',n++;e+=">";for(var t=0;t<r.childNodes.length;)e+=Hr(r.childNodes[t]),t++;return e+="</"+lt(r)+">",e}function Cl(r){var e=r.documentElement,n=Be(e,"sheetData"),t=[];return Pt(n,"row",function(o){Pt(o,"c",function(l){t.push(l)})}),t}function Ll(r,e){return Be(e,"v")}function Tl(r,e){if(e.firstChild&&lt(e.firstChild)==="is"&&e.firstChild.firstChild&&lt(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function Ol(r){var e=r.documentElement,n=Be(e,"dimension");if(n)return n.getAttribute("ref")}function Al(r){var e=r.documentElement,n=Be(e,"cellStyleXfs");return n?St(n,"xf"):[]}function Il(r){var e=r.documentElement,n=Be(e,"cellXfs");return n?St(n,"xf"):[]}function Pl(r){var e=r.documentElement,n=Be(e,"numFmts");return n?St(n,"numFmt"):[]}function Ml(r){var e=r.documentElement;return kl(e,"si",function(n){var t=Be(n,"t");if(t)return t.textContent;var o="";return Pt(n,"r",function(l){o+=Be(l,"t").textContent}),o})}function El(r){var e=r.documentElement;return Be(e,"workbookPr")}function Nl(r){var e=r.documentElement;return St(e,"Relationship")}function Dl(r){var e=r.documentElement,n=Be(e,"sheets");return St(n,"sheet")}function Fl(r,e){var n=e.createDocument(r),t={},o=El(n);o&&o.getAttribute("date1904")==="1"&&(t.epoch1904=!0),t.sheets=[];var l=function(a){a.getAttribute("name")&&t.sheets.push({id:a.getAttribute("sheetId"),name:a.getAttribute("name"),relationId:a.getAttribute("r:id")})};return Dl(n).forEach(l),t}function jl(r,e){var n=e.createDocument(r),t={sheets:{},sharedStrings:void 0,styles:void 0},o=function(i){var a=i.getAttribute("Target"),s=i.getAttribute("Type");switch(s){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":t.styles=Xt(a);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":t.sharedStrings=Xt(a);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":t.sheets[i.getAttribute("Id")]=Xt(a);break}};return Nl(n).forEach(o),t}function Xt(r){return r[0]==="/"?r.slice(1):"xl/"+r}function In(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),n.push.apply(n,t)}return n}function Pn(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?In(Object(n),!0).forEach(function(t){Bl(r,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))})}return r}function Bl(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Hl(r,e){if(!r)return{};var n=e.createDocument(r),t=Al(n).map(Kt),o=Pl(n).map(Rl).reduce(function(i,a){return i[a.id]=a,i},[]),l=function(a){return a.hasAttribute("xfId")?Pn(Pn({},t[a.xfId]),Kt(a,o)):Kt(a,o)};return Il(n).map(l)}function Rl(r){return{id:r.getAttribute("numFmtId"),template:r.getAttribute("formatCode")}}function Kt(r,e){var n={};if(r.hasAttribute("numFmtId")){var t=r.getAttribute("numFmtId");e[t]?n.numberFormat=e[t]:n.numberFormat={id:t}}return n}function Wl(r,e){return r?Ml(e.createDocument(r)):[]}function Rr(r,e){e&&e.epoch1904&&(r+=1462);var n=70*365+19,t=60*60*1e3;return new Date(Math.round((r-n)*24*t))}function zl(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n)return(n=n.call(r)).next.bind(n);if(Array.isArray(r)||(n=Ul(r))||e&&r&&typeof r.length=="number"){n&&(r=n);var t=0;return function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ul(r,e){if(r){if(typeof r=="string")return Mn(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mn(r,e)}}function Mn(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Gl(r,e,n,t){if(e){var o=n[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(Vl.indexOf(Number(o.numberFormat.id))>=0||t.dateFormat&&o.numberFormat.template===t.dateFormat||t.smartDateParser!==!1&&o.numberFormat.template&&Kl(o.numberFormat.template))return!0}}var Vl=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],ql=/^\[\$-414\]/,Xl=/;@$/;function Kl(r){r=r.toLowerCase(),r=r.replace(ql,""),r=r.replace(Xl,"");for(var e=r.split(/\W+/),n=zl(e),t;!(t=n()).done;){var o=t.value;if(Zl.indexOf(o)<0)return!1}return!0}var Zl=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function Yl(r,e,n){var t=n.getInlineStringValue,o=n.getInlineStringXml,l=n.getStyleId,i=n.styles,a=n.values,s=n.properties,f=n.options;switch(e||(e="n"),e){case"str":r=Zt(r,f);break;case"inlineStr":if(r=t(),r===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));r=Zt(r,f);break;case"s":var u=Number(r);if(isNaN(u))throw new Error('Invalid "shared" string index: '.concat(r));if(u>=a.length)throw new Error('An out-of-bounds "shared" string index: '.concat(r));r=a[u],r=Zt(r,f);break;case"b":if(r==="1")r=!0;else if(r==="0")r=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(r));break;case"z":r=void 0;break;case"e":r=Jl(r);break;case"d":if(r===void 0)break;var c=new Date(r);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(r));r=c;break;case"n":if(r===void 0)break;var p=Number(r);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(r));r=p,Gl(r,l(),i,f)&&(r=Rr(r,s));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return r===void 0&&(r=null),r}function Jl(r){switch(r){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(r)}}function Zt(r,e){return e.trim!==!1&&(r=r.trim()),r===""&&(r=void 0),r}var Ql=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function xl(r){var e=function(f,u){return f-u},n=r.map(function(s){return s.row}).sort(e),t=r.map(function(s){return s.column}).sort(e),o=n[0],l=n[n.length-1],i=t[0],a=t[t.length-1];return[{row:o,column:i},{row:l,column:a}]}function es(r){for(var e=0,n=0;n<r.length;)e*=26,e+=Ql.indexOf(r[n]),n++;return e}function Wr(r){return r=r.split(/(\d+)/),[parseInt(r[1]),es(r[0].trim())]}function ts(r,e,n,t,o,l,i){var a=Wr(r.getAttribute("r")),s=Ll(e,r),f=s&&s.textContent,u;return r.hasAttribute("t")&&(u=r.getAttribute("t")),{row:a[0],column:a[1],value:Yl(f,u,{getInlineStringValue:function(){return Tl(e,r)},getInlineStringXml:function(){return Hr(r)},getStyleId:function(){return r.getAttribute("s")},styles:o,values:t,properties:l,options:i})}}function ns(r,e,n,t,o,l){var i=Cl(r);return i.length===0?[]:i.map(function(a){return ts(a,r,e,n,t,o,l)})}function rs(r,e){return is(r)||ss(r,e)||ls(r,e)||os()}function os(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ls(r,e){if(r){if(typeof r=="string")return En(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return En(r,e)}}function En(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function ss(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var t=[],o=!0,l=!1,i,a;try{for(n=n.call(r);!(o=(i=n.next()).done)&&(t.push(i.value),!(e&&t.length===e));o=!0);}catch(s){l=!0,a=s}finally{try{!o&&n.return!=null&&n.return()}finally{if(l)throw a}}return t}}function is(r){if(Array.isArray(r))return r}function as(r){var e=Ol(r);if(e)return e=e.split(":").map(Wr).map(function(n){var t=rs(n,2),o=t[0],l=t[1];return{row:o,column:l}}),e.length===1&&(e=[e[0],e[0]]),e}function fs(r,e,n,t,o,l){var i=e.createDocument(r),a=ns(i,e,n,t,o,l),s=as(i)||xl(a);return{cells:a,dimensions:s}}function us(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n)return(n=n.call(r)).next.bind(n);if(Array.isArray(r)||(n=cs(r))||e&&r&&typeof r.length=="number"){n&&(r=n);var t=0;return function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cs(r,e){if(r){if(typeof r=="string")return Nn(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nn(r,e)}}function Nn(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function ps(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.rowMap,t=e.accessor,o=t===void 0?function(c){return c}:t,l=e.onlyTrimAtTheEnd,i=r.length-1;i>=0;){for(var a=!0,s=us(r[i]),f;!(f=s()).done;){var u=f.value;if(o(u)!==null){a=!1;break}}if(a)r.splice(i,1),n&&n.splice(i,1);else if(l)break;i--}return r}function ms(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n)return(n=n.call(r)).next.bind(n);if(Array.isArray(r)||(n=$s(r))||e&&r&&typeof r.length=="number"){n&&(r=n);var t=0;return function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $s(r,e){if(r){if(typeof r=="string")return Dn(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dn(r,e)}}function Dn(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function ds(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.accessor,t=n===void 0?function(c){return c}:n,o=e.onlyTrimAtTheEnd,l=r[0].length-1;l>=0;){for(var i=!0,a=ms(r),s;!(s=a()).done;){var f=s.value;if(t(f[l])!==null){i=!1;break}}if(i)for(var u=0;u<r.length;)r[u].splice(l,1),u++;else if(o)break;l--}return r}function gs(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n)return(n=n.call(r)).next.bind(n);if(Array.isArray(r)||(n=zr(r))||e&&r&&typeof r.length=="number"){n&&(r=n);var t=0;return function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _s(r,e){return vs(r)||bs(r,e)||zr(r,e)||hs()}function hs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zr(r,e){if(r){if(typeof r=="string")return Fn(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fn(r,e)}}function Fn(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function bs(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var t=[],o=!0,l=!1,i,a;try{for(n=n.call(r);!(o=(i=n.next()).done)&&(t.push(i.value),!(e&&t.length===e));o=!0);}catch(s){l=!0,a=s}finally{try{!o&&n.return!=null&&n.return()}finally{if(l)throw a}}return t}}function vs(r){if(Array.isArray(r))return r}function ws(r,e){var n=r.dimensions,t=r.cells;if(t.length===0)return[];var o=_s(n,2);o[0];for(var l=o[1],i=l.column,a=l.row,s=new Array(a),f=0;f<a;){s[f]=new Array(i);for(var u=0;u<i;)s[f][u]=null,u++;f++}for(var c=gs(t),p;!(p=c()).done;){var $=p.value,k=$.row-1,w=$.column-1;w<i&&k<a&&(s[k][w]=$.value)}var C=e.rowMap;if(C)for(var y=0;y<s.length;)C[y]=y,y++;return s=ps(ds(s,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:C}),e.transformData&&(s=e.transformData(s)),s}function ys(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n)return(n=n.call(r)).next.bind(n);if(Array.isArray(r)||(n=ks(r))||e&&r&&typeof r.length=="number"){n&&(r=n);var t=0;return function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ks(r,e){if(r){if(typeof r=="string")return jn(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jn(r,e)}}function jn(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Bn(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),n.push.apply(n,t)}return n}function Ss(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Bn(Object(n),!0).forEach(function(t){Cs(r,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))})}return r}function Cs(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Ls(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n.sheet||(n=Ss({sheet:1},n));var t=function(p){if(!r[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return r[p]},o=jl(t("xl/_rels/workbook.xml.rels"),e),l=o.sharedStrings?Wl(t(o.sharedStrings),e):[],i=o.styles?Hl(t(o.styles),e):{},a=Fl(t("xl/workbook.xml"),e);if(n.getSheets)return a.sheets.map(function(c){var p=c.name;return{name:p}});var s=Ts(n.sheet,a.sheets);if(!s||!o.sheets[s])throw Os(n.sheet,a.sheets);var f=fs(t(o.sheets[s]),e,l,i,a,n),u=ws(f,n);return n.properties?{data:u,properties:a}:u}function Ts(r,e){if(typeof r=="number"){var n=e[r-1];return n&&n.relationId}for(var t=ys(e),o;!(o=t()).done;){var l=o.value;if(l.name===r)return l.relationId}}function Os(r,e){var n=e&&e.map(function(t,o){return'"'.concat(t.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof r=="number"?"#"+r:'"'+r+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+n+".":""))}function xt(r){"@babel/helpers - typeof";return xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(r)}function Hn(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function As(r,e,n){return e&&Hn(r.prototype,e),n&&Hn(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function Is(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Ps(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&ht(r,e)}function Ms(r){var e=Ur();return function(){var t=bt(r),o;if(e){var l=bt(this).constructor;o=Reflect.construct(t,arguments,l)}else o=t.apply(this,arguments);return Es(this,o)}}function Es(r,e){if(e&&(xt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ns(r)}function Ns(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function en(r){var e=typeof Map=="function"?new Map:void 0;return en=function(t){if(t===null||!Ds(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return Lt(t,arguments,bt(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),ht(o,t)},en(r)}function Lt(r,e,n){return Ur()?Lt=Reflect.construct:Lt=function(o,l,i){var a=[null];a.push.apply(a,l);var s=Function.bind.apply(o,a),f=new s;return i&&ht(f,i.prototype),f},Lt.apply(null,arguments)}function Ur(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ds(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function ht(r,e){return ht=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},ht(r,e)}function bt(r){return bt=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},bt(r)}var be=function(r){Ps(n,r);var e=Ms(n);function n(t){var o;return Is(this,n),o=e.call(this,"invalid"),o.reason=t,o}return As(n)}(en(Error));function Fs(r){if(typeof r=="string"){var e=r;if(r=Number(r),String(r)!==e)throw new be("not_a_number")}if(typeof r!="number")throw new be("not_a_number");if(isNaN(r))throw new be("invalid_number");if(!isFinite(r))throw new be("out_of_bounds");return r}function js(r){if(typeof r=="string")return r;if(typeof r=="number"){if(isNaN(r))throw new be("invalid_number");if(!isFinite(r))throw new be("out_of_bounds");return String(r)}throw new be("not_a_string")}function Bs(r){if(typeof r=="boolean")return r;throw new be("not_a_boolean")}function Hs(r,e){var n=e.properties;if(r instanceof Date){if(isNaN(r.valueOf()))throw new be("out_of_bounds");return r}if(typeof r=="number"){if(isNaN(r))throw new be("invalid_number");if(!isFinite(r))throw new be("out_of_bounds");var t=Rr(r,n);if(isNaN(t.valueOf()))throw new be("out_of_bounds");return t}throw new be("not_a_date")}function Rs(r,e){return Us(r)||zs(r,e)||Gr(r,e)||Ws()}function Ws(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zs(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var t=[],o=!0,l=!1,i,a;try{for(n=n.call(r);!(o=(i=n.next()).done)&&(t.push(i.value),!(e&&t.length===e));o=!0);}catch(s){l=!0,a=s}finally{try{!o&&n.return!=null&&n.return()}finally{if(l)throw a}}return t}}function Us(r){if(Array.isArray(r))return r}function tn(r){"@babel/helpers - typeof";return tn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tn(r)}function Gs(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n)return(n=n.call(r)).next.bind(n);if(Array.isArray(r)||(n=Gr(r))||e&&r&&typeof r.length=="number"){n&&(r=n);var t=0;return function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gr(r,e){if(r){if(typeof r=="string")return Rn(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rn(r,e)}}function Rn(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function Wn(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),n.push.apply(n,t)}return n}function zn(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Wn(Object(n),!0).forEach(function(t){Vs(r,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))})}return r}function Vs(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}var Un={isColumnOriented:!1};function qs(r,e,n){n?n=zn(zn({},Un),n):n=Un;var t=n,o=t.isColumnOriented,l=t.rowMap,i=t.ignoreEmptyRows;Ys(e),o&&(r=Zs(r));for(var a=r[0],s=[],f=[],u=1;u<r.length;u++){var c=Vr(e,r[u],u,a,f,n);(c!==null||i===!1)&&s.push(c)}if(l)for(var p=Gs(f),$;!($=p()).done;){var k=$.value;k.row=l[k.row-1]+1}return{rows:s,errors:f}}function Vr(r,e,n,t,o,l){for(var i={},a=!0,s=function(){var p=u[f],$=r[p],k=tn($.type)==="object"&&!Array.isArray($.type),w=e[t.indexOf(p)];w===void 0&&(w=null);var C=void 0,y=void 0,P=void 0;if(k)C=Vr($.type,e,n,t,o,l);else if(w===null)C=null;else if(Array.isArray($.type)){var D=!1,I=Ks(w).map(function(F){var A=Gn(F,$,l);return A.error&&(C=F,y=A.error,P=A.reason),A.value!==null&&(D=!0),A.value});y||(C=D?I:null)}else{var N=Gn(w,$,l);y=N.error,P=N.reason,C=y?w:N.value}!y&&C===null&&$.required&&(y="required"),y?(y={error:y,row:n+1,column:p,value:C},P&&(y.reason=P),$.type&&(y.type=$.type),o.push(y)):(a&&C!==null&&(a=!1),(C!==null||l.includeNullValues)&&(i[$.prop]=C))},f=0,u=Object.keys(r);f<u.length;f++)s();return a?null:i}function Gn(r,e,n){if(r===null)return{value:null};var t;if(e.parse?t=it(r,e.parse):e.type?t=Xs(r,Array.isArray(e.type)?e.type[0]:e.type,n):t={value:r},t.error)return t;if(t.value!==null){if(e.oneOf&&e.oneOf.indexOf(t.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(t.value)}catch(o){return{error:o.message}}}return t}function it(r,e){try{return r=e(r),r===void 0?{value:null}:{value:r}}catch(t){var n={error:t.message};return t.reason&&(n.reason=t.reason),n}}function Xs(r,e,n){switch(e){case String:return it(r,js);case Number:return it(r,Fs);case Date:return it(r,function(t){return Hs(t,{properties:n.properties})});case Boolean:return it(r,Bs);default:if(typeof e=="function")return it(r,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function qr(r,e,n){for(var t=0,o="";n+t<r.length;){var l=r[n+t];if(l===e)return[o,t];if(l==='"'){var i=qr(r,'"',n+t+1);o+=i[0],t+=1+i[1]+1}else o+=l,t++}return[o,t]}function Ks(r){for(var e=[],n=0;n<r.length;){var t=qr(r,",",n),o=Rs(t,2),l=o[0],i=o[1];n+=i+1,e.push(l.trim())}return e}var Zs=function(e){return e[0].map(function(n,t){return e.map(function(o){return o[t]})})};function Ys(r){for(var e=0,n=Object.keys(r);e<n.length;e++){var t=n[e],o=r[t];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(t,'".'))}}function nn(r){"@babel/helpers - typeof";return nn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(r)}function Xr(r){for(var e={},n=0,t=Object.keys(r);n<t.length;n++){var o=t[n],l=r[o],i=void 0;nn(l)==="object"&&(l=Object.keys(r[o])[0],i=Xr(r[o][l])),e[o]={prop:l},i&&(e[o].type=i)}return e}var Js=["schema","map"];function Vn(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);e&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),n.push.apply(n,t)}return n}function Ct(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Vn(Object(n),!0).forEach(function(t){Qs(r,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))})}return r}function Qs(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function xs(r,e){if(r==null)return{};var n=ei(r,e),t,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);for(o=0;o<l.length;o++)t=l[o],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(r,t)&&(n[t]=r[t])}return n}function ei(r,e){if(r==null)return{};var n={},t=Object.keys(r),o,l;for(l=0;l<t.length;l++)o=t[l],!(e.indexOf(o)>=0)&&(n[o]=r[o]);return n}function ti(r,e,n){var t=n.schema,o=n.map,l=xs(n,Js);!t&&o&&(t=Xr(o));var i=Ls(r,e,Ct(Ct({},l),{},{properties:t||l.properties}));return t?qs(i.data,t,Ct(Ct({},l),{},{properties:i.properties})):i}function ni(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return wl(r).then(function(n){return ti(n,rl,e)})}function ri(r){let e=new Map;for(let[t,o]of Object.entries(r.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let n=1;for(let t of r.features){let o=e.get(t.properties.scheme_reference);o.num_features++,t.properties.funding_programme=o.funding_programme,t.id=n++}return e}async function oi(r){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:n}=await ni(r,{map:e,sheet:"Form Input"}),t={type:"FeatureCollection",features:[]};for(let o of n){let l=eo(o.lat_lon.split(",").map(parseFloat).reverse()),i=o;i.submission_time=o.submission_time.toLocaleString(),t.features.push({type:"Feature",properties:i,geometry:{type:"Point",coordinates:l},id:t.features.length+1})}return t}const Q={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},vt=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function li(r){let e,n,t,o,l;function i(s){r[3](s)}let a={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return r[0]!==void 0&&(a.value=r[0]),e=new At({props:a}),q.push(()=>Y(e,"value",i)),e.$on("change",r[2]),o=new wo({props:{rows:r[1]}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};!n&&f&1&&(n=!0,u.value=s[0],J(()=>n=!1)),e.$set(u);const c={};f&2&&(c.rows=s[1]),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}function si(r,e,n){let t;ee(r,Qe,s=>n(4,t=s));let o="interventionType",l=bn("v1");function i(){let s;o=="interventionType"?(s=Ir("v1"),n(1,l=bn("v1"))):(s=kr(["get","funding_programme"],{ATF2:Q.atf2,ATF3:Q.atf3,ATF4:Q.atf4},"grey"),n(1,l=[["ATF2",Q.atf2],["ATF3",Q.atf3],["ATF4",Q.atf4]])),t.setPaintProperty("interventions-points","circle-color",s),t.setPaintProperty("interventions-lines","line-color",s),t.setPaintProperty("interventions-polygons","fill-color",s),t.setPaintProperty("interventions-polygon-outlines","line-color",s)}function a(s){o=s,n(0,o)}return[o,l,i,a]}class ii extends U{constructor(e){super(),G(this,e,si,li,z,{})}}function ai(r){let e;return{c(){e=S("Clear")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function fi(r){let e,n,t,o,l,i;return t=new _t({props:{$$slots:{default:[ai]},$$scope:{ctx:r}}}),t.$on("click",r[13]),{c(){e=M("input"),n=O(),h(t.$$.fragment),Z(e,"type","text"),Z(e,"class","govuk-input govuk-input--width-10"),Z(e,"id","filterText")},m(a,s){d(a,e,s),dn(e,r[0]),d(a,n,s),b(t,a,s),o=!0,l||(i=pt(e,"input",r[12]),l=!0)},p(a,s){s&1&&e.value!==a[0]&&dn(e,a[0]);const f={};s&131072&&(f.$$scope={dirty:s,ctx:a}),t.$set(f)},i(a){o||(m(t.$$.fragment,a),o=!0)},o(a){_(t.$$.fragment,a),o=!1},d(a){a&&(g(e),g(n)),v(t,a),l=!1,i()}}}function ui(r){let e,n,t,o,l,i,a,s,f,u;function c(w){r[10](w)}let p={label:"Authority or region",id:"filterAuthority",choices:r[5],emptyOption:!0};r[2]!==void 0&&(p.value=r[2]),e=new At({props:p}),q.push(()=>Y(e,"value",c));function $(w){r[11](w)}let k={label:"Funding programme",id:"filterFundingProgramme",choices:r[6],emptyOption:!0};return r[3]!==void 0&&(k.value=r[3]),o=new At({props:k}),q.push(()=>Y(o,"value",$)),a=new Sr({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[fi]},$$scope:{ctx:r}}}),f=new ii({}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment),i=O(),h(a.$$.fragment),s=O(),h(f.$$.fragment)},m(w,C){b(e,w,C),d(w,t,C),b(o,w,C),d(w,i,C),b(a,w,C),d(w,s,C),b(f,w,C),u=!0},p(w,C){const y={};C&32&&(y.choices=w[5]),!n&&C&4&&(n=!0,y.value=w[2],J(()=>n=!1)),e.$set(y);const P={};C&64&&(P.choices=w[6]),!l&&C&8&&(l=!0,P.value=w[3],J(()=>l=!1)),o.$set(P);const D={};C&131073&&(D.$$scope={dirty:C,ctx:w}),a.$set(D)},i(w){u||(m(e.$$.fragment,w),m(o.$$.fragment,w),m(a.$$.fragment,w),m(f.$$.fragment,w),u=!0)},o(w){_(e.$$.fragment,w),_(o.$$.fragment,w),_(a.$$.fragment,w),_(f.$$.fragment,w),u=!1},d(w){w&&(g(t),g(i),g(s)),v(e,w),v(o,w),v(a,w),v(f,w)}}}function ci(r){let e,n=r[1].size.toLocaleString()+"",t,o,l=r[7].route.toLocaleString()+"",i,a,s=r[7].area.toLocaleString()+"",f,u,c=r[7].crossing.toLocaleString()+"",p,$,k=r[7].other.toLocaleString()+"",w,C;return{c(){e=S("Showing "),t=S(n),o=S(" schemes ("),i=S(l),a=S(`
    routes, `),f=S(s),u=S(` areas,
    `),p=S(c),$=S(" crossings, "),w=S(k),C=S(`
    other)`)},m(y,P){d(y,e,P),d(y,t,P),d(y,o,P),d(y,i,P),d(y,a,P),d(y,f,P),d(y,u,P),d(y,p,P),d(y,$,P),d(y,w,P),d(y,C,P)},p(y,P){P&2&&n!==(n=y[1].size.toLocaleString()+"")&&K(t,n),P&128&&l!==(l=y[7].route.toLocaleString()+"")&&K(i,l),P&128&&s!==(s=y[7].area.toLocaleString()+"")&&K(f,s),P&128&&c!==(c=y[7].crossing.toLocaleString()+"")&&K(p,c),P&128&&k!==(k=y[7].other.toLocaleString()+"")&&K(w,k)},d(y){y&&(g(e),g(t),g(o),g(i),g(a),g(f),g(u),g(p),g($),g(w),g(C))}}}function pi(r){let e,n,t;function o(i){r[14](i)}let l={id:"show-schemes",$$slots:{default:[ci]},$$scope:{ctx:r}};return r[4]!==void 0&&(l.checked=r[4]),e=new ie({props:l}),q.push(()=>Y(e,"checked",o)),{c(){h(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,a){const s={};a&131202&&(s.$$scope={dirty:a,ctx:i}),!n&&a&16&&(n=!0,s.checked=i[4],J(()=>n=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){_(e.$$.fragment,i),t=!1},d(i){v(e,i)}}}function mi(r){let e,n,t,o;return e=new Ie({props:{label:"Filters",$$slots:{default:[ui]},$$scope:{ctx:r}}}),t=new yt({props:{small:!0,$$slots:{default:[pi]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},p(l,[i]){const a={};i&131181&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&131218&&(s.$$scope={dirty:i,ctx:l}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function $i(r,e,n){let t,o;ee(r,at,I=>n(15,t=I)),ee(r,Qe,I=>n(9,o=I));let{schemes:l}=e,{schemesToBeShown:i=new Set}=e,{filterText:a=""}=e,s=[],f="",u=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;$t(()=>{let I=new Set,N=new Set;for(let F of l.values())F.authority_or_region&&I.add(F.authority_or_region),F.funding_programme&&N.add(F.funding_programme);n(5,s=Array.from(I.entries())),s.sort(),n(6,u=Array.from(N.entries())),u.sort()});function k(I,N,F){let A=I.toLowerCase(),E=T=>{var H,W;if(A&&!((H=T.properties.name)!=null&&H.toLowerCase().includes(A))&&!((W=T.properties.description)!=null&&W.toLowerCase().includes(A)))return!1;if(N||F){let V=l.get(T.properties.scheme_reference);if(N&&V.authority_or_region!=N||F&&V.funding_programme!=F)return!1}return!0};n(1,i=new Set(t.features.filter(E).map(T=>T.properties.scheme_reference))),n(7,p={area:0,route:0,crossing:0,other:0});let j=T=>{var H,W;return!(!i.has(T.properties.scheme_reference)||A&&!((H=T.properties.name)!=null&&H.toLowerCase().includes(A))&&!((W=T.properties.description)!=null&&W.toLowerCase().includes(A)))};at.update(T=>{for(let H of T.features)j(H)?(delete H.properties.hide_while_editing,n(7,p[H.properties.intervention_type]++,p)):H.properties.hide_while_editing=!0;return T}),n(7,p)}function w(I){f=I,n(2,f)}function C(I){c=I,n(3,c)}function y(){a=this.value,n(0,a)}const P=()=>n(0,a="");function D(I){$=I,n(4,$)}return r.$$set=I=>{"schemes"in I&&n(8,l=I.schemes),"schemesToBeShown"in I&&n(1,i=I.schemesToBeShown),"filterText"in I&&n(0,a=I.filterText)},r.$$.update=()=>{if(r.$$.dirty&528&&o)for(let I of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(I)&&o.setLayoutProperty(I,"visibility",$?"visible":"none");r.$$.dirty&13&&k(a,f,c)},[a,i,f,c,$,s,u,p,l,o,w,C,y,P,D]}class di extends U{constructor(e){super(),G(this,e,$i,mi,z,{schemes:8,schemesToBeShown:1,filterText:0})}}function gi(r,e,n){let t;ee(r,Qe,a=>n(3,t=a));let o=null,{markerPosition:l}=e,{markerPositionUpdated:i}=e;return $t(()=>{o=new Yt.Marker({draggable:!0}).setLngLat(l).addTo(t),o.on("dragstart",()=>{t.getCanvas().style.cursor="grabbing"}),o.on("drag",()=>{n(0,l=o.getLngLat()),i()}),o.on("dragend",()=>{t.getCanvas().style.cursor="inherit"})}),mt(()=>{o&&o.remove()}),r.$$set=a=>{"markerPosition"in a&&n(0,l=a.markerPosition),"markerPositionUpdated"in a&&n(1,i=a.markerPositionUpdated)},[l,i]}class _i extends U{constructor(e){super(),G(this,e,gi,null,z,{markerPosition:0,markerPositionUpdated:1})}}function qn(r,e,n){const t=r.slice();return t[16]=e[n],t[17]=e,t[18]=n,t}function hi(r){let e,n;return e=new _t({props:{$$slots:{default:[vi]},$$scope:{ctx:r}}}),e.$on("click",r[4]),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&524288&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function bi(r){let e,n;return e=new _t({props:{$$slots:{default:[wi]},$$scope:{ctx:r}}}),e.$on("click",r[3]),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&524288&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function vi(r){let e;return{c(){e=S("Disable Line Measurement Tool")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function wi(r){let e;return{c(){e=S("Enable Line Measurement Tool")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Xn(r){var c;let e,n,t,o=[],l=new Map,i,a,s=r[2]&&((c=r[2].properties)==null?void 0:c.length)&&Kn(r);n=new Ie({props:{label:"Help",$$slots:{default:[yi]},$$scope:{ctx:r}}});let f=je(r[1]);const u=p=>p[16].id;for(let p=0;p<f.length;p+=1){let $=qn(r,f,p),k=u($);l.set(k,o[p]=Zn(k,$))}return{c(){s&&s.c(),e=O(),h(n.$$.fragment),t=O();for(let p=0;p<o.length;p+=1)o[p].c();i=de()},m(p,$){s&&s.m(p,$),d(p,e,$),b(n,p,$),d(p,t,$);for(let k=0;k<o.length;k+=1)o[k]&&o[k].m(p,$);d(p,i,$),a=!0},p(p,$){var w;p[2]&&((w=p[2].properties)!=null&&w.length)?s?s.p(p,$):(s=Kn(p),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null);const k={};$&524288&&(k.$$scope={dirty:$,ctx:p}),n.$set(k),$&130&&(f=je(p[1]),ne(),o=no(o,$,u,1,p,f,l,i.parentNode,ro,Zn,i,qn),re())},i(p){if(!a){m(n.$$.fragment,p);for(let $=0;$<f.length;$+=1)m(o[$]);a=!0}},o(p){_(n.$$.fragment,p);for(let $=0;$<o.length;$+=1)_(o[$]);a=!1},d(p){p&&(g(e),g(t),g(i)),s&&s.d(p),v(n,p);for(let $=0;$<o.length;$+=1)o[$].d(p)}}}function Kn(r){var i;let e,n,t=((i=r[2].properties)==null?void 0:i.length)+"",o,l;return{c(){e=M("p"),n=S("Length: "),o=S(t),l=S("m")},m(a,s){d(a,e,s),L(e,n),L(e,o),L(e,l)},p(a,s){var f;s&4&&t!==(t=((f=a[2].properties)==null?void 0:f.length)+"")&&K(o,t)},d(a){a&&g(e)}}}function yi(r){let e;return{c(){e=M("ul"),e.innerHTML=`<li><b>Click</b>
        on the map to place a new waypoint</li> <li><b>Click and Drag</b>
        an existing waypoint to move it</li> <li><b>Hold shift and click on</b>
        an existing waypoint to delete it</li> <li>Press <b>Escape</b>
        to exit this mode</li>`},m(n,t){d(n,e,t)},p:x,d(n){n&&g(e)}}}function Zn(r,e){let n,t,o,l;function i(s){e[8](s,e[16])}let a={markerPositionUpdated:e[7]};return e[16].lngLat!==void 0&&(a.markerPosition=e[16].lngLat),t=new _i({props:a}),q.push(()=>Y(t,"markerPosition",i)),{key:r,first:null,c(){n=de(),h(t.$$.fragment),this.first=n},m(s,f){d(s,n,f),b(t,s,f),l=!0},p(s,f){e=s;const u={};!o&&f&2&&(o=!0,u.markerPosition=e[16].lngLat,J(()=>o=!1)),t.$set(u)},i(s){l||(m(t.$$.fragment,s),l=!0)},o(s){_(t.$$.fragment,s),l=!1},d(s){s&&g(n),v(t,s)}}}function ki(r){let e,n,t,o,l,i,a;const s=[bi,hi],f=[];function u(p,$){return p[0]?0:1}e=u(r),n=f[e]=s[e](r);let c=!r[0]&&Xn(r);return{c(){n.c(),t=O(),c&&c.c(),o=de()},m(p,$){f[e].m(p,$),d(p,t,$),c&&c.m(p,$),d(p,o,$),l=!0,i||(a=[pt(window,"keydown",r[5]),pt(window,"keyup",r[6])],i=!0)},p(p,[$]){let k=e;e=u(p),e===k?f[e].p(p,$):(ne(),_(f[k],1,1,()=>{f[k]=null}),re(),n=f[e],n?n.p(p,$):(n=f[e]=s[e](p),n.c()),m(n,1),n.m(t.parentNode,t)),p[0]?c&&(ne(),_(c,1,1,()=>{c=null}),re()):c?(c.p(p,$),$&1&&m(c,1)):(c=Xn(p),c.c(),m(c,1),c.m(o.parentNode,o))},i(p){l||(m(n),m(c),l=!0)},o(p){_(n),_(c),l=!1},d(p){p&&(g(t),g(o)),f[e].d(p),c&&c.d(p),i=!1,to(a)}}}const tt="measurement-line";function Si(r,e,n){let t;ee(r,Qe,D=>n(11,t=D));let o=!0,l=[],i,a=!1,s=0;function f(D){o||(a||(l.push({id:s++,lngLat:D.lngLat}),n(1,l),w()),a&&l.length>0&&(u(D.lngLat),w()))}function u(D){let N=new Yt.LngLat(0,-90).distanceTo(new Yt.LngLat(0,90)),F;l.forEach(A=>{const E=A.lngLat;N>=D.distanceTo(E)&&(F=E,N=D.distanceTo(E))}),F&&n(1,l=l.filter(A=>{const E=A.lngLat;return E.lng!=(F==null?void 0:F.lng)||E.lat!=(F==null?void 0:F.lat)}))}function c(){n(0,o=!1)}function p(){n(0,o=!0),n(1,l=[]),C()}function $(D){D.key==="Shift"&&(a=!0),D.key==="Escape"&&p()}function k(D){D.key==="Shift"&&(a=!1)}function w(){if(l.length<2){C();return}const D=l.map(I=>[I.lngLat.lng,I.lngLat.lat]);n(2,i=oo(D,{})),i.properties&&n(2,i.properties.length=(yo(i)*1e3).toFixed(2),i),y()}function C(){t.getSource(tt)&&(t.getSource(tt).setData(sn()),n(2,i=void 0))}function y(){t.getSource(tt)?t.getSource(tt).setData(i):(lo(t,tt,i),an(t,{id:tt,source:tt,color:$o.measuringLine,width:5}))}$t(()=>{t.on("click",f)}),mt(()=>{t.off("click",f)});function P(D,I){r.$$.not_equal(I.lngLat,D)&&(I.lngLat=D,n(1,l))}return[o,l,i,c,p,$,k,w,P]}class Ci extends U{constructor(e){super(),G(this,e,Si,ki,z,{})}}function Li(r){let e;return{c(){e=S(`Open Government License
  `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ti(r){let e,n,t,o,l;return t=new X({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Li]},$$scope:{ctx:r}}}),{c(){e=M("p"),n=S("License: "),h(t.$$.fragment),o=S(`. Contains OS data © Crown copyright and database right
  2023.`)},m(i,a){d(i,e,a),L(e,n),b(t,e,null),L(e,o),l=!0},p(i,[a]){const s={};a&1&&(s.$$scope={dirty:a,ctx:i}),t.$set(s)},i(i){l||(m(t.$$.fragment,i),l=!0)},o(i){_(t.$$.fragment,i),l=!1},d(i){i&&g(e),v(t)}}}class Ge extends U{constructor(e){super(),G(this,e,null,Ti,z,{})}}function Yn(r,e,n){const t=r.slice();return t[2]=e[n],t}function Jn(r,e,n){const t=r.slice();return t[5]=e[n],t}function Qn(r){let e,n;return{c(){e=M("span"),n=S(` 
    `),He(e,"background",r[5]),He(e,"width","100%"),He(e,"border","1px solid black")},m(t,o){d(t,e,o),L(e,n)},p(t,o){o&1&&He(e,"background",t[5])},d(t){t&&g(e)}}}function xn(r){let e,n=r[2]+"",t;return{c(){e=M("span"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&2&&n!==(n=o[2]+"")&&K(t,n)},d(o){o&&g(e)}}}function Oi(r){let e,n,t,o=je(r[0]),l=[];for(let s=0;s<o.length;s+=1)l[s]=Qn(Jn(r,o,s));let i=je(r[1]),a=[];for(let s=0;s<i.length;s+=1)a[s]=xn(Yn(r,i,s));return{c(){e=M("div");for(let s=0;s<l.length;s+=1)l[s].c();n=O(),t=M("div");for(let s=0;s<a.length;s+=1)a[s].c();He(e,"display","flex"),He(t,"display","flex"),He(t,"justify-content","space-between")},m(s,f){d(s,e,f);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(e,null);d(s,n,f),d(s,t,f);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(t,null)},p(s,[f]){if(f&1){o=je(s[0]);let u;for(u=0;u<o.length;u+=1){const c=Jn(s,o,u);l[u]?l[u].p(c,f):(l[u]=Qn(c),l[u].c(),l[u].m(e,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=o.length}if(f&2){i=je(s[1]);let u;for(u=0;u<i.length;u+=1){const c=Yn(s,i,u);a[u]?a[u].p(c,f):(a[u]=xn(c),a[u].c(),a[u].m(t,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=i.length}},i:x,o:x,d(s){s&&(g(e),g(n),g(t)),Ot(l,s),Ot(a,s)}}}function Ai(r,e,n){let{colorScale:t}=e,{limits:o}=e;return r.$$set=l=>{"colorScale"in l&&n(0,t=l.colorScale),"limits"in l&&n(1,o=l.limits)},[t,o]}class xe extends U{constructor(e){super(),G(this,e,Ai,Oi,z,{colorScale:0,limits:1})}}function Ii(r){let e;return{c(){e=S("Percent of households with a car")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Pi(r){let e;return{c(){e=S(`NOMIS TS045
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Mi(r){let e;return{c(){e=S(`ONS Geography
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ei(r){let e;return{c(){e=S(`Open Government License
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ni(r){let e,n,t,o,l,i,a,s,f,u,c,p;return t=new X({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Pi]},$$scope:{ctx:r}}}),l=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Mi]},$$scope:{ctx:r}}}),u=new X({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Ei]},$$scope:{ctx:r}}}),{c(){e=M("p"),n=S("Car/van availability data is from the 2021 census, via "),h(t.$$.fragment),o=S(". Output area boundaries from "),h(l.$$.fragment),i=S("."),a=O(),s=M("p"),f=S("License: "),h(u.$$.fragment),c=S(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,k){d($,e,k),L(e,n),b(t,e,null),L(e,o),b(l,e,null),L(e,i),d($,a,k),d($,s,k),L(s,f),b(u,s,null),L(s,c),p=!0},p($,k){const w={};k&65536&&(w.$$scope={dirty:k,ctx:$}),t.$set(w);const C={};k&65536&&(C.$$scope={dirty:k,ctx:$}),l.$set(C);const y={};k&65536&&(y.$$scope={dirty:k,ctx:$}),u.$set(y)},i($){p||(m(t.$$.fragment,$),m(l.$$.fragment,$),m(u.$$.fragment,$),p=!0)},o($){_(t.$$.fragment,$),_(l.$$.fragment,$),_(u.$$.fragment,$),p=!1},d($){$&&(g(e),g(a),g(s)),v(t),v(l),v(u)}}}function Di(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Ni]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&65536&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function er(r){let e,n;return e=new xe({props:{colorScale:r[4],limits:r[7]()}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p:x,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Fi(r){let e;return{c(){e=S("Average cars per household")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function ji(r){let e;return{c(){e=S(`NOMIS TS045
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Bi(r){let e;return{c(){e=S(`ONS Geography
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Hi(r){let e;return{c(){e=S(`Open Government License
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ri(r){let e,n,t,o,l,i,a,s,f,u,c,p,$,k;return l=new X({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[ji]},$$scope:{ctx:r}}}),a=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Bi]},$$scope:{ctx:r}}}),p=new X({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Hi]},$$scope:{ctx:r}}}),{c(){e=M("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,n=O(),t=M("p"),o=S("Car/van availability data is from the 2021 census, via "),h(l.$$.fragment),i=S(". Output area boundaries from "),h(a.$$.fragment),s=S("."),f=O(),u=M("p"),c=S("License: "),h(p.$$.fragment),$=S(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(w,C){d(w,e,C),d(w,n,C),d(w,t,C),L(t,o),b(l,t,null),L(t,i),b(a,t,null),L(t,s),d(w,f,C),d(w,u,C),L(u,c),b(p,u,null),L(u,$),k=!0},p(w,C){const y={};C&65536&&(y.$$scope={dirty:C,ctx:w}),l.$set(y);const P={};C&65536&&(P.$$scope={dirty:C,ctx:w}),a.$set(P);const D={};C&65536&&(D.$$scope={dirty:C,ctx:w}),p.$set(D)},i(w){k||(m(l.$$.fragment,w),m(a.$$.fragment,w),m(p.$$.fragment,w),k=!0)},o(w){_(l.$$.fragment,w),_(a.$$.fragment,w),_(p.$$.fragment,w),k=!1},d(w){w&&(g(e),g(n),g(t),g(f),g(u)),v(l),v(a),v(p)}}}function Wi(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Ri]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&65536&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function tr(r){let e,n;return e=new xe({props:{colorScale:r[4],limits:r[7]()}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p:x,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function zi(r){let e;return{c(){e=S("Population density")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ui(r){let e;return{c(){e=S(`NOMIS TS006
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Gi(r){let e;return{c(){e=S(`ONS Geography
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Vi(r){let e,n,t,o,l,i,a,s,f;return t=new X({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Ui]},$$scope:{ctx:r}}}),l=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Gi]},$$scope:{ctx:r}}}),s=new Ge({}),{c(){e=M("p"),n=S("Population density data is from the 2021 census, via "),h(t.$$.fragment),o=S(". Output area boundaries from "),h(l.$$.fragment),i=S("."),a=O(),h(s.$$.fragment)},m(u,c){d(u,e,c),L(e,n),b(t,e,null),L(e,o),b(l,e,null),L(e,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&65536&&(p.$$scope={dirty:c,ctx:u}),t.$set(p);const $={};c&65536&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){f||(m(t.$$.fragment,u),m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){_(t.$$.fragment,u),_(l.$$.fragment,u),_(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(a)),v(t),v(l),v(s,u)}}}function qi(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Vi]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&65536&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function nr(r){let e,n,t,o;return t=new xe({props:{colorScale:r[4],limits:r[7]().map(Ki)}}),{c(){e=M("p"),e.textContent="(people per square kilometres)",n=O(),h(t.$$.fragment)},m(l,i){d(l,e,i),d(l,n,i),b(t,l,i),o=!0},p:x,i(l){o||(m(t.$$.fragment,l),o=!0)},o(l){_(t.$$.fragment,l),o=!1},d(l){l&&(g(e),g(n)),v(t,l)}}}function Xi(r){let e,n,t,o,l,i,a,s,f,u,c,p,$,k;function w(E){r[9](E)}let C={id:"percent_households_with_car",$$slots:{right:[Di],default:[Ii]},$$scope:{ctx:r}};r[0]!==void 0&&(C.checked=r[0]),e=new ie({props:C}),q.push(()=>Y(e,"checked",w)),e.$on("change",r[10]);let y=r[3]=="percent_households_with_car"&&er(r);function P(E){r[11](E)}let D={id:"average_cars_per_household",$$slots:{right:[Wi],default:[Fi]},$$scope:{ctx:r}};r[1]!==void 0&&(D.checked=r[1]),l=new ie({props:D}),q.push(()=>Y(l,"checked",P)),l.$on("change",r[12]);let I=r[3]=="average_cars_per_household"&&tr(r);function N(E){r[13](E)}let F={id:"population_density",$$slots:{right:[qi],default:[zi]},$$scope:{ctx:r}};r[2]!==void 0&&(F.checked=r[2]),f=new ie({props:F}),q.push(()=>Y(f,"checked",N)),f.$on("change",r[14]);let A=r[3]=="population_density"&&nr(r);return $=new Ye({props:{layer:De,tooltip:r[5],show:r[3]!="",clickable:!0}}),$.$on("click",r[6]),{c(){h(e.$$.fragment),t=O(),y&&y.c(),o=O(),h(l.$$.fragment),a=O(),I&&I.c(),s=O(),h(f.$$.fragment),c=O(),A&&A.c(),p=O(),h($.$$.fragment)},m(E,j){b(e,E,j),d(E,t,j),y&&y.m(E,j),d(E,o,j),b(l,E,j),d(E,a,j),I&&I.m(E,j),d(E,s,j),b(f,E,j),d(E,c,j),A&&A.m(E,j),d(E,p,j),b($,E,j),k=!0},p(E,[j]){const T={};j&65536&&(T.$$scope={dirty:j,ctx:E}),!n&&j&1&&(n=!0,T.checked=E[0],J(()=>n=!1)),e.$set(T),E[3]=="percent_households_with_car"?y?(y.p(E,j),j&8&&m(y,1)):(y=er(E),y.c(),m(y,1),y.m(o.parentNode,o)):y&&(ne(),_(y,1,1,()=>{y=null}),re());const H={};j&65536&&(H.$$scope={dirty:j,ctx:E}),!i&&j&2&&(i=!0,H.checked=E[1],J(()=>i=!1)),l.$set(H),E[3]=="average_cars_per_household"?I?(I.p(E,j),j&8&&m(I,1)):(I=tr(E),I.c(),m(I,1),I.m(s.parentNode,s)):I&&(ne(),_(I,1,1,()=>{I=null}),re());const W={};j&65536&&(W.$$scope={dirty:j,ctx:E}),!u&&j&4&&(u=!0,W.checked=E[2],J(()=>u=!1)),f.$set(W),E[3]=="population_density"?A?(A.p(E,j),j&8&&m(A,1)):(A=nr(E),A.c(),m(A,1),A.m(p.parentNode,p)):A&&(ne(),_(A,1,1,()=>{A=null}),re());const V={};j&8&&(V.show=E[3]!=""),$.$set(V)},i(E){k||(m(e.$$.fragment,E),m(y),m(l.$$.fragment,E),m(I),m(f.$$.fragment,E),m(A),m($.$$.fragment,E),k=!0)},o(E){_(e.$$.fragment,E),_(y),_(l.$$.fragment,E),_(I),_(f.$$.fragment,E),_(A),_($.$$.fragment,E),k=!1},d(E){E&&(g(t),g(o),g(a),g(s),g(c),g(p)),v(e,E),y&&y.d(E),v(l,E),I&&I.d(E),v(f,E),A&&A.d(E),v($,E)}}}let De="census_output_areas";const Ki=r=>r.toLocaleString();function Zi(r,e,n){let t;ee(r,Qe,D=>n(8,t=D));let o=`${De}-outline`,l=Q.sequential_low_to_high,i=!1,a=!1,s=!1,f="";Cr(t,De,`${ue()}/v1/${De}.pmtiles`),so(t,{id:De,source:De,sourceLayer:De,color:"black",opacity:Lr(.5,.7)}),an(t,{id:o,source:De,sourceLayer:De,color:"black",width:.5});function u(D){let I=D.properties.OA21CD,N=D.properties[f];return f=="percent_households_with_car"?`<p>${N}% of households in ${I} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${I} have an average of ${N} cars</p>`:`<p>There are ${N.toLocaleString()} people per square kilometre in ${I}</p>`}function c(D){let I=D.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${I}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${I}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(D){i=D,n(0,i)}const k=()=>{n(1,a=!1),n(2,s=!1)};function w(D){a=D,n(1,a)}const C=()=>{n(0,i=!1),n(2,s=!1)};function y(D){s=D,n(2,s)}const P=()=>{n(0,i=!1),n(1,a=!1)};return r.$$.update=()=>{r.$$.dirty&271&&(i?n(3,f="percent_households_with_car"):a?n(3,f="average_cars_per_household"):s?n(3,f="population_density"):n(3,f=""),f?(t.setPaintProperty(De,"fill-color",Je(["get",f],p(),l)),t.setLayoutProperty(o,"visibility","visible")):t.setLayoutProperty(o,"visibility","none"))},[i,a,s,f,l,u,c,p,t,$,k,w,C,y,P]}class Yi extends U{constructor(e){super(),G(this,e,Zi,Xi,z,{})}}function Ji(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Combined authorities`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function Qi(r){let e;return{c(){e=S(`ONS Geography
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function xi(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[Qi]},$$scope:{ctx:r}}}),i=new Ge({}),{c(){e=M("p"),n=S("Data from "),h(t.$$.fragment),o=S(", as of December 2022."),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function ea(r){let e,n,t;return n=new ae({props:{$$slots:{default:[xi]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function ta(r){let e,n=r[5][0].properties.name+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&32&&n!==(n=o[5][0].properties.name+"")&&K(t,n)},d(o){o&&g(e)}}}function na(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[ta,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ra(r){let e,n,t,o;return e=new st({props:{id:Mt,paint:{"fill-color":r[2],"fill-opacity":ve(0,.5)},layout:{visibility:r[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[na]},$$scope:{ctx:r}}}),e.$on("click",la),t=new Me({props:{id:r[3],paint:{"line-color":r[2],"line-width":2.5},layout:{visibility:r[1]}}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function oa(r){let e,n,t,o,l;function i(s){r[4](s)}let a={id:Mt,$$slots:{right:[ea],default:[Ji]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new cn({props:{data:`${ue()}/v1/${Mt}.geojson`,$$slots:{default:[ra]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let Mt="combined_authorities";function la(r){window.open(`https://www.ons.gov.uk/visualisations/areas/${r.detail.features[0].properties.CAUTH22CD}`,"_blank")}function sa(r,e,n){let t,o=Q.combined_authorities,l=`${Mt}-outline`,i=!1;function a(s){i=s,n(0,i)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=i?"visible":"none")},[i,t,o,l,a]}class ia extends U{constructor(e){super(),G(this,e,sa,oa,z,{})}}function rr(r){const e=r[6][0].properties;r[7]=e}function aa(r){let e;return{c(){e=S("Indices of Multiple Deprivation")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function fa(r){let e;return{c(){e=S(`DLUCH GIS
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function ua(r){let e;return{c(){e=S(`here
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function ca(r){let e,n,t,o,l,i,a,s,f;return t=new X({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[fa]},$$scope:{ctx:r}}}),l=new X({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[ua]},$$scope:{ctx:r}}}),s=new Ge({}),{c(){e=M("p"),n=S("The 2019 English IMD scores come from "),h(t.$$.fragment),o=S(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),h(l.$$.fragment),i=S("."),a=O(),h(s.$$.fragment)},m(u,c){d(u,e,c),L(e,n),b(t,e,null),L(e,o),b(l,e,null),L(e,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),t.$set(p);const $={};c&256&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){f||(m(t.$$.fragment,u),m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){_(t.$$.fragment,u),_(l.$$.fragment,u),_(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(a)),v(t),v(l),v(s,u)}}}function pa(r){let e,n,t;return n=new ae({props:{$$slots:{default:[ca]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&256&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function or(r){let e,n;return e=new xe({props:{colorScale:r[3],limits:["Least deprived","Most deprived"]}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p:x,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ma(r){rr(r);let e,n=r[7].LSOA11CD+"",t,o,l,i=r[7].score+"",a,s,f,u,c,p=r[7].rank.toLocaleString()+"",$,k;return{c(){e=M("p"),t=S(n),o=S(` has an IMD score of
        `),l=M("b"),a=S(i),s=O(),f=M("p"),u=S("Rank: "),c=M("b"),$=S(p),k=S(`
        / 32,844 LSOAs`)},m(w,C){d(w,e,C),L(e,t),L(e,o),L(e,l),L(l,a),d(w,s,C),d(w,f,C),L(f,u),L(f,c),L(c,$),L(f,k)},p(w,C){rr(w),C&64&&n!==(n=w[7].LSOA11CD+"")&&K(t,n),C&64&&i!==(i=w[7].score+"")&&K(a,i),C&64&&p!==(p=w[7].rank.toLocaleString()+"")&&K($,p)},d(w){w&&(g(e),g(s),g(f))}}}function $a(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[ma,({features:t})=>({6:t}),({features:t})=>t?64:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&320&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function da(r){let e,n,t,o;return e=new st({props:{id:wt,sourceLayer:wt,paint:{"fill-color":Je(["-",10,["get","decile"]],r[4],r[3]),"fill-opacity":ve(.5,.7)},layout:{visibility:r[1]},manageHoverState:!0,$$slots:{default:[$a]},$$scope:{ctx:r}}}),t=new Me({props:{id:r[2],paint:{"line-color":"black","line-width":.5},layout:{visibility:r[1]}}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&256&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function ga(r){let e,n,t,o,l,i;function a(u){r[5](u)}let s={id:wt,$$slots:{right:[pa],default:[aa]},$$scope:{ctx:r}};r[0]!==void 0&&(s.checked=r[0]),e=new ie({props:s}),q.push(()=>Y(e,"checked",a));let f=r[0]&&or(r);return l=new ye({props:{url:`pmtiles://${ue()}/v1/${wt}.pmtiles`,$$slots:{default:[da]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),f&&f.c(),o=O(),h(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:u}),!n&&c&1&&(n=!0,p.checked=u[0],J(()=>n=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=or(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(ne(),_(f,1,1,()=>{f=null}),re());const $={};c&258&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){_(e.$$.fragment,u),_(f),_(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),v(e,u),f&&f.d(u),v(l,u)}}}let wt="imd";function _a(r,e,n){let t,o=`${wt}-outline`,l=Q.sequential_low_to_high,i=[0,2,4,6,8,10],a=!1;function s(f){a=f,n(0,a)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=a?"visible":"none")},[a,t,o,l,i,s]}class ha extends U{constructor(e){super(),G(this,e,_a,ga,z,{})}}function ba(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Local Authority Districts`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function va(r){let e;return{c(){e=S(`ONS Geography
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function wa(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[va]},$$scope:{ctx:r}}}),i=new Ge({}),{c(){e=M("p"),n=S("Data from "),h(t.$$.fragment),o=S(", as of May 2023."),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function ya(r){let e,n,t;return n=new ae({props:{$$slots:{default:[wa]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function ka(r){let e,n=r[5][0].properties.name+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&32&&n!==(n=o[5][0].properties.name+"")&&K(t,n)},d(o){o&&g(e)}}}function Sa(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[ka,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ca(r){let e,n,t,o;return e=new st({props:{id:Et,paint:{"fill-color":r[2],"fill-opacity":ve(0,.5)},layout:{visibility:r[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[Sa]},$$scope:{ctx:r}}}),e.$on("click",Ta),t=new Me({props:{id:r[3],paint:{"line-color":r[2],"line-width":2.5},layout:{visibility:r[1]}}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function La(r){let e,n,t,o,l;function i(s){r[4](s)}let a={id:Et,$$slots:{right:[ya],default:[ba]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new cn({props:{data:`${ue()}/v1/${Et}.geojson`,$$slots:{default:[Ca]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let Et="local_authority_districts";function Ta(r){window.open(`https://www.ons.gov.uk/visualisations/areas/${r.detail.features[0].properties.LAD23CD}`,"_blank")}function Oa(r,e,n){let t,o=Q.local_authority_districts,l=`${Et}-outline`,i=!1;function a(s){i=s,n(0,i)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=i?"visible":"none")},[i,t,o,l,a]}class Aa extends U{constructor(e){super(),G(this,e,Oa,La,z,{})}}function Ia(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Local Planning Authorities`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function Pa(r){let e;return{c(){e=S(`local authority
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ma(r){let e;return{c(){e=S(`national park authorit
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ea(r){let e;return{c(){e=S(`development corporation
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Na(r){let e;return{c(){e=S("this map")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Da(r){let e;return{c(){e=S(`planning.data.gov.uk
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Fa(r){let e,n,t,o,l,i,a,s,f,u,c,p,$,k,w,C,y,P,D,I,N,F;return t=new X({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Pa]},$$scope:{ctx:r}}}),l=new X({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Ma]},$$scope:{ctx:r}}}),a=new X({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Ea]},$$scope:{ctx:r}}}),$=new X({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Na]},$$scope:{ctx:r}}}),P=new X({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Da]},$$scope:{ctx:r}}}),N=new Ge({}),{c(){e=M("p"),n=S("LPAs may be a "),h(t.$$.fragment),o=S(", "),h(l.$$.fragment),i=S("y, or "),h(a.$$.fragment),s=S("."),f=O(),u=M("p"),c=M("strong"),p=S(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),h($.$$.fragment),k=S(" to get more details."),w=O(),C=M("p"),y=S("Data from ONS Geography via "),h(P.$$.fragment),D=S(", as of November 2022."),I=O(),h(N.$$.fragment)},m(A,E){d(A,e,E),L(e,n),b(t,e,null),L(e,o),b(l,e,null),L(e,i),b(a,e,null),L(e,s),d(A,f,E),d(A,u,E),L(u,c),L(c,p),b($,c,null),L(c,k),d(A,w,E),d(A,C,E),L(C,y),b(P,C,null),L(C,D),d(A,I,E),b(N,A,E),F=!0},p(A,E){const j={};E&64&&(j.$$scope={dirty:E,ctx:A}),t.$set(j);const T={};E&64&&(T.$$scope={dirty:E,ctx:A}),l.$set(T);const H={};E&64&&(H.$$scope={dirty:E,ctx:A}),a.$set(H);const W={};E&64&&(W.$$scope={dirty:E,ctx:A}),$.$set(W);const V={};E&64&&(V.$$scope={dirty:E,ctx:A}),P.$set(V)},i(A){F||(m(t.$$.fragment,A),m(l.$$.fragment,A),m(a.$$.fragment,A),m($.$$.fragment,A),m(P.$$.fragment,A),m(N.$$.fragment,A),F=!0)},o(A){_(t.$$.fragment,A),_(l.$$.fragment,A),_(a.$$.fragment,A),_($.$$.fragment,A),_(P.$$.fragment,A),_(N.$$.fragment,A),F=!1},d(A){A&&(g(e),g(f),g(u),g(w),g(C),g(I)),v(t),v(l),v(a),v($),v(P),v(N,A)}}}function ja(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Fa]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function Ba(r){let e,n=r[5][0].properties.name+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&32&&n!==(n=o[5][0].properties.name+"")&&K(t,n)},d(o){o&&g(e)}}}function Ha(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[Ba,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ra(r){let e,n,t,o;return e=new st({props:{id:ft,sourceLayer:ft,paint:{"fill-color":r[2],"fill-opacity":ve(0,.5)},layout:{visibility:r[1]},manageHoverState:!0,$$slots:{default:[Ha]},$$scope:{ctx:r}}}),t=new Me({props:{id:r[3],sourceLayer:ft,paint:{"line-color":r[2],"line-width":2.5},layout:{visibility:r[1]}}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function Wa(r){let e,n,t,o,l;function i(s){r[4](s)}let a={id:ft,$$slots:{right:[ja],default:[Ia]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${ft}.pmtiles`,$$slots:{default:[Ra]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let ft="local_planning_authorities";function za(r,e,n){let t,o=Q.local_planning_authorities,l=`${ft}-outline`,i=!1;function a(s){i=s,n(0,i)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=i?"visible":"none")},[i,t,o,l,a]}class Ua extends U{constructor(e){super(),G(this,e,za,Wa,z,{})}}function Ga(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Parliamentary constituencies`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function Va(r){let e;return{c(){e=S(`Ordnance Survey Boundary-Line
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function qa(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[Va]},$$scope:{ctx:r}}}),i=new Ge({}),{c(){e=M("p"),n=S("Data from "),h(t.$$.fragment),o=S(", as of May 2023."),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function Xa(r){let e,n,t;return n=new ae({props:{$$slots:{default:[qa]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function Ka(r){let e,n=r[5][0].properties.Name+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&32&&n!==(n=o[5][0].properties.Name+"")&&K(t,n)},d(o){o&&g(e)}}}function Za(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[Ka,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ya(r){let e,n,t,o;return e=new st({props:{id:ut,sourceLayer:ut,paint:{"fill-color":r[2],"fill-opacity":ve(0,.5)},layout:{visibility:r[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[Za]},$$scope:{ctx:r}}}),e.$on("click",Qa),t=new Me({props:{id:r[3],sourceLayer:ut,paint:{"line-color":r[2],"line-width":5},layout:{visibility:r[1]}}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function Ja(r){let e,n,t,o,l;function i(s){r[4](s)}let a={id:ut,$$slots:{right:[Xa],default:[Ga]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${ut}.pmtiles`,$$slots:{default:[Ya]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let ut="parliamentary_constituencies";function Qa(r){let e=r.detail.features[0].properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function xa(r,e,n){let t,o=Q.parliamentary_constituencies,l=`${ut}-outline`,i=!1;function a(s){i=s,n(0,i)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=i?"visible":"none")},[i,t,o,l,a]}class ef extends U{constructor(e){super(),G(this,e,xa,Ja,z,{})}}function tf(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Wards`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function nf(r){let e;return{c(){e=S(`ONS Geography
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function rf(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[nf]},$$scope:{ctx:r}}}),i=new Ge({}),{c(){e=M("p"),n=S("Data from "),h(t.$$.fragment),o=S(", as of May 2023."),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function of(r){let e,n,t;return n=new ae({props:{$$slots:{default:[rf]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function lf(r){let e,n=r[5][0].properties.name+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&32&&n!==(n=o[5][0].properties.name+"")&&K(t,n)},d(o){o&&g(e)}}}function sf(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[lf,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function af(r){let e,n,t,o;return e=new st({props:{id:ct,sourceLayer:ct,paint:{"fill-color":r[2],"fill-opacity":ve(0,.5)},layout:{visibility:r[1]},manageHoverState:!0,hoverCursor:"pointer",$$slots:{default:[sf]},$$scope:{ctx:r}}}),e.$on("click",uf),t=new Me({props:{id:r[3],sourceLayer:ct,paint:{"line-color":r[2],"line-width":2.5},layout:{visibility:r[1]}}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},p(l,i){const a={};i&2&&(a.layout={visibility:l[1]}),i&64&&(a.$$scope={dirty:i,ctx:l}),e.$set(a);const s={};i&2&&(s.layout={visibility:l[1]}),t.$set(s)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function ff(r){let e,n,t,o,l;function i(s){r[4](s)}let a={id:ct,$$slots:{right:[of],default:[tf]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${ct}.pmtiles`,$$slots:{default:[af]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let ct="wards";function uf(r){let e=encodeURIComponent(r.detail.features[0].properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function cf(r,e,n){let t,o=Q.wards,l=`${ct}-outline`,i=!1;function a(s){i=s,n(0,i)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=i?"visible":"none")},[i,t,o,l,a]}class pf extends U{constructor(e){super(),G(this,e,cf,ff,z,{})}}function mf(r){let e;return{c(){e=S("Open Data Commons Open Database License")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function $f(r){let e,n,t,o;return t=new X({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[mf]},$$scope:{ctx:r}}}),{c(){e=M("p"),n=S("License: "),h(t.$$.fragment)},m(l,i){d(l,e,i),L(e,n),b(t,e,null),o=!0},p(l,[i]){const a={};i&1&&(a.$$scope={dirty:i,ctx:l}),t.$set(a)},i(l){o||(m(t.$$.fragment,l),o=!0)},o(l){_(t.$$.fragment,l),o=!1},d(l){l&&g(e),v(t)}}}class et extends U{constructor(e){super(),G(this,e,null,$f,z,{})}}function df(r){let e,n,t;return e=new we({props:{color:Q.bus_route_with_lane}}),{c(){h(e.$$.fragment),n=S(`
  Bus routes`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function gf(r){let e;return{c(){e=S(`GTFS
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function _f(r){let e,n,t,o,l,i,a,s,f;return l=new X({props:{href:"https://gtfs.org",$$slots:{default:[gf]},$$scope:{ctx:r}}}),s=new et({}),{c(){e=M("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,n=O(),t=M("p"),o=S("Note this data is from OpenStreetMap (as of 9 August 2023), not "),h(l.$$.fragment),i=S(`, and doesn't include which routes are run or the
        frequency of service.`),a=O(),h(s.$$.fragment)},m(u,c){d(u,e,c),d(u,n,c),d(u,t,c),L(t,o),b(l,t,null),L(t,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:u}),l.$set(p)},i(u){f||(m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){_(l.$$.fragment,u),_(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(n),g(t),g(a)),v(l),v(s,u)}}}function hf(r){let e,n,t;return n=new ae({props:{$$slots:{default:[_f]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&16&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function bf(r){let e;return{c(){e=M("p"),e.textContent="At least one bus route crosses here, without any bus lanes"},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function vf(r){let e;return{c(){e=M("p"),e.textContent=`At least one bus route crosses here, with a bus lane in one or more
          directions`},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function wf(r){let e;function n(l,i){return l[3][0].properties.has_bus_lane?vf:bf}let t=n(r),o=t(r);return{c(){o.c(),e=de()},m(l,i){o.m(l,i),d(l,e,i)},p(l,i){t!==(t=n(l))&&(o.d(1),o=t(l),o&&(o.c(),o.m(e.parentNode,e)))},d(l){l&&g(e),o.d(l)}}}function yf(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[wf,({features:t})=>({3:t}),({features:t})=>t?8:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&24&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function kf(r){let e,n;return e=new Me({props:{id:Nt,sourceLayer:Nt,paint:{"line-color":["case",["boolean",["get","has_bus_lane"],!1],Q.bus_route_with_lane,Q.bus_route_without_lane],"line-width":5,"line-opacity":ve(1,.5)},layout:{visibility:r[1]},$$slots:{default:[yf]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&16&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Sf(r){let e,n,t,o,l;function i(s){r[2](s)}let a={id:Nt,$$slots:{right:[hf],default:[df]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${Nt}.pmtiles`,$$slots:{default:[kf]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&16&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&18&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let Nt="bus_routes";function Cf(r,e,n){let t,o=!1;function l(i){o=i,n(0,o)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=o?"visible":"none")},[o,t,l]}class Lf extends U{constructor(e){super(),G(this,e,Cf,Sf,z,{})}}function lr(r){const e=Nf(r[4][0]);r[5]=e[0],r[6]=e[1],r[7]=e[2]}function sr(r,e,n){const t=r.slice();return t[8]=e[n][0],t[9]=e[n][1],t}function Tf(r){let e;return{c(){e=S("Cycle paths")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Of(r){let e,n,t,o,l,i,a,s;return a=new et({}),{c(){e=M("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,n=O(),t=M("ul"),t.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=O(),l=M("p"),l.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,i=O(),h(a.$$.fragment)},m(f,u){d(f,e,u),d(f,n,u),d(f,t,u),d(f,o,u),d(f,l,u),d(f,i,u),b(a,f,u),s=!0},p:x,i(f){s||(m(a.$$.fragment,f),s=!0)},o(f){_(a.$$.fragment,f),s=!1},d(f){f&&(g(e),g(n),g(t),g(o),g(l),g(i)),v(a,f)}}}function Af(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Of]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&4096&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function ir(r){let e,n,t=je(r[2]),o=[];for(let i=0;i<t.length;i+=1)o[i]=ar(sr(r,t,i));const l=i=>_(o[i],1,1,()=>{o[i]=null});return{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=de()},m(i,a){for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(i,a);d(i,e,a),n=!0},p(i,a){if(a&4){t=je(i[2]);let s;for(s=0;s<t.length;s+=1){const f=sr(i,t,s);o[s]?(o[s].p(f,a),m(o[s],1)):(o[s]=ar(f),o[s].c(),m(o[s],1),o[s].m(e.parentNode,e))}for(ne(),s=t.length;s<o.length;s+=1)l(s);re()}},i(i){if(!n){for(let a=0;a<t.length;a+=1)m(o[a]);n=!0}},o(i){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)_(o[a]);n=!1},d(i){i&&g(e),Ot(o,i)}}}function ar(r){let e,n,t,o=r[8]+"",l,i,a;return n=new we({props:{color:r[9]}}),{c(){e=M("div"),h(n.$$.fragment),t=O(),l=S(o),i=O()},m(s,f){d(s,e,f),b(n,e,null),L(e,t),L(e,l),L(e,i),a=!0},p:x,i(s){a||(m(n.$$.fragment,s),a=!0)},o(s){_(n.$$.fragment,s),a=!1},d(s){s&&g(e),v(n)}}}function If(r){lr(r);let e,n=r[5]+"",t,o,l,i,a,s=r[6]+"",f,u,c,p,$=r[7]+"",k;return{c(){e=M("h2"),t=S(n),o=O(),l=M("p"),i=S("Direction: "),a=M("b"),f=O(),u=M("p"),c=S("Width: "),p=M("b"),k=S($)},m(w,C){d(w,e,C),L(e,t),d(w,o,C),d(w,l,C),L(l,i),L(l,a),a.innerHTML=s,d(w,f,C),d(w,u,C),L(u,c),L(u,p),L(p,k)},p(w,C){lr(w),C&16&&n!==(n=w[5]+"")&&K(t,n),C&16&&s!==(s=w[6]+"")&&(a.innerHTML=s),C&16&&$!==($=w[7]+"")&&K(k,$)},d(w){w&&(g(e),g(o),g(l),g(f),g(u))}}}function Pf(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[If,({features:t})=>({4:t}),({features:t})=>t?16:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&4112&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Mf(r){let e,n;return e=new Me({props:{id:Dt,sourceLayer:Dt,paint:{"line-color":kr(["get","kind"],{track:Q.cycle_paths.track,lane:Q.cycle_paths.lane,shared_use_segregated:Q.cycle_paths.shared_use_segregated,shared_use_unsegregated:Q.cycle_paths.shared_use_unsegregated},"red"),"line-width":vt,"line-opacity":ve(1,.5)},layout:{visibility:r[1]},hoverCursor:"pointer",$$slots:{default:[Pf]},$$scope:{ctx:r}}}),e.$on("click",Df),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&4096&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ef(r){let e,n,t,o,l,i;function a(u){r[3](u)}let s={id:Dt,$$slots:{right:[Af],default:[Tf]},$$scope:{ctx:r}};r[0]!==void 0&&(s.checked=r[0]),e=new ie({props:s}),q.push(()=>Y(e,"checked",a));let f=r[0]&&ir(r);return l=new ye({props:{url:`pmtiles://${ue()}/v1/${Dt}.pmtiles`,$$slots:{default:[Mf]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),f&&f.c(),o=O(),h(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&4096&&(p.$$scope={dirty:c,ctx:u}),!n&&c&1&&(n=!0,p.checked=u[0],J(()=>n=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=ir(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(ne(),_(f,1,1,()=>{f=null}),re());const $={};c&4098&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){_(e.$$.fragment,u),_(f),_(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),v(e,u),f&&f.d(u),v(l,u)}}}let Dt="cycle_paths";function Nf(r){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[r.properties.kind],n={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[r.properties.direction],t=r.properties.width=="unknown"?"unknown":`${r.properties.width} meters`;return[e,`${n} ${r.properties.direction}`,t]}function Df(r){window.open(`http://openstreetmap.org/way/${r.detail.features[0].properties.osm_id}`,"_blank")}function Ff(r,e,n){let t,o=[["Separated tracks",Q.cycle_paths.track],["Unprotected lanes",Q.cycle_paths.lane],["Shared-use (segregated)",Q.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",Q.cycle_paths.shared_use_unsegregated]],l=!1;function i(a){l=a,n(0,l)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=l?"visible":"none")},[l,t,o,i]}class jf extends U{constructor(e){super(),G(this,e,Ff,Ef,z,{})}}function fr(r){const e=r[4][0].properties.name??"Unknown MRN road";r[5]=e}function Bf(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Major Road Network`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function Hf(r){let e;return{c(){e=S(`Major Road Network
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Rf(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Hf]},$$scope:{ctx:r}}}),i=new Ge({}),{c(){e=M("p"),n=S("Data from the "),h(t.$$.fragment),o=S(", as of September 2021."),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function Wf(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Rf]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function zf(r){fr(r);let e,n=r[5]+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){fr(o),l&16&&n!==(n=o[5]+"")&&K(t,n)},d(o){o&&g(e)}}}function Uf(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[zf,({features:t})=>({4:t}),({features:t})=>t?16:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&80&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Gf(r){let e,n;return e=new Me({props:{id:Ft,sourceLayer:Ft,paint:{"line-color":r[2],"line-width":7,"line-opacity":ve(1,.5)},layout:{visibility:r[1]},$$slots:{default:[Uf]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&64&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Vf(r){let e,n,t,o,l;function i(s){r[3](s)}let a={id:Ft,$$slots:{right:[Wf],default:[Bf]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${Ft}.pmtiles`,$$slots:{default:[Gf]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&64&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&66&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let Ft="mrn";function qf(r,e,n){let t,o=Q.mrn,l=!1;function i(a){l=a,n(0,l)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=l?"visible":"none")},[l,t,o,i]}class Xf extends U{constructor(e){super(),G(this,e,qf,Vf,z,{})}}function Kf(r){let e;return{c(){e=S("Propensity to Cycle Tool")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Zf(r){let e;return{c(){e=S("the PCT website")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Yf(r){let e;return{c(){e=S("2017 journal article")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Jf(r){let e,n,t,o,l,i,a,s,f,u,c;return a=new X({props:{href:"https://www.pct.bike",$$slots:{default:[Zf]},$$scope:{ctx:r}}}),f=new X({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[Yf]},$$scope:{ctx:r}}}),{c(){e=M("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,n=O(),t=M("p"),t.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=O(),l=M("p"),i=S("See "),h(a.$$.fragment),s=S(" and "),h(f.$$.fragment),u=S(" for details on methodology and data sources.")},m(p,$){d(p,e,$),d(p,n,$),d(p,t,$),d(p,o,$),d(p,l,$),L(l,i),b(a,l,null),L(l,s),b(f,l,null),L(l,u),c=!0},p(p,$){const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),a.$set(k);const w={};$&2048&&(w.$$scope={dirty:$,ctx:p}),f.$set(w)},i(p){c||(m(a.$$.fragment,p),m(f.$$.fragment,p),c=!0)},o(p){_(a.$$.fragment,p),_(f.$$.fragment,p),c=!1},d(p){p&&(g(e),g(n),g(t),g(o),g(l)),v(a),v(f)}}}function Qf(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Jf]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&2048&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function ur(r){let e,n,t,o,l,i,a,s;e=new xe({props:{colorScale:r[3],limits:r[4]}});function f($){r[8]($)}let u={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};r[0]!==void 0&&(u.value=r[0]),t=new Tr({props:u}),q.push(()=>Y(t,"value",f)),t.$on("change",r[6]);function c($){r[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return r[1]!==void 0&&(p.value=r[1]),i=new At({props:p}),q.push(()=>Y(i,"value",c)),i.$on("change",r[6]),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),l=O(),h(i.$$.fragment)},m($,k){b(e,$,k),d($,n,k),b(t,$,k),d($,l,k),b(i,$,k),s=!0},p($,k){const w={};!o&&k&1&&(o=!0,w.value=$[0],J(()=>o=!1)),t.$set(w);const C={};!a&&k&2&&(a=!0,C.value=$[1],J(()=>a=!1)),i.$set(C)},i($){s||(m(e.$$.fragment,$),m(t.$$.fragment,$),m(i.$$.fragment,$),s=!0)},o($){_(e.$$.fragment,$),_(t.$$.fragment,$),_(i.$$.fragment,$),s=!1},d($){$&&(g(n),g(l)),v(e,$),v(t,$),v(i,$)}}}function xf(r){let e,n,t,o,l,i,a,s;function f(p){r[7](p)}let u={id:rt,$$slots:{right:[Qf],default:[Kf]},$$scope:{ctx:r}};r[2]!==void 0&&(u.checked=r[2]),e=new ie({props:u}),q.push(()=>Y(e,"checked",f));let c=r[2]&&ur(r);return l=new Ye({props:{layer:rt,tooltip:r[5],show:r[2]&&r[0]==rt,clickable:!1}}),a=new Ye({props:{layer:Tt,tooltip:r[5],show:r[2]&&r[0]==Tt,clickable:!1}}),{c(){h(e.$$.fragment),t=O(),c&&c.c(),o=O(),h(l.$$.fragment),i=O(),h(a.$$.fragment)},m(p,$){b(e,p,$),d(p,t,$),c&&c.m(p,$),d(p,o,$),b(l,p,$),d(p,i,$),b(a,p,$),s=!0},p(p,[$]){const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),!n&&$&4&&(n=!0,k.checked=p[2],J(()=>n=!1)),e.$set(k),p[2]?c?(c.p(p,$),$&4&&m(c,1)):(c=ur(p),c.c(),m(c,1),c.m(o.parentNode,o)):c&&(ne(),_(c,1,1,()=>{c=null}),re());const w={};$&5&&(w.show=p[2]&&p[0]==rt),l.$set(w);const C={};$&5&&(C.show=p[2]&&p[0]==Tt),a.$set(C)},i(p){s||(m(e.$$.fragment,p),m(c),m(l.$$.fragment,p),m(a.$$.fragment,p),s=!0)},o(p){_(e.$$.fragment,p),_(c),_(l.$$.fragment,p),_(a.$$.fragment,p),s=!1},d(p){p&&(g(t),g(o),g(i)),v(e,p),c&&c.d(p),v(l,p),v(a,p)}}}let rt="pct_commute",Tt="pct_school";function eu(r,e,n){let t;ee(r,Qe,k=>n(10,t=k));let o=Q.sequential_low_to_high,l=[0,50,100,500,1e3,2e3],i=rt,a="baseline";for(let k of[rt,Tt])Cr(t,k,`${ue()}/v1/${k}.pmtiles`),an(t,{id:k,source:k,sourceLayer:k,color:Je(["get",a],l,o),width:vt,opacity:Lr(.5,1)});let s=!1;function f(k){let w=k.properties.baseline,C=k.properties.gov_target,y=k.properties.go_dutch,P=`<h2>Trip purpose: ${i==rt?"commuting":"school"}</h2>`;if(P+=`<p>Baseline (2011): <b>${w.toLocaleString()}</b></p>`,w==0)P+=`<p>Government target (2025): <b>${C.toLocaleString()}</b></p>`,P+=`<p>Go Dutch: <b>${y.toLocaleString()}</b></p>`;else{let D=(C/w).toFixed(1),I=(y/w).toFixed(1);P+=`<p>Government target (2025): ${C.toLocaleString()} (<b>${D}x</b> of baseline)</p>`,P+=`<p>Go Dutch: ${y.toLocaleString()} (<b>${I}x</b> of baseline)</p>`}return P}function u(){t.setPaintProperty(i,"line-color",Je(["get",a],l,o))}function c(k){s=k,n(2,s)}function p(k){i=k,n(0,i)}function $(k){a=k,n(1,a)}return[i,a,s,o,l,f,u,c,p,$]}class tu extends U{constructor(e){super(),G(this,e,eu,xf,z,{})}}function nu(r){let e;return{c(){e=S("OS Speeds")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function ru(r){let e;return{c(){e=S("Basemap")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function ou(r){let e;return{c(){e=S(`Public Sector Geospatial Agreement
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function lu(r){let e,n,t,o,l,i,a,s,f,u,c,p;return t=new X({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[ru]},$$scope:{ctx:r}}}),u=new X({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[ou]},$$scope:{ctx:r}}}),{c(){e=M("p"),n=S("The average speed data is collected over a six-month period by "),h(t.$$.fragment),o=S(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),l=O(),i=M("p"),i.textContent="Data valid as of 1 September, 2023",a=O(),s=M("p"),f=S(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),h(u.$$.fragment),c=S(".")},m($,k){d($,e,k),L(e,n),b(t,e,null),L(e,o),d($,l,k),d($,i,k),d($,a,k),d($,s,k),L(s,f),b(u,s,null),L(s,c),p=!0},p($,k){const w={};k&512&&(w.$$scope={dirty:k,ctx:$}),t.$set(w);const C={};k&512&&(C.$$scope={dirty:k,ctx:$}),u.$set(C)},i($){p||(m(t.$$.fragment,$),m(u.$$.fragment,$),p=!0)},o($){_(t.$$.fragment,$),_(u.$$.fragment,$),p=!1},d($){$&&(g(e),g(l),g(i),g(a),g(s)),v(t),v(u)}}}function su(r){let e,n,t;return n=new ae({props:{$$slots:{default:[lu]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&512&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function cr(r){let e,n,t,o,l;e=new xe({props:{colorScale:r[3],limits:r[4]}});function i(s){r[7](s)}let a={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return r[1]!==void 0&&(a.value=r[1]),t=new Tr({props:a}),q.push(()=>Y(t,"value",i)),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(s,f){b(e,s,f),d(s,n,f),b(t,s,f),l=!0},p(s,f){const u={};!o&&f&2&&(o=!0,u.value=s[1],J(()=>o=!1)),t.$set(u)},i(s){l||(m(e.$$.fragment,s),m(t.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),l=!1},d(s){s&&g(n),v(e,s),v(t,s)}}}function iu(r){let e,n,t=r[8][0].properties.indicative_mph+"",o,l,i,a,s,f=r[8][0].properties.highest_mph+"",u,c,p=r[5][r[8][0].properties.highest_description]+"",$,k;return{c(){e=M("p"),n=S("Posted speed limit: "),o=S(t),l=S(" mph"),i=O(),a=M("p"),s=S("Highest average speed: "),u=S(f),c=S(" mph (during "),$=S(p),k=S(")")},m(w,C){d(w,e,C),L(e,n),L(e,o),L(e,l),d(w,i,C),d(w,a,C),L(a,s),L(a,u),L(a,c),L(a,$),L(a,k)},p(w,C){C&256&&t!==(t=w[8][0].properties.indicative_mph+"")&&K(o,t),C&256&&f!==(f=w[8][0].properties.highest_mph+"")&&K(u,f),C&256&&p!==(p=w[5][w[8][0].properties.highest_description]+"")&&K($,p)},d(w){w&&(g(e),g(i),g(a))}}}function au(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[iu,({features:t})=>({8:t}),({features:t})=>t?256:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&768&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function fu(r){let e,n;return e=new Me({props:{id:jt,sourceLayer:jt,paint:{"line-color":Je(["get",r[1]],r[4],r[3]),"line-width":vt,"line-opacity":ve(1,.5)},layout:{visibility:r[2]},$$slots:{default:[au]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.paint={"line-color":Je(["get",t[1]],t[4],t[3]),"line-width":vt,"line-opacity":ve(1,.5)}),o&4&&(l.layout={visibility:t[2]}),o&512&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function uu(r){let e,n,t,o,l,i;function a(u){r[6](u)}let s={id:jt,$$slots:{right:[su],default:[nu]},$$scope:{ctx:r}};r[0]!==void 0&&(s.checked=r[0]),e=new ie({props:s}),q.push(()=>Y(e,"checked",a));let f=r[0]&&cr(r);return l=new ye({props:{url:`pmtiles://${fn()}/v1/${jt}.pmtiles`,$$slots:{default:[fu]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),f&&f.c(),o=O(),h(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&512&&(p.$$scope={dirty:c,ctx:u}),!n&&c&1&&(n=!0,p.checked=u[0],J(()=>n=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=cr(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(ne(),_(f,1,1,()=>{f=null}),re());const $={};c&518&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){_(e.$$.fragment,u),_(f),_(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),v(e,u),f&&f.d(u),v(l,u)}}}let jt="road_speeds";function cu(r,e,n){let t,o=Q.sequential_low_to_high,l=[0,20,30,40,50,90],i="indicative_mph",a=!1,s={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"};function f(c){a=c,n(0,a)}function u(c){i=c,n(1,i)}return r.$$.update=()=>{r.$$.dirty&1&&n(2,t=a?"visible":"none")},[a,i,t,o,l,s,f,u]}class pu extends U{constructor(e){super(),G(this,e,cu,uu,z,{})}}function mu(r){let e;return{c(){e=S("OS Road widths")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function $u(r){let e;return{c(){e=S(`Public Sector Geospatial Agreement
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function du(r){let e,n,t,o,l,i,a,s,f;return a=new X({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[$u]},$$scope:{ctx:r}}}),{c(){e=M("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,n=O(),t=M("p"),t.textContent="Data valid as of 1 September, 2023",o=O(),l=M("p"),i=S(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),h(a.$$.fragment),s=S(".")},m(u,c){d(u,e,c),d(u,n,c),d(u,t,c),d(u,o,c),d(u,l,c),L(l,i),b(a,l,null),L(l,s),f=!0},p(u,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),a.$set(p)},i(u){f||(m(a.$$.fragment,u),f=!0)},o(u){_(a.$$.fragment,u),f=!1},d(u){u&&(g(e),g(n),g(t),g(o),g(l)),v(a)}}}function gu(r){let e,n,t;return n=new ae({props:{$$slots:{default:[du]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&64&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function pr(r){let e,n;return e=new xe({props:{colorScale:r[2],limits:r[3]}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p:x,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function _u(r){let e,n,t,o=r[5][0].properties.average+"",l,i,a,s,f,u,c=r[5][0].properties.minimum+"",p,$;return{c(){e=M("p"),n=S("Average width: "),t=M("b"),l=S(o),i=S(`
         meters`),a=O(),s=M("p"),f=S("Minimum width: "),u=M("b"),p=S(c),$=S(`
         meters`)},m(k,w){d(k,e,w),L(e,n),L(e,t),L(t,l),L(e,i),d(k,a,w),d(k,s,w),L(s,f),L(s,u),L(u,p),L(s,$)},p(k,w){w&32&&o!==(o=k[5][0].properties.average+"")&&K(l,o),w&32&&c!==(c=k[5][0].properties.minimum+"")&&K(p,c)},d(k){k&&(g(e),g(a),g(s))}}}function hu(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[_u,({features:t})=>({5:t}),({features:t})=>t?32:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&96&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function bu(r){let e,n;return e=new Me({props:{id:Bt,sourceLayer:Bt,paint:{"line-color":Je(["get","average"],r[3],r[2]),"line-width":vt,"line-opacity":ve(1,.5)},layout:{visibility:r[1]},$$slots:{default:[hu]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&64&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function vu(r){let e,n,t,o,l,i;function a(u){r[4](u)}let s={id:Bt,$$slots:{right:[gu],default:[mu]},$$scope:{ctx:r}};r[0]!==void 0&&(s.checked=r[0]),e=new ie({props:s}),q.push(()=>Y(e,"checked",a));let f=r[0]&&pr(r);return l=new ye({props:{url:`pmtiles://${fn()}/v1/${Bt}.pmtiles`,$$slots:{default:[bu]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),f&&f.c(),o=O(),h(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:u}),!n&&c&1&&(n=!0,p.checked=u[0],J(()=>n=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=pr(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(ne(),_(f,1,1,()=>{f=null}),re());const $={};c&66&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){_(e.$$.fragment,u),_(f),_(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),v(e,u),f&&f.d(u),v(l,u)}}}let Bt="road_widths";function wu(r,e,n){let t,o=Q.sequential_low_to_high,l=[0,5,10,15,20,100],i=!1;function a(s){i=s,n(0,i)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=i?"visible":"none")},[i,t,o,l,a]}class yu extends U{constructor(e){super(),G(this,e,wu,vu,z,{})}}function ku(r){let e,n,t;return{c(){e=M("input"),Z(e,"class","govuk-file-upload"),Z(e,"id","load-criticals"),Z(e,"type","file")},m(o,l){d(o,e,l),r[7](e),n||(t=pt(e,"change",r[4]),n=!0)},p:x,d(o){o&&g(e),r[7](null),n=!1,t()}}}function mr(r){let e,n;return e=new yt({props:{small:!0,$$slots:{default:[Cu]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&517&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Su(r){let e,n,t=r[2].toLocaleString()+"",o,l,i;return e=new we({props:{color:rn}}),{c(){h(e.$$.fragment),n=S(`
        Show `),o=S(t),l=S(" issues")},m(a,s){b(e,a,s),d(a,n,s),d(a,o,s),d(a,l,s),i=!0},p(a,s){(!i||s&4)&&t!==(t=a[2].toLocaleString()+"")&&K(o,t)},i(a){i||(m(e.$$.fragment,a),i=!0)},o(a){_(e.$$.fragment,a),i=!1},d(a){a&&(g(n),g(o),g(l)),v(e,a)}}}function Cu(r){let e,n,t;function o(i){r[8](i)}let l={id:"show-criticals",$$slots:{default:[Su]},$$scope:{ctx:r}};return r[0]!==void 0&&(l.checked=r[0]),e=new ie({props:l}),q.push(()=>Y(e,"checked",o)),{c(){h(e.$$.fragment)},m(i,a){b(e,i,a),t=!0},p(i,a){const s={};a&516&&(s.$$scope={dirty:a,ctx:i}),!n&&a&1&&(n=!0,s.checked=i[0],J(()=>n=!1)),e.$set(s)},i(i){t||(m(e.$$.fragment,i),t=!0)},o(i){_(e.$$.fragment,i),t=!1},d(i){v(e,i)}}}function Lu(r){let e,n,t,o,l,i;e=new Sr({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[ku]},$$scope:{ctx:r}}}),t=new Or({props:{errorMessage:r[3]}});let a=r[2]>0&&mr(r);return{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),a&&a.c(),l=de()},m(s,f){b(e,s,f),d(s,n,f),b(t,s,f),d(s,o,f),a&&a.m(s,f),d(s,l,f),i=!0},p(s,f){const u={};f&514&&(u.$$scope={dirty:f,ctx:s}),e.$set(u);const c={};f&8&&(c.errorMessage=s[3]),t.$set(c),s[2]>0?a?(a.p(s,f),f&4&&m(a,1)):(a=mr(s),a.c(),m(a,1),a.m(l.parentNode,l)):a&&(ne(),_(a,1,1,()=>{a=null}),re())},i(s){i||(m(e.$$.fragment,s),m(t.$$.fragment,s),m(a),i=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),_(a),i=!1},d(s){s&&(g(n),g(o),g(l)),v(e,s),v(t,s),a&&a.d(s)}}}function Tu(r){let e,n,t,o,l,i;return e=new Ie({props:{label:"Critical Issues",$$slots:{default:[Lu]},$$scope:{ctx:r}}}),t=new Ye({props:{layer:$e+"-points",tooltip:Ou,show:r[0],clickable:!1}}),l=new Ye({props:{layer:$e+"-clusters",show:r[0],clickable:!0,ignoreHigherLayers:[$e+"-counts"]}}),l.$on("click",r[5]),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),h(l.$$.fragment)},m(a,s){b(e,a,s),d(a,n,s),b(t,a,s),d(a,o,s),b(l,a,s),i=!0},p(a,[s]){const f={};s&527&&(f.$$scope={dirty:s,ctx:a}),e.$set(f);const u={};s&1&&(u.show=a[0]),t.$set(u);const c={};s&1&&(c.show=a[0]),l.$set(c)},i(a){i||(m(e.$$.fragment,a),m(t.$$.fragment,a),m(l.$$.fragment,a),i=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),_(l.$$.fragment,a),i=!1},d(a){a&&(g(n),g(o)),v(e,a),v(t,a),v(l,a)}}}let $e="criticals",rn="red";function Ou(r){let e='<div style="max-width: 30vw;">';return e+=`<h2>${r.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${r.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${r.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${r.properties.id}</b></p>`,e+=`<p>Submitted by <b>${r.properties.inspector??"???"}</b> at <b>${r.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${r.properties.scheme_reference}</b> in stage <b>${r.properties.current_design_stage}</b></p>`,e+="</div>",e}function Au(r,e,n){let t;ee(r,Qe,p=>n(6,t=p));let o,l=!0,i=0,a="";io(t,$e),t.addSource($e,{type:"geojson",data:sn(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),gn(t,{id:`${$e}-clusters`,source:$e,filter:["has","point_count"],color:rn,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),t.addLayer({id:`${$e}-counts`,source:$e,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),gn(t,{id:`${$e}-points`,source:$e,filter:["!",["has","point_count"]],color:rn,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function s(p){try{let $=await oi(o.files[0]);t.getSource($e).setData($),n(2,i=$.features.length),n(3,a="")}catch($){n(3,a=`The file you loaded is broken: ${$}`)}}function f(p){t.getSource($e).getClusterExpansionZoom(p.detail.properties.cluster_id,($,k)=>{$||t.easeTo({center:p.detail.geometry.coordinates,zoom:k})})}function u(p){q[p?"unshift":"push"](()=>{o=p,n(1,o)})}function c(p){l=p,n(0,l)}return r.$$.update=()=>{r.$$.dirty&65&&t.getLayer(`${$e}-counts`)&&t.setLayoutProperty(`${$e}-counts`,"visibility",l?"visible":"none")},[l,o,i,a,s,f,t,u,c]}class Iu extends U{constructor(e){super(),G(this,e,Au,Tu,z,{})}}function Pu(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Crossings`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function Mu(r){let e;return{c(){e=S("crossing")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Eu(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[Mu]},$$scope:{ctx:r}}}),i=new et({}),{c(){e=M("p"),n=S("This shows "),h(t.$$.fragment),o=S(" data from OpenStreetMap (as of 9 August 2023)."),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function Nu(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Eu]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&32&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function Du(r){let e,n=$r(r[4][0])+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&16&&n!==(n=$r(o[4][0])+"")&&K(t,n)},d(o){o&&g(e)}}}function Fu(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[Du,({features:t})=>({4:t}),({features:t})=>t?16:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&48&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ju(r){let e,n;return e=new zt({props:{id:Ht,sourceLayer:Ht,paint:{"circle-color":r[2],"circle-radius":["interpolate",["linear"],["zoom"],1,2,8,3,13,10]},layout:{visibility:r[1]},$$slots:{default:[Fu]},$$scope:{ctx:r}}}),e.$on("click",Hu),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Bu(r){let e,n,t,o,l;function i(s){r[3](s)}let a={id:Ht,$$slots:{right:[Nu],default:[Pu]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${Ht}.pmtiles`,$$slots:{default:[ju]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&34&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let Ht="crossings";function $r(r){const e=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]),n=r.properties.crossing;return`${e.get(n)??`Crossing with unknown type (${n})`}. Click for details.`}function Hu(r){window.open(`http://openstreetmap.org/node/${r.detail.features[0].properties.osm_id}`,"_blank")}function Ru(r,e,n){let t,o=Q.crossings,l=!1;function i(a){l=a,n(0,l)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=l?"visible":"none")},[l,t,o,i]}class Wu extends U{constructor(e){super(),G(this,e,Ru,Bu,z,{})}}function zu(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Cycle parking`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function Uu(r){let e;return{c(){e=S("OpenStreetMap")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Gu(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Uu]},$$scope:{ctx:r}}}),i=new et({}),{c(){e=M("p"),n=S("Cycle parking, according to "),h(t.$$.fragment),o=S(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function Vu(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Gu]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&32&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function qu(r){let e,n=dr(r[4][0])+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&16&&n!==(n=dr(o[4][0])+"")&&K(t,n)},d(o){o&&g(e)}}}function Xu(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[qu,({features:t})=>({4:t}),({features:t})=>t?16:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&48&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ku(r){let e,n;return e=new zt({props:{id:Rt,sourceLayer:Rt,paint:{"circle-color":r[2],"circle-radius":["interpolate",["linear"],["zoom"],1,2,8,3,13,10]},layout:{visibility:r[1]},manageHoverState:!0,$$slots:{default:[Xu]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Zu(r){let e,n,t,o,l;function i(s){r[3](s)}let a={id:Rt,$$slots:{right:[Vu],default:[zu]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${Rt}.pmtiles`,$$slots:{default:[Ku]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&34&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let Rt="cycle_parking";function dr(r){return`Capacity: ${r.properties.capacity??"unknown"}`}function Yu(r,e,n){let t,o=Q.cycle_parking,l=!1;function i(a){l=a,n(0,l)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=l?"visible":"none")},[l,t,o,i]}class Ju extends U{constructor(e){super(),G(this,e,Yu,Zu,z,{})}}function Qu(r){let e,n,t,o;return e=new we({props:{color:r[4]}}),{c(){h(e.$$.fragment),n=O(),t=S(r[1])},m(l,i){b(e,l,i),d(l,n,i),d(l,t,i),o=!0},p(l,i){(!o||i&2)&&K(t,l[1])},i(l){o||(m(e.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),o=!1},d(l){l&&(g(n),g(t)),v(e,l)}}}function xu(r){let e;const n=r[7].default,t=Re(n,r,r[9],null);return{c(){t&&t.c()},m(o,l){t&&t.m(o,l),e=!0},p(o,l){t&&t.p&&(!e||l&512)&&We(t,n,o,o[9],e?Ue(n,o[9],l,null):ze(o[9]),null)},i(o){e||(m(t,o),e=!0)},o(o){_(t,o),e=!1},d(o){t&&t.d(o)}}}function ec(r){let e,n,t;return n=new ae({props:{$$slots:{default:[xu]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&512&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function tc(r){let e,n=r[5](r[10][0])+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&1024&&n!==(n=o[5](o[10][0])+"")&&K(t,n)},d(o){o&&g(e)}}}function nc(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[tc,({features:t})=>({10:t}),({features:t})=>t?1024:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&1536&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function rc(r){let e,n;return e=new st({props:{id:r[0],sourceLayer:r[0],paint:{"fill-color":r[4],"fill-opacity":ve(.7,1)},layout:{visibility:r[3]},manageHoverState:!0,$$slots:{default:[nc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&1&&(l.id=t[0]),o&1&&(l.sourceLayer=t[0]),o&8&&(l.layout={visibility:t[3]}),o&512&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function oc(r){let e,n,t,o,l;function i(s){r[8](s)}let a={id:r[0],$$slots:{right:[ec],default:[Qu]},$$scope:{ctx:r}};return r[2]!==void 0&&(a.checked=r[2]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new ye({props:{url:`pmtiles://${ue()}/v1/${r[0]}.pmtiles`,$$slots:{default:[rc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&1&&(u.id=s[0]),f&514&&(u.$$scope={dirty:f,ctx:s}),!n&&f&4&&(n=!0,u.checked=s[2],J(()=>n=!1)),e.$set(u);const c={};f&1&&(c.url=`pmtiles://${ue()}/v1/${s[0]}.pmtiles`),f&521&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}function lc(r,e,n){let t,{$$slots:o={},$$scope:l}=e,{name:i}=e,{singularNoun:a}=e,{pluralNoun:s}=e,f=Q[i],u=!1;function c($){return $.properties.name??`Unnamed ${a}`}function p($){u=$,n(2,u)}return r.$$set=$=>{"name"in $&&n(0,i=$.name),"singularNoun"in $&&n(6,a=$.singularNoun),"pluralNoun"in $&&n(1,s=$.pluralNoun),"$$scope"in $&&n(9,l=$.$$scope)},r.$$.update=()=>{r.$$.dirty&4&&n(3,t=u?"visible":"none")},[i,s,u,t,f,c,a,o,p,l]}class mn extends U{constructor(e){super(),G(this,e,lc,oc,z,{name:0,singularNoun:6,pluralNoun:1})}}function sc(r){let e;return{c(){e=S("hospital")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function ic(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[sc]},$$scope:{ctx:r}}}),i=new et({}),{c(){e=M("p"),n=S("This shows "),h(t.$$.fragment),o=S(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&1&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function ac(r){let e,n;return e=new mn({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[ic]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,[o]){const l={};o&1&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class fc extends U{constructor(e){super(),G(this,e,null,ac,z,{})}}function uc(r){let e,n,t;return e=new we({props:{color:r[2]}}),{c(){h(e.$$.fragment),n=S(`
  Railway Stations`)},m(o,l){b(e,o,l),d(o,n,l),t=!0},p:x,i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){_(e.$$.fragment,o),t=!1},d(o){o&&g(n),v(e,o)}}}function cc(r){let e;return{c(){e=S("railway station")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function pc(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[cc]},$$scope:{ctx:r}}}),i=new et({}),{c(){e=M("p"),n=S("This shows "),h(t.$$.fragment),o=S(" data from OpenStreetMap (as of 9 August 2023)."),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function mc(r){let e,n,t;return n=new ae({props:{$$slots:{default:[pc]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&32&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function $c(r){let e,n=gr(r[4][0])+"",t;return{c(){e=M("p"),t=S(n)},m(o,l){d(o,e,l),L(e,t)},p(o,l){l&16&&n!==(n=gr(o[4][0])+"")&&K(t,n)},d(o){o&&g(e)}}}function dc(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[$c,({features:t})=>({4:t}),({features:t})=>t?16:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&48&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function gc(r){let e,n;return e=new zt({props:{id:on,paint:{"circle-color":r[2],"circle-radius":go/2},layout:{visibility:r[1]},$$slots:{default:[dc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function _c(r){let e,n,t,o,l;function i(s){r[3](s)}let a={id:on,$$slots:{right:[mc],default:[uc]},$$scope:{ctx:r}};return r[0]!==void 0&&(a.checked=r[0]),e=new ie({props:a}),q.push(()=>Y(e,"checked",i)),o=new cn({props:{data:`${ue()}/v1/${on}.geojson`,$$slots:{default:[gc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,[f]){const u={};f&32&&(u.$$scope={dirty:f,ctx:s}),!n&&f&1&&(n=!0,u.checked=s[0],J(()=>n=!1)),e.$set(u);const c={};f&34&&(c.$$scope={dirty:f,ctx:s}),o.$set(c)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),v(e,s),v(o,s)}}}let on="railway_stations";function gr(r){return r.properties.name??"Unnamed railway station"}function hc(r,e,n){let t,o=Q.railway_stations,l=!1;function i(a){l=a,n(0,l)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=l?"visible":"none")},[l,t,o,i]}class bc extends U{constructor(e){super(),G(this,e,hc,_c,z,{})}}function vc(r){let e;return{c(){e=S("primary and secondary schools")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function wc(r){let e,n,t,o,l,i,a;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[vc]},$$scope:{ctx:r}}}),i=new et({}),{c(){e=M("p"),n=S("This shows "),h(t.$$.fragment),o=S(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),l=O(),h(i.$$.fragment)},m(s,f){d(s,e,f),L(e,n),b(t,e,null),L(e,o),d(s,l,f),b(i,s,f),a=!0},p(s,f){const u={};f&1&&(u.$$scope={dirty:f,ctx:s}),t.$set(u)},i(s){a||(m(t.$$.fragment,s),m(i.$$.fragment,s),a=!0)},o(s){_(t.$$.fragment,s),_(i.$$.fragment,s),a=!1},d(s){s&&(g(e),g(l)),v(t),v(i,s)}}}function yc(r){let e,n;return e=new mn({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[wc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,[o]){const l={};o&1&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class kc extends U{constructor(e){super(),G(this,e,null,yc,z,{})}}function Sc(r){let e;return{c(){e=S("sports pitches")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Cc(r){let e;return{c(){e=S("sports centres")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Lc(r){let e,n,t,o,l,i,a,s,f;return t=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[Sc]},$$scope:{ctx:r}}}),l=new X({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[Cc]},$$scope:{ctx:r}}}),s=new et({}),{c(){e=M("p"),n=S("This shows "),h(t.$$.fragment),o=S(" and "),h(l.$$.fragment),i=S(" data from OpenStreetMap (as of 9 August 2023)."),a=O(),h(s.$$.fragment)},m(u,c){d(u,e,c),L(e,n),b(t,e,null),L(e,o),b(l,e,null),L(e,i),d(u,a,c),b(s,u,c),f=!0},p(u,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:u}),t.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){f||(m(t.$$.fragment,u),m(l.$$.fragment,u),m(s.$$.fragment,u),f=!0)},o(u){_(t.$$.fragment,u),_(l.$$.fragment,u),_(s.$$.fragment,u),f=!1},d(u){u&&(g(e),g(a)),v(t),v(l),v(s,u)}}}function Tc(r){let e,n;return e=new mn({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Lc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,[o]){const l={};o&1&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class Oc extends U{constructor(e){super(),G(this,e,null,Tc,z,{})}}function _r(r){const e=Bc(r[6][0]);r[7]=e[0],r[8]=e[1],r[9]=e[2],r[10]=e[3]}function Ac(r){let e;return{c(){e=S("Vehicle counts")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Ic(r){let e;return{c(){e=S(`DfT road statistics
        `)},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Pc(r){let e;return{c(){e=S("methodology")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function Mc(r){let e,n,t,o,l,i,a,s,f,u,c;return t=new X({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[Ic]},$$scope:{ctx:r}}}),l=new X({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[Pc]},$$scope:{ctx:r}}}),u=new Ge({}),{c(){e=M("p"),n=S("2022 AADF (annual average daily flow) data from "),h(t.$$.fragment),o=S(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),h(l.$$.fragment),i=S(" for details and caveats about the measurements."),a=O(),s=M("p"),s.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=O(),h(u.$$.fragment)},m(p,$){d(p,e,$),L(e,n),b(t,e,null),L(e,o),b(l,e,null),L(e,i),d(p,a,$),d(p,s,$),d(p,f,$),b(u,p,$),c=!0},p(p,$){const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),t.$set(k);const w={};$&2048&&(w.$$scope={dirty:$,ctx:p}),l.$set(w)},i(p){c||(m(t.$$.fragment,p),m(l.$$.fragment,p),m(u.$$.fragment,p),c=!0)},o(p){_(t.$$.fragment,p),_(l.$$.fragment,p),_(u.$$.fragment,p),c=!1},d(p){p&&(g(e),g(a),g(s),g(f)),v(t),v(l),v(u,p)}}}function Ec(r){let e,n,t;return n=new ae({props:{$$slots:{default:[Mc]},$$scope:{ctx:r}}}),{c(){e=M("span"),h(n.$$.fragment),Z(e,"slot","right")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&2048&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function hr(r){let e,n;return e=new xe({props:{colorScale:r[2],limits:r[4]}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p:x,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Nc(r){_r(r);let e,n=r[7]+"",t,o,l,i,a,s=r[8]+"",f,u,c,p,$,k=r[9]+"",w,C,y,P,D,I=r[10]+"",N;return{c(){e=M("h2"),t=S(n),o=O(),l=M("p"),i=S("Total motor vehicles (2022 AADF): "),a=M("b"),f=S(s),u=O(),c=M("p"),p=S("Total pedal cycles (2022 AADF): "),$=M("b"),w=S(k),C=O(),y=M("p"),P=S("Count method: "),D=M("b"),N=S(I)},m(F,A){d(F,e,A),L(e,t),d(F,o,A),d(F,l,A),L(l,i),L(l,a),L(a,f),d(F,u,A),d(F,c,A),L(c,p),L(c,$),L($,w),d(F,C,A),d(F,y,A),L(y,P),L(y,D),L(D,N)},p(F,A){_r(F),A&64&&n!==(n=F[7]+"")&&K(t,n),A&64&&s!==(s=F[8]+"")&&K(f,s),A&64&&k!==(k=F[9]+"")&&K(w,k),A&64&&I!==(I=F[10]+"")&&K(N,I)},d(F){F&&(g(e),g(o),g(l),g(u),g(c),g(C),g(y))}}}function Dc(r){let e,n;return e=new pe({props:{openOn:"hover",$$slots:{default:[Nc,({features:t})=>({6:t}),({features:t})=>t?64:0]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2112&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Fc(r){let e,n;return e=new zt({props:{id:Wt,sourceLayer:Wt,paint:{"circle-color":Je(["get","motor_vehicles_2022"],r[3],r[2]),"circle-opacity":.9,"circle-radius":["interpolate",["linear"],["zoom"],1,2,8,3,13,15],"circle-stroke-color":"black","circle-stroke-width":.1},layout:{visibility:r[1]},$$slots:{default:[Dc]},$$scope:{ctx:r}}}),e.$on("click",Hc),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.layout={visibility:t[1]}),o&2048&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function jc(r){let e,n,t,o,l,i;function a(u){r[5](u)}let s={id:Wt,$$slots:{right:[Ec],default:[Ac]},$$scope:{ctx:r}};r[0]!==void 0&&(s.checked=r[0]),e=new ie({props:s}),q.push(()=>Y(e,"checked",a));let f=r[0]&&hr(r);return l=new ye({props:{url:`pmtiles://${ue()}/v1/${Wt}.pmtiles`,$$slots:{default:[Fc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment),t=O(),f&&f.c(),o=O(),h(l.$$.fragment)},m(u,c){b(e,u,c),d(u,t,c),f&&f.m(u,c),d(u,o,c),b(l,u,c),i=!0},p(u,[c]){const p={};c&2048&&(p.$$scope={dirty:c,ctx:u}),!n&&c&1&&(n=!0,p.checked=u[0],J(()=>n=!1)),e.$set(p),u[0]?f?(f.p(u,c),c&1&&m(f,1)):(f=hr(u),f.c(),m(f,1),f.m(o.parentNode,o)):f&&(ne(),_(f,1,1,()=>{f=null}),re());const $={};c&2050&&($.$$scope={dirty:c,ctx:u}),l.$set($)},i(u){i||(m(e.$$.fragment,u),m(f),m(l.$$.fragment,u),i=!0)},o(u){_(e.$$.fragment,u),_(f),_(l.$$.fragment,u),i=!1},d(u){u&&(g(t),g(o)),v(e,u),f&&f.d(u),v(l,u)}}}let Wt="vehicle_counts";function Bc(r){let e=r.properties;return[e.location,e.motor_vehicles_2022.toLocaleString(),e.pedal_cycles_2022.toLocaleString(),e.method]}function Hc(r){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${r.detail.features[0].properties.count_point}`,"_blank")}function Rc(r,e,n){let t,o=Q.sequential_low_to_high,l=[0,4e4,8e4,12e4,16e4,205e3],i=["","40k","80k","120k","160k",""],a=!1;function s(f){a=f,n(0,a)}return r.$$.update=()=>{r.$$.dirty&1&&n(1,t=a?"visible":"none")},[a,t,o,l,i,s]}class Wc extends U{constructor(e){super(),G(this,e,Rc,jc,z,{})}}function zc(r){let e,n,t,o,l,i,a,s;return e=new kc({}),t=new fc({}),l=new Oc({}),a=new bc({}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),h(l.$$.fragment),i=O(),h(a.$$.fragment)},m(f,u){b(e,f,u),d(f,n,u),b(t,f,u),d(f,o,u),b(l,f,u),d(f,i,u),b(a,f,u),s=!0},i(f){s||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(l.$$.fragment,f),m(a.$$.fragment,f),s=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(l.$$.fragment,f),_(a.$$.fragment,f),s=!1},d(f){f&&(g(n),g(o),g(i)),v(e,f),v(t,f),v(l,f),v(a,f)}}}function Uc(r){let e,n;return e=new yt({props:{small:!0,$$slots:{default:[zc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Gc(r){let e,n,t,o,l,i,a,s,f,u;return e=new jf({}),t=new Xf({}),l=new Lf({}),a=new Ju({}),f=new Wu({}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),h(l.$$.fragment),i=O(),h(a.$$.fragment),s=O(),h(f.$$.fragment)},m(c,p){b(e,c,p),d(c,n,p),b(t,c,p),d(c,o,p),b(l,c,p),d(c,i,p),b(a,c,p),d(c,s,p),b(f,c,p),u=!0},i(c){u||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(l.$$.fragment,c),m(a.$$.fragment,c),m(f.$$.fragment,c),u=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(l.$$.fragment,c),_(a.$$.fragment,c),_(f.$$.fragment,c),u=!1},d(c){c&&(g(n),g(o),g(i),g(s)),v(e,c),v(t,c),v(l,c),v(a,c),v(f,c)}}}function Vc(r){let e,n;return e=new yt({props:{small:!0,$$slots:{default:[Gc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function qc(r){let e,n,t,o,l,i,a,s,f,u;return e=new ef({}),t=new pf({}),l=new ia({}),a=new Aa({}),f=new Ua({}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),h(l.$$.fragment),i=O(),h(a.$$.fragment),s=O(),h(f.$$.fragment)},m(c,p){b(e,c,p),d(c,n,p),b(t,c,p),d(c,o,p),b(l,c,p),d(c,i,p),b(a,c,p),d(c,s,p),b(f,c,p),u=!0},i(c){u||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(l.$$.fragment,c),m(a.$$.fragment,c),m(f.$$.fragment,c),u=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(l.$$.fragment,c),_(a.$$.fragment,c),_(f.$$.fragment,c),u=!1},d(c){c&&(g(n),g(o),g(i),g(s)),v(e,c),v(t,c),v(l,c),v(a,c),v(f,c)}}}function Xc(r){let e,n;return e=new yt({props:{small:!0,$$slots:{default:[qc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&32&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Kc(r){let e,n,t,o;return e=new Yi({}),t=new ha({}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function Zc(r){let e,n,t,o;return e=new yu({}),t=new pu({}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment)},m(l,i){b(e,l,i),d(l,n,i),b(t,l,i),o=!0},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),o=!1},d(l){l&&g(n),v(e,l),v(t,l)}}}function Yc(r){let e,n,t,o,l=ln()=="Private (development)",i,a;e=new Wc({}),t=new tu({});let s=l&&Zc();return{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),s&&s.c(),i=de()},m(f,u){b(e,f,u),d(f,n,u),b(t,f,u),d(f,o,u),s&&s.m(f,u),d(f,i,u),a=!0},p:x,i(f){a||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(s),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(s),a=!1},d(f){f&&(g(n),g(o),g(i)),v(e,f),v(t,f),s&&s.d(f)}}}function Jc(r){let e,n,t,o,l;function i(s){r[4](s)}let a={displayEnableButton:!0};return r[1]!==void 0&&(a.isInactive=r[1]),e=new ho({props:a}),r[3](e),q.push(()=>Y(e,"isInactive",i)),o=new Ci({}),{c(){h(e.$$.fragment),t=O(),h(o.$$.fragment)},m(s,f){b(e,s,f),d(s,t,f),b(o,s,f),l=!0},p(s,f){const u={};!n&&f&2&&(n=!0,u.isInactive=s[1],J(()=>n=!1)),e.$set(u)},i(s){l||(m(e.$$.fragment,s),m(o.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),_(o.$$.fragment,s),l=!1},d(s){s&&g(t),r[3](null),v(e,s),v(o,s)}}}function Qc(r){let e,n,t,o,l,i,a,s,f,u,c,p,$,k,w,C;return e=new Iu({}),t=new Ie({props:{label:"Trip generators",$$slots:{default:[Uc]},$$scope:{ctx:r}}}),l=new Ie({props:{label:"Existing infrastructure",$$slots:{default:[Vc]},$$scope:{ctx:r}}}),a=new Ie({props:{label:"Boundaries",$$slots:{default:[Xc]},$$scope:{ctx:r}}}),f=new Ie({props:{label:"Census",$$slots:{default:[Kc]},$$scope:{ctx:r}}}),c=new Ie({props:{label:"Other",$$slots:{default:[Yc]},$$scope:{ctx:r}}}),$=new Ie({props:{label:"Tools",$$slots:{default:[Jc]},$$scope:{ctx:r}}}),w=new _o({props:{disabled:!r[1]}}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),h(l.$$.fragment),i=O(),h(a.$$.fragment),s=O(),h(f.$$.fragment),u=O(),h(c.$$.fragment),p=O(),h($.$$.fragment),k=O(),h(w.$$.fragment)},m(y,P){b(e,y,P),d(y,n,P),b(t,y,P),d(y,o,P),b(l,y,P),d(y,i,P),b(a,y,P),d(y,s,P),b(f,y,P),d(y,u,P),b(c,y,P),d(y,p,P),b($,y,P),d(y,k,P),b(w,y,P),C=!0},p(y,P){const D={};P&32&&(D.$$scope={dirty:P,ctx:y}),t.$set(D);const I={};P&32&&(I.$$scope={dirty:P,ctx:y}),l.$set(I);const N={};P&32&&(N.$$scope={dirty:P,ctx:y}),a.$set(N);const F={};P&32&&(F.$$scope={dirty:P,ctx:y}),f.$set(F);const A={};P&32&&(A.$$scope={dirty:P,ctx:y}),c.$set(A);const E={};P&35&&(E.$$scope={dirty:P,ctx:y}),$.$set(E);const j={};P&2&&(j.disabled=!y[1]),w.$set(j)},i(y){C||(m(e.$$.fragment,y),m(t.$$.fragment,y),m(l.$$.fragment,y),m(a.$$.fragment,y),m(f.$$.fragment,y),m(c.$$.fragment,y),m($.$$.fragment,y),m(w.$$.fragment,y),C=!0)},o(y){_(e.$$.fragment,y),_(t.$$.fragment,y),_(l.$$.fragment,y),_(a.$$.fragment,y),_(f.$$.fragment,y),_(c.$$.fragment,y),_($.$$.fragment,y),_(w.$$.fragment,y),C=!1},d(y){y&&(g(n),g(o),g(i),g(s),g(u),g(p),g(k)),v(e,y),v(t,y),v(l,y),v(a,y),v(f,y),v(c,y),v($,y),v(w,y)}}}function xc(r){let e,n,t,o;return e=new Ie({props:{label:"Layers",open:!0,$$slots:{default:[Qc]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(l,i){b(e,l,i),n=!0,t||(o=pt(window,"keydown",r[2]),t=!0)},p(l,[i]){const a={};i&35&&(a.$$scope={dirty:i,ctx:l}),e.$set(a)},i(l){n||(m(e.$$.fragment,l),n=!0)},o(l){_(e.$$.fragment,l),n=!1},d(l){v(e,l),t=!1,o()}}}function ep(r,e,n){let t;ee(r,_n,s=>n(1,t=s));let o;function l(s){!t&&s.key=="Escape"&&(o.disableStreetView(),s.preventDefault())}function i(s){q[s?"unshift":"push"](()=>{o=s,n(0,o)})}function a(s){t=s,_n.set(t)}return[o,t,l,i,a]}class tp extends U{constructor(e){super(),G(this,e,ep,xc,z,{})}}function np(r,e,n){let{loadFile:t}=e;return $t(async()=>{let l=await(await fetch(`${fn()}/v1/random_schemes.geojson`)).text();t(l)}),r.$$set=o=>{"loadFile"in o&&n(0,t=o.loadFile)},[t]}class rp extends U{constructor(e){super(),G(this,e,np,null,z,{loadFile:0})}}function op(r){let e;return{c(){e=S("Show on map")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function lp(r){let e;return{c(){e=S("Edit scheme locally")},m(n,t){d(n,e,t)},d(n){n&&g(e)}}}function sp(r){let e,n,t=r[0].authority_or_region+"",o,l,i,a,s=r[0].capital_scheme_id+"",f,u,c,p,$=r[0].funding_programme+"",k,w,C,y,P,D,I;return y=new _t({props:{$$slots:{default:[op]},$$scope:{ctx:r}}}),y.$on("click",r[3]),D=new _t({props:{disabled:r[1],title:r[2],$$slots:{default:[lp]},$$scope:{ctx:r}}}),D.$on("click",r[4]),{c(){e=M("p"),n=S("Authority or region: "),o=S(t),l=O(),i=M("p"),a=S("Capital scheme ID: "),f=S(s),u=O(),c=M("p"),p=S("Funding programme: "),k=S($),w=O(),C=M("div"),h(y.$$.fragment),P=O(),h(D.$$.fragment),Z(C,"class","govuk-button-group")},m(N,F){d(N,e,F),L(e,n),L(e,o),d(N,l,F),d(N,i,F),L(i,a),L(i,f),d(N,u,F),d(N,c,F),L(c,p),L(c,k),d(N,w,F),d(N,C,F),b(y,C,null),L(C,P),b(D,C,null),I=!0},p(N,F){(!I||F&1)&&t!==(t=N[0].authority_or_region+"")&&K(o,t),(!I||F&1)&&s!==(s=N[0].capital_scheme_id+"")&&K(f,s),(!I||F&1)&&$!==($=N[0].funding_programme+"")&&K(k,$);const A={};F&256&&(A.$$scope={dirty:F,ctx:N}),y.$set(A);const E={};F&256&&(E.$$scope={dirty:F,ctx:N}),D.$set(E)},i(N){I||(m(y.$$.fragment,N),m(D.$$.fragment,N),I=!0)},o(N){_(y.$$.fragment,N),_(D.$$.fragment,N),I=!1},d(N){N&&(g(e),g(l),g(i),g(u),g(c),g(w),g(C)),v(y),v(D)}}}function ip(r){let e,n;return e=new Ie({props:{label:`${r[0].scheme_reference}: ${r[0].num_features} features`,$$slots:{default:[sp]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,[o]){const l={};o&1&&(l.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),o&257&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ap(r,e,n){let t,o;ee(r,at,c=>n(6,t=c)),ee(r,Qe,c=>n(7,o=c));let{scheme:l}=e,{authorityNames:i}=e,a=!i.has(l.authority_or_region),s=a?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==l.scheme_reference)};o==null||o.fitBounds(ao(c),{padding:20,animate:!1})}function u(){let c={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==l.scheme_reference)},p=l.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${l.authority_or_region}`,"_blank")}return r.$$set=c=>{"scheme"in c&&n(0,l=c.scheme),"authorityNames"in c&&n(5,i=c.authorityNames)},[l,a,s,f,u,i]}class fp extends U{constructor(e){super(),G(this,e,ap,ip,z,{scheme:0,authorityNames:5})}}const up=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];function br(r,e,n){const t=r.slice();return t[13]=e[n],t}function cp(r){let e,n;return e=new rp({props:{loadFile:r[7]}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p:x,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function vr(r){let e,n,t,o;function l(s){r[9](s)}function i(s){r[10](s)}let a={schemes:r[1]};return r[2]!==void 0&&(a.schemesToBeShown=r[2]),r[3]!==void 0&&(a.filterText=r[3]),e=new di({props:a}),q.push(()=>Y(e,"schemesToBeShown",l)),q.push(()=>Y(e,"filterText",i)),{c(){h(e.$$.fragment)},m(s,f){b(e,s,f),o=!0},p(s,f){const u={};f&2&&(u.schemes=s[1]),!n&&f&4&&(n=!0,u.schemesToBeShown=s[2],J(()=>n=!1)),!t&&f&8&&(t=!0,u.filterText=s[3],J(()=>t=!1)),e.$set(u)},i(s){o||(m(e.$$.fragment,s),o=!0)},o(s){_(e.$$.fragment,s),o=!1},d(s){v(e,s)}}}function wr(r){let e,n;return e=new fp({props:{scheme:r[13],authorityNames:r[6]}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,o){const l={};o&2&&(l.scheme=t[13]),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function yr(r){let e=r[2].has(r[13].scheme_reference),n,t,o=e&&wr(r);return{c(){o&&o.c(),n=de()},m(l,i){o&&o.m(l,i),d(l,n,i),t=!0},p(l,i){i&6&&(e=l[2].has(l[13].scheme_reference)),e?o?(o.p(l,i),i&6&&m(o,1)):(o=wr(l),o.c(),m(o,1),o.m(n.parentNode,n)):o&&(ne(),_(o,1,1,()=>{o=null}),re())},i(l){t||(m(o),t=!0)},o(l){_(o),t=!1},d(l){l&&g(n),o&&o.d(l)}}}function pp(r){let e,n,t,o,l,i,a,s,f,u,c=ln()=="Private (development)",p,$,k,w,C,y,P,D;l=new ko({props:{boundaryGeojson:r[5]}}),a=new nl({}),f=new fo({});let I=c&&cp(r);$=new Co({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:r[7]}}),w=new Or({props:{errorMessage:r[0]}});let N=r[1].size>0&&vr(r),F=je(r[1].values()),A=[];for(let j=0;j<F.length;j+=1)A[j]=yr(br(r,F,j));const E=j=>_(A[j],1,1,()=>{A[j]=null});return{c(){e=M("div"),n=M("div"),t=M("h1"),t.textContent="Browse schemes",o=O(),h(l.$$.fragment),i=O(),h(a.$$.fragment),s=O(),h(f.$$.fragment),u=O(),I&&I.c(),p=O(),h($.$$.fragment),k=O(),h(w.$$.fragment),C=O(),N&&N.c(),y=O(),P=M("ul");for(let j=0;j<A.length;j+=1)A[j].c();He(n,"display","flex"),He(n,"justify-content","space-between"),Z(e,"slot","sidebar"),Z(e,"class","govuk-prose")},m(j,T){d(j,e,T),L(e,n),L(n,t),L(n,o),b(l,n,null),L(e,i),b(a,e,null),L(e,s),b(f,e,null),L(e,u),I&&I.m(e,null),L(e,p),b($,e,null),L(e,k),b(w,e,null),L(e,C),N&&N.m(e,null),L(e,y),L(e,P);for(let H=0;H<A.length;H+=1)A[H]&&A[H].m(P,null);D=!0},p(j,T){const H={};T&32&&(H.boundaryGeojson=j[5]),l.$set(H),c&&I.p(j,T);const W={};if(T&1&&(W.errorMessage=j[0]),w.$set(W),j[1].size>0?N?(N.p(j,T),T&2&&m(N,1)):(N=vr(j),N.c(),m(N,1),N.m(e,y)):N&&(ne(),_(N,1,1,()=>{N=null}),re()),T&70){F=je(j[1].values());let V;for(V=0;V<F.length;V+=1){const le=br(j,F,V);A[V]?(A[V].p(le,T),m(A[V],1)):(A[V]=yr(le),A[V].c(),m(A[V],1),A[V].m(P,null))}for(ne(),V=F.length;V<A.length;V+=1)E(V);re()}},i(j){if(!D){m(l.$$.fragment,j),m(a.$$.fragment,j),m(f.$$.fragment,j),m(I),m($.$$.fragment,j),m(w.$$.fragment,j),m(N);for(let T=0;T<F.length;T+=1)m(A[T]);D=!0}},o(j){_(l.$$.fragment,j),_(a.$$.fragment,j),_(f.$$.fragment,j),_(I),_($.$$.fragment,j),_(w.$$.fragment,j),_(N),A=A.filter(Boolean);for(let T=0;T<A.length;T+=1)_(A[T]);D=!1},d(j){j&&g(e),v(l),v(a),v(f),I&&I.d(),v($),v(w),N&&N.d(),Ot(A,j)}}}function mp(r){let e,n,t,o,l,i,a,s,f,u,c;return e=new So({props:{colorInterventions:Ir("v1")}}),t=new Ye({props:{layer:"interventions-points",tooltip:r[8],clickable:!1}}),l=new Ye({props:{layer:"interventions-lines",tooltip:r[8],clickable:!1}}),a=new Ye({props:{layer:"interventions-polygons",tooltip:r[8],clickable:!1}}),u=new tp({}),{c(){h(e.$$.fragment),n=O(),h(t.$$.fragment),o=O(),h(l.$$.fragment),i=O(),h(a.$$.fragment),s=O(),f=M("div"),h(u.$$.fragment),Z(f,"class","top-right svelte-u44ed2")},m(p,$){b(e,p,$),d(p,n,$),b(t,p,$),d(p,o,$),b(l,p,$),d(p,i,$),b(a,p,$),d(p,s,$),d(p,f,$),b(u,f,null),c=!0},p:x,i(p){c||(m(e.$$.fragment,p),m(t.$$.fragment,p),m(l.$$.fragment,p),m(a.$$.fragment,p),m(u.$$.fragment,p),c=!0)},o(p){_(e.$$.fragment,p),_(t.$$.fragment,p),_(l.$$.fragment,p),_(a.$$.fragment,p),_(u.$$.fragment,p),c=!1},d(p){p&&(g(n),g(o),g(i),g(s),g(f)),v(e,p),v(t,p),v(l,p),v(a,p),v(u)}}}function $p(r){let e,n,t;return n=new vo({props:{style:r[4],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[mp]},$$scope:{ctx:r}}}),{c(){e=M("div"),h(n.$$.fragment),Z(e,"slot","main")},m(o,l){d(o,e,l),b(n,e,null),t=!0},p(o,l){const i={};l&16&&(i.style=o[4]),l&65536&&(i.$$scope={dirty:l,ctx:o}),n.$set(i)},i(o){t||(m(n.$$.fragment,o),t=!0)},o(o){_(n.$$.fragment,o),t=!1},d(o){o&&g(e),v(n)}}}function dp(r){let e,n;return e=new bo({props:{$$slots:{main:[$p],sidebar:[pp]},$$scope:{ctx:r}}}),{c(){h(e.$$.fragment)},m(t,o){b(e,t,o),n=!0},p(t,[o]){const l={};o&65599&&(l.$$scope={dirty:o,ctx:t}),e.$set(l)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function gp(r,e,n){let t,o;ee(r,hn,C=>n(4,t=C)),ee(r,at,C=>n(5,o=C));let l=new Set(up);$t(()=>{uo()});const i=new URLSearchParams(window.location.search);hn.set(i.get("style")||"dataviz");let a="",s=new Map,f=new Set,u="";mt(()=>{at.set(sn())});function c(C){try{let y=JSON.parse(C);n(1,s=ri(y)),at.set(y),n(0,a="")}catch(y){n(0,a=`The file you loaded is broken: ${y}`)}}function p(C){let y=C.properties;var P='<div style="max-width: 30vw;">';return P+=`<h2>${$(y.name)} (${y.intervention_type})</h2>`,P+=`<p>Scheme reference: ${y.scheme_reference}</p>`,y.length_meters&&(P+=`<p>Length: ${co(y.length_meters)}</p>`),y.description&&(P+=`<p>${$(y.description)}</p>`),P+="</div>",P}function $(C){return u?C.replace(new RegExp(u,"gi"),y=>`<mark>${y}</mark>`):C}function k(C){f=C,n(2,f)}function w(C){u=C,n(3,u)}return[a,s,f,u,t,o,l,c,p,k,w]}class _p extends U{constructor(e){super(),G(this,e,gp,dp,z,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new _p({target:document.getElementById("app")});
