import{S as M,i as C,s as F,N as b,C as H,aX as x,H as E,B as I,r as S,a5 as D}from"./index-c9c3e32e.js";function T(l,a,i){let t,f;b(l,H,e=>i(6,t=e)),b(l,x,e=>i(7,f=e));const k=E();let{layer:n}=a,{clickable:s}=a,{tooltip:u=null}=a,{show:y=!0}=a,{ignoreHigherLayers:h=[]}=a,{hoveredFeature:r=null}=a,c=new I.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});S(()=>{t.on("mousemove",n,L),t.on("mouseleave",n,g),s&&t.on("click",n,m)}),D(()=>{t.off("mousemove",n,L),t.off("mouseleave",n,g),s&&t.off("click",n,m),v(),c.remove()});function L(e){if(!f)return;let o=e.features??[];if(o.length!=0){if(o[0].id||console.log(`Features in the ${n} layer don't have IDs; InteractiveLayer won't work`),d(e)){g();return}if((r==null?void 0:r.id)!=o[0].id){if(v(),i(0,r=o[0]),t.setFeatureState(r,{hover:!0}),u){let w=`<div class="govuk-prose">${u(r)}</div>`;c.setLngLat(e.lngLat).setHTML(w).addTo(t)}s&&(t.getCanvas().style.cursor="pointer")}else u&&c.setLngLat(e.lngLat)}}function g(){f&&(v(),i(0,r=null),c.remove(),s&&(t.getCanvas().style.cursor="inherit"))}function v(){r&&t.setFeatureState(r,{hover:!1})}function m(e){if(!f)return;let o=e.features??[];if(o.length>0){if(d(e))return;k("click",o[0])}}function d(e){for(let o of t.queryRenderedFeatures(e.point)){if(o.layer.id==n)return!1;if(!h.includes(o.layer.id))return!0}return!1}return l.$$set=e=>{"layer"in e&&i(1,n=e.layer),"clickable"in e&&i(2,s=e.clickable),"tooltip"in e&&i(3,u=e.tooltip),"show"in e&&i(4,y=e.show),"ignoreHigherLayers"in e&&i(5,h=e.ignoreHigherLayers),"hoveredFeature"in e&&i(0,r=e.hoveredFeature)},l.$$.update=()=>{l.$$.dirty&82&&t.getLayer(n)&&t.setLayoutProperty(n,"visibility",y?"visible":"none")},[r,n,s,u,y,h,t]}class q extends M{constructor(a){super(),C(this,a,T,null,F,{layer:1,clickable:2,tooltip:3,show:4,ignoreHigherLayers:5,hoveredFeature:0})}}export{q as I};
