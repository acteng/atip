import{S as K,i as q,s as Z,e as D,u as v,d as O,g as _,j as m,k as T,m as w,t as d,n as g,p as h,q as b,f as nr,x as Q,aq as Un,b as H,c as z,l as V,Q as X,C as re,ar as rn,W as mt,r as Mt,F as nn,a as Kt,h as G,v as pr,w as or,I as Le,aT as ae,$ as ge,G as ue,aS as B,J as ze,N as Fe,K as Et,y as le,o as fe,V as Ge,aU as Ve,U as sr,aV as Hn,a1 as on,a0 as ht,E as sn,a5 as xt,aK as Wn,aL as zn,aM as Vn,aN as Gn,R as an,aW as $r,D as Kn,aX as mr,a8 as ln,aR as hr,L as qn,z as Zn,aH as Xn}from"./index-a45a4fa1.js";import{H as ne,L as Yn,d as dr,c as fn,C as _e,Z as Jn,I as Qn}from"./schemas-360c9570.js";import{e as Pt,C as xe,b as St,d as te,a as eo,S as to,B as ro,L as no,M as oo}from"./StreetViewController-baa334c9.js";import{I as J,F as so}from"./InteractiveLayer-e5674875.js";function io(t){let e;return{c(){e=D("p"),e.textContent=`The scheme data shown is fake. Load the real data from a file below.
        We're working to put real scheme data here.`},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ao(t){let e,r,n,o,s=t[0]=="Private (development)"&&io();return{c(){s&&s.c(),e=O(),r=D("p"),r.textContent="Note the ATF scheme data has not been validated.",n=O(),o=D("p"),o.innerHTML=`Please contact <a href="mailto:dcarlino@turing.ac.uk">Dustin</a>
      and
      <a href="mailto:Peter.York@activetravelengland.gov.uk">Pete</a>
      about any problems, ideas, or feedback for this site.`},m(a,u){s&&s.m(a,u),m(a,e,u),m(a,r,u),m(a,n,u),m(a,o,u)},p:Q,d(a){a&&(h(e),h(r),h(n),h(o)),s&&s.d(a)}}}function lo(t){let e,r,n,o,s,a;return s=new ne({props:{$$slots:{default:[ao]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("App version: "),n=v(t[0]),o=O(),_(s.$$.fragment)},m(u,i){m(u,e,i),T(e,r),T(e,n),T(e,o),w(s,e,null),a=!0},p(u,[i]){const f={};i&2&&(f.$$scope={dirty:i,ctx:u}),s.$set(f)},i(u){a||(d(s.$$.fragment,u),a=!0)},o(u){g(s.$$.fragment,u),a=!1},d(u){u&&h(e),b(s)}}}function fo(t){return[nr()]}class uo extends K{constructor(e){super(),q(this,e,fo,lo,Z,{})}}const co={createDocument:function(e){return new DOMParser().parseFromString(e.trim(),"text/xml")}};var me=Uint8Array,rt=Uint16Array,un=Uint32Array,cn=new me([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),pn=new me([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),po=new me([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$n=function(t,e){for(var r=new rt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new un(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},mn=$n(cn,2),hn=mn[0],$o=mn[1];hn[28]=258,$o[258]=28;var mo=$n(pn,0),ho=mo[0],qt=new rt(32768);for(var Y=0;Y<32768;++Y){var je=(Y&43690)>>>1|(Y&21845)<<1;je=(je&52428)>>>2|(je&13107)<<2,je=(je&61680)>>>4|(je&3855)<<4,qt[Y]=((je&65280)>>>8|(je&255)<<8)>>>1}var bt=function(t,e,r){for(var n=t.length,o=0,s=new rt(e);o<n;++o)t[o]&&++s[t[o]-1];var a=new rt(e);for(o=0;o<e;++o)a[o]=a[o-1]+s[o-1]<<1;var u;if(r){u=new rt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],l=e-t[o],c=a[t[o]-1]++<<l,p=c|(1<<l)-1;c<=p;++c)u[qt[c]>>>i]=f}else for(u=new rt(n),o=0;o<n;++o)t[o]&&(u[o]=qt[a[t[o]-1]++]>>>15-t[o]);return u},Ct=new me(288);for(var Y=0;Y<144;++Y)Ct[Y]=8;for(var Y=144;Y<256;++Y)Ct[Y]=9;for(var Y=256;Y<280;++Y)Ct[Y]=7;for(var Y=280;Y<288;++Y)Ct[Y]=8;var dn=new me(32);for(var Y=0;Y<32;++Y)dn[Y]=5;var go=bt(Ct,9,1),_o=bt(dn,5,1),Bt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},jt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},wo=function(t){return(t+7)/8|0},ir=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t.BYTES_PER_ELEMENT==2?rt:t.BYTES_PER_ELEMENT==4?un:me)(r-e);return n.set(t.subarray(e,r)),n},bo=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Se=function(t,e,r){var n=new Error(e||bo[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Se),!r)throw n;return n},vo=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new me(0);var o=!e||r,s=!r||r.i;r||(r={}),e||(e=new me(n*3));var a=function(lt){var ft=e.length;if(lt>ft){var gt=new me(Math.max(ft*2,lt));gt.set(e),e=gt}},u=r.f||0,i=r.p||0,f=r.b||0,l=r.l,c=r.d,p=r.m,$=r.n,y=n*8;do{if(!l){u=ve(t,i,1);var k=ve(t,i+1,3);if(i+=3,k)if(k==1)l=go,c=_o,p=9,$=5;else if(k==2){var x=ve(t,i,31)+257,C=ve(t,i+10,15)+4,A=x+ve(t,i+5,31)+1;i+=14;for(var F=new me(A),M=new me(19),P=0;P<C;++P)M[po[P]]=ve(t,i+P*3,7);i+=C*3;for(var N=Bt(M),I=(1<<N)-1,j=bt(M,N,1),P=0;P<A;){var ee=j[ve(t,i,I)];i+=ee&15;var S=ee>>>4;if(S<16)F[P++]=S;else{var R=0,ce=0;for(S==16?(ce=3+ve(t,i,3),i+=2,R=F[P-1]):S==17?(ce=3+ve(t,i,7),i+=3):S==18&&(ce=11+ve(t,i,127),i+=7);ce--;)F[P++]=R}}var we=F.subarray(0,x),oe=F.subarray(x);p=Bt(we),$=Bt(oe),l=bt(we,p,1),c=bt(oe,$,1)}else Se(1);else{var S=wo(i)+4,L=t[S-4]|t[S-3]<<8,E=S+L;if(E>n){s&&Se(0);break}o&&a(f+L),e.set(t.subarray(S,E),f),r.b=f+=L,r.p=i=E*8,r.f=u;continue}if(i>y){s&&Se(0);break}}o&&a(f+131072);for(var qe=(1<<p)-1,pe=(1<<$)-1,dt=i;;dt=i){var R=l[jt(t,i)&qe],Be=R>>>4;if(i+=R&15,i>y){s&&Se(0);break}if(R||Se(2),Be<256)e[f++]=Be;else if(Be==256){dt=i,l=null;break}else{var st=Be-254;if(Be>264){var P=Be-257,be=cn[P];st=ve(t,i,(1<<be)-1)+hn[P],i+=be}var it=c[jt(t,i)&pe],Ie=it>>>4;it||Se(3),i+=it&15;var oe=ho[Ie];if(Ie>3){var be=pn[Ie];oe+=jt(t,i)&(1<<be)-1,i+=be}if(i>y){s&&Se(0);break}o&&a(f+131072);for(var at=f+st;f<at;f+=4)e[f]=e[f-oe],e[f+1]=e[f+1-oe],e[f+2]=e[f+2-oe],e[f+3]=e[f+3-oe];f=at}}r.l=l,r.p=dt,r.b=f,r.f=u,l&&(u=1,r.m=p,r.d=c,r.n=$)}while(!u);return f==e.length?e:ir(e,0,f)},yo=new me(0),Pe=function(t,e){return t[e]|t[e+1]<<8},Ce=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Rt=function(t,e){return Ce(t,e)+Ce(t,e+4)*4294967296};function ko(t,e){return vo(t,e)}var Zt=typeof TextDecoder<"u"&&new TextDecoder,So=0;try{Zt.decode(yo,{stream:!0}),So=1}catch{}var Co=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,ir(t,r-1)];o?o==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function gn(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(Zt)return Zt.decode(t);var o=Co(t),s=o[0],a=o[1];return a.length&&Se(8),s}}var Lo=function(t,e){return e+30+Pe(t,e+26)+Pe(t,e+28)},Oo=function(t,e,r){var n=Pe(t,e+28),o=gn(t.subarray(e+46,e+46+n),!(Pe(t,e+8)&2048)),s=e+46+n,a=Ce(t,e+20),u=r&&a==4294967295?To(t,s):[a,Ce(t,e+24),Ce(t,e+42)],i=u[0],f=u[1],l=u[2];return[Pe(t,e+10),i,f,o,s+Pe(t,e+30)+Pe(t,e+32),l]},To=function(t,e){for(;Pe(t,e)!=1;e+=4+Pe(t,e+2));return[Rt(t,e+12),Rt(t,e+4),Rt(t,e+20)]};function Ao(t,e){for(var r={},n=t.length-22;Ce(t,n)!=101010256;--n)(!n||t.length-n>65558)&&Se(13);var o=Pe(t,n+8);if(!o)return{};var s=Ce(t,n+16),a=s==4294967295||o==65535;if(a){var u=Ce(t,n-12);a=Ce(t,u)==101075792,a&&(o=Ce(t,u+32),s=Ce(t,u+48))}for(var i=e&&e.filter,f=0;f<o;++f){var l=Oo(t,s,a),c=l[0],p=l[1],$=l[2],y=l[3],k=l[4],S=l[5],L=Lo(t,S);s=k,(!i||i({name:y,size:p,originalSize:$,compression:c}))&&(c?c==8?r[y]=ko(t.subarray(L,L+p),new me($)):Se(14,"unknown compression type "+c):r[y]=ir(t,L,L+p))}return r}function Do(t){return t instanceof File||t instanceof Blob?t.arrayBuffer().then(Ut):Ut(t)}function Ut(t){var e=new Uint8Array(t),r=Ao(e);return Promise.resolve(Eo(r))}function Eo(t){for(var e=[],r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];e[o]=gn(t[o])}return e}function Ne(t,e){for(var r=0;r<t.childNodes.length;){var n=t.childNodes[r];if(n.nodeType===1&&ot(n)===e)return n;r++}}function Lt(t,e){for(var r=[],n=0;n<t.childNodes.length;){var o=t.childNodes[n];o.nodeType===1&&ot(o)===e&&r.push(o),n++}return r}function Nt(t,e,r){for(var n=0;n<t.childNodes.length;){var o=t.childNodes[n];e?o.nodeType===1&&ot(o)===e&&r(o,n):r(o,n),n++}}function Po(t,e,r){var n=[];return Nt(t,e,function(o,s){n.push(r(o,s))}),n}var No=/.+\:/;function ot(t){return t.tagName.replace(No,"")}function _n(t){if(t.nodeType!==1)return t.textContent;for(var e="<"+ot(t),r=0;r<t.attributes.length;)e+=" "+t.attributes[r].name+'="'+t.attributes[r].value+'"',r++;e+=">";for(var n=0;n<t.childNodes.length;)e+=_n(t.childNodes[n]),n++;return e+="</"+ot(t)+">",e}function Io(t){var e=t.documentElement,r=Ne(e,"sheetData"),n=[];return Nt(r,"row",function(o){Nt(o,"c",function(s){n.push(s)})}),n}function Mo(t,e){return Ne(e,"v")}function xo(t,e){if(e.firstChild&&ot(e.firstChild)==="is"&&e.firstChild.firstChild&&ot(e.firstChild.firstChild)==="t")return e.firstChild.firstChild.textContent}function Fo(t){var e=t.documentElement,r=Ne(e,"dimension");if(r)return r.getAttribute("ref")}function Bo(t){var e=t.documentElement,r=Ne(e,"cellStyleXfs");return r?Lt(r,"xf"):[]}function jo(t){var e=t.documentElement,r=Ne(e,"cellXfs");return r?Lt(r,"xf"):[]}function Ro(t){var e=t.documentElement,r=Ne(e,"numFmts");return r?Lt(r,"numFmt"):[]}function Uo(t){var e=t.documentElement;return Po(e,"si",function(r){var n=Ne(r,"t");if(n)return n.textContent;var o="";return Nt(r,"r",function(s){o+=Ne(s,"t").textContent}),o})}function Ho(t){var e=t.documentElement;return Ne(e,"workbookPr")}function Wo(t){var e=t.documentElement;return Lt(e,"Relationship")}function zo(t){var e=t.documentElement,r=Ne(e,"sheets");return Lt(r,"sheet")}function Vo(t,e){var r=e.createDocument(t),n={},o=Ho(r);o&&o.getAttribute("date1904")==="1"&&(n.epoch1904=!0),n.sheets=[];var s=function(u){u.getAttribute("name")&&n.sheets.push({id:u.getAttribute("sheetId"),name:u.getAttribute("name"),relationId:u.getAttribute("r:id")})};return zo(r).forEach(s),n}function Go(t,e){var r=e.createDocument(t),n={sheets:{},sharedStrings:void 0,styles:void 0},o=function(a){var u=a.getAttribute("Target"),i=a.getAttribute("Type");switch(i){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":n.styles=Ht(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings":n.sharedStrings=Ht(u);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet":n.sheets[a.getAttribute("Id")]=Ht(u);break}};return Wo(r).forEach(o),n}function Ht(t){return t[0]==="/"?t.slice(1):"xl/"+t}function gr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function _r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gr(Object(r),!0).forEach(function(n){Ko(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ko(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qo(t,e){if(!t)return{};var r=e.createDocument(t),n=Bo(r).map(Wt),o=Ro(r).map(Zo).reduce(function(a,u){return a[u.id]=u,a},[]),s=function(u){return u.hasAttribute("xfId")?_r(_r({},n[u.xfId]),Wt(u,o)):Wt(u,o)};return jo(r).map(s)}function Zo(t){return{id:t.getAttribute("numFmtId"),template:t.getAttribute("formatCode")}}function Wt(t,e){var r={};if(t.hasAttribute("numFmtId")){var n=t.getAttribute("numFmtId");e[n]?r.numberFormat=e[n]:r.numberFormat={id:n}}return r}function Xo(t,e){return t?Uo(e.createDocument(t)):[]}function wn(t,e){e&&e.epoch1904&&(t+=1462);var r=70*365+19,n=60*60*1e3;return new Date(Math.round((t-r)*24*n))}function Yo(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Jo(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jo(t,e){if(t){if(typeof t=="string")return wr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(t,e)}}function wr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Qo(t,e,r,n){if(e){var o=r[e];if(!o)throw new Error("Cell style not found: ".concat(e));if(!o.numberFormat)return!1;if(es.indexOf(Number(o.numberFormat.id))>=0||n.dateFormat&&o.numberFormat.template===n.dateFormat||n.smartDateParser!==!1&&o.numberFormat.template&&ns(o.numberFormat.template))return!0}}var es=[14,15,16,17,18,19,20,21,22,27,30,36,45,46,47,50,57],ts=/^\[\$-414\]/,rs=/;@$/;function ns(t){t=t.toLowerCase(),t=t.replace(ts,""),t=t.replace(rs,"");for(var e=t.split(/\W+/),r=Yo(e),n;!(n=r()).done;){var o=n.value;if(os.indexOf(o)<0)return!1}return!0}var os=["ss","mm","h","hh","am","pm","d","dd","m","mm","mmm","mmmm","yy","yyyy","e"];function ss(t,e,r){var n=r.getInlineStringValue,o=r.getInlineStringXml,s=r.getStyleId,a=r.styles,u=r.values,i=r.properties,f=r.options;switch(e||(e="n"),e){case"str":t=zt(t,f);break;case"inlineStr":if(t=n(),t===void 0)throw new Error('Unsupported "inline string" cell value structure: '.concat(o()));t=zt(t,f);break;case"s":var l=Number(t);if(isNaN(l))throw new Error('Invalid "shared" string index: '.concat(t));if(l>=u.length)throw new Error('An out-of-bounds "shared" string index: '.concat(t));t=u[l],t=zt(t,f);break;case"b":if(t==="1")t=!0;else if(t==="0")t=!1;else throw new Error('Unsupported "boolean" cell value: '.concat(t));break;case"z":t=void 0;break;case"e":t=is(t);break;case"d":if(t===void 0)break;var c=new Date(t);if(isNaN(c.valueOf()))throw new Error('Unsupported "date" cell value: '.concat(t));t=c;break;case"n":if(t===void 0)break;var p=Number(t);if(isNaN(p))throw new Error('Invalid "numeric" cell value: '.concat(t));t=p,Qo(t,s(),a,f)&&(t=wn(t,i));break;default:throw new TypeError("Cell type not supported: ".concat(e))}return t===void 0&&(t=null),t}function is(t){switch(t){case 0:return"#NULL!";case 7:return"#DIV/0!";case 15:return"#VALUE!";case 23:return"#REF!";case 29:return"#NAME?";case 36:return"#NUM!";case 42:return"#N/A";case 43:return"#GETTING_DATA";default:return"#ERROR_".concat(t)}}function zt(t,e){return e.trim!==!1&&(t=t.trim()),t===""&&(t=void 0),t}var as=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function ls(t){var e=function(f,l){return f-l},r=t.map(function(i){return i.row}).sort(e),n=t.map(function(i){return i.column}).sort(e),o=r[0],s=r[r.length-1],a=n[0],u=n[n.length-1];return[{row:o,column:a},{row:s,column:u}]}function fs(t){for(var e=0,r=0;r<t.length;)e*=26,e+=as.indexOf(t[r]),r++;return e}function bn(t){return t=t.split(/(\d+)/),[parseInt(t[1]),fs(t[0].trim())]}function us(t,e,r,n,o,s,a){var u=bn(t.getAttribute("r")),i=Mo(e,t),f=i&&i.textContent,l;return t.hasAttribute("t")&&(l=t.getAttribute("t")),{row:u[0],column:u[1],value:ss(f,l,{getInlineStringValue:function(){return xo(e,t)},getInlineStringXml:function(){return _n(t)},getStyleId:function(){return t.getAttribute("s")},styles:o,values:n,properties:s,options:a})}}function cs(t,e,r,n,o,s){var a=Io(t);return a.length===0?[]:a.map(function(u){return us(u,t,e,r,n,o,s)})}function ps(t,e){return ds(t)||hs(t,e)||ms(t,e)||$s()}function $s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ms(t,e){if(t){if(typeof t=="string")return br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return br(t,e)}}function br(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hs(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,u;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function ds(t){if(Array.isArray(t))return t}function gs(t){var e=Fo(t);if(e)return e=e.split(":").map(bn).map(function(r){var n=ps(r,2),o=n[0],s=n[1];return{row:o,column:s}}),e.length===1&&(e=[e[0],e[0]]),e}function _s(t,e,r,n,o,s){var a=e.createDocument(t),u=cs(a,e,r,n,o,s),i=gs(a)||ls(u);return{cells:u,dimensions:i}}function ws(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=bs(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bs(t,e){if(t){if(typeof t=="string")return vr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vr(t,e)}}function vr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vs(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.rowMap,n=e.accessor,o=n===void 0?function(c){return c}:n,s=e.onlyTrimAtTheEnd,a=t.length-1;a>=0;){for(var u=!0,i=ws(t[a]),f;!(f=i()).done;){var l=f.value;if(o(l)!==null){u=!1;break}}if(u)t.splice(a,1),r&&r.splice(a,1);else if(s)break;a--}return t}function ys(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ks(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ks(t,e){if(t){if(typeof t=="string")return yr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(t,e)}}function yr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ss(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.accessor,n=r===void 0?function(c){return c}:r,o=e.onlyTrimAtTheEnd,s=t[0].length-1;s>=0;){for(var a=!0,u=ys(t),i;!(i=u()).done;){var f=i.value;if(n(f[s])!==null){a=!1;break}}if(a)for(var l=0;l<t.length;)t[l].splice(s,1),l++;else if(o)break;s--}return t}function Cs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=vn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ls(t,e){return As(t)||Ts(t,e)||vn(t,e)||Os()}function Os(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vn(t,e){if(t){if(typeof t=="string")return kr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kr(t,e)}}function kr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ts(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,u;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function As(t){if(Array.isArray(t))return t}function Ds(t,e){var r=t.dimensions,n=t.cells;if(n.length===0)return[];var o=Ls(r,2);o[0];for(var s=o[1],a=s.column,u=s.row,i=new Array(u),f=0;f<u;){i[f]=new Array(a);for(var l=0;l<a;)i[f][l]=null,l++;f++}for(var c=Cs(n),p;!(p=c()).done;){var $=p.value,y=$.row-1,k=$.column-1;k<a&&y<u&&(i[y][k]=$.value)}var S=e.rowMap;if(S)for(var L=0;L<i.length;)S[L]=L,L++;return i=vs(Ss(i,{onlyTrimAtTheEnd:!0}),{onlyTrimAtTheEnd:!0,rowMap:S}),e.transformData&&(i=e.transformData(i)),i}function Es(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Ps(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ps(t,e){if(t){if(typeof t=="string")return Sr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sr(t,e)}}function Sr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Cr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Ns(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cr(Object(r),!0).forEach(function(n){Is(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Is(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ms(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};r.sheet||(r=Ns({sheet:1},r));var n=function(p){if(!t[p])throw new Error('"'.concat(p,'" file not found inside the *.xlsx file zip archive'));return t[p]},o=Go(n("xl/_rels/workbook.xml.rels"),e),s=o.sharedStrings?Xo(n(o.sharedStrings),e):[],a=o.styles?qo(n(o.styles),e):{},u=Vo(n("xl/workbook.xml"),e);if(r.getSheets)return u.sheets.map(function(c){var p=c.name;return{name:p}});var i=xs(r.sheet,u.sheets);if(!i||!o.sheets[i])throw Fs(r.sheet,u.sheets);var f=_s(n(o.sheets[i]),e,s,a,u,r),l=Ds(f,r);return r.properties?{data:l,properties:u}:l}function xs(t,e){if(typeof t=="number"){var r=e[t-1];return r&&r.relationId}for(var n=Es(e),o;!(o=n()).done;){var s=o.value;if(s.name===t)return s.relationId}}function Fs(t,e){var r=e&&e.map(function(n,o){return'"'.concat(n.name,'" (#').concat(o+1,")")}).join(", ");return new Error("Sheet ".concat(typeof t=="number"?"#"+t:'"'+t+'"'," not found in the *.xlsx file.").concat(e?" Available sheets: "+r+".":""))}function Xt(t){"@babel/helpers - typeof";return Xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xt(t)}function Lr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bs(t,e,r){return e&&Lr(t.prototype,e),r&&Lr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function js(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yt(t,e)}function Us(t){var e=yn();return function(){var n=kt(t),o;if(e){var s=kt(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Hs(this,o)}}function Hs(t,e){if(e&&(Xt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ws(t)}function Ws(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yt(t){var e=typeof Map=="function"?new Map:void 0;return Yt=function(n){if(n===null||!zs(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,o)}function o(){return At(n,arguments,kt(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),yt(o,n)},Yt(t)}function At(t,e,r){return yn()?At=Reflect.construct:At=function(o,s,a){var u=[null];u.push.apply(u,s);var i=Function.bind.apply(o,u),f=new i;return a&&yt(f,a.prototype),f},At.apply(null,arguments)}function yn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zs(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function yt(t,e){return yt=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},yt(t,e)}function kt(t){return kt=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},kt(t)}var he=function(t){Rs(r,t);var e=Us(r);function r(n){var o;return js(this,r),o=e.call(this,"invalid"),o.reason=n,o}return Bs(r)}(Yt(Error));function Vs(t){if(typeof t=="string"){var e=t;if(t=Number(t),String(t)!==e)throw new he("not_a_number")}if(typeof t!="number")throw new he("not_a_number");if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return t}function Gs(t){if(typeof t=="string")return t;if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");return String(t)}throw new he("not_a_string")}function Ks(t){if(typeof t=="boolean")return t;throw new he("not_a_boolean")}function qs(t,e){var r=e.properties;if(t instanceof Date){if(isNaN(t.valueOf()))throw new he("out_of_bounds");return t}if(typeof t=="number"){if(isNaN(t))throw new he("invalid_number");if(!isFinite(t))throw new he("out_of_bounds");var n=wn(t,r);if(isNaN(n.valueOf()))throw new he("out_of_bounds");return n}throw new he("not_a_date")}function Zs(t,e){return Js(t)||Ys(t,e)||kn(t,e)||Xs()}function Xs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ys(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],o=!0,s=!1,a,u;try{for(r=r.call(t);!(o=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));o=!0);}catch(i){s=!0,u=i}finally{try{!o&&r.return!=null&&r.return()}finally{if(s)throw u}}return n}}function Js(t){if(Array.isArray(t))return t}function Jt(t){"@babel/helpers - typeof";return Jt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jt(t)}function Qs(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=kn(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kn(t,e){if(t){if(typeof t=="string")return Or(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Or(t,e)}}function Or(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Tr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Ar(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tr(Object(r),!0).forEach(function(n){ei(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ei(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Dr={isColumnOriented:!1};function ti(t,e,r){r?r=Ar(Ar({},Dr),r):r=Dr;var n=r,o=n.isColumnOriented,s=n.rowMap,a=n.ignoreEmptyRows;si(e),o&&(t=oi(t));for(var u=t[0],i=[],f=[],l=1;l<t.length;l++){var c=Sn(e,t[l],l,u,f,r);(c!==null||a===!1)&&i.push(c)}if(s)for(var p=Qs(f),$;!($=p()).done;){var y=$.value;y.row=s[y.row-1]+1}return{rows:i,errors:f}}function Sn(t,e,r,n,o,s){for(var a={},u=!0,i=function(){var p=l[f],$=t[p],y=Jt($.type)==="object"&&!Array.isArray($.type),k=e[n.indexOf(p)];k===void 0&&(k=null);var S=void 0,L=void 0,E=void 0;if(y)S=Sn($.type,e,r,n,o,s);else if(k===null)S=null;else if(Array.isArray($.type)){var x=!1,C=ni(k).map(function(F){var M=Er(F,$,s);return M.error&&(S=F,L=M.error,E=M.reason),M.value!==null&&(x=!0),M.value});L||(S=x?C:null)}else{var A=Er(k,$,s);L=A.error,E=A.reason,S=L?k:A.value}!L&&S===null&&$.required&&(L="required"),L?(L={error:L,row:r+1,column:p,value:S},E&&(L.reason=E),$.type&&(L.type=$.type),o.push(L)):(u&&S!==null&&(u=!1),(S!==null||s.includeNullValues)&&(a[$.prop]=S))},f=0,l=Object.keys(t);f<l.length;f++)i();return u?null:a}function Er(t,e,r){if(t===null)return{value:null};var n;if(e.parse?n=ct(t,e.parse):e.type?n=ri(t,Array.isArray(e.type)?e.type[0]:e.type,r):n={value:t},n.error)return n;if(n.value!==null){if(e.oneOf&&e.oneOf.indexOf(n.value)<0)return{error:"invalid",reason:"unknown"};if(e.validate)try{e.validate(n.value)}catch(o){return{error:o.message}}}return n}function ct(t,e){try{return t=e(t),t===void 0?{value:null}:{value:t}}catch(n){var r={error:n.message};return n.reason&&(r.reason=n.reason),r}}function ri(t,e,r){switch(e){case String:return ct(t,Gs);case Number:return ct(t,Vs);case Date:return ct(t,function(n){return qs(n,{properties:r.properties})});case Boolean:return ct(t,Ks);default:if(typeof e=="function")return ct(t,e);throw new Error("Unsupported schema type: ".concat(e&&e.name||e))}}function Cn(t,e,r){for(var n=0,o="";r+n<t.length;){var s=t[r+n];if(s===e)return[o,n];if(s==='"'){var a=Cn(t,'"',r+n+1);o+=a[0],n+=1+a[1]+1}else o+=s,n++}return[o,n]}function ni(t){for(var e=[],r=0;r<t.length;){var n=Cn(t,",",r),o=Zs(n,2),s=o[0],a=o[1];r+=a+1,e.push(s.trim())}return e}var oi=function(e){return e[0].map(function(r,n){return e.map(function(o){return o[n]})})};function si(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e],o=t[n];if(!o.prop)throw new Error('"prop" not defined for schema entry "'.concat(n,'".'))}}function Qt(t){"@babel/helpers - typeof";return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qt(t)}function Ln(t){for(var e={},r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],s=t[o],a=void 0;Qt(s)==="object"&&(s=Object.keys(t[o])[0],a=Ln(t[o][s])),e[o]={prop:s},a&&(e[o].type=a)}return e}var ii=["schema","map"];function Pr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Tt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pr(Object(r),!0).forEach(function(n){ai(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ai(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function li(t,e){if(t==null)return{};var r=fi(t,e),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)n=s[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function fi(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,s;for(s=0;s<n.length;s++)o=n[s],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function ui(t,e,r){var n=r.schema,o=r.map,s=li(r,ii);!n&&o&&(n=Ln(o));var a=Ms(t,e,Tt(Tt({},s),{},{properties:n||s.properties}));return n?ti(a.data,n,Tt(Tt({},s),{},{properties:a.properties})):a}function ci(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Do(t).then(function(r){return ui(r,co,e)})}function pi(t){let e=new Map;for(let[n,o]of Object.entries(t.schemes))e.set(n,{scheme_reference:n,num_features:0,authority_or_region:o.authority_or_region,capital_scheme_id:o.capital_scheme_id,funding_programme:o.funding_programme});let r=1;for(let n of t.features){let o=e.get(n.properties.scheme_reference);o.num_features++,n.properties.funding_programme=o.funding_programme,n.id=r++}return e}async function $i(t){let e={ID:"id",Inspector:"inspector","Submission Time":"submission_time","Please enter the Scheme Reference number, (e.g. ATF2_WYO_01)":"scheme_reference","Please enter current Design Stage":"current_design_stage","Select Critical Issue type below:":"critical_type","Please Enter Latitude and Longitude \n(Right click on location in Google, left click on information to copy to clipboard, paste below)":"lat_lon",Column1:"location_description","Enter any additional information (e.g. any comments or notes about this critical issue)":"notes"},{rows:r}=await ci(t,{map:e,sheet:"Form Input"}),n={type:"FeatureCollection",features:[]};for(let o of r){let s=Un(o.lat_lon.split(",").map(parseFloat).reverse()),a=o;a.submission_time=o.submission_time.toLocaleString(),n.features.push({type:"Feature",properties:a,geometry:{type:"Point",coordinates:s},id:n.features.length+1})}return n}const U={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",sports_spaces:"#013220",railway_stations:"#A52A2A",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",local_planning_authorities:"red",bus_route_with_lane:"#9362BA",bus_route_without_lane:"#C2A6D8",cycle_parking:"black",crossings:"green",cycle_paths:{track:"#0000FF",lane:"#009FEF",shared_use_segregated:"#FF9900",shared_use_unsegregated:"#E7E700"},sequential_low_to_high:["#CDE594","#80C6A3","#1F9EB7","#186290","#080C54"],atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"},Ft=["interpolate",["exponential",1.6],["zoom"],3,1,7,2,18,20];function mi(t){let e,r,n,o,s;function a(i){t[3](i)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return t[0]!==void 0&&(u.value=t[0]),e=new Pt({props:u}),H.push(()=>z(e,"value",a)),e.$on("change",t[2]),o=new Yn({props:{rows:t[1]}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};!r&&f&1&&(r=!0,l.value=i[0],V(()=>r=!1)),e.$set(l);const c={};f&2&&(c.rows=i[1]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function hi(t,e,r){let n;X(t,re,i=>r(4,n=i));let o="interventionType",s=dr("v1");function a(){let i;o=="interventionType"?(i=fn("v1"),r(1,s=dr("v1"))):(i=rn(["get","funding_programme"],{ATF2:U.atf2,ATF3:U.atf3,ATF4:U.atf4},"grey"),r(1,s=[["ATF2",U.atf2],["ATF3",U.atf3],["ATF4",U.atf4]])),n.setPaintProperty("interventions-points","circle-color",i),n.setPaintProperty("interventions-lines","line-color",i),n.setPaintProperty("interventions-polygons","fill-color",i),n.setPaintProperty("interventions-polygon-outlines","line-color",i)}function u(i){o=i,r(0,o)}return[o,s,a,u]}class di extends K{constructor(e){super(),q(this,e,hi,mi,Z,{})}}function gi(t){let e;return{c(){e=v("Clear")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _i(t){let e,r,n,o,s,a;return n=new Kt({props:{$$slots:{default:[gi]},$$scope:{ctx:t}}}),n.$on("click",t[13]),{c(){e=D("input"),r=O(),_(n.$$.fragment),G(e,"type","text"),G(e,"class","govuk-input govuk-input--width-10"),G(e,"id","filterText")},m(u,i){m(u,e,i),pr(e,t[0]),m(u,r,i),w(n,u,i),o=!0,s||(a=or(e,"input",t[12]),s=!0)},p(u,i){i&1&&e.value!==u[0]&&pr(e,u[0]);const f={};i&131072&&(f.$$scope={dirty:i,ctx:u}),n.$set(f)},i(u){o||(d(n.$$.fragment,u),o=!0)},o(u){g(n.$$.fragment,u),o=!1},d(u){u&&(h(e),h(r)),b(n,u),s=!1,a()}}}function wi(t){let e,r,n,o,s,a,u,i,f,l;function c(k){t[10](k)}let p={label:"Authority or region",id:"filterAuthority",choices:t[5],emptyOption:!0};t[2]!==void 0&&(p.value=t[2]),e=new Pt({props:p}),H.push(()=>z(e,"value",c));function $(k){t[11](k)}let y={label:"Funding programme",id:"filterFundingProgramme",choices:t[6],emptyOption:!0};return t[3]!==void 0&&(y.value=t[3]),o=new Pt({props:y}),H.push(()=>z(o,"value",$)),u=new nn({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[_i]},$$scope:{ctx:t}}}),f=new di({}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment),a=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(k,S){w(e,k,S),m(k,n,S),w(o,k,S),m(k,a,S),w(u,k,S),m(k,i,S),w(f,k,S),l=!0},p(k,S){const L={};S&32&&(L.choices=k[5]),!r&&S&4&&(r=!0,L.value=k[2],V(()=>r=!1)),e.$set(L);const E={};S&64&&(E.choices=k[6]),!s&&S&8&&(s=!0,E.value=k[3],V(()=>s=!1)),o.$set(E);const x={};S&131073&&(x.$$scope={dirty:S,ctx:k}),u.$set(x)},i(k){l||(d(e.$$.fragment,k),d(o.$$.fragment,k),d(u.$$.fragment,k),d(f.$$.fragment,k),l=!0)},o(k){g(e.$$.fragment,k),g(o.$$.fragment,k),g(u.$$.fragment,k),g(f.$$.fragment,k),l=!1},d(k){k&&(h(n),h(a),h(i)),b(e,k),b(o,k),b(u,k),b(f,k)}}}function bi(t){let e,r=t[1].size.toLocaleString()+"",n,o,s=t[7].route.toLocaleString()+"",a,u,i=t[7].area.toLocaleString()+"",f,l,c=t[7].crossing.toLocaleString()+"",p,$,y=t[7].other.toLocaleString()+"",k,S;return{c(){e=v("Showing "),n=v(r),o=v(" schemes ("),a=v(s),u=v(`
    routes, `),f=v(i),l=v(` areas,
    `),p=v(c),$=v(" crossings, "),k=v(y),S=v(`
    other)`)},m(L,E){m(L,e,E),m(L,n,E),m(L,o,E),m(L,a,E),m(L,u,E),m(L,f,E),m(L,l,E),m(L,p,E),m(L,$,E),m(L,k,E),m(L,S,E)},p(L,E){E&2&&r!==(r=L[1].size.toLocaleString()+"")&&Le(n,r),E&128&&s!==(s=L[7].route.toLocaleString()+"")&&Le(a,s),E&128&&i!==(i=L[7].area.toLocaleString()+"")&&Le(f,i),E&128&&c!==(c=L[7].crossing.toLocaleString()+"")&&Le(p,c),E&128&&y!==(y=L[7].other.toLocaleString()+"")&&Le(k,y)},d(L){L&&(h(e),h(n),h(o),h(a),h(u),h(f),h(l),h(p),h($),h(k),h(S))}}}function vi(t){let e,r,n;function o(a){t[14](a)}let s={id:"show-schemes",$$slots:{default:[bi]},$$scope:{ctx:t}};return t[4]!==void 0&&(s.checked=t[4]),e=new te({props:s}),H.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(a,u){w(e,a,u),n=!0},p(a,u){const i={};u&131202&&(i.$$scope={dirty:u,ctx:a}),!r&&u&16&&(r=!0,i.checked=a[4],V(()=>r=!1)),e.$set(i)},i(a){n||(d(e.$$.fragment,a),n=!0)},o(a){g(e.$$.fragment,a),n=!1},d(a){b(e,a)}}}function yi(t){let e,r,n,o;return e=new xe({props:{label:"Filters",$$slots:{default:[wi]},$$scope:{ctx:t}}}),n=new St({props:{small:!0,$$slots:{default:[vi]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},p(s,[a]){const u={};a&131181&&(u.$$scope={dirty:a,ctx:s}),e.$set(u);const i={};a&131218&&(i.$$scope={dirty:a,ctx:s}),n.$set(i)},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function ki(t,e,r){let n,o;X(t,mt,C=>r(15,n=C)),X(t,re,C=>r(9,o=C));let{schemes:s}=e,{schemesToBeShown:a=new Set}=e,{filterText:u=""}=e,i=[],f="",l=[],c="",p={area:0,route:0,crossing:0,other:0},$=!0;Mt(()=>{let C=new Set,A=new Set;for(let F of s.values())F.authority_or_region&&C.add(F.authority_or_region),F.funding_programme&&A.add(F.funding_programme);r(5,i=Array.from(C.entries())),i.sort(),r(6,l=Array.from(A.entries())),l.sort()});function y(C,A,F){let M=C.toLowerCase(),P=I=>{var j,ee;if(M&&!((j=I.properties.name)!=null&&j.toLowerCase().includes(M))&&!((ee=I.properties.description)!=null&&ee.toLowerCase().includes(M)))return!1;if(A||F){let R=s.get(I.properties.scheme_reference);if(A&&R.authority_or_region!=A||F&&R.funding_programme!=F)return!1}return!0};r(1,a=new Set(n.features.filter(P).map(I=>I.properties.scheme_reference))),r(7,p={area:0,route:0,crossing:0,other:0});let N=I=>{var j,ee;return!(!a.has(I.properties.scheme_reference)||M&&!((j=I.properties.name)!=null&&j.toLowerCase().includes(M))&&!((ee=I.properties.description)!=null&&ee.toLowerCase().includes(M)))};mt.update(I=>{for(let j of I.features)N(j)?(delete j.properties.hide_while_editing,r(7,p[j.properties.intervention_type]++,p)):j.properties.hide_while_editing=!0;return I}),r(7,p)}function k(C){f=C,r(2,f)}function S(C){c=C,r(3,c)}function L(){u=this.value,r(0,u)}const E=()=>r(0,u="");function x(C){$=C,r(4,$)}return t.$$set=C=>{"schemes"in C&&r(8,s=C.schemes),"schemesToBeShown"in C&&r(1,a=C.schemesToBeShown),"filterText"in C&&r(0,u=C.filterText)},t.$$.update=()=>{if(t.$$.dirty&528&&o)for(let C of["interventions-polygons","interventions-polygon-outlines","interventions-lines","interventions-lines-endpoints","interventions-points"])o.getLayer(C)&&o.setLayoutProperty(C,"visibility",$?"visible":"none");t.$$.dirty&13&&y(u,f,c)},[u,a,f,c,$,i,l,p,s,o,k,S,L,E,x]}class Si extends K{constructor(e){super(),q(this,e,ki,yi,Z,{schemes:8,schemesToBeShown:1,filterText:0})}}function Ci(t){let e,r,n;return e=new _e({props:{color:U.bus_route_with_lane}}),{c(){_(e.$$.fragment),r=v(`
  Bus routes`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Li(t){let e;return{c(){e=v(`GTFS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Oi(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ti(t){let e,r,n,o,s,a,u,i,f,l,c;return s=new B({props:{href:"https://gtfs.org",$$slots:{default:[Li]},$$scope:{ctx:t}}}),l=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Oi]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows all roads with at least one bus route crossing them. It also
        shows whether the road has a bus lane or not.`,r=O(),n=D("p"),o=v("Note this data is from OpenStreetMap (as of 9 August 2023), not "),_(s.$$.fragment),a=v(`, and doesn't include which routes are run or the
        frequency of service.`),u=O(),i=D("p"),f=v("License: "),_(l.$$.fragment)},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),T(n,o),w(s,n,null),T(n,a),m(p,u,$),m(p,i,$),T(i,f),w(l,i,null),c=!0},p(p,$){const y={};$&8&&(y.$$scope={dirty:$,ctx:p}),s.$set(y);const k={};$&8&&(k.$$scope={dirty:$,ctx:p}),l.$set(k)},i(p){c||(d(s.$$.fragment,p),d(l.$$.fragment,p),c=!0)},o(p){g(s.$$.fragment,p),g(l.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(u),h(i)),b(s),b(l)}}}function Ai(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ti]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&8&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Di(t){let e,r,n,o,s;function a(i){t[1](i)}let u={id:Ze,$$slots:{right:[Ai],default:[Ci]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Ze,tooltip:Ei,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&8&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ze="bus_routes";function Ei(t){return t.properties.has_bus_lane?"<p>At least one bus route crosses here, with a bus lane in one or more directions</p>":"<p>At least one bus route crosses here, without any bus lanes</p>"}function Pi(t,e,r){let n;X(t,re,a=>r(2,n=a)),ae(n,Ze,`https://atip.uk/layers/v1/${Ze}.pmtiles`),ge(n,{id:Ze,source:Ze,sourceLayer:Ze,color:["case",["boolean",["get","has_bus_lane"],!1],U.bus_route_with_lane,U.bus_route_without_lane],width:5,opacity:ue(.5,1)});let o=!1;function s(a){o=a,r(0,o)}return[o,s]}class Ni extends K{constructor(e){super(),q(this,e,Pi,Di,Z,{})}}function Nr(t,e,r){const n=t.slice();return n[2]=e[r],n}function Ir(t,e,r){const n=t.slice();return n[5]=e[r],n}function Mr(t){let e,r;return{c(){e=D("span"),r=v(` 
    `),Fe(e,"background",t[5]),Fe(e,"width","100%"),Fe(e,"border","1px solid black")},m(n,o){m(n,e,o),T(e,r)},p(n,o){o&1&&Fe(e,"background",n[5])},d(n){n&&h(e)}}}function xr(t){let e,r=t[2]+"",n;return{c(){e=D("span"),n=v(r)},m(o,s){m(o,e,s),T(e,n)},p(o,s){s&2&&r!==(r=o[2]+"")&&Le(n,r)},d(o){o&&h(e)}}}function Ii(t){let e,r,n,o=ze(t[0]),s=[];for(let i=0;i<o.length;i+=1)s[i]=Mr(Ir(t,o,i));let a=ze(t[1]),u=[];for(let i=0;i<a.length;i+=1)u[i]=xr(Nr(t,a,i));return{c(){e=D("div");for(let i=0;i<s.length;i+=1)s[i].c();r=O(),n=D("div");for(let i=0;i<u.length;i+=1)u[i].c();Fe(e,"display","flex"),Fe(n,"display","flex"),Fe(n,"justify-content","space-between")},m(i,f){m(i,e,f);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);m(i,r,f),m(i,n,f);for(let l=0;l<u.length;l+=1)u[l]&&u[l].m(n,null)},p(i,[f]){if(f&1){o=ze(i[0]);let l;for(l=0;l<o.length;l+=1){const c=Ir(i,o,l);s[l]?s[l].p(c,f):(s[l]=Mr(c),s[l].c(),s[l].m(e,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=o.length}if(f&2){a=ze(i[1]);let l;for(l=0;l<a.length;l+=1){const c=Nr(i,a,l);u[l]?u[l].p(c,f):(u[l]=xr(c),u[l].c(),u[l].m(n,null))}for(;l<u.length;l+=1)u[l].d(1);u.length=a.length}},i:Q,o:Q,d(i){i&&(h(e),h(r),h(n)),Et(s,i),Et(u,i)}}}function Mi(t,e,r){let{colorScale:n}=e,{limits:o}=e;return t.$$set=s=>{"colorScale"in s&&r(0,n=s.colorScale),"limits"in s&&r(1,o=s.limits)},[n,o]}class Ke extends K{constructor(e){super(),q(this,e,Mi,Ii,Z,{colorScale:0,limits:1})}}function xi(t){let e;return{c(){e=v("Percent of households with a car")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Fi(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Bi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ji(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ri(t){let e,r,n,o,s,a,u,i,f,l,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Fi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Bi]},$$scope:{ctx:t}}}),l=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ji]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Car/van availability data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),a=v("."),u=O(),i=D("p"),f=v("License: "),_(l.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,a),m($,u,y),m($,i,y),T(i,f),w(l,i,null),T(i,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&65536&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&65536&&(L.$$scope={dirty:y,ctx:$}),l.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(l.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(l.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(l)}}}function Ui(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ri]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Fr(t){let e,r;return e=new Ke({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Hi(t){let e;return{c(){e=v("Average cars per household")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Wi(t){let e;return{c(){e=v(`NOMIS TS045
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vi(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gi(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,y;return s=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Wi]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[zi]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Vi]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`Where the census counts "3 or more cars or vans", the average shown here
        assumes 3.`,r=O(),n=D("p"),o=v("Car/van availability data is from the 2021 census, via "),_(s.$$.fragment),a=v(". Output area boundaries from "),_(u.$$.fragment),i=v("."),f=O(),l=D("p"),c=v("License: "),_(p.$$.fragment),$=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(k,S){m(k,e,S),m(k,r,S),m(k,n,S),T(n,o),w(s,n,null),T(n,a),w(u,n,null),T(n,i),m(k,f,S),m(k,l,S),T(l,c),w(p,l,null),T(l,$),y=!0},p(k,S){const L={};S&65536&&(L.$$scope={dirty:S,ctx:k}),s.$set(L);const E={};S&65536&&(E.$$scope={dirty:S,ctx:k}),u.$set(E);const x={};S&65536&&(x.$$scope={dirty:S,ctx:k}),p.$set(x)},i(k){y||(d(s.$$.fragment,k),d(u.$$.fragment,k),d(p.$$.fragment,k),y=!0)},o(k){g(s.$$.fragment,k),g(u.$$.fragment,k),g(p.$$.fragment,k),y=!1},d(k){k&&(h(e),h(r),h(n),h(f),h(l)),b(s),b(u),b(p)}}}function Ki(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Gi]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Br(t){let e,r;return e=new Ke({props:{colorScale:t[4],limits:t[7]()}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function qi(t){let e;return{c(){e=v("Population density")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zi(t){let e;return{c(){e=v(`NOMIS TS006
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xi(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yi(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ji(t){let e,r,n,o,s,a,u,i,f,l,c,p;return n=new B({props:{href:"https://www.nomisweb.co.uk/sources/census_2021_bulk",$$slots:{default:[Zi]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::output-areas-2021-boundaries-ew-bgc/explore",$$slots:{default:[Xi]},$$scope:{ctx:t}}}),l=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Yi]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Population density data is from the 2021 census, via "),_(n.$$.fragment),o=v(". Output area boundaries from "),_(s.$$.fragment),a=v("."),u=O(),i=D("p"),f=v("License: "),_(l.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,a),m($,u,y),m($,i,y),T(i,f),w(l,i,null),T(i,c),p=!0},p($,y){const k={};y&65536&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&65536&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&65536&&(L.$$scope={dirty:y,ctx:$}),l.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(l.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(l.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(l)}}}function Qi(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ji]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function jr(t){let e,r,n,o;return n=new Ke({props:{colorScale:t[4],limits:t[7]().map(ta)}}),{c(){e=D("p"),e.textContent="(people per square kilometres)",r=O(),_(n.$$.fragment)},m(s,a){m(s,e,a),m(s,r,a),w(n,s,a),o=!0},p:Q,i(s){o||(d(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&(h(e),h(r)),b(n,s)}}}function ea(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,y;function k(P){t[9](P)}let S={id:"percent_households_with_car",$$slots:{right:[Ui],default:[xi]},$$scope:{ctx:t}};t[0]!==void 0&&(S.checked=t[0]),e=new te({props:S}),H.push(()=>z(e,"checked",k)),e.$on("change",t[10]);let L=t[3]=="percent_households_with_car"&&Fr(t);function E(P){t[11](P)}let x={id:"average_cars_per_household",$$slots:{right:[Ki],default:[Hi]},$$scope:{ctx:t}};t[1]!==void 0&&(x.checked=t[1]),s=new te({props:x}),H.push(()=>z(s,"checked",E)),s.$on("change",t[12]);let C=t[3]=="average_cars_per_household"&&Br(t);function A(P){t[13](P)}let F={id:"population_density",$$slots:{right:[Qi],default:[qi]},$$scope:{ctx:t}};t[2]!==void 0&&(F.checked=t[2]),f=new te({props:F}),H.push(()=>z(f,"checked",A)),f.$on("change",t[14]);let M=t[3]=="population_density"&&jr(t);return $=new J({props:{layer:Oe,tooltip:t[5],show:t[3]!="",clickable:!0}}),$.$on("click",t[6]),{c(){_(e.$$.fragment),n=O(),L&&L.c(),o=O(),_(s.$$.fragment),u=O(),C&&C.c(),i=O(),_(f.$$.fragment),c=O(),M&&M.c(),p=O(),_($.$$.fragment)},m(P,N){w(e,P,N),m(P,n,N),L&&L.m(P,N),m(P,o,N),w(s,P,N),m(P,u,N),C&&C.m(P,N),m(P,i,N),w(f,P,N),m(P,c,N),M&&M.m(P,N),m(P,p,N),w($,P,N),y=!0},p(P,[N]){const I={};N&65536&&(I.$$scope={dirty:N,ctx:P}),!r&&N&1&&(r=!0,I.checked=P[0],V(()=>r=!1)),e.$set(I),P[3]=="percent_households_with_car"?L?(L.p(P,N),N&8&&d(L,1)):(L=Fr(P),L.c(),d(L,1),L.m(o.parentNode,o)):L&&(le(),g(L,1,1,()=>{L=null}),fe());const j={};N&65536&&(j.$$scope={dirty:N,ctx:P}),!a&&N&2&&(a=!0,j.checked=P[1],V(()=>a=!1)),s.$set(j),P[3]=="average_cars_per_household"?C?(C.p(P,N),N&8&&d(C,1)):(C=Br(P),C.c(),d(C,1),C.m(i.parentNode,i)):C&&(le(),g(C,1,1,()=>{C=null}),fe());const ee={};N&65536&&(ee.$$scope={dirty:N,ctx:P}),!l&&N&4&&(l=!0,ee.checked=P[2],V(()=>l=!1)),f.$set(ee),P[3]=="population_density"?M?(M.p(P,N),N&8&&d(M,1)):(M=jr(P),M.c(),d(M,1),M.m(p.parentNode,p)):M&&(le(),g(M,1,1,()=>{M=null}),fe());const R={};N&8&&(R.show=P[3]!=""),$.$set(R)},i(P){y||(d(e.$$.fragment,P),d(L),d(s.$$.fragment,P),d(C),d(f.$$.fragment,P),d(M),d($.$$.fragment,P),y=!0)},o(P){g(e.$$.fragment,P),g(L),g(s.$$.fragment,P),g(C),g(f.$$.fragment,P),g(M),g($.$$.fragment,P),y=!1},d(P){P&&(h(n),h(o),h(u),h(i),h(c),h(p)),b(e,P),L&&L.d(P),b(s,P),C&&C.d(P),b(f,P),M&&M.d(P),b($,P)}}}let Oe="census_output_areas";const ta=t=>t.toLocaleString();function ra(t,e,r){let n;X(t,re,x=>r(8,n=x));let o=`${Oe}-outline`,s=U.sequential_low_to_high,a=!1,u=!1,i=!1,f="";ae(n,Oe,`https://atip.uk/layers/v1/${Oe}.pmtiles`),Ge(n,{id:Oe,source:Oe,sourceLayer:Oe,color:"black",opacity:ue(.5,.7)}),ge(n,{id:o,source:Oe,sourceLayer:Oe,color:"black",width:.5});function l(x){let C=x.properties.OA21CD,A=x.properties[f];return f=="percent_households_with_car"?`<p>${A}% of households in ${C} have 1 or more cars</p>`:f=="average_cars_per_household"?`<p>Households in ${C} have an average of ${A} cars</p>`:`<p>There are ${A.toLocaleString()} people per square kilometre in ${C}</p>`}function c(x){let C=x.detail.properties.OA21CD;f=="percent_households_with_car"||f=="average_cars_per_household"?window.open(`https://www.ons.gov.uk/census/maps/choropleth/housing/number-of-cars-or-vans/number-of-cars-5a/no-cars-or-vans-in-household?oa=${C}`,"_blank"):window.open(`https://www.ons.gov.uk/census/maps/choropleth/population/population-density/population-density/persons-per-square-kilometre?oa=${C}`,"_blank")}function p(){return f=="percent_households_with_car"?[0,20,40,60,80,100]:f=="average_cars_per_household"?[0,.5,1,1.5,2,2.5]:[0,4700,13e3,33e3,94e3,198e4]}function $(x){a=x,r(0,a)}const y=()=>{r(1,u=!1),r(2,i=!1)};function k(x){u=x,r(1,u)}const S=()=>{r(0,a=!1),r(2,i=!1)};function L(x){i=x,r(2,i)}const E=()=>{r(0,a=!1),r(1,u=!1)};return t.$$.update=()=>{t.$$.dirty&271&&(a?r(3,f="percent_households_with_car"):u?r(3,f="average_cars_per_household"):i?r(3,f="population_density"):r(3,f=""),f?(n.setPaintProperty(Oe,"fill-color",Ve(["get",f],p(),s)),n.setLayoutProperty(o,"visibility","visible")):n.setLayoutProperty(o,"visibility","none"))},[a,u,i,f,s,l,c,p,n,$,y,k,S,L,E]}class na extends K{constructor(e){super(),q(this,e,ra,ea,Z,{})}}function oa(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Combined authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function sa(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ia(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function aa(t){let e,r,n,o,s,a,u,i,f,l;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[sa]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ia]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of December 2022."),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,a,p),T(a,u),w(i,a,null),T(a,f),l=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){l||(d(n.$$.fragment,c),d(i.$$.fragment,c),l=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),l=!1},d(c){c&&(h(e),h(s),h(a)),b(n),b(i)}}}function la(t){let e,r,n;return r=new ne({props:{$$slots:{default:[aa]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function fa(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Re,$$slots:{right:[la],default:[oa]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Re,tooltip:ua,show:t[0],clickable:!0}}),o.$on("click",ca),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Re="combined_authorities";function ua(t){return`<p>${t.properties.name}</p>`}function ca(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.CAUTH22CD}`,"_blank")}function pa(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.combined_authorities,s=`${Re}-outline`;sr(n,Re,`https://atip.uk/layers/v1/${Re}.geojson`),Ge(n,{id:Re,source:Re,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Re,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class $a extends K{constructor(e){super(),q(this,e,pa,fa,Z,{})}}function ma(t){let e,r,n;return{c(){e=D("input"),G(e,"class","govuk-file-upload"),G(e,"id","load-criticals"),G(e,"type","file")},m(o,s){m(o,e,s),t[7](e),r||(n=or(e,"change",t[4]),r=!0)},p:Q,d(o){o&&h(e),t[7](null),r=!1,n()}}}function Rr(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[da]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function ha(t){let e,r,n=t[2].toLocaleString()+"",o,s,a;return e=new _e({props:{color:er}}),{c(){_(e.$$.fragment),r=v(`
        Show `),o=v(n),s=v(" issues")},m(u,i){w(e,u,i),m(u,r,i),m(u,o,i),m(u,s,i),a=!0},p(u,i){(!a||i&4)&&n!==(n=u[2].toLocaleString()+"")&&Le(o,n)},i(u){a||(d(e.$$.fragment,u),a=!0)},o(u){g(e.$$.fragment,u),a=!1},d(u){u&&(h(r),h(o),h(s)),b(e,u)}}}function da(t){let e,r,n;function o(a){t[8](a)}let s={id:"show-criticals",$$slots:{default:[ha]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.checked=t[0]),e=new te({props:s}),H.push(()=>z(e,"checked",o)),{c(){_(e.$$.fragment)},m(a,u){w(e,a,u),n=!0},p(a,u){const i={};u&516&&(i.$$scope={dirty:u,ctx:a}),!r&&u&1&&(r=!0,i.checked=a[0],V(()=>r=!1)),e.$set(i)},i(a){n||(d(e.$$.fragment,a),n=!0)},o(a){g(e.$$.fragment,a),n=!1},d(a){b(e,a)}}}function ga(t){let e,r,n,o,s,a;e=new nn({props:{label:"Load from .xlsx",id:"load-criticals",$$slots:{default:[ma]},$$scope:{ctx:t}}}),n=new sn({props:{errorMessage:t[3]}});let u=t[2]>0&&Rr(t);return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),u&&u.c(),s=xt()},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),m(i,o,f),u&&u.m(i,f),m(i,s,f),a=!0},p(i,f){const l={};f&514&&(l.$$scope={dirty:f,ctx:i}),e.$set(l);const c={};f&8&&(c.errorMessage=i[3]),n.$set(c),i[2]>0?u?(u.p(i,f),f&4&&d(u,1)):(u=Rr(i),u.c(),d(u,1),u.m(s.parentNode,s)):u&&(le(),g(u,1,1,()=>{u=null}),fe())},i(i){a||(d(e.$$.fragment,i),d(n.$$.fragment,i),d(u),a=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),g(u),a=!1},d(i){i&&(h(r),h(o),h(s)),b(e,i),b(n,i),u&&u.d(i)}}}function _a(t){let e,r,n,o,s,a;return e=new xe({props:{label:"Critical Issues",$$slots:{default:[ga]},$$scope:{ctx:t}}}),n=new J({props:{layer:se+"-points",tooltip:wa,show:t[0],clickable:!1}}),s=new J({props:{layer:se+"-clusters",show:t[0],clickable:!0,ignoreHigherLayers:[se+"-counts"]}}),s.$on("click",t[5]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment)},m(u,i){w(e,u,i),m(u,r,i),w(n,u,i),m(u,o,i),w(s,u,i),a=!0},p(u,[i]){const f={};i&527&&(f.$$scope={dirty:i,ctx:u}),e.$set(f);const l={};i&1&&(l.show=u[0]),n.$set(l);const c={};i&1&&(c.show=u[0]),s.$set(c)},i(u){a||(d(e.$$.fragment,u),d(n.$$.fragment,u),d(s.$$.fragment,u),a=!0)},o(u){g(e.$$.fragment,u),g(n.$$.fragment,u),g(s.$$.fragment,u),a=!1},d(u){u&&(h(r),h(o)),b(e,u),b(n,u),b(s,u)}}}let se="criticals",er="red";function wa(t){let e='<div style="max-width: 30vw;">';return e+=`<h2>${t.properties.critical_type}</h2>`,e+=`<p><u>Location</u>: ${t.properties.location_description}</p>`,e+=`<p><u>Notes</u>: ${t.properties.notes}</p>`,e+="<hr />",e+=`<p>Critical issue ID: <b>${t.properties.id}</b></p>`,e+=`<p>Submitted by <b>${t.properties.inspector??"???"}</b> at <b>${t.properties.submission_time}</b></p>`,e+=`<p>For scheme <b>${t.properties.scheme_reference}</b> in stage <b>${t.properties.current_design_stage}</b></p>`,e+="</div>",e}function ba(t,e,r){let n;X(t,re,p=>r(6,n=p));let o,s=!0,a=0,u="";Hn(n,se),n.addSource(se,{type:"geojson",data:on(),cluster:!0,clusterMaxZoom:14,clusterRadius:50}),ht(n,{id:`${se}-clusters`,source:se,filter:["has","point_count"],color:er,opacity:.9,radius:["step",["get","point_count"],20,15,30,30,40]}),n.addLayer({id:`${se}-counts`,source:se,type:"symbol",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}"}}),ht(n,{id:`${se}-points`,source:se,filter:["!",["has","point_count"]],color:er,opacity:.9,radius:15,strokeColor:"black",strokeWidth:3});async function i(p){try{let $=await $i(o.files[0]);n.getSource(se).setData($),r(2,a=$.features.length),r(3,u="")}catch($){r(3,u=`The file you loaded is broken: ${$}`)}}function f(p){n.getSource(se).getClusterExpansionZoom(p.detail.properties.cluster_id,($,y)=>{$||n.easeTo({center:p.detail.geometry.coordinates,zoom:y})})}function l(p){H[p?"unshift":"push"](()=>{o=p,r(1,o)})}function c(p){s=p,r(0,s)}return t.$$.update=()=>{t.$$.dirty&65&&n.getLayer(`${se}-counts`)&&n.setLayoutProperty(`${se}-counts`,"visibility",s?"visible":"none")},[s,o,a,u,i,f,n,l,c]}class va extends K{constructor(e){super(),q(this,e,ba,_a,Z,{})}}function ya(t){let e,r,n;return e=new _e({props:{color:t[2]}}),{c(){_(e.$$.fragment),r=v(`
  Crossings`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ka(t){let e;return{c(){e=v("crossing")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Sa(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ca(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Key:crossing",$$slots:{default:[ka]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Sa]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),T(e,r),w(n,e,null),T(e,o),m(l,s,c),m(l,a,c),T(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&64&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&64&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(d(n.$$.fragment,l),d(i.$$.fragment,l),f=!0)},o(l){g(n.$$.fragment,l),g(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),b(n),b(i)}}}function La(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ca]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Oa(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Ue,$$slots:{right:[La],default:[ya]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Ue,tooltip:t[1],show:t[0],clickable:!0}}),o.$on("click",Ta),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&64&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Ue="crossings";function Ta(t){window.open(`http://openstreetmap.org/node/${t.detail.properties.osm_id}`,"_blank")}function Aa(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=!1;function s(f){const l=f.properties.crossing;return`<p>${a.get(l)??`Crossing with unknown type (${l})`}. Click for details.</p>`}const a=new Map([["no","Location where crossing is impossible/illegal but where there is a clear desire line to cross"],["traffic_signals","Signalised crossing"],["marked","Crossing with no traffic signals"],["uncontrolled","Crossing with no traffic signals"],["unmarked","Crossing with no markings or signals"],["zebra","Zebra crossing"],["island","Crossing with an island"],["informal","Informal crossing with an obvious desire line, but no official infrastructure to support it"]]);ae(n,Ue,`https://atip.uk/layers/v1/${Ue}.pmtiles`);let u=U[Ue];ht(n,{id:Ue,source:Ue,sourceLayer:Ue,color:u,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});function i(f){o=f,r(0,o)}return[o,s,u,i]}class Da extends K{constructor(e){super(),q(this,e,Aa,Oa,Z,{})}}function Ea(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Cycle parking`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Pa(t){let e;return{c(){e=v("OpenStreetMap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Na(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ia(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dbicycle_parking",$$slots:{default:[Pa]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Na]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Cycle parking, according to "),_(n.$$.fragment),o=v(` (as of 9 August 2023). The type of parking, public/private
        access, and whether it's covered are not shown.`),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),T(e,r),w(n,e,null),T(e,o),m(l,s,c),m(l,a,c),T(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(d(n.$$.fragment,l),d(i.$$.fragment,l),f=!0)},o(l){g(n.$$.fragment,l),g(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),b(n),b(i)}}}function Ma(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ia]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function xa(t){let e,r,n,o,s;function a(i){t[2](i)}let u={id:Xe,$$slots:{right:[Ma],default:[Ea]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Xe,tooltip:Fa,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&16&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Xe="cycle_parking";function Fa(t){return`<p>Capacity: ${t.properties.capacity??"unknown"}</p>`}function Ba(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=U.cycle_parking;ae(n,Xe,`https://atip.uk/layers/v1/${Xe}.pmtiles`),ht(n,{id:Xe,source:Xe,sourceLayer:Xe,color:o,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,10]});let s=!1;function a(u){s=u,r(0,s)}return[s,o,a]}class ja extends K{constructor(e){super(),q(this,e,Ba,xa,Z,{})}}function Ur(t,e,r){const n=t.slice();return n[4]=e[r][0],n[5]=e[r][1],n}function Ra(t){let e;return{c(){e=v("Cycle paths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ua(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ha(t){let e,r,n,o,s,a,u,i,f,l;return f=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Ua]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This shows different types of cycle path, according to OpenStreetMap (as
        of 15 August 2023).`,r=O(),n=D("ul"),n.innerHTML=`<li><b>Separated tracks</b>
          include fully or partly segregated cycletracks alongside a carriageway,
          stepped cycletracks, and tracks off the carriageway entirely. They&#39;re also
          separated from foot traffic.</li> <li><b>Unprotected lanes</b>
          are mandatory or advisory lanes on the carriageway, without any physical
          protection. They do not included shared bus lanes.</li> <li><b>Shared-use</b>
          paths are split between cycle and foot traffic, and are separated from
          motor traffic somehow. There can be segregation between cyclists and pedestrians
          or not.</li>`,o=O(),s=D("p"),s.textContent=`Note there are many known limitations with this layer. Data in
        OpenStreetMap can be missing, mapped twice, or mapped incorrectly. Our
        processing is also imperfect. You can click a segment to see full
        OpenStreetMap data. Please do report issues with the classification or
        data.`,a=O(),u=D("p"),i=v("License: "),_(f.$$.fragment)},m(c,p){m(c,e,p),m(c,r,p),m(c,n,p),m(c,o,p),m(c,s,p),m(c,a,p),m(c,u,p),T(u,i),w(f,u,null),l=!0},p(c,p){const $={};p&256&&($.$$scope={dirty:p,ctx:c}),f.$set($)},i(c){l||(d(f.$$.fragment,c),l=!0)},o(c){g(f.$$.fragment,c),l=!1},d(c){c&&(h(e),h(r),h(n),h(o),h(s),h(a),h(u)),b(f)}}}function Wa(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ha]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Hr(t){let e,r,n=ze(t[1]),o=[];for(let a=0;a<n.length;a+=1)o[a]=Wr(Ur(t,n,a));const s=a=>g(o[a],1,1,()=>{o[a]=null});return{c(){for(let a=0;a<o.length;a+=1)o[a].c();e=xt()},m(a,u){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(a,u);m(a,e,u),r=!0},p(a,u){if(u&2){n=ze(a[1]);let i;for(i=0;i<n.length;i+=1){const f=Ur(a,n,i);o[i]?(o[i].p(f,u),d(o[i],1)):(o[i]=Wr(f),o[i].c(),d(o[i],1),o[i].m(e.parentNode,e))}for(le(),i=n.length;i<o.length;i+=1)s(i);fe()}},i(a){if(!r){for(let u=0;u<n.length;u+=1)d(o[u]);r=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)g(o[u]);r=!1},d(a){a&&h(e),Et(o,a)}}}function Wr(t){let e,r,n,o=t[4]+"",s,a,u;return r=new _e({props:{color:t[5]}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),s=v(o),a=O()},m(i,f){m(i,e,f),w(r,e,null),T(e,n),T(e,s),T(e,a),u=!0},p:Q,i(i){u||(d(r.$$.fragment,i),u=!0)},o(i){g(r.$$.fragment,i),u=!1},d(i){i&&h(e),b(r)}}}function za(t){let e,r,n,o,s,a;function u(l){t[2](l)}let i={id:Ye,$$slots:{right:[Wa],default:[Ra]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&Hr(t);return s=new J({props:{layer:Ye,tooltip:Va,show:t[0],clickable:!0}}),s.$on("click",Ga),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:l}),!r&&c&1&&(r=!0,p.checked=l[0],V(()=>r=!1)),e.$set(p),l[0]?f?(f.p(l,c),c&1&&d(f,1)):(f=Hr(l),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(le(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=l[0]),s.$set($)},i(l){a||(d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!0)},o(l){g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),b(e,l),f&&f.d(l),b(s,l)}}}let Ye="cycle_paths";function Va(t){let e={track:"Separated track",lane:"Unprotected lane",shared_use_segregated:"Shared-use (segregated)",shared_use_unsegregated:"Shared-use (unsegregated)"}[t.properties.kind],r={"one-way":"&uarr;","two-way":"&#8597;",unknown:""}[t.properties.direction],n=t.properties.width=="unknown"?"unknown":`${t.properties.width} meters`,o=`<h2>${e}</h2>`;return o+=`<p>Direction: <b>${r} ${t.properties.direction}</b></p>`,o+=`<p>Width: <b>${n}</b></p>`,o}function Ga(t){window.open(`http://openstreetmap.org/way/${t.detail.properties.osm_id}`,"_blank")}function Ka(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=[["Separated tracks",U.cycle_paths.track],["Unprotected lanes",U.cycle_paths.lane],["Shared-use (segregated)",U.cycle_paths.shared_use_segregated],["Shared-use (unsegregated)",U.cycle_paths.shared_use_unsegregated]];ae(n,Ye,`https://atip.uk/layers/v1/${Ye}.pmtiles`),ge(n,{id:Ye,source:Ye,sourceLayer:Ye,color:rn(["get","kind"],{track:U.cycle_paths.track,lane:U.cycle_paths.lane,shared_use_segregated:U.cycle_paths.shared_use_segregated,shared_use_unsegregated:U.cycle_paths.shared_use_unsegregated},"red"),width:Ft,opacity:ue(.5,1)});let s=!1;function a(u){s=u,r(0,s)}return[s,o,a]}class qa extends K{constructor(e){super(),q(this,e,Ka,za,Z,{})}}function Za(t){let e,r,n,o;return e=new _e({props:{color:t[3]}}),{c(){_(e.$$.fragment),r=O(),n=v(t[1])},m(s,a){w(e,s,a),m(s,r,a),m(s,n,a),o=!0},p(s,a){(!o||a&2)&&Le(n,s[1])},i(s){o||(d(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){s&&(h(r),h(n)),b(e,s)}}}function Xa(t){let e;const r=t[6].default,n=Wn(r,t,t[8],null);return{c(){n&&n.c()},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&zn(n,r,o,o[8],e?Gn(r,o[8],s,null):Vn(o[8]),null)},i(o){e||(d(n,o),e=!0)},o(o){g(n,o),e=!1},d(o){n&&n.d(o)}}}function Ya(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Xa]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Ja(t){let e,r,n,o,s;function a(i){t[7](i)}let u={id:t[0],$$slots:{right:[Ya],default:[Za]},$$scope:{ctx:t}};return t[2]!==void 0&&(u.checked=t[2]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:t[0],tooltip:t[4],show:t[2],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&1&&(l.id=i[0]),f&258&&(l.$$scope={dirty:f,ctx:i}),!r&&f&4&&(r=!0,l.checked=i[2],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.layer=i[0]),f&4&&(c.show=i[2]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}function Qa(t,e,r){let n;X(t,re,$=>r(9,n=$));let{$$slots:o={},$$scope:s}=e,{name:a}=e,{singularNoun:u}=e,{pluralNoun:i}=e,f=U[a];ae(n,a,`https://atip.uk/layers/v1/${a}.pmtiles`),Ge(n,{id:a,source:a,sourceLayer:a,color:f,opacity:ue(1,.7)});let l=!1;function c($){return`<p>${$.properties.name??`Unnamed ${u}`}</p>`}function p($){l=$,r(2,l)}return t.$$set=$=>{"name"in $&&r(0,a=$.name),"singularNoun"in $&&r(5,u=$.singularNoun),"pluralNoun"in $&&r(1,i=$.pluralNoun),"$$scope"in $&&r(8,s=$.$$scope)},[a,i,l,f,c,u,o,p,s]}class ar extends K{constructor(e){super(),q(this,e,Qa,Ja,Z,{name:0,singularNoun:5,pluralNoun:1})}}function el(t){let e;return{c(){e=v("hospital")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function tl(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function rl(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[el]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[tl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(` data from OpenStreetMap (as of 9 August 2023). It doesn't include
    outpatient clinics or individual doctor's offices.`),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),T(e,r),w(n,e,null),T(e,o),m(l,s,c),m(l,a,c),T(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(d(n.$$.fragment,l),d(i.$$.fragment,l),f=!0)},o(l){g(n.$$.fragment,l),g(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),b(n),b(i)}}}function nl(t){let e,r;return e=new ar({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[rl]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class ol extends K{constructor(e){super(),q(this,e,null,nl,Z,{})}}function sl(t){let e;return{c(){e=v("Indices of Multiple Deprivation")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function il(t){let e;return{c(){e=v(`DLUCH GIS
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function al(t){let e;return{c(){e=v(`here
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function ll(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fl(t){let e,r,n,o,s,a,u,i,f,l,c,p;return n=new B({props:{href:"https://data-communities.opendata.arcgis.com/datasets/communities::indices-of-multiple-deprivation-imd-2019-1/explore",$$slots:{default:[il]},$$scope:{ctx:t}}}),s=new B({props:{href:"http://dclgapps.communities.gov.uk/imd/iod_index.html",$$slots:{default:[al]},$$scope:{ctx:t}}}),l=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[ll]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("The 2019 English IMD scores come from "),_(n.$$.fragment),o=v(`. Note the LSOAs identified are from the 2011 census. A
        detailed breakdown of the score across different categories can be found `),_(s.$$.fragment),a=v("."),u=O(),i=D("p"),f=v("License: "),_(l.$$.fragment),c=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,a),m($,u,y),m($,i,y),T(i,f),w(l,i,null),T(i,c),p=!0},p($,y){const k={};y&64&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&64&&(S.$$scope={dirty:y,ctx:$}),s.$set(S);const L={};y&64&&(L.$$scope={dirty:y,ctx:$}),l.$set(L)},i($){p||(d(n.$$.fragment,$),d(s.$$.fragment,$),d(l.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(s.$$.fragment,$),g(l.$$.fragment,$),p=!1},d($){$&&(h(e),h(u),h(i)),b(n),b(s),b(l)}}}function ul(t){let e,r,n;return r=new ne({props:{$$slots:{default:[fl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function zr(t){let e,r;return e=new Ke({props:{colorScale:t[1],limits:["Least deprived","Most deprived"]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function cl(t){let e,r,n,o,s,a;function u(l){t[3](l)}let i={id:Te,$$slots:{right:[ul],default:[sl]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&zr(t);return s=new J({props:{layer:Te,tooltip:pl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:l}),!r&&c&1&&(r=!0,p.checked=l[0],V(()=>r=!1)),e.$set(p),l[0]?f?(f.p(l,c),c&1&&d(f,1)):(f=zr(l),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(le(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=l[0]),s.$set($)},i(l){a||(d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!0)},o(l){g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),b(e,l),f&&f.d(l),b(s,l)}}}let Te="imd";function pl(t){return`<p>${t.properties.LSOA11CD} has an IMD score of <b>${t.properties.score}</b></p><p>Rank: <b>${t.properties.rank.toLocaleString()}</b> / 32,844 LSOAs</p>`}function $l(t,e,r){let n;X(t,re,f=>r(2,n=f));let o=`${Te}-outline`,s=U.sequential_low_to_high,a=[0,2,4,6,8,10];ae(n,Te,`https://atip.uk/layers/v1/${Te}.pmtiles`),Ge(n,{id:Te,source:Te,sourceLayer:Te,color:Ve(["-",10,["get","decile"]],a,s),opacity:ue(.5,.7)}),ge(n,{id:o,source:Te,sourceLayer:Te,color:"black",width:.5});let u=!1;function i(f){u=f,r(0,u)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(o)&&n.setLayoutProperty(o,"visibility",u?"visible":"none")},[u,s,n,i]}class ml extends K{constructor(e){super(),q(this,e,$l,cl,Z,{})}}function hl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Authority Districts`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function dl(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function gl(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function _l(t){let e,r,n,o,s,a,u,i,f,l;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[dl]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[gl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,a,p),T(a,u),w(i,a,null),T(a,f),l=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){l||(d(n.$$.fragment,c),d(i.$$.fragment,c),l=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),l=!1},d(c){c&&(h(e),h(s),h(a)),b(n),b(i)}}}function wl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[_l]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function bl(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:He,$$slots:{right:[wl],default:[hl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:He,tooltip:vl,show:t[0],clickable:!0}}),o.$on("click",yl),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let He="local_authority_districts";function vl(t){return`<p>${t.properties.name}</p>`}function yl(t){window.open(`https://www.ons.gov.uk/visualisations/areas/${t.detail.properties.LAD23CD}`,"_blank")}function kl(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.local_authority_districts,s=`${He}-outline`;sr(n,He,`https://atip.uk/layers/v1/${He}.geojson`),Ge(n,{id:He,source:He,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:He,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class Sl extends K{constructor(e){super(),q(this,e,kl,bl,Z,{})}}function Cl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Local Planning Authorities`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function Ll(t){let e;return{c(){e=v(`local authority
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ol(t){let e;return{c(){e=v(`national park authorit
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Tl(t){let e;return{c(){e=v(`development corporation
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Al(t){let e;return{c(){e=v("this map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Dl(t){let e;return{c(){e=v(`planning.data.gov.uk
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function El(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pl(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,y,k,S,L,E,x,C,A,F,M,P,N;return n=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-authority",$$slots:{default:[Ll]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://www.planning.data.gov.uk/dataset/national-park-authority",$$slots:{default:[Ol]},$$scope:{ctx:t}}}),u=new B({props:{href:"https://www.planning.data.gov.uk/dataset/development-corporation",$$slots:{default:[Tl]},$$scope:{ctx:t}}}),$=new B({props:{href:"https://www.planning.data.gov.uk/map/?dataset=local-planning-authority",$$slots:{default:[Al]},$$scope:{ctx:t}}}),E=new B({props:{href:"https://www.planning.data.gov.uk/dataset/local-planning-authority",$$slots:{default:[Dl]},$$scope:{ctx:t}}}),M=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[El]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("LPAs may be a "),_(n.$$.fragment),o=v(", "),_(s.$$.fragment),a=v("y, or "),_(u.$$.fragment),i=v("."),f=O(),l=D("p"),c=D("strong"),p=v(`Note there are overlapping LPAs near Northhamptonshire. Only one
          authority name is shown when hovering. Use `),_($.$$.fragment),y=v(" to get more details."),k=O(),S=D("p"),L=v("Data from ONS Geography via "),_(E.$$.fragment),x=v(", as of November 2022."),C=O(),A=D("p"),F=v("License: "),_(M.$$.fragment),P=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(I,j){m(I,e,j),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,a),w(u,e,null),T(e,i),m(I,f,j),m(I,l,j),T(l,c),T(c,p),w($,c,null),T(c,y),m(I,k,j),m(I,S,j),T(S,L),w(E,S,null),T(S,x),m(I,C,j),m(I,A,j),T(A,F),w(M,A,null),T(A,P),N=!0},p(I,j){const ee={};j&32&&(ee.$$scope={dirty:j,ctx:I}),n.$set(ee);const R={};j&32&&(R.$$scope={dirty:j,ctx:I}),s.$set(R);const ce={};j&32&&(ce.$$scope={dirty:j,ctx:I}),u.$set(ce);const we={};j&32&&(we.$$scope={dirty:j,ctx:I}),$.$set(we);const oe={};j&32&&(oe.$$scope={dirty:j,ctx:I}),E.$set(oe);const qe={};j&32&&(qe.$$scope={dirty:j,ctx:I}),M.$set(qe)},i(I){N||(d(n.$$.fragment,I),d(s.$$.fragment,I),d(u.$$.fragment,I),d($.$$.fragment,I),d(E.$$.fragment,I),d(M.$$.fragment,I),N=!0)},o(I){g(n.$$.fragment,I),g(s.$$.fragment,I),g(u.$$.fragment,I),g($.$$.fragment,I),g(E.$$.fragment,I),g(M.$$.fragment,I),N=!1},d(I){I&&(h(e),h(f),h(l),h(k),h(S),h(C),h(A)),b(n),b(s),b(u),b($),b(E),b(M)}}}function Nl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Pl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Il(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Ae,$$slots:{right:[Nl],default:[Cl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Ae,tooltip:Ml,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ae="local_planning_authorities";function Ml(t){return`<p>${t.properties.name}</p>`}function xl(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.local_planning_authorities,s=`${Ae}-outline`;ae(n,Ae,`https://atip.uk/layers/v1/${Ae}.pmtiles`),Ge(n,{id:Ae,source:Ae,sourceLayer:Ae,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Ae,sourceLayer:Ae,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class Fl extends K{constructor(e){super(),q(this,e,xl,Il,Z,{})}}function Bl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Major Road Network`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function jl(t){let e;return{c(){e=v(`Major Road Network
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Rl(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ul(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[jl]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Rl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from the "),_(n.$$.fragment),o=v(", as of September 2021."),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),T(e,r),w(n,e,null),T(e,o),m(l,s,c),m(l,a,c),T(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&16&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&16&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(d(n.$$.fragment,l),d(i.$$.fragment,l),f=!0)},o(l){g(n.$$.fragment,l),g(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),b(n),b(i)}}}function Hl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Ul]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&16&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Wl(t){let e,r,n,o,s;function a(i){t[2](i)}let u={id:Je,$$slots:{right:[Hl],default:[Bl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Je,tooltip:zl,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&16&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Je="mrn";function zl(t){return`<p>${t.properties.name??"Unknown MRN road"}</p>`}function Vl(t,e,r){let n;X(t,re,u=>r(3,n=u));let o=U.mrn;ae(n,Je,`https://atip.uk/layers/v1/${Je}.pmtiles`),ge(n,{id:Je,source:Je,sourceLayer:Je,color:o,width:7,opacity:ue(.5,1)});let s=!1;function a(u){s=u,r(0,s)}return[s,o,a]}class Gl extends K{constructor(e){super(),q(this,e,Vl,Wl,Z,{})}}function Kl(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Parliamentary constituencies`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function ql(t){let e;return{c(){e=v(`Ordnance Survey Boundary-Line
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Zl(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xl(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[ql]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Zl]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),T(e,r),w(n,e,null),T(e,o),m(l,s,c),m(l,a,c),T(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(d(n.$$.fragment,l),d(i.$$.fragment,l),f=!0)},o(l){g(n.$$.fragment,l),g(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),b(n),b(i)}}}function Yl(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Xl]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Jl(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:De,$$slots:{right:[Yl],default:[Kl]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:De,tooltip:Ql,show:t[0],clickable:!0}}),o.$on("click",ef),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let De="parliamentary_constituencies";function Ql(t){return`<p>${t.properties.Name}</p>`}function ef(t){let e=t.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function tf(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.parliamentary_constituencies,s=`${De}-outline`;ae(n,De,`https://atip.uk/layers/v1/${De}.pmtiles`),Ge(n,{id:De,source:De,sourceLayer:De,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:De,sourceLayer:De,color:o,width:5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class rf extends K{constructor(e){super(),q(this,e,tf,Jl,Z,{})}}function nf(t){let e;return{c(){e=v("Propensity to Cycle Tool")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function of(t){let e;return{c(){e=v("the PCT website")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function sf(t){let e;return{c(){e=v("2017 journal article")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function af(t){let e,r,n,o,s,a,u,i,f,l,c;return u=new B({props:{href:"https://www.pct.bike",$$slots:{default:[of]},$$scope:{ctx:t}}}),f=new B({props:{href:"https://www.jtlu.org/index.php/jtlu/article/view/862",$$slots:{default:[sf]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`The PCT shows major links on the transport network on which there is
        high latent demand for cycling under scenarios of change, based on the
        "fastest" routes from CycleStreets. Counts approximate daily rush hour
        traffic levels.`,r=O(),n=D("p"),n.textContent=`Note this layer uses 2011 census data and outdated OpenStreetMap data.
        Please use this layer with caution.`,o=O(),s=D("p"),a=v("See "),_(u.$$.fragment),i=v(" and "),_(f.$$.fragment),l=v(" for details on methodology and data sources.")},m(p,$){m(p,e,$),m(p,r,$),m(p,n,$),m(p,o,$),m(p,s,$),T(s,a),w(u,s,null),T(s,i),w(f,s,null),T(s,l),c=!0},p(p,$){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),u.$set(y);const k={};$&2048&&(k.$$scope={dirty:$,ctx:p}),f.$set(k)},i(p){c||(d(u.$$.fragment,p),d(f.$$.fragment,p),c=!0)},o(p){g(u.$$.fragment,p),g(f.$$.fragment,p),c=!1},d(p){p&&(h(e),h(r),h(n),h(o),h(s)),b(u),b(f)}}}function lf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[af]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&2048&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Vr(t){let e,r,n,o,s,a,u,i;e=new Ke({props:{colorScale:t[3],limits:t[4]}});function f($){t[8]($)}let l={legend:"Trip purpose",id:"tripPurpose",choices:[["pct_commute","Commuting"],["pct_school","School"]],inlineSmall:!0};t[0]!==void 0&&(l.value=t[0]),n=new an({props:l}),H.push(()=>z(n,"value",f)),n.$on("change",t[6]);function c($){t[9]($)}let p={label:"Scenario",id:"scenario",choices:[["baseline","Baseline (2011)"],["gov_target","Government target (2025)"],["go_dutch","Go Dutch"]]};return t[1]!==void 0&&(p.value=t[1]),a=new Pt({props:p}),H.push(()=>z(a,"value",c)),a.$on("change",t[6]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),s=O(),_(a.$$.fragment)},m($,y){w(e,$,y),m($,r,y),w(n,$,y),m($,s,y),w(a,$,y),i=!0},p($,y){const k={};!o&&y&1&&(o=!0,k.value=$[0],V(()=>o=!1)),n.$set(k);const S={};!u&&y&2&&(u=!0,S.value=$[1],V(()=>u=!1)),a.$set(S)},i($){i||(d(e.$$.fragment,$),d(n.$$.fragment,$),d(a.$$.fragment,$),i=!0)},o($){g(e.$$.fragment,$),g(n.$$.fragment,$),g(a.$$.fragment,$),i=!1},d($){$&&(h(r),h(s)),b(e,$),b(n,$),b(a,$)}}}function ff(t){let e,r,n,o,s,a,u,i;function f(p){t[7](p)}let l={id:nt,$$slots:{right:[lf],default:[nf]},$$scope:{ctx:t}};t[2]!==void 0&&(l.checked=t[2]),e=new te({props:l}),H.push(()=>z(e,"checked",f));let c=t[2]&&Vr(t);return s=new J({props:{layer:nt,tooltip:t[5],show:t[2]&&t[0]==nt,clickable:!1}}),u=new J({props:{layer:Dt,tooltip:t[5],show:t[2]&&t[0]==Dt,clickable:!1}}),{c(){_(e.$$.fragment),n=O(),c&&c.c(),o=O(),_(s.$$.fragment),a=O(),_(u.$$.fragment)},m(p,$){w(e,p,$),m(p,n,$),c&&c.m(p,$),m(p,o,$),w(s,p,$),m(p,a,$),w(u,p,$),i=!0},p(p,[$]){const y={};$&2048&&(y.$$scope={dirty:$,ctx:p}),!r&&$&4&&(r=!0,y.checked=p[2],V(()=>r=!1)),e.$set(y),p[2]?c?(c.p(p,$),$&4&&d(c,1)):(c=Vr(p),c.c(),d(c,1),c.m(o.parentNode,o)):c&&(le(),g(c,1,1,()=>{c=null}),fe());const k={};$&5&&(k.show=p[2]&&p[0]==nt),s.$set(k);const S={};$&5&&(S.show=p[2]&&p[0]==Dt),u.$set(S)},i(p){i||(d(e.$$.fragment,p),d(c),d(s.$$.fragment,p),d(u.$$.fragment,p),i=!0)},o(p){g(e.$$.fragment,p),g(c),g(s.$$.fragment,p),g(u.$$.fragment,p),i=!1},d(p){p&&(h(n),h(o),h(a)),b(e,p),c&&c.d(p),b(s,p),b(u,p)}}}let nt="pct_commute",Dt="pct_school";function uf(t,e,r){let n;X(t,re,y=>r(10,n=y));let o=U.sequential_low_to_high,s=[0,50,100,500,1e3,2e3],a=nt,u="baseline";for(let y of[nt,Dt])ae(n,y,`https://atip.uk/layers/v1/${y}.pmtiles`),ge(n,{id:y,source:y,sourceLayer:y,color:Ve(["get",u],s,o),width:Ft,opacity:ue(.5,1)});let i=!1;function f(y){let k=y.properties.baseline,S=y.properties.gov_target,L=y.properties.go_dutch,E=`<h2>Trip purpose: ${a==nt?"commuting":"school"}</h2>`;if(E+=`<p>Baseline (2011): <b>${k.toLocaleString()}</b></p>`,k==0)E+=`<p>Government target (2025): <b>${S.toLocaleString()}</b></p>`,E+=`<p>Go Dutch: <b>${L.toLocaleString()}</b></p>`;else{let x=(S/k).toFixed(1),C=(L/k).toFixed(1);E+=`<p>Government target (2025): ${S.toLocaleString()} (<b>${x}x</b> of baseline)</p>`,E+=`<p>Go Dutch: ${L.toLocaleString()} (<b>${C}x</b> of baseline)</p>`}return E}function l(){n.setPaintProperty(a,"line-color",Ve(["get",u],s,o))}function c(y){i=y,r(2,i)}function p(y){a=y,r(0,a)}function $(y){u=y,r(1,u)}return[a,u,i,o,s,f,l,c,p,$]}class cf extends K{constructor(e){super(),q(this,e,uf,ff,Z,{})}}function pf(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Railway Stations`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function $f(t){let e;return{c(){e=v("railway station")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function mf(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function hf(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation",$$slots:{default:[$f]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[mf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(" data from OpenStreetMap (as of 9 August 2023)."),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),T(e,r),w(n,e,null),T(e,o),m(l,s,c),m(l,a,c),T(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&32&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(d(n.$$.fragment,l),d(i.$$.fragment,l),f=!0)},o(l){g(n.$$.fragment,l),g(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),b(n),b(i)}}}function df(t){let e,r,n;return r=new ne({props:{$$slots:{default:[hf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function gf(t){let e,r,n,o,s;function a(i){t[2](i)}let u={id:Qe,$$slots:{right:[df],default:[pf]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Qe,tooltip:_f,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}const Qe="railway_stations";function _f(t){return`<p>${t.properties.name??"Unnamed railway station"}</p>`}function wf(t,e,r){let n;X(t,re,i=>r(3,n=i));const o=`https://atip.uk/layers/v1/${Qe}.geojson`;let s=!1;sr(n,Qe,o);let a=U[Qe];ht(n,{id:Qe,source:Qe,color:a,radius:eo/2});function u(i){s=i,r(0,s)}return[s,a,u]}class bf extends K{constructor(e){super(),q(this,e,wf,gf,Z,{})}}function vf(t){let e;return{c(){e=v("OS Speeds")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function yf(t){let e;return{c(){e=v("Basemap")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function kf(t){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Sf(t){let e,r,n,o,s,a,u,i,f,l,c,p;return n=new B({props:{href:"https://basemap.co.uk/speed-data",$$slots:{default:[yf]},$$scope:{ctx:t}}}),l=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[kf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("The average speed data is collected over a six-month period by "),_(n.$$.fragment),o=v(` from 135,000 vehicle telematic systems and provided through
        Ordnance Survey. The averages are grouped by different time periods for weekdays
        and weekends. This map shows the highest average.`),s=O(),a=D("p"),a.textContent="Data valid as of 1 September, 2023",u=O(),i=D("p"),f=v(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(l.$$.fragment),c=v(".")},m($,y){m($,e,y),T(e,r),w(n,e,null),T(e,o),m($,s,y),m($,a,y),m($,u,y),m($,i,y),T(i,f),w(l,i,null),T(i,c),p=!0},p($,y){const k={};y&256&&(k.$$scope={dirty:y,ctx:$}),n.$set(k);const S={};y&256&&(S.$$scope={dirty:y,ctx:$}),l.$set(S)},i($){p||(d(n.$$.fragment,$),d(l.$$.fragment,$),p=!0)},o($){g(n.$$.fragment,$),g(l.$$.fragment,$),p=!1},d($){$&&(h(e),h(s),h(a),h(u),h(i)),b(n),b(l)}}}function Cf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Sf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&256&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Gr(t){let e,r,n,o,s;e=new Ke({props:{colorScale:t[2],limits:t[3]}});function a(i){t[6](i)}let u={legend:"Show speed types",id:"showSpeed",choices:[["indicative_mph","Posted speed limit"],["highest_mph","Highest measured average speed"]],inlineSmall:!0};return t[0]!==void 0&&(u.value=t[0]),n=new an({props:u}),H.push(()=>z(n,"value",a)),n.$on("change",t[4]),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(i,f){w(e,i,f),m(i,r,f),w(n,i,f),s=!0},p(i,f){const l={};!o&&f&1&&(o=!0,l.value=i[0],V(()=>o=!1)),n.$set(l)},i(i){s||(d(e.$$.fragment,i),d(n.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(n.$$.fragment,i),s=!1},d(i){i&&h(r),b(e,i),b(n,i)}}}function Lf(t){let e,r,n,o,s,a;function u(l){t[5](l)}let i={id:We,$$slots:{right:[Cf],default:[vf]},$$scope:{ctx:t}};t[1]!==void 0&&(i.checked=t[1]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[1]&&Gr(t);return s=new J({props:{layer:We,tooltip:Of,show:t[1],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&256&&(p.$$scope={dirty:c,ctx:l}),!r&&c&2&&(r=!0,p.checked=l[1],V(()=>r=!1)),e.$set(p),l[1]?f?(f.p(l,c),c&2&&d(f,1)):(f=Gr(l),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(le(),g(f,1,1,()=>{f=null}),fe());const $={};c&2&&($.show=l[1]),s.$set($)},i(l){a||(d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!0)},o(l){g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),b(e,l),f&&f.d(l),b(s,l)}}}let We="road_speeds";function Of(t){let e={mf4to7:"Monday-Friday 4-7am",mf7to9:"Monday-Friday 7-9am",mf9to12:"Monday-Friday 9am-12pm",mf12to14:"Monday-Friday 12-2pm",mf14to16:"Monday-Friday 2-4pm",mf16to19:"Monday-Friday 4-7pm",mf19to22:"Monday-Friday 7-10pm",mf22to4:"Monday-Friday 10pm-4am",ss4to7:"Saturday-Sunday 4-7am",ss7to10:"Saturday-Sunday 7-10am",ss10to14:"Saturday-Sunday 10am-2pm",ss14to19:"Saturday-Sunday 2-7pm",ss19to22:"Saturday-Sunday 7-10pm",ss22to4:"Saturday-Sunday 10pm-4am"}[t.properties.highest_description],r=`<p>Posted speed limit: ${t.properties.indicative_mph} mph</p>`;return r+=`<p>Highest average speed: ${t.properties.highest_mph} mph (during ${e})</p>`,r}function Tf(t,e,r){let n;X(t,re,c=>r(7,n=c));let o=U.sequential_low_to_high,s=[0,20,30,40,50,90],a="indicative_mph";ae(n,We,`https://atip.uk/private_layers/v1/${We}.pmtiles`),ge(n,{id:We,source:We,sourceLayer:We,color:Ve(["get",a],s,o),width:Ft,opacity:ue(.5,1)});let u=!1;function i(){n.setPaintProperty(We,"line-color",Ve(["get",a],s,o))}function f(c){u=c,r(1,u)}function l(c){a=c,r(0,a)}return[a,u,o,s,i,f,l]}class Af extends K{constructor(e){super(),q(this,e,Tf,Lf,Z,{})}}function Df(t){let e;return{c(){e=v("OS Road widths")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Ef(t){let e;return{c(){e=v(`Public Sector Geospatial Agreement
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pf(t){let e,r,n,o,s,a,u,i,f;return u=new B({props:{href:"https://www.ordnancesurvey.co.uk/documents/licensing/psga-member-licence.pdf",$$slots:{default:[Ef]},$$scope:{ctx:t}}}),{c(){e=D("p"),e.textContent=`This is average and minimum road carriageway width (in meters) from
        Ordnance Survey. The coloring shows the average width, and the line
        thickness has no meaning. Be careful interpreting the data near dual
        carriageways and crossing islands.`,r=O(),n=D("p"),n.textContent="Data valid as of 1 September, 2023",o=O(),s=D("p"),a=v(`License: Contains OS data © Crown copyright and database right
        2023. Made available under the `),_(u.$$.fragment),i=v(".")},m(l,c){m(l,e,c),m(l,r,c),m(l,n,c),m(l,o,c),m(l,s,c),T(s,a),w(u,s,null),T(s,i),f=!0},p(l,c){const p={};c&32&&(p.$$scope={dirty:c,ctx:l}),u.$set(p)},i(l){f||(d(u.$$.fragment,l),f=!0)},o(l){g(u.$$.fragment,l),f=!1},d(l){l&&(h(e),h(r),h(n),h(o),h(s)),b(u)}}}function Nf(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Pf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function Kr(t){let e,r;return e=new Ke({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function If(t){let e,r,n,o,s,a;function u(l){t[3](l)}let i={id:et,$$slots:{right:[Nf],default:[Df]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&Kr(t);return s=new J({props:{layer:et,tooltip:Mf,show:t[0],clickable:!1}}),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&32&&(p.$$scope={dirty:c,ctx:l}),!r&&c&1&&(r=!0,p.checked=l[0],V(()=>r=!1)),e.$set(p),l[0]?f?(f.p(l,c),c&1&&d(f,1)):(f=Kr(l),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(le(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=l[0]),s.$set($)},i(l){a||(d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!0)},o(l){g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),b(e,l),f&&f.d(l),b(s,l)}}}let et="road_widths";function Mf(t){let e=`<p>Average width: ${t.properties.average} meters</p>`;return e+=`<p>Minimum width: ${t.properties.minimum} meters</p>`,e}function xf(t,e,r){let n;X(t,re,i=>r(4,n=i));let o=U.sequential_low_to_high,s=[0,5,10,15,20,100];ae(n,et,`https://atip.uk/private_layers/v1/${et}.pmtiles`),ge(n,{id:et,source:et,sourceLayer:et,color:Ve(["get","average"],s,o),width:Ft,opacity:ue(.5,1)});let a=!1;function u(i){a=i,r(0,a)}return[a,o,s,u]}class Ff extends K{constructor(e){super(),q(this,e,xf,If,Z,{})}}function Bf(t){let e;return{c(){e=v("primary and secondary schools")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function jf(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Rf(t){let e,r,n,o,s,a,u,i,f;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[Bf]},$$scope:{ctx:t}}}),i=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[jf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(` from OpenStreetMap (as of 9 August 2023). It doesn't include
    kindergartens, colleges, universities, or other training schools.`),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment)},m(l,c){m(l,e,c),T(e,r),w(n,e,null),T(e,o),m(l,s,c),m(l,a,c),T(a,u),w(i,a,null),f=!0},p(l,c){const p={};c&1&&(p.$$scope={dirty:c,ctx:l}),n.$set(p);const $={};c&1&&($.$$scope={dirty:c,ctx:l}),i.$set($)},i(l){f||(d(n.$$.fragment,l),d(i.$$.fragment,l),f=!0)},o(l){g(n.$$.fragment,l),g(i.$$.fragment,l),f=!1},d(l){l&&(h(e),h(s),h(a)),b(n),b(i)}}}function Uf(t){let e,r;return e=new ar({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[Rf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class Hf extends K{constructor(e){super(),q(this,e,null,Uf,Z,{})}}function Wf(t){let e;return{c(){e=v("sports pitches")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function zf(t){let e;return{c(){e=v("sports centres")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Vf(t){let e;return{c(){e=v("Open Data Commons Open Database License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Gf(t){let e,r,n,o,s,a,u,i,f,l,c;return n=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dpitch",$$slots:{default:[Wf]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:leisure%3Dsports_centre",$$slots:{default:[zf]},$$scope:{ctx:t}}}),l=new B({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Vf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("This shows "),_(n.$$.fragment),o=v(" and "),_(s.$$.fragment),a=v(" data from OpenStreetMap (as of 9 August 2023)."),u=O(),i=D("p"),f=v("License: "),_(l.$$.fragment)},m(p,$){m(p,e,$),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,a),m(p,u,$),m(p,i,$),T(i,f),w(l,i,null),c=!0},p(p,$){const y={};$&1&&(y.$$scope={dirty:$,ctx:p}),n.$set(y);const k={};$&1&&(k.$$scope={dirty:$,ctx:p}),s.$set(k);const S={};$&1&&(S.$$scope={dirty:$,ctx:p}),l.$set(S)},i(p){c||(d(n.$$.fragment,p),d(s.$$.fragment,p),d(l.$$.fragment,p),c=!0)},o(p){g(n.$$.fragment,p),g(s.$$.fragment,p),g(l.$$.fragment,p),c=!1},d(p){p&&(h(e),h(u),h(i)),b(n),b(s),b(l)}}}function Kf(t){let e,r;return e=new ar({props:{name:"sports_spaces",singularNoun:"sports space",pluralNoun:"Sports spaces",$$slots:{default:[Gf]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}class qf extends K{constructor(e){super(),q(this,e,null,Kf,Z,{})}}function Zf(t){let e;return{c(){e=v("Vehicle counts")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Xf(t){let e;return{c(){e=v(`DfT road statistics
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Yf(t){let e;return{c(){e=v("methodology")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Jf(t){let e;return{c(){e=v("Open Government License")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Qf(t){let e,r,n,o,s,a,u,i,f,l,c,p,$;return n=new B({props:{href:"https://roadtraffic.dft.gov.uk/downloads",$$slots:{default:[Xf]},$$scope:{ctx:t}}}),s=new B({props:{href:"https://storage.googleapis.com/dft-statistics/road-traffic/all-traffic-data-metadata.pdf",$$slots:{default:[Yf]},$$scope:{ctx:t}}}),p=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Jf]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("2022 AADF (annual average daily flow) data from "),_(n.$$.fragment),o=v(`. This counts the total daily number of vehicles
        traveling past a count point (in both directions) on an average day of
        the year. See `),_(s.$$.fragment),a=v(" for details and caveats about the measurements."),u=O(),i=D("p"),i.textContent=`The colors show motor vehicles AADF, not pedal cycles. Click a point for
        full data.`,f=O(),l=D("p"),c=v("License: "),_(p.$$.fragment)},m(y,k){m(y,e,k),T(e,r),w(n,e,null),T(e,o),w(s,e,null),T(e,a),m(y,u,k),m(y,i,k),m(y,f,k),m(y,l,k),T(l,c),w(p,l,null),$=!0},p(y,k){const S={};k&64&&(S.$$scope={dirty:k,ctx:y}),n.$set(S);const L={};k&64&&(L.$$scope={dirty:k,ctx:y}),s.$set(L);const E={};k&64&&(E.$$scope={dirty:k,ctx:y}),p.$set(E)},i(y){$||(d(n.$$.fragment,y),d(s.$$.fragment,y),d(p.$$.fragment,y),$=!0)},o(y){g(n.$$.fragment,y),g(s.$$.fragment,y),g(p.$$.fragment,y),$=!1},d(y){y&&(h(e),h(u),h(i),h(f),h(l)),b(n),b(s),b(p)}}}function eu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[Qf]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&64&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function qr(t){let e,r;return e=new Ke({props:{colorScale:t[1],limits:t[2]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function tu(t){let e,r,n,o,s,a;function u(l){t[3](l)}let i={id:tt,$$slots:{right:[eu],default:[Zf]},$$scope:{ctx:t}};t[0]!==void 0&&(i.checked=t[0]),e=new te({props:i}),H.push(()=>z(e,"checked",u));let f=t[0]&&qr(t);return s=new J({props:{layer:tt,tooltip:ru,show:t[0],clickable:!0}}),s.$on("click",nu),{c(){_(e.$$.fragment),n=O(),f&&f.c(),o=O(),_(s.$$.fragment)},m(l,c){w(e,l,c),m(l,n,c),f&&f.m(l,c),m(l,o,c),w(s,l,c),a=!0},p(l,[c]){const p={};c&64&&(p.$$scope={dirty:c,ctx:l}),!r&&c&1&&(r=!0,p.checked=l[0],V(()=>r=!1)),e.$set(p),l[0]?f?(f.p(l,c),c&1&&d(f,1)):(f=qr(l),f.c(),d(f,1),f.m(o.parentNode,o)):f&&(le(),g(f,1,1,()=>{f=null}),fe());const $={};c&1&&($.show=l[0]),s.$set($)},i(l){a||(d(e.$$.fragment,l),d(f),d(s.$$.fragment,l),a=!0)},o(l){g(e.$$.fragment,l),g(f),g(s.$$.fragment,l),a=!1},d(l){l&&(h(n),h(o)),b(e,l),f&&f.d(l),b(s,l)}}}let tt="vehicle_counts";function ru(t){let e=`<h2>${t.properties.location}</h2>`;return e+=`<p>Total motor vehicles (2022 AADF): <b>${t.properties.motor_vehicles_2022.toLocaleString()}</b></p>`,e+=`<p>Total pedal cycles (2022 AADF): <b>${t.properties.pedal_cycles_2022.toLocaleString()}</b></p>`,e+=`<p>Count method: <b>${t.properties.method}</b></p>`,e}function nu(t){window.open(`https://roadtraffic.dft.gov.uk/manualcountpoints/${t.detail.properties.count_point}`,"_blank")}function ou(t,e,r){let n;X(t,re,f=>r(4,n=f));let o=U.sequential_low_to_high,s=[0,4e4,8e4,12e4,16e4,205e3],a=["","40k","80k","120k","160k",""];ae(n,tt,`https://atip.uk/layers/v1/${tt}.pmtiles`),ht(n,{id:tt,source:tt,sourceLayer:tt,color:Ve(["get","motor_vehicles_2022"],s,o),opacity:.9,radius:["interpolate",["linear"],["zoom"],1,2,8,3,13,15],strokeColor:"black",strokeWidth:.1});let u=!1;function i(f){u=f,r(0,u)}return[u,o,a,i]}class su extends K{constructor(e){super(),q(this,e,ou,tu,Z,{})}}function iu(t){let e,r,n;return e=new _e({props:{color:t[1]}}),{c(){_(e.$$.fragment),r=v(`
  Wards`)},m(o,s){w(e,o,s),m(o,r,s),n=!0},p:Q,i(o){n||(d(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){o&&h(r),b(e,o)}}}function au(t){let e;return{c(){e=v(`ONS Geography
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function lu(t){let e;return{c(){e=v(`Open Government License
        `)},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function fu(t){let e,r,n,o,s,a,u,i,f,l;return n=new B({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[au]},$$scope:{ctx:t}}}),i=new B({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[lu]},$$scope:{ctx:t}}}),{c(){e=D("p"),r=v("Data from "),_(n.$$.fragment),o=v(", as of May 2023."),s=O(),a=D("p"),u=v("License: "),_(i.$$.fragment),f=v(`. Contains OS data © Crown copyright and database
        right 2023.`)},m(c,p){m(c,e,p),T(e,r),w(n,e,null),T(e,o),m(c,s,p),m(c,a,p),T(a,u),w(i,a,null),T(a,f),l=!0},p(c,p){const $={};p&32&&($.$$scope={dirty:p,ctx:c}),n.$set($);const y={};p&32&&(y.$$scope={dirty:p,ctx:c}),i.$set(y)},i(c){l||(d(n.$$.fragment,c),d(i.$$.fragment,c),l=!0)},o(c){g(n.$$.fragment,c),g(i.$$.fragment,c),l=!1},d(c){c&&(h(e),h(s),h(a)),b(n),b(i)}}}function uu(t){let e,r,n;return r=new ne({props:{$$slots:{default:[fu]},$$scope:{ctx:t}}}),{c(){e=D("span"),_(r.$$.fragment),G(e,"slot","right")},m(o,s){m(o,e,s),w(r,e,null),n=!0},p(o,s){const a={};s&32&&(a.$$scope={dirty:s,ctx:o}),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){g(r.$$.fragment,o),n=!1},d(o){o&&h(e),b(r)}}}function cu(t){let e,r,n,o,s;function a(i){t[3](i)}let u={id:Ee,$$slots:{right:[uu],default:[iu]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.checked=t[0]),e=new te({props:u}),H.push(()=>z(e,"checked",a)),o=new J({props:{layer:Ee,tooltip:pu,show:t[0],clickable:!0}}),o.$on("click",$u),{c(){_(e.$$.fragment),n=O(),_(o.$$.fragment)},m(i,f){w(e,i,f),m(i,n,f),w(o,i,f),s=!0},p(i,[f]){const l={};f&32&&(l.$$scope={dirty:f,ctx:i}),!r&&f&1&&(r=!0,l.checked=i[0],V(()=>r=!1)),e.$set(l);const c={};f&1&&(c.show=i[0]),o.$set(c)},i(i){s||(d(e.$$.fragment,i),d(o.$$.fragment,i),s=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),s=!1},d(i){i&&h(n),b(e,i),b(o,i)}}}let Ee="wards";function pu(t){return`<p>${t.properties.name}</p>`}function $u(t){let e=encodeURIComponent(t.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function mu(t,e,r){let n;X(t,re,i=>r(2,n=i));let o=U.wards,s=`${Ee}-outline`;ae(n,Ee,`https://atip.uk/layers/v1/${Ee}.pmtiles`),Ge(n,{id:Ee,source:Ee,sourceLayer:Ee,color:o,opacity:ue(.5,0)}),ge(n,{id:s,source:Ee,sourceLayer:Ee,color:o,width:2.5});let a=!1;function u(i){a=i,r(0,a)}return t.$$.update=()=>{t.$$.dirty&5&&n.getLayer(s)&&n.setLayoutProperty(s,"visibility",a?"visible":"none")},[a,o,n,u]}class hu extends K{constructor(e){super(),q(this,e,mu,cu,Z,{})}}function du(t){let e,r,n,o,s,a,u,i;return e=new Hf({}),n=new ol({}),s=new qf({}),u=new bf({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),a=O(),_(u.$$.fragment)},m(f,l){w(e,f,l),m(f,r,l),w(n,f,l),m(f,o,l),w(s,f,l),m(f,a,l),w(u,f,l),i=!0},i(f){i||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(s.$$.fragment,f),d(u.$$.fragment,f),i=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(s.$$.fragment,f),g(u.$$.fragment,f),i=!1},d(f){f&&(h(r),h(o),h(a)),b(e,f),b(n,f),b(s,f),b(u,f)}}}function gu(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[du]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function _u(t){let e,r,n,o,s,a,u,i,f,l;return e=new qa({}),n=new Gl({}),s=new Ni({}),u=new ja({}),f=new Da({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),a=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,a,p),w(u,c,p),m(c,i,p),w(f,c,p),l=!0},i(c){l||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),l=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),l=!1},d(c){c&&(h(r),h(o),h(a),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function wu(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[_u]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function bu(t){let e,r,n,o,s,a,u,i,f,l;return e=new rf({}),n=new hu({}),s=new $a({}),u=new Sl({}),f=new Fl({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),a=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment)},m(c,p){w(e,c,p),m(c,r,p),w(n,c,p),m(c,o,p),w(s,c,p),m(c,a,p),w(u,c,p),m(c,i,p),w(f,c,p),l=!0},i(c){l||(d(e.$$.fragment,c),d(n.$$.fragment,c),d(s.$$.fragment,c),d(u.$$.fragment,c),d(f.$$.fragment,c),l=!0)},o(c){g(e.$$.fragment,c),g(n.$$.fragment,c),g(s.$$.fragment,c),g(u.$$.fragment,c),g(f.$$.fragment,c),l=!1},d(c){c&&(h(r),h(o),h(a),h(i)),b(e,c),b(n,c),b(s,c),b(u,c),b(f,c)}}}function vu(t){let e,r;return e=new St({props:{small:!0,$$slots:{default:[bu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function yu(t){let e,r,n,o;return e=new na({}),n=new ml({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function ku(t){let e,r,n,o;return e=new Ff({}),n=new Af({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment)},m(s,a){w(e,s,a),m(s,r,a),w(n,s,a),o=!0},i(s){o||(d(e.$$.fragment,s),d(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){s&&h(r),b(e,s),b(n,s)}}}function Su(t){let e,r,n,o,s=nr()=="Private (development)",a,u;e=new su({}),n=new cf({});let i=s&&ku();return{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),i&&i.c(),a=xt()},m(f,l){w(e,f,l),m(f,r,l),w(n,f,l),m(f,o,l),i&&i.m(f,l),m(f,a,l),u=!0},p:Q,i(f){u||(d(e.$$.fragment,f),d(n.$$.fragment,f),d(i),u=!0)},o(f){g(e.$$.fragment,f),g(n.$$.fragment,f),g(i),u=!1},d(f){f&&(h(r),h(o),h(a)),b(e,f),b(n,f),i&&i.d(f)}}}function Cu(t){let e,r,n,o,s,a,u,i,f,l,c,p,$,y,k,S,L;e=new va({}),n=new xe({props:{label:"Trip generators",$$slots:{default:[gu]},$$scope:{ctx:t}}}),s=new xe({props:{label:"Existing infrastructure",$$slots:{default:[wu]},$$scope:{ctx:t}}}),u=new xe({props:{label:"Boundaries",$$slots:{default:[vu]},$$scope:{ctx:t}}}),f=new xe({props:{label:"Census",$$slots:{default:[yu]},$$scope:{ctx:t}}}),c=new xe({props:{label:"Other",$$slots:{default:[Su]},$$scope:{ctx:t}}});function E(C){t[4](C)}let x={displayEnableButton:!0};return t[1]!==void 0&&(x.isInactive=t[1]),$=new to({props:x}),t[3]($),H.push(()=>z($,"isInactive",E)),S=new ro({props:{disabled:!t[1]}}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),a=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),l=O(),_(c.$$.fragment),p=O(),_($.$$.fragment),k=O(),_(S.$$.fragment)},m(C,A){w(e,C,A),m(C,r,A),w(n,C,A),m(C,o,A),w(s,C,A),m(C,a,A),w(u,C,A),m(C,i,A),w(f,C,A),m(C,l,A),w(c,C,A),m(C,p,A),w($,C,A),m(C,k,A),w(S,C,A),L=!0},p(C,A){const F={};A&32&&(F.$$scope={dirty:A,ctx:C}),n.$set(F);const M={};A&32&&(M.$$scope={dirty:A,ctx:C}),s.$set(M);const P={};A&32&&(P.$$scope={dirty:A,ctx:C}),u.$set(P);const N={};A&32&&(N.$$scope={dirty:A,ctx:C}),f.$set(N);const I={};A&32&&(I.$$scope={dirty:A,ctx:C}),c.$set(I);const j={};!y&&A&2&&(y=!0,j.isInactive=C[1],V(()=>y=!1)),$.$set(j);const ee={};A&2&&(ee.disabled=!C[1]),S.$set(ee)},i(C){L||(d(e.$$.fragment,C),d(n.$$.fragment,C),d(s.$$.fragment,C),d(u.$$.fragment,C),d(f.$$.fragment,C),d(c.$$.fragment,C),d($.$$.fragment,C),d(S.$$.fragment,C),L=!0)},o(C){g(e.$$.fragment,C),g(n.$$.fragment,C),g(s.$$.fragment,C),g(u.$$.fragment,C),g(f.$$.fragment,C),g(c.$$.fragment,C),g($.$$.fragment,C),g(S.$$.fragment,C),L=!1},d(C){C&&(h(r),h(o),h(a),h(i),h(l),h(p),h(k)),b(e,C),b(n,C),b(s,C),b(u,C),b(f,C),b(c,C),t[3](null),b($,C),b(S,C)}}}function Lu(t){let e,r,n,o;return e=new xe({props:{label:"Layers",open:!0,$$slots:{default:[Cu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(s,a){w(e,s,a),r=!0,n||(o=or(window,"keydown",t[2]),n=!0)},p(s,[a]){const u={};a&35&&(u.$$scope={dirty:a,ctx:s}),e.$set(u)},i(s){r||(d(e.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),r=!1},d(s){b(e,s),n=!1,o()}}}function Ou(t,e,r){let n;X(t,$r,i=>r(1,n=i));let o;function s(i){!n&&i.key=="Escape"&&(o.disableStreetView(),i.preventDefault())}function a(i){H[i?"unshift":"push"](()=>{o=i,r(0,o)})}function u(i){n=i,$r.set(n)}return[o,n,s,a,u]}class Tu extends K{constructor(e){super(),q(this,e,Ou,Lu,Z,{})}}function Au(t,e,r){let{loadFile:n}=e;return Mt(async()=>{let s=await(await fetch("https://atip.uk/random_schemes.geojson")).text();n(s)}),t.$$set=o=>{"loadFile"in o&&r(0,n=o.loadFile)},[n]}class Du extends K{constructor(e){super(),q(this,e,Au,null,Z,{loadFile:0})}}function Eu(t){let e;return{c(){e=v("Show on map")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Pu(t){let e;return{c(){e=v("Edit scheme locally")},m(r,n){m(r,e,n)},d(r){r&&h(e)}}}function Nu(t){let e,r,n=t[0].authority_or_region+"",o,s,a,u,i=t[0].capital_scheme_id+"",f,l,c,p,$=t[0].funding_programme+"",y,k,S,L,E,x,C;return L=new Kt({props:{$$slots:{default:[Eu]},$$scope:{ctx:t}}}),L.$on("click",t[3]),x=new Kt({props:{disabled:t[1],title:t[2],$$slots:{default:[Pu]},$$scope:{ctx:t}}}),x.$on("click",t[4]),{c(){e=D("p"),r=v("Authority or region: "),o=v(n),s=O(),a=D("p"),u=v("Capital scheme ID: "),f=v(i),l=O(),c=D("p"),p=v("Funding programme: "),y=v($),k=O(),S=D("div"),_(L.$$.fragment),E=O(),_(x.$$.fragment),G(S,"class","govuk-button-group")},m(A,F){m(A,e,F),T(e,r),T(e,o),m(A,s,F),m(A,a,F),T(a,u),T(a,f),m(A,l,F),m(A,c,F),T(c,p),T(c,y),m(A,k,F),m(A,S,F),w(L,S,null),T(S,E),w(x,S,null),C=!0},p(A,F){(!C||F&1)&&n!==(n=A[0].authority_or_region+"")&&Le(o,n),(!C||F&1)&&i!==(i=A[0].capital_scheme_id+"")&&Le(f,i),(!C||F&1)&&$!==($=A[0].funding_programme+"")&&Le(y,$);const M={};F&256&&(M.$$scope={dirty:F,ctx:A}),L.$set(M);const P={};F&256&&(P.$$scope={dirty:F,ctx:A}),x.$set(P)},i(A){C||(d(L.$$.fragment,A),d(x.$$.fragment,A),C=!0)},o(A){g(L.$$.fragment,A),g(x.$$.fragment,A),C=!1},d(A){A&&(h(e),h(s),h(a),h(l),h(c),h(k),h(S)),b(L),b(x)}}}function Iu(t){let e,r;return e=new xe({props:{label:`${t[0].scheme_reference}: ${t[0].num_features} features`,$$slots:{default:[Nu]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&1&&(s.label=`${n[0].scheme_reference}: ${n[0].num_features} features`),o&257&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Mu(t,e,r){let n,o;X(t,mt,c=>r(6,n=c)),X(t,re,c=>r(7,o=c));let{scheme:s}=e,{authorityNames:a}=e,u=!a.has(s.authority_or_region),i=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function f(){let c={type:"FeatureCollection",features:n.features.filter(p=>p.properties.scheme_reference==s.scheme_reference)};o==null||o.fitBounds(Kn(c),{padding:20,animate:!1})}function l(){let c={type:"FeatureCollection",features:n.features.filter($=>$.properties.scheme_reference==s.scheme_reference)},p=s.authority_or_region;window.localStorage.setItem(p,JSON.stringify(c)),window.open(`scheme.html?authority=${s.authority_or_region}`,"_blank")}return t.$$set=c=>{"scheme"in c&&r(0,s=c.scheme),"authorityNames"in c&&r(5,a=c.authorityNames)},[s,u,i,f,l,a]}class xu extends K{constructor(e){super(),q(this,e,Mu,Iu,Z,{scheme:0,authorityNames:5})}}const Fu=["Adur","Allerdale","Amber Valley","Arun","Ashfield","Ashford","Babergh","Barking and Dagenham","Barnet","Barnsley","Barrow-in-Furness","Basildon","Basingstoke and Deane","Bassetlaw","Bath and North East Somerset","Bedford","Bexley","Birmingham","Blaby","Blackburn with Darwen","Blackpool","Bolsover","Bolton","Boston","Bournemouth, Christchurch and Poole","Bracknell Forest","Bradford","Braintree","Breckland","Brent","Brentwood","Brighton and Hove","Bristol, City of","Broadland","Bromley","Bromsgrove","Broxbourne","Broxtowe","Buckinghamshire","Burnley","Bury","Calderdale","Cambridge","Cambridgeshire and Peterborough Combined Authority","Camden","Cannock Chase","Canterbury","Carlisle","Castle Point","Central Bedfordshire","Charnwood","Chelmsford","Cheltenham","Cherwell","Cheshire East","Cheshire West and Chester","Chesterfield","Chichester","Chorley","City of London","Colchester","Copeland","Cornwall","Cotswold","County Durham","Coventry","Craven","Crawley","Croydon","Cumbria","Dacorum","Darlington","Dartford","Derby","Derbyshire","Derbyshire Dales","Devon","Doncaster","Dorset","Dover","Dudley","Ealing","Eastbourne","East Cambridgeshire","East Devon","East Hampshire","East Hertfordshire","Eastleigh","East Lindsey","East Riding of Yorkshire","East Staffordshire","East Suffolk","East Sussex","Eden","Elmbridge","Enfield","Epping Forest","Epsom and Ewell","Erewash","Essex","Exeter","Fareham","Fenland","Folkestone and Hythe","Forest of Dean","Fylde","Gateshead","Gedling","Gloucester","Gloucestershire","Gosport","Gravesham","Greater London","Greater Manchester Combined Authority","Great Yarmouth","Greenwich","Guildford","Hackney","Halton","Hambleton","Hammersmith and Fulham","Hampshire","Harborough","Haringey","Harlow","Harrogate","Harrow","Hart","Hartlepool","Hastings","Havant","Havering","Herefordshire","Herefordshire, County of","Hertfordshire","Hertsmere","High Peak","Hillingdon","Hinckley and Bosworth","Horsham","Hounslow","Huntingdonshire","Hyndburn","Ipswich","Isle of Wight","Isles of Scilly","Islington","Kensington and Chelsea","Kent","King's Lynn and West Norfolk","Kingston upon Hull","Kingston upon Hull, City of","Kingston upon Thames","Kirklees","Knowsley","Lambeth","Lancashire","Lancaster","Leeds","Leicester","Leicestershire","Lewes","Lewisham","Lichfield","Lincoln","Lincolnshire","Liverpool","Liverpool City Region Combined Authority","Luton","Maidstone","Maldon","Malvern Hills","Manchester","Mansfield","Medway","Melton","Mendip","Merton","Mid Devon","Middlesbrough","Mid Suffolk","Mid Sussex","Milton Keynes","Mole Valley","Newark and Sherwood","Newcastle-under-Lyme","Newcastle upon Tyne","New Forest","Newham","Norfolk","North Devon","North East Derbyshire","North East Joint Transport Committee","North East Lincolnshire","North Hertfordshire","North Kesteven","North Lincolnshire","North Norfolk","North Northamptonshire","North Somerset","North Tyneside","Northumberland","North Warwickshire","North West Leicestershire","North Yorkshire","Norwich","Nottingham","Nottinghamshire","Nuneaton and Bedworth","Oadby and Wigston","Oldham","Oxford","Oxfordshire","Pendle","Peterborough","Plymouth","Portsmouth","Preston","Reading","Redbridge","Redcar and Cleveland","Redditch","Reigate and Banstead","Ribble Valley","Richmondshire","Richmond upon Thames","Rochdale","Rochford","Rossendale","Rother","Rotherham","Rugby","Runnymede","Rushcliffe","Rushmoor","Rutland","Ryedale","Salford","Sandwell","Scarborough","Sedgemoor","Sefton","Selby","Sevenoaks","Sheffield","Sheffield City Region Combined Authority","Shropshire","Slough","Solihull","Somerset","Somerset West and Taunton","Southampton","South Cambridgeshire","South Derbyshire","Southend-on-Sea","South Gloucestershire","South Hams","South Holland","South Kesteven","South Lakeland","South Norfolk","South Oxfordshire","South Ribble","South Somerset","South Staffordshire","South Tyneside","Southwark","Spelthorne","Stafford","Staffordshire","Staffordshire Moorlands","St Albans","Stevenage","St. Helens","Stockport","Stockton-on-Tees","Stoke-on-Trent","Stratford-on-Avon","Stroud","Suffolk","Sunderland","Surrey","Surrey Heath","Sutton","Swale","Swindon","Tameside","Tamworth","Tandridge","Tees Valley Combined Authority","Teignbridge","Telford and Wrekin","Tendring","Test Valley","Tewkesbury","Thanet","Three Rivers","Thurrock","Tonbridge and Malling","Torbay","Torridge","Tower Hamlets","Trafford","Tunbridge Wells","Uttlesford","Vale of White Horse","Wakefield","Walsall","Waltham Forest","Wandsworth","Warrington","Warwick","Warwickshire","Watford","Waverley","Wealden","Welwyn Hatfield","West Berkshire","West Devon","West Lancashire","West Lindsey","West Midlands ITA","Westminster","West Northamptonshire","West of England Combined Authority","West Oxfordshire","West Suffolk","West Sussex","West Yorkshire Combined Authority","Wigan","Wiltshire","Winchester","Windsor and Maidenhead","Wirral","Woking","Wokingham","Wolverhampton","Worcester","Worcestershire","Worthing","Wychavon","Wyre","Wyre Forest","York"];var ie=(t,e,r)=>new Promise((n,o)=>{var s=i=>{try{u(r.next(i))}catch(f){o(f)}},a=i=>{try{u(r.throw(i))}catch(f){o(f)}},u=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,a);u((r=r.apply(t,e)).next())}),de=Uint8Array,pt=Uint16Array,Bu=Int32Array,On=new de([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tn=new de([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ju=new de([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),An=function(t,e){for(var r=new pt(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var o=new Bu(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return{b:r,r:o}},Dn=An(On,2),En=Dn.b,Ru=Dn.r;En[28]=258,Ru[258]=28;var Uu=An(Tn,0),Hu=Uu.b,tr=new pt(32768);for(W=0;W<32768;++W)Me=(W&43690)>>1|(W&21845)<<1,Me=(Me&52428)>>2|(Me&13107)<<2,Me=(Me&61680)>>4|(Me&3855)<<4,tr[W]=((Me&65280)>>8|(Me&255)<<8)>>1;var Me,W,vt=function(t,e,r){for(var n=t.length,o=0,s=new pt(e);o<n;++o)t[o]&&++s[t[o]-1];var a=new pt(e);for(o=1;o<e;++o)a[o]=a[o-1]+s[o-1]<<1;var u;if(r){u=new pt(1<<e);var i=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],l=e-t[o],c=a[t[o]-1]++<<l,p=c|(1<<l)-1;c<=p;++c)u[tr[c]>>i]=f}else for(u=new pt(n),o=0;o<n;++o)t[o]&&(u[o]=tr[a[t[o]-1]++]>>15-t[o]);return u},Ot=new de(288);for(W=0;W<144;++W)Ot[W]=8;var W;for(W=144;W<256;++W)Ot[W]=9;var W;for(W=256;W<280;++W)Ot[W]=7;var W;for(W=280;W<288;++W)Ot[W]=8;var W,Pn=new de(32);for(W=0;W<32;++W)Pn[W]=5;var W,Wu=vt(Ot,9,1),zu=vt(Pn,5,1),Vt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ye=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Gt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Vu=function(t){return(t+7)/8|0},Gu=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new de(r-e);return n.set(t.subarray(e,r)),n},Ku=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$e=function(t,e,r){var n=new Error(e||Ku[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,$e),!r)throw n;return n},lr=function(t,e,r,n){var o=t.length,s=n?n.length:0;if(!o||e.f&&!e.l)return r||new de(0);var a=!r||e.i!=2,u=e.i;r||(r=new de(o*3));var i=function(fr){var ur=r.length;if(fr>ur){var cr=new de(Math.max(ur*2,fr));cr.set(r),r=cr}},f=e.f||0,l=e.p||0,c=e.b||0,p=e.l,$=e.d,y=e.m,k=e.n,S=o*8;do{if(!p){f=ye(t,l,1);var L=ye(t,l+1,3);if(l+=3,L)if(L==1)p=Wu,$=zu,y=9,k=5;else if(L==2){var A=ye(t,l,31)+257,F=ye(t,l+10,15)+4,M=A+ye(t,l+5,31)+1;l+=14;for(var P=new de(M),N=new de(19),I=0;I<F;++I)N[ju[I]]=ye(t,l+I*3,7);l+=F*3;for(var j=Vt(N),ee=(1<<j)-1,R=vt(N,j,1),I=0;I<M;){var ce=R[ye(t,l,ee)];l+=ce&15;var E=ce>>4;if(E<16)P[I++]=E;else{var we=0,oe=0;for(E==16?(oe=3+ye(t,l,3),l+=2,we=P[I-1]):E==17?(oe=3+ye(t,l,7),l+=3):E==18&&(oe=11+ye(t,l,127),l+=7);oe--;)P[I++]=we}}var qe=P.subarray(0,A),pe=P.subarray(A);y=Vt(qe),k=Vt(pe),p=vt(qe,y,1),$=vt(pe,k,1)}else $e(1);else{var E=Vu(l)+4,x=t[E-4]|t[E-3]<<8,C=E+x;if(C>o){u&&$e(0);break}a&&i(c+x),r.set(t.subarray(E,C),c),e.b=c+=x,e.p=l=C*8,e.f=f;continue}if(l>S){u&&$e(0);break}}a&&i(c+131072);for(var dt=(1<<y)-1,Be=(1<<k)-1,st=l;;st=l){var we=p[Gt(t,l)&dt],be=we>>4;if(l+=we&15,l>S){u&&$e(0);break}if(we||$e(2),be<256)r[c++]=be;else if(be==256){st=l,p=null;break}else{var it=be-254;if(be>264){var I=be-257,Ie=On[I];it=ye(t,l,(1<<Ie)-1)+En[I],l+=Ie}var at=$[Gt(t,l)&Be],lt=at>>4;at||$e(3),l+=at&15;var pe=Hu[lt];if(lt>3){var Ie=Tn[lt];pe+=Gt(t,l)&(1<<Ie)-1,l+=Ie}if(l>S){u&&$e(0);break}a&&i(c+131072);var ft=c+it;if(c<pe){var gt=s-pe,Rn=Math.min(pe,ft);for(gt+c<0&&$e(3);c<Rn;++c)r[c]=n[gt+c]}for(;c<ft;c+=4)r[c]=r[c-pe],r[c+1]=r[c+1-pe],r[c+2]=r[c+2-pe],r[c+3]=r[c+3-pe];c=ft}}e.l=p,e.p=st,e.b=c,e.f=f,p&&(f=1,e.m=y,e.d=$,e.n=k)}while(!f);return c==r.length?r:Gu(r,0,c)},qu=new de(0),Zu=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&$e(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(e&2)},Xu=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Yu=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&$e(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&$e(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Ju(t,e){return lr(t,{i:2},e&&e.out,e&&e.dictionary)}function Qu(t,e){var r=Zu(t);return r+8>t.length&&$e(6,"invalid gzip data"),lr(t.subarray(r,-8),{i:2},e&&e.out||new de(Xu(t)),e&&e.dictionary)}function ec(t,e){return lr(t.subarray(Yu(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function rr(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Qu(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Ju(t,e):ec(t,e)}var tc=typeof TextDecoder<"u"&&new TextDecoder,rc=0;try{tc.decode(qu,{stream:!0}),rc=1}catch{}var Nn=(t,e)=>t*Math.pow(2,e),_t=(t,e)=>Math.floor(t/Math.pow(2,e)),It=(t,e)=>Nn(t.getUint16(e+1,!0),8)+t.getUint8(e),In=(t,e)=>Nn(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),nc=(t,e,r,n,o)=>{if(t!=n.getUint8(o))return t-n.getUint8(o);const s=It(n,o+1);if(e!=s)return e-s;const a=It(n,o+4);return r!=a?r-a:0},oc=(t,e,r,n)=>{const o=Mn(t,e|128,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!0}:null},Zr=(t,e,r,n)=>{const o=Mn(t,e,r,n);return o?{z:e,x:r,y:n,offset:o[0],length:o[1],is_dir:!1}:null},Mn=(t,e,r,n)=>{let o=0,s=t.byteLength/17-1;for(;o<=s;){const a=s+o>>1,u=nc(e,r,n,t,a*17);if(u>0)o=a+1;else if(u<0)s=a-1;else return[In(t,a*17+7),t.getUint32(a*17+13,!0)]}return null},sc=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,xn=(t,e)=>{const r=t.getUint8(e*17);return{z:r&127,x:It(t,e*17+1),y:It(t,e*17+4),offset:In(t,e*17+7),length:t.getUint32(e*17+13,!0),is_dir:r>>7===1}},Xr=t=>{const e=[],r=new DataView(t);for(let n=0;n<r.byteLength/17;n++)e.push(xn(r,n));return ic(e)},ic=t=>{t.sort(sc);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++){const o=t[n];let s=o.z;o.is_dir&&(s=s|128),r[n*17]=s,r[n*17+1]=o.x&255,r[n*17+2]=o.x>>8&255,r[n*17+3]=o.x>>16&255,r[n*17+4]=o.y&255,r[n*17+5]=o.y>>8&255,r[n*17+6]=o.y>>16&255,r[n*17+7]=o.offset&255,r[n*17+8]=_t(o.offset,8)&255,r[n*17+9]=_t(o.offset,16)&255,r[n*17+10]=_t(o.offset,24)&255,r[n*17+11]=_t(o.offset,32)&255,r[n*17+12]=_t(o.offset,48)&255,r[n*17+13]=o.length&255,r[n*17+14]=o.length>>8&255,r[n*17+15]=o.length>>16&255,r[n*17+16]=o.length>>24&255}return e},ac=(t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,n=xn(t,r-1);if(n.is_dir){const o=n.z,s=e.z-o,a=Math.trunc(e.x/(1<<s)),u=Math.trunc(e.y/(1<<s));return{z:o,x:a,y:u}}return null};function lc(t){return ie(this,null,function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),n=r.getUint32(4,!0),o=r.getUint16(8,!0),s=new TextDecoder("utf-8"),a=JSON.parse(s.decode(new DataView(e.data,10,n)));let u=0;a.compression==="gzip"&&(u=2);let i=0;"minzoom"in a&&(i=+a.minzoom);let f=0;"maxzoom"in a&&(f=+a.maxzoom);let l=0,c=0,p=0,$=-180,y=-85,k=180,S=85;if(a.bounds){const E=a.bounds.split(",");$=+E[0],y=+E[1],k=+E[2],S=+E[3]}if(a.center){const E=a.center.split(",");l=+E[0],c=+E[1],p=+E[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:i,maxZoom:f,minLon:$,minLat:y,maxLon:k,maxLat:S,centerZoom:p,centerLon:l,centerLat:c,etag:e.etag}})}function fc(t,e,r,n,o,s,a){return ie(this,null,function*(){let u=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(u=Xr(u));const i=Zr(new DataView(u),n,o,s);if(i){let c=(yield e.getBytes(i.offset,i.length,a)).data;const p=new DataView(c);return p.getUint8(0)==31&&p.getUint8(1)==139&&(c=rr(new Uint8Array(c))),{data:c}}const f=ac(new DataView(u),{z:n,x:o,y:s});if(f){const l=oc(new DataView(u),f.z,f.x,f.y);if(l){let c=yield r.getArrayBuffer(e,l.offset,l.length,t);t.specVersion===1&&(c=Xr(c));const p=Zr(new DataView(c),n,o,s);if(p){let y=(yield e.getBytes(p.offset,p.length,a)).data;const k=new DataView(y);return k.getUint8(0)==31&&k.getUint8(1)==139&&(y=rr(new Uint8Array(y))),{data:y}}}}})}var Fn={getHeader:lc,getZxy:fc},uc=class{constructor(){this.tile=(t,e)=>{if(t.type=="json"){const r=t.url.substr(10);let n=this.tiles.get(r);return n||(n=new Yr(r),this.tiles.set(r,n)),n.getHeader().then(o=>{const s={tiles:[t.url+"/{z}/{x}/{y}"],minzoom:o.minZoom,maxzoom:o.maxZoom,bounds:[o.minLon,o.minLat,o.maxLon,o.maxLat]};e(null,s,null,null)}).catch(o=>{e(o,null,null,null)}),{cancel:()=>{}}}else{const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),n=t.url.match(r);if(!n)throw new Error("Invalid PMTiles protocol URL");const o=n[1];let s=this.tiles.get(o);s||(s=new Yr(o),this.tiles.set(o,s));const a=n[2],u=n[3],i=n[4],f=new AbortController,l=f.signal;let c=()=>{f.abort()};return s.getHeader().then(p=>{s.getZxy(+a,+u,+i,l).then($=>{$?e(null,new Uint8Array($.data),$.cacheControl,$.expires):p.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch($=>{$.name!=="AbortError"&&e($,null,null,null)})}),{cancel:c}}},this.tiles=new Map}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function ut(t,e){return(e>>>0)*4294967296+(t>>>0)}function cc(t,e){const r=e.buf;let n,o;if(o=r[e.pos++],n=(o&112)>>4,o<128||(o=r[e.pos++],n|=(o&127)<<3,o<128)||(o=r[e.pos++],n|=(o&127)<<10,o<128)||(o=r[e.pos++],n|=(o&127)<<17,o<128)||(o=r[e.pos++],n|=(o&127)<<24,o<128)||(o=r[e.pos++],n|=(o&1)<<31,o<128))return ut(t,n);throw new Error("Expected varint not more than 10 bytes")}function wt(t){const e=t.buf;let r,n;return n=e[t.pos++],r=n&127,n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,cc(r,t))}function pc(t,e,r,n){if(n==0){r==1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var $c=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function mc(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=$c[t],o=Math.pow(2,t);let s=0,a=0,u=0;const i=[e,r];let f=o/2;for(;f>0;)s=(i[0]&f)>0?1:0,a=(i[1]&f)>0?1:0,u+=f*f*(3*s^a),pc(f,i,s,a),f=f/2;return n+u}function Bn(t,e){return ie(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return rr(new Uint8Array(t));{let n=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(n).arrayBuffer()}}else throw Error("Compression method not supported")})}var hc=127;function dc(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=n+r>>1,s=e-t[o].tileId;if(s>0)r=o+1;else if(s<0)n=o-1;else return t[o]}return n>=0&&(t[n].runLength===0||e-t[n].tileId<t[n].runLength)?t[n]:null}var gc=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return ie(this,null,function*(){let n;r||(n=new AbortController,r=n.signal);let o=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(o.status===416&&t===0){const u=o.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const i=+u.substr(8);o=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(i-1)}})}if(o.status>=300)throw Error("Bad response code: "+o.status);const s=o.headers.get("Content-Length");if(o.status===200&&(!s||+s>e))throw n&&n.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield o.arrayBuffer(),etag:o.headers.get("ETag")||void 0,cacheControl:o.headers.get("Cache-Control")||void 0,expires:o.headers.get("Expires")||void 0}})}};function ke(t,e){const r=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return r*Math.pow(2,32)+n}function _c(t,e){const r=new DataView(t),n=r.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:ke(r,8),rootDirectoryLength:ke(r,16),jsonMetadataOffset:ke(r,24),jsonMetadataLength:ke(r,32),leafDirectoryOffset:ke(r,40),leafDirectoryLength:ke(r,48),tileDataOffset:ke(r,56),tileDataLength:ke(r,64),numAddressedTiles:ke(r,72),numTileEntries:ke(r,80),numTileContents:ke(r,88),clustered:r.getUint8(96)===1,internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}function jn(t){const e={buf:new Uint8Array(t),pos:0},r=wt(e),n=[];let o=0;for(let s=0;s<r;s++){const a=wt(e);n.push({tileId:o+a,offset:0,length:0,runLength:1}),o+=a}for(let s=0;s<r;s++)n[s].runLength=wt(e);for(let s=0;s<r;s++)n[s].length=wt(e);for(let s=0;s<r;s++){const a=wt(e);a===0&&s>0?n[s].offset=n[s-1].offset+n[s-1].length:n[s].offset=a-1}return n}function wc(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var $t=class extends Error{};function bc(t,e,r,n){return ie(this,null,function*(){const o=yield t.getBytes(0,16384);if(new DataView(o.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(wc(o.data)<3)return[yield Fn.getHeader(t)];const a=o.data.slice(0,hc);let u=o.etag;n&&o.etag!=n&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),u=void 0);const i=_c(a,u);if(r){const f=o.data.slice(i.rootDirectoryOffset,i.rootDirectoryOffset+i.rootDirectoryLength),l=t.getKey()+"|"+(i.etag||"")+"|"+i.rootDirectoryOffset+"|"+i.rootDirectoryLength,c=jn(yield e(f,i.internalCompression));return[i,[l,c.length,c]]}return[i,void 0]})}function vc(t,e,r,n,o){return ie(this,null,function*(){const s=yield t.getBytes(r,n);if(o.etag&&o.etag!==s.etag)throw new $t(s.etag);const a=yield e(s.data,o.internalCompression),u=jn(a);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var yc=class{constructor(t=100,e=!0,r=Bn){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return ie(this,null,function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const n=new Promise((o,s)=>{bc(t,this.decompress,this.prefetch,e).then(a=>{a[1]&&this.cache.set(a[1][0],{lastUsed:this.counter++,data:Promise.resolve(a[1][2])}),o(a[0]),this.prune()}).catch(a=>{s(a)})});return this.cache.set(r,{lastUsed:this.counter++,data:n}),n})}getDirectory(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((a,u)=>{vc(t,this.decompress,e,r,n).then(i=>{a(i),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,e,r,n){return ie(this,null,function*(){const o=t.getKey()+"|"+(n.etag||"")+"|"+e+"|"+r;if(this.cache.has(o))return this.cache.get(o).lastUsed=this.counter++,yield this.cache.get(o).data;const s=new Promise((a,u)=>{t.getBytes(e,r).then(i=>{if(n.etag&&n.etag!==i.etag)throw new $t(i.etag);a(i.data),this.cache.has(o),this.prune()}).catch(i=>{u(i)})});return this.cache.set(o,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((r,n)=>{r.lastUsed<t&&(t=r.lastUsed,e=n)}),e&&this.cache.delete(e)}}invalidate(t,e){return ie(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)})}},Yr=class{constructor(t,e,r){typeof t=="string"?this.source=new gc(t):this.source=t,r?this.decompress=r:this.decompress=Bn,e?this.cache=e:this.cache=new yc}getHeader(){return ie(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,r,n){return ie(this,null,function*(){const o=mc(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Fn.getZxy(s,this.source,this.cache,t,e,r,n);if(t<s.minZoom||t>s.maxZoom)return;let a=s.rootDirectoryOffset,u=s.rootDirectoryLength;for(let i=0;i<=3;i++){const f=yield this.cache.getDirectory(this.source,a,u,s),l=dc(f,o);if(l)if(l.runLength>0){const c=yield this.source.getBytes(s.tileDataOffset+l.offset,l.length,n);if(s.etag&&s.etag!==c.etag)throw new $t(c.etag);return{data:yield this.decompress(c.data,s.tileCompression),cacheControl:c.cacheControl,expires:c.expires}}else a=s.leafDirectoryOffset+l.offset,u=l.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,r,n){return ie(this,null,function*(){try{return yield this.getZxyAttempt(t,e,r,n)}catch(o){if(o instanceof $t)return this.cache.invalidate(this.source,o.message),yield this.getZxyAttempt(t,e,r,n);throw o}})}getMetadataAttempt(){return ie(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new $t(e.etag);const r=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(r))})}getMetadata(){return ie(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof $t)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function kc(t){return Mt(()=>{let e=new uc;mr.addProtocol("pmtiles",e.tile)}),ln(()=>{mr.removeProtocol("pmtiles")}),[]}class Sc extends K{constructor(e){super(),q(this,e,kc,null,Z,{})}}function Jr(t,e,r){const n=t.slice();return n[13]=e[r],n}function Cc(t){let e,r;return e=new Du({props:{loadFile:t[7]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p:Q,i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Qr(t){let e,r,n,o;function s(i){t[9](i)}function a(i){t[10](i)}let u={schemes:t[1]};return t[2]!==void 0&&(u.schemesToBeShown=t[2]),t[3]!==void 0&&(u.filterText=t[3]),e=new Si({props:u}),H.push(()=>z(e,"schemesToBeShown",s)),H.push(()=>z(e,"filterText",a)),{c(){_(e.$$.fragment)},m(i,f){w(e,i,f),o=!0},p(i,f){const l={};f&2&&(l.schemes=i[1]),!r&&f&4&&(r=!0,l.schemesToBeShown=i[2],V(()=>r=!1)),!n&&f&8&&(n=!0,l.filterText=i[3],V(()=>n=!1)),e.$set(l)},i(i){o||(d(e.$$.fragment,i),o=!0)},o(i){g(e.$$.fragment,i),o=!1},d(i){b(e,i)}}}function en(t){let e,r;return e=new xu({props:{scheme:t[13],authorityNames:t[6]}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,o){const s={};o&2&&(s.scheme=n[13]),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function tn(t){let e=t[2].has(t[13].scheme_reference),r,n,o=e&&en(t);return{c(){o&&o.c(),r=xt()},m(s,a){o&&o.m(s,a),m(s,r,a),n=!0},p(s,a){a&6&&(e=s[2].has(s[13].scheme_reference)),e?o?(o.p(s,a),a&6&&d(o,1)):(o=en(s),o.c(),d(o,1),o.m(r.parentNode,r)):o&&(le(),g(o,1,1,()=>{o=null}),fe())},i(s){n||(d(o),n=!0)},o(s){g(o),n=!1},d(s){s&&h(r),o&&o.d(s)}}}function Lc(t){let e,r,n,o,s,a,u,i,f,l,c=nr()=="Private (development)",p,$,y,k,S,L,E,x;s=new Jn({props:{boundaryGeojson:t[5]}}),u=new uo({}),f=new qn({});let C=c&&Cc(t);$=new so({props:{label:"Load schemes from GeoJSON",id:"load-geojson",loadFile:t[7]}}),k=new sn({props:{errorMessage:t[0]}});let A=t[1].size>0&&Qr(t),F=ze(t[1].values()),M=[];for(let N=0;N<F.length;N+=1)M[N]=tn(Jr(t,F,N));const P=N=>g(M[N],1,1,()=>{M[N]=null});return{c(){e=D("div"),r=D("div"),n=D("h1"),n.textContent="Browse schemes",o=O(),_(s.$$.fragment),a=O(),_(u.$$.fragment),i=O(),_(f.$$.fragment),l=O(),C&&C.c(),p=O(),_($.$$.fragment),y=O(),_(k.$$.fragment),S=O(),A&&A.c(),L=O(),E=D("ul");for(let N=0;N<M.length;N+=1)M[N].c();Fe(r,"display","flex"),Fe(r,"justify-content","space-between"),G(e,"slot","sidebar"),G(e,"class","govuk-prose")},m(N,I){m(N,e,I),T(e,r),T(r,n),T(r,o),w(s,r,null),T(e,a),w(u,e,null),T(e,i),w(f,e,null),T(e,l),C&&C.m(e,null),T(e,p),w($,e,null),T(e,y),w(k,e,null),T(e,S),A&&A.m(e,null),T(e,L),T(e,E);for(let j=0;j<M.length;j+=1)M[j]&&M[j].m(E,null);x=!0},p(N,I){const j={};I&32&&(j.boundaryGeojson=N[5]),s.$set(j),c&&C.p(N,I);const ee={};if(I&1&&(ee.errorMessage=N[0]),k.$set(ee),N[1].size>0?A?(A.p(N,I),I&2&&d(A,1)):(A=Qr(N),A.c(),d(A,1),A.m(e,L)):A&&(le(),g(A,1,1,()=>{A=null}),fe()),I&70){F=ze(N[1].values());let R;for(R=0;R<F.length;R+=1){const ce=Jr(N,F,R);M[R]?(M[R].p(ce,I),d(M[R],1)):(M[R]=tn(ce),M[R].c(),d(M[R],1),M[R].m(E,null))}for(le(),R=F.length;R<M.length;R+=1)P(R);fe()}},i(N){if(!x){d(s.$$.fragment,N),d(u.$$.fragment,N),d(f.$$.fragment,N),d(C),d($.$$.fragment,N),d(k.$$.fragment,N),d(A);for(let I=0;I<F.length;I+=1)d(M[I]);x=!0}},o(N){g(s.$$.fragment,N),g(u.$$.fragment,N),g(f.$$.fragment,N),g(C),g($.$$.fragment,N),g(k.$$.fragment,N),g(A),M=M.filter(Boolean);for(let I=0;I<M.length;I+=1)g(M[I]);x=!1},d(N){N&&h(e),b(s),b(u),b(f),C&&C.d(),b($),b(k),A&&A.d(),Et(M,N)}}}function Oc(t){let e,r,n,o,s,a,u,i,f,l,c;return e=new Qn({props:{colorInterventions:fn("v1")}}),n=new J({props:{layer:"interventions-points",tooltip:t[8],clickable:!1}}),s=new J({props:{layer:"interventions-lines",tooltip:t[8],clickable:!1}}),u=new J({props:{layer:"interventions-polygons",tooltip:t[8],clickable:!1}}),l=new Tu({}),{c(){_(e.$$.fragment),r=O(),_(n.$$.fragment),o=O(),_(s.$$.fragment),a=O(),_(u.$$.fragment),i=O(),f=D("div"),_(l.$$.fragment),G(f,"class","top-right svelte-u44ed2")},m(p,$){w(e,p,$),m(p,r,$),w(n,p,$),m(p,o,$),w(s,p,$),m(p,a,$),w(u,p,$),m(p,i,$),m(p,f,$),w(l,f,null),c=!0},p:Q,i(p){c||(d(e.$$.fragment,p),d(n.$$.fragment,p),d(s.$$.fragment,p),d(u.$$.fragment,p),d(l.$$.fragment,p),c=!0)},o(p){g(e.$$.fragment,p),g(n.$$.fragment,p),g(s.$$.fragment,p),g(u.$$.fragment,p),g(l.$$.fragment,p),c=!1},d(p){p&&(h(r),h(o),h(a),h(i),h(f)),b(e,p),b(n,p),b(s,p),b(u,p),b(l)}}}function Tc(t){let e,r,n,o,s;return r=new Sc({}),o=new oo({props:{style:t[4],startBounds:[-5.96,49.89,2.31,55.94],$$slots:{default:[Oc]},$$scope:{ctx:t}}}),{c(){e=D("div"),_(r.$$.fragment),n=O(),_(o.$$.fragment),G(e,"slot","main")},m(a,u){m(a,e,u),w(r,e,null),T(e,n),w(o,e,null),s=!0},p(a,u){const i={};u&16&&(i.style=a[4]),u&65536&&(i.$$scope={dirty:u,ctx:a}),o.$set(i)},i(a){s||(d(r.$$.fragment,a),d(o.$$.fragment,a),s=!0)},o(a){g(r.$$.fragment,a),g(o.$$.fragment,a),s=!1},d(a){a&&h(e),b(r),b(o)}}}function Ac(t){let e,r;return e=new no({props:{$$slots:{main:[Tc],sidebar:[Lc]},$$scope:{ctx:t}}}),{c(){_(e.$$.fragment)},m(n,o){w(e,n,o),r=!0},p(n,[o]){const s={};o&65599&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){r||(d(e.$$.fragment,n),r=!0)},o(n){g(e.$$.fragment,n),r=!1},d(n){b(e,n)}}}function Dc(t,e,r){let n,o;X(t,hr,S=>r(4,n=S)),X(t,mt,S=>r(5,o=S));let s=new Set(Fu);Mt(()=>{Zn()});const a=new URLSearchParams(window.location.search);hr.set(a.get("style")||"dataviz");let u="",i=new Map,f=new Set,l="";ln(()=>{mt.set(on())});function c(S){try{let L=JSON.parse(S);r(1,i=pi(L)),mt.set(L),r(0,u="")}catch(L){r(0,u=`The file you loaded is broken: ${L}`)}}function p(S){let L=S.properties;var E='<div style="max-width: 30vw;">';return E+=`<h2>${$(L.name)} (${L.intervention_type})</h2>`,E+=`<p>Scheme reference: ${L.scheme_reference}</p>`,L.length_meters&&(E+=`<p>Length: ${Xn(L.length_meters)}</p>`),L.description&&(E+=`<p>${$(L.description)}</p>`),E+="</div>",E}function $(S){return l?S.replace(new RegExp(l,"gi"),L=>`<mark>${L}</mark>`):S}function y(S){f=S,r(2,f)}function k(S){l=S,r(3,l)}return[u,i,f,l,n,o,s,c,p,y,k]}class Ec extends K{constructor(e){super(),q(this,e,Dc,Ac,Z,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Ec({target:document.getElementById("app")});
