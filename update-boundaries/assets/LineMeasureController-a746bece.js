import{S as W,i as z,s as K,q as V,B as X,r as Y,b9 as E,a3 as Z,G as te,d as N,g as C,j as b,m as M,w as q,as as G,n as d,at as T,t as m,o as k,p as S,aF as ne,aC as F,a0 as v,aP as re,aQ as se,e as R,u as D,k as j,C as ae,H as oe,b as le,c as ie,l as fe,O as ue,P as ce,x as I,ab as pe,a as x}from"./index-df641f5c.js";import{C as _e,c as ge,L as me,i as de}from"./StreetViewController-f07edb47.js";function be(l,e,t){let n;V(l,X,u=>t(3,n=u));let a=null,{markerPosition:o}=e,{markerPositionUpdated:f}=e;return Y(()=>{a=new E.Marker({draggable:!0}).setLngLat(o).addTo(n),a.on("dragstart",()=>{n.getCanvas().style.cursor="grabbing"}),a.on("drag",()=>{t(0,o=a.getLngLat()),f()}),a.on("dragend",()=>{n.getCanvas().style.cursor="inherit"})}),Z(()=>{a&&a.remove()}),l.$$set=u=>{"markerPosition"in u&&t(0,o=u.markerPosition),"markerPositionUpdated"in u&&t(1,f=u.markerPositionUpdated)},[o,f]}class ke extends W{constructor(e){super(),z(this,e,be,null,K,{markerPosition:0,markerPositionUpdated:1})}}function J(l,e,t){const n=l.slice();return n[16]=e[t],n[17]=e,n[18]=t,n}function Le(l){let e,t;return e=new x({props:{$$slots:{default:[he]},$$scope:{ctx:l}}}),e.$on("click",l[5]),{c(){C(e.$$.fragment)},m(n,a){M(e,n,a),t=!0},p(n,a){const o={};a&524288&&(o.$$scope={dirty:a,ctx:n}),e.$set(o)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){d(e.$$.fragment,n),t=!1},d(n){S(e,n)}}}function $e(l){let e,t;return e=new x({props:{$$slots:{default:[ye]},$$scope:{ctx:l}}}),e.$on("click",l[4]),{c(){C(e.$$.fragment)},m(n,a){M(e,n,a),t=!0},p(n,a){const o={};a&524288&&(o.$$scope={dirty:a,ctx:n}),e.$set(o)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){d(e.$$.fragment,n),t=!1},d(n){S(e,n)}}}function he(l){let e;return{c(){e=D("Disable Line Measurement Tool")},m(t,n){b(t,e,n)},d(t){t&&k(e)}}}function ye(l){let e;return{c(){e=D("Enable Line Measurement Tool")},m(t,n){b(t,e,n)},d(t){t&&k(e)}}}function A(l){var h;let e,t,n,a=[],o=new Map,f,u,i=l[2]&&((h=l[2].properties)==null?void 0:h.length)&&B(l);t=new _e({props:{label:"Help",$$slots:{default:[we]},$$scope:{ctx:l}}});let p=F(l[1]);const _=s=>s[16].id;for(let s=0;s<p.length;s+=1){let r=J(l,p,s),c=_(r);o.set(c,a[s]=Q(c,r))}return{c(){i&&i.c(),e=N(),C(t.$$.fragment),n=N();for(let s=0;s<a.length;s+=1)a[s].c();f=v()},m(s,r){i&&i.m(s,r),b(s,e,r),M(t,s,r),b(s,n,r);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(s,r);b(s,f,r),u=!0},p(s,r){var L;s[2]&&((L=s[2].properties)!=null&&L.length)?i?i.p(s,r):(i=B(s),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null);const c={};r&524288&&(c.$$scope={dirty:r,ctx:s}),t.$set(c),r&258&&(p=F(s[1]),G(),a=re(a,r,_,1,s,p,o,f.parentNode,se,Q,f,J),T())},i(s){if(!u){m(t.$$.fragment,s);for(let r=0;r<p.length;r+=1)m(a[r]);u=!0}},o(s){d(t.$$.fragment,s);for(let r=0;r<a.length;r+=1)d(a[r]);u=!1},d(s){s&&(k(e),k(n),k(f)),i&&i.d(s),S(t,s);for(let r=0;r<a.length;r+=1)a[r].d(s)}}}function B(l){var f;let e,t,n=((f=l[2].properties)==null?void 0:f.length)+"",a,o;return{c(){e=R("p"),t=D("Length: "),a=D(n),o=D("m")},m(u,i){b(u,e,i),j(e,t),j(e,a),j(e,o)},p(u,i){var p;i&4&&n!==(n=((p=u[2].properties)==null?void 0:p.length)+"")&&ae(a,n)},d(u){u&&k(e)}}}function we(l){let e;return{c(){e=R("ul"),e.innerHTML=`<li><b>Click</b>
        on the map to place a new waypoint</li> <li><b>Click and Drag</b>
        an existing waypoint to move it</li> <li><b>Hold shift and click on</b>
        an existing waypoint to delete it</li> <li>Press <b>Escape</b>
        to exit this mode</li>`},m(t,n){b(t,e,n)},p:oe,d(t){t&&k(e)}}}function Q(l,e){let t,n,a,o;function f(i){e[9](i,e[16])}let u={markerPositionUpdated:e[8]};return e[16].lngLat!==void 0&&(u.markerPosition=e[16].lngLat),n=new ke({props:u}),le.push(()=>ie(n,"markerPosition",f)),{key:l,first:null,c(){t=v(),C(n.$$.fragment),this.first=t},m(i,p){b(i,t,p),M(n,i,p),o=!0},p(i,p){e=i;const _={};!a&&p&2&&(a=!0,_.markerPosition=e[16].lngLat,fe(()=>a=!1)),n.$set(_)},i(i){o||(m(n.$$.fragment,i),o=!0)},o(i){d(n.$$.fragment,i),o=!1},d(i){i&&k(t),S(n,i)}}}function Pe(l){let e,t;const n=[ue("measurement-line"),{paint:{"line-color":ge.measuringLine,"line-width":5}}];let a={};for(let o=0;o<n.length;o+=1)a=ce(a,n[o]);return e=new me({props:a}),{c(){C(e.$$.fragment)},m(o,f){M(e,o,f),t=!0},p(o,f){const u={};e.$set(u)},i(o){t||(m(e.$$.fragment,o),t=!0)},o(o){d(e.$$.fragment,o),t=!1},d(o){S(e,o)}}}function Ce(l){let e,t,n,a,o,f,u,i;const p=[$e,Le],_=[];function h(r,c){return r[0]?0:1}e=h(l),t=_[e]=p[e](l);let s=!l[0]&&A(l);return o=new te({props:{data:l[3],$$slots:{default:[Pe]},$$scope:{ctx:l}}}),{c(){t.c(),n=N(),s&&s.c(),a=N(),C(o.$$.fragment)},m(r,c){_[e].m(r,c),b(r,n,c),s&&s.m(r,c),b(r,a,c),M(o,r,c),f=!0,u||(i=[q(window,"keydown",l[6]),q(window,"keyup",l[7])],u=!0)},p(r,[c]){let L=e;e=h(r),e===L?_[e].p(r,c):(G(),d(_[L],1,1,()=>{_[L]=null}),T(),t=_[e],t?t.p(r,c):(t=_[e]=p[e](r),t.c()),m(t,1),t.m(n.parentNode,n)),r[0]?s&&(G(),d(s,1,1,()=>{s=null}),T()):s?(s.p(r,c),c&1&&m(s,1)):(s=A(r),s.c(),m(s,1),s.m(a.parentNode,a));const y={};c&8&&(y.data=r[3]),c&524288&&(y.$$scope={dirty:c,ctx:r}),o.$set(y)},i(r){f||(m(t),m(s),m(o.$$.fragment,r),f=!0)},o(r){d(t),d(s),d(o.$$.fragment,r),f=!1},d(r){r&&(k(n),k(a)),_[e].d(r),s&&s.d(r),S(o,r),u=!1,ne(i)}}}function Me(l,e,t){let n;V(l,X,g=>t(12,n=g));let a=!0,o=[],f,u=!1,i=0,p=I();function _(g){a||(u||(o.push({id:i++,lngLat:g.lngLat}),t(1,o),y()),u&&o.length>0&&(h(g.lngLat),y()))}function h(g){let O=new E.LngLat(0,-90).distanceTo(new E.LngLat(0,90)),$;o.forEach(U=>{const P=U.lngLat;O>=g.distanceTo(P)&&($=P,O=g.distanceTo(P))}),$&&t(1,o=o.filter(U=>{const P=U.lngLat;return P.lng!=($==null?void 0:$.lng)||P.lat!=($==null?void 0:$.lat)}))}function s(){t(0,a=!1)}function r(){t(0,a=!0),t(1,o=[]),H()}function c(g){g.key==="Shift"&&(u=!0),g.key==="Escape"&&r()}function L(g){g.key==="Shift"&&(u=!1)}function y(){if(o.length<2){H();return}const g=o.map(w=>[w.lngLat.lng,w.lngLat.lat]);t(2,f=pe(g,{})),f.properties&&t(2,f.properties.length=(de(f)*1e3).toFixed(2),f),t(3,p=JSON.parse(JSON.stringify(f)))}function H(){t(2,f=void 0),t(3,p=I())}Y(()=>{n.on("click",_)}),Z(()=>{n.off("click",_)});function ee(g,w){l.$$.not_equal(w.lngLat,g)&&(w.lngLat=g,t(1,o))}return[a,o,f,p,s,r,c,L,y,ee]}class Ne extends W{constructor(e){super(),z(this,e,Me,Ce,K,{})}}export{Ne as L};
