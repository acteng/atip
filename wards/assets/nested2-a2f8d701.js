import{S as H,i as Z,s as R,b as X,c as Y,I as oe,g as v,f as M,m as y,j as m,o as Q,t as g,l as _,p as h,q as b,_ as K,C as ie,a0 as mt,a1 as Ce,G as ge,a7 as De,u as L,x as Se,e as B,h as x,aV as F,k as D,U as se,a2 as he,r as He,F as Nt,a as Ae,v as et,w as It,aW as Ee,H as xt,L as Ft,M as jt,N as Vt,az as Ht,D as ht,aX as tt,ag as gt,d as Zt,X as nt,y as ke,n as Le,z as Rt,A as Gt,a9 as Kt,aP as qt,E as Wt,V as rt,W as Jt,ad as Xt}from"./data_getter-57196b1d.js";import{d as de,j as _e,H as we,C as Ze,S as Fe,h as Yt,i as st,g as dt,L as Qt,Z as en,M as tn,I as nn,b as rn,B as sn}from"./Map-9c47f6f4.js";const G={schools:"#007DBB",hospitals:"#B73D25",mrn:"#006478",parliamentary_constituencies:"#006E59",wards:"purple",combined_authorities:"cyan",local_authority_districts:"orange",atf2:"#00AFFF",atf3:"#FF62DC",atf4:"#FFD833"};function on(s){let e,n,t;return e=new _e({props:{color:s[1]}}),{c(){v(e.$$.fragment),n=L(`
  Combined authorities`)},m(r,i){y(e,r,i),m(r,n,i),t=!0},p:Se,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&h(n),b(e,r)}}}function ln(s){let e;return{c(){e=L(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function an(s){let e;return{c(){e=L(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function fn(s){let e,n,t,r,i,l,u,o,c,a;return t=new F({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::combined-authorities-december-2022-boundaries-en-buc/explore",$$slots:{default:[ln]},$$scope:{ctx:s}}}),o=new F({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[an]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=L("Data from "),v(t.$$.fragment),r=L(", as of December 2022."),i=M(),l=B("p"),u=L("License: "),v(o.$$.fragment),c=L(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),D(e,n),y(t,e,null),D(e,r),m(f,i,$),m(f,l,$),D(l,u),y(o,l,null),D(l,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const w={};$&32&&(w.$$scope={dirty:$,ctx:f}),o.$set(w)},i(f){a||(g(t.$$.fragment,f),g(o.$$.fragment,f),a=!0)},o(f){_(t.$$.fragment,f),_(o.$$.fragment,f),a=!1},d(f){f&&(h(e),h(i),h(l)),b(t),b(o)}}}function cn(s){let e,n,t;return n=new we({props:{$$slots:{default:[fn]},$$scope:{ctx:s}}}),{c(){e=B("span"),v(n.$$.fragment),x(e,"slot","right")},m(r,i){m(r,e,i),y(n,e,null),t=!0},p(r,i){const l={};i&32&&(l.$$scope={dirty:i,ctx:r}),n.$set(l)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&h(e),b(n)}}}function un(s){let e,n,t,r,i;function l(o){s[3](o)}let u={id:le,$$slots:{right:[cn],default:[on]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new de({props:u}),X.push(()=>Y(e,"checked",l)),r=new oe({props:{layer:le,tooltip:pn,show:s[0]}}),r.$on("click",$n),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment)},m(o,c){y(e,o,c),m(o,t,c),y(r,o,c),i=!0},p(o,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,a.checked=o[0],Q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=o[0]),r.$set(f)},i(o){i||(g(e.$$.fragment,o),g(r.$$.fragment,o),i=!0)},o(o){_(e.$$.fragment,o),_(r.$$.fragment,o),i=!1},d(o){o&&h(t),b(e,o),b(r,o)}}}let le="combined_authorities";function pn(s){return`<p>${s.properties.name}</p>`}function $n(s){encodeURIComponent(s.detail.properties.name),window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.CAUTH22CD}`,"_blank")}function mn(s,e,n){let t;K(s,ie,o=>n(2,t=o));let r=G.combined_authorities,i=`${le}-outline`;mt(t,le,`https://atip.uk/layers/v1/${le}.geojson`),Ce(t,{id:le,source:le,color:r,opacity:ge(.5,.1)}),De(t,{id:i,source:le,color:r,width:2.5});let l=!1;function u(o){l=o,n(0,l)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(i)&&t.setLayoutProperty(i,"visibility",l?"visible":"none")},[l,r,t,u]}class hn extends H{constructor(e){super(),Z(this,e,mn,un,R,{})}}function gn(s){let e=new Map;for(let[t,r]of Object.entries(s.schemes))e.set(t,{scheme_reference:t,num_features:0,authority_or_region:r.authority_or_region,capital_scheme_id:r.capital_scheme_id,funding_programme:r.funding_programme});let n=1;for(let t of s.features){let r=e.get(t.properties.scheme_reference);r.num_features++,t.properties.funding_programme=r.funding_programme,t.id=n++}return e}function dn(s){let e;return{c(){e=L("Clear")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function _n(s){let e,n,t,r,i,l;return t=new Ae({props:{$$slots:{default:[dn]},$$scope:{ctx:s}}}),t.$on("click",s[11]),{c(){e=B("input"),n=M(),v(t.$$.fragment),x(e,"type","text"),x(e,"class","govuk-input govuk-input--width-10"),x(e,"id","filterText")},m(u,o){m(u,e,o),et(e,s[0]),m(u,n,o),y(t,u,o),r=!0,i||(l=It(e,"input",s[10]),i=!0)},p(u,o){o&1&&e.value!==u[0]&&et(e,u[0]);const c={};o&16384&&(c.$$scope={dirty:o,ctx:u}),t.$set(c)},i(u){r||(g(t.$$.fragment,u),r=!0)},o(u){_(t.$$.fragment,u),r=!1},d(u){u&&(h(e),h(n)),b(t,u),i=!1,l()}}}function wn(s){let e,n,t,r,i,l,u,o;function c(p){s[8](p)}let a={label:"Authority or region",id:"filterAuthority",choices:s[4],emptyOption:!0};s[2]!==void 0&&(a.value=s[2]),e=new Fe({props:a}),X.push(()=>Y(e,"value",c));function f(p){s[9](p)}let $={label:"Funding programme",id:"filterFundingProgramme",choices:s[5],emptyOption:!0};return s[3]!==void 0&&($.value=s[3]),r=new Fe({props:$}),X.push(()=>Y(r,"value",f)),u=new Nt({props:{label:"Intervention name or description",id:"filterText",$$slots:{default:[_n]},$$scope:{ctx:s}}}),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment),l=M(),v(u.$$.fragment)},m(p,w){y(e,p,w),m(p,t,w),y(r,p,w),m(p,l,w),y(u,p,w),o=!0},p(p,w){const d={};w&16&&(d.choices=p[4]),!n&&w&4&&(n=!0,d.value=p[2],Q(()=>n=!1)),e.$set(d);const C={};w&32&&(C.choices=p[5]),!i&&w&8&&(i=!0,C.value=p[3],Q(()=>i=!1)),r.$set(C);const k={};w&16385&&(k.$$scope={dirty:w,ctx:p}),u.$set(k)},i(p){o||(g(e.$$.fragment,p),g(r.$$.fragment,p),g(u.$$.fragment,p),o=!0)},o(p){_(e.$$.fragment,p),_(r.$$.fragment,p),_(u.$$.fragment,p),o=!1},d(p){p&&(h(t),h(l)),b(e,p),b(r,p),b(u,p)}}}function vn(s){let e,n,t,r,i=s[1].size+"",l,u,o=s[6].route+"",c,a,f=s[6].area+"",$,p,w=s[6].crossing+"",d,C,k=s[6].other+"",T,S,A;return e=new Ze({props:{label:"Filters",$$slots:{default:[wn]},$$scope:{ctx:s}}}),{c(){v(e.$$.fragment),n=M(),t=B("p"),r=L("Showing "),l=L(i),u=L(" schemes ("),c=L(o),a=L(" routes, "),$=L(f),p=L(` areas,
  `),d=L(w),C=L(" crossings, "),T=L(k),S=L(" other)")},m(U,E){y(e,U,E),m(U,n,E),m(U,t,E),D(t,r),D(t,l),D(t,u),D(t,c),D(t,a),D(t,$),D(t,p),D(t,d),D(t,C),D(t,T),D(t,S),A=!0},p(U,[E]){const P={};E&16445&&(P.$$scope={dirty:E,ctx:U}),e.$set(P),(!A||E&2)&&i!==(i=U[1].size+"")&&se(l,i),(!A||E&64)&&o!==(o=U[6].route+"")&&se(c,o),(!A||E&64)&&f!==(f=U[6].area+"")&&se($,f),(!A||E&64)&&w!==(w=U[6].crossing+"")&&se(d,w),(!A||E&64)&&k!==(k=U[6].other+"")&&se(T,k)},i(U){A||(g(e.$$.fragment,U),A=!0)},o(U){_(e.$$.fragment,U),A=!1},d(U){U&&(h(n),h(t)),b(e,U)}}}function yn(s,e,n){let t;K(s,he,k=>n(12,t=k));let{schemes:r}=e,{schemesToBeShown:i=new Set}=e,{filterText:l=""}=e,u=[],o="",c=[],a="",f={area:0,route:0,crossing:0,other:0};He(()=>{let k=new Set,T=new Set;for(let S of r.values())S.authority_or_region&&k.add(S.authority_or_region),S.funding_programme&&T.add(S.funding_programme);n(4,u=Array.from(k.entries())),u.sort(),n(5,c=Array.from(T.entries())),c.sort()});function $(k,T,S){let A=k.toLowerCase(),U=P=>{var z,ne;if(A&&!((z=P.properties.name)!=null&&z.toLowerCase().includes(A))&&!((ne=P.properties.description)!=null&&ne.toLowerCase().includes(A)))return!1;if(T||S){let N=r.get(P.properties.scheme_reference);if(T&&N.authority_or_region!=T||S&&N.funding_programme!=S)return!1}return!0};n(1,i=new Set(t.features.filter(U).map(P=>P.properties.scheme_reference))),n(6,f={area:0,route:0,crossing:0,other:0});let E=P=>{var z,ne;return!(!i.has(P.properties.scheme_reference)||A&&!((z=P.properties.name)!=null&&z.toLowerCase().includes(A))&&!((ne=P.properties.description)!=null&&ne.toLowerCase().includes(A)))};he.update(P=>{for(let z of P.features)E(z)?(delete z.properties.hide_while_editing,n(6,f[z.properties.intervention_type]++,f)):z.properties.hide_while_editing=!0;return P}),n(6,f)}function p(k){o=k,n(2,o)}function w(k){a=k,n(3,a)}function d(){l=this.value,n(0,l)}const C=()=>n(0,l="");return s.$$set=k=>{"schemes"in k&&n(7,r=k.schemes),"schemesToBeShown"in k&&n(1,i=k.schemesToBeShown),"filterText"in k&&n(0,l=k.filterText)},s.$$.update=()=>{s.$$.dirty&13&&$(l,o,a)},[l,i,o,a,u,c,f,r,p,w,d,C]}class bn extends H{constructor(e){super(),Z(this,e,yn,vn,R,{schemes:7,schemesToBeShown:1,filterText:0})}}function kn(s){let e,n,t,r;return e=new _e({props:{color:s[3]}}),{c(){v(e.$$.fragment),n=M(),t=L(s[1])},m(i,l){y(e,i,l),m(i,n,l),m(i,t,l),r=!0},p(i,l){(!r||l&2)&&se(t,i[1])},i(i){r||(g(e.$$.fragment,i),r=!0)},o(i){_(e.$$.fragment,i),r=!1},d(i){i&&(h(n),h(t)),b(e,i)}}}function Ln(s){let e;const n=s[6].default,t=xt(n,s,s[8],null);return{c(){t&&t.c()},m(r,i){t&&t.m(r,i),e=!0},p(r,i){t&&t.p&&(!e||i&256)&&Ft(t,n,r,r[8],e?Vt(n,r[8],i,null):jt(r[8]),null)},i(r){e||(g(t,r),e=!0)},o(r){_(t,r),e=!1},d(r){t&&t.d(r)}}}function Tn(s){let e,n,t;return n=new we({props:{$$slots:{default:[Ln]},$$scope:{ctx:s}}}),{c(){e=B("span"),v(n.$$.fragment),x(e,"slot","right")},m(r,i){m(r,e,i),y(n,e,null),t=!0},p(r,i){const l={};i&256&&(l.$$scope={dirty:i,ctx:r}),n.$set(l)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&h(e),b(n)}}}function Cn(s){let e,n,t,r,i;function l(o){s[7](o)}let u={id:s[0],$$slots:{right:[Tn],default:[kn]},$$scope:{ctx:s}};return s[2]!==void 0&&(u.checked=s[2]),e=new de({props:u}),X.push(()=>Y(e,"checked",l)),r=new oe({props:{layer:s[0],tooltip:s[4],show:s[2]}}),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment)},m(o,c){y(e,o,c),m(o,t,c),y(r,o,c),i=!0},p(o,[c]){const a={};c&1&&(a.id=o[0]),c&258&&(a.$$scope={dirty:c,ctx:o}),!n&&c&4&&(n=!0,a.checked=o[2],Q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.layer=o[0]),c&4&&(f.show=o[2]),r.$set(f)},i(o){i||(g(e.$$.fragment,o),g(r.$$.fragment,o),i=!0)},o(o){_(e.$$.fragment,o),_(r.$$.fragment,o),i=!1},d(o){o&&h(t),b(e,o),b(r,o)}}}function Dn(s,e,n){let t;K(s,ie,p=>n(9,t=p));let{$$slots:r={},$$scope:i}=e,{name:l}=e,{singularNoun:u}=e,{pluralNoun:o}=e,c=G[l];Ee(t,l,`https://atip.uk/layers/v1/${l}.pmtiles`),Ce(t,{id:l,source:l,sourceLayer:l,color:c,opacity:ge(1,.7)});let a=!1;function f(p){return`<p>${p.properties.name??`Unnamed ${u}`}</p>`}function $(p){a=p,n(2,a)}return s.$$set=p=>{"name"in p&&n(0,l=p.name),"singularNoun"in p&&n(5,u=p.singularNoun),"pluralNoun"in p&&n(1,o=p.pluralNoun),"$$scope"in p&&n(8,i=p.$$scope)},[l,o,a,c,f,u,r,$,i]}class _t extends H{constructor(e){super(),Z(this,e,Dn,Cn,R,{name:0,singularNoun:5,pluralNoun:1})}}function Sn(s){let e;return{c(){e=L("hospital")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Un(s){let e;return{c(){e=L("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Mn(s){let e,n,t,r,i,l,u,o,c;return t=new F({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dhospital",$$slots:{default:[Sn]},$$scope:{ctx:s}}}),o=new F({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[Un]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=L("This shows "),v(t.$$.fragment),r=L(` data from OpenStreetMap. It doesn't include outpatient clinics
    or individual doctor's offices.`),i=M(),l=B("p"),u=L("License: "),v(o.$$.fragment)},m(a,f){m(a,e,f),D(e,n),y(t,e,null),D(e,r),m(a,i,f),m(a,l,f),D(l,u),y(o,l,null),c=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),o.$set(p)},i(a){c||(g(t.$$.fragment,a),g(o.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(o.$$.fragment,a),c=!1},d(a){a&&(h(e),h(i),h(l)),b(t),b(o)}}}function An(s){let e,n;return e=new _t({props:{name:"hospitals",singularNoun:"hospital",pluralNoun:"Hospitals",$$slots:{default:[Mn]},$$scope:{ctx:s}}}),{c(){v(e.$$.fragment)},m(t,r){y(e,t,r),n=!0},p(t,[r]){const i={};r&1&&(i.$$scope={dirty:r,ctx:t}),e.$set(i)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}class Bn extends H{constructor(e){super(),Z(this,e,null,An,R,{})}}function En(s){let e,n,t,r,i;function l(o){s[3](o)}let u={label:"Color interventions",id:"colorInterventions",choices:[["interventionType","By intervention type"],["fundingProgramme","By funding programme"]]};return s[0]!==void 0&&(u.value=s[0]),e=new Fe({props:u}),X.push(()=>Y(e,"value",l)),e.$on("change",s[2]),r=new Yt({props:{rows:s[1]}}),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment)},m(o,c){y(e,o,c),m(o,t,c),y(r,o,c),i=!0},p(o,[c]){const a={};!n&&c&1&&(n=!0,a.value=o[0],Q(()=>n=!1)),e.$set(a);const f={};c&2&&(f.rows=o[1]),r.$set(f)},i(o){i||(g(e.$$.fragment,o),g(r.$$.fragment,o),i=!0)},o(o){_(e.$$.fragment,o),_(r.$$.fragment,o),i=!1},d(o){o&&h(t),b(e,o),b(r,o)}}}function On(s,e,n){let t;K(s,ie,o=>n(4,t=o));let r="interventionType",i=st("v1");function l(){let o;r=="interventionType"?(o=dt("v1"),n(1,i=st("v1"))):(o=Ht(["get","funding_programme"],{ATF2:G.atf2,ATF3:G.atf3,ATF4:G.atf4},"grey"),n(1,i=[["ATF2",G.atf2],["ATF3",G.atf3],["ATF4",G.atf4]])),t.setPaintProperty("interventions-points","circle-color",o),t.setPaintProperty("interventions-lines","line-color",o),t.setPaintProperty("interventions-polygons","fill-color",o),t.setPaintProperty("interventions-polygon-outlines","line-color",o)}function u(o){r=o,n(0,r)}return[r,i,l,u]}class Pn extends H{constructor(e){super(),Z(this,e,On,En,R,{})}}function zn(s){let e,n,t;return e=new _e({props:{color:s[1]}}),{c(){v(e.$$.fragment),n=L(`
  Local Authority Districts`)},m(r,i){y(e,r,i),m(r,n,i),t=!0},p:Se,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&h(n),b(e,r)}}}function Nn(s){let e;return{c(){e=L(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function In(s){let e;return{c(){e=L(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function xn(s){let e,n,t,r,i,l,u,o,c,a;return t=new F({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::local-authority-districts-may-2023-boundaries-uk-buc/explore",$$slots:{default:[Nn]},$$scope:{ctx:s}}}),o=new F({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[In]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=L("Data from "),v(t.$$.fragment),r=L(", as of May 2023."),i=M(),l=B("p"),u=L("License: "),v(o.$$.fragment),c=L(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),D(e,n),y(t,e,null),D(e,r),m(f,i,$),m(f,l,$),D(l,u),y(o,l,null),D(l,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const w={};$&32&&(w.$$scope={dirty:$,ctx:f}),o.$set(w)},i(f){a||(g(t.$$.fragment,f),g(o.$$.fragment,f),a=!0)},o(f){_(t.$$.fragment,f),_(o.$$.fragment,f),a=!1},d(f){f&&(h(e),h(i),h(l)),b(t),b(o)}}}function Fn(s){let e,n,t;return n=new we({props:{$$slots:{default:[xn]},$$scope:{ctx:s}}}),{c(){e=B("span"),v(n.$$.fragment),x(e,"slot","right")},m(r,i){m(r,e,i),y(n,e,null),t=!0},p(r,i){const l={};i&32&&(l.$$scope={dirty:i,ctx:r}),n.$set(l)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&h(e),b(n)}}}function jn(s){let e,n,t,r,i;function l(o){s[3](o)}let u={id:ae,$$slots:{right:[Fn],default:[zn]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new de({props:u}),X.push(()=>Y(e,"checked",l)),r=new oe({props:{layer:ae,tooltip:Vn,show:s[0]}}),r.$on("click",Hn),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment)},m(o,c){y(e,o,c),m(o,t,c),y(r,o,c),i=!0},p(o,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,a.checked=o[0],Q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=o[0]),r.$set(f)},i(o){i||(g(e.$$.fragment,o),g(r.$$.fragment,o),i=!0)},o(o){_(e.$$.fragment,o),_(r.$$.fragment,o),i=!1},d(o){o&&h(t),b(e,o),b(r,o)}}}let ae="local_authority_districts";function Vn(s){return`<p>${s.properties.name}</p>`}function Hn(s){s.detail.properties.LAD23CD,window.open(`https://www.ons.gov.uk/visualisations/areas/${s.detail.properties.LAD23CD}`,"_blank")}function Zn(s,e,n){let t;K(s,ie,o=>n(2,t=o));let r=G.local_authority_districts,i=`${ae}-outline`;mt(t,ae,`https://atip.uk/layers/v1/${ae}.geojson`),Ce(t,{id:ae,source:ae,color:r,opacity:ge(.5,.1)}),De(t,{id:i,source:ae,color:r,width:2.5});let l=!1;function u(o){l=o,n(0,l)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(i)&&t.setLayoutProperty(i,"visibility",l?"visible":"none")},[l,r,t,u]}class Rn extends H{constructor(e){super(),Z(this,e,Zn,jn,R,{})}}function Gn(s){let e,n,t;return e=new _e({props:{color:s[1]}}),{c(){v(e.$$.fragment),n=L(`
  MRN`)},m(r,i){y(e,r,i),m(r,n,i),t=!0},p:Se,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&h(n),b(e,r)}}}function Kn(s){let e;return{c(){e=L(`Major Road Network
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function qn(s){let e;return{c(){e=L("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Wn(s){let e,n,t,r,i,l,u,o,c;return t=new F({props:{href:"https://maps.dft.gov.uk/major-road-network/index.html",$$slots:{default:[Kn]},$$scope:{ctx:s}}}),o=new F({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[qn]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=L("Data from the "),v(t.$$.fragment),r=L("."),i=M(),l=B("p"),u=L("License: "),v(o.$$.fragment)},m(a,f){m(a,e,f),D(e,n),y(t,e,null),D(e,r),m(a,i,f),m(a,l,f),D(l,u),y(o,l,null),c=!0},p(a,f){const $={};f&16&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&16&&(p.$$scope={dirty:f,ctx:a}),o.$set(p)},i(a){c||(g(t.$$.fragment,a),g(o.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(o.$$.fragment,a),c=!1},d(a){a&&(h(e),h(i),h(l)),b(t),b(o)}}}function Jn(s){let e,n,t;return n=new we({props:{$$slots:{default:[Wn]},$$scope:{ctx:s}}}),{c(){e=B("span"),v(n.$$.fragment),x(e,"slot","right")},m(r,i){m(r,e,i),y(n,e,null),t=!0},p(r,i){const l={};i&16&&(l.$$scope={dirty:i,ctx:r}),n.$set(l)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&h(e),b(n)}}}function Xn(s){let e,n,t,r,i;function l(o){s[2](o)}let u={id:fe,$$slots:{right:[Jn],default:[Gn]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new de({props:u}),X.push(()=>Y(e,"checked",l)),r=new oe({props:{layer:fe,tooltip:Yn,show:s[0]}}),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment)},m(o,c){y(e,o,c),m(o,t,c),y(r,o,c),i=!0},p(o,[c]){const a={};c&16&&(a.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,a.checked=o[0],Q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=o[0]),r.$set(f)},i(o){i||(g(e.$$.fragment,o),g(r.$$.fragment,o),i=!0)},o(o){_(e.$$.fragment,o),_(r.$$.fragment,o),i=!1},d(o){o&&h(t),b(e,o),b(r,o)}}}let fe="mrn";function Yn(s){return`<p>${s.properties.name??"Unknown MRN road"}</p>`}function Qn(s,e,n){let t;K(s,ie,u=>n(3,t=u));let r=G.mrn;Ee(t,fe,`https://atip.uk/layers/v1/${fe}.pmtiles`),De(t,{id:fe,source:fe,sourceLayer:fe,color:r,width:7,opacity:ge(.5,1)});let i=!1;function l(u){i=u,n(0,i)}return[i,r,l]}class er extends H{constructor(e){super(),Z(this,e,Qn,Xn,R,{})}}function tr(s){let e,n,t;return e=new _e({props:{color:s[1]}}),{c(){v(e.$$.fragment),n=L(`
  Parliamentary constituencies`)},m(r,i){y(e,r,i),m(r,n,i),t=!0},p:Se,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&h(n),b(e,r)}}}function nr(s){let e;return{c(){e=L(`Ordnance Survey Boundary-Line
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function rr(s){let e;return{c(){e=L("Open Government License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function sr(s){let e,n,t,r,i,l,u,o,c;return t=new F({props:{href:"https://www.ordnancesurvey.co.uk/products/boundary-line",$$slots:{default:[nr]},$$scope:{ctx:s}}}),o=new F({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[rr]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=L("Data from "),v(t.$$.fragment),r=L("."),i=M(),l=B("p"),u=L("License: "),v(o.$$.fragment)},m(a,f){m(a,e,f),D(e,n),y(t,e,null),D(e,r),m(a,i,f),m(a,l,f),D(l,u),y(o,l,null),c=!0},p(a,f){const $={};f&32&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&32&&(p.$$scope={dirty:f,ctx:a}),o.$set(p)},i(a){c||(g(t.$$.fragment,a),g(o.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(o.$$.fragment,a),c=!1},d(a){a&&(h(e),h(i),h(l)),b(t),b(o)}}}function or(s){let e,n,t;return n=new we({props:{$$slots:{default:[sr]},$$scope:{ctx:s}}}),{c(){e=B("span"),v(n.$$.fragment),x(e,"slot","right")},m(r,i){m(r,e,i),y(n,e,null),t=!0},p(r,i){const l={};i&32&&(l.$$scope={dirty:i,ctx:r}),n.$set(l)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&h(e),b(n)}}}function ir(s){let e,n,t,r,i;function l(o){s[3](o)}let u={id:ee,$$slots:{right:[or],default:[tr]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new de({props:u}),X.push(()=>Y(e,"checked",l)),r=new oe({props:{layer:ee,tooltip:lr,show:s[0]}}),r.$on("click",ar),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment)},m(o,c){y(e,o,c),m(o,t,c),y(r,o,c),i=!0},p(o,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,a.checked=o[0],Q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=o[0]),r.$set(f)},i(o){i||(g(e.$$.fragment,o),g(r.$$.fragment,o),i=!0)},o(o){_(e.$$.fragment,o),_(r.$$.fragment,o),i=!1},d(o){o&&h(t),b(e,o),b(r,o)}}}let ee="parliamentary_constituencies";function lr(s){return`<p>${s.properties.Name}</p>`}function ar(s){let e=s.detail.properties.Name;e=e.replace(/ Boro Const$/,""),e=e.replace(/ Co Const$/,""),e=encodeURIComponent(e),window.open(`https://members.parliament.uk/members/Commons?SearchText=${e}`,"_blank")}function fr(s,e,n){let t;K(s,ie,o=>n(2,t=o));let r=G.parliamentary_constituencies,i=`${ee}-outline`;Ee(t,ee,`https://atip.uk/layers/v1/${ee}.pmtiles`),Ce(t,{id:ee,source:ee,sourceLayer:ee,color:r,opacity:ge(.5,.1)}),De(t,{id:i,source:ee,sourceLayer:ee,color:r,width:5});let l=!1;function u(o){l=o,n(0,l)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(i)&&t.setLayoutProperty(i,"visibility",l?"visible":"none")},[l,r,t,u]}class cr extends H{constructor(e){super(),Z(this,e,fr,ir,R,{})}}function ur(s){let e;return{c(){e=L("Show on map")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function pr(s){let e;return{c(){e=L("Edit scheme locally")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function $r(s){let e,n,t=s[0].authority_or_region+"",r,i,l,u,o=s[0].capital_scheme_id+"",c,a,f,$,p=s[0].funding_programme+"",w,d,C,k,T,S,A;return k=new Ae({props:{$$slots:{default:[ur]},$$scope:{ctx:s}}}),k.$on("click",s[3]),S=new Ae({props:{disabled:s[1],title:s[2],$$slots:{default:[pr]},$$scope:{ctx:s}}}),S.$on("click",s[4]),{c(){e=B("p"),n=L("Authority or region: "),r=L(t),i=M(),l=B("p"),u=L("Capital scheme ID: "),c=L(o),a=M(),f=B("p"),$=L("Funding programme: "),w=L(p),d=M(),C=B("div"),v(k.$$.fragment),T=M(),v(S.$$.fragment),x(C,"class","govuk-button-group")},m(U,E){m(U,e,E),D(e,n),D(e,r),m(U,i,E),m(U,l,E),D(l,u),D(l,c),m(U,a,E),m(U,f,E),D(f,$),D(f,w),m(U,d,E),m(U,C,E),y(k,C,null),D(C,T),y(S,C,null),A=!0},p(U,E){(!A||E&1)&&t!==(t=U[0].authority_or_region+"")&&se(r,t),(!A||E&1)&&o!==(o=U[0].capital_scheme_id+"")&&se(c,o),(!A||E&1)&&p!==(p=U[0].funding_programme+"")&&se(w,p);const P={};E&256&&(P.$$scope={dirty:E,ctx:U}),k.$set(P);const z={};E&256&&(z.$$scope={dirty:E,ctx:U}),S.$set(z)},i(U){A||(g(k.$$.fragment,U),g(S.$$.fragment,U),A=!0)},o(U){_(k.$$.fragment,U),_(S.$$.fragment,U),A=!1},d(U){U&&(h(e),h(i),h(l),h(a),h(f),h(d),h(C)),b(k),b(S)}}}function mr(s){let e,n;return e=new Ze({props:{label:`${s[0].scheme_reference}: ${s[0].num_features} features`,$$slots:{default:[$r]},$$scope:{ctx:s}}}),{c(){v(e.$$.fragment)},m(t,r){y(e,t,r),n=!0},p(t,[r]){const i={};r&1&&(i.label=`${t[0].scheme_reference}: ${t[0].num_features} features`),r&257&&(i.$$scope={dirty:r,ctx:t}),e.$set(i)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function hr(s,e,n){let t,r;K(s,he,f=>n(6,t=f)),K(s,ie,f=>n(7,r=f));let{scheme:i}=e,{authorityNames:l}=e,u=!l.has(i.authority_or_region),o=u?"This scheme doesn't have an authority specified correctly, so you can't edit this scheme. We're working to fix this problem.":void 0;function c(){let f={type:"FeatureCollection",features:t.features.filter($=>$.properties.scheme_reference==i.scheme_reference)};r==null||r.fitBounds(ht(f),{padding:20,animate:!1})}function a(){let f={type:"FeatureCollection",features:t.features.filter(p=>p.properties.scheme_reference==i.scheme_reference)},$=i.authority_or_region;window.localStorage.setItem($,JSON.stringify(f)),window.open(`scheme.html?authority=${i.authority_or_region}`,"_blank")}return s.$$set=f=>{"scheme"in f&&n(0,i=f.scheme),"authorityNames"in f&&n(5,l=f.authorityNames)},[i,u,o,c,a,l]}class gr extends H{constructor(e){super(),Z(this,e,hr,mr,R,{scheme:0,authorityNames:5})}}function dr(s){let e;return{c(){e=L("primary and secondary schools")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function _r(s){let e;return{c(){e=L("Open Data Commons Open Database License")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function wr(s){let e,n,t,r,i,l,u,o,c;return t=new F({props:{href:"https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dschool",$$slots:{default:[dr]},$$scope:{ctx:s}}}),o=new F({props:{href:"https://www.openstreetmap.org/copyright",$$slots:{default:[_r]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=L("This shows "),v(t.$$.fragment),r=L(` from OpenStreetMap. It doesn't include kindergartens, colleges,
    universities, or other training schools.`),i=M(),l=B("p"),u=L("License: "),v(o.$$.fragment)},m(a,f){m(a,e,f),D(e,n),y(t,e,null),D(e,r),m(a,i,f),m(a,l,f),D(l,u),y(o,l,null),c=!0},p(a,f){const $={};f&1&&($.$$scope={dirty:f,ctx:a}),t.$set($);const p={};f&1&&(p.$$scope={dirty:f,ctx:a}),o.$set(p)},i(a){c||(g(t.$$.fragment,a),g(o.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(o.$$.fragment,a),c=!1},d(a){a&&(h(e),h(i),h(l)),b(t),b(o)}}}function vr(s){let e,n;return e=new _t({props:{name:"schools",singularNoun:"school",pluralNoun:"Schools",$$slots:{default:[wr]},$$scope:{ctx:s}}}),{c(){v(e.$$.fragment)},m(t,r){y(e,t,r),n=!0},p(t,[r]){const i={};r&1&&(i.$$scope={dirty:r,ctx:t}),e.$set(i)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}class yr extends H{constructor(e){super(),Z(this,e,null,vr,R,{})}}function br(s){let e,n,t;return e=new _e({props:{color:s[1]}}),{c(){v(e.$$.fragment),n=L(`
  Wards`)},m(r,i){y(e,r,i),m(r,n,i),t=!0},p:Se,i(r){t||(g(e.$$.fragment,r),t=!0)},o(r){_(e.$$.fragment,r),t=!1},d(r){r&&h(n),b(e,r)}}}function kr(s){let e;return{c(){e=L(`ONS Geography
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Lr(s){let e;return{c(){e=L(`Open Government License
        `)},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function Tr(s){let e,n,t,r,i,l,u,o,c,a;return t=new F({props:{href:"https://geoportal.statistics.gov.uk/datasets/ons::wards-may-2023-boundaries-uk-bgc/explore",$$slots:{default:[kr]},$$scope:{ctx:s}}}),o=new F({props:{href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",$$slots:{default:[Lr]},$$scope:{ctx:s}}}),{c(){e=B("p"),n=L("Data from "),v(t.$$.fragment),r=L(", as of May 2023."),i=M(),l=B("p"),u=L("License: "),v(o.$$.fragment),c=L(`. Contains OS data Â© Crown copyright and database
        right 2023.`)},m(f,$){m(f,e,$),D(e,n),y(t,e,null),D(e,r),m(f,i,$),m(f,l,$),D(l,u),y(o,l,null),D(l,c),a=!0},p(f,$){const p={};$&32&&(p.$$scope={dirty:$,ctx:f}),t.$set(p);const w={};$&32&&(w.$$scope={dirty:$,ctx:f}),o.$set(w)},i(f){a||(g(t.$$.fragment,f),g(o.$$.fragment,f),a=!0)},o(f){_(t.$$.fragment,f),_(o.$$.fragment,f),a=!1},d(f){f&&(h(e),h(i),h(l)),b(t),b(o)}}}function Cr(s){let e,n,t;return n=new we({props:{$$slots:{default:[Tr]},$$scope:{ctx:s}}}),{c(){e=B("span"),v(n.$$.fragment),x(e,"slot","right")},m(r,i){m(r,e,i),y(n,e,null),t=!0},p(r,i){const l={};i&32&&(l.$$scope={dirty:i,ctx:r}),n.$set(l)},i(r){t||(g(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&h(e),b(n)}}}function Dr(s){let e,n,t,r,i;function l(o){s[3](o)}let u={id:te,$$slots:{right:[Cr],default:[br]},$$scope:{ctx:s}};return s[0]!==void 0&&(u.checked=s[0]),e=new de({props:u}),X.push(()=>Y(e,"checked",l)),r=new oe({props:{layer:te,tooltip:Sr,show:s[0]}}),r.$on("click",Ur),{c(){v(e.$$.fragment),t=M(),v(r.$$.fragment)},m(o,c){y(e,o,c),m(o,t,c),y(r,o,c),i=!0},p(o,[c]){const a={};c&32&&(a.$$scope={dirty:c,ctx:o}),!n&&c&1&&(n=!0,a.checked=o[0],Q(()=>n=!1)),e.$set(a);const f={};c&1&&(f.show=o[0]),r.$set(f)},i(o){i||(g(e.$$.fragment,o),g(r.$$.fragment,o),i=!0)},o(o){_(e.$$.fragment,o),_(r.$$.fragment,o),i=!1},d(o){o&&h(t),b(e,o),b(r,o)}}}let te="wards";function Sr(s){return`<p>${s.properties.name}</p>`}function Ur(s){let e=encodeURIComponent(s.detail.properties.name);window.open(`https://www.google.com/search?q=${e}+councillor`,"_blank")}function Mr(s,e,n){let t;K(s,ie,o=>n(2,t=o));let r=G.wards,i=`${te}-outline`;Ee(t,te,`https://atip.uk/layers/v1/${te}.pmtiles`),Ce(t,{id:te,source:te,sourceLayer:te,color:r,opacity:ge(.5,.1)}),De(t,{id:i,source:te,sourceLayer:te,color:r,width:2.5});let l=!1;function u(o){l=o,n(0,l)}return s.$$.update=()=>{s.$$.dirty&5&&t.getLayer(i)&&t.setLayoutProperty(i,"visibility",l?"visible":"none")},[l,r,t,u]}class Ar extends H{constructor(e){super(),Z(this,e,Mr,Dr,R,{})}}var I=(s,e,n)=>new Promise((t,r)=>{var i=o=>{try{u(n.next(o))}catch(c){r(c)}},l=o=>{try{u(n.throw(o))}catch(c){r(c)}},u=o=>o.done?t(o.value):Promise.resolve(o.value).then(i,l);u((n=n.apply(s,e)).next())}),V=Uint8Array,$e=Uint16Array,Br=Int32Array,wt=new V([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vt=new V([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Er=new V([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yt=function(s,e){for(var n=new $e(31),t=0;t<31;++t)n[t]=e+=1<<s[t-1];for(var r=new Br(n[30]),t=1;t<30;++t)for(var i=n[t];i<n[t+1];++i)r[i]=i-n[t]<<5|t;return{b:n,r}},bt=yt(wt,2),kt=bt.b,Or=bt.r;kt[28]=258,Or[258]=28;var Pr=yt(vt,0),zr=Pr.b,je=new $e(32768);for(O=0;O<32768;++O)re=(O&43690)>>1|(O&21845)<<1,re=(re&52428)>>2|(re&13107)<<2,re=(re&61680)>>4|(re&3855)<<4,je[O]=((re&65280)>>8|(re&255)<<8)>>1;var re,O,Te=function(s,e,n){for(var t=s.length,r=0,i=new $e(e);r<t;++r)s[r]&&++i[s[r]-1];var l=new $e(e);for(r=1;r<e;++r)l[r]=l[r-1]+i[r-1]<<1;var u;if(n){u=new $e(1<<e);var o=15-e;for(r=0;r<t;++r)if(s[r])for(var c=r<<4|s[r],a=e-s[r],f=l[s[r]-1]++<<a,$=f|(1<<a)-1;f<=$;++f)u[je[f]>>o]=c}else for(u=new $e(t),r=0;r<t;++r)s[r]&&(u[r]=je[l[s[r]-1]++]>>15-s[r]);return u},Ue=new V(288);for(O=0;O<144;++O)Ue[O]=8;var O;for(O=144;O<256;++O)Ue[O]=9;var O;for(O=256;O<280;++O)Ue[O]=7;var O;for(O=280;O<288;++O)Ue[O]=8;var O,Lt=new V(32);for(O=0;O<32;++O)Lt[O]=5;var O,Nr=Te(Ue,9,1),Ir=Te(Lt,5,1),Ie=function(s){for(var e=s[0],n=1;n<s.length;++n)s[n]>e&&(e=s[n]);return e},W=function(s,e,n){var t=e/8|0;return(s[t]|s[t+1]<<8)>>(e&7)&n},xe=function(s,e){var n=e/8|0;return(s[n]|s[n+1]<<8|s[n+2]<<16)>>(e&7)},xr=function(s){return(s+7)/8|0},Fr=function(s,e,n){(e==null||e<0)&&(e=0),(n==null||n>s.length)&&(n=s.length);var t=new V(n-e);return t.set(s.subarray(e,n)),t},jr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],j=function(s,e,n){var t=new Error(e||jr[s]);if(t.code=s,Error.captureStackTrace&&Error.captureStackTrace(t,j),!n)throw t;return t},Re=function(s,e,n,t){var r=s.length,i=t?t.length:0;if(!r||e.f&&!e.l)return n||new V(0);var l=!n||e.i!=2,u=e.i;n||(n=new V(r*3));var o=function(Xe){var Ye=n.length;if(Xe>Ye){var Qe=new V(Math.max(Ye*2,Xe));Qe.set(n),n=Qe}},c=e.f||0,a=e.p||0,f=e.b||0,$=e.l,p=e.d,w=e.m,d=e.n,C=r*8;do{if(!$){c=W(s,a,1);var k=W(s,a+1,3);if(a+=3,k)if(k==1)$=Nr,p=Ir,w=9,d=5;else if(k==2){var U=W(s,a,31)+257,E=W(s,a+10,15)+4,P=U+W(s,a+5,31)+1;a+=14;for(var z=new V(P),ne=new V(19),N=0;N<E;++N)ne[Er[N]]=W(s,a+N*3,7);a+=E*3;for(var Ge=Ie(ne),Bt=(1<<Ge)-1,Et=Te(ne,Ge,1),N=0;N<P;){var Ke=Et[W(s,a,Bt)];a+=Ke&15;var T=Ke>>4;if(T<16)z[N++]=T;else{var ce=0,Me=0;for(T==16?(Me=3+W(s,a,3),a+=2,ce=z[N-1]):T==17?(Me=3+W(s,a,7),a+=3):T==18&&(Me=11+W(s,a,127),a+=7);Me--;)z[N++]=ce}}var qe=z.subarray(0,U),q=z.subarray(U);w=Ie(qe),d=Ie(q),$=Te(qe,w,1),p=Te(q,d,1)}else j(1);else{var T=xr(a)+4,S=s[T-4]|s[T-3]<<8,A=T+S;if(A>r){u&&j(0);break}l&&o(f+S),n.set(s.subarray(T,A),f),e.b=f+=S,e.p=a=A*8,e.f=c;continue}if(a>C){u&&j(0);break}}l&&o(f+131072);for(var Ot=(1<<w)-1,Pt=(1<<d)-1,Oe=a;;Oe=a){var ce=$[xe(s,a)&Ot],ue=ce>>4;if(a+=ce&15,a>C){u&&j(0);break}if(ce||j(2),ue<256)n[f++]=ue;else if(ue==256){Oe=a,$=null;break}else{var We=ue-254;if(ue>264){var N=ue-257,ve=wt[N];We=W(s,a,(1<<ve)-1)+kt[N],a+=ve}var Pe=p[xe(s,a)&Pt],ze=Pe>>4;Pe||j(3),a+=Pe&15;var q=zr[ze];if(ze>3){var ve=vt[ze];q+=xe(s,a)&(1<<ve)-1,a+=ve}if(a>C){u&&j(0);break}l&&o(f+131072);var Ne=f+We;if(f<q){var Je=i-q,zt=Math.min(q,Ne);for(Je+f<0&&j(3);f<zt;++f)n[f]=t[Je+f]}for(;f<Ne;f+=4)n[f]=n[f-q],n[f+1]=n[f+1-q],n[f+2]=n[f+2-q],n[f+3]=n[f+3-q];f=Ne}}e.l=$,e.p=Oe,e.b=f,e.f=c,$&&(c=1,e.m=w,e.d=p,e.n=d)}while(!c);return f==n.length?n:Fr(n,0,f)},Vr=new V(0),Hr=function(s){(s[0]!=31||s[1]!=139||s[2]!=8)&&j(6,"invalid gzip data");var e=s[3],n=10;e&4&&(n+=(s[10]|s[11]<<8)+2);for(var t=(e>>3&1)+(e>>4&1);t>0;t-=!s[n++]);return n+(e&2)},Zr=function(s){var e=s.length;return(s[e-4]|s[e-3]<<8|s[e-2]<<16|s[e-1]<<24)>>>0},Rr=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&j(6,"invalid zlib data"),(s[1]>>5&1)==+!e&&j(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function Gr(s,e){return Re(s,{i:2},e&&e.out,e&&e.dictionary)}function Kr(s,e){var n=Hr(s);return n+8>s.length&&j(6,"invalid gzip data"),Re(s.subarray(n,-8),{i:2},e&&e.out||new V(Zr(s)),e&&e.dictionary)}function qr(s,e){return Re(s.subarray(Rr(s,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function Ve(s,e){return s[0]==31&&s[1]==139&&s[2]==8?Kr(s,e):(s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31?Gr(s,e):qr(s,e)}var Wr=typeof TextDecoder<"u"&&new TextDecoder,Jr=0;try{Wr.decode(Vr,{stream:!0}),Jr=1}catch{}var Tt=(s,e)=>s*Math.pow(2,e),ye=(s,e)=>Math.floor(s/Math.pow(2,e)),Be=(s,e)=>Tt(s.getUint16(e+1,!0),8)+s.getUint8(e),Ct=(s,e)=>Tt(s.getUint32(e+2,!0),16)+s.getUint16(e,!0),Xr=(s,e,n,t,r)=>{if(s!=t.getUint8(r))return s-t.getUint8(r);const i=Be(t,r+1);if(e!=i)return e-i;const l=Be(t,r+4);return n!=l?n-l:0},Yr=(s,e,n,t)=>{const r=Dt(s,e|128,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!0}:null},ot=(s,e,n,t)=>{const r=Dt(s,e,n,t);return r?{z:e,x:n,y:t,offset:r[0],length:r[1],is_dir:!1}:null},Dt=(s,e,n,t)=>{let r=0,i=s.byteLength/17-1;for(;r<=i;){const l=i+r>>1,u=Xr(e,n,t,s,l*17);if(u>0)r=l+1;else if(u<0)i=l-1;else return[Ct(s,l*17+7),s.getUint32(l*17+13,!0)]}return null},Qr=(s,e)=>s.is_dir&&!e.is_dir?1:!s.is_dir&&e.is_dir?-1:s.z!==e.z?s.z-e.z:s.x!==e.x?s.x-e.x:s.y-e.y,St=(s,e)=>{const n=s.getUint8(e*17);return{z:n&127,x:Be(s,e*17+1),y:Be(s,e*17+4),offset:Ct(s,e*17+7),length:s.getUint32(e*17+13,!0),is_dir:n>>7===1}},it=s=>{const e=[],n=new DataView(s);for(let t=0;t<n.byteLength/17;t++)e.push(St(n,t));return es(e)},es=s=>{s.sort(Qr);const e=new ArrayBuffer(17*s.length),n=new Uint8Array(e);for(let t=0;t<s.length;t++){const r=s[t];let i=r.z;r.is_dir&&(i=i|128),n[t*17]=i,n[t*17+1]=r.x&255,n[t*17+2]=r.x>>8&255,n[t*17+3]=r.x>>16&255,n[t*17+4]=r.y&255,n[t*17+5]=r.y>>8&255,n[t*17+6]=r.y>>16&255,n[t*17+7]=r.offset&255,n[t*17+8]=ye(r.offset,8)&255,n[t*17+9]=ye(r.offset,16)&255,n[t*17+10]=ye(r.offset,24)&255,n[t*17+11]=ye(r.offset,32)&255,n[t*17+12]=ye(r.offset,48)&255,n[t*17+13]=r.length&255,n[t*17+14]=r.length>>8&255,n[t*17+15]=r.length>>16&255,n[t*17+16]=r.length>>24&255}return e},ts=(s,e)=>{if(s.byteLength<17)return null;const n=s.byteLength/17,t=St(s,n-1);if(t.is_dir){const r=t.z,i=e.z-r,l=Math.trunc(e.x/(1<<i)),u=Math.trunc(e.y/(1<<i));return{z:r,x:l,y:u}}return null};function ns(s){return I(this,null,function*(){const e=yield s.getBytes(0,512e3),n=new DataView(e.data),t=n.getUint32(4,!0),r=n.getUint16(8,!0),i=new TextDecoder("utf-8"),l=JSON.parse(i.decode(new DataView(e.data,10,t)));let u=0;l.compression==="gzip"&&(u=2);let o=0;"minzoom"in l&&(o=+l.minzoom);let c=0;"maxzoom"in l&&(c=+l.maxzoom);let a=0,f=0,$=0,p=-180,w=-85,d=180,C=85;if(l.bounds){const T=l.bounds.split(",");p=+T[0],w=+T[1],d=+T[2],C=+T[3]}if(l.center){const T=l.center.split(",");a=+T[0],f=+T[1],$=+T[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+t,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:t,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:o,maxZoom:c,minLon:p,minLat:w,maxLon:d,maxLat:C,centerZoom:$,centerLon:a,centerLat:f,etag:e.etag}})}function rs(s,e,n,t,r,i,l){return I(this,null,function*(){let u=yield n.getArrayBuffer(e,s.rootDirectoryOffset,s.rootDirectoryLength,s);s.specVersion===1&&(u=it(u));const o=ot(new DataView(u),t,r,i);if(o){let f=(yield e.getBytes(o.offset,o.length,l)).data;const $=new DataView(f);return $.getUint8(0)==31&&$.getUint8(1)==139&&(f=Ve(new Uint8Array(f))),{data:f}}const c=ts(new DataView(u),{z:t,x:r,y:i});if(c){const a=Yr(new DataView(u),c.z,c.x,c.y);if(a){let f=yield n.getArrayBuffer(e,a.offset,a.length,s);s.specVersion===1&&(f=it(f));const $=ot(new DataView(f),t,r,i);if($){let w=(yield e.getBytes($.offset,$.length,l)).data;const d=new DataView(w);return d.getUint8(0)==31&&d.getUint8(1)==139&&(w=Ve(new Uint8Array(w))),{data:w}}}}})}var Ut={getHeader:ns,getZxy:rs},ss=class{constructor(){this.tile=(s,e)=>{if(s.type=="json"){const n=s.url.substr(10);let t=this.tiles.get(n);return t||(t=new lt(n),this.tiles.set(n,t)),t.getHeader().then(r=>{const i={tiles:[s.url+"/{z}/{x}/{y}"],minzoom:r.minZoom,maxzoom:r.maxZoom,bounds:[r.minLon,r.minLat,r.maxLon,r.maxLat]};e(null,i,null,null)}).catch(r=>{e(r,null,null,null)}),{cancel:()=>{}}}else{const n=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),t=s.url.match(n);if(!t)throw new Error("Invalid PMTiles protocol URL");const r=t[1];let i=this.tiles.get(r);i||(i=new lt(r),this.tiles.set(r,i));const l=t[2],u=t[3],o=t[4],c=new AbortController,a=c.signal;let f=()=>{c.abort()};return i.getHeader().then($=>{i.getZxy(+l,+u,+o,a).then(p=>{p?e(null,new Uint8Array(p.data),p.cacheControl,p.expires):$.tileType==1?e(null,new Uint8Array,null,null):e(null,null,null,null)}).catch(p=>{p.name!=="AbortError"&&e(p,null,null,null)})}),{cancel:f}}},this.tiles=new Map}add(s){this.tiles.set(s.source.getKey(),s)}get(s){return this.tiles.get(s)}};function pe(s,e){return(e>>>0)*4294967296+(s>>>0)}function os(s,e){const n=e.buf;let t,r;if(r=n[e.pos++],t=(r&112)>>4,r<128||(r=n[e.pos++],t|=(r&127)<<3,r<128)||(r=n[e.pos++],t|=(r&127)<<10,r<128)||(r=n[e.pos++],t|=(r&127)<<17,r<128)||(r=n[e.pos++],t|=(r&127)<<24,r<128)||(r=n[e.pos++],t|=(r&1)<<31,r<128))return pe(s,t);throw new Error("Expected varint not more than 10 bytes")}function be(s){const e=s.buf;let n,t;return t=e[s.pos++],n=t&127,t<128||(t=e[s.pos++],n|=(t&127)<<7,t<128)||(t=e[s.pos++],n|=(t&127)<<14,t<128)||(t=e[s.pos++],n|=(t&127)<<21,t<128)?n:(t=e[s.pos],n|=(t&15)<<28,os(n,s))}function is(s,e,n,t){if(t==0){n==1&&(e[0]=s-1-e[0],e[1]=s-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}var ls=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function as(s,e,n){if(s>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,s)-1||n>Math.pow(2,s)-1)throw Error("tile x/y outside zoom level bounds");const t=ls[s],r=Math.pow(2,s);let i=0,l=0,u=0;const o=[e,n];let c=r/2;for(;c>0;)i=(o[0]&c)>0?1:0,l=(o[1]&c)>0?1:0,u+=c*c*(3*i^l),is(c,o,i,l),c=c/2;return t+u}function Mt(s,e){return I(this,null,function*(){if(e===1||e===0)return s;if(e===2){if(typeof globalThis.DecompressionStream>"u")return Ve(new Uint8Array(s));{let t=new Response(s).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(t).arrayBuffer()}}else throw Error("Compression method not supported")})}var fs=127;function cs(s,e){let n=0,t=s.length-1;for(;n<=t;){const r=t+n>>1,i=e-s[r].tileId;if(i>0)n=r+1;else if(i<0)t=r-1;else return s[r]}return t>=0&&(s[t].runLength===0||e-s[t].tileId<s[t].runLength)?s[t]:null}var us=class{constructor(s){this.url=s}getKey(){return this.url}getBytes(s,e,n){return I(this,null,function*(){let t;n||(t=new AbortController,n=t.signal);let r=yield fetch(this.url,{signal:n,headers:{Range:"bytes="+s+"-"+(s+e-1)}});if(r.status===416&&s===0){const u=r.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const o=+u.substr(8);r=yield fetch(this.url,{signal:n,headers:{Range:"bytes=0-"+(o-1)}})}if(r.status>=300)throw Error("Bad response code: "+r.status);const i=r.headers.get("Content-Length");if(r.status===200&&(!i||+i>e))throw t&&t.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield r.arrayBuffer(),etag:r.headers.get("ETag")||void 0,cacheControl:r.headers.get("Cache-Control")||void 0,expires:r.headers.get("Expires")||void 0}})}};function J(s,e){const n=s.getUint32(e+4,!0),t=s.getUint32(e+0,!0);return n*Math.pow(2,32)+t}function ps(s,e){const n=new DataView(s),t=n.getUint8(7);if(t>3)throw Error(`Archive is spec version ${t} but this library supports up to spec version 3`);return{specVersion:t,rootDirectoryOffset:J(n,8),rootDirectoryLength:J(n,16),jsonMetadataOffset:J(n,24),jsonMetadataLength:J(n,32),leafDirectoryOffset:J(n,40),leafDirectoryLength:J(n,48),tileDataOffset:J(n,56),tileDataLength:J(n,64),numAddressedTiles:J(n,72),numTileEntries:J(n,80),numTileContents:J(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function At(s){const e={buf:new Uint8Array(s),pos:0},n=be(e),t=[];let r=0;for(let i=0;i<n;i++){const l=be(e);t.push({tileId:r+l,offset:0,length:0,runLength:1}),r+=l}for(let i=0;i<n;i++)t[i].runLength=be(e);for(let i=0;i<n;i++)t[i].length=be(e);for(let i=0;i<n;i++){const l=be(e);l===0&&i>0?t[i].offset=t[i-1].offset+t[i-1].length:t[i].offset=l-1}return t}function $s(s){const e=new DataView(s);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var me=class extends Error{};function ms(s,e,n,t){return I(this,null,function*(){const r=yield s.getBytes(0,16384);if(new DataView(r.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if($s(r.data)<3)return[yield Ut.getHeader(s)];const l=r.data.slice(0,fs);let u=r.etag;t&&r.etag!=t&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+s.getKey()),u=void 0);const o=ps(l,u);if(n){const c=r.data.slice(o.rootDirectoryOffset,o.rootDirectoryOffset+o.rootDirectoryLength),a=s.getKey()+"|"+(o.etag||"")+"|"+o.rootDirectoryOffset+"|"+o.rootDirectoryLength,f=At(yield e(c,o.internalCompression));return[o,[a,f.length,f]]}return[o,void 0]})}function hs(s,e,n,t,r){return I(this,null,function*(){const i=yield s.getBytes(n,t);if(r.etag&&r.etag!==i.etag)throw new me(i.etag);const l=yield e(i.data,r.internalCompression),u=At(l);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var gs=class{constructor(s=100,e=!0,n=Mt){this.cache=new Map,this.maxCacheEntries=s,this.counter=1,this.prefetch=e,this.decompress=n}getHeader(s,e){return I(this,null,function*(){const n=s.getKey();if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const t=new Promise((r,i)=>{ms(s,this.decompress,this.prefetch,e).then(l=>{l[1]&&this.cache.set(l[1][0],{lastUsed:this.counter++,data:Promise.resolve(l[1][2])}),r(l[0]),this.prune()}).catch(l=>{i(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:t}),t})}getDirectory(s,e,n,t){return I(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const i=new Promise((l,u)=>{hs(s,this.decompress,e,n,t).then(o=>{l(o),this.prune()}).catch(o=>{u(o)})});return this.cache.set(r,{lastUsed:this.counter++,data:i}),i})}getArrayBuffer(s,e,n,t){return I(this,null,function*(){const r=s.getKey()+"|"+(t.etag||"")+"|"+e+"|"+n;if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const i=new Promise((l,u)=>{s.getBytes(e,n).then(o=>{if(t.etag&&t.etag!==o.etag)throw new me(o.etag);l(o.data),this.cache.has(r),this.prune()}).catch(o=>{u(o)})});return this.cache.set(r,{lastUsed:this.counter++,data:i}),i})}prune(){if(this.cache.size>=this.maxCacheEntries){let s=1/0,e;this.cache.forEach((n,t)=>{n.lastUsed<s&&(s=n.lastUsed,e=t)}),e&&this.cache.delete(e)}}invalidate(s,e){return I(this,null,function*(){this.cache.delete(s.getKey()),yield this.getHeader(s,e)})}},lt=class{constructor(s,e,n){typeof s=="string"?this.source=new us(s):this.source=s,n?this.decompress=n:this.decompress=Mt,e?this.cache=e:this.cache=new gs}getHeader(){return I(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(s,e,n,t){return I(this,null,function*(){const r=as(s,e,n),i=yield this.cache.getHeader(this.source);if(i.specVersion<3)return Ut.getZxy(i,this.source,this.cache,s,e,n,t);if(s<i.minZoom||s>i.maxZoom)return;let l=i.rootDirectoryOffset,u=i.rootDirectoryLength;for(let o=0;o<=3;o++){const c=yield this.cache.getDirectory(this.source,l,u,i),a=cs(c,r);if(a)if(a.runLength>0){const f=yield this.source.getBytes(i.tileDataOffset+a.offset,a.length,t);if(i.etag&&i.etag!==f.etag)throw new me(f.etag);return{data:yield this.decompress(f.data,i.tileCompression),cacheControl:f.cacheControl,expires:f.expires}}else l=i.leafDirectoryOffset+a.offset,u=a.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(s,e,n,t){return I(this,null,function*(){try{return yield this.getZxyAttempt(s,e,n,t)}catch(r){if(r instanceof me)return this.cache.invalidate(this.source,r.message),yield this.getZxyAttempt(s,e,n,t);throw r}})}getMetadataAttempt(){return I(this,null,function*(){const s=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(s.jsonMetadataOffset,s.jsonMetadataLength);if(s.etag&&s.etag!==e.etag)throw new me(e.etag);const n=yield this.decompress(e.data,s.internalCompression),t=new TextDecoder("utf-8");return JSON.parse(t.decode(n))})}getMetadata(){return I(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(s){if(s instanceof me)return this.cache.invalidate(this.source,s.message),yield this.getMetadataAttempt();throw s}})}};function ds(s){return He(()=>{let e=new ss;tt.addProtocol("pmtiles",e.tile)}),gt(()=>{tt.removeProtocol("pmtiles")}),[]}class _s extends H{constructor(e){super(),Z(this,e,ds,null,R,{})}}function at(s,e,n){const t=s.slice();return t[15]=e[n],t}function ws(s){let e;return{c(){e=L("Home")},m(n,t){m(n,e,t)},d(n){n&&h(e)}}}function ft(s){let e,n;return e=new Wt({props:{errorMessage:s[1]}}),{c(){v(e.$$.fragment)},m(t,r){y(e,t,r),n=!0},p(t,r){const i={};r&2&&(i.errorMessage=t[1]),e.$set(i)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ct(s){let e,n,t,r;function i(o){s[10](o)}function l(o){s[11](o)}let u={schemes:s[2]};return s[3]!==void 0&&(u.schemesToBeShown=s[3]),s[4]!==void 0&&(u.filterText=s[4]),e=new bn({props:u}),X.push(()=>Y(e,"schemesToBeShown",i)),X.push(()=>Y(e,"filterText",l)),{c(){v(e.$$.fragment)},m(o,c){y(e,o,c),r=!0},p(o,c){const a={};c&4&&(a.schemes=o[2]),!n&&c&8&&(n=!0,a.schemesToBeShown=o[3],Q(()=>n=!1)),!t&&c&16&&(t=!0,a.filterText=o[4],Q(()=>t=!1)),e.$set(a)},i(o){r||(g(e.$$.fragment,o),r=!0)},o(o){_(e.$$.fragment,o),r=!1},d(o){b(e,o)}}}function ut(s){let e,n,t=rt(s[2].values()),r=[];for(let l=0;l<t.length;l+=1)r[l]=$t(at(s,t,l));const i=l=>_(r[l],1,1,()=>{r[l]=null});return{c(){e=B("ul");for(let l=0;l<r.length;l+=1)r[l].c()},m(l,u){m(l,e,u);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);n=!0},p(l,u){if(u&13){t=rt(l[2].values());let o;for(o=0;o<t.length;o+=1){const c=at(l,t,o);r[o]?(r[o].p(c,u),g(r[o],1)):(r[o]=$t(c),r[o].c(),g(r[o],1),r[o].m(e,null))}for(ke(),o=t.length;o<r.length;o+=1)i(o);Le()}},i(l){if(!n){for(let u=0;u<t.length;u+=1)g(r[u]);n=!0}},o(l){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)_(r[u]);n=!1},d(l){l&&h(e),Jt(r,l)}}}function pt(s){let e,n;return e=new gr({props:{scheme:s[15],authorityNames:s[0]}}),{c(){v(e.$$.fragment)},m(t,r){y(e,t,r),n=!0},p(t,r){const i={};r&4&&(i.scheme=t[15]),r&1&&(i.authorityNames=t[0]),e.$set(i)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function $t(s){let e=s[3].has(s[15].scheme_reference),n,t,r=e&&pt(s);return{c(){r&&r.c(),n=Xt()},m(i,l){r&&r.m(i,l),m(i,n,l),t=!0},p(i,l){l&12&&(e=i[3].has(i[15].scheme_reference)),e?r?(r.p(i,l),l&12&&g(r,1)):(r=pt(i),r.c(),g(r,1),r.m(n.parentNode,n)):r&&(ke(),_(r,1,1,()=>{r=null}),Le())},i(i){t||(g(r),t=!0)},o(i){_(r),t=!1},d(i){i&&h(n),r&&r.d(i)}}}function vs(s){let e,n,t,r,i,l,u,o,c,a,f,$,p;n=new Ae({props:{$$slots:{default:[ws]},$$scope:{ctx:s}}}),n.$on("click",s[9]),u=new en({props:{boundaryGeojson:s[5]}});let w=s[1]&&ft(s);a=new Zt({props:{label:"Load from GeoJSON",id:"load-geojson",loadFile:s[7]}});let d=s[2].size>0&&ct(s),C=s[0]&&ut(s);return{c(){e=B("div"),v(n.$$.fragment),t=M(),r=B("div"),i=B("h1"),i.textContent="Browse schemes",l=M(),v(u.$$.fragment),o=M(),w&&w.c(),c=M(),v(a.$$.fragment),f=M(),d&&d.c(),$=M(),C&&C.c(),nt(r,"display","flex"),nt(r,"justify-content","space-between"),x(e,"slot","sidebar"),x(e,"class","govuk-prose")},m(k,T){m(k,e,T),y(n,e,null),D(e,t),D(e,r),D(r,i),D(r,l),y(u,r,null),D(e,o),w&&w.m(e,null),D(e,c),y(a,e,null),D(e,f),d&&d.m(e,null),D(e,$),C&&C.m(e,null),p=!0},p(k,T){const S={};T&262144&&(S.$$scope={dirty:T,ctx:k}),n.$set(S);const A={};T&32&&(A.boundaryGeojson=k[5]),u.$set(A),k[1]?w?(w.p(k,T),T&2&&g(w,1)):(w=ft(k),w.c(),g(w,1),w.m(e,c)):w&&(ke(),_(w,1,1,()=>{w=null}),Le()),k[2].size>0?d?(d.p(k,T),T&4&&g(d,1)):(d=ct(k),d.c(),g(d,1),d.m(e,$)):d&&(ke(),_(d,1,1,()=>{d=null}),Le()),k[0]?C?(C.p(k,T),T&1&&g(C,1)):(C=ut(k),C.c(),g(C,1),C.m(e,null)):C&&(ke(),_(C,1,1,()=>{C=null}),Le())},i(k){p||(g(n.$$.fragment,k),g(u.$$.fragment,k),g(w),g(a.$$.fragment,k),g(d),g(C),p=!0)},o(k){_(n.$$.fragment,k),_(u.$$.fragment,k),_(w),_(a.$$.fragment,k),_(d),_(C),p=!1},d(k){k&&h(e),b(n),b(u),w&&w.d(),b(a),d&&d.d(),C&&C.d()}}}function ys(s){let e,n,t,r,i,l,u,o,c,a,f,$,p,w;return e=new yr({}),t=new Bn({}),i=new er({}),u=new cr({}),c=new Ar({}),f=new hn({}),p=new Rn({}),{c(){v(e.$$.fragment),n=M(),v(t.$$.fragment),r=M(),v(i.$$.fragment),l=M(),v(u.$$.fragment),o=M(),v(c.$$.fragment),a=M(),v(f.$$.fragment),$=M(),v(p.$$.fragment)},m(d,C){y(e,d,C),m(d,n,C),y(t,d,C),m(d,r,C),y(i,d,C),m(d,l,C),y(u,d,C),m(d,o,C),y(c,d,C),m(d,a,C),y(f,d,C),m(d,$,C),y(p,d,C),w=!0},i(d){w||(g(e.$$.fragment,d),g(t.$$.fragment,d),g(i.$$.fragment,d),g(u.$$.fragment,d),g(c.$$.fragment,d),g(f.$$.fragment,d),g(p.$$.fragment,d),w=!0)},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),_(i.$$.fragment,d),_(u.$$.fragment,d),_(c.$$.fragment,d),_(f.$$.fragment,d),_(p.$$.fragment,d),w=!1},d(d){d&&(h(n),h(r),h(l),h(o),h(a),h($)),b(e,d),b(t,d),b(i,d),b(u,d),b(c,d),b(f,d),b(p,d)}}}function bs(s){let e,n,t,r,i,l,u,o;return e=new Pn({}),i=new rn({props:{small:!0,$$slots:{default:[ys]},$$scope:{ctx:s}}}),u=new sn({props:{style:s[6]}}),{c(){v(e.$$.fragment),n=M(),t=B("hr"),r=M(),v(i.$$.fragment),l=M(),v(u.$$.fragment)},m(c,a){y(e,c,a),m(c,n,a),m(c,t,a),m(c,r,a),y(i,c,a),m(c,l,a),y(u,c,a),o=!0},p(c,a){const f={};a&262144&&(f.$$scope={dirty:a,ctx:c}),i.$set(f)},i(c){o||(g(e.$$.fragment,c),g(i.$$.fragment,c),g(u.$$.fragment,c),o=!0)},o(c){_(e.$$.fragment,c),_(i.$$.fragment,c),_(u.$$.fragment,c),o=!1},d(c){c&&(h(n),h(t),h(r),h(l)),b(e,c),b(i,c),b(u,c)}}}function ks(s){let e,n,t,r,i,l,u,o,c,a,f;return e=new nn({props:{colorInterventions:dt("v1")}}),t=new oe({props:{layer:"interventions-points",tooltip:s[8]}}),i=new oe({props:{layer:"interventions-lines",tooltip:s[8]}}),u=new oe({props:{layer:"interventions-polygons",tooltip:s[8]}}),a=new Ze({props:{label:"Layers",open:!0,$$slots:{default:[bs]},$$scope:{ctx:s}}}),{c(){v(e.$$.fragment),n=M(),v(t.$$.fragment),r=M(),v(i.$$.fragment),l=M(),v(u.$$.fragment),o=M(),c=B("div"),v(a.$$.fragment),x(c,"class","top-right svelte-nlvvhu")},m($,p){y(e,$,p),m($,n,p),y(t,$,p),m($,r,p),y(i,$,p),m($,l,p),y(u,$,p),m($,o,p),m($,c,p),y(a,c,null),f=!0},p($,p){const w={};p&262144&&(w.$$scope={dirty:p,ctx:$}),a.$set(w)},i($){f||(g(e.$$.fragment,$),g(t.$$.fragment,$),g(i.$$.fragment,$),g(u.$$.fragment,$),g(a.$$.fragment,$),f=!0)},o($){_(e.$$.fragment,$),_(t.$$.fragment,$),_(i.$$.fragment,$),_(u.$$.fragment,$),_(a.$$.fragment,$),f=!1},d($){$&&(h(n),h(r),h(l),h(o),h(c)),b(e,$),b(t,$),b(i,$),b(u,$),b(a)}}}function Ls(s){let e,n,t,r,i;return n=new _s({}),r=new tn({props:{style:s[6],$$slots:{default:[ks]},$$scope:{ctx:s}}}),{c(){e=B("div"),v(n.$$.fragment),t=M(),v(r.$$.fragment),x(e,"slot","main")},m(l,u){m(l,e,u),y(n,e,null),D(e,t),y(r,e,null),i=!0},p(l,u){const o={};u&262144&&(o.$$scope={dirty:u,ctx:l}),r.$set(o)},i(l){i||(g(n.$$.fragment,l),g(r.$$.fragment,l),i=!0)},o(l){_(n.$$.fragment,l),_(r.$$.fragment,l),i=!1},d(l){l&&h(e),b(n),b(r)}}}function Ts(s){let e,n;return e=new Qt({props:{$$slots:{main:[Ls],sidebar:[vs]},$$scope:{ctx:s}}}),{c(){v(e.$$.fragment)},m(t,r){y(e,t,r),n=!0},p(t,[r]){const i={};r&262207&&(i.$$scope={dirty:r,ctx:t}),e.$set(i)},i(t){n||(g(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Cs(s,e,n){let t,r;K(s,ie,T=>n(12,t=T)),K(s,he,T=>n(5,r=T));let i=null;He(async()=>{Rt();let T=await Gt();n(0,i=new Set(T.features.map(S=>S.properties.name)))});let u=new URLSearchParams(window.location.search).get("style")||"dataviz",o="",c=new Map,a=new Set,f="";gt(()=>{he.set(Kt())});function $(T){try{let S=JSON.parse(T);n(2,c=gn(S)),he.set(S),n(1,o=""),t==null||t.fitBounds(ht(S),{padding:20,animate:!1})}catch(S){n(1,o=`Couldn't load schemes from a file: ${S}`)}}function p(T){let S=T.properties;var A='<div style="max-width: 30vw;">';return A+=`<h2>${w(S.name)} (${S.intervention_type})</h2>`,A+=`<p>Scheme reference: ${S.scheme_reference}</p>`,S.length_meters&&(A+=`<p>Length: ${qt(S.length_meters)}</p>`),S.description&&(A+=`<p>${w(S.description)}</p>`),A+="</div>",A}function w(T){return f?T.replace(new RegExp(f,"gi"),S=>`<mark>${S}</mark>`):T}const d=()=>window.open("index.html");function C(T){a=T,n(3,a)}function k(T){f=T,n(4,f)}return[i,o,c,a,f,r,u,$,p,d,C,k]}class Ds extends H{constructor(e){super(),Z(this,e,Cs,Ts,R,{})}}document.body.className=document.body.className?document.body.className+" js-enabled":"js-enabled";new Ds({target:document.getElementById("app")});
